function $v(){}function qv(va){return va()}function Kv(){return Object.create(null)}function Ac(va){va.forEach(qv)}function K0(va){return typeof va=="function"}function lg(va,ii){return va!=va?ii==ii:va!==ii||va&&typeof va=="object"||typeof va=="function"}let qc;function ug(va,ii){return qc||(qc=document.createElement("a")),qc.href=ii,va===qc.href}function J0(va){return Object.keys(va).length===0}function fg(va,ii){va.appendChild(ii)}function cg(va,ii,d){va.insertBefore(ii,d||null)}function Q0(va){va.parentNode.removeChild(va)}function hg(va,ii){for(let d=0;d<va.length;d+=1)va[d]&&va[d].d(ii)}function vg(va){return document.createElement(va)}function ep(va){return document.createTextNode(va)}function pg(){return ep(" ")}function dg(){return ep("")}function gg(va,ii,d){d==null?va.removeAttribute(ii):va.getAttribute(ii)!==d&&va.setAttribute(ii,d)}function $0(va){return Array.from(va.childNodes)}function yg(va,ii){ii=""+ii,va.wholeText!==ii&&(va.data=ii)}let Tc;function wc(va){Tc=va}function q0(){if(!Tc)throw new Error("Function called outside component initialization");return Tc}function mg(va){q0().$$.on_mount.push(va)}const _c=[],Jv=[],rh=[],Qv=[],eg=Promise.resolve();let Fh=!1;function tg(){Fh||(Fh=!0,eg.then(tp))}function Oh(va){rh.push(va)}const zh=new Set;let eh=0;function tp(){const va=Tc;do{for(;eh<_c.length;){const ii=_c[eh];eh++,wc(ii),rg(ii.$$)}for(wc(null),_c.length=0,eh=0;Jv.length;)Jv.pop()();for(let ii=0;ii<rh.length;ii+=1){const d=rh[ii];zh.has(d)||(zh.add(d),d())}rh.length=0}while(_c.length);for(;Qv.length;)Qv.pop()();Fh=!1,zh.clear(),wc(va)}function rg(va){if(va.fragment!==null){va.update(),Ac(va.before_update);const ii=va.dirty;va.dirty=[-1],va.fragment&&va.fragment.p(va.ctx,ii),va.after_update.forEach(Oh)}}const nh=new Set;let Mf;function xg(){Mf={r:0,c:[],p:Mf}}function bg(){Mf.r||Ac(Mf.c),Mf=Mf.p}function ng(va,ii){va&&va.i&&(nh.delete(va),va.i(ii))}function _g(va,ii,d,re){if(va&&va.o){if(nh.has(va))return;nh.add(va),Mf.c.push(()=>{nh.delete(va),re&&(d&&va.d(1),re())}),va.o(ii)}}function wg(va){va&&va.c()}function ag(va,ii,d,re){const{fragment:ne,on_mount:w,on_destroy:c,after_update:M}=va.$$;ne&&ne.m(ii,d),re||Oh(()=>{const T=w.map(qv).filter(K0);c?c.push(...T):Ac(T),va.$$.on_mount=[]}),M.forEach(Oh)}function ig(va,ii){const d=va.$$;d.fragment!==null&&(Ac(d.on_destroy),d.fragment&&d.fragment.d(ii),d.on_destroy=d.fragment=null,d.ctx=[])}function og(va,ii){va.$$.dirty[0]===-1&&(_c.push(va),tg(),va.$$.dirty.fill(0)),va.$$.dirty[ii/31|0]|=1<<ii%31}function Tg(va,ii,d,re,ne,w,c,M=[-1]){const T=Tc;wc(va);const e=va.$$={fragment:null,ctx:null,props:w,update:$v,not_equal:ne,bound:Kv(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(ii.context||(T?T.$$.context:[])),callbacks:Kv(),dirty:M,skip_bound:!1,root:ii.target||T.$$.root};c&&c(e.root);let a=!1;if(e.ctx=d?d(va,ii.props||{},(n,r,...t)=>{const f=t.length?t[0]:r;return e.ctx&&ne(e.ctx[n],e.ctx[n]=f)&&(!e.skip_bound&&e.bound[n]&&e.bound[n](f),a&&og(va,n)),r}):[],e.update(),a=!0,Ac(e.before_update),e.fragment=re?re(e.ctx):!1,ii.target){if(ii.hydrate){const n=$0(ii.target);e.fragment&&e.fragment.l(n),n.forEach(Q0)}else e.fragment&&e.fragment.c();ii.intro&&ng(va.$$.fragment),ag(va,ii.target,ii.anchor,ii.customElement),tp()}wc(T)}class Ag{$destroy(){ig(this,1),this.$destroy=$v}$on(ii,d){const re=this.$$.callbacks[ii]||(this.$$.callbacks[ii]=[]);return re.push(d),()=>{const ne=re.indexOf(d);ne!==-1&&re.splice(ne,1)}}$set(ii){this.$$set&&!J0(ii)&&(this.$$.skip_bound=!0,this.$$set(ii),this.$$.skip_bound=!1)}}var Mo=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function sg(va){return va&&va.__esModule&&Object.prototype.hasOwnProperty.call(va,"default")?va.default:va}function th(va){throw new Error('Could not dynamically require "'+va+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var rp={exports:{}};(function(va,ii){(function(d){va.exports=d()})(function(){return function(){function d(re,ne,w){function c(e,a){if(!ne[e]){if(!re[e]){var n=typeof th=="function"&&th;if(!a&&n)return n(e,!0);if(M)return M(e,!0);var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}var t=ne[e]={exports:{}};re[e][0].call(t.exports,function(f){var o=re[e][1][f];return c(o||f)},t,t.exports,d,re,ne,w)}return ne[e].exports}for(var M=typeof th=="function"&&th,T=0;T<w.length;T++)c(w[T]);return c}return d}()({1:[function(d,re,ne){var w=d("../src/lib"),c={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:#fff;","X .select-outline-2":"stroke:#000;stroke-dasharray:2px 2px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var M in c){var T=M.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");w.addStyleRule(T,c[M])}},{"../src/lib":503}],2:[function(d,re,ne){re.exports=d("../src/transforms/aggregate")},{"../src/transforms/aggregate":1118}],3:[function(d,re,ne){re.exports=d("../src/traces/bar")},{"../src/traces/bar":656}],4:[function(d,re,ne){re.exports=d("../src/traces/barpolar")},{"../src/traces/barpolar":669}],5:[function(d,re,ne){re.exports=d("../src/traces/box")},{"../src/traces/box":679}],6:[function(d,re,ne){re.exports=d("../src/components/calendars")},{"../src/components/calendars":364}],7:[function(d,re,ne){re.exports=d("../src/traces/candlestick")},{"../src/traces/candlestick":688}],8:[function(d,re,ne){re.exports=d("../src/traces/carpet")},{"../src/traces/carpet":707}],9:[function(d,re,ne){re.exports=d("../src/traces/choropleth")},{"../src/traces/choropleth":721}],10:[function(d,re,ne){re.exports=d("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":728}],11:[function(d,re,ne){re.exports=d("../src/traces/cone")},{"../src/traces/cone":734}],12:[function(d,re,ne){re.exports=d("../src/traces/contour")},{"../src/traces/contour":749}],13:[function(d,re,ne){re.exports=d("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":760}],14:[function(d,re,ne){re.exports=d("../src/core")},{"../src/core":481}],15:[function(d,re,ne){re.exports=d("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":768}],16:[function(d,re,ne){re.exports=d("../src/transforms/filter")},{"../src/transforms/filter":1119}],17:[function(d,re,ne){re.exports=d("../src/traces/funnel")},{"../src/traces/funnel":778}],18:[function(d,re,ne){re.exports=d("../src/traces/funnelarea")},{"../src/traces/funnelarea":787}],19:[function(d,re,ne){re.exports=d("../src/transforms/groupby")},{"../src/transforms/groupby":1120}],20:[function(d,re,ne){re.exports=d("../src/traces/heatmap")},{"../src/traces/heatmap":800}],21:[function(d,re,ne){re.exports=d("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":811}],22:[function(d,re,ne){re.exports=d("../src/traces/histogram")},{"../src/traces/histogram":823}],23:[function(d,re,ne){re.exports=d("../src/traces/histogram2d")},{"../src/traces/histogram2d":829}],24:[function(d,re,ne){re.exports=d("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":833}],25:[function(d,re,ne){re.exports=d("../src/traces/icicle")},{"../src/traces/icicle":839}],26:[function(d,re,ne){re.exports=d("../src/traces/image")},{"../src/traces/image":852}],27:[function(d,re,ne){var w=d("./core");w.register([d("./bar"),d("./box"),d("./heatmap"),d("./histogram"),d("./histogram2d"),d("./histogram2dcontour"),d("./contour"),d("./scatterternary"),d("./violin"),d("./funnel"),d("./waterfall"),d("./image"),d("./pie"),d("./sunburst"),d("./treemap"),d("./icicle"),d("./funnelarea"),d("./scatter3d"),d("./surface"),d("./isosurface"),d("./volume"),d("./mesh3d"),d("./cone"),d("./streamtube"),d("./scattergeo"),d("./choropleth"),d("./scattergl"),d("./splom"),d("./pointcloud"),d("./heatmapgl"),d("./parcoords"),d("./parcats"),d("./scattermapbox"),d("./choroplethmapbox"),d("./densitymapbox"),d("./sankey"),d("./indicator"),d("./table"),d("./carpet"),d("./scattercarpet"),d("./contourcarpet"),d("./ohlc"),d("./candlestick"),d("./scatterpolar"),d("./scatterpolargl"),d("./barpolar"),d("./scattersmith"),d("./aggregate"),d("./filter"),d("./groupby"),d("./sort"),d("./calendars")]),re.exports=w},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(d,re,ne){re.exports=d("../src/traces/indicator")},{"../src/traces/indicator":860}],29:[function(d,re,ne){re.exports=d("../src/traces/isosurface")},{"../src/traces/isosurface":866}],30:[function(d,re,ne){re.exports=d("../src/traces/mesh3d")},{"../src/traces/mesh3d":871}],31:[function(d,re,ne){re.exports=d("../src/traces/ohlc")},{"../src/traces/ohlc":876}],32:[function(d,re,ne){re.exports=d("../src/traces/parcats")},{"../src/traces/parcats":885}],33:[function(d,re,ne){re.exports=d("../src/traces/parcoords")},{"../src/traces/parcoords":896}],34:[function(d,re,ne){re.exports=d("../src/traces/pie")},{"../src/traces/pie":907}],35:[function(d,re,ne){re.exports=d("../src/traces/pointcloud")},{"../src/traces/pointcloud":916}],36:[function(d,re,ne){re.exports=d("../src/traces/sankey")},{"../src/traces/sankey":922}],37:[function(d,re,ne){re.exports=d("../src/traces/scatter3d")},{"../src/traces/scatter3d":960}],38:[function(d,re,ne){re.exports=d("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":967}],39:[function(d,re,ne){re.exports=d("../src/traces/scattergeo")},{"../src/traces/scattergeo":975}],40:[function(d,re,ne){re.exports=d("../src/traces/scattergl")},{"../src/traces/scattergl":989}],41:[function(d,re,ne){re.exports=d("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":999}],42:[function(d,re,ne){re.exports=d("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1007}],43:[function(d,re,ne){re.exports=d("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1015}],44:[function(d,re,ne){re.exports=d("../src/traces/scattersmith")},{"../src/traces/scattersmith":1022}],45:[function(d,re,ne){re.exports=d("../src/traces/scatterternary")},{"../src/traces/scatterternary":1030}],46:[function(d,re,ne){re.exports=d("../src/transforms/sort")},{"../src/transforms/sort":1122}],47:[function(d,re,ne){re.exports=d("../src/traces/splom")},{"../src/traces/splom":1040}],48:[function(d,re,ne){re.exports=d("../src/traces/streamtube")},{"../src/traces/streamtube":1048}],49:[function(d,re,ne){re.exports=d("../src/traces/sunburst")},{"../src/traces/sunburst":1056}],50:[function(d,re,ne){re.exports=d("../src/traces/surface")},{"../src/traces/surface":1065}],51:[function(d,re,ne){re.exports=d("../src/traces/table")},{"../src/traces/table":1073}],52:[function(d,re,ne){re.exports=d("../src/traces/treemap")},{"../src/traces/treemap":1084}],53:[function(d,re,ne){re.exports=d("../src/traces/violin")},{"../src/traces/violin":1097}],54:[function(d,re,ne){re.exports=d("../src/traces/volume")},{"../src/traces/volume":1105}],55:[function(d,re,ne){re.exports=d("../src/traces/waterfall")},{"../src/traces/waterfall":1113}],56:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne,d("d3-array"),d("d3-collection"),d("d3-shape"),d("elementary-circuits-directed-graph")):c(w.d3=w.d3||{},w.d3,w.d3,w.d3,null)})(this,function(w,c,M,T,e){e=e&&e.hasOwnProperty("default")?e.default:e;function a(fe){return fe.target.depth}function n(fe){return fe.depth}function r(fe,pe){return pe-1-fe.height}function t(fe,pe){return fe.sourceLinks.length?fe.depth:pe-1}function f(fe){return fe.targetLinks.length?fe.depth:fe.sourceLinks.length?c.min(fe.sourceLinks,a)-1:0}function o(fe){return function(){return fe}}var i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(fe){return typeof fe}:function(fe){return fe&&typeof Symbol=="function"&&fe.constructor===Symbol&&fe!==Symbol.prototype?"symbol":typeof fe};function g(fe,pe){return y(fe.source,pe.source)||fe.index-pe.index}function p(fe,pe){return y(fe.target,pe.target)||fe.index-pe.index}function y(fe,pe){return fe.partOfCycle===pe.partOfCycle?fe.y0-pe.y0:fe.circularLinkType==="top"||pe.circularLinkType==="bottom"?-1:1}function h(fe){return fe.value}function m(fe){return(fe.y0+fe.y1)/2}function u(fe){return m(fe.source)}function _(fe){return m(fe.target)}function s(fe){return fe.index}function A(fe){return fe.nodes}function x(fe){return fe.links}function v(fe,pe){var ge=fe.get(pe);if(!ge)throw new Error("missing: "+pe);return ge}function b(fe,pe){return pe(fe)}var l=25,L=10,S=.3;function k(){var fe=0,pe=0,ge=1,Ae=1,we=24,De,Be=s,Ve=t,xe=A,Le=x,He=32,Je=2,Oe,Pe=null;function Ue(){var Tt={nodes:xe.apply(null,arguments),links:Le.apply(null,arguments)};vt(Tt),P(Tt,Be,Pe),Lt(Tt),Rt(Tt),z(Tt,Be),Bt(Tt,He,Be),Mt(Tt);for(var at=4,ct=0;ct<at;ct++)Z(Tt,Ae,Be),ee(Tt,Ae,Be),q(Tt,pe,Ae,Be),Z(Tt,Ae,Be),ee(Tt,Ae,Be);return ye(Tt,pe,Ae),V(Tt,Je,Ae,Be),Tt}Ue.nodeId=function(Tt){return arguments.length?(Be=typeof Tt=="function"?Tt:o(Tt),Ue):Be},Ue.nodeAlign=function(Tt){return arguments.length?(Ve=typeof Tt=="function"?Tt:o(Tt),Ue):Ve},Ue.nodeWidth=function(Tt){return arguments.length?(we=+Tt,Ue):we},Ue.nodePadding=function(Tt){return arguments.length?(De=+Tt,Ue):De},Ue.nodes=function(Tt){return arguments.length?(xe=typeof Tt=="function"?Tt:o(Tt),Ue):xe},Ue.links=function(Tt){return arguments.length?(Le=typeof Tt=="function"?Tt:o(Tt),Ue):Le},Ue.size=function(Tt){return arguments.length?(fe=pe=0,ge=+Tt[0],Ae=+Tt[1],Ue):[ge-fe,Ae-pe]},Ue.extent=function(Tt){return arguments.length?(fe=+Tt[0][0],ge=+Tt[1][0],pe=+Tt[0][1],Ae=+Tt[1][1],Ue):[[fe,pe],[ge,Ae]]},Ue.iterations=function(Tt){return arguments.length?(He=+Tt,Ue):He},Ue.circularLinkGap=function(Tt){return arguments.length?(Je=+Tt,Ue):Je},Ue.nodePaddingRatio=function(Tt){return arguments.length?(Oe=+Tt,Ue):Oe},Ue.sortNodes=function(Tt){return arguments.length?(Pe=Tt,Ue):Pe},Ue.update=function(Tt){return z(Tt,Be),Mt(Tt),Tt.links.forEach(function(at){at.circular&&(at.circularLinkType=at.y0+at.y1<Ae?"top":"bottom",at.source.circularLinkType=at.circularLinkType,at.target.circularLinkType=at.circularLinkType)}),Z(Tt,Ae,Be,!1),ee(Tt,Ae,Be),V(Tt,Je,Ae,Be),Tt};function vt(Tt){Tt.nodes.forEach(function(ct,je){ct.index=je,ct.sourceLinks=[],ct.targetLinks=[]});var at=M.map(Tt.nodes,Be);return Tt.links.forEach(function(ct,je){ct.index=je;var ke=ct.source,Ye=ct.target;(typeof ke=="undefined"?"undefined":i(ke))!=="object"&&(ke=ct.source=v(at,ke)),(typeof Ye=="undefined"?"undefined":i(Ye))!=="object"&&(Ye=ct.target=v(at,Ye)),ke.sourceLinks.push(ct),Ye.targetLinks.push(ct)}),Tt}function Lt(Tt){Tt.nodes.forEach(function(at){at.partOfCycle=!1,at.value=Math.max(c.sum(at.sourceLinks,h),c.sum(at.targetLinks,h)),at.sourceLinks.forEach(function(ct){ct.circular&&(at.partOfCycle=!0,at.circularLinkType=ct.circularLinkType)}),at.targetLinks.forEach(function(ct){ct.circular&&(at.partOfCycle=!0,at.circularLinkType=ct.circularLinkType)})})}function Yt(Tt){var at=0,ct=0,je=0,ke=0,Ye=c.max(Tt.nodes,function(Ke){return Ke.column});return Tt.links.forEach(function(Ke){Ke.circular&&(Ke.circularLinkType=="top"?at=at+Ke.width:ct=ct+Ke.width,Ke.target.column==0&&(ke=ke+Ke.width),Ke.source.column==Ye&&(je=je+Ke.width))}),at=at>0?at+l+L:at,ct=ct>0?ct+l+L:ct,je=je>0?je+l+L:je,ke=ke>0?ke+l+L:ke,{top:at,bottom:ct,left:ke,right:je}}function At(Tt,at){var ct=c.max(Tt.nodes,function(bt){return bt.column}),je=ge-fe,ke=Ae-pe,Ye=je+at.right+at.left,Ke=ke+at.top+at.bottom,st=je/Ye,Et=ke/Ke;return fe=fe*st+at.left,ge=at.right==0?ge:ge*st,pe=pe*Et+at.top,Ae=Ae*Et,Tt.nodes.forEach(function(bt){bt.x0=fe+bt.column*((ge-fe-we)/ct),bt.x1=bt.x0+we}),Et}function Rt(Tt){var at,ct,je;for(at=Tt.nodes,ct=[],je=0;at.length;++je,at=ct,ct=[])at.forEach(function(ke){ke.depth=je,ke.sourceLinks.forEach(function(Ye){ct.indexOf(Ye.target)<0&&!Ye.circular&&ct.push(Ye.target)})});for(at=Tt.nodes,ct=[],je=0;at.length;++je,at=ct,ct=[])at.forEach(function(ke){ke.height=je,ke.targetLinks.forEach(function(Ye){ct.indexOf(Ye.source)<0&&!Ye.circular&&ct.push(Ye.source)})});Tt.nodes.forEach(function(ke){ke.column=Math.floor(Ve.call(null,ke,je))})}function Bt(Tt,at,ct){var je=M.nest().key(function(bt){return bt.column}).sortKeys(c.ascending).entries(Tt.nodes).map(function(bt){return bt.values});Ke(ct),Et();for(var ke=1,Ye=at;Ye>0;--Ye)st(ke*=.99,ct),Et();function Ke(bt){if(Oe){var zt=1/0;je.forEach(function(tr){var qt=Ae*Oe/(tr.length+1);zt=qt<zt?qt:zt}),De=zt}var $t=c.min(je,function(tr){return(Ae-pe-(tr.length-1)*De)/c.sum(tr,h)});$t=$t*S,Tt.links.forEach(function(tr){tr.width=tr.value*$t});var Ot=Yt(Tt),Qt=At(Tt,Ot);$t=$t*Qt,Tt.links.forEach(function(tr){tr.width=tr.value*$t}),je.forEach(function(tr){var qt=tr.length;tr.forEach(function(lr,Wr){lr.depth==je.length-1&&qt==1||lr.depth==0&&qt==1?(lr.y0=Ae/2-lr.value*$t,lr.y1=lr.y0+lr.value*$t):lr.partOfCycle?R(lr,bt)==0?(lr.y0=Ae/2+Wr,lr.y1=lr.y0+lr.value*$t):lr.circularLinkType=="top"?(lr.y0=pe+Wr,lr.y1=lr.y0+lr.value*$t):(lr.y0=Ae-lr.value*$t-Wr,lr.y1=lr.y0+lr.value*$t):Ot.top==0||Ot.bottom==0?(lr.y0=(Ae-pe)/qt*Wr,lr.y1=lr.y0+lr.value*$t):(lr.y0=(Ae-pe)/2-qt/2+Wr,lr.y1=lr.y0+lr.value*$t)})})}function st(bt,zt){var $t=je.length;je.forEach(function(Ot){var Qt=Ot.length,tr=Ot[0].depth;Ot.forEach(function(qt){var lr;if((qt.sourceLinks.length||qt.targetLinks.length)&&!(qt.partOfCycle&&R(qt,zt)>0))if(tr==0&&Qt==1)lr=qt.y1-qt.y0,qt.y0=Ae/2-lr/2,qt.y1=Ae/2+lr/2;else if(tr==$t-1&&Qt==1)lr=qt.y1-qt.y0,qt.y0=Ae/2-lr/2,qt.y1=Ae/2+lr/2;else{var Wr=0,cn=c.mean(qt.sourceLinks,_),Jr=c.mean(qt.targetLinks,u);cn&&Jr?Wr=(cn+Jr)/2:Wr=cn||Jr;var ot=(Wr-m(qt))*bt;qt.y0+=ot,qt.y1+=ot}})})}function Et(){je.forEach(function(bt){var zt,$t,Ot=pe,Qt=bt.length,tr;for(bt.sort(y),tr=0;tr<Qt;++tr)zt=bt[tr],$t=Ot-zt.y0,$t>0&&(zt.y0+=$t,zt.y1+=$t),Ot=zt.y1+De;if($t=Ot-De-Ae,$t>0)for(Ot=zt.y0-=$t,zt.y1-=$t,tr=Qt-2;tr>=0;--tr)zt=bt[tr],$t=zt.y1+De-Ot,$t>0&&(zt.y0-=$t,zt.y1-=$t),Ot=zt.y0})}}function Mt(Tt){Tt.nodes.forEach(function(at){at.sourceLinks.sort(p),at.targetLinks.sort(g)}),Tt.nodes.forEach(function(at){var ct=at.y0,je=ct,ke=at.y1,Ye=ke;at.sourceLinks.forEach(function(Ke){Ke.circular?(Ke.y0=ke-Ke.width/2,ke=ke-Ke.width):(Ke.y0=ct+Ke.width/2,ct+=Ke.width)}),at.targetLinks.forEach(function(Ke){Ke.circular?(Ke.y1=Ye-Ke.width/2,Ye=Ye-Ke.width):(Ke.y1=je+Ke.width/2,je+=Ke.width)})})}return Ue}function P(fe,pe,ge){var Ae=0;if(ge===null){for(var we=[],De=0;De<fe.links.length;De++){var Be=fe.links[De],Ve=Be.source.index,xe=Be.target.index;we[Ve]||(we[Ve]=[]),we[xe]||(we[xe]=[]),we[Ve].indexOf(xe)===-1&&we[Ve].push(xe)}var Le=e(we);Le.sort(function(Pe,Ue){return Pe.length-Ue.length});var He={};for(De=0;De<Le.length;De++){var Je=Le[De],Oe=Je.slice(-2);He[Oe[0]]||(He[Oe[0]]={}),He[Oe[0]][Oe[1]]=!0}fe.links.forEach(function(Pe){var Ue=Pe.target.index,vt=Pe.source.index;Ue===vt||He[vt]&&He[vt][Ue]?(Pe.circular=!0,Pe.circularLinkID=Ae,Ae=Ae+1):Pe.circular=!1})}else fe.links.forEach(function(Pe){Pe.source[ge]<Pe.target[ge]?Pe.circular=!1:(Pe.circular=!0,Pe.circularLinkID=Ae,Ae=Ae+1)})}function z(fe,pe){var ge=0,Ae=0;fe.links.forEach(function(we){we.circular&&(we.source.circularLinkType||we.target.circularLinkType?we.circularLinkType=we.source.circularLinkType?we.source.circularLinkType:we.target.circularLinkType:we.circularLinkType=ge<Ae?"top":"bottom",we.circularLinkType=="top"?ge=ge+1:Ae=Ae+1,fe.nodes.forEach(function(De){(b(De,pe)==b(we.source,pe)||b(De,pe)==b(we.target,pe))&&(De.circularLinkType=we.circularLinkType)}))}),fe.links.forEach(function(we){we.circular&&(we.source.circularLinkType==we.target.circularLinkType&&(we.circularLinkType=we.source.circularLinkType),le(we,pe)&&(we.circularLinkType=we.source.circularLinkType))})}function I(fe){var pe=Math.abs(fe.y1-fe.y0),ge=Math.abs(fe.target.x0-fe.source.x1);return Math.atan(ge/pe)}function D(fe,pe){return fe.source.column<pe.target.column?!1:!(fe.target.column>pe.source.column)}function R(fe,pe){var ge=0;fe.sourceLinks.forEach(function(we){ge=we.circular&&!le(we,pe)?ge+1:ge});var Ae=0;return fe.targetLinks.forEach(function(we){Ae=we.circular&&!le(we,pe)?Ae+1:Ae}),ge+Ae}function B(fe){var pe=fe.source.sourceLinks,ge=0;pe.forEach(function(De){ge=De.circular?ge+1:ge});var Ae=fe.target.targetLinks,we=0;return Ae.forEach(function(De){we=De.circular?we+1:we}),!(ge>1||we>1)}function F(fe,pe,ge){return fe.sort(J),fe.forEach(function(Ae,we){var De=0;if(le(Ae,ge)&&B(Ae))Ae.circularPathData.verticalBuffer=De+Ae.width/2;else{var Be=0;for(Be;Be<we;Be++)if(D(fe[we],fe[Be])){var Ve=fe[Be].circularPathData.verticalBuffer+fe[Be].width/2+pe;De=Ve>De?Ve:De}Ae.circularPathData.verticalBuffer=De+Ae.width/2}}),fe}function V(fe,pe,ge,Ae){var we=5,De=c.min(fe.links,function(xe){return xe.source.y0});fe.links.forEach(function(xe){xe.circular&&(xe.circularPathData={})});var Be=fe.links.filter(function(xe){return xe.circularLinkType=="top"});F(Be,pe,Ae);var Ve=fe.links.filter(function(xe){return xe.circularLinkType=="bottom"});F(Ve,pe,Ae),fe.links.forEach(function(xe){if(xe.circular){if(xe.circularPathData.arcRadius=xe.width+L,xe.circularPathData.leftNodeBuffer=we,xe.circularPathData.rightNodeBuffer=we,xe.circularPathData.sourceWidth=xe.source.x1-xe.source.x0,xe.circularPathData.sourceX=xe.source.x0+xe.circularPathData.sourceWidth,xe.circularPathData.targetX=xe.target.x0,xe.circularPathData.sourceY=xe.y0,xe.circularPathData.targetY=xe.y1,le(xe,Ae)&&B(xe))xe.circularPathData.leftSmallArcRadius=L+xe.width/2,xe.circularPathData.leftLargeArcRadius=L+xe.width/2,xe.circularPathData.rightSmallArcRadius=L+xe.width/2,xe.circularPathData.rightLargeArcRadius=L+xe.width/2,xe.circularLinkType=="bottom"?(xe.circularPathData.verticalFullExtent=xe.source.y1+l+xe.circularPathData.verticalBuffer,xe.circularPathData.verticalLeftInnerExtent=xe.circularPathData.verticalFullExtent-xe.circularPathData.leftLargeArcRadius,xe.circularPathData.verticalRightInnerExtent=xe.circularPathData.verticalFullExtent-xe.circularPathData.rightLargeArcRadius):(xe.circularPathData.verticalFullExtent=xe.source.y0-l-xe.circularPathData.verticalBuffer,xe.circularPathData.verticalLeftInnerExtent=xe.circularPathData.verticalFullExtent+xe.circularPathData.leftLargeArcRadius,xe.circularPathData.verticalRightInnerExtent=xe.circularPathData.verticalFullExtent+xe.circularPathData.rightLargeArcRadius);else{var Le=xe.source.column,He=xe.circularLinkType,Je=fe.links.filter(function(Ue){return Ue.source.column==Le&&Ue.circularLinkType==He});xe.circularLinkType=="bottom"?Je.sort(Y):Je.sort(j);var Oe=0;Je.forEach(function(Ue,vt){Ue.circularLinkID==xe.circularLinkID&&(xe.circularPathData.leftSmallArcRadius=L+xe.width/2+Oe,xe.circularPathData.leftLargeArcRadius=L+xe.width/2+vt*pe+Oe),Oe=Oe+Ue.width}),Le=xe.target.column,Je=fe.links.filter(function(Ue){return Ue.target.column==Le&&Ue.circularLinkType==He}),xe.circularLinkType=="bottom"?Je.sort(oe):Je.sort(X),Oe=0,Je.forEach(function(Ue,vt){Ue.circularLinkID==xe.circularLinkID&&(xe.circularPathData.rightSmallArcRadius=L+xe.width/2+Oe,xe.circularPathData.rightLargeArcRadius=L+xe.width/2+vt*pe+Oe),Oe=Oe+Ue.width}),xe.circularLinkType=="bottom"?(xe.circularPathData.verticalFullExtent=Math.max(ge,xe.source.y1,xe.target.y1)+l+xe.circularPathData.verticalBuffer,xe.circularPathData.verticalLeftInnerExtent=xe.circularPathData.verticalFullExtent-xe.circularPathData.leftLargeArcRadius,xe.circularPathData.verticalRightInnerExtent=xe.circularPathData.verticalFullExtent-xe.circularPathData.rightLargeArcRadius):(xe.circularPathData.verticalFullExtent=De-l-xe.circularPathData.verticalBuffer,xe.circularPathData.verticalLeftInnerExtent=xe.circularPathData.verticalFullExtent+xe.circularPathData.leftLargeArcRadius,xe.circularPathData.verticalRightInnerExtent=xe.circularPathData.verticalFullExtent+xe.circularPathData.rightLargeArcRadius)}xe.circularPathData.leftInnerExtent=xe.circularPathData.sourceX+xe.circularPathData.leftNodeBuffer,xe.circularPathData.rightInnerExtent=xe.circularPathData.targetX-xe.circularPathData.rightNodeBuffer,xe.circularPathData.leftFullExtent=xe.circularPathData.sourceX+xe.circularPathData.leftLargeArcRadius+xe.circularPathData.leftNodeBuffer,xe.circularPathData.rightFullExtent=xe.circularPathData.targetX-xe.circularPathData.rightLargeArcRadius-xe.circularPathData.rightNodeBuffer}if(xe.circular)xe.path=G(xe);else{var Pe=T.linkHorizontal().source(function(Ue){var vt=Ue.source.x0+(Ue.source.x1-Ue.source.x0),Lt=Ue.y0;return[vt,Lt]}).target(function(Ue){var vt=Ue.target.x0,Lt=Ue.y1;return[vt,Lt]});xe.path=Pe(xe)}})}function G(fe){var pe="";return fe.circularLinkType=="top"?pe="M"+fe.circularPathData.sourceX+" "+fe.circularPathData.sourceY+" L"+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.sourceY+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftSmallArcRadius+" 0 0 0 "+fe.circularPathData.leftFullExtent+" "+(fe.circularPathData.sourceY-fe.circularPathData.leftSmallArcRadius)+" L"+fe.circularPathData.leftFullExtent+" "+fe.circularPathData.verticalLeftInnerExtent+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftLargeArcRadius+" 0 0 0 "+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.verticalFullExtent+" L"+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.verticalFullExtent+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightLargeArcRadius+" 0 0 0 "+fe.circularPathData.rightFullExtent+" "+fe.circularPathData.verticalRightInnerExtent+" L"+fe.circularPathData.rightFullExtent+" "+(fe.circularPathData.targetY-fe.circularPathData.rightSmallArcRadius)+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightSmallArcRadius+" 0 0 0 "+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.targetY+" L"+fe.circularPathData.targetX+" "+fe.circularPathData.targetY:pe="M"+fe.circularPathData.sourceX+" "+fe.circularPathData.sourceY+" L"+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.sourceY+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftSmallArcRadius+" 0 0 1 "+fe.circularPathData.leftFullExtent+" "+(fe.circularPathData.sourceY+fe.circularPathData.leftSmallArcRadius)+" L"+fe.circularPathData.leftFullExtent+" "+fe.circularPathData.verticalLeftInnerExtent+" A"+fe.circularPathData.leftLargeArcRadius+" "+fe.circularPathData.leftLargeArcRadius+" 0 0 1 "+fe.circularPathData.leftInnerExtent+" "+fe.circularPathData.verticalFullExtent+" L"+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.verticalFullExtent+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightLargeArcRadius+" 0 0 1 "+fe.circularPathData.rightFullExtent+" "+fe.circularPathData.verticalRightInnerExtent+" L"+fe.circularPathData.rightFullExtent+" "+(fe.circularPathData.targetY+fe.circularPathData.rightSmallArcRadius)+" A"+fe.circularPathData.rightLargeArcRadius+" "+fe.circularPathData.rightSmallArcRadius+" 0 0 1 "+fe.circularPathData.rightInnerExtent+" "+fe.circularPathData.targetY+" L"+fe.circularPathData.targetX+" "+fe.circularPathData.targetY,pe}function J(fe,pe){return se(fe)==se(pe)?fe.circularLinkType=="bottom"?Y(fe,pe):j(fe,pe):se(pe)-se(fe)}function j(fe,pe){return fe.y0-pe.y0}function Y(fe,pe){return pe.y0-fe.y0}function X(fe,pe){return fe.y1-pe.y1}function oe(fe,pe){return pe.y1-fe.y1}function se(fe){return fe.target.column-fe.source.column}function ie(fe){return fe.target.x0-fe.source.x1}function N(fe,pe){var ge=I(fe),Ae=ie(pe)/Math.tan(ge),we=ae(fe)=="up"?fe.y1+Ae:fe.y1-Ae;return we}function U(fe,pe){var ge=I(fe),Ae=ie(pe)/Math.tan(ge),we=ae(fe)=="up"?fe.y1-Ae:fe.y1+Ae;return we}function q(fe,pe,ge,Ae){fe.links.forEach(function(we){if(!we.circular&&we.target.column-we.source.column>1){var De=we.source.column+1,Be=we.target.column-1,Ve=1,xe=Be-De+1;for(Ve=1;De<=Be;De++,Ve++)fe.nodes.forEach(function(Le){if(Le.column==De){var He=Ve/(xe+1),Je=Math.pow(1-He,3),Oe=3*He*Math.pow(1-He,2),Pe=3*Math.pow(He,2)*(1-He),Ue=Math.pow(He,3),vt=Je*we.y0+Oe*we.y0+Pe*we.y1+Ue*we.y1,Lt=vt-we.width/2,Yt=vt+we.width/2,At;Lt>Le.y0&&Lt<Le.y1?(At=Le.y1-Lt+10,At=Le.circularLinkType=="bottom"?At:-At,Le=W(Le,At,pe,ge),fe.nodes.forEach(function(Rt){b(Rt,Ae)==b(Le,Ae)||Rt.column!=Le.column||Q(Le,Rt)&&W(Rt,At,pe,ge)})):Yt>Le.y0&&Yt<Le.y1?(At=Yt-Le.y0+10,Le=W(Le,At,pe,ge),fe.nodes.forEach(function(Rt){b(Rt,Ae)==b(Le,Ae)||Rt.column!=Le.column||Rt.y0<Le.y1&&Rt.y1>Le.y1&&W(Rt,At,pe,ge)})):Lt<Le.y0&&Yt>Le.y1&&(At=Yt-Le.y0+10,Le=W(Le,At,pe,ge),fe.nodes.forEach(function(Rt){b(Rt,Ae)==b(Le,Ae)||Rt.column!=Le.column||Rt.y0<Le.y1&&Rt.y1>Le.y1&&W(Rt,At,pe,ge)}))}})}})}function Q(fe,pe){return fe.y0>pe.y0&&fe.y0<pe.y1||fe.y1>pe.y0&&fe.y1<pe.y1?!0:fe.y0<pe.y0&&fe.y1>pe.y1}function W(fe,pe,ge,Ae){return fe.y0+pe>=ge&&fe.y1+pe<=Ae&&(fe.y0=fe.y0+pe,fe.y1=fe.y1+pe,fe.targetLinks.forEach(function(we){we.y1=we.y1+pe}),fe.sourceLinks.forEach(function(we){we.y0=we.y0+pe})),fe}function Z(fe,pe,ge,Ae){fe.nodes.forEach(function(we){Ae&&we.y+(we.y1-we.y0)>pe&&(we.y=we.y-(we.y+(we.y1-we.y0)-pe));var De=fe.links.filter(function(xe){return b(xe.source,ge)==b(we,ge)}),Be=De.length;Be>1&&De.sort(function(xe,Le){if(!xe.circular&&!Le.circular){if(xe.target.column==Le.target.column)return xe.y1-Le.y1;if(te(xe,Le)){if(xe.target.column>Le.target.column){var He=U(Le,xe);return xe.y1-He}if(Le.target.column>xe.target.column){var Je=U(xe,Le);return Je-Le.y1}}else return xe.y1-Le.y1}if(xe.circular&&!Le.circular)return xe.circularLinkType=="top"?-1:1;if(Le.circular&&!xe.circular)return Le.circularLinkType=="top"?1:-1;if(xe.circular&&Le.circular)return xe.circularLinkType===Le.circularLinkType&&xe.circularLinkType=="top"?xe.target.column===Le.target.column?xe.target.y1-Le.target.y1:Le.target.column-xe.target.column:xe.circularLinkType===Le.circularLinkType&&xe.circularLinkType=="bottom"?xe.target.column===Le.target.column?Le.target.y1-xe.target.y1:xe.target.column-Le.target.column:xe.circularLinkType=="top"?-1:1});var Ve=we.y0;De.forEach(function(xe){xe.y0=Ve+xe.width/2,Ve=Ve+xe.width}),De.forEach(function(xe,Le){if(xe.circularLinkType=="bottom"){var He=Le+1,Je=0;for(He;He<Be;He++)Je=Je+De[He].width;xe.y0=we.y1-Je-xe.width/2}})})}function ee(fe,pe,ge){fe.nodes.forEach(function(Ae){var we=fe.links.filter(function(Ve){return b(Ve.target,ge)==b(Ae,ge)}),De=we.length;De>1&&we.sort(function(Ve,xe){if(!Ve.circular&&!xe.circular){if(Ve.source.column==xe.source.column)return Ve.y0-xe.y0;if(te(Ve,xe)){if(xe.source.column<Ve.source.column){var Le=N(xe,Ve);return Ve.y0-Le}if(Ve.source.column<xe.source.column){var He=N(Ve,xe);return He-xe.y0}}else return Ve.y0-xe.y0}if(Ve.circular&&!xe.circular)return Ve.circularLinkType=="top"?-1:1;if(xe.circular&&!Ve.circular)return xe.circularLinkType=="top"?1:-1;if(Ve.circular&&xe.circular)return Ve.circularLinkType===xe.circularLinkType&&Ve.circularLinkType=="top"?Ve.source.column===xe.source.column?Ve.source.y1-xe.source.y1:Ve.source.column-xe.source.column:Ve.circularLinkType===xe.circularLinkType&&Ve.circularLinkType=="bottom"?Ve.source.column===xe.source.column?Ve.source.y1-xe.source.y1:xe.source.column-Ve.source.column:Ve.circularLinkType=="top"?-1:1});var Be=Ae.y0;we.forEach(function(Ve){Ve.y1=Be+Ve.width/2,Be=Be+Ve.width}),we.forEach(function(Ve,xe){if(Ve.circularLinkType=="bottom"){var Le=xe+1,He=0;for(Le;Le<De;Le++)He=He+we[Le].width;Ve.y1=Ae.y1-He-Ve.width/2}})})}function te(fe,pe){return ae(fe)==ae(pe)}function ae(fe){return fe.y0-fe.y1>0?"up":"down"}function le(fe,pe){return b(fe.source,pe)==b(fe.target,pe)}function ye(fe,pe,ge){var Ae=fe.nodes,we=fe.links,De=!1,Be=!1;if(we.forEach(function(Oe){Oe.circularLinkType=="top"?De=!0:Oe.circularLinkType=="bottom"&&(Be=!0)}),De==!1||Be==!1){var Ve=c.min(Ae,function(Oe){return Oe.y0}),xe=c.max(Ae,function(Oe){return Oe.y1}),Le=xe-Ve,He=ge-pe,Je=He/Le;Ae.forEach(function(Oe){var Pe=(Oe.y1-Oe.y0)*Je;Oe.y0=(Oe.y0-Ve)*Je,Oe.y1=Oe.y0+Pe}),we.forEach(function(Oe){Oe.y0=(Oe.y0-Ve)*Je,Oe.y1=(Oe.y1-Ve)*Je,Oe.width=Oe.width*Je})}}w.sankeyCircular=k,w.sankeyCenter=f,w.sankeyLeft=n,w.sankeyRight=r,w.sankeyJustify=t,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne,d("d3-array"),d("d3-collection"),d("d3-shape")):c(w.d3=w.d3||{},w.d3,w.d3,w.d3)})(this,function(w,c,M,T){function e(L){return L.target.depth}function a(L){return L.depth}function n(L,S){return S-1-L.height}function r(L,S){return L.sourceLinks.length?L.depth:S-1}function t(L){return L.targetLinks.length?L.depth:L.sourceLinks.length?c.min(L.sourceLinks,e)-1:0}function f(L){return function(){return L}}function o(L,S){return g(L.source,S.source)||L.index-S.index}function i(L,S){return g(L.target,S.target)||L.index-S.index}function g(L,S){return L.y0-S.y0}function p(L){return L.value}function y(L){return(L.y0+L.y1)/2}function h(L){return y(L.source)*L.value}function m(L){return y(L.target)*L.value}function u(L){return L.index}function _(L){return L.nodes}function s(L){return L.links}function A(L,S){var k=L.get(S);if(!k)throw new Error("missing: "+S);return k}var x=function(){var L=0,S=0,k=1,P=1,z=24,I=8,D=u,R=r,B=_,F=s,V=32,G=2/3;function J(){var ie={nodes:B.apply(null,arguments),links:F.apply(null,arguments)};return j(ie),Y(ie),X(ie),oe(ie),se(ie),ie}J.update=function(ie){return se(ie),ie},J.nodeId=function(ie){return arguments.length?(D=typeof ie=="function"?ie:f(ie),J):D},J.nodeAlign=function(ie){return arguments.length?(R=typeof ie=="function"?ie:f(ie),J):R},J.nodeWidth=function(ie){return arguments.length?(z=+ie,J):z},J.nodePadding=function(ie){return arguments.length?(I=+ie,J):I},J.nodes=function(ie){return arguments.length?(B=typeof ie=="function"?ie:f(ie),J):B},J.links=function(ie){return arguments.length?(F=typeof ie=="function"?ie:f(ie),J):F},J.size=function(ie){return arguments.length?(L=S=0,k=+ie[0],P=+ie[1],J):[k-L,P-S]},J.extent=function(ie){return arguments.length?(L=+ie[0][0],k=+ie[1][0],S=+ie[0][1],P=+ie[1][1],J):[[L,S],[k,P]]},J.iterations=function(ie){return arguments.length?(V=+ie,J):V};function j(ie){ie.nodes.forEach(function(U,q){U.index=q,U.sourceLinks=[],U.targetLinks=[]});var N=M.map(ie.nodes,D);ie.links.forEach(function(U,q){U.index=q;var Q=U.source,W=U.target;typeof Q!="object"&&(Q=U.source=A(N,Q)),typeof W!="object"&&(W=U.target=A(N,W)),Q.sourceLinks.push(U),W.targetLinks.push(U)})}function Y(ie){ie.nodes.forEach(function(N){N.value=Math.max(c.sum(N.sourceLinks,p),c.sum(N.targetLinks,p))})}function X(ie){var N,U,q;for(N=ie.nodes,U=[],q=0;N.length;++q,N=U,U=[])N.forEach(function(W){W.depth=q,W.sourceLinks.forEach(function(Z){U.indexOf(Z.target)<0&&U.push(Z.target)})});for(N=ie.nodes,U=[],q=0;N.length;++q,N=U,U=[])N.forEach(function(W){W.height=q,W.targetLinks.forEach(function(Z){U.indexOf(Z.source)<0&&U.push(Z.source)})});var Q=(k-L-z)/(q-1);ie.nodes.forEach(function(W){W.x1=(W.x0=L+Math.max(0,Math.min(q-1,Math.floor(R.call(null,W,q))))*Q)+z})}function oe(ie){var N=M.nest().key(function(te){return te.x0}).sortKeys(c.ascending).entries(ie.nodes).map(function(te){return te.values});Q(),ee();for(var U=1,q=V;q>0;--q)Z(U*=.99),ee(),W(U),ee();function Q(){var te=c.max(N,function(ye){return ye.length}),ae=G*(P-S)/(te-1);I>ae&&(I=ae);var le=c.min(N,function(ye){return(P-S-(ye.length-1)*I)/c.sum(ye,p)});N.forEach(function(ye){ye.forEach(function(fe,pe){fe.y1=(fe.y0=pe)+fe.value*le})}),ie.links.forEach(function(ye){ye.width=ye.value*le})}function W(te){N.forEach(function(ae){ae.forEach(function(le){if(le.targetLinks.length){var ye=(c.sum(le.targetLinks,h)/c.sum(le.targetLinks,p)-y(le))*te;le.y0+=ye,le.y1+=ye}})})}function Z(te){N.slice().reverse().forEach(function(ae){ae.forEach(function(le){if(le.sourceLinks.length){var ye=(c.sum(le.sourceLinks,m)/c.sum(le.sourceLinks,p)-y(le))*te;le.y0+=ye,le.y1+=ye}})})}function ee(){N.forEach(function(te){var ae,le,ye=S,fe=te.length,pe;for(te.sort(g),pe=0;pe<fe;++pe)ae=te[pe],le=ye-ae.y0,le>0&&(ae.y0+=le,ae.y1+=le),ye=ae.y1+I;if(le=ye-I-P,le>0)for(ye=ae.y0-=le,ae.y1-=le,pe=fe-2;pe>=0;--pe)ae=te[pe],le=ae.y1+I-ye,le>0&&(ae.y0-=le,ae.y1-=le),ye=ae.y0})}}function se(ie){ie.nodes.forEach(function(N){N.sourceLinks.sort(i),N.targetLinks.sort(o)}),ie.nodes.forEach(function(N){var U=N.y0,q=U;N.sourceLinks.forEach(function(Q){Q.y0=U+Q.width/2,U+=Q.width}),N.targetLinks.forEach(function(Q){Q.y1=q+Q.width/2,q+=Q.width})})}return J};function v(L){return[L.source.x1,L.y0]}function b(L){return[L.target.x0,L.y1]}var l=function(){return T.linkHorizontal().source(v).target(b)};w.sankey=x,w.sankeyCenter=t,w.sankeyLeft=a,w.sankeyRight=n,w.sankeyJustify=r,w.sankeyLinkHorizontal=l,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(d,re,ne){(function(){var w={version:"3.8.0"},c=[].slice,M=function(ue){return c.call(ue)},T=self.document;function e(ue){return ue&&(ue.ownerDocument||ue.document||ue).documentElement}function a(ue){return ue&&(ue.ownerDocument&&ue.ownerDocument.defaultView||ue.document&&ue||ue.defaultView)}if(T)try{M(T.documentElement.childNodes)[0].nodeType}catch{M=function(be){for(var Ee=be.length,Fe=new Array(Ee);Ee--;)Fe[Ee]=be[Ee];return Fe}}if(Date.now||(Date.now=function(){return+new Date}),T)try{T.createElement("DIV").style.setProperty("opacity",0,"")}catch{var n=this.Element.prototype,r=n.setAttribute,t=n.setAttributeNS,f=this.CSSStyleDeclaration.prototype,o=f.setProperty;n.setAttribute=function(be,Ee){r.call(this,be,Ee+"")},n.setAttributeNS=function(be,Ee,Fe){t.call(this,be,Ee,Fe+"")},f.setProperty=function(be,Ee,Fe){o.call(this,be,Ee+"",Fe)}}w.ascending=i;function i(ue,be){return ue<be?-1:ue>be?1:ue>=be?0:NaN}w.descending=function(ue,be){return be<ue?-1:be>ue?1:be>=ue?0:NaN},w.min=function(ue,be){var Ee=-1,Fe=ue.length,ze,Ze;if(arguments.length===1){for(;++Ee<Fe;)if((Ze=ue[Ee])!=null&&Ze>=Ze){ze=Ze;break}for(;++Ee<Fe;)(Ze=ue[Ee])!=null&&ze>Ze&&(ze=Ze)}else{for(;++Ee<Fe;)if((Ze=be.call(ue,ue[Ee],Ee))!=null&&Ze>=Ze){ze=Ze;break}for(;++Ee<Fe;)(Ze=be.call(ue,ue[Ee],Ee))!=null&&ze>Ze&&(ze=Ze)}return ze},w.max=function(ue,be){var Ee=-1,Fe=ue.length,ze,Ze;if(arguments.length===1){for(;++Ee<Fe;)if((Ze=ue[Ee])!=null&&Ze>=Ze){ze=Ze;break}for(;++Ee<Fe;)(Ze=ue[Ee])!=null&&Ze>ze&&(ze=Ze)}else{for(;++Ee<Fe;)if((Ze=be.call(ue,ue[Ee],Ee))!=null&&Ze>=Ze){ze=Ze;break}for(;++Ee<Fe;)(Ze=be.call(ue,ue[Ee],Ee))!=null&&Ze>ze&&(ze=Ze)}return ze},w.extent=function(ue,be){var Ee=-1,Fe=ue.length,ze,Ze,yt;if(arguments.length===1){for(;++Ee<Fe;)if((Ze=ue[Ee])!=null&&Ze>=Ze){ze=yt=Ze;break}for(;++Ee<Fe;)(Ze=ue[Ee])!=null&&(ze>Ze&&(ze=Ze),yt<Ze&&(yt=Ze))}else{for(;++Ee<Fe;)if((Ze=be.call(ue,ue[Ee],Ee))!=null&&Ze>=Ze){ze=yt=Ze;break}for(;++Ee<Fe;)(Ze=be.call(ue,ue[Ee],Ee))!=null&&(ze>Ze&&(ze=Ze),yt<Ze&&(yt=Ze))}return[ze,yt]};function g(ue){return ue===null?NaN:+ue}function p(ue){return!isNaN(ue)}w.sum=function(ue,be){var Ee=0,Fe=ue.length,ze,Ze=-1;if(arguments.length===1)for(;++Ze<Fe;)p(ze=+ue[Ze])&&(Ee+=ze);else for(;++Ze<Fe;)p(ze=+be.call(ue,ue[Ze],Ze))&&(Ee+=ze);return Ee},w.mean=function(ue,be){var Ee=0,Fe=ue.length,ze,Ze=-1,yt=Fe;if(arguments.length===1)for(;++Ze<Fe;)p(ze=g(ue[Ze]))?Ee+=ze:--yt;else for(;++Ze<Fe;)p(ze=g(be.call(ue,ue[Ze],Ze)))?Ee+=ze:--yt;if(yt)return Ee/yt},w.quantile=function(ue,be){var Ee=(ue.length-1)*be+1,Fe=Math.floor(Ee),ze=+ue[Fe-1],Ze=Ee-Fe;return Ze?ze+Ze*(ue[Fe]-ze):ze},w.median=function(ue,be){var Ee=[],Fe=ue.length,ze,Ze=-1;if(arguments.length===1)for(;++Ze<Fe;)p(ze=g(ue[Ze]))&&Ee.push(ze);else for(;++Ze<Fe;)p(ze=g(be.call(ue,ue[Ze],Ze)))&&Ee.push(ze);if(Ee.length)return w.quantile(Ee.sort(i),.5)},w.variance=function(ue,be){var Ee=ue.length,Fe=0,ze,Ze,yt=0,ft=-1,St=0;if(arguments.length===1)for(;++ft<Ee;)p(ze=g(ue[ft]))&&(Ze=ze-Fe,Fe+=Ze/++St,yt+=Ze*(ze-Fe));else for(;++ft<Ee;)p(ze=g(be.call(ue,ue[ft],ft)))&&(Ze=ze-Fe,Fe+=Ze/++St,yt+=Ze*(ze-Fe));if(St>1)return yt/(St-1)},w.deviation=function(){var ue=w.variance.apply(this,arguments);return ue&&Math.sqrt(ue)};function y(ue){return{left:function(be,Ee,Fe,ze){for(arguments.length<3&&(Fe=0),arguments.length<4&&(ze=be.length);Fe<ze;){var Ze=Fe+ze>>>1;ue(be[Ze],Ee)<0?Fe=Ze+1:ze=Ze}return Fe},right:function(be,Ee,Fe,ze){for(arguments.length<3&&(Fe=0),arguments.length<4&&(ze=be.length);Fe<ze;){var Ze=Fe+ze>>>1;ue(be[Ze],Ee)>0?ze=Ze:Fe=Ze+1}return Fe}}}var h=y(i);w.bisectLeft=h.left,w.bisect=w.bisectRight=h.right,w.bisector=function(ue){return y(ue.length===1?function(be,Ee){return i(ue(be),Ee)}:ue)},w.shuffle=function(ue,be,Ee){(Fe=arguments.length)<3&&(Ee=ue.length,Fe<2&&(be=0));for(var Fe=Ee-be,ze,Ze;Fe;)Ze=Math.random()*Fe--|0,ze=ue[Fe+be],ue[Fe+be]=ue[Ze+be],ue[Ze+be]=ze;return ue},w.permute=function(ue,be){for(var Ee=be.length,Fe=new Array(Ee);Ee--;)Fe[Ee]=ue[be[Ee]];return Fe},w.pairs=function(ue){for(var be=0,Ee=ue.length-1,Fe=ue[0],ze=new Array(Ee<0?0:Ee);be<Ee;)ze[be]=[Fe,Fe=ue[++be]];return ze},w.transpose=function(ue){if(!(Ze=ue.length))return[];for(var be=-1,Ee=w.min(ue,m),Fe=new Array(Ee);++be<Ee;)for(var ze=-1,Ze,yt=Fe[be]=new Array(Ze);++ze<Ze;)yt[ze]=ue[ze][be];return Fe};function m(ue){return ue.length}w.zip=function(){return w.transpose(arguments)},w.keys=function(ue){var be=[];for(var Ee in ue)be.push(Ee);return be},w.values=function(ue){var be=[];for(var Ee in ue)be.push(ue[Ee]);return be},w.entries=function(ue){var be=[];for(var Ee in ue)be.push({key:Ee,value:ue[Ee]});return be},w.merge=function(ue){for(var be=ue.length,Ee,Fe=-1,ze=0,Ze,yt;++Fe<be;)ze+=ue[Fe].length;for(Ze=new Array(ze);--be>=0;)for(yt=ue[be],Ee=yt.length;--Ee>=0;)Ze[--ze]=yt[Ee];return Ze};var u=Math.abs;w.range=function(ue,be,Ee){if(arguments.length<3&&(Ee=1,arguments.length<2&&(be=ue,ue=0)),(be-ue)/Ee===1/0)throw new Error("infinite range");var Fe=[],ze=_(u(Ee)),Ze=-1,yt;if(ue*=ze,be*=ze,Ee*=ze,Ee<0)for(;(yt=ue+Ee*++Ze)>be;)Fe.push(yt/ze);else for(;(yt=ue+Ee*++Ze)<be;)Fe.push(yt/ze);return Fe};function _(ue){for(var be=1;ue*be%1;)be*=10;return be}function s(ue,be){for(var Ee in be)Object.defineProperty(ue.prototype,Ee,{value:be[Ee],enumerable:!1})}w.map=function(ue,be){var Ee=new A;if(ue instanceof A)ue.forEach(function(ft,St){Ee.set(ft,St)});else if(Array.isArray(ue)){var Fe=-1,ze=ue.length,Ze;if(arguments.length===1)for(;++Fe<ze;)Ee.set(Fe,ue[Fe]);else for(;++Fe<ze;)Ee.set(be.call(ue,Ze=ue[Fe],Fe),Ze)}else for(var yt in ue)Ee.set(yt,ue[yt]);return Ee};function A(){this._=Object.create(null)}var x="__proto__",v="\0";s(A,{has:L,get:function(ue){return this._[b(ue)]},set:function(ue,be){return this._[b(ue)]=be},remove:S,keys:k,values:function(){var ue=[];for(var be in this._)ue.push(this._[be]);return ue},entries:function(){var ue=[];for(var be in this._)ue.push({key:l(be),value:this._[be]});return ue},size:P,empty:z,forEach:function(ue){for(var be in this._)ue.call(this,l(be),this._[be])}});function b(ue){return(ue+="")===x||ue[0]===v?v+ue:ue}function l(ue){return(ue+="")[0]===v?ue.slice(1):ue}function L(ue){return b(ue)in this._}function S(ue){return(ue=b(ue))in this._&&delete this._[ue]}function k(){var ue=[];for(var be in this._)ue.push(l(be));return ue}function P(){var ue=0;for(var be in this._)++ue;return ue}function z(){for(var ue in this._)return!1;return!0}w.nest=function(){var ue={},be=[],Ee=[],Fe,ze;function Ze(ft,St,Nt){if(Nt>=be.length)return ze?ze.call(ue,St):Fe?St.sort(Fe):St;for(var Xt=-1,Kt=St.length,br=be[Nt++],Zr,nn,Mr,zr=new A,Gr;++Xt<Kt;)(Gr=zr.get(Zr=br(nn=St[Xt])))?Gr.push(nn):zr.set(Zr,[nn]);return ft?(nn=ft(),Mr=function(qr,tn){nn.set(qr,Ze(ft,tn,Nt))}):(nn={},Mr=function(qr,tn){nn[qr]=Ze(ft,tn,Nt)}),zr.forEach(Mr),nn}function yt(ft,St){if(St>=be.length)return ft;var Nt=[],Xt=Ee[St++];return ft.forEach(function(Kt,br){Nt.push({key:Kt,values:yt(br,St)})}),Xt?Nt.sort(function(Kt,br){return Xt(Kt.key,br.key)}):Nt}return ue.map=function(ft,St){return Ze(St,ft,0)},ue.entries=function(ft){return yt(Ze(w.map,ft,0),0)},ue.key=function(ft){return be.push(ft),ue},ue.sortKeys=function(ft){return Ee[be.length-1]=ft,ue},ue.sortValues=function(ft){return Fe=ft,ue},ue.rollup=function(ft){return ze=ft,ue},ue},w.set=function(ue){var be=new I;if(ue)for(var Ee=0,Fe=ue.length;Ee<Fe;++Ee)be.add(ue[Ee]);return be};function I(){this._=Object.create(null)}s(I,{has:L,add:function(ue){return this._[b(ue+="")]=!0,ue},remove:S,values:k,size:P,empty:z,forEach:function(ue){for(var be in this._)ue.call(this,l(be))}}),w.behavior={};function D(ue){return ue}w.rebind=function(ue,be){for(var Ee=1,Fe=arguments.length,ze;++Ee<Fe;)ue[ze=arguments[Ee]]=R(ue,be,be[ze]);return ue};function R(ue,be,Ee){return function(){var Fe=Ee.apply(be,arguments);return Fe===be?ue:Fe}}function B(ue,be){if(be in ue)return be;be=be.charAt(0).toUpperCase()+be.slice(1);for(var Ee=0,Fe=F.length;Ee<Fe;++Ee){var ze=F[Ee]+be;if(ze in ue)return ze}}var F=["webkit","ms","moz","Moz","o","O"];function V(){}w.dispatch=function(){for(var ue=new G,be=-1,Ee=arguments.length;++be<Ee;)ue[arguments[be]]=J(ue);return ue};function G(){}G.prototype.on=function(ue,be){var Ee=ue.indexOf("."),Fe="";if(Ee>=0&&(Fe=ue.slice(Ee+1),ue=ue.slice(0,Ee)),ue)return arguments.length<2?this[ue].on(Fe):this[ue].on(Fe,be);if(arguments.length===2){if(be==null)for(ue in this)this.hasOwnProperty(ue)&&this[ue].on(Fe,null);return this}};function J(ue){var be=[],Ee=new A;function Fe(){for(var ze=be,Ze=-1,yt=ze.length,ft;++Ze<yt;)(ft=ze[Ze].on)&&ft.apply(this,arguments);return ue}return Fe.on=function(ze,Ze){var yt=Ee.get(ze),ft;return arguments.length<2?yt&&yt.on:(yt&&(yt.on=null,be=be.slice(0,ft=be.indexOf(yt)).concat(be.slice(ft+1)),Ee.remove(ze)),Ze&&be.push(Ee.set(ze,{on:Ze})),ue)},Fe}w.event=null;function j(){w.event.preventDefault()}function Y(){for(var ue=w.event,be;be=ue.sourceEvent;)ue=be;return ue}function X(ue){for(var be=new G,Ee=0,Fe=arguments.length;++Ee<Fe;)be[arguments[Ee]]=J(be);return be.of=function(ze,Ze){return function(yt){try{var ft=yt.sourceEvent=w.event;yt.target=ue,w.event=yt,be[yt.type].apply(ze,Ze)}finally{w.event=ft}}},be}w.requote=function(ue){return ue.replace(oe,"\\$&")};var oe=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,se={}.__proto__?function(ue,be){ue.__proto__=be}:function(ue,be){for(var Ee in be)ue[Ee]=be[Ee]};function ie(ue){return se(ue,Q),ue}var N=function(ue,be){return be.querySelector(ue)},U=function(ue,be){return be.querySelectorAll(ue)},q=function(ue,be){var Ee=ue.matches||ue[B(ue,"matchesSelector")];return q=function(Fe,ze){return Ee.call(Fe,ze)},q(ue,be)};typeof Sizzle=="function"&&(N=function(ue,be){return Sizzle(ue,be)[0]||null},U=Sizzle,q=Sizzle.matchesSelector),w.selection=function(){return w.select(T.documentElement)};var Q=w.selection.prototype=[];Q.select=function(ue){var be=[],Ee,Fe,ze,Ze;ue=W(ue);for(var yt=-1,ft=this.length;++yt<ft;){be.push(Ee=[]),Ee.parentNode=(ze=this[yt]).parentNode;for(var St=-1,Nt=ze.length;++St<Nt;)(Ze=ze[St])?(Ee.push(Fe=ue.call(Ze,Ze.__data__,St,yt)),Fe&&"__data__"in Ze&&(Fe.__data__=Ze.__data__)):Ee.push(null)}return ie(be)};function W(ue){return typeof ue=="function"?ue:function(){return N(ue,this)}}Q.selectAll=function(ue){var be=[],Ee,Fe;ue=Z(ue);for(var ze=-1,Ze=this.length;++ze<Ze;)for(var yt=this[ze],ft=-1,St=yt.length;++ft<St;)(Fe=yt[ft])&&(be.push(Ee=M(ue.call(Fe,Fe.__data__,ft,ze))),Ee.parentNode=Fe);return ie(be)};function Z(ue){return typeof ue=="function"?ue:function(){return U(ue,this)}}var ee="http://www.w3.org/1999/xhtml",te={svg:"http://www.w3.org/2000/svg",xhtml:ee,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};w.ns={prefix:te,qualify:function(ue){var be=ue.indexOf(":"),Ee=ue;return be>=0&&(Ee=ue.slice(0,be))!=="xmlns"&&(ue=ue.slice(be+1)),te.hasOwnProperty(Ee)?{space:te[Ee],local:ue}:ue}},Q.attr=function(ue,be){if(arguments.length<2){if(typeof ue=="string"){var Ee=this.node();return ue=w.ns.qualify(ue),ue.local?Ee.getAttributeNS(ue.space,ue.local):Ee.getAttribute(ue)}for(be in ue)this.each(ae(be,ue[be]));return this}return this.each(ae(ue,be))};function ae(ue,be){ue=w.ns.qualify(ue);function Ee(){this.removeAttribute(ue)}function Fe(){this.removeAttributeNS(ue.space,ue.local)}function ze(){this.setAttribute(ue,be)}function Ze(){this.setAttributeNS(ue.space,ue.local,be)}function yt(){var St=be.apply(this,arguments);St==null?this.removeAttribute(ue):this.setAttribute(ue,St)}function ft(){var St=be.apply(this,arguments);St==null?this.removeAttributeNS(ue.space,ue.local):this.setAttributeNS(ue.space,ue.local,St)}return be==null?ue.local?Fe:Ee:typeof be=="function"?ue.local?ft:yt:ue.local?Ze:ze}function le(ue){return ue.trim().replace(/\s+/g," ")}Q.classed=function(ue,be){if(arguments.length<2){if(typeof ue=="string"){var Ee=this.node(),Fe=(ue=fe(ue)).length,ze=-1;if(be=Ee.classList){for(;++ze<Fe;)if(!be.contains(ue[ze]))return!1}else for(be=Ee.getAttribute("class");++ze<Fe;)if(!ye(ue[ze]).test(be))return!1;return!0}for(be in ue)this.each(pe(be,ue[be]));return this}return this.each(pe(ue,be))};function ye(ue){return new RegExp("(?:^|\\s+)"+w.requote(ue)+"(?:\\s+|$)","g")}function fe(ue){return(ue+"").trim().split(/^|\s+/)}function pe(ue,be){ue=fe(ue).map(ge);var Ee=ue.length;function Fe(){for(var Ze=-1;++Ze<Ee;)ue[Ze](this,be)}function ze(){for(var Ze=-1,yt=be.apply(this,arguments);++Ze<Ee;)ue[Ze](this,yt)}return typeof be=="function"?ze:Fe}function ge(ue){var be=ye(ue);return function(Ee,Fe){if(ze=Ee.classList)return Fe?ze.add(ue):ze.remove(ue);var ze=Ee.getAttribute("class")||"";Fe?(be.lastIndex=0,be.test(ze)||Ee.setAttribute("class",le(ze+" "+ue))):Ee.setAttribute("class",le(ze.replace(be," ")))}}Q.style=function(ue,be,Ee){var Fe=arguments.length;if(Fe<3){if(typeof ue!="string"){Fe<2&&(be="");for(Ee in ue)this.each(Ae(Ee,ue[Ee],be));return this}if(Fe<2){var ze=this.node();return a(ze).getComputedStyle(ze,null).getPropertyValue(ue)}Ee=""}return this.each(Ae(ue,be,Ee))};function Ae(ue,be,Ee){function Fe(){this.style.removeProperty(ue)}function ze(){this.style.setProperty(ue,be,Ee)}function Ze(){var yt=be.apply(this,arguments);yt==null?this.style.removeProperty(ue):this.style.setProperty(ue,yt,Ee)}return be==null?Fe:typeof be=="function"?Ze:ze}Q.property=function(ue,be){if(arguments.length<2){if(typeof ue=="string")return this.node()[ue];for(be in ue)this.each(we(be,ue[be]));return this}return this.each(we(ue,be))};function we(ue,be){function Ee(){delete this[ue]}function Fe(){this[ue]=be}function ze(){var Ze=be.apply(this,arguments);Ze==null?delete this[ue]:this[ue]=Ze}return be==null?Ee:typeof be=="function"?ze:Fe}Q.text=function(ue){return arguments.length?this.each(typeof ue=="function"?function(){var be=ue.apply(this,arguments);this.textContent=be==null?"":be}:ue==null?function(){this.textContent=""}:function(){this.textContent=ue}):this.node().textContent},Q.html=function(ue){return arguments.length?this.each(typeof ue=="function"?function(){var be=ue.apply(this,arguments);this.innerHTML=be==null?"":be}:ue==null?function(){this.innerHTML=""}:function(){this.innerHTML=ue}):this.node().innerHTML},Q.append=function(ue){return ue=De(ue),this.select(function(){return this.appendChild(ue.apply(this,arguments))})};function De(ue){function be(){var Fe=this.ownerDocument,ze=this.namespaceURI;return ze===ee&&Fe.documentElement.namespaceURI===ee?Fe.createElement(ue):Fe.createElementNS(ze,ue)}function Ee(){return this.ownerDocument.createElementNS(ue.space,ue.local)}return typeof ue=="function"?ue:(ue=w.ns.qualify(ue)).local?Ee:be}Q.insert=function(ue,be){return ue=De(ue),be=W(be),this.select(function(){return this.insertBefore(ue.apply(this,arguments),be.apply(this,arguments)||null)})},Q.remove=function(){return this.each(Be)};function Be(){var ue=this.parentNode;ue&&ue.removeChild(this)}Q.data=function(ue,be){var Ee=-1,Fe=this.length,ze,Ze;if(!arguments.length){for(ue=new Array(Fe=(ze=this[0]).length);++Ee<Fe;)(Ze=ze[Ee])&&(ue[Ee]=Ze.__data__);return ue}function yt(Xt,Kt){var br,Zr=Xt.length,nn=Kt.length,Mr=Math.min(Zr,nn),zr=new Array(nn),Gr=new Array(nn),qr=new Array(Zr),tn,Yr;if(be){var Un=new A,ta=new Array(Zr),_a;for(br=-1;++br<Zr;)(tn=Xt[br])&&(Un.has(_a=be.call(tn,tn.__data__,br))?qr[br]=tn:Un.set(_a,tn),ta[br]=_a);for(br=-1;++br<nn;)(tn=Un.get(_a=be.call(Kt,Yr=Kt[br],br)))?tn!==!0&&(zr[br]=tn,tn.__data__=Yr):Gr[br]=Ve(Yr),Un.set(_a,!0);for(br=-1;++br<Zr;)br in ta&&Un.get(ta[br])!==!0&&(qr[br]=Xt[br])}else{for(br=-1;++br<Mr;)tn=Xt[br],Yr=Kt[br],tn?(tn.__data__=Yr,zr[br]=tn):Gr[br]=Ve(Yr);for(;br<nn;++br)Gr[br]=Ve(Kt[br]);for(;br<Zr;++br)qr[br]=Xt[br]}Gr.update=zr,Gr.parentNode=zr.parentNode=qr.parentNode=Xt.parentNode,ft.push(Gr),St.push(zr),Nt.push(qr)}var ft=Je([]),St=ie([]),Nt=ie([]);if(typeof ue=="function")for(;++Ee<Fe;)yt(ze=this[Ee],ue.call(ze,ze.parentNode.__data__,Ee));else for(;++Ee<Fe;)yt(ze=this[Ee],ue);return St.enter=function(){return ft},St.exit=function(){return Nt},St};function Ve(ue){return{__data__:ue}}Q.datum=function(ue){return arguments.length?this.property("__data__",ue):this.property("__data__")},Q.filter=function(ue){var be=[],Ee,Fe,ze;typeof ue!="function"&&(ue=xe(ue));for(var Ze=0,yt=this.length;Ze<yt;Ze++){be.push(Ee=[]),Ee.parentNode=(Fe=this[Ze]).parentNode;for(var ft=0,St=Fe.length;ft<St;ft++)(ze=Fe[ft])&&ue.call(ze,ze.__data__,ft,Ze)&&Ee.push(ze)}return ie(be)};function xe(ue){return function(){return q(this,ue)}}Q.order=function(){for(var ue=-1,be=this.length;++ue<be;)for(var Ee=this[ue],Fe=Ee.length-1,ze=Ee[Fe],Ze;--Fe>=0;)(Ze=Ee[Fe])&&(ze&&ze!==Ze.nextSibling&&ze.parentNode.insertBefore(Ze,ze),ze=Ze);return this},Q.sort=function(ue){ue=Le.apply(this,arguments);for(var be=-1,Ee=this.length;++be<Ee;)this[be].sort(ue);return this.order()};function Le(ue){return arguments.length||(ue=i),function(be,Ee){return be&&Ee?ue(be.__data__,Ee.__data__):!be-!Ee}}Q.each=function(ue){return He(this,function(be,Ee,Fe){ue.call(be,be.__data__,Ee,Fe)})};function He(ue,be){for(var Ee=0,Fe=ue.length;Ee<Fe;Ee++)for(var ze=ue[Ee],Ze=0,yt=ze.length,ft;Ze<yt;Ze++)(ft=ze[Ze])&&be(ft,Ze,Ee);return ue}Q.call=function(ue){var be=M(arguments);return ue.apply(be[0]=this,be),this},Q.empty=function(){return!this.node()},Q.node=function(){for(var ue=0,be=this.length;ue<be;ue++)for(var Ee=this[ue],Fe=0,ze=Ee.length;Fe<ze;Fe++){var Ze=Ee[Fe];if(Ze)return Ze}return null},Q.size=function(){var ue=0;return He(this,function(){++ue}),ue};function Je(ue){return se(ue,Oe),ue}var Oe=[];w.selection.enter=Je,w.selection.enter.prototype=Oe,Oe.append=Q.append,Oe.empty=Q.empty,Oe.node=Q.node,Oe.call=Q.call,Oe.size=Q.size,Oe.select=function(ue){for(var be=[],Ee,Fe,ze,Ze,yt,ft=-1,St=this.length;++ft<St;){ze=(Ze=this[ft]).update,be.push(Ee=[]),Ee.parentNode=Ze.parentNode;for(var Nt=-1,Xt=Ze.length;++Nt<Xt;)(yt=Ze[Nt])?(Ee.push(ze[Nt]=Fe=ue.call(Ze.parentNode,yt.__data__,Nt,ft)),Fe.__data__=yt.__data__):Ee.push(null)}return ie(be)},Oe.insert=function(ue,be){return arguments.length<2&&(be=Pe(this)),Q.insert.call(this,ue,be)};function Pe(ue){var be,Ee;return function(Fe,ze,Ze){var yt=ue[Ze].update,ft=yt.length,St;for(Ze!=Ee&&(Ee=Ze,be=0),ze>=be&&(be=ze+1);!(St=yt[be])&&++be<ft;);return St}}w.select=function(ue){var be;return typeof ue=="string"?(be=[N(ue,T)],be.parentNode=T.documentElement):(be=[ue],be.parentNode=e(ue)),ie([be])},w.selectAll=function(ue){var be;return typeof ue=="string"?(be=M(U(ue,T)),be.parentNode=T.documentElement):(be=M(ue),be.parentNode=null),ie([be])},Q.on=function(ue,be,Ee){var Fe=arguments.length;if(Fe<3){if(typeof ue!="string"){Fe<2&&(be=!1);for(Ee in ue)this.each(Ue(Ee,ue[Ee],be));return this}if(Fe<2)return(Fe=this.node()["__on"+ue])&&Fe._;Ee=!1}return this.each(Ue(ue,be,Ee))};function Ue(ue,be,Ee){var Fe="__on"+ue,ze=ue.indexOf("."),Ze=Lt;ze>0&&(ue=ue.slice(0,ze));var yt=vt.get(ue);yt&&(ue=yt,Ze=Yt);function ft(){var Xt=this[Fe];Xt&&(this.removeEventListener(ue,Xt,Xt.$),delete this[Fe])}function St(){var Xt=Ze(be,M(arguments));ft.call(this),this.addEventListener(ue,this[Fe]=Xt,Xt.$=Ee),Xt._=be}function Nt(){var Xt=new RegExp("^__on([^.]+)"+w.requote(ue)+"$"),Kt;for(var br in this)if(Kt=br.match(Xt)){var Zr=this[br];this.removeEventListener(Kt[1],Zr,Zr.$),delete this[br]}}return ze?be?St:ft:be?V:Nt}var vt=w.map({mouseenter:"mouseover",mouseleave:"mouseout"});T&&vt.forEach(function(ue){"on"+ue in T&&vt.remove(ue)});function Lt(ue,be){return function(Ee){var Fe=w.event;w.event=Ee,be[0]=this.__data__;try{ue.apply(this,be)}finally{w.event=Fe}}}function Yt(ue,be){var Ee=Lt(ue,be);return function(Fe){var ze=this,Ze=Fe.relatedTarget;(!Ze||Ze!==ze&&!(Ze.compareDocumentPosition(ze)&8))&&Ee.call(ze,Fe)}}var At,Rt=0;function Bt(ue){var be=".dragsuppress-"+ ++Rt,Ee="click"+be,Fe=w.select(a(ue)).on("touchmove"+be,j).on("dragstart"+be,j).on("selectstart"+be,j);if(At==null&&(At="onselectstart"in ue?!1:B(ue.style,"userSelect")),At){var ze=e(ue).style,Ze=ze[At];ze[At]="none"}return function(yt){if(Fe.on(be,null),At&&(ze[At]=Ze),yt){var ft=function(){Fe.on(Ee,null)};Fe.on(Ee,function(){j(),ft()},!0),setTimeout(ft,0)}}}w.mouse=function(ue){return Tt(ue,Y())};var Mt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function Tt(ue,be){be.changedTouches&&(be=be.changedTouches[0]);var Ee=ue.ownerSVGElement||ue;if(Ee.createSVGPoint){var Fe=Ee.createSVGPoint();if(Mt<0){var ze=a(ue);if(ze.scrollX||ze.scrollY){Ee=w.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var Ze=Ee[0][0].getScreenCTM();Mt=!(Ze.f||Ze.e),Ee.remove()}}return Mt?(Fe.x=be.pageX,Fe.y=be.pageY):(Fe.x=be.clientX,Fe.y=be.clientY),Fe=Fe.matrixTransform(ue.getScreenCTM().inverse()),[Fe.x,Fe.y]}var yt=ue.getBoundingClientRect();return[be.clientX-yt.left-ue.clientLeft,be.clientY-yt.top-ue.clientTop]}w.touch=function(ue,be,Ee){if(arguments.length<3&&(Ee=be,be=Y().changedTouches),be){for(var Fe=0,ze=be.length,Ze;Fe<ze;++Fe)if((Ze=be[Fe]).identifier===Ee)return Tt(ue,Ze)}},w.behavior.drag=function(){var ue=X(ze,"drag","dragstart","dragend"),be=null,Ee=Ze(V,w.mouse,a,"mousemove","mouseup"),Fe=Ze(at,w.touch,D,"touchmove","touchend");function ze(){this.on("mousedown.drag",Ee).on("touchstart.drag",Fe)}function Ze(yt,ft,St,Nt,Xt){return function(){var Kt=this,br=w.event.target.correspondingElement||w.event.target,Zr=Kt.parentNode,nn=ue.of(Kt,arguments),Mr=0,zr=yt(),Gr=".drag"+(zr==null?"":"-"+zr),qr,tn=w.select(St(br)).on(Nt+Gr,ta).on(Xt+Gr,_a),Yr=Bt(br),Un=ft(Zr,zr);be?(qr=be.apply(Kt,arguments),qr=[qr.x-Un[0],qr.y-Un[1]]):qr=[0,0],nn({type:"dragstart"});function ta(){var ia=ft(Zr,zr),ka,ua;!ia||(ka=ia[0]-Un[0],ua=ia[1]-Un[1],Mr|=ka|ua,Un=ia,nn({type:"drag",x:ia[0]+qr[0],y:ia[1]+qr[1],dx:ka,dy:ua}))}function _a(){!ft(Zr,zr)||(tn.on(Nt+Gr,null).on(Xt+Gr,null),Yr(Mr),nn({type:"dragend"}))}}}return ze.origin=function(yt){return arguments.length?(be=yt,ze):be},w.rebind(ze,ue,"on")};function at(){return w.event.changedTouches[0].identifier}w.touches=function(ue,be){return arguments.length<2&&(be=Y().touches),be?M(be).map(function(Ee){var Fe=Tt(ue,Ee);return Fe.identifier=Ee.identifier,Fe}):[]};var ct=1e-6,je=ct*ct,ke=Math.PI,Ye=2*ke,Ke=Ye-ct,st=ke/2,Et=ke/180,bt=180/ke;function zt(ue,be,Ee){return(be[0]-ue[0])*(Ee[1]-ue[1])-(be[1]-ue[1])*(Ee[0]-ue[0])}function $t(ue){return ue>1?st:ue<-1?-st:Math.asin(ue)}function Ot(ue){return((ue=Math.exp(ue))-1/ue)/2}function Qt(ue){return((ue=Math.exp(ue))+1/ue)/2}function tr(ue){return((ue=Math.exp(2*ue))-1)/(ue+1)}var qt=Math.SQRT2,lr=2,Wr=4;w.interpolateZoom=function(ue,be){var Ee=ue[0],Fe=ue[1],ze=ue[2],Ze=be[0],yt=be[1],ft=be[2],St=Ze-Ee,Nt=yt-Fe,Xt=St*St+Nt*Nt,Kt,br;if(Xt<je)br=Math.log(ft/ze)/qt,Kt=function(qr){return[Ee+qr*St,Fe+qr*Nt,ze*Math.exp(qt*qr*br)]};else{var Zr=Math.sqrt(Xt),nn=(ft*ft-ze*ze+Wr*Xt)/(2*ze*lr*Zr),Mr=(ft*ft-ze*ze-Wr*Xt)/(2*ft*lr*Zr),zr=Math.log(Math.sqrt(nn*nn+1)-nn),Gr=Math.log(Math.sqrt(Mr*Mr+1)-Mr);br=(Gr-zr)/qt,Kt=function(qr){var tn=qr*br,Yr=Qt(zr),Un=ze/(lr*Zr)*(Yr*tr(qt*tn+zr)-Ot(zr));return[Ee+Un*St,Fe+Un*Nt,ze*Yr/Qt(qt*tn+zr)]}}return Kt.duration=br*1e3,Kt},w.behavior.zoom=function(){var ue={x:0,y:0,k:1},be,Ee,Fe,ze=[960,500],Ze=cn,yt=250,ft=0,St="mousedown.zoom",Nt="mousemove.zoom",Xt="mouseup.zoom",Kt,br="touchstart.zoom",Zr,nn=X(tn,"zoomstart","zoom","zoomend"),Mr,zr,Gr,qr;ot||(ot="onwheel"in T?(Jr=function(){return-w.event.deltaY*(w.event.deltaMode?120:1)},"wheel"):"onmousewheel"in T?(Jr=function(){return w.event.wheelDelta},"mousewheel"):(Jr=function(){return-w.event.detail},"MozMousePixelScroll"));function tn(fa){fa.on(St,Qa).on(ot+".zoom",ho).on("dblclick.zoom",Fi).on(br,xi)}tn.event=function(fa){fa.each(function(){var ni=nn.of(this,arguments),Xa=ue;Wa?w.select(this).transition().each("start.zoom",function(){ue=this.__chart__||{x:0,y:0,k:1},ua(ni)}).tween("zoom:zoom",function(){var Ei=ze[0],si=ze[1],so=Ee?Ee[0]:Ei/2,qi=Ee?Ee[1]:si/2,mo=w.interpolateZoom([(so-ue.x)/ue.k,(qi-ue.y)/ue.k,Ei/ue.k],[(so-Xa.x)/Xa.k,(qi-Xa.y)/Xa.k,Ei/Xa.k]);return function(Wo){var Bo=mo(Wo),Xo=Ei/Bo[2];this.__chart__=ue={x:so-Bo[0]*Xo,y:qi-Bo[1]*Xo,k:Xo},Na(ni)}}).each("interrupt.zoom",function(){Pa(ni)}).each("end.zoom",function(){Pa(ni)}):(this.__chart__=ue,ua(ni),Na(ni),Pa(ni))})},tn.translate=function(fa){return arguments.length?(ue={x:+fa[0],y:+fa[1],k:ue.k},ka(),tn):[ue.x,ue.y]},tn.scale=function(fa){return arguments.length?(ue={x:ue.x,y:ue.y,k:null},ta(+fa),ka(),tn):ue.k},tn.scaleExtent=function(fa){return arguments.length?(Ze=fa==null?cn:[+fa[0],+fa[1]],tn):Ze},tn.center=function(fa){return arguments.length?(Fe=fa&&[+fa[0],+fa[1]],tn):Fe},tn.size=function(fa){return arguments.length?(ze=fa&&[+fa[0],+fa[1]],tn):ze},tn.duration=function(fa){return arguments.length?(yt=+fa,tn):yt},tn.x=function(fa){return arguments.length?(zr=fa,Mr=fa.copy(),ue={x:0,y:0,k:1},tn):zr},tn.y=function(fa){return arguments.length?(qr=fa,Gr=fa.copy(),ue={x:0,y:0,k:1},tn):qr};function Yr(fa){return[(fa[0]-ue.x)/ue.k,(fa[1]-ue.y)/ue.k]}function Un(fa){return[fa[0]*ue.k+ue.x,fa[1]*ue.k+ue.y]}function ta(fa){ue.k=Math.max(Ze[0],Math.min(Ze[1],fa))}function _a(fa,ni){ni=Un(ni),ue.x+=fa[0]-ni[0],ue.y+=fa[1]-ni[1]}function ia(fa,ni,Xa,Ei){fa.__chart__={x:ue.x,y:ue.y,k:ue.k},ta(Math.pow(2,Ei)),_a(Ee=ni,Xa),fa=w.select(fa),yt>0&&(fa=fa.transition().duration(yt)),fa.call(tn.event)}function ka(){zr&&zr.domain(Mr.range().map(function(fa){return(fa-ue.x)/ue.k}).map(Mr.invert)),qr&&qr.domain(Gr.range().map(function(fa){return(fa-ue.y)/ue.k}).map(Gr.invert))}function ua(fa){ft++||fa({type:"zoomstart"})}function Na(fa){ka(),fa({type:"zoom",scale:ue.k,translate:[ue.x,ue.y]})}function Pa(fa){--ft||(fa({type:"zoomend"}),Ee=null)}function Qa(){var fa=this,ni=nn.of(fa,arguments),Xa=0,Ei=w.select(a(fa)).on(Nt,qi).on(Xt,mo),si=Yr(w.mouse(fa)),so=Bt(fa);Ln.call(fa),ua(ni);function qi(){Xa=1,_a(w.mouse(fa),si),Na(ni)}function mo(){Ei.on(Nt,null).on(Xt,null),so(Xa),Pa(ni)}}function xi(){var fa=this,ni=nn.of(fa,arguments),Xa={},Ei=0,si,so=".zoom-"+w.event.changedTouches[0].identifier,qi="touchmove"+so,mo="touchend"+so,Wo=[],Bo=w.select(fa),Xo=Bt(fa);Ui(),ua(ni),Bo.on(St,null).on(br,Ui);function Wi(){var _o=w.touches(fa);return si=ue.k,_o.forEach(function(ro){ro.identifier in Xa&&(Xa[ro.identifier]=Yr(ro))}),_o}function Ui(){var _o=w.event.target;w.select(_o).on(qi,Ia).on(mo,Za),Wo.push(_o);for(var ro=w.event.changedTouches,Ro=0,ji=ro.length;Ro<ji;++Ro)Xa[ro[Ro].identifier]=null;var Zo=Wi(),bs=Date.now();if(Zo.length===1){if(bs-Zr<500){var Ul=Zo[0];ia(fa,Ul,Xa[Ul.identifier],Math.floor(Math.log(ue.k)/Math.LN2)+1),j()}Zr=bs}else if(Zo.length>1){var Ul=Zo[0],Ki=Zo[1],qu=Ul[0]-Ki[0],Ml=Ul[1]-Ki[1];Ei=qu*qu+Ml*Ml}}function Ia(){var _o=w.touches(fa),ro,Ro,ji,Zo;Ln.call(fa);for(var bs=0,Ul=_o.length;bs<Ul;++bs,Zo=null)if(ji=_o[bs],Zo=Xa[ji.identifier]){if(Ro)break;ro=ji,Ro=Zo}if(Zo){var Ki=(Ki=ji[0]-ro[0])*Ki+(Ki=ji[1]-ro[1])*Ki,qu=Ei&&Math.sqrt(Ki/Ei);ro=[(ro[0]+ji[0])/2,(ro[1]+ji[1])/2],Ro=[(Ro[0]+Zo[0])/2,(Ro[1]+Zo[1])/2],ta(qu*si)}Zr=null,_a(ro,Ro),Na(ni)}function Za(){if(w.event.touches.length){for(var _o=w.event.changedTouches,ro=0,Ro=_o.length;ro<Ro;++ro)delete Xa[_o[ro].identifier];for(var ji in Xa)return void Wi()}w.selectAll(Wo).on(so,null),Bo.on(St,Qa).on(br,xi),Xo(),Pa(ni)}}function ho(){var fa=nn.of(this,arguments);Kt?clearTimeout(Kt):(Ln.call(this),be=Yr(Ee=Fe||w.mouse(this)),ua(fa)),Kt=setTimeout(function(){Kt=null,Pa(fa)},50),j(),ta(Math.pow(2,Jr()*.002)*ue.k),_a(Ee,be),Na(fa)}function Fi(){var fa=w.mouse(this),ni=Math.log(ue.k)/Math.LN2;ia(this,fa,Yr(fa),w.event.shiftKey?Math.ceil(ni)-1:Math.floor(ni)+1)}return w.rebind(tn,nn,"on")};var cn=[0,1/0],Jr,ot;w.color=Vt;function Vt(){}Vt.prototype.toString=function(){return this.rgb()+""},w.hsl=jt;function jt(ue,be,Ee){return this instanceof jt?(this.h=+ue,this.s=+be,void(this.l=+Ee)):arguments.length<2?ue instanceof jt?new jt(ue.h,ue.s,ue.l):fn(""+ue,xr,jt):new jt(ue,be,Ee)}var Ut=jt.prototype=new Vt;Ut.brighter=function(ue){return ue=Math.pow(.7,arguments.length?ue:1),new jt(this.h,this.s,this.l/ue)},Ut.darker=function(ue){return ue=Math.pow(.7,arguments.length?ue:1),new jt(this.h,this.s,ue*this.l)},Ut.rgb=function(){return yr(this.h,this.s,this.l)};function yr(ue,be,Ee){var Fe,ze;ue=isNaN(ue)?0:(ue%=360)<0?ue+360:ue,be=isNaN(be)||be<0?0:be>1?1:be,Ee=Ee<0?0:Ee>1?1:Ee,ze=Ee<=.5?Ee*(1+be):Ee+be-Ee*be,Fe=2*Ee-ze;function Ze(ft){return ft>360?ft-=360:ft<0&&(ft+=360),ft<60?Fe+(ze-Fe)*ft/60:ft<180?ze:ft<240?Fe+(ze-Fe)*(240-ft)/60:Fe}function yt(ft){return Math.round(Ze(ft)*255)}return new hr(yt(ue+120),yt(ue),yt(ue-120))}w.hcl=nt;function nt(ue,be,Ee){return this instanceof nt?(this.h=+ue,this.c=+be,void(this.l=+Ee)):arguments.length<2?ue instanceof nt?new nt(ue.h,ue.c,ue.l):ue instanceof Ne?kt(ue.l,ue.a,ue.b):kt((ue=mr((ue=w.rgb(ue)).r,ue.g,ue.b)).l,ue.a,ue.b):new nt(ue,be,Ee)}var _e=nt.prototype=new Vt;_e.brighter=function(ue){return new nt(this.h,this.c,Math.min(100,this.l+We*(arguments.length?ue:1)))},_e.darker=function(ue){return new nt(this.h,this.c,Math.max(0,this.l-We*(arguments.length?ue:1)))},_e.rgb=function(){return Me(this.h,this.c,this.l).rgb()};function Me(ue,be,Ee){return isNaN(ue)&&(ue=0),isNaN(be)&&(be=0),new Ne(Ee,Math.cos(ue*=Et)*be,Math.sin(ue)*be)}w.lab=Ne;function Ne(ue,be,Ee){return this instanceof Ne?(this.l=+ue,this.a=+be,void(this.b=+Ee)):arguments.length<2?ue instanceof Ne?new Ne(ue.l,ue.a,ue.b):ue instanceof nt?Me(ue.h,ue.c,ue.l):mr((ue=hr(ue)).r,ue.g,ue.b):new Ne(ue,be,Ee)}var We=18,Qe=.95047,rt=1,$e=1.08883,ht=Ne.prototype=new Vt;ht.brighter=function(ue){return new Ne(Math.min(100,this.l+We*(arguments.length?ue:1)),this.a,this.b)},ht.darker=function(ue){return new Ne(Math.max(0,this.l-We*(arguments.length?ue:1)),this.a,this.b)},ht.rgb=function(){return xt(this.l,this.a,this.b)};function xt(ue,be,Ee){var Fe=(ue+16)/116,ze=Fe+be/500,Ze=Fe-Ee/200;return ze=Wt(ze)*Qe,Fe=Wt(Fe)*rt,Ze=Wt(Ze)*$e,new hr(ir(3.2404542*ze-1.5371385*Fe-.4985314*Ze),ir(-.969266*ze+1.8760108*Fe+.041556*Ze),ir(.0556434*ze-.2040259*Fe+1.0572252*Ze))}function kt(ue,be,Ee){return ue>0?new nt(Math.atan2(Ee,be)*bt,Math.sqrt(be*be+Ee*Ee),ue):new nt(NaN,NaN,ue)}function Wt(ue){return ue>.206893034?ue*ue*ue:(ue-4/29)/7.787037}function Ft(ue){return ue>.008856?Math.pow(ue,1/3):7.787037*ue+4/29}function ir(ue){return Math.round(255*(ue<=.00304?12.92*ue:1.055*Math.pow(ue,1/2.4)-.055))}w.rgb=hr;function hr(ue,be,Ee){return this instanceof hr?(this.r=~~ue,this.g=~~be,void(this.b=~~Ee)):arguments.length<2?ue instanceof hr?new hr(ue.r,ue.g,ue.b):fn(""+ue,hr,yr):new hr(ue,be,Ee)}function _r(ue){return new hr(ue>>16,ue>>8&255,ue&255)}function an(ue){return _r(ue)+""}var Rr=hr.prototype=new Vt;Rr.brighter=function(ue){ue=Math.pow(.7,arguments.length?ue:1);var be=this.r,Ee=this.g,Fe=this.b,ze=30;return!be&&!Ee&&!Fe?new hr(ze,ze,ze):(be&&be<ze&&(be=ze),Ee&&Ee<ze&&(Ee=ze),Fe&&Fe<ze&&(Fe=ze),new hr(Math.min(255,be/ue),Math.min(255,Ee/ue),Math.min(255,Fe/ue)))},Rr.darker=function(ue){return ue=Math.pow(.7,arguments.length?ue:1),new hr(ue*this.r,ue*this.g,ue*this.b)},Rr.hsl=function(){return xr(this.r,this.g,this.b)},Rr.toString=function(){return"#"+Vr(this.r)+Vr(this.g)+Vr(this.b)};function Vr(ue){return ue<16?"0"+Math.max(0,ue).toString(16):Math.min(255,ue).toString(16)}function fn(ue,be,Ee){var Fe=0,ze=0,Ze=0,yt,ft,St;if(yt=/([a-z]+)\((.*)\)/.exec(ue=ue.toLowerCase()),yt)switch(ft=yt[2].split(","),yt[1]){case"hsl":return Ee(parseFloat(ft[0]),parseFloat(ft[1])/100,parseFloat(ft[2])/100);case"rgb":return be(Ir(ft[0]),Ir(ft[1]),Ir(ft[2]))}return(St=Sr.get(ue))?be(St.r,St.g,St.b):(ue!=null&&ue.charAt(0)==="#"&&!isNaN(St=parseInt(ue.slice(1),16))&&(ue.length===4?(Fe=(St&3840)>>4,Fe=Fe>>4|Fe,ze=St&240,ze=ze>>4|ze,Ze=St&15,Ze=Ze<<4|Ze):ue.length===7&&(Fe=(St&16711680)>>16,ze=(St&65280)>>8,Ze=St&255)),be(Fe,ze,Ze))}function xr(ue,be,Ee){var Fe=Math.min(ue/=255,be/=255,Ee/=255),ze=Math.max(ue,be,Ee),Ze=ze-Fe,yt,ft,St=(ze+Fe)/2;return Ze?(ft=St<.5?Ze/(ze+Fe):Ze/(2-ze-Fe),ue==ze?yt=(be-Ee)/Ze+(be<Ee?6:0):be==ze?yt=(Ee-ue)/Ze+2:yt=(ue-be)/Ze+4,yt*=60):(yt=NaN,ft=St>0&&St<1?0:yt),new jt(yt,ft,St)}function mr(ue,be,Ee){ue=Fr(ue),be=Fr(be),Ee=Fr(Ee);var Fe=Ft((.4124564*ue+.3575761*be+.1804375*Ee)/Qe),ze=Ft((.2126729*ue+.7151522*be+.072175*Ee)/rt),Ze=Ft((.0193339*ue+.119192*be+.9503041*Ee)/$e);return Ne(116*ze-16,500*(Fe-ze),200*(ze-Ze))}function Fr(ue){return(ue/=255)<=.04045?ue/12.92:Math.pow((ue+.055)/1.055,2.4)}function Ir(ue){var be=parseFloat(ue);return ue.charAt(ue.length-1)==="%"?Math.round(be*2.55):be}var Sr=w.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Sr.forEach(function(ue,be){Sr.set(ue,_r(be))});function tt(ue){return typeof ue=="function"?ue:function(){return ue}}w.functor=tt,w.xhr=Ct(D);function Ct(ue){return function(be,Ee,Fe){return arguments.length===2&&typeof Ee=="function"&&(Fe=Ee,Ee=null),Zt(be,Ee,ue,Fe)}}function Zt(ue,be,Ee,Fe){var ze={},Ze=w.dispatch("beforesend","progress","load","error"),yt={},ft=new XMLHttpRequest,St=null;self.XDomainRequest&&!("withCredentials"in ft)&&/^(http(s)?:)?\/\//.test(ue)&&(ft=new XDomainRequest),"onload"in ft?ft.onload=ft.onerror=Nt:ft.onreadystatechange=function(){ft.readyState>3&&Nt()};function Nt(){var Xt=ft.status,Kt;if(!Xt&&Lr(ft)||Xt>=200&&Xt<300||Xt===304){try{Kt=Ee.call(ze,ft)}catch(br){Ze.error.call(ze,br);return}Ze.load.call(ze,Kt)}else Ze.error.call(ze,ft)}return ft.onprogress=function(Xt){var Kt=w.event;w.event=Xt;try{Ze.progress.call(ze,ft)}finally{w.event=Kt}},ze.header=function(Xt,Kt){return Xt=(Xt+"").toLowerCase(),arguments.length<2?yt[Xt]:(Kt==null?delete yt[Xt]:yt[Xt]=Kt+"",ze)},ze.mimeType=function(Xt){return arguments.length?(be=Xt==null?null:Xt+"",ze):be},ze.responseType=function(Xt){return arguments.length?(St=Xt,ze):St},ze.response=function(Xt){return Ee=Xt,ze},["get","post"].forEach(function(Xt){ze[Xt]=function(){return ze.send.apply(ze,[Xt].concat(M(arguments)))}}),ze.send=function(Xt,Kt,br){if(arguments.length===2&&typeof Kt=="function"&&(br=Kt,Kt=null),ft.open(Xt,ue,!0),be!=null&&!("accept"in yt)&&(yt.accept=be+",*/*"),ft.setRequestHeader)for(var Zr in yt)ft.setRequestHeader(Zr,yt[Zr]);return be!=null&&ft.overrideMimeType&&ft.overrideMimeType(be),St!=null&&(ft.responseType=St),br!=null&&ze.on("error",br).on("load",function(nn){br(null,nn)}),Ze.beforesend.call(ze,ft),ft.send(Kt==null?null:Kt),ze},ze.abort=function(){return ft.abort(),ze},w.rebind(ze,Ze,"on"),Fe==null?ze:ze.get(ur(Fe))}function ur(ue){return ue.length===1?function(be,Ee){ue(be==null?Ee:null)}:ue}function Lr(ue){var be=ue.responseType;return be&&be!=="text"?ue.response:ue.responseText}w.dsv=function(ue,be){var Ee=new RegExp('["'+ue+`
]`),Fe=ue.charCodeAt(0);function ze(Nt,Xt,Kt){arguments.length<3&&(Kt=Xt,Xt=null);var br=Zt(Nt,be,Xt==null?Ze:yt(Xt),Kt);return br.row=function(Zr){return arguments.length?br.response((Xt=Zr)==null?Ze:yt(Zr)):Xt},br}function Ze(Nt){return ze.parse(Nt.responseText)}function yt(Nt){return function(Xt){return ze.parse(Xt.responseText,Nt)}}ze.parse=function(Nt,Xt){var Kt;return ze.parseRows(Nt,function(br,Zr){if(Kt)return Kt(br,Zr-1);var nn=function(Mr){for(var zr={},Gr=br.length,qr=0;qr<Gr;++qr)zr[br[qr]]=Mr[qr];return zr};Kt=Xt?function(Mr,zr){return Xt(nn(Mr),zr)}:nn})},ze.parseRows=function(Nt,Xt){var Kt={},br={},Zr=[],nn=Nt.length,Mr=0,zr=0,Gr,qr;function tn(){if(Mr>=nn)return br;if(qr)return qr=!1,Kt;var Un=Mr;if(Nt.charCodeAt(Un)===34){for(var ta=Un;ta++<nn;)if(Nt.charCodeAt(ta)===34){if(Nt.charCodeAt(ta+1)!==34)break;++ta}Mr=ta+2;var _a=Nt.charCodeAt(ta+1);return _a===13?(qr=!0,Nt.charCodeAt(ta+2)===10&&++Mr):_a===10&&(qr=!0),Nt.slice(Un+1,ta).replace(/""/g,'"')}for(;Mr<nn;){var _a=Nt.charCodeAt(Mr++),ia=1;if(_a===10)qr=!0;else if(_a===13)qr=!0,Nt.charCodeAt(Mr)===10&&(++Mr,++ia);else if(_a!==Fe)continue;return Nt.slice(Un,Mr-ia)}return Nt.slice(Un)}for(;(Gr=tn())!==br;){for(var Yr=[];Gr!==Kt&&Gr!==br;)Yr.push(Gr),Gr=tn();Xt&&(Yr=Xt(Yr,zr++))==null||Zr.push(Yr)}return Zr},ze.format=function(Nt){if(Array.isArray(Nt[0]))return ze.formatRows(Nt);var Xt=new I,Kt=[];return Nt.forEach(function(br){for(var Zr in br)Xt.has(Zr)||Kt.push(Xt.add(Zr))}),[Kt.map(St).join(ue)].concat(Nt.map(function(br){return Kt.map(function(Zr){return St(br[Zr])}).join(ue)})).join(`
`)},ze.formatRows=function(Nt){return Nt.map(ft).join(`
`)};function ft(Nt){return Nt.map(St).join(ue)}function St(Nt){return Ee.test(Nt)?'"'+Nt.replace(/\"/g,'""')+'"':Nt}return ze},w.csv=w.dsv(",","text/csv"),w.tsv=w.dsv("	","text/tab-separated-values");var Br,Pr,Tr,jr,Pn=this[B(this,"requestAnimationFrame")]||function(ue){setTimeout(ue,17)};w.timer=function(){An.apply(this,arguments)};function An(ue,be,Ee){var Fe=arguments.length;Fe<2&&(be=0),Fe<3&&(Ee=Date.now());var ze=Ee+be,Ze={c:ue,t:ze,n:null};return Pr?Pr.n=Ze:Br=Ze,Pr=Ze,Tr||(jr=clearTimeout(jr),Tr=1,Pn($n)),Ze}function $n(){var ue=zn(),be=Yn()-ue;be>24?(isFinite(be)&&(clearTimeout(jr),jr=setTimeout($n,be)),Tr=0):(Tr=1,Pn($n))}w.timer.flush=function(){zn(),Yn()};function zn(){for(var ue=Date.now(),be=Br;be;)ue>=be.t&&be.c(ue-be.t)&&(be.c=null),be=be.n;return ue}function Yn(){for(var ue,be=Br,Ee=1/0;be;)be.c?(be.t<Ee&&(Ee=be.t),be=(ue=be).n):be=ue?ue.n=be.n:Br=be.n;return Pr=ue,Ee}w.round=function(ue,be){return be?Math.round(ue*(be=Math.pow(10,be)))/be:Math.round(ue)},w.geom={};function Kn(ue){return ue[0]}function Aa(ue){return ue[1]}w.geom.hull=function(ue){var be=Kn,Ee=Aa;if(arguments.length)return Fe(ue);function Fe(ze){if(ze.length<3)return[];var Ze=tt(be),yt=tt(Ee),ft,St=ze.length,Nt=[],Xt=[];for(ft=0;ft<St;ft++)Nt.push([+Ze.call(this,ze[ft],ft),+yt.call(this,ze[ft],ft),ft]);for(Nt.sort(vi),ft=0;ft<St;ft++)Xt.push([Nt[ft][0],-Nt[ft][1]]);var Kt=Ua(Nt),br=Ua(Xt),Zr=br[0]===Kt[0],nn=br[br.length-1]===Kt[Kt.length-1],Mr=[];for(ft=Kt.length-1;ft>=0;--ft)Mr.push(ze[Nt[Kt[ft]][2]]);for(ft=+Zr;ft<br.length-nn;++ft)Mr.push(ze[Nt[br[ft]][2]]);return Mr}return Fe.x=function(ze){return arguments.length?(be=ze,Fe):be},Fe.y=function(ze){return arguments.length?(Ee=ze,Fe):Ee},Fe};function Ua(ue){for(var be=ue.length,Ee=[0,1],Fe=2,ze=2;ze<be;ze++){for(;Fe>1&&zt(ue[Ee[Fe-2]],ue[Ee[Fe-1]],ue[ze])<=0;)--Fe;Ee[Fe++]=ze}return Ee.slice(0,Fe)}function vi(ue,be){return ue[0]-be[0]||ue[1]-be[1]}w.geom.polygon=function(ue){return se(ue,ci),ue};var ci=w.geom.polygon.prototype=[];ci.area=function(){for(var ue=-1,be=this.length,Ee,Fe=this[be-1],ze=0;++ue<be;)Ee=Fe,Fe=this[ue],ze+=Ee[1]*Fe[0]-Ee[0]*Fe[1];return ze*.5},ci.centroid=function(ue){var be=-1,Ee=this.length,Fe=0,ze=0,Ze,yt=this[Ee-1],ft;for(arguments.length||(ue=-1/(6*this.area()));++be<Ee;)Ze=yt,yt=this[be],ft=Ze[0]*yt[1]-yt[0]*Ze[1],Fe+=(Ze[0]+yt[0])*ft,ze+=(Ze[1]+yt[1])*ft;return[Fe*ue,ze*ue]},ci.clip=function(ue){for(var be,Ee=wr(ue),Fe=-1,ze=this.length-wr(this),Ze,yt,ft=this[ze-1],St,Nt,Xt;++Fe<ze;){for(be=ue.slice(),ue.length=0,St=this[Fe],Nt=be[(yt=be.length-Ee)-1],Ze=-1;++Ze<yt;)Xt=be[Ze],ui(Xt,ft,St)?(ui(Nt,ft,St)||ue.push(Ga(Nt,Xt,ft,St)),ue.push(Xt)):ui(Nt,ft,St)&&ue.push(Ga(Nt,Xt,ft,St)),Nt=Xt;Ee&&ue.push(ue[0]),ft=St}return ue};function ui(ue,be,Ee){return(Ee[0]-be[0])*(ue[1]-be[1])<(Ee[1]-be[1])*(ue[0]-be[0])}function Ga(ue,be,Ee,Fe){var ze=ue[0],Ze=Ee[0],yt=be[0]-ze,ft=Fe[0]-Ze,St=ue[1],Nt=Ee[1],Xt=be[1]-St,Kt=Fe[1]-Nt,br=(ft*(St-Nt)-Kt*(ze-Ze))/(Kt*yt-ft*Xt);return[ze+br*yt,St+br*Xt]}function wr(ue){var be=ue[0],Ee=ue[ue.length-1];return!(be[0]-Ee[0]||be[1]-Ee[1])}var vn,on,_n,Bn=[],sa,ra,In=[];function ea(){la(this),this.edge=this.site=this.circle=null}function Va(ue){var be=Bn.pop()||new ea;return be.site=ue,be}function hi(ue){dr(ue),_n.remove(ue),Bn.push(ue),la(ue)}function It(ue){var be=ue.circle,Ee=be.x,Fe=be.cy,ze={x:Ee,y:Fe},Ze=ue.P,yt=ue.N,ft=[ue];hi(ue);for(var St=Ze;St.circle&&u(Ee-St.circle.x)<ct&&u(Fe-St.circle.cy)<ct;)Ze=St.P,ft.unshift(St),hi(St),St=Ze;ft.unshift(St),dr(St);for(var Nt=yt;Nt.circle&&u(Ee-Nt.circle.x)<ct&&u(Fe-Nt.circle.cy)<ct;)yt=Nt.N,ft.push(Nt),hi(Nt),Nt=yt;ft.push(Nt),dr(Nt);var Xt=ft.length,Kt;for(Kt=1;Kt<Xt;++Kt)Nt=ft[Kt],St=ft[Kt-1],aa(Nt.edge,St.site,Nt.site,ze);St=ft[0],Nt=ft[Xt-1],Nt.edge=xn(St.site,Nt.site,null,ze),gr(St),gr(Nt)}function vr(ue){for(var be=ue.x,Ee=ue.y,Fe,ze,Ze,yt,ft=_n._;ft;)if(Ze=rn(ft,Ee)-be,Ze>ct)ft=ft.L;else if(yt=be-hn(ft,Ee),yt>ct){if(!ft.R){Fe=ft;break}ft=ft.R}else{Ze>-ct?(Fe=ft.P,ze=ft):yt>-ct?(Fe=ft,ze=ft.N):Fe=ze=ft;break}var St=Va(ue);if(_n.insert(Fe,St),!(!Fe&&!ze)){if(Fe===ze){dr(Fe),ze=Va(Fe.site),_n.insert(St,ze),St.edge=ze.edge=xn(Fe.site,St.site),gr(Fe),gr(ze);return}if(!ze){St.edge=xn(Fe.site,St.site);return}dr(Fe),dr(ze);var Nt=Fe.site,Xt=Nt.x,Kt=Nt.y,br=ue.x-Xt,Zr=ue.y-Kt,nn=ze.site,Mr=nn.x-Xt,zr=nn.y-Kt,Gr=2*(br*zr-Zr*Mr),qr=br*br+Zr*Zr,tn=Mr*Mr+zr*zr,Yr={x:(zr*qr-Zr*tn)/Gr+Xt,y:(br*tn-Mr*qr)/Gr+Kt};aa(ze.edge,Nt,nn,Yr),St.edge=xn(Nt,ue,null,Yr),ze.edge=xn(ue,nn,null,Yr),gr(Fe),gr(ze)}}function rn(ue,be){var Ee=ue.site,Fe=Ee.x,ze=Ee.y,Ze=ze-be;if(!Ze)return Fe;var yt=ue.P;if(!yt)return-1/0;Ee=yt.site;var ft=Ee.x,St=Ee.y,Nt=St-be;if(!Nt)return ft;var Xt=ft-Fe,Kt=1/Ze-1/Nt,br=Xt/Nt;return Kt?(-br+Math.sqrt(br*br-2*Kt*(Xt*Xt/(-2*Nt)-St+Nt/2+ze-Ze/2)))/Kt+Fe:(Fe+ft)/2}function hn(ue,be){var Ee=ue.N;if(Ee)return rn(Ee,be);var Fe=ue.site;return Fe.y===be?Fe.x:1/0}function un(ue){this.site=ue,this.edges=[]}un.prototype.prepare=function(){for(var ue=this.edges,be=ue.length,Ee;be--;)Ee=ue[be].edge,(!Ee.b||!Ee.a)&&ue.splice(be,1);return ue.sort(bn),ue.length};function kn(ue){for(var be=ue[0][0],Ee=ue[1][0],Fe=ue[0][1],ze=ue[1][1],Ze,yt,ft,St,Nt=on,Xt=Nt.length,Kt,br,Zr,nn,Mr,zr;Xt--;)if(Kt=Nt[Xt],!(!Kt||!Kt.prepare()))for(Zr=Kt.edges,nn=Zr.length,br=0;br<nn;)zr=Zr[br].end(),ft=zr.x,St=zr.y,Mr=Zr[++br%nn].start(),Ze=Mr.x,yt=Mr.y,(u(ft-Ze)>ct||u(St-yt)>ct)&&(Zr.splice(br,0,new da(Wn(Kt.site,zr,u(ft-be)<ct&&ze-St>ct?{x:be,y:u(Ze-be)<ct?yt:ze}:u(St-ze)<ct&&Ee-ft>ct?{x:u(yt-ze)<ct?Ze:Ee,y:ze}:u(ft-Ee)<ct&&St-Fe>ct?{x:Ee,y:u(Ze-Ee)<ct?yt:Fe}:u(St-Fe)<ct&&ft-be>ct?{x:u(yt-Fe)<ct?Ze:be,y:Fe}:null),Kt.site,null)),++nn)}function bn(ue,be){return be.angle-ue.angle}function ln(){la(this),this.x=this.y=this.arc=this.site=this.cy=null}function gr(ue){var be=ue.P,Ee=ue.N;if(!(!be||!Ee)){var Fe=be.site,ze=ue.site,Ze=Ee.site;if(Fe!==Ze){var yt=ze.x,ft=ze.y,St=Fe.x-yt,Nt=Fe.y-ft,Xt=Ze.x-yt,zr=Ze.y-ft,Kt=2*(St*zr-Nt*Xt);if(!(Kt>=-je)){var br=St*St+Nt*Nt,Zr=Xt*Xt+zr*zr,nn=(zr*br-Nt*Zr)/Kt,Mr=(St*Zr-Xt*br)/Kt,zr=Mr+ft,Gr=In.pop()||new ln;Gr.arc=ue,Gr.site=ze,Gr.x=nn+yt,Gr.y=zr+Math.sqrt(nn*nn+Mr*Mr),Gr.cy=zr,ue.circle=Gr;for(var qr=null,tn=ra._;tn;)if(Gr.y<tn.y||Gr.y===tn.y&&Gr.x<=tn.x)if(tn.L)tn=tn.L;else{qr=tn.P;break}else if(tn.R)tn=tn.R;else{qr=tn;break}ra.insert(qr,Gr),qr||(sa=Gr)}}}}function dr(ue){var be=ue.circle;be&&(be.P||(sa=be.N),ra.remove(be),In.push(be),la(be),ue.circle=null)}function Cr(ue,be,Ee,Fe){return function(ze){var Ze=ze.a,yt=ze.b,ft=Ze.x,St=Ze.y,Nt=yt.x,Xt=yt.y,Kt=0,br=1,Zr=Nt-ft,nn=Xt-St,Mr;if(Mr=ue-ft,!(!Zr&&Mr>0)){if(Mr/=Zr,Zr<0){if(Mr<Kt)return;Mr<br&&(br=Mr)}else if(Zr>0){if(Mr>br)return;Mr>Kt&&(Kt=Mr)}if(Mr=Ee-ft,!(!Zr&&Mr<0)){if(Mr/=Zr,Zr<0){if(Mr>br)return;Mr>Kt&&(Kt=Mr)}else if(Zr>0){if(Mr<Kt)return;Mr<br&&(br=Mr)}if(Mr=be-St,!(!nn&&Mr>0)){if(Mr/=nn,nn<0){if(Mr<Kt)return;Mr<br&&(br=Mr)}else if(nn>0){if(Mr>br)return;Mr>Kt&&(Kt=Mr)}if(Mr=Fe-St,!(!nn&&Mr<0)){if(Mr/=nn,nn<0){if(Mr>br)return;Mr>Kt&&(Kt=Mr)}else if(nn>0){if(Mr<Kt)return;Mr<br&&(br=Mr)}return Kt>0&&(ze.a={x:ft+Kt*Zr,y:St+Kt*nn}),br<1&&(ze.b={x:ft+br*Zr,y:St+br*nn}),ze}}}}}}function dn(ue){for(var be=vn,Ee=Cr(ue[0][0],ue[0][1],ue[1][0],ue[1][1]),Fe=be.length,ze;Fe--;)ze=be[Fe],(!On(ze,ue)||!Ee(ze)||u(ze.a.x-ze.b.x)<ct&&u(ze.a.y-ze.b.y)<ct)&&(ze.a=ze.b=null,be.splice(Fe,1))}function On(ue,be){var Ee=ue.b;if(Ee)return!0;var Fe=ue.a,ze=be[0][0],Ze=be[1][0],yt=be[0][1],ft=be[1][1],St=ue.l,Nt=ue.r,Xt=St.x,Kt=St.y,br=Nt.x,Zr=Nt.y,nn=(Xt+br)/2,Mr=(Kt+Zr)/2,zr,Gr;if(Zr===Kt){if(nn<ze||nn>=Ze)return;if(Xt>br){if(!Fe)Fe={x:nn,y:yt};else if(Fe.y>=ft)return;Ee={x:nn,y:ft}}else{if(!Fe)Fe={x:nn,y:ft};else if(Fe.y<yt)return;Ee={x:nn,y:yt}}}else if(zr=(Xt-br)/(Zr-Kt),Gr=Mr-zr*nn,zr<-1||zr>1)if(Xt>br){if(!Fe)Fe={x:(yt-Gr)/zr,y:yt};else if(Fe.y>=ft)return;Ee={x:(ft-Gr)/zr,y:ft}}else{if(!Fe)Fe={x:(ft-Gr)/zr,y:ft};else if(Fe.y<yt)return;Ee={x:(yt-Gr)/zr,y:yt}}else if(Kt<Zr){if(!Fe)Fe={x:ze,y:zr*ze+Gr};else if(Fe.x>=Ze)return;Ee={x:Ze,y:zr*Ze+Gr}}else{if(!Fe)Fe={x:Ze,y:zr*Ze+Gr};else if(Fe.x<ze)return;Ee={x:ze,y:zr*ze+Gr}}return ue.a=Fe,ue.b=Ee,!0}function qn(ue,be){this.l=ue,this.r=be,this.a=this.b=null}function xn(ue,be,Ee,Fe){var ze=new qn(ue,be);return vn.push(ze),Ee&&aa(ze,ue,be,Ee),Fe&&aa(ze,be,ue,Fe),on[ue.i].edges.push(new da(ze,ue,be)),on[be.i].edges.push(new da(ze,be,ue)),ze}function Wn(ue,be,Ee){var Fe=new qn(ue,null);return Fe.a=be,Fe.b=Ee,vn.push(Fe),Fe}function aa(ue,be,Ee,Fe){!ue.a&&!ue.b?(ue.a=Fe,ue.l=be,ue.r=Ee):ue.l===Ee?ue.b=Fe:ue.a=Fe}function da(ue,be,Ee){var Fe=ue.a,ze=ue.b;this.edge=ue,this.site=be,this.angle=Ee?Math.atan2(Ee.y-be.y,Ee.x-be.x):ue.l===be?Math.atan2(ze.x-Fe.x,Fe.y-ze.y):Math.atan2(Fe.x-ze.x,ze.y-Fe.y)}da.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function ma(){this._=null}function la(ue){ue.U=ue.C=ue.L=ue.R=ue.P=ue.N=null}ma.prototype={insert:function(ue,be){var Ee,Fe,ze;if(ue){if(be.P=ue,be.N=ue.N,ue.N&&(ue.N.P=be),ue.N=be,ue.R){for(ue=ue.R;ue.L;)ue=ue.L;ue.L=be}else ue.R=be;Ee=ue}else this._?(ue=zo(this._),be.P=null,be.N=ue,ue.P=ue.L=be,Ee=ue):(be.P=be.N=null,this._=be,Ee=null);for(be.L=be.R=null,be.U=Ee,be.C=!0,ue=be;Ee&&Ee.C;)Fe=Ee.U,Ee===Fe.L?(ze=Fe.R,ze&&ze.C?(Ee.C=ze.C=!1,Fe.C=!0,ue=Fe):(ue===Ee.R&&(Ma(this,Ee),ue=Ee,Ee=ue.U),Ee.C=!1,Fe.C=!0,po(this,Fe))):(ze=Fe.L,ze&&ze.C?(Ee.C=ze.C=!1,Fe.C=!0,ue=Fe):(ue===Ee.L&&(po(this,Ee),ue=Ee,Ee=ue.U),Ee.C=!1,Fe.C=!0,Ma(this,Fe))),Ee=ue.U;this._.C=!1},remove:function(ue){ue.N&&(ue.N.P=ue.P),ue.P&&(ue.P.N=ue.N),ue.N=ue.P=null;var be=ue.U,Ee,Fe=ue.L,ze=ue.R,Ze,yt;if(Fe?ze?Ze=zo(ze):Ze=Fe:Ze=ze,be?be.L===ue?be.L=Ze:be.R=Ze:this._=Ze,Fe&&ze?(yt=Ze.C,Ze.C=ue.C,Ze.L=Fe,Fe.U=Ze,Ze!==ze?(be=Ze.U,Ze.U=ue.U,ue=Ze.R,be.L=ue,Ze.R=ze,ze.U=Ze):(Ze.U=be,be=Ze,ue=Ze.R)):(yt=ue.C,ue=Ze),ue&&(ue.U=be),!yt){if(ue&&ue.C){ue.C=!1;return}do{if(ue===this._)break;if(ue===be.L){if(Ee=be.R,Ee.C&&(Ee.C=!1,be.C=!0,Ma(this,be),Ee=be.R),Ee.L&&Ee.L.C||Ee.R&&Ee.R.C){(!Ee.R||!Ee.R.C)&&(Ee.L.C=!1,Ee.C=!0,po(this,Ee),Ee=be.R),Ee.C=be.C,be.C=Ee.R.C=!1,Ma(this,be),ue=this._;break}}else if(Ee=be.L,Ee.C&&(Ee.C=!1,be.C=!0,po(this,be),Ee=be.L),Ee.L&&Ee.L.C||Ee.R&&Ee.R.C){(!Ee.L||!Ee.L.C)&&(Ee.R.C=!1,Ee.C=!0,Ma(this,Ee),Ee=be.L),Ee.C=be.C,be.C=Ee.L.C=!1,po(this,be),ue=this._;break}Ee.C=!0,ue=be,be=be.U}while(!ue.C);ue&&(ue.C=!1)}}};function Ma(ue,be){var Ee=be,Fe=be.R,ze=Ee.U;ze?ze.L===Ee?ze.L=Fe:ze.R=Fe:ue._=Fe,Fe.U=ze,Ee.U=Fe,Ee.R=Fe.L,Ee.R&&(Ee.R.U=Ee),Fe.L=Ee}function po(ue,be){var Ee=be,Fe=be.L,ze=Ee.U;ze?ze.L===Ee?ze.L=Fe:ze.R=Fe:ue._=Fe,Fe.U=ze,Ee.U=Fe,Ee.L=Fe.R,Ee.L&&(Ee.L.U=Ee),Fe.R=Ee}function zo(ue){for(;ue.L;)ue=ue.L;return ue}function Ko(ue,be){var Ee=ue.sort(nl).pop(),Fe,ze,Ze;for(vn=[],on=new Array(ue.length),_n=new ma,ra=new ma;;)if(Ze=sa,Ee&&(!Ze||Ee.y<Ze.y||Ee.y===Ze.y&&Ee.x<Ze.x))(Ee.x!==Fe||Ee.y!==ze)&&(on[Ee.i]=new un(Ee),vr(Ee),Fe=Ee.x,ze=Ee.y),Ee=ue.pop();else if(Ze)It(Ze.arc);else break;be&&(dn(be),kn(be));var yt={cells:on,edges:vn};return _n=ra=vn=on=null,yt}function nl(ue,be){return be.y-ue.y||be.x-ue.x}w.geom.voronoi=function(ue){var be=Kn,Ee=Aa,Fe=be,ze=Ee,Ze=pl;if(ue)return yt(ue);function yt(St){var Nt=new Array(St.length),Xt=Ze[0][0],Kt=Ze[0][1],br=Ze[1][0],Zr=Ze[1][1];return Ko(ft(St),Ze).cells.forEach(function(nn,Mr){var zr=nn.edges,Gr=nn.site,qr=Nt[Mr]=zr.length?zr.map(function(tn){var Yr=tn.start();return[Yr.x,Yr.y]}):Gr.x>=Xt&&Gr.x<=br&&Gr.y>=Kt&&Gr.y<=Zr?[[Xt,Zr],[br,Zr],[br,Kt],[Xt,Kt]]:[];qr.point=St[Mr]}),Nt}function ft(St){return St.map(function(Nt,Xt){return{x:Math.round(Fe(Nt,Xt)/ct)*ct,y:Math.round(ze(Nt,Xt)/ct)*ct,i:Xt}})}return yt.links=function(St){return Ko(ft(St)).edges.filter(function(Nt){return Nt.l&&Nt.r}).map(function(Nt){return{source:St[Nt.l.i],target:St[Nt.r.i]}})},yt.triangles=function(St){var Nt=[];return Ko(ft(St)).cells.forEach(function(Xt,Kt){for(var br=Xt.site,Zr=Xt.edges.sort(bn),nn=-1,Mr=Zr.length,zr,Gr=Zr[Mr-1].edge,qr=Gr.l===br?Gr.r:Gr.l;++nn<Mr;)zr=qr,Gr=Zr[nn].edge,qr=Gr.l===br?Gr.r:Gr.l,Kt<zr.i&&Kt<qr.i&&Yl(br,zr,qr)<0&&Nt.push([St[Kt],St[zr.i],St[qr.i]])}),Nt},yt.x=function(St){return arguments.length?(Fe=tt(be=St),yt):be},yt.y=function(St){return arguments.length?(ze=tt(Ee=St),yt):Ee},yt.clipExtent=function(St){return arguments.length?(Ze=St==null?pl:St,yt):Ze===pl?null:Ze},yt.size=function(St){return arguments.length?yt.clipExtent(St&&[[0,0],St]):Ze===pl?null:Ze&&Ze[1]},yt};var pl=[[-1e6,-1e6],[1e6,1e6]];function Yl(ue,be,Ee){return(ue.x-Ee.x)*(be.y-ue.y)-(ue.x-be.x)*(Ee.y-ue.y)}w.geom.delaunay=function(ue){return w.geom.voronoi().triangles(ue)},w.geom.quadtree=function(ue,be,Ee,Fe,ze){var Ze=Kn,yt=Aa,ft;if(ft=arguments.length)return Ze=di,yt=Gs,ft===3&&(ze=Ee,Fe=be,Ee=be=0),St(ue);function St(Nt){var Xt,Kt=tt(Ze),br=tt(yt),Zr,nn,Mr,zr,Gr,qr,tn,Yr;if(be!=null)Gr=be,qr=Ee,tn=Fe,Yr=ze;else if(tn=Yr=-(Gr=qr=1/0),Zr=[],nn=[],zr=Nt.length,ft)for(Mr=0;Mr<zr;++Mr)Xt=Nt[Mr],Xt.x<Gr&&(Gr=Xt.x),Xt.y<qr&&(qr=Xt.y),Xt.x>tn&&(tn=Xt.x),Xt.y>Yr&&(Yr=Xt.y),Zr.push(Xt.x),nn.push(Xt.y);else for(Mr=0;Mr<zr;++Mr){var Un=+Kt(Xt=Nt[Mr],Mr),ta=+br(Xt,Mr);Un<Gr&&(Gr=Un),ta<qr&&(qr=ta),Un>tn&&(tn=Un),ta>Yr&&(Yr=ta),Zr.push(Un),nn.push(ta)}var _a=tn-Gr,ia=Yr-qr;_a>ia?Yr=qr+_a:tn=Gr+ia;function ka(Pa,Qa,xi,ho,Fi,fa,ni,Xa){if(!(isNaN(xi)||isNaN(ho)))if(Pa.leaf){var Ei=Pa.x,si=Pa.y;if(Ei!=null)if(u(Ei-xi)+u(si-ho)<.01)ua(Pa,Qa,xi,ho,Fi,fa,ni,Xa);else{var so=Pa.point;Pa.x=Pa.y=Pa.point=null,ua(Pa,so,Ei,si,Fi,fa,ni,Xa),ua(Pa,Qa,xi,ho,Fi,fa,ni,Xa)}else Pa.x=xi,Pa.y=ho,Pa.point=Qa}else ua(Pa,Qa,xi,ho,Fi,fa,ni,Xa)}function ua(Pa,Qa,xi,ho,Fi,fa,ni,Xa){var Ei=(Fi+ni)*.5,si=(fa+Xa)*.5,so=xi>=Ei,qi=ho>=si,mo=qi<<1|so;Pa.leaf=!1,Pa=Pa.nodes[mo]||(Pa.nodes[mo]=Rs()),so?Fi=Ei:ni=Ei,qi?fa=si:Xa=si,ka(Pa,Qa,xi,ho,Fi,fa,ni,Xa)}var Na=Rs();if(Na.add=function(Pa){ka(Na,Pa,+Kt(Pa,++Mr),+br(Pa,Mr),Gr,qr,tn,Yr)},Na.visit=function(Pa){Hi(Pa,Na,Gr,qr,tn,Yr)},Na.find=function(Pa){return So(Na,Pa[0],Pa[1],Gr,qr,tn,Yr)},Mr=-1,be==null){for(;++Mr<zr;)ka(Na,Nt[Mr],Zr[Mr],nn[Mr],Gr,qr,tn,Yr);--Mr}else Nt.forEach(Na.add);return Zr=nn=Nt=Xt=null,Na}return St.x=function(Nt){return arguments.length?(Ze=Nt,St):Ze},St.y=function(Nt){return arguments.length?(yt=Nt,St):yt},St.extent=function(Nt){return arguments.length?(Nt==null?be=Ee=Fe=ze=null:(be=+Nt[0][0],Ee=+Nt[0][1],Fe=+Nt[1][0],ze=+Nt[1][1]),St):be==null?null:[[be,Ee],[Fe,ze]]},St.size=function(Nt){return arguments.length?(Nt==null?be=Ee=Fe=ze=null:(be=Ee=0,Fe=+Nt[0],ze=+Nt[1]),St):be==null?null:[Fe-be,ze-Ee]},St};function di(ue){return ue.x}function Gs(ue){return ue.y}function Rs(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Hi(ue,be,Ee,Fe,ze,Ze){if(!ue(be,Ee,Fe,ze,Ze)){var yt=(Ee+ze)*.5,ft=(Fe+Ze)*.5,St=be.nodes;St[0]&&Hi(ue,St[0],Ee,Fe,yt,ft),St[1]&&Hi(ue,St[1],yt,Fe,ze,ft),St[2]&&Hi(ue,St[2],Ee,ft,yt,Ze),St[3]&&Hi(ue,St[3],yt,ft,ze,Ze)}}function So(ue,be,Ee,Fe,ze,Ze,yt){var ft=1/0,St;return function Nt(Xt,Kt,br,Zr,nn){if(!(Kt>Ze||br>yt||Zr<Fe||nn<ze)){if(Mr=Xt.point){var Mr,zr=be-Xt.x,Gr=Ee-Xt.y,qr=zr*zr+Gr*Gr;if(qr<ft){var tn=Math.sqrt(ft=qr);Fe=be-tn,ze=Ee-tn,Ze=be+tn,yt=Ee+tn,St=Mr}}for(var Yr=Xt.nodes,Un=(Kt+Zr)*.5,ta=(br+nn)*.5,_a=be>=Un,ia=Ee>=ta,ka=ia<<1|_a,ua=ka+4;ka<ua;++ka)if(Xt=Yr[ka&3])switch(ka&3){case 0:Nt(Xt,Kt,br,Un,ta);break;case 1:Nt(Xt,Un,br,Zr,ta);break;case 2:Nt(Xt,Kt,ta,Un,nn);break;case 3:Nt(Xt,Un,ta,Zr,nn);break}}}(ue,Fe,ze,Ze,yt),St}w.interpolateRgb=dl;function dl(ue,be){ue=w.rgb(ue),be=w.rgb(be);var Ee=ue.r,Fe=ue.g,ze=ue.b,Ze=be.r-Ee,yt=be.g-Fe,ft=be.b-ze;return function(St){return"#"+Vr(Math.round(Ee+Ze*St))+Vr(Math.round(Fe+yt*St))+Vr(Math.round(ze+ft*St))}}w.interpolateObject=ps;function ps(ue,be){var Ee={},Fe={},ze;for(ze in ue)ze in be?Ee[ze]=io(ue[ze],be[ze]):Fe[ze]=ue[ze];for(ze in be)ze in ue||(Fe[ze]=be[ze]);return function(Ze){for(ze in Ee)Fe[ze]=Ee[ze](Ze);return Fe}}w.interpolateNumber=Ii;function Ii(ue,be){return ue=+ue,be=+be,function(Ee){return ue*(1-Ee)+be*Ee}}w.interpolateString=al;function al(ue,be){var Ee=Qi.lastIndex=Bi.lastIndex=0,Fe,ze,Ze,yt=-1,ft=[],St=[];for(ue=ue+"",be=be+"";(Fe=Qi.exec(ue))&&(ze=Bi.exec(be));)(Ze=ze.index)>Ee&&(Ze=be.slice(Ee,Ze),ft[yt]?ft[yt]+=Ze:ft[++yt]=Ze),(Fe=Fe[0])===(ze=ze[0])?ft[yt]?ft[yt]+=ze:ft[++yt]=ze:(ft[++yt]=null,St.push({i:yt,x:Ii(Fe,ze)})),Ee=Bi.lastIndex;return Ee<be.length&&(Ze=be.slice(Ee),ft[yt]?ft[yt]+=Ze:ft[++yt]=Ze),ft.length<2?St[0]?(be=St[0].x,function(Nt){return be(Nt)+""}):function(){return be}:(be=St.length,function(Nt){for(var Xt=0,Kt;Xt<be;++Xt)ft[(Kt=St[Xt]).i]=Kt.x(Nt);return ft.join("")})}var Qi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Bi=new RegExp(Qi.source,"g");w.interpolate=io;function io(ue,be){for(var Ee=w.interpolators.length,Fe;--Ee>=0&&!(Fe=w.interpolators[Ee](ue,be)););return Fe}w.interpolators=[function(ue,be){var Ee=typeof be;return(Ee==="string"?Sr.has(be.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(be)?dl:al:be instanceof Vt?dl:Array.isArray(be)?$i:Ee==="object"&&isNaN(be)?ps:Ii)(ue,be)}],w.interpolateArray=$i;function $i(ue,be){var Ee=[],Fe=[],ze=ue.length,Ze=be.length,yt=Math.min(ue.length,be.length),ft;for(ft=0;ft<yt;++ft)Ee.push(io(ue[ft],be[ft]));for(;ft<ze;++ft)Fe[ft]=ue[ft];for(;ft<Ze;++ft)Fe[ft]=be[ft];return function(St){for(ft=0;ft<yt;++ft)Fe[ft]=Ee[ft](St);return Fe}}var rs=function(){return D},Ys=w.map({linear:rs,poly:ws,quad:function(){return ko},cubic:function(){return Mu},sin:function(){return Ll},exp:function(){return Su},circle:function(){return ku},elastic:Ws,back:Pl,bounce:function(){return Ts}}),au=w.map({in:D,out:iu,"in-out":Is,"out-in":function(ue){return Is(iu(ue))}});w.ease=function(ue){var be=ue.indexOf("-"),Ee=be>=0?ue.slice(0,be):ue,Fe=be>=0?ue.slice(be+1):"in";return Ee=Ys.get(Ee)||rs,Fe=au.get(Fe)||D,Jo(Fe(Ee.apply(null,c.call(arguments,1))))};function Jo(ue){return function(be){return be<=0?0:be>=1?1:ue(be)}}function iu(ue){return function(be){return 1-ue(1-be)}}function Is(ue){return function(be){return .5*(be<.5?ue(2*be):2-ue(2-2*be))}}function ko(ue){return ue*ue}function Mu(ue){return ue*ue*ue}function zs(ue){if(ue<=0)return 0;if(ue>=1)return 1;var be=ue*ue,Ee=be*ue;return 4*(ue<.5?Ee:3*(ue-be)+Ee-.75)}function ws(ue){return function(be){return Math.pow(be,ue)}}function Ll(ue){return 1-Math.cos(ue*st)}function Su(ue){return Math.pow(2,10*(ue-1))}function ku(ue){return 1-Math.sqrt(1-ue*ue)}function Ws(ue,be){var Ee;return arguments.length<2&&(be=.45),arguments.length?Ee=be/Ye*Math.asin(1/ue):(ue=1,Ee=be/4),function(Fe){return 1+ue*Math.pow(2,-10*Fe)*Math.sin((Fe-Ee)*Ye/be)}}function Pl(ue){return ue||(ue=1.70158),function(be){return be*be*((ue+1)*be-ue)}}function Ts(ue){return ue<1/2.75?7.5625*ue*ue:ue<2/2.75?7.5625*(ue-=1.5/2.75)*ue+.75:ue<2.5/2.75?7.5625*(ue-=2.25/2.75)*ue+.9375:7.5625*(ue-=2.625/2.75)*ue+.984375}w.interpolateHcl=Wl;function Wl(ue,be){ue=w.hcl(ue),be=w.hcl(be);var Ee=ue.h,Fe=ue.c,ze=ue.l,Ze=be.h-Ee,yt=be.c-Fe,ft=be.l-ze;return isNaN(yt)&&(yt=0,Fe=isNaN(Fe)?be.c:Fe),isNaN(Ze)?(Ze=0,Ee=isNaN(Ee)?be.h:Ee):Ze>180?Ze-=360:Ze<-180&&(Ze+=360),function(St){return Me(Ee+Ze*St,Fe+yt*St,ze+ft*St)+""}}w.interpolateHsl=il;function il(ue,be){ue=w.hsl(ue),be=w.hsl(be);var Ee=ue.h,Fe=ue.s,ze=ue.l,Ze=be.h-Ee,yt=be.s-Fe,ft=be.l-ze;return isNaN(yt)&&(yt=0,Fe=isNaN(Fe)?be.s:Fe),isNaN(Ze)?(Ze=0,Ee=isNaN(Ee)?be.h:Ee):Ze>180?Ze-=360:Ze<-180&&(Ze+=360),function(St){return yr(Ee+Ze*St,Fe+yt*St,ze+ft*St)+""}}w.interpolateLab=Xl;function Xl(ue,be){ue=w.lab(ue),be=w.lab(be);var Ee=ue.l,Fe=ue.a,ze=ue.b,Ze=be.l-Ee,yt=be.a-Fe,ft=be.b-ze;return function(St){return xt(Ee+Ze*St,Fe+yt*St,ze+ft*St)+""}}w.interpolateRound=ou;function ou(ue,be){return be-=ue,function(Ee){return Math.round(ue+be*Ee)}}w.transform=function(ue){var be=T.createElementNS(w.ns.prefix.svg,"g");return(w.transform=function(Ee){if(Ee!=null){be.setAttribute("transform",Ee);var Fe=be.transform.baseVal.consolidate()}return new Dl(Fe?Fe.matrix:Rl)})(ue)};function Dl(ue){var be=[ue.a,ue.b],Ee=[ue.c,ue.d],Fe=Xs(be),ze=Eu(be,Ee),Ze=Xs(Zl(Ee,be,-ze))||0;be[0]*Ee[1]<Ee[0]*be[1]&&(be[0]*=-1,be[1]*=-1,Fe*=-1,ze*=-1),this.rotate=(Fe?Math.atan2(be[1],be[0]):Math.atan2(-Ee[0],Ee[1]))*bt,this.translate=[ue.e,ue.f],this.scale=[Fe,Ze],this.skew=Ze?Math.atan2(ze,Ze)*bt:0}Dl.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function Eu(ue,be){return ue[0]*be[0]+ue[1]*be[1]}function Xs(ue){var be=Math.sqrt(Eu(ue,ue));return be&&(ue[0]/=be,ue[1]/=be),be}function Zl(ue,be,Ee){return ue[0]+=Ee*be[0],ue[1]+=Ee*be[1],ue}var Rl={a:1,b:0,c:0,d:1,e:0,f:0};w.interpolateTransform=Il;function ds(ue){return ue.length?ue.pop()+",":""}function yl(ue,be,Ee,Fe){if(ue[0]!==be[0]||ue[1]!==be[1]){var ze=Ee.push("translate(",null,",",null,")");Fe.push({i:ze-4,x:Ii(ue[0],be[0])},{i:ze-2,x:Ii(ue[1],be[1])})}else(be[0]||be[1])&&Ee.push("translate("+be+")")}function jl(ue,be,Ee,Fe){ue!==be?(ue-be>180?be+=360:be-ue>180&&(ue+=360),Fe.push({i:Ee.push(ds(Ee)+"rotate(",null,")")-2,x:Ii(ue,be)})):be&&Ee.push(ds(Ee)+"rotate("+be+")")}function su(ue,be,Ee,Fe){ue!==be?Fe.push({i:Ee.push(ds(Ee)+"skewX(",null,")")-2,x:Ii(ue,be)}):be&&Ee.push(ds(Ee)+"skewX("+be+")")}function lu(ue,be,Ee,Fe){if(ue[0]!==be[0]||ue[1]!==be[1]){var ze=Ee.push(ds(Ee)+"scale(",null,",",null,")");Fe.push({i:ze-4,x:Ii(ue[0],be[0])},{i:ze-2,x:Ii(ue[1],be[1])})}else(be[0]!==1||be[1]!==1)&&Ee.push(ds(Ee)+"scale("+be+")")}function Il(ue,be){var Ee=[],Fe=[];return ue=w.transform(ue),be=w.transform(be),yl(ue.translate,be.translate,Ee,Fe),jl(ue.rotate,be.rotate,Ee,Fe),su(ue.skew,be.skew,Ee,Fe),lu(ue.scale,be.scale,Ee,Fe),ue=be=null,function(ze){for(var Ze=-1,yt=Fe.length,ft;++Ze<yt;)Ee[(ft=Fe[Ze]).i]=ft.x(ze);return Ee.join("")}}function Cu(ue,be){return be=(be-=ue=+ue)||1/be,function(Ee){return(Ee-ue)/be}}function uu(ue,be){return be=(be-=ue=+ue)||1/be,function(Ee){return Math.max(0,Math.min(1,(Ee-ue)/be))}}w.layout={},w.layout.bundle=function(){return function(ue){for(var be=[],Ee=-1,Fe=ue.length;++Ee<Fe;)be.push(Qo(ue[Ee]));return be}};function Qo(ue){for(var be=ue.source,Ee=ue.target,Fe=sl(be,Ee),ze=[be];be!==Fe;)be=be.parent,ze.push(be);for(var Ze=ze.length;Ee!==Fe;)ze.splice(Ze,0,Ee),Ee=Ee.parent;return ze}function ol(ue){for(var be=[],Ee=ue.parent;Ee!=null;)be.push(ue),ue=Ee,Ee=Ee.parent;return be.push(ue),be}function sl(ue,be){if(ue===be)return ue;for(var Ee=ol(ue),Fe=ol(be),ze=Ee.pop(),Ze=Fe.pop(),yt=null;ze===Ze;)yt=ze,ze=Ee.pop(),Ze=Fe.pop();return yt}w.layout.chord=function(){var ue={},be,Ee,Fe,ze,Ze=0,yt,ft,St;function Nt(){var Kt={},br=[],Zr=w.range(ze),nn=[],Mr,zr,Gr,qr,tn;for(be=[],Ee=[],Mr=0,qr=-1;++qr<ze;){for(zr=0,tn=-1;++tn<ze;)zr+=Fe[qr][tn];br.push(zr),nn.push(w.range(ze)),Mr+=zr}for(yt&&Zr.sort(function(Na,Pa){return yt(br[Na],br[Pa])}),ft&&nn.forEach(function(Na,Pa){Na.sort(function(Qa,xi){return ft(Fe[Pa][Qa],Fe[Pa][xi])})}),Mr=(Ye-Ze*ze)/Mr,zr=0,qr=-1;++qr<ze;){for(Gr=zr,tn=-1;++tn<ze;){var Yr=Zr[qr],Un=nn[Yr][tn],ta=Fe[Yr][Un],_a=zr,ia=zr+=ta*Mr;Kt[Yr+"-"+Un]={index:Yr,subindex:Un,startAngle:_a,endAngle:ia,value:ta}}Ee[Yr]={index:Yr,startAngle:Gr,endAngle:zr,value:br[Yr]},zr+=Ze}for(qr=-1;++qr<ze;)for(tn=qr-1;++tn<ze;){var ka=Kt[qr+"-"+tn],ua=Kt[tn+"-"+qr];(ka.value||ua.value)&&be.push(ka.value<ua.value?{source:ua,target:ka}:{source:ka,target:ua})}St&&Xt()}function Xt(){be.sort(function(Kt,br){return St((Kt.source.value+Kt.target.value)/2,(br.source.value+br.target.value)/2)})}return ue.matrix=function(Kt){return arguments.length?(ze=(Fe=Kt)&&Fe.length,be=Ee=null,ue):Fe},ue.padding=function(Kt){return arguments.length?(Ze=Kt,be=Ee=null,ue):Ze},ue.sortGroups=function(Kt){return arguments.length?(yt=Kt,be=Ee=null,ue):yt},ue.sortSubgroups=function(Kt){return arguments.length?(ft=Kt,be=null,ue):ft},ue.sortChords=function(Kt){return arguments.length?(St=Kt,be&&Xt(),ue):St},ue.chords=function(){return be||Nt(),be},ue.groups=function(){return Ee||Nt(),Ee},ue},w.layout.force=function(){var ue={},be=w.dispatch("start","tick","end"),Ee,Fe=[1,1],ze,Ze,yt=.9,ft=Ms,St=lo,Nt=-30,Xt=ml,Kt=.1,br=.64,Zr=[],nn=[],Mr,zr,Gr;function qr(Yr){return function(Un,ta,_a,ia){if(Un.point!==Yr){var ka=Un.cx-Yr.x,ua=Un.cy-Yr.y,Na=ia-ta,Pa=ka*ka+ua*ua;if(Na*Na/br<Pa){if(Pa<Xt){var Qa=Un.charge/Pa;Yr.px-=ka*Qa,Yr.py-=ua*Qa}return!0}if(Un.point&&Pa&&Pa<Xt){var Qa=Un.pointCharge/Pa;Yr.px-=ka*Qa,Yr.py-=ua*Qa}}return!Un.charge}}ue.tick=function(){if((Ze*=.99)<.005)return Ee=null,be.end({type:"end",alpha:Ze=0}),!0;var Yr=Zr.length,Un=nn.length,ta,_a,ia,ka,ua,Na,Pa,Qa,xi;for(_a=0;_a<Un;++_a)ia=nn[_a],ka=ia.source,ua=ia.target,Qa=ua.x-ka.x,xi=ua.y-ka.y,(Na=Qa*Qa+xi*xi)&&(Na=Ze*zr[_a]*((Na=Math.sqrt(Na))-Mr[_a])/Na,Qa*=Na,xi*=Na,ua.x-=Qa*(Pa=ka.weight+ua.weight?ka.weight/(ka.weight+ua.weight):.5),ua.y-=xi*Pa,ka.x+=Qa*(Pa=1-Pa),ka.y+=xi*Pa);if((Pa=Ze*Kt)&&(Qa=Fe[0]/2,xi=Fe[1]/2,_a=-1,Pa))for(;++_a<Yr;)ia=Zr[_a],ia.x+=(Qa-ia.x)*Pa,ia.y+=(xi-ia.y)*Pa;if(Nt)for(As(ta=w.geom.quadtree(Zr),Ze,Gr),_a=-1;++_a<Yr;)(ia=Zr[_a]).fixed||ta.visit(qr(ia));for(_a=-1;++_a<Yr;)ia=Zr[_a],ia.fixed?(ia.x=ia.px,ia.y=ia.py):(ia.x-=(ia.px-(ia.px=ia.x))*yt,ia.y-=(ia.py-(ia.py=ia.y))*yt);be.tick({type:"tick",alpha:Ze})},ue.nodes=function(Yr){return arguments.length?(Zr=Yr,ue):Zr},ue.links=function(Yr){return arguments.length?(nn=Yr,ue):nn},ue.size=function(Yr){return arguments.length?(Fe=Yr,ue):Fe},ue.linkDistance=function(Yr){return arguments.length?(ft=typeof Yr=="function"?Yr:+Yr,ue):ft},ue.distance=ue.linkDistance,ue.linkStrength=function(Yr){return arguments.length?(St=typeof Yr=="function"?Yr:+Yr,ue):St},ue.friction=function(Yr){return arguments.length?(yt=+Yr,ue):yt},ue.charge=function(Yr){return arguments.length?(Nt=typeof Yr=="function"?Yr:+Yr,ue):Nt},ue.chargeDistance=function(Yr){return arguments.length?(Xt=Yr*Yr,ue):Math.sqrt(Xt)},ue.gravity=function(Yr){return arguments.length?(Kt=+Yr,ue):Kt},ue.theta=function(Yr){return arguments.length?(br=Yr*Yr,ue):Math.sqrt(br)},ue.alpha=function(Yr){return arguments.length?(Yr=+Yr,Ze?Yr>0?Ze=Yr:(Ee.c=null,Ee.t=NaN,Ee=null,be.end({type:"end",alpha:Ze=0})):Yr>0&&(be.start({type:"start",alpha:Ze=Yr}),Ee=An(ue.tick)),ue):Ze},ue.start=function(){var Yr,Un=Zr.length,ta=nn.length,_a=Fe[0],ia=Fe[1],ka,ua;for(Yr=0;Yr<Un;++Yr)(ua=Zr[Yr]).index=Yr,ua.weight=0;for(Yr=0;Yr<ta;++Yr)ua=nn[Yr],typeof ua.source=="number"&&(ua.source=Zr[ua.source]),typeof ua.target=="number"&&(ua.target=Zr[ua.target]),++ua.source.weight,++ua.target.weight;for(Yr=0;Yr<Un;++Yr)ua=Zr[Yr],isNaN(ua.x)&&(ua.x=Na("x",_a)),isNaN(ua.y)&&(ua.y=Na("y",ia)),isNaN(ua.px)&&(ua.px=ua.x),isNaN(ua.py)&&(ua.py=ua.y);if(Mr=[],typeof ft=="function")for(Yr=0;Yr<ta;++Yr)Mr[Yr]=+ft.call(this,nn[Yr],Yr);else for(Yr=0;Yr<ta;++Yr)Mr[Yr]=ft;if(zr=[],typeof St=="function")for(Yr=0;Yr<ta;++Yr)zr[Yr]=+St.call(this,nn[Yr],Yr);else for(Yr=0;Yr<ta;++Yr)zr[Yr]=St;if(Gr=[],typeof Nt=="function")for(Yr=0;Yr<Un;++Yr)Gr[Yr]=+Nt.call(this,Zr[Yr],Yr);else for(Yr=0;Yr<Un;++Yr)Gr[Yr]=Nt;function Na(Pa,Qa){if(!ka){for(ka=new Array(Un),Fi=0;Fi<Un;++Fi)ka[Fi]=[];for(Fi=0;Fi<ta;++Fi){var xi=nn[Fi];ka[xi.source.index].push(xi.target),ka[xi.target.index].push(xi.source)}}for(var ho=ka[Yr],Fi=-1,fa=ho.length,ni;++Fi<fa;)if(!isNaN(ni=ho[Fi][Pa]))return ni;return Math.random()*Qa}return ue.resume()},ue.resume=function(){return ue.alpha(.1)},ue.stop=function(){return ue.alpha(0)},ue.drag=function(){if(ze||(ze=w.behavior.drag().origin(D).on("dragstart.force",Kl).on("drag.force",tn).on("dragend.force",gs)),!arguments.length)return ze;this.on("mouseover.force",Eo).on("mouseout.force",zl).call(ze)};function tn(Yr){Yr.px=w.event.x,Yr.py=w.event.y,ue.resume()}return w.rebind(ue,be,"on")};function Kl(ue){ue.fixed|=2}function gs(ue){ue.fixed&=-7}function Eo(ue){ue.fixed|=4,ue.px=ue.x,ue.py=ue.y}function zl(ue){ue.fixed&=-5}function As(ue,be,Ee){var Fe=0,ze=0;if(ue.charge=0,!ue.leaf)for(var Ze=ue.nodes,yt=Ze.length,ft=-1,St;++ft<yt;)St=Ze[ft],St!=null&&(As(St,be,Ee),ue.charge+=St.charge,Fe+=St.charge*St.cx,ze+=St.charge*St.cy);if(ue.point){ue.leaf||(ue.point.x+=Math.random()-.5,ue.point.y+=Math.random()-.5);var Nt=be*Ee[ue.point.index];ue.charge+=ue.pointCharge=Nt,Fe+=Nt*ue.point.x,ze+=Nt*ue.point.y}ue.cx=Fe/ue.charge,ue.cy=ze/ue.charge}var Ms=20,lo=1,ml=1/0;w.layout.hierarchy=function(){var ue=Fl,be=bl,Ee=ll;function Fe(ze){var Ze=[ze],yt=[],ft;for(ze.depth=0;(ft=Ze.pop())!=null;)if(yt.push(ft),(Nt=be.call(Fe,ft,ft.depth))&&(St=Nt.length)){for(var St,Nt,Xt;--St>=0;)Ze.push(Xt=Nt[St]),Xt.parent=ft,Xt.depth=ft.depth+1;Ee&&(ft.value=0),ft.children=Nt}else Ee&&(ft.value=+Ee.call(Fe,ft,ft.depth)||0),delete ft.children;return ys(ze,function(Kt){var br,Zr;ue&&(br=Kt.children)&&br.sort(ue),Ee&&(Zr=Kt.parent)&&(Zr.value+=Kt.value)}),yt}return Fe.sort=function(ze){return arguments.length?(ue=ze,Fe):ue},Fe.children=function(ze){return arguments.length?(be=ze,Fe):be},Fe.value=function(ze){return arguments.length?(Ee=ze,Fe):Ee},Fe.revalue=function(ze){return Ee&&(Zs(ze,function(Ze){Ze.children&&(Ze.value=0)}),ys(ze,function(Ze){var yt;Ze.children||(Ze.value=+Ee.call(Fe,Ze,Ze.depth)||0),(yt=Ze.parent)&&(yt.value+=Ze.value)})),ze},Fe};function xl(ue,be){return w.rebind(ue,be,"sort","children","value"),ue.nodes=ue,ue.links=_l,ue}function Zs(ue,be){for(var Ee=[ue];(ue=Ee.pop())!=null;)if(be(ue),(ze=ue.children)&&(Fe=ze.length))for(var Fe,ze;--Fe>=0;)Ee.push(ze[Fe])}function ys(ue,be){for(var Ee=[ue],Fe=[];(ue=Ee.pop())!=null;)if(Fe.push(ue),(yt=ue.children)&&(Ze=yt.length))for(var ze=-1,Ze,yt;++ze<Ze;)Ee.push(yt[ze]);for(;(ue=Fe.pop())!=null;)be(ue)}function bl(ue){return ue.children}function ll(ue){return ue.value}function Fl(ue,be){return be.value-ue.value}function _l(ue){return w.merge(ue.map(function(be){return(be.children||[]).map(function(Ee){return{source:be,target:Ee}})}))}w.layout.partition=function(){var ue=w.layout.hierarchy(),be=[1,1];function Ee(Ze,yt,ft,St){var Nt=Ze.children;if(Ze.x=yt,Ze.y=Ze.depth*St,Ze.dx=ft,Ze.dy=St,Nt&&(Kt=Nt.length)){var Xt=-1,Kt,br,Zr;for(ft=Ze.value?ft/Ze.value:0;++Xt<Kt;)Ee(br=Nt[Xt],yt,Zr=br.value*ft,St),yt+=Zr}}function Fe(Ze){var yt=Ze.children,ft=0;if(yt&&(Nt=yt.length))for(var St=-1,Nt;++St<Nt;)ft=Math.max(ft,Fe(yt[St]));return 1+ft}function ze(Ze,yt){var ft=ue.call(this,Ze,yt);return Ee(ft[0],0,be[0],be[1]/Fe(ft[0])),ft}return ze.size=function(Ze){return arguments.length?(be=Ze,ze):be},xl(ze,ue)},w.layout.pie=function(){var ue=Number,be=js,Ee=0,Fe=Ye,ze=0;function Ze(yt){var ft=yt.length,St=yt.map(function(qr,tn){return+ue.call(Ze,qr,tn)}),Nt=+(typeof Ee=="function"?Ee.apply(this,arguments):Ee),Xt=(typeof Fe=="function"?Fe.apply(this,arguments):Fe)-Nt,Kt=Math.min(Math.abs(Xt)/ft,+(typeof ze=="function"?ze.apply(this,arguments):ze)),br=Kt*(Xt<0?-1:1),Zr=w.sum(St),nn=Zr?(Xt-ft*br)/Zr:0,Mr=w.range(ft),zr=[],Gr;return be!=null&&Mr.sort(be===js?function(qr,tn){return St[tn]-St[qr]}:function(qr,tn){return be(yt[qr],yt[tn])}),Mr.forEach(function(qr){zr[qr]={data:yt[qr],value:Gr=St[qr],startAngle:Nt,endAngle:Nt+=Gr*nn+br,padAngle:Kt}}),zr}return Ze.value=function(yt){return arguments.length?(ue=yt,Ze):ue},Ze.sort=function(yt){return arguments.length?(be=yt,Ze):be},Ze.startAngle=function(yt){return arguments.length?(Ee=yt,Ze):Ee},Ze.endAngle=function(yt){return arguments.length?(Fe=yt,Ze):Fe},Ze.padAngle=function(yt){return arguments.length?(ze=yt,Ze):ze},Ze};var js={};w.layout.stack=function(){var ue=D,be=wl,Ee=Ks,Fe=Yu,ze=Lu,Ze=ns;function yt(ft,St){if(!(nn=ft.length))return ft;var Nt=ft.map(function(qr,tn){return ue.call(yt,qr,tn)}),Xt=Nt.map(function(qr){return qr.map(function(tn,Yr){return[ze.call(yt,tn,Yr),Ze.call(yt,tn,Yr)]})}),Kt=be.call(yt,Xt,St);Nt=w.permute(Nt,Kt),Xt=w.permute(Xt,Kt);var br=Ee.call(yt,Xt,St),Zr=Nt[0].length,nn,Mr,zr,Gr;for(zr=0;zr<Zr;++zr)for(Fe.call(yt,Nt[0][zr],Gr=br[zr],Xt[0][zr][1]),Mr=1;Mr<nn;++Mr)Fe.call(yt,Nt[Mr][zr],Gr+=Xt[Mr-1][zr][1],Xt[Mr][zr][1]);return ft}return yt.values=function(ft){return arguments.length?(ue=ft,yt):ue},yt.order=function(ft){return arguments.length?(be=typeof ft=="function"?ft:Jl.get(ft)||wl,yt):be},yt.offset=function(ft){return arguments.length?(Ee=typeof ft=="function"?ft:ul.get(ft)||Ks,yt):Ee},yt.x=function(ft){return arguments.length?(ze=ft,yt):ze},yt.y=function(ft){return arguments.length?(Ze=ft,yt):Ze},yt.out=function(ft){return arguments.length?(Fe=ft,yt):Fe},yt};function Lu(ue){return ue.x}function ns(ue){return ue.y}function Yu(ue,be,Ee){ue.y0=be,ue.y=Ee}var Jl=w.map({"inside-out":function(ue){var be=ue.length,Ee,Fe,ze=ue.map(Tl),Ze=ue.map(fu),yt=w.range(be).sort(function(Kt,br){return ze[Kt]-ze[br]}),ft=0,St=0,Nt=[],Xt=[];for(Ee=0;Ee<be;++Ee)Fe=yt[Ee],ft<St?(ft+=Ze[Fe],Nt.push(Fe)):(St+=Ze[Fe],Xt.push(Fe));return Xt.reverse().concat(Nt)},reverse:function(ue){return w.range(ue.length).reverse()},default:wl}),ul=w.map({silhouette:function(ue){var be=ue.length,Ee=ue[0].length,Fe=[],ze=0,Ze,yt,ft,St=[];for(yt=0;yt<Ee;++yt){for(Ze=0,ft=0;Ze<be;Ze++)ft+=ue[Ze][yt][1];ft>ze&&(ze=ft),Fe.push(ft)}for(yt=0;yt<Ee;++yt)St[yt]=(ze-Fe[yt])/2;return St},wiggle:function(ue){var be=ue.length,Ee=ue[0],Fe=Ee.length,ze,Ze,yt,ft,St,Nt,Xt,Kt,br,Zr=[];for(Zr[0]=Kt=br=0,Ze=1;Ze<Fe;++Ze){for(ze=0,ft=0;ze<be;++ze)ft+=ue[ze][Ze][1];for(ze=0,St=0,Xt=Ee[Ze][0]-Ee[Ze-1][0];ze<be;++ze){for(yt=0,Nt=(ue[ze][Ze][1]-ue[ze][Ze-1][1])/(2*Xt);yt<ze;++yt)Nt+=(ue[yt][Ze][1]-ue[yt][Ze-1][1])/Xt;St+=Nt*ue[ze][Ze][1]}Zr[Ze]=Kt-=ft?St/ft*Xt:0,Kt<br&&(br=Kt)}for(Ze=0;Ze<Fe;++Ze)Zr[Ze]-=br;return Zr},expand:function(ue){var be=ue.length,Ee=ue[0].length,Fe=1/be,ze,Ze,yt,ft=[];for(Ze=0;Ze<Ee;++Ze){for(ze=0,yt=0;ze<be;ze++)yt+=ue[ze][Ze][1];if(yt)for(ze=0;ze<be;ze++)ue[ze][Ze][1]/=yt;else for(ze=0;ze<be;ze++)ue[ze][Ze][1]=Fe}for(Ze=0;Ze<Ee;++Ze)ft[Ze]=0;return ft},zero:Ks});function wl(ue){return w.range(ue.length)}function Ks(ue){for(var be=-1,Ee=ue[0].length,Fe=[];++be<Ee;)Fe[be]=0;return Fe}function Tl(ue){for(var be=1,Ee=0,Fe=ue[0][1],ze,Ze=ue.length;be<Ze;++be)(ze=ue[be][1])>Fe&&(Ee=be,Fe=ze);return Ee}function fu(ue){return ue.reduce(cu,0)}function cu(ue,be){return ue+be[1]}w.layout.histogram=function(){var ue=!0,be=Number,Ee=fl,Fe=Wu;function ze(Ze,br){for(var ft=[],St=Ze.map(be,this),Nt=Ee.call(this,St,br),Xt=Fe.call(this,Nt,St,br),Kt,br=-1,Zr=St.length,nn=Xt.length-1,Mr=ue?1:1/Zr,zr;++br<nn;)Kt=ft[br]=[],Kt.dx=Xt[br+1]-(Kt.x=Xt[br]),Kt.y=0;if(nn>0)for(br=-1;++br<Zr;)zr=St[br],zr>=Nt[0]&&zr<=Nt[1]&&(Kt=ft[w.bisect(Xt,zr,1,nn)-1],Kt.y+=Mr,Kt.push(Ze[br]));return ft}return ze.value=function(Ze){return arguments.length?(be=Ze,ze):be},ze.range=function(Ze){return arguments.length?(Ee=tt(Ze),ze):Ee},ze.bins=function(Ze){return arguments.length?(Fe=typeof Ze=="number"?function(yt){return zi(yt,Ze)}:tt(Ze),ze):Fe},ze.frequency=function(Ze){return arguments.length?(ue=!!Ze,ze):ue},ze};function Wu(ue,be){return zi(ue,Math.ceil(Math.log(be.length)/Math.LN2+1))}function zi(ue,be){for(var Ee=-1,Fe=+ue[0],ze=(ue[1]-Fe)/be,Ze=[];++Ee<=be;)Ze[Ee]=ze*Ee+Fe;return Ze}function fl(ue){return[w.min(ue),w.max(ue)]}w.layout.pack=function(){var ue=w.layout.hierarchy().sort(Js),be=0,Ee=[1,1],Fe;function ze(Ze,yt){var ft=ue.call(this,Ze,yt),St=ft[0],Nt=Ee[0],Xt=Ee[1],Kt=Fe==null?Math.sqrt:typeof Fe=="function"?Fe:function(){return Fe};if(St.x=St.y=0,ys(St,function(Zr){Zr.r=+Kt(Zr.value)}),ys(St,uo),be){var br=be*(Fe?1:Math.max(2*St.r/Nt,2*St.r/Xt))/2;ys(St,function(Zr){Zr.r+=br}),ys(St,uo),ys(St,function(Zr){Zr.r-=br})}return Fs(St,Nt/2,Xt/2,Fe?1:1/Math.max(2*St.r/Nt,2*St.r/Xt)),ft}return ze.size=function(Ze){return arguments.length?(Ee=Ze,ze):Ee},ze.radius=function(Ze){return arguments.length?(Fe=Ze==null||typeof Ze=="function"?Ze:+Ze,ze):Fe},ze.padding=function(Ze){return arguments.length?(be=+Ze,ze):be},xl(ze,ue)};function Js(ue,be){return ue.value-be.value}function $o(ue,be){var Ee=ue._pack_next;ue._pack_next=be,be._pack_prev=ue,be._pack_next=Ee,Ee._pack_prev=be}function as(ue,be){ue._pack_next=be,be._pack_prev=ue}function Al(ue,be){var Ee=be.x-ue.x,Fe=be.y-ue.y,ze=ue.r+be.r;return .999*ze*ze>Ee*Ee+Fe*Fe}function uo(ue){if(!(be=ue.children)||!(br=be.length))return;var be,Ee=1/0,Fe=-1/0,ze=1/0,Ze=-1/0,yt,ft,St,Nt,Xt,Kt,br;function Zr(Yr){Ee=Math.min(Yr.x-Yr.r,Ee),Fe=Math.max(Yr.x+Yr.r,Fe),ze=Math.min(Yr.y-Yr.r,ze),Ze=Math.max(Yr.y+Yr.r,Ze)}if(be.forEach(hu),yt=be[0],yt.x=-yt.r,yt.y=0,Zr(yt),br>1&&(ft=be[1],ft.x=ft.r,ft.y=0,Zr(ft),br>2))for(St=be[2],Os(yt,ft,St),Zr(St),$o(yt,St),yt._pack_prev=St,$o(St,ft),ft=yt._pack_next,Nt=3;Nt<br;Nt++){Os(yt,ft,St=be[Nt]);var nn=0,Mr=1,zr=1;for(Xt=ft._pack_next;Xt!==ft;Xt=Xt._pack_next,Mr++)if(Al(Xt,St)){nn=1;break}if(nn==1)for(Kt=yt._pack_prev;Kt!==Xt._pack_prev&&!Al(Kt,St);Kt=Kt._pack_prev,zr++);nn?(Mr<zr||Mr==zr&&ft.r<yt.r?as(yt,ft=Xt):as(yt=Kt,ft),Nt--):($o(yt,St),ft=St,Zr(St))}var Gr=(Ee+Fe)/2,qr=(ze+Ze)/2,tn=0;for(Nt=0;Nt<br;Nt++)St=be[Nt],St.x-=Gr,St.y-=qr,tn=Math.max(tn,St.r+Math.sqrt(St.x*St.x+St.y*St.y));ue.r=tn,be.forEach(is)}function hu(ue){ue._pack_next=ue._pack_prev=ue}function is(ue){delete ue._pack_next,delete ue._pack_prev}function Fs(ue,be,Ee,Fe){var ze=ue.children;if(ue.x=be+=Fe*ue.x,ue.y=Ee+=Fe*ue.y,ue.r*=Fe,ze)for(var Ze=-1,yt=ze.length;++Ze<yt;)Fs(ze[Ze],be,Ee,Fe)}function Os(ue,be,Ee){var Fe=ue.r+Ee.r,ze=be.x-ue.x,Ze=be.y-ue.y;if(Fe&&(ze||Ze)){var yt=be.r+Ee.r,ft=ze*ze+Ze*Ze;yt*=yt,Fe*=Fe;var St=.5+(Fe-yt)/(2*ft),Nt=Math.sqrt(Math.max(0,2*yt*(Fe+ft)-(Fe-=ft)*Fe-yt*yt))/(2*ft);Ee.x=ue.x+St*ze+Nt*Ze,Ee.y=ue.y+St*Ze-Nt*ze}else Ee.x=ue.x+Fe,Ee.y=ue.y}w.layout.tree=function(){var ue=w.layout.hierarchy().sort(null).value(null),be=Ss,Ee=[1,1],Fe=null;function ze(Xt,Kt){var br=ue.call(this,Xt,Kt),Zr=br[0],nn=Ze(Zr);if(ys(nn,yt),nn.parent.m=-nn.z,Zs(nn,ft),Fe)Zs(Zr,Nt);else{var Mr=Zr,zr=Zr,Gr=Zr;Zs(Zr,function(Un){Un.x<Mr.x&&(Mr=Un),Un.x>zr.x&&(zr=Un),Un.depth>Gr.depth&&(Gr=Un)});var qr=be(Mr,zr)/2-Mr.x,tn=Ee[0]/(zr.x+be(zr,Mr)/2+qr),Yr=Ee[1]/(Gr.depth||1);Zs(Zr,function(Un){Un.x=(Un.x+qr)*tn,Un.y=Un.depth*Yr})}return br}function Ze(Xt){for(var Kt={A:null,children:[Xt]},br=[Kt],Zr;(Zr=br.pop())!=null;)for(var nn=Zr.children,Mr,zr=0,Gr=nn.length;zr<Gr;++zr)br.push((nn[zr]=Mr={_:nn[zr],parent:Zr,children:(Mr=nn[zr].children)&&Mr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:zr}).a=Mr);return Kt.children[0]}function yt(Xt){var Kt=Xt.children,br=Xt.parent.children,Zr=Xt.i?br[Xt.i-1]:null;if(Kt.length){ss(Xt);var nn=(Kt[0].z+Kt[Kt.length-1].z)/2;Zr?(Xt.z=Zr.z+be(Xt._,Zr._),Xt.m=Xt.z-nn):Xt.z=nn}else Zr&&(Xt.z=Zr.z+be(Xt._,Zr._));Xt.parent.A=St(Xt,Zr,Xt.parent.A||br[0])}function ft(Xt){Xt._.x=Xt.z+Xt.parent.m,Xt.m+=Xt.parent.m}function St(Xt,Kt,br){if(Kt){for(var Zr=Xt,nn=Xt,Mr=Kt,zr=Zr.parent.children[0],Gr=Zr.m,qr=nn.m,tn=Mr.m,Yr=zr.m,Un;Mr=Gi(Mr),Zr=os(Zr),Mr&&Zr;)zr=os(zr),nn=Gi(nn),nn.a=Xt,Un=Mr.z+tn-Zr.z-Gr+be(Mr._,Zr._),Un>0&&(Co(vu(Mr,Xt,br),Xt,Un),Gr+=Un,qr+=Un),tn+=Mr.m,Gr+=Zr.m,Yr+=zr.m,qr+=nn.m;Mr&&!Gi(nn)&&(nn.t=Mr,nn.m+=tn-qr),Zr&&!os(zr)&&(zr.t=Zr,zr.m+=Gr-Yr,br=Xt)}return br}function Nt(Xt){Xt.x*=Ee[0],Xt.y=Xt.depth*Ee[1]}return ze.separation=function(Xt){return arguments.length?(be=Xt,ze):be},ze.size=function(Xt){return arguments.length?(Fe=(Ee=Xt)==null?Nt:null,ze):Fe?null:Ee},ze.nodeSize=function(Xt){return arguments.length?(Fe=(Ee=Xt)==null?null:Nt,ze):Fe?Ee:null},xl(ze,ue)};function Ss(ue,be){return ue.parent==be.parent?1:2}function os(ue){var be=ue.children;return be.length?be[0]:ue.t}function Gi(ue){var be=ue.children,Ee;return(Ee=be.length)?be[Ee-1]:ue.t}function Co(ue,be,Ee){var Fe=Ee/(be.i-ue.i);be.c-=Fe,be.s+=Ee,ue.c+=Fe,be.z+=Ee,be.m+=Ee}function ss(ue){for(var be=0,Ee=0,Fe=ue.children,ze=Fe.length,Ze;--ze>=0;)Ze=Fe[ze],Ze.z+=be,Ze.m+=be,be+=Ze.s+(Ee+=Ze.c)}function vu(ue,be,Ee){return ue.a.parent===be.parent?ue.a:Ee}w.layout.cluster=function(){var ue=w.layout.hierarchy().sort(null).value(null),be=Ss,Ee=[1,1],Fe=!1;function ze(Ze,yt){var ft=ue.call(this,Ze,yt),St=ft[0],Nt,Xt=0;ys(St,function(Mr){var zr=Mr.children;zr&&zr.length?(Mr.x=pu(zr),Mr.y=Ol(zr)):(Mr.x=Nt?Xt+=be(Mr,Nt):0,Mr.y=0,Nt=Mr)});var Kt=dt(St),br=Dt(St),Zr=Kt.x-be(Kt,br)/2,nn=br.x+be(br,Kt)/2;return ys(St,Fe?function(Mr){Mr.x=(Mr.x-St.x)*Ee[0],Mr.y=(St.y-Mr.y)*Ee[1]}:function(Mr){Mr.x=(Mr.x-Zr)/(nn-Zr)*Ee[0],Mr.y=(1-(St.y?Mr.y/St.y:1))*Ee[1]}),ft}return ze.separation=function(Ze){return arguments.length?(be=Ze,ze):be},ze.size=function(Ze){return arguments.length?(Fe=(Ee=Ze)==null,ze):Fe?null:Ee},ze.nodeSize=function(Ze){return arguments.length?(Fe=(Ee=Ze)!=null,ze):Fe?Ee:null},xl(ze,ue)};function Ol(ue){return 1+w.max(ue,function(be){return be.y})}function pu(ue){return ue.reduce(function(be,Ee){return be+Ee.x},0)/ue.length}function dt(ue){var be=ue.children;return be&&be.length?dt(be[0]):ue}function Dt(ue){var be=ue.children,Ee;return be&&(Ee=be.length)?Dt(be[Ee-1]):ue}w.layout.treemap=function(){var ue=w.layout.hierarchy(),be=Math.round,Ee=[1,1],Fe=null,ze=or,Ze=!1,yt,ft="squarify",St=.5*(1+Math.sqrt(5));function Nt(Mr,zr){for(var Gr=-1,qr=Mr.length,tn,Yr;++Gr<qr;)Yr=(tn=Mr[Gr]).value*(zr<0?0:zr),tn.area=isNaN(Yr)||Yr<=0?0:Yr}function Xt(Mr){var zr=Mr.children;if(zr&&zr.length){var Gr=ze(Mr),qr=[],tn=zr.slice(),Yr,Un=1/0,ta,_a=ft==="slice"?Gr.dx:ft==="dice"?Gr.dy:ft==="slice-dice"?Mr.depth&1?Gr.dy:Gr.dx:Math.min(Gr.dx,Gr.dy),ia;for(Nt(tn,Gr.dx*Gr.dy/Mr.value),qr.area=0;(ia=tn.length)>0;)qr.push(Yr=tn[ia-1]),qr.area+=Yr.area,ft!=="squarify"||(ta=br(qr,_a))<=Un?(tn.pop(),Un=ta):(qr.area-=qr.pop().area,Zr(qr,_a,Gr,!1),_a=Math.min(Gr.dx,Gr.dy),qr.length=qr.area=0,Un=1/0);qr.length&&(Zr(qr,_a,Gr,!0),qr.length=qr.area=0),zr.forEach(Xt)}}function Kt(Mr){var zr=Mr.children;if(zr&&zr.length){var Gr=ze(Mr),qr=zr.slice(),tn,Yr=[];for(Nt(qr,Gr.dx*Gr.dy/Mr.value),Yr.area=0;tn=qr.pop();)Yr.push(tn),Yr.area+=tn.area,tn.z!=null&&(Zr(Yr,tn.z?Gr.dx:Gr.dy,Gr,!qr.length),Yr.length=Yr.area=0);zr.forEach(Kt)}}function br(Mr,zr){for(var Gr=Mr.area,qr,tn=0,Yr=1/0,Un=-1,ta=Mr.length;++Un<ta;)!(qr=Mr[Un].area)||(qr<Yr&&(Yr=qr),qr>tn&&(tn=qr));return Gr*=Gr,zr*=zr,Gr?Math.max(zr*tn*St/Gr,Gr/(zr*Yr*St)):1/0}function Zr(Mr,zr,Gr,qr){var tn=-1,Yr=Mr.length,Un=Gr.x,ta=Gr.y,_a=zr?be(Mr.area/zr):0,ia;if(zr==Gr.dx){for((qr||_a>Gr.dy)&&(_a=Gr.dy);++tn<Yr;)ia=Mr[tn],ia.x=Un,ia.y=ta,ia.dy=_a,Un+=ia.dx=Math.min(Gr.x+Gr.dx-Un,_a?be(ia.area/_a):0);ia.z=!0,ia.dx+=Gr.x+Gr.dx-Un,Gr.y+=_a,Gr.dy-=_a}else{for((qr||_a>Gr.dx)&&(_a=Gr.dx);++tn<Yr;)ia=Mr[tn],ia.x=Un,ia.y=ta,ia.dx=_a,ta+=ia.dy=Math.min(Gr.y+Gr.dy-ta,_a?be(ia.area/_a):0);ia.z=!1,ia.dy+=Gr.y+Gr.dy-ta,Gr.x+=_a,Gr.dx-=_a}}function nn(Mr){var zr=yt||ue(Mr),Gr=zr[0];return Gr.x=Gr.y=0,Gr.value?(Gr.dx=Ee[0],Gr.dy=Ee[1]):Gr.dx=Gr.dy=0,yt&&ue.revalue(Gr),Nt([Gr],Gr.dx*Gr.dy/Gr.value),(yt?Kt:Xt)(Gr),Ze&&(yt=zr),zr}return nn.size=function(Mr){return arguments.length?(Ee=Mr,nn):Ee},nn.padding=function(Mr){if(!arguments.length)return Fe;function zr(tn){var Yr=Mr.call(nn,tn,tn.depth);return Yr==null?or(tn):er(tn,typeof Yr=="number"?[Yr,Yr,Yr,Yr]:Yr)}function Gr(tn){return er(tn,Mr)}var qr;return ze=(Fe=Mr)==null?or:(qr=typeof Mr)=="function"?zr:(qr==="number"&&(Mr=[Mr,Mr,Mr,Mr]),Gr),nn},nn.round=function(Mr){return arguments.length?(be=Mr?Math.round:Number,nn):be!=Number},nn.sticky=function(Mr){return arguments.length?(Ze=Mr,yt=null,nn):Ze},nn.ratio=function(Mr){return arguments.length?(St=Mr,nn):St},nn.mode=function(Mr){return arguments.length?(ft=Mr+"",nn):ft},xl(nn,ue)};function or(ue){return{x:ue.x,y:ue.y,dx:ue.dx,dy:ue.dy}}function er(ue,be){var Ee=ue.x+be[3],Fe=ue.y+be[0],ze=ue.dx-be[1]-be[3],Ze=ue.dy-be[0]-be[2];return ze<0&&(Ee+=ze/2,ze=0),Ze<0&&(Fe+=Ze/2,Ze=0),{x:Ee,y:Fe,dx:ze,dy:Ze}}w.random={normal:function(ue,be){var Ee=arguments.length;return Ee<2&&(be=1),Ee<1&&(ue=0),function(){var Fe,ze,Ze;do Fe=Math.random()*2-1,ze=Math.random()*2-1,Ze=Fe*Fe+ze*ze;while(!Ze||Ze>1);return ue+be*Fe*Math.sqrt(-2*Math.log(Ze)/Ze)}},logNormal:function(){var ue=w.random.normal.apply(w,arguments);return function(){return Math.exp(ue())}},bates:function(ue){var be=w.random.irwinHall(ue);return function(){return be()/ue}},irwinHall:function(ue){return function(){for(var be=0,Ee=0;Ee<ue;Ee++)be+=Math.random();return be}}},w.scale={};function Er(ue){var be=ue[0],Ee=ue[ue.length-1];return be<Ee?[be,Ee]:[Ee,be]}function $r(ue){return ue.rangeExtent?ue.rangeExtent():Er(ue.range())}function pn(ue,be,Ee,Fe){var ze=Ee(ue[0],ue[1]),Ze=Fe(be[0],be[1]);return function(yt){return Ze(ze(yt))}}function wn(ue,be){var Ee=0,Fe=ue.length-1,ze=ue[Ee],Ze=ue[Fe],yt;return Ze<ze&&(yt=Ee,Ee=Fe,Fe=yt,yt=ze,ze=Ze,Ze=yt),ue[Ee]=be.floor(ze),ue[Fe]=be.ceil(Ze),ue}function En(ue){return ue?{floor:function(be){return Math.floor(be/ue)*ue},ceil:function(be){return Math.ceil(be/ue)*ue}}:Nn}var Nn={floor:D,ceil:D};function gn(ue,be,Ee,Fe){var ze=[],Ze=[],yt=0,ft=Math.min(ue.length,be.length)-1;for(ue[ft]<ue[0]&&(ue=ue.slice().reverse(),be=be.slice().reverse());++yt<=ft;)ze.push(Ee(ue[yt-1],ue[yt])),Ze.push(Fe(be[yt-1],be[yt]));return function(St){var Nt=w.bisect(ue,St,1,ft)-1;return Ze[Nt](ze[Nt](St))}}w.scale.linear=function(){return Rn([0,1],[0,1],io,!1)};function Rn(ue,be,Ee,Fe){var ze,Ze;function yt(){var St=Math.min(ue.length,be.length)>2?gn:pn,Nt=Fe?uu:Cu;return ze=St(ue,be,Nt,Ee),Ze=St(be,ue,Nt,io),ft}function ft(St){return ze(St)}return ft.invert=function(St){return Ze(St)},ft.domain=function(St){return arguments.length?(ue=St.map(Number),yt()):ue},ft.range=function(St){return arguments.length?(be=St,yt()):be},ft.rangeRound=function(St){return ft.range(St).interpolate(ou)},ft.clamp=function(St){return arguments.length?(Fe=St,yt()):Fe},ft.interpolate=function(St){return arguments.length?(Ee=St,yt()):Ee},ft.ticks=function(St){return za(ue,St)},ft.tickFormat=function(St,Nt){return d3_scale_linearTickFormat(ue,St,Nt)},ft.nice=function(St){return Vn(ue,St),yt()},ft.copy=function(){return Rn(ue,be,Ee,Fe)},yt()}function Cn(ue,be){return w.rebind(ue,be,"range","rangeRound","interpolate","clamp")}function Vn(ue,be){return wn(ue,En(Jn(ue,be)[2])),wn(ue,En(Jn(ue,be)[2])),ue}function Jn(ue,be){be==null&&(be=10);var Ee=Er(ue),Fe=Ee[1]-Ee[0],ze=Math.pow(10,Math.floor(Math.log(Fe/be)/Math.LN10)),Ze=be/Fe*ze;return Ze<=.15?ze*=10:Ze<=.35?ze*=5:Ze<=.75&&(ze*=2),Ee[0]=Math.ceil(Ee[0]/ze)*ze,Ee[1]=Math.floor(Ee[1]/ze)*ze+ze*.5,Ee[2]=ze,Ee}function za(ue,be){return w.range.apply(w,Jn(ue,be))}w.scale.log=function(){return Ea(w.scale.linear().domain([0,1]),10,!0,[1,10])};function Ea(ue,be,Ee,Fe){function ze(ft){return(Ee?Math.log(ft<0?0:ft):-Math.log(ft>0?0:-ft))/Math.log(be)}function Ze(ft){return Ee?Math.pow(be,ft):-Math.pow(be,-ft)}function yt(ft){return ue(ze(ft))}return yt.invert=function(ft){return Ze(ue.invert(ft))},yt.domain=function(ft){return arguments.length?(Ee=ft[0]>=0,ue.domain((Fe=ft.map(Number)).map(ze)),yt):Fe},yt.base=function(ft){return arguments.length?(be=+ft,ue.domain(Fe.map(ze)),yt):be},yt.nice=function(){var ft=wn(Fe.map(ze),Ee?Math:Fa);return ue.domain(ft),Fe=ft.map(Ze),yt},yt.ticks=function(){var ft=Er(Fe),St=[],Nt=ft[0],Xt=ft[1],Kt=Math.floor(ze(Nt)),br=Math.ceil(ze(Xt)),Zr=be%1?2:be;if(isFinite(br-Kt)){if(Ee){for(;Kt<br;Kt++)for(var nn=1;nn<Zr;nn++)St.push(Ze(Kt)*nn);St.push(Ze(Kt))}else for(St.push(Ze(Kt));Kt++<br;)for(var nn=Zr-1;nn>0;nn--)St.push(Ze(Kt)*nn);for(Kt=0;St[Kt]<Nt;Kt++);for(br=St.length;St[br-1]>Xt;br--);St=St.slice(Kt,br)}return St},yt.copy=function(){return Ea(ue.copy(),be,Ee,Fe)},Cn(yt,ue)}var Fa={floor:function(ue){return-Math.ceil(-ue)},ceil:function(ue){return-Math.floor(-ue)}};w.scale.pow=function(){return Oa(w.scale.linear(),1,[0,1])};function Oa(ue,be,Ee){var Fe=Zn(be),ze=Zn(1/be);function Ze(yt){return ue(Fe(yt))}return Ze.invert=function(yt){return ze(ue.invert(yt))},Ze.domain=function(yt){return arguments.length?(ue.domain((Ee=yt.map(Number)).map(Fe)),Ze):Ee},Ze.ticks=function(yt){return za(Ee,yt)},Ze.tickFormat=function(yt,ft){return d3_scale_linearTickFormat(Ee,yt,ft)},Ze.nice=function(yt){return Ze.domain(Vn(Ee,yt))},Ze.exponent=function(yt){return arguments.length?(Fe=Zn(be=yt),ze=Zn(1/be),ue.domain(Ee.map(Fe)),Ze):be},Ze.copy=function(){return Oa(ue.copy(),be,Ee)},Cn(Ze,ue)}function Zn(ue){return function(be){return be<0?-Math.pow(-be,ue):Math.pow(be,ue)}}w.scale.sqrt=function(){return w.scale.pow().exponent(.5)},w.scale.ordinal=function(){return ha([],{t:"range",a:[[]]})};function ha(ue,be){var Ee,Fe,ze;function Ze(ft){return Fe[((Ee.get(ft)||(be.t==="range"?Ee.set(ft,ue.push(ft)):NaN))-1)%Fe.length]}function yt(ft,St){return w.range(ue.length).map(function(Nt){return ft+St*Nt})}return Ze.domain=function(ft){if(!arguments.length)return ue;ue=[],Ee=new A;for(var St=-1,Nt=ft.length,Xt;++St<Nt;)Ee.has(Xt=ft[St])||Ee.set(Xt,ue.push(Xt));return Ze[be.t].apply(Ze,be.a)},Ze.range=function(ft){return arguments.length?(Fe=ft,ze=0,be={t:"range",a:arguments},Ze):Fe},Ze.rangePoints=function(ft,St){arguments.length<2&&(St=0);var Nt=ft[0],Xt=ft[1],Kt=ue.length<2?(Nt=(Nt+Xt)/2,0):(Xt-Nt)/(ue.length-1+St);return Fe=yt(Nt+Kt*St/2,Kt),ze=0,be={t:"rangePoints",a:arguments},Ze},Ze.rangeRoundPoints=function(ft,St){arguments.length<2&&(St=0);var Nt=ft[0],Xt=ft[1],Kt=ue.length<2?(Nt=Xt=Math.round((Nt+Xt)/2),0):(Xt-Nt)/(ue.length-1+St)|0;return Fe=yt(Nt+Math.round(Kt*St/2+(Xt-Nt-(ue.length-1+St)*Kt)/2),Kt),ze=0,be={t:"rangeRoundPoints",a:arguments},Ze},Ze.rangeBands=function(ft,St,Nt){arguments.length<2&&(St=0),arguments.length<3&&(Nt=St);var Xt=ft[1]<ft[0],Kt=ft[Xt-0],br=ft[1-Xt],Zr=(br-Kt)/(ue.length-St+2*Nt);return Fe=yt(Kt+Zr*Nt,Zr),Xt&&Fe.reverse(),ze=Zr*(1-St),be={t:"rangeBands",a:arguments},Ze},Ze.rangeRoundBands=function(ft,St,Nt){arguments.length<2&&(St=0),arguments.length<3&&(Nt=St);var Xt=ft[1]<ft[0],Kt=ft[Xt-0],br=ft[1-Xt],Zr=Math.floor((br-Kt)/(ue.length-St+2*Nt));return Fe=yt(Kt+Math.round((br-Kt-(ue.length-St)*Zr)/2),Zr),Xt&&Fe.reverse(),ze=Math.round(Zr*(1-St)),be={t:"rangeRoundBands",a:arguments},Ze},Ze.rangeBand=function(){return ze},Ze.rangeExtent=function(){return Er(be.a[0])},Ze.copy=function(){return ha(ue,be)},Ze.domain(ue)}w.scale.category10=function(){return w.scale.ordinal().range(Ya)},w.scale.category20=function(){return w.scale.ordinal().range(Ja)},w.scale.category20b=function(){return w.scale.ordinal().range(yi)},w.scale.category20c=function(){return w.scale.ordinal().range(mi)};var Ya=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(an),Ja=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(an),yi=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(an),mi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(an);w.scale.quantile=function(){return bi([],[])};function bi(ue,be){var Ee;function Fe(){var Ze=0,yt=be.length;for(Ee=[];++Ze<yt;)Ee[Ze-1]=w.quantile(ue,Ze/yt);return ze}function ze(Ze){if(!isNaN(Ze=+Ze))return be[w.bisect(Ee,Ze)]}return ze.domain=function(Ze){return arguments.length?(ue=Ze.map(g).filter(p).sort(i),Fe()):ue},ze.range=function(Ze){return arguments.length?(be=Ze,Fe()):be},ze.quantiles=function(){return Ee},ze.invertExtent=function(Ze){return Ze=be.indexOf(Ze),Ze<0?[NaN,NaN]:[Ze>0?Ee[Ze-1]:ue[0],Ze<Ee.length?Ee[Ze]:ue[ue.length-1]]},ze.copy=function(){return bi(ue,be)},Fe()}w.scale.quantize=function(){return Si(0,1,[0,1])};function Si(ue,be,Ee){var Fe,ze;function Ze(ft){return Ee[Math.max(0,Math.min(ze,Math.floor(Fe*(ft-ue))))]}function yt(){return Fe=Ee.length/(be-ue),ze=Ee.length-1,Ze}return Ze.domain=function(ft){return arguments.length?(ue=+ft[0],be=+ft[ft.length-1],yt()):[ue,be]},Ze.range=function(ft){return arguments.length?(Ee=ft,yt()):Ee},Ze.invertExtent=function(ft){return ft=Ee.indexOf(ft),ft=ft<0?NaN:ft/Fe+ue,[ft,ft+1/Fe]},Ze.copy=function(){return Si(ue,be,Ee)},yt()}w.scale.threshold=function(){return oi([.5],[0,1])};function oi(ue,be){function Ee(Fe){if(Fe<=Fe)return be[w.bisect(ue,Fe)]}return Ee.domain=function(Fe){return arguments.length?(ue=Fe,Ee):ue},Ee.range=function(Fe){return arguments.length?(be=Fe,Ee):be},Ee.invertExtent=function(Fe){return Fe=be.indexOf(Fe),[ue[Fe-1],ue[Fe]]},Ee.copy=function(){return oi(ue,be)},Ee}w.scale.identity=function(){return xo([0,1])};function xo(ue){function be(Ee){return+Ee}return be.invert=be,be.domain=be.range=function(Ee){return arguments.length?(ue=Ee.map(be),be):ue},be.ticks=function(Ee){return za(ue,Ee)},be.tickFormat=function(Ee,Fe){return d3_scale_linearTickFormat(ue,Ee,Fe)},be.copy=function(){return xo(ue)},be}w.svg={};function to(){return 0}w.svg.arc=function(){var ue=pa,be=_i,Ee=to,Fe=Ka,ze=fo,Ze=go,yt=ls;function ft(){var Nt=Math.max(0,+ue.apply(this,arguments)),Xt=Math.max(0,+be.apply(this,arguments)),Kt=ze.apply(this,arguments)-st,br=Ze.apply(this,arguments)-st,Zr=Math.abs(br-Kt),nn=Kt>br?0:1;if(Xt<Nt&&(Mr=Xt,Xt=Nt,Nt=Mr),Zr>=Ke)return St(Xt,nn)+(Nt?St(Nt,1-nn):"")+"Z";var Mr,zr,Gr,qr,tn=0,Yr=0,Un,ta,_a,ia,ka,ua,Na,Pa,Qa=[];if((qr=(+yt.apply(this,arguments)||0)/2)&&(Gr=Fe===Ka?Math.sqrt(Nt*Nt+Xt*Xt):+Fe.apply(this,arguments),nn||(Yr*=-1),Xt&&(Yr=$t(Gr/Xt*Math.sin(qr))),Nt&&(tn=$t(Gr/Nt*Math.sin(qr)))),Xt){Un=Xt*Math.cos(Kt+Yr),ta=Xt*Math.sin(Kt+Yr),_a=Xt*Math.cos(br-Yr),ia=Xt*Math.sin(br-Yr);var xi=Math.abs(br-Kt-2*Yr)<=ke?0:1;if(Yr&&ks(Un,ta,_a,ia)===nn^xi){var ho=(Kt+br)/2;Un=Xt*Math.cos(ho),ta=Xt*Math.sin(ho),_a=ia=null}}else Un=ta=0;if(Nt){ka=Nt*Math.cos(br-tn),ua=Nt*Math.sin(br-tn),Na=Nt*Math.cos(Kt+tn),Pa=Nt*Math.sin(Kt+tn);var Fi=Math.abs(Kt-br+2*tn)<=ke?0:1;if(tn&&ks(ka,ua,Na,Pa)===1-nn^Fi){var fa=(Kt+br)/2;ka=Nt*Math.cos(fa),ua=Nt*Math.sin(fa),Na=Pa=null}}else ka=ua=0;if(Zr>ct&&(Mr=Math.min(Math.abs(Xt-Nt)/2,+Ee.apply(this,arguments)))>.001){zr=Nt<Xt^nn?0:1;var ni=Mr,Xa=Mr;if(Zr<ke){var Ei=Na==null?[ka,ua]:_a==null?[Un,ta]:Ga([Un,ta],[Na,Pa],[_a,ia],[ka,ua]),si=Un-Ei[0],so=ta-Ei[1],qi=_a-Ei[0],mo=ia-Ei[1],Wo=1/Math.sin(Math.acos((si*qi+so*mo)/(Math.sqrt(si*si+so*so)*Math.sqrt(qi*qi+mo*mo)))/2),Bo=Math.sqrt(Ei[0]*Ei[0]+Ei[1]*Ei[1]);Xa=Math.min(Mr,(Nt-Bo)/(Wo-1)),ni=Math.min(Mr,(Xt-Bo)/(Wo+1))}if(_a!=null){var Xo=Fo(Na==null?[ka,ua]:[Na,Pa],[Un,ta],Xt,ni,nn),Wi=Fo([_a,ia],[ka,ua],Xt,ni,nn);Mr===ni?Qa.push("M",Xo[0],"A",ni,",",ni," 0 0,",zr," ",Xo[1],"A",Xt,",",Xt," 0 ",1-nn^ks(Xo[1][0],Xo[1][1],Wi[1][0],Wi[1][1]),",",nn," ",Wi[1],"A",ni,",",ni," 0 0,",zr," ",Wi[0]):Qa.push("M",Xo[0],"A",ni,",",ni," 0 1,",zr," ",Wi[0])}else Qa.push("M",Un,",",ta);if(Na!=null){var Ui=Fo([Un,ta],[Na,Pa],Nt,-Xa,nn),Ia=Fo([ka,ua],_a==null?[Un,ta]:[_a,ia],Nt,-Xa,nn);Mr===Xa?Qa.push("L",Ia[0],"A",Xa,",",Xa," 0 0,",zr," ",Ia[1],"A",Nt,",",Nt," 0 ",nn^ks(Ia[1][0],Ia[1][1],Ui[1][0],Ui[1][1]),",",1-nn," ",Ui[1],"A",Xa,",",Xa," 0 0,",zr," ",Ui[0]):Qa.push("L",Ia[0],"A",Xa,",",Xa," 0 0,",zr," ",Ui[0])}else Qa.push("L",ka,",",ua)}else Qa.push("M",Un,",",ta),_a!=null&&Qa.push("A",Xt,",",Xt," 0 ",xi,",",nn," ",_a,",",ia),Qa.push("L",ka,",",ua),Na!=null&&Qa.push("A",Nt,",",Nt," 0 ",Fi,",",1-nn," ",Na,",",Pa);return Qa.push("Z"),Qa.join("")}function St(Nt,Xt){return"M0,"+Nt+"A"+Nt+","+Nt+" 0 1,"+Xt+" 0,"+-Nt+"A"+Nt+","+Nt+" 0 1,"+Xt+" 0,"+Nt}return ft.innerRadius=function(Nt){return arguments.length?(ue=tt(Nt),ft):ue},ft.outerRadius=function(Nt){return arguments.length?(be=tt(Nt),ft):be},ft.cornerRadius=function(Nt){return arguments.length?(Ee=tt(Nt),ft):Ee},ft.padRadius=function(Nt){return arguments.length?(Fe=Nt==Ka?Ka:tt(Nt),ft):Fe},ft.startAngle=function(Nt){return arguments.length?(ze=tt(Nt),ft):ze},ft.endAngle=function(Nt){return arguments.length?(Ze=tt(Nt),ft):Ze},ft.padAngle=function(Nt){return arguments.length?(yt=tt(Nt),ft):yt},ft.centroid=function(){var Nt=(+ue.apply(this,arguments)+ +be.apply(this,arguments))/2,Xt=(+ze.apply(this,arguments)+ +Ze.apply(this,arguments))/2-st;return[Math.cos(Xt)*Nt,Math.sin(Xt)*Nt]},ft};var Ka="auto";function pa(ue){return ue.innerRadius}function _i(ue){return ue.outerRadius}function fo(ue){return ue.startAngle}function go(ue){return ue.endAngle}function ls(ue){return ue&&ue.padAngle}function ks(ue,be,Ee,Fe){return(ue-Ee)*be-(be-Fe)*ue>0?0:1}function Fo(ue,be,Ee,Fe,ze){var Ze=ue[0]-be[0],yt=ue[1]-be[1],ft=(ze?Fe:-Fe)/Math.sqrt(Ze*Ze+yt*yt),St=ft*yt,Nt=-ft*Ze,Xt=ue[0]+St,Kt=ue[1]+Nt,br=be[0]+St,Zr=be[1]+Nt,nn=(Xt+br)/2,Mr=(Kt+Zr)/2,zr=br-Xt,Gr=Zr-Kt,qr=zr*zr+Gr*Gr,tn=Ee-Fe,Yr=Xt*Zr-br*Kt,Un=(Gr<0?-1:1)*Math.sqrt(Math.max(0,tn*tn*qr-Yr*Yr)),ta=(Yr*Gr-zr*Un)/qr,_a=(-Yr*zr-Gr*Un)/qr,ia=(Yr*Gr+zr*Un)/qr,ka=(-Yr*zr+Gr*Un)/qr,ua=ta-nn,Na=_a-Mr,Pa=ia-nn,Qa=ka-Mr;return ua*ua+Na*Na>Pa*Pa+Qa*Qa&&(ta=ia,_a=ka),[[ta-St,_a-Nt],[ta*Ee/tn,_a*Ee/tn]]}function Qs(){return!0}function ms(ue){var be=Kn,Ee=Aa,Fe=Qs,ze=bo,Ze=ze.key,yt=.7;function ft(St){var Nt=[],Xt=[],Kt=-1,br=St.length,Zr,nn=tt(be),Mr=tt(Ee);function zr(){Nt.push("M",ze(ue(Xt),yt))}for(;++Kt<br;)Fe.call(this,Zr=St[Kt],Kt)?Xt.push([+nn.call(this,Zr,Kt),+Mr.call(this,Zr,Kt)]):Xt.length&&(zr(),Xt=[]);return Xt.length&&zr(),Nt.length?Nt.join(""):null}return ft.x=function(St){return arguments.length?(be=St,ft):be},ft.y=function(St){return arguments.length?(Ee=St,ft):Ee},ft.defined=function(St){return arguments.length?(Fe=St,ft):Fe},ft.interpolate=function(St){return arguments.length?(typeof St=="function"?Ze=ze=St:Ze=(ze=us.get(St)||bo).key,ft):Ze},ft.tension=function(St){return arguments.length?(yt=St,ft):yt},ft}w.svg.line=function(){return ms(D)};var us=w.map({linear:bo,"linear-closed":Bl,step:Ql,"step-before":fs,"step-after":du,basis:Es,"basis-open":Xu,"basis-closed":Ru,bundle:Iu,cardinal:Pu,"cardinal-open":Nl,"cardinal-closed":vf,monotone:Ge});us.forEach(function(ue,be){be.key=ue,be.closed=/-closed$/.test(ue)});function bo(ue){return ue.length>1?ue.join("L"):ue+"Z"}function Bl(ue){return ue.join("L")+"Z"}function Ql(ue){for(var be=0,Ee=ue.length,Fe=ue[0],ze=[Fe[0],",",Fe[1]];++be<Ee;)ze.push("H",(Fe[0]+(Fe=ue[be])[0])/2,"V",Fe[1]);return Ee>1&&ze.push("H",Fe[0]),ze.join("")}function fs(ue){for(var be=0,Ee=ue.length,Fe=ue[0],ze=[Fe[0],",",Fe[1]];++be<Ee;)ze.push("V",(Fe=ue[be])[1],"H",Fe[0]);return ze.join("")}function du(ue){for(var be=0,Ee=ue.length,Fe=ue[0],ze=[Fe[0],",",Fe[1]];++be<Ee;)ze.push("H",(Fe=ue[be])[0],"V",Fe[1]);return ze.join("")}function Nl(ue,be){return ue.length<4?bo(ue):ue[1]+gu(ue.slice(1,-1),Du(ue,be))}function vf(ue,be){return ue.length<3?Bl(ue):ue[0]+gu((ue.push(ue[0]),ue),Du([ue[ue.length-2]].concat(ue,[ue[1]]),be))}function Pu(ue,be){return ue.length<3?bo(ue):ue[0]+gu(ue,Du(ue,be))}function gu(ue,be){if(be.length<1||ue.length!=be.length&&ue.length!=be.length+2)return bo(ue);var Ee=ue.length!=be.length,Fe="",ze=ue[0],Ze=ue[1],yt=be[0],ft=yt,St=1;if(Ee&&(Fe+="Q"+(Ze[0]-yt[0]*2/3)+","+(Ze[1]-yt[1]*2/3)+","+Ze[0]+","+Ze[1],ze=ue[1],St=2),be.length>1){ft=be[1],Ze=ue[St],St++,Fe+="C"+(ze[0]+yt[0])+","+(ze[1]+yt[1])+","+(Ze[0]-ft[0])+","+(Ze[1]-ft[1])+","+Ze[0]+","+Ze[1];for(var Nt=2;Nt<be.length;Nt++,St++)Ze=ue[St],ft=be[Nt],Fe+="S"+(Ze[0]-ft[0])+","+(Ze[1]-ft[1])+","+Ze[0]+","+Ze[1]}if(Ee){var Xt=ue[St];Fe+="Q"+(Ze[0]+ft[0]*2/3)+","+(Ze[1]+ft[1]*2/3)+","+Xt[0]+","+Xt[1]}return Fe}function Du(ue,be){for(var Ee=[],Fe=(1-be)/2,ze,Ze=ue[0],yt=ue[1],ft=1,St=ue.length;++ft<St;)ze=Ze,Ze=yt,yt=ue[ft],Ee.push([Fe*(yt[0]-ze[0]),Fe*(yt[1]-ze[1])]);return Ee}function Es(ue){if(ue.length<3)return bo(ue);var be=1,Ee=ue.length,Fe=ue[0],ze=Fe[0],Ze=Fe[1],yt=[ze,ze,ze,(Fe=ue[1])[0]],ft=[Ze,Ze,Ze,Fe[1]],St=[ze,",",Ze,"L",Oo(xs,yt),",",Oo(xs,ft)];for(ue.push(ue[Ee-1]);++be<=Ee;)Fe=ue[be],yt.shift(),yt.push(Fe[0]),ft.shift(),ft.push(Fe[1]),yu(St,yt,ft);return ue.pop(),St.push("L",Fe),St.join("")}function Xu(ue){if(ue.length<4)return bo(ue);for(var be=[],Ee=-1,Fe=ue.length,ze,Ze=[0],yt=[0];++Ee<3;)ze=ue[Ee],Ze.push(ze[0]),yt.push(ze[1]);for(be.push(Oo(xs,Ze)+","+Oo(xs,yt)),--Ee;++Ee<Fe;)ze=ue[Ee],Ze.shift(),Ze.push(ze[0]),yt.shift(),yt.push(ze[1]),yu(be,Ze,yt);return be.join("")}function Ru(ue){for(var be,Ee=-1,Fe=ue.length,ze=Fe+4,Ze,yt=[],ft=[];++Ee<4;)Ze=ue[Ee%Fe],yt.push(Ze[0]),ft.push(Ze[1]);for(be=[Oo(xs,yt),",",Oo(xs,ft)],--Ee;++Ee<ze;)Ze=ue[Ee%Fe],yt.shift(),yt.push(Ze[0]),ft.shift(),ft.push(Ze[1]),yu(be,yt,ft);return be.join("")}function Iu(ue,be){var Ee=ue.length-1;if(Ee)for(var Fe=ue[0][0],ze=ue[0][1],Ze=ue[Ee][0]-Fe,yt=ue[Ee][1]-ze,ft=-1,St,Nt;++ft<=Ee;)St=ue[ft],Nt=ft/Ee,St[0]=be*St[0]+(1-be)*(Fe+Nt*Ze),St[1]=be*St[1]+(1-be)*(ze+Nt*yt);return Es(ue)}function Oo(ue,be){return ue[0]*be[0]+ue[1]*be[1]+ue[2]*be[2]+ue[3]*be[3]}var zu=[0,2/3,1/3,0],$u=[0,1/3,2/3,0],xs=[0,1/6,2/3,1/6];function yu(ue,be,Ee){ue.push("C",Oo(zu,be),",",Oo(zu,Ee),",",Oo($u,be),",",Oo($u,Ee),",",Oo(xs,be),",",Oo(xs,Ee))}function mu(ue,be){return(be[1]-ue[1])/(be[0]-ue[0])}function Fu(ue){for(var be=0,Ee=ue.length-1,Fe=[],ze=ue[0],Ze=ue[1],yt=Fe[0]=mu(ze,Ze);++be<Ee;)Fe[be]=(yt+(yt=mu(ze=Ze,Ze=ue[be+1])))/2;return Fe[be]=yt,Fe}function Re(ue){for(var be=[],Ee,Fe,ze,Ze,yt=Fu(ue),ft=-1,St=ue.length-1;++ft<St;)Ee=mu(ue[ft],ue[ft+1]),u(Ee)<ct?yt[ft]=yt[ft+1]=0:(Fe=yt[ft]/Ee,ze=yt[ft+1]/Ee,Ze=Fe*Fe+ze*ze,Ze>9&&(Ze=Ee*3/Math.sqrt(Ze),yt[ft]=Ze*Fe,yt[ft+1]=Ze*ze));for(ft=-1;++ft<=St;)Ze=(ue[Math.min(St,ft+1)][0]-ue[Math.max(0,ft-1)][0])/(6*(1+yt[ft]*yt[ft])),be.push([Ze||0,yt[ft]*Ze||0]);return be}function Ge(ue){return ue.length<3?bo(ue):ue[0]+gu(ue,Re(ue))}w.svg.line.radial=function(){var ue=ms(et);return ue.radius=ue.x,delete ue.x,ue.angle=ue.y,delete ue.y,ue};function et(ue){for(var be,Ee=-1,Fe=ue.length,ze,Ze;++Ee<Fe;)be=ue[Ee],ze=be[0],Ze=be[1]-st,be[0]=ze*Math.cos(Ze),be[1]=ze*Math.sin(Ze);return ue}function it(ue){var be=Kn,Ee=Kn,Fe=0,ze=Aa,Ze=Qs,yt=bo,ft=yt.key,St=yt,Nt="L",Xt=.7;function Kt(br){var Zr=[],nn=[],Mr=[],zr=-1,Gr=br.length,qr,tn=tt(be),Yr=tt(Fe),Un=be===Ee?function(){return _a}:tt(Ee),ta=Fe===ze?function(){return ia}:tt(ze),_a,ia;function ka(){Zr.push("M",yt(ue(Mr),Xt),Nt,St(ue(nn.reverse()),Xt),"Z")}for(;++zr<Gr;)Ze.call(this,qr=br[zr],zr)?(nn.push([_a=+tn.call(this,qr,zr),ia=+Yr.call(this,qr,zr)]),Mr.push([+Un.call(this,qr,zr),+ta.call(this,qr,zr)])):nn.length&&(ka(),nn=[],Mr=[]);return nn.length&&ka(),Zr.length?Zr.join(""):null}return Kt.x=function(br){return arguments.length?(be=Ee=br,Kt):Ee},Kt.x0=function(br){return arguments.length?(be=br,Kt):be},Kt.x1=function(br){return arguments.length?(Ee=br,Kt):Ee},Kt.y=function(br){return arguments.length?(Fe=ze=br,Kt):ze},Kt.y0=function(br){return arguments.length?(Fe=br,Kt):Fe},Kt.y1=function(br){return arguments.length?(ze=br,Kt):ze},Kt.defined=function(br){return arguments.length?(Ze=br,Kt):Ze},Kt.interpolate=function(br){return arguments.length?(typeof br=="function"?ft=yt=br:ft=(yt=us.get(br)||bo).key,St=yt.reverse||yt,Nt=yt.closed?"M":"L",Kt):ft},Kt.tension=function(br){return arguments.length?(Xt=br,Kt):Xt},Kt}fs.reverse=du,du.reverse=fs,w.svg.area=function(){return it(D)},w.svg.area.radial=function(){var ue=it(et);return ue.radius=ue.x,delete ue.x,ue.innerRadius=ue.x0,delete ue.x0,ue.outerRadius=ue.x1,delete ue.x1,ue.angle=ue.y,delete ue.y,ue.startAngle=ue.y0,delete ue.y0,ue.endAngle=ue.y1,delete ue.y1,ue};function mt(ue){return ue.source}function gt(ue){return ue.target}w.svg.chord=function(){var ue=mt,be=gt,Ee=_t,Fe=fo,ze=go;function Ze(Xt,Kt){var br=yt(this,ue,Xt,Kt),Zr=yt(this,be,Xt,Kt);return"M"+br.p0+St(br.r,br.p1,br.a1-br.a0)+(ft(br,Zr)?Nt(br.r,br.p1,br.r,br.p0):Nt(br.r,br.p1,Zr.r,Zr.p0)+St(Zr.r,Zr.p1,Zr.a1-Zr.a0)+Nt(Zr.r,Zr.p1,br.r,br.p0))+"Z"}function yt(Xt,Kt,br,Zr){var nn=Kt.call(Xt,br,Zr),Mr=Ee.call(Xt,nn,Zr),zr=Fe.call(Xt,nn,Zr)-st,Gr=ze.call(Xt,nn,Zr)-st;return{r:Mr,a0:zr,a1:Gr,p0:[Mr*Math.cos(zr),Mr*Math.sin(zr)],p1:[Mr*Math.cos(Gr),Mr*Math.sin(Gr)]}}function ft(Xt,Kt){return Xt.a0==Kt.a0&&Xt.a1==Kt.a1}function St(Xt,Kt,br){return"A"+Xt+","+Xt+" 0 "+ +(br>ke)+",1 "+Kt}function Nt(Xt,Kt,br,Zr){return"Q 0,0 "+Zr}return Ze.radius=function(Xt){return arguments.length?(Ee=tt(Xt),Ze):Ee},Ze.source=function(Xt){return arguments.length?(ue=tt(Xt),Ze):ue},Ze.target=function(Xt){return arguments.length?(be=tt(Xt),Ze):be},Ze.startAngle=function(Xt){return arguments.length?(Fe=tt(Xt),Ze):Fe},Ze.endAngle=function(Xt){return arguments.length?(ze=tt(Xt),Ze):ze},Ze};function _t(ue){return ue.radius}w.svg.diagonal=function(){var ue=mt,be=gt,Ee=ar;function Fe(ze,Ze){var yt=ue.call(this,ze,Ze),ft=be.call(this,ze,Ze),St=(yt.y+ft.y)/2,Nt=[yt,{x:yt.x,y:St},{x:ft.x,y:St},ft];return Nt=Nt.map(Ee),"M"+Nt[0]+"C"+Nt[1]+" "+Nt[2]+" "+Nt[3]}return Fe.source=function(ze){return arguments.length?(ue=tt(ze),Fe):ue},Fe.target=function(ze){return arguments.length?(be=tt(ze),Fe):be},Fe.projection=function(ze){return arguments.length?(Ee=ze,Fe):Ee},Fe};function ar(ue){return[ue.x,ue.y]}w.svg.diagonal.radial=function(){var ue=w.svg.diagonal(),be=ar,Ee=ue.projection;return ue.projection=function(Fe){return arguments.length?Ee(fr(be=Fe)):be},ue};function fr(ue){return function(){var be=ue.apply(this,arguments),Ee=be[0],Fe=be[1]-st;return[Ee*Math.cos(Fe),Ee*Math.sin(Fe)]}}w.svg.symbol=function(){var ue=pr,be=rr;function Ee(Fe,ze){return(Hr.get(ue.call(this,Fe,ze))||kr)(be.call(this,Fe,ze))}return Ee.type=function(Fe){return arguments.length?(ue=tt(Fe),Ee):ue},Ee.size=function(Fe){return arguments.length?(be=tt(Fe),Ee):be},Ee};function rr(){return 64}function pr(){return"circle"}function kr(ue){var be=Math.sqrt(ue/ke);return"M0,"+be+"A"+be+","+be+" 0 1,1 0,"+-be+"A"+be+","+be+" 0 1,1 0,"+be+"Z"}var Hr=w.map({circle:kr,cross:function(ue){var be=Math.sqrt(ue/5)/2;return"M"+-3*be+","+-be+"H"+-be+"V"+-3*be+"H"+be+"V"+-be+"H"+3*be+"V"+be+"H"+be+"V"+3*be+"H"+-be+"V"+be+"H"+-3*be+"Z"},diamond:function(ue){var be=Math.sqrt(ue/(2*mn)),Ee=be*mn;return"M0,"+-be+"L"+Ee+",0 0,"+be+" "+-Ee+",0Z"},square:function(ue){var be=Math.sqrt(ue)/2;return"M"+-be+","+-be+"L"+be+","+-be+" "+be+","+be+" "+-be+","+be+"Z"},"triangle-down":function(ue){var be=Math.sqrt(ue/Qr),Ee=be*Qr/2;return"M0,"+Ee+"L"+be+","+-Ee+" "+-be+","+-Ee+"Z"},"triangle-up":function(ue){var be=Math.sqrt(ue/Qr),Ee=be*Qr/2;return"M0,"+-Ee+"L"+be+","+Ee+" "+-be+","+Ee+"Z"}});w.svg.symbolTypes=Hr.keys();var Qr=Math.sqrt(3),mn=Math.tan(30*Et);Q.transition=function(ue){for(var be=Wa||++ja,Ee=ti(ue),Fe=[],ze,Ze,yt=qa||{time:Date.now(),ease:zs,delay:0,duration:250},ft=-1,St=this.length;++ft<St;){Fe.push(ze=[]);for(var Nt=this[ft],Xt=-1,Kt=Nt.length;++Xt<Kt;)(Ze=Nt[Xt])&&Yi(Ze,Xt,Ee,be,yt),ze.push(Ze)}return ga(Fe,Ee,be)},Q.interrupt=function(ue){return this.each(ue==null?Ln:Gn(ti(ue)))};var Ln=Gn(ti());function Gn(ue){return function(){var be,Ee,Fe;(be=this[ue])&&(Fe=be[Ee=be.active])&&(Fe.timer.c=null,Fe.timer.t=NaN,--be.count?delete be[Ee]:delete this[ue],be.active+=.5,Fe.event&&Fe.event.interrupt.call(this,this.__data__,Fe.index))}}function ga(ue,be,Ee){return se(ue,xa),ue.namespace=be,ue.id=Ee,ue}var xa=[],ja=0,Wa,qa;xa.call=Q.call,xa.empty=Q.empty,xa.node=Q.node,xa.size=Q.size,w.transition=function(ue,be){return ue&&ue.transition?Wa?ue.transition(be):ue:w.selection().transition(ue)},w.transition.prototype=xa,xa.select=function(ue){var be=this.id,Ee=this.namespace,Fe=[],ze,Ze,yt;ue=W(ue);for(var ft=-1,St=this.length;++ft<St;){Fe.push(ze=[]);for(var Nt=this[ft],Xt=-1,Kt=Nt.length;++Xt<Kt;)(yt=Nt[Xt])&&(Ze=ue.call(yt,yt.__data__,Xt,ft))?("__data__"in yt&&(Ze.__data__=yt.__data__),Yi(Ze,Xt,Ee,be,yt[Ee][be]),ze.push(Ze)):ze.push(null)}return ga(Fe,Ee,be)},xa.selectAll=function(ue){var be=this.id,Ee=this.namespace,Fe=[],ze,Ze,yt,ft,St;ue=Z(ue);for(var Nt=-1,Xt=this.length;++Nt<Xt;)for(var Kt=this[Nt],br=-1,Zr=Kt.length;++br<Zr;)if(yt=Kt[br]){St=yt[Ee][be],Ze=ue.call(yt,yt.__data__,br,Nt),Fe.push(ze=[]);for(var nn=-1,Mr=Ze.length;++nn<Mr;)(ft=Ze[nn])&&Yi(ft,nn,Ee,be,St),ze.push(ft)}return ga(Fe,Ee,be)},xa.filter=function(ue){var be=[],Ee,Fe,ze;typeof ue!="function"&&(ue=xe(ue));for(var Ze=0,yt=this.length;Ze<yt;Ze++){be.push(Ee=[]);for(var Fe=this[Ze],ft=0,St=Fe.length;ft<St;ft++)(ze=Fe[ft])&&ue.call(ze,ze.__data__,ft,Ze)&&Ee.push(ze)}return ga(be,this.namespace,this.id)},xa.tween=function(ue,be){var Ee=this.id,Fe=this.namespace;return arguments.length<2?this.node()[Fe][Ee].tween.get(ue):He(this,be==null?function(ze){ze[Fe][Ee].tween.remove(ue)}:function(ze){ze[Fe][Ee].tween.set(ue,be)})};function pi(ue,be,Ee,Fe){var ze=ue.id,Ze=ue.namespace;return He(ue,typeof Ee=="function"?function(yt,ft,St){yt[Ze][ze].tween.set(be,Fe(Ee.call(yt,yt.__data__,ft,St)))}:(Ee=Fe(Ee),function(yt){yt[Ze][ze].tween.set(be,Ee)}))}xa.attr=function(ue,be){if(arguments.length<2){for(be in ue)this.attr(be,ue[be]);return this}var Ee=ue=="transform"?Il:io,Fe=w.ns.qualify(ue);function ze(){this.removeAttribute(Fe)}function Ze(){this.removeAttributeNS(Fe.space,Fe.local)}function yt(St){return St==null?ze:(St+="",function(){var Nt=this.getAttribute(Fe),Xt;return Nt!==St&&(Xt=Ee(Nt,St),function(Kt){this.setAttribute(Fe,Xt(Kt))})})}function ft(St){return St==null?Ze:(St+="",function(){var Nt=this.getAttributeNS(Fe.space,Fe.local),Xt;return Nt!==St&&(Xt=Ee(Nt,St),function(Kt){this.setAttributeNS(Fe.space,Fe.local,Xt(Kt))})})}return pi(this,"attr."+ue,be,Fe.local?ft:yt)},xa.attrTween=function(ue,be){var Ee=w.ns.qualify(ue);function Fe(Ze,yt){var ft=be.call(this,Ze,yt,this.getAttribute(Ee));return ft&&function(St){this.setAttribute(Ee,ft(St))}}function ze(Ze,yt){var ft=be.call(this,Ze,yt,this.getAttributeNS(Ee.space,Ee.local));return ft&&function(St){this.setAttributeNS(Ee.space,Ee.local,ft(St))}}return this.tween("attr."+ue,Ee.local?ze:Fe)},xa.style=function(ue,be,Ee){var Fe=arguments.length;if(Fe<3){if(typeof ue!="string"){Fe<2&&(be="");for(Ee in ue)this.style(Ee,ue[Ee],be);return this}Ee=""}function ze(){this.style.removeProperty(ue)}function Ze(yt){return yt==null?ze:(yt+="",function(){var ft=a(this).getComputedStyle(this,null).getPropertyValue(ue),St;return ft!==yt&&(St=io(ft,yt),function(Nt){this.style.setProperty(ue,St(Nt),Ee)})})}return pi(this,"style."+ue,be,Ze)},xa.styleTween=function(ue,be,Ee){arguments.length<3&&(Ee="");function Fe(ze,Ze){var yt=be.call(this,ze,Ze,a(this).getComputedStyle(this,null).getPropertyValue(ue));return yt&&function(ft){this.style.setProperty(ue,yt(ft),Ee)}}return this.tween("style."+ue,Fe)},xa.text=function(ue){return pi(this,"text",ue,oo)};function oo(ue){return ue==null&&(ue=""),function(){this.textContent=ue}}xa.remove=function(){var ue=this.namespace;return this.each("end.transition",function(){var be;this[ue].count<2&&(be=this.parentNode)&&be.removeChild(this)})},xa.ease=function(ue){var be=this.id,Ee=this.namespace;return arguments.length<1?this.node()[Ee][be].ease:(typeof ue!="function"&&(ue=w.ease.apply(w,arguments)),He(this,function(Fe){Fe[Ee][be].ease=ue}))},xa.delay=function(ue){var be=this.id,Ee=this.namespace;return arguments.length<1?this.node()[Ee][be].delay:He(this,typeof ue=="function"?function(Fe,ze,Ze){Fe[Ee][be].delay=+ue.call(Fe,Fe.__data__,ze,Ze)}:(ue=+ue,function(Fe){Fe[Ee][be].delay=ue}))},xa.duration=function(ue){var be=this.id,Ee=this.namespace;return arguments.length<1?this.node()[Ee][be].duration:He(this,typeof ue=="function"?function(Fe,ze,Ze){Fe[Ee][be].duration=Math.max(1,ue.call(Fe,Fe.__data__,ze,Ze))}:(ue=Math.max(1,ue),function(Fe){Fe[Ee][be].duration=ue}))},xa.each=function(ue,be){var Ee=this.id,Fe=this.namespace;if(arguments.length<2){var ze=qa,Ze=Wa;try{Wa=Ee,He(this,function(yt,ft,St){qa=yt[Fe][Ee],ue.call(yt,yt.__data__,ft,St)})}finally{qa=ze,Wa=Ze}}else He(this,function(yt){var ft=yt[Fe][Ee];(ft.event||(ft.event=w.dispatch("start","end","interrupt"))).on(ue,be)});return this},xa.transition=function(){for(var ue=this.id,be=++ja,Ee=this.namespace,Fe=[],ze,Ze,yt,ft,St=0,Nt=this.length;St<Nt;St++){Fe.push(ze=[]);for(var Ze=this[St],Xt=0,Kt=Ze.length;Xt<Kt;Xt++)(yt=Ze[Xt])&&(ft=yt[Ee][ue],Yi(yt,Xt,Ee,be,{time:ft.time,ease:ft.ease,delay:ft.delay+ft.duration,duration:ft.duration})),ze.push(yt)}return ga(Fe,Ee,be)};function ti(ue){return ue==null?"__transition__":"__transition_"+ue+"__"}function Yi(ue,be,Ee,Fe,ze){var Ze=ue[Ee]||(ue[Ee]={active:0,count:0}),yt=Ze[Fe],ft,St,Nt,Xt,Kt;function br(Mr){var zr=yt.delay;if(St.t=zr+ft,zr<=Mr)return Zr(Mr-zr);St.c=Zr}function Zr(Mr){var zr=Ze.active,Gr=Ze[zr];Gr&&(Gr.timer.c=null,Gr.timer.t=NaN,--Ze.count,delete Ze[zr],Gr.event&&Gr.event.interrupt.call(ue,ue.__data__,Gr.index));for(var qr in Ze)if(+qr<Fe){var tn=Ze[qr];tn.timer.c=null,tn.timer.t=NaN,--Ze.count,delete Ze[qr]}St.c=nn,An(function(){return St.c&&nn(Mr||1)&&(St.c=null,St.t=NaN),1},0,ft),Ze.active=Fe,yt.event&&yt.event.start.call(ue,ue.__data__,be),Kt=[],yt.tween.forEach(function(Yr,Un){(Un=Un.call(ue,ue.__data__,be))&&Kt.push(Un)}),Xt=yt.ease,Nt=yt.duration}function nn(Mr){for(var zr=Mr/Nt,Gr=Xt(zr),qr=Kt.length;qr>0;)Kt[--qr].call(ue,Gr);if(zr>=1)return yt.event&&yt.event.end.call(ue,ue.__data__,be),--Ze.count?delete Ze[Fe]:delete ue[Ee],1}yt||(ft=ze.time,St=An(br,0,ft),yt=Ze[Fe]={tween:new A,time:ft,timer:St,delay:ze.delay,duration:ze.duration,ease:ze.ease,index:be},ze=null,++Ze.count)}w.svg.axis=function(){var ue=w.scale.linear(),be=co,Ee=6,Fe=6,ze=3,Ze=[10],yt=null,ft;function St(Nt){Nt.each(function(){var Xt=w.select(this),Kt=this.__chart__||ue,br=this.__chart__=ue.copy(),Zr=yt==null?br.ticks?br.ticks.apply(br,Ze):br.domain():yt,nn=ft==null?br.tickFormat?br.tickFormat.apply(br,Ze):D:ft,Mr=Xt.selectAll(".tick").data(Zr,br),zr=Mr.enter().insert("g",".domain").attr("class","tick").style("opacity",ct),Gr=w.transition(Mr.exit()).style("opacity",ct).remove(),qr=w.transition(Mr.order()).style("opacity",1),tn=Math.max(Ee,0)+ze,Yr,Un=$r(br),ta=Xt.selectAll(".domain").data([0]),_a=(ta.enter().append("path").attr("class","domain"),w.transition(ta));zr.append("line"),zr.append("text");var ia=zr.select("line"),ka=qr.select("line"),ua=Mr.select("text").text(nn),Na=zr.select("text"),Pa=qr.select("text"),Qa=be==="top"||be==="left"?-1:1,xi,ho,Fi,fa;if(be==="bottom"||be==="top"?(Yr=wi,xi="x",Fi="y",ho="x2",fa="y2",ua.attr("dy",Qa<0?"0em":".71em").style("text-anchor","middle"),_a.attr("d","M"+Un[0]+","+Qa*Fe+"V0H"+Un[1]+"V"+Qa*Fe)):(Yr=ki,xi="y",Fi="x",ho="y2",fa="x2",ua.attr("dy",".32em").style("text-anchor",Qa<0?"end":"start"),_a.attr("d","M"+Qa*Fe+","+Un[0]+"H0V"+Un[1]+"H"+Qa*Fe)),ia.attr(fa,Qa*Ee),Na.attr(Fi,Qa*tn),ka.attr(ho,0).attr(fa,Qa*Ee),Pa.attr(xi,0).attr(Fi,Qa*tn),br.rangeBand){var ni=br,Xa=ni.rangeBand()/2;Kt=br=function(Ei){return ni(Ei)+Xa}}else Kt.rangeBand?Kt=br:Gr.call(Yr,br,Kt);zr.call(Yr,Kt,br),qr.call(Yr,br,br)})}return St.scale=function(Nt){return arguments.length?(ue=Nt,St):ue},St.orient=function(Nt){return arguments.length?(be=Nt in wo?Nt+"":co,St):be},St.ticks=function(){return arguments.length?(Ze=M(arguments),St):Ze},St.tickValues=function(Nt){return arguments.length?(yt=Nt,St):yt},St.tickFormat=function(Nt){return arguments.length?(ft=Nt,St):ft},St.tickSize=function(Nt){var Xt=arguments.length;return Xt?(Ee=+Nt,Fe=+arguments[Xt-1],St):Ee},St.innerTickSize=function(Nt){return arguments.length?(Ee=+Nt,St):Ee},St.outerTickSize=function(Nt){return arguments.length?(Fe=+Nt,St):Fe},St.tickPadding=function(Nt){return arguments.length?(ze=+Nt,St):ze},St.tickSubdivide=function(){return arguments.length&&St},St};var co="bottom",wo={top:1,right:1,bottom:1,left:1};function wi(ue,be,Ee){ue.attr("transform",function(Fe){var ze=be(Fe);return"translate("+(isFinite(ze)?ze:Ee(Fe))+",0)"})}function ki(ue,be,Ee){ue.attr("transform",function(Fe){var ze=be(Fe);return"translate(0,"+(isFinite(ze)?ze:Ee(Fe))+")"})}w.svg.brush=function(){var ue=X(Xt,"brushstart","brush","brushend"),be=null,Ee=null,Fe=[0,0],ze=[0,0],Ze,yt,ft=!0,St=!0,Nt=yo[0];function Xt(Mr){Mr.each(function(){var zr=w.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",nn).on("touchstart.brush",nn),Gr=zr.selectAll(".background").data([0]);Gr.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),zr.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var qr=zr.selectAll(".resize").data(Nt,D);qr.exit().remove(),qr.enter().append("g").attr("class",function(ta){return"resize "+ta}).style("cursor",function(ta){return cs[ta]}).append("rect").attr("x",function(ta){return/[ew]$/.test(ta)?-3:null}).attr("y",function(ta){return/^[ns]/.test(ta)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),qr.style("display",Xt.empty()?"none":null);var tn=w.transition(zr),Yr=w.transition(Gr),Un;be&&(Un=$r(be),Yr.attr("x",Un[0]).attr("width",Un[1]-Un[0]),br(tn)),Ee&&(Un=$r(Ee),Yr.attr("y",Un[0]).attr("height",Un[1]-Un[0]),Zr(tn)),Kt(tn)})}Xt.event=function(Mr){Mr.each(function(){var zr=ue.of(this,arguments),Gr={x:Fe,y:ze,i:Ze,j:yt},qr=this.__chart__||Gr;this.__chart__=Gr,Wa?w.select(this).transition().each("start.brush",function(){Ze=qr.i,yt=qr.j,Fe=qr.x,ze=qr.y,zr({type:"brushstart"})}).tween("brush:brush",function(){var tn=$i(Fe,Gr.x),Yr=$i(ze,Gr.y);return Ze=yt=null,function(Un){Fe=Gr.x=tn(Un),ze=Gr.y=Yr(Un),zr({type:"brush",mode:"resize"})}}).each("end.brush",function(){Ze=Gr.i,yt=Gr.j,zr({type:"brush",mode:"resize"}),zr({type:"brushend"})}):(zr({type:"brushstart"}),zr({type:"brush",mode:"resize"}),zr({type:"brushend"}))})};function Kt(Mr){Mr.selectAll(".resize").attr("transform",function(zr){return"translate("+Fe[+/e$/.test(zr)]+","+ze[+/^s/.test(zr)]+")"})}function br(Mr){Mr.select(".extent").attr("x",Fe[0]),Mr.selectAll(".extent,.n>rect,.s>rect").attr("width",Fe[1]-Fe[0])}function Zr(Mr){Mr.select(".extent").attr("y",ze[0]),Mr.selectAll(".extent,.e>rect,.w>rect").attr("height",ze[1]-ze[0])}function nn(){var Mr=this,zr=w.select(w.event.target),Gr=ue.of(Mr,arguments),qr=w.select(Mr),tn=zr.datum(),Yr=!/^(n|s)$/.test(tn)&&be,Un=!/^(e|w)$/.test(tn)&&Ee,ta=zr.classed("extent"),_a=Bt(Mr),ia,ka=w.mouse(Mr),ua,Na=w.select(a(Mr)).on("keydown.brush",xi).on("keyup.brush",ho);if(w.event.changedTouches?Na.on("touchmove.brush",Fi).on("touchend.brush",ni):Na.on("mousemove.brush",Fi).on("mouseup.brush",ni),qr.interrupt().selectAll("*").interrupt(),ta)ka[0]=Fe[0]-ka[0],ka[1]=ze[0]-ka[1];else if(tn){var Pa=+/w$/.test(tn),Qa=+/^n/.test(tn);ua=[Fe[1-Pa]-ka[0],ze[1-Qa]-ka[1]],ka[0]=Fe[Pa],ka[1]=ze[Qa]}else w.event.altKey&&(ia=ka.slice());qr.style("pointer-events","none").selectAll(".resize").style("display",null),w.select("body").style("cursor",zr.style("cursor")),Gr({type:"brushstart"}),Fi();function xi(){w.event.keyCode==32&&(ta||(ia=null,ka[0]-=Fe[1],ka[1]-=ze[1],ta=2),j())}function ho(){w.event.keyCode==32&&ta==2&&(ka[0]+=Fe[1],ka[1]+=ze[1],ta=0,j())}function Fi(){var Xa=w.mouse(Mr),Ei=!1;ua&&(Xa[0]+=ua[0],Xa[1]+=ua[1]),ta||(w.event.altKey?(ia||(ia=[(Fe[0]+Fe[1])/2,(ze[0]+ze[1])/2]),ka[0]=Fe[+(Xa[0]<ia[0])],ka[1]=ze[+(Xa[1]<ia[1])]):ia=null),Yr&&fa(Xa,be,0)&&(br(qr),Ei=!0),Un&&fa(Xa,Ee,1)&&(Zr(qr),Ei=!0),Ei&&(Kt(qr),Gr({type:"brush",mode:ta?"move":"resize"}))}function fa(Xa,Ei,si){var so=$r(Ei),qi=so[0],mo=so[1],Wo=ka[si],Bo=si?ze:Fe,Xo=Bo[1]-Bo[0],Wi,Ui;if(ta&&(qi-=Wo,mo-=Xo+Wo),Wi=(si?St:ft)?Math.max(qi,Math.min(mo,Xa[si])):Xa[si],ta?Ui=(Wi+=Wo)+Xo:(ia&&(Wo=Math.max(qi,Math.min(mo,2*ia[si]-Wi))),Wo<Wi?(Ui=Wi,Wi=Wo):Ui=Wo),Bo[0]!=Wi||Bo[1]!=Ui)return si?yt=null:Ze=null,Bo[0]=Wi,Bo[1]=Ui,!0}function ni(){Fi(),qr.style("pointer-events","all").selectAll(".resize").style("display",Xt.empty()?"none":null),w.select("body").style("cursor",null),Na.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),_a(),Gr({type:"brushend"})}}return Xt.x=function(Mr){return arguments.length?(be=Mr,Nt=yo[!be<<1|!Ee],Xt):be},Xt.y=function(Mr){return arguments.length?(Ee=Mr,Nt=yo[!be<<1|!Ee],Xt):Ee},Xt.clamp=function(Mr){return arguments.length?(be&&Ee?(ft=!!Mr[0],St=!!Mr[1]):be?ft=!!Mr:Ee&&(St=!!Mr),Xt):be&&Ee?[ft,St]:be?ft:Ee?St:null},Xt.extent=function(Mr){var zr,Gr,qr,tn,Yr;return arguments.length?(be&&(zr=Mr[0],Gr=Mr[1],Ee&&(zr=zr[0],Gr=Gr[0]),Ze=[zr,Gr],be.invert&&(zr=be(zr),Gr=be(Gr)),Gr<zr&&(Yr=zr,zr=Gr,Gr=Yr),(zr!=Fe[0]||Gr!=Fe[1])&&(Fe=[zr,Gr])),Ee&&(qr=Mr[0],tn=Mr[1],be&&(qr=qr[1],tn=tn[1]),yt=[qr,tn],Ee.invert&&(qr=Ee(qr),tn=Ee(tn)),tn<qr&&(Yr=qr,qr=tn,tn=Yr),(qr!=ze[0]||tn!=ze[1])&&(ze=[qr,tn])),Xt):(be&&(Ze?(zr=Ze[0],Gr=Ze[1]):(zr=Fe[0],Gr=Fe[1],be.invert&&(zr=be.invert(zr),Gr=be.invert(Gr)),Gr<zr&&(Yr=zr,zr=Gr,Gr=Yr))),Ee&&(yt?(qr=yt[0],tn=yt[1]):(qr=ze[0],tn=ze[1],Ee.invert&&(qr=Ee.invert(qr),tn=Ee.invert(tn)),tn<qr&&(Yr=qr,qr=tn,tn=Yr))),be&&Ee?[[zr,qr],[Gr,tn]]:be?[zr,Gr]:Ee&&[qr,tn])},Xt.clear=function(){return Xt.empty()||(Fe=[0,0],ze=[0,0],Ze=yt=null),Xt},Xt.empty=function(){return!!be&&Fe[0]==Fe[1]||!!Ee&&ze[0]==ze[1]},w.rebind(Xt,ue,"on")};var cs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},yo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];w.text=Ct(function(ue){return ue.responseText}),w.json=function(ue,be){return Zt(ue,"application/json",Do,be)};function Do(ue){return JSON.parse(ue.responseText)}w.html=function(ue,be){return Zt(ue,"text/html",Yo,be)};function Yo(ue){var be=T.createRange();return be.selectNode(T.body),be.createContextualFragment(ue.responseText)}w.xml=Ct(function(ue){return ue.responseXML}),typeof re=="object"&&re.exports?re.exports=w:this.d3=w}).apply(self)},{}],59:[function(d,re,ne){re.exports=d("./quad")},{"./quad":60}],60:[function(d,re,ne){var w=d("binary-search-bounds"),c=d("clamp"),M=d("parse-rect"),T=d("array-bounds"),e=d("pick-by-alias"),a=d("defined"),n=d("flatten-vertex-data"),r=d("is-obj"),t=d("dtype"),f=d("math-log2"),o=1073741824;re.exports=function(p,y){y||(y={}),p=n(p,"float64"),y=e(y,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var h=a(y.maxDepth,255),m=a(y.bounds,T(p,2));m[0]===m[2]&&m[2]++,m[1]===m[3]&&m[3]++;var u=i(p,m),_=p.length>>>1,s;y.dtype||(y.dtype="array"),typeof y.dtype=="string"?s=new(t(y.dtype))(_):y.dtype&&(s=y.dtype,Array.isArray(s)&&(s.length=_));for(var A=0;A<_;++A)s[A]=A;var x=[],v=[],b=[],l=[];D(0,0,1,s,0,1);for(var L=0,S=0;S<x.length;S++){var k=x[S];if(s.set)s.set(k,L);else for(var P=0,z=k.length;P<z;P++)s[P+L]=k[P];var I=L+x[S].length;l[S]=[L,I],L=I}return s.range=R,s;function D(V,G,J,j,Y,X){if(!j.length)return null;var oe=x[Y]||(x[Y]=[]),se=b[Y]||(b[Y]=[]),ie=v[Y]||(v[Y]=[]),N=oe.length;if(Y++,Y>h||X>o){for(var U=0;U<j.length;U++)oe.push(j[U]),se.push(X),ie.push(null,null,null,null);return N}if(oe.push(j[0]),se.push(X),j.length<=1)return ie.push(null,null,null,null),N;for(var q=J*.5,Q=V+q,W=G+q,Z=[],ee=[],te=[],ae=[],le=1,ye=j.length;le<ye;le++){var fe=j[le],pe=u[fe*2],ge=u[fe*2+1];pe<Q?ge<W?Z.push(fe):ee.push(fe):ge<W?te.push(fe):ae.push(fe)}return X<<=2,ie.push(D(V,G,q,Z,Y,X),D(V,W,q,ee,Y,X+1),D(Q,G,q,te,Y,X+2),D(Q,W,q,ae,Y,X+3)),N}function R(){for(var V=[],G=arguments.length;G--;)V[G]=arguments[G];var J;if(r(V[V.length-1])){var j=V.pop();!V.length&&(j.x!=null||j.l!=null||j.left!=null)&&(V=[j],J={}),J=e(j,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else J={};V.length||(V=m);var Y=M.apply(void 0,V),X=[Math.min(Y.x,Y.x+Y.width),Math.min(Y.y,Y.y+Y.height),Math.max(Y.x,Y.x+Y.width),Math.max(Y.y,Y.y+Y.height)],oe=X[0],se=X[1],ie=X[2],N=X[3],U=i([oe,se,ie,N],m),q=U[0],Q=U[1],W=U[2],Z=U[3],ee=a(J.level,x.length);if(J.d!=null){var te;typeof J.d=="number"?te=[J.d,J.d]:J.d.length&&(te=J.d),ee=Math.min(Math.max(Math.ceil(-f(Math.abs(te[0])/(m[2]-m[0]))),Math.ceil(-f(Math.abs(te[1])/(m[3]-m[1])))),ee)}if(ee=Math.min(ee,x.length),J.lod)return B(q,Q,W,Z,ee);var ae=[];le(0,0,1,0,0,1);function le(fe,pe,ge,Ae,we,De){if(!(we===null||De===null)){var Be=fe+ge,Ve=pe+ge;if(!(q>Be||Q>Ve||W<fe||Z<pe)&&!(Ae>=ee)&&we!==De){var xe=x[Ae];De===void 0&&(De=xe.length);for(var Le=we;Le<De;Le++){var He=xe[Le],Je=p[He*2],Oe=p[He*2+1];Je>=oe&&Je<=ie&&Oe>=se&&Oe<=N&&ae.push(He)}var Pe=v[Ae],Ue=Pe[we*4+0],vt=Pe[we*4+1],Lt=Pe[we*4+2],Yt=Pe[we*4+3],At=ye(Pe,we+1),Rt=ge*.5,Bt=Ae+1;le(fe,pe,Rt,Bt,Ue,vt||Lt||Yt||At),le(fe,pe+Rt,Rt,Bt,vt,Lt||Yt||At),le(fe+Rt,pe,Rt,Bt,Lt,Yt||At),le(fe+Rt,pe+Rt,Rt,Bt,Yt,At)}}}function ye(fe,pe){for(var ge=null,Ae=0;ge===null;)if(ge=fe[pe*4+Ae],Ae++,Ae>fe.length)return null;return ge}return ae}function B(V,G,J,j,Y){for(var X=[],oe=0;oe<Y;oe++){var se=b[oe],ie=l[oe][0],N=F(V,G,oe),U=F(J,j,oe),q=w.ge(se,N),Q=w.gt(se,U,q,se.length-1);X[oe]=[q+ie,Q+ie]}return X}function F(V,G,J){for(var j=1,Y=.5,X=.5,oe=.5,se=0;se<J;se++)j<<=2,j+=V<Y?G<X?0:1:G<X?2:3,oe*=.5,Y+=V<Y?-oe:oe,X+=G<X?-oe:oe;return j}};function i(g,p){for(var y=p[0],h=p[1],m=p[2],u=p[3],_=1/(m-y),s=1/(u-h),A=new Array(g.length),x=0,v=g.length/2;x<v;x++)A[2*x]=c((g[2*x]-y)*_,0,1),A[2*x+1]=c((g[2*x+1]-h)*s,0,1);return A}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(d,re,ne){Object.defineProperty(ne,"__esModule",{value:!0});var w=d("@turf/meta"),c=6378137;function M(r){return w.geomReduce(r,function(t,f){return t+T(f)},0)}ne.default=M;function T(r){var t=0,f;switch(r.type){case"Polygon":return e(r.coordinates);case"MultiPolygon":for(f=0;f<r.coordinates.length;f++)t+=e(r.coordinates[f]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function e(r){var t=0;if(r&&r.length>0){t+=Math.abs(a(r[0]));for(var f=1;f<r.length;f++)t-=Math.abs(a(r[f]))}return t}function a(r){var t,f,o,i,g,p,y,h=0,m=r.length;if(m>2){for(y=0;y<m;y++)y===m-2?(i=m-2,g=m-1,p=0):y===m-1?(i=m-1,g=0,p=1):(i=y,g=y+1,p=y+2),t=r[i],f=r[g],o=r[p],h+=(n(o[0])-n(t[0]))*Math.sin(n(f[1]));h=h*c*c/2}return h}function n(r){return r*Math.PI/180}},{"@turf/meta":63}],62:[function(d,re,ne){Object.defineProperty(ne,"__esModule",{value:!0}),ne.earthRadius=63710088e-1,ne.factors={centimeters:ne.earthRadius*100,centimetres:ne.earthRadius*100,degrees:ne.earthRadius/111325,feet:ne.earthRadius*3.28084,inches:ne.earthRadius*39.37,kilometers:ne.earthRadius/1e3,kilometres:ne.earthRadius/1e3,meters:ne.earthRadius,metres:ne.earthRadius,miles:ne.earthRadius/1609.344,millimeters:ne.earthRadius*1e3,millimetres:ne.earthRadius*1e3,nauticalmiles:ne.earthRadius/1852,radians:1,yards:ne.earthRadius*1.0936},ne.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ne.earthRadius,yards:1.0936133},ne.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function w(S,k,P){P===void 0&&(P={});var z={type:"Feature"};return(P.id===0||P.id)&&(z.id=P.id),P.bbox&&(z.bbox=P.bbox),z.properties=k||{},z.geometry=S,z}ne.feature=w;function c(S,k,P){switch(S){case"Point":return M(k).geometry;case"LineString":return n(k).geometry;case"Polygon":return e(k).geometry;case"MultiPoint":return o(k).geometry;case"MultiLineString":return f(k).geometry;case"MultiPolygon":return i(k).geometry;default:throw new Error(S+" is invalid")}}ne.geometry=c;function M(S,k,P){if(P===void 0&&(P={}),!S)throw new Error("coordinates is required");if(!Array.isArray(S))throw new Error("coordinates must be an Array");if(S.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!v(S[0])||!v(S[1]))throw new Error("coordinates must contain numbers");var z={type:"Point",coordinates:S};return w(z,k,P)}ne.point=M;function T(S,k,P){return P===void 0&&(P={}),t(S.map(function(z){return M(z,k)}),P)}ne.points=T;function e(S,k,P){P===void 0&&(P={});for(var z=0,I=S;z<I.length;z++){var D=I[z];if(D.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var R=0;R<D[D.length-1].length;R++)if(D[D.length-1][R]!==D[0][R])throw new Error("First and last Position are not equivalent.")}var B={type:"Polygon",coordinates:S};return w(B,k,P)}ne.polygon=e;function a(S,k,P){return P===void 0&&(P={}),t(S.map(function(z){return e(z,k)}),P)}ne.polygons=a;function n(S,k,P){if(P===void 0&&(P={}),S.length<2)throw new Error("coordinates must be an array of two or more positions");var z={type:"LineString",coordinates:S};return w(z,k,P)}ne.lineString=n;function r(S,k,P){return P===void 0&&(P={}),t(S.map(function(z){return n(z,k)}),P)}ne.lineStrings=r;function t(S,k){k===void 0&&(k={});var P={type:"FeatureCollection"};return k.id&&(P.id=k.id),k.bbox&&(P.bbox=k.bbox),P.features=S,P}ne.featureCollection=t;function f(S,k,P){P===void 0&&(P={});var z={type:"MultiLineString",coordinates:S};return w(z,k,P)}ne.multiLineString=f;function o(S,k,P){P===void 0&&(P={});var z={type:"MultiPoint",coordinates:S};return w(z,k,P)}ne.multiPoint=o;function i(S,k,P){P===void 0&&(P={});var z={type:"MultiPolygon",coordinates:S};return w(z,k,P)}ne.multiPolygon=i;function g(S,k,P){P===void 0&&(P={});var z={type:"GeometryCollection",geometries:S};return w(z,k,P)}ne.geometryCollection=g;function p(S,k){if(k===void 0&&(k=0),k&&!(k>=0))throw new Error("precision must be a positive number");var P=Math.pow(10,k||0);return Math.round(S*P)/P}ne.round=p;function y(S,k){k===void 0&&(k="kilometers");var P=ne.factors[k];if(!P)throw new Error(k+" units is invalid");return S*P}ne.radiansToLength=y;function h(S,k){k===void 0&&(k="kilometers");var P=ne.factors[k];if(!P)throw new Error(k+" units is invalid");return S/P}ne.lengthToRadians=h;function m(S,k){return _(h(S,k))}ne.lengthToDegrees=m;function u(S){var k=S%360;return k<0&&(k+=360),k}ne.bearingToAzimuth=u;function _(S){var k=S%(2*Math.PI);return k*180/Math.PI}ne.radiansToDegrees=_;function s(S){var k=S%360;return k*Math.PI/180}ne.degreesToRadians=s;function A(S,k,P){if(k===void 0&&(k="kilometers"),P===void 0&&(P="kilometers"),!(S>=0))throw new Error("length must be a positive number");return y(h(S,k),P)}ne.convertLength=A;function x(S,k,P){if(k===void 0&&(k="meters"),P===void 0&&(P="kilometers"),!(S>=0))throw new Error("area must be a positive number");var z=ne.areaFactors[k];if(!z)throw new Error("invalid original units");var I=ne.areaFactors[P];if(!I)throw new Error("invalid final units");return S/z*I}ne.convertArea=x;function v(S){return!isNaN(S)&&S!==null&&!Array.isArray(S)}ne.isNumber=v;function b(S){return!!S&&S.constructor===Object}ne.isObject=b;function l(S){if(!S)throw new Error("bbox is required");if(!Array.isArray(S))throw new Error("bbox must be an Array");if(S.length!==4&&S.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");S.forEach(function(k){if(!v(k))throw new Error("bbox must only contain numbers")})}ne.validateBBox=l;function L(S){if(!S)throw new Error("id is required");if(["string","number"].indexOf(typeof S)===-1)throw new Error("id must be a number or a string")}ne.validateId=L},{}],63:[function(d,re,ne){Object.defineProperty(ne,"__esModule",{value:!0});var w=d("@turf/helpers");function c(_,s,A){if(_!==null)for(var x,v,b,l,L,S,k,P=0,z=0,I,D=_.type,R=D==="FeatureCollection",B=D==="Feature",F=R?_.features.length:1,V=0;V<F;V++){k=R?_.features[V].geometry:B?_.geometry:_,I=k?k.type==="GeometryCollection":!1,L=I?k.geometries.length:1;for(var G=0;G<L;G++){var J=0,j=0;if(l=I?k.geometries[G]:k,l!==null){S=l.coordinates;var Y=l.type;switch(P=A&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(s(S,z,V,J,j)===!1)return!1;z++,J++;break;case"LineString":case"MultiPoint":for(x=0;x<S.length;x++){if(s(S[x],z,V,J,j)===!1)return!1;z++,Y==="MultiPoint"&&J++}Y==="LineString"&&J++;break;case"Polygon":case"MultiLineString":for(x=0;x<S.length;x++){for(v=0;v<S[x].length-P;v++){if(s(S[x][v],z,V,J,j)===!1)return!1;z++}Y==="MultiLineString"&&J++,Y==="Polygon"&&j++}Y==="Polygon"&&J++;break;case"MultiPolygon":for(x=0;x<S.length;x++){for(j=0,v=0;v<S[x].length;v++){for(b=0;b<S[x][v].length-P;b++){if(s(S[x][v][b],z,V,J,j)===!1)return!1;z++}j++}J++}break;case"GeometryCollection":for(x=0;x<l.geometries.length;x++)if(c(l.geometries[x],s,A)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function M(_,s,A,x){var v=A;return c(_,function(b,l,L,S,k){l===0&&A===void 0?v=b:v=s(v,b,l,L,S,k)},x),v}function T(_,s){var A;switch(_.type){case"FeatureCollection":for(A=0;A<_.features.length&&s(_.features[A].properties,A)!==!1;A++);break;case"Feature":s(_.properties,0);break}}function e(_,s,A){var x=A;return T(_,function(v,b){b===0&&A===void 0?x=v:x=s(x,v,b)}),x}function a(_,s){if(_.type==="Feature")s(_,0);else if(_.type==="FeatureCollection")for(var A=0;A<_.features.length&&s(_.features[A],A)!==!1;A++);}function n(_,s,A){var x=A;return a(_,function(v,b){b===0&&A===void 0?x=v:x=s(x,v,b)}),x}function r(_){var s=[];return c(_,function(A){s.push(A)}),s}function t(_,s){var A,x,v,b,l,L,S,k,P,z,I=0,D=_.type==="FeatureCollection",R=_.type==="Feature",B=D?_.features.length:1;for(A=0;A<B;A++){for(L=D?_.features[A].geometry:R?_.geometry:_,k=D?_.features[A].properties:R?_.properties:{},P=D?_.features[A].bbox:R?_.bbox:void 0,z=D?_.features[A].id:R?_.id:void 0,S=L?L.type==="GeometryCollection":!1,l=S?L.geometries.length:1,v=0;v<l;v++){if(b=S?L.geometries[v]:L,b===null){if(s(null,I,k,P,z)===!1)return!1;continue}switch(b.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(s(b,I,k,P,z)===!1)return!1;break}case"GeometryCollection":{for(x=0;x<b.geometries.length;x++)if(s(b.geometries[x],I,k,P,z)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}I++}}function f(_,s,A){var x=A;return t(_,function(v,b,l,L,S){b===0&&A===void 0?x=v:x=s(x,v,b,l,L,S)}),x}function o(_,s){t(_,function(A,x,v,b,l){var L=A===null?null:A.type;switch(L){case null:case"Point":case"LineString":case"Polygon":return s(w.feature(A,v,{bbox:b,id:l}),x,0)===!1?!1:void 0}var S;switch(L){case"MultiPoint":S="Point";break;case"MultiLineString":S="LineString";break;case"MultiPolygon":S="Polygon";break}for(var k=0;k<A.coordinates.length;k++){var P=A.coordinates[k],z={type:S,coordinates:P};if(s(w.feature(z,v),x,k)===!1)return!1}})}function i(_,s,A){var x=A;return o(_,function(v,b,l){b===0&&l===0&&A===void 0?x=v:x=s(x,v,b,l)}),x}function g(_,s){o(_,function(A,x,v){var b=0;if(!!A.geometry){var l=A.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var L,S=0,k=0,P=0;if(c(A,function(z,I,D,R,B){if(L===void 0||x>S||R>k||B>P){L=z,S=x,k=R,P=B,b=0;return}var F=w.lineString([L,z],A.properties);if(s(F,x,v,B,b)===!1)return!1;b++,L=z})===!1)return!1}}})}function p(_,s,A){var x=A,v=!1;return g(_,function(b,l,L,S,k){v===!1&&A===void 0?x=b:x=s(x,b,l,L,S,k),v=!0}),x}function y(_,s){if(!_)throw new Error("geojson is required");o(_,function(A,x,v){if(A.geometry!==null){var b=A.geometry.type,l=A.geometry.coordinates;switch(b){case"LineString":if(s(A,x,v,0,0)===!1)return!1;break;case"Polygon":for(var L=0;L<l.length;L++)if(s(w.lineString(l[L],A.properties),x,v,L)===!1)return!1;break}}})}function h(_,s,A){var x=A;return y(_,function(v,b,l,L){b===0&&A===void 0?x=v:x=s(x,v,b,l,L)}),x}function m(_,s){if(s=s||{},!w.isObject(s))throw new Error("options is invalid");var A=s.featureIndex||0,x=s.multiFeatureIndex||0,v=s.geometryIndex||0,b=s.segmentIndex||0,l=s.properties,L;switch(_.type){case"FeatureCollection":A<0&&(A=_.features.length+A),l=l||_.features[A].properties,L=_.features[A].geometry;break;case"Feature":l=l||_.properties,L=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=_;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var S=L.coordinates;switch(L.type){case"Point":case"MultiPoint":return null;case"LineString":return b<0&&(b=S.length+b-1),w.lineString([S[b],S[b+1]],l,s);case"Polygon":return v<0&&(v=S.length+v),b<0&&(b=S[v].length+b-1),w.lineString([S[v][b],S[v][b+1]],l,s);case"MultiLineString":return x<0&&(x=S.length+x),b<0&&(b=S[x].length+b-1),w.lineString([S[x][b],S[x][b+1]],l,s);case"MultiPolygon":return x<0&&(x=S.length+x),v<0&&(v=S[x].length+v),b<0&&(b=S[x][v].length-b-1),w.lineString([S[x][v][b],S[x][v][b+1]],l,s)}throw new Error("geojson is invalid")}function u(_,s){if(s=s||{},!w.isObject(s))throw new Error("options is invalid");var A=s.featureIndex||0,x=s.multiFeatureIndex||0,v=s.geometryIndex||0,b=s.coordIndex||0,l=s.properties,L;switch(_.type){case"FeatureCollection":A<0&&(A=_.features.length+A),l=l||_.features[A].properties,L=_.features[A].geometry;break;case"Feature":l=l||_.properties,L=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=_;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var S=L.coordinates;switch(L.type){case"Point":return w.point(S,l,s);case"MultiPoint":return x<0&&(x=S.length+x),w.point(S[x],l,s);case"LineString":return b<0&&(b=S.length+b),w.point(S[b],l,s);case"Polygon":return v<0&&(v=S.length+v),b<0&&(b=S[v].length+b),w.point(S[v][b],l,s);case"MultiLineString":return x<0&&(x=S.length+x),b<0&&(b=S[x].length+b),w.point(S[x][b],l,s);case"MultiPolygon":return x<0&&(x=S.length+x),v<0&&(v=S[x].length+v),b<0&&(b=S[x][v].length-b),w.point(S[x][v][b],l,s)}throw new Error("geojson is invalid")}ne.coordEach=c,ne.coordReduce=M,ne.propEach=T,ne.propReduce=e,ne.featureEach=a,ne.featureReduce=n,ne.coordAll=r,ne.geomEach=t,ne.geomReduce=f,ne.flattenEach=o,ne.flattenReduce=i,ne.segmentEach=g,ne.segmentReduce=p,ne.lineEach=y,ne.lineReduce=h,ne.findSegment=m,ne.findPoint=u},{"@turf/helpers":62}],64:[function(d,re,ne){Object.defineProperty(ne,"__esModule",{value:!0});var w=d("@turf/meta");function c(M){var T=[1/0,1/0,-1/0,-1/0];return w.coordEach(M,function(e){T[0]>e[0]&&(T[0]=e[0]),T[1]>e[1]&&(T[1]=e[1]),T[2]<e[0]&&(T[2]=e[0]),T[3]<e[1]&&(T[3]=e[1])}),T}c.default=c,ne.default=c},{"@turf/meta":66}],65:[function(d,re,ne){arguments[4][62][0].apply(ne,arguments)},{dup:62}],66:[function(d,re,ne){arguments[4][63][0].apply(ne,arguments)},{"@turf/helpers":65,dup:63}],67:[function(d,re,ne){Object.defineProperty(ne,"__esModule",{value:!0});var w=d("@turf/meta"),c=d("@turf/helpers");function M(T,e){e===void 0&&(e={});var a=0,n=0,r=0;return w.coordEach(T,function(t){a+=t[0],n+=t[1],r++}),c.point([a/r,n/r],e.properties)}ne.default=M},{"@turf/helpers":68,"@turf/meta":69}],68:[function(d,re,ne){Object.defineProperty(ne,"__esModule",{value:!0}),ne.earthRadius=63710088e-1,ne.factors={centimeters:ne.earthRadius*100,centimetres:ne.earthRadius*100,degrees:ne.earthRadius/111325,feet:ne.earthRadius*3.28084,inches:ne.earthRadius*39.37,kilometers:ne.earthRadius/1e3,kilometres:ne.earthRadius/1e3,meters:ne.earthRadius,metres:ne.earthRadius,miles:ne.earthRadius/1609.344,millimeters:ne.earthRadius*1e3,millimetres:ne.earthRadius*1e3,nauticalmiles:ne.earthRadius/1852,radians:1,yards:ne.earthRadius/1.0936},ne.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ne.earthRadius,yards:1/1.0936},ne.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function w(B,F,V){V===void 0&&(V={});var G={type:"Feature"};return(V.id===0||V.id)&&(G.id=V.id),V.bbox&&(G.bbox=V.bbox),G.properties=F||{},G.geometry=B,G}ne.feature=w;function c(B,F,V){switch(B){case"Point":return M(F).geometry;case"LineString":return n(F).geometry;case"Polygon":return e(F).geometry;case"MultiPoint":return o(F).geometry;case"MultiLineString":return f(F).geometry;case"MultiPolygon":return i(F).geometry;default:throw new Error(B+" is invalid")}}ne.geometry=c;function M(B,F,V){V===void 0&&(V={});var G={type:"Point",coordinates:B};return w(G,F,V)}ne.point=M;function T(B,F,V){return V===void 0&&(V={}),t(B.map(function(G){return M(G,F)}),V)}ne.points=T;function e(B,F,V){V===void 0&&(V={});for(var G=0,J=B;G<J.length;G++){var j=J[G];if(j.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var Y=0;Y<j[j.length-1].length;Y++)if(j[j.length-1][Y]!==j[0][Y])throw new Error("First and last Position are not equivalent.")}var X={type:"Polygon",coordinates:B};return w(X,F,V)}ne.polygon=e;function a(B,F,V){return V===void 0&&(V={}),t(B.map(function(G){return e(G,F)}),V)}ne.polygons=a;function n(B,F,V){if(V===void 0&&(V={}),B.length<2)throw new Error("coordinates must be an array of two or more positions");var G={type:"LineString",coordinates:B};return w(G,F,V)}ne.lineString=n;function r(B,F,V){return V===void 0&&(V={}),t(B.map(function(G){return n(G,F)}),V)}ne.lineStrings=r;function t(B,F){F===void 0&&(F={});var V={type:"FeatureCollection"};return F.id&&(V.id=F.id),F.bbox&&(V.bbox=F.bbox),V.features=B,V}ne.featureCollection=t;function f(B,F,V){V===void 0&&(V={});var G={type:"MultiLineString",coordinates:B};return w(G,F,V)}ne.multiLineString=f;function o(B,F,V){V===void 0&&(V={});var G={type:"MultiPoint",coordinates:B};return w(G,F,V)}ne.multiPoint=o;function i(B,F,V){V===void 0&&(V={});var G={type:"MultiPolygon",coordinates:B};return w(G,F,V)}ne.multiPolygon=i;function g(B,F,V){V===void 0&&(V={});var G={type:"GeometryCollection",geometries:B};return w(G,F,V)}ne.geometryCollection=g;function p(B,F){if(F===void 0&&(F=0),F&&!(F>=0))throw new Error("precision must be a positive number");var V=Math.pow(10,F||0);return Math.round(B*V)/V}ne.round=p;function y(B,F){F===void 0&&(F="kilometers");var V=ne.factors[F];if(!V)throw new Error(F+" units is invalid");return B*V}ne.radiansToLength=y;function h(B,F){F===void 0&&(F="kilometers");var V=ne.factors[F];if(!V)throw new Error(F+" units is invalid");return B/V}ne.lengthToRadians=h;function m(B,F){return _(h(B,F))}ne.lengthToDegrees=m;function u(B){var F=B%360;return F<0&&(F+=360),F}ne.bearingToAzimuth=u;function _(B){var F=B%(2*Math.PI);return F*180/Math.PI}ne.radiansToDegrees=_;function s(B){var F=B%360;return F*Math.PI/180}ne.degreesToRadians=s;function A(B,F,V){if(F===void 0&&(F="kilometers"),V===void 0&&(V="kilometers"),!(B>=0))throw new Error("length must be a positive number");return y(h(B,F),V)}ne.convertLength=A;function x(B,F,V){if(F===void 0&&(F="meters"),V===void 0&&(V="kilometers"),!(B>=0))throw new Error("area must be a positive number");var G=ne.areaFactors[F];if(!G)throw new Error("invalid original units");var J=ne.areaFactors[V];if(!J)throw new Error("invalid final units");return B/G*J}ne.convertArea=x;function v(B){return!isNaN(B)&&B!==null&&!Array.isArray(B)&&!/^\s*$/.test(B)}ne.isNumber=v;function b(B){return!!B&&B.constructor===Object}ne.isObject=b;function l(B){if(!B)throw new Error("bbox is required");if(!Array.isArray(B))throw new Error("bbox must be an Array");if(B.length!==4&&B.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");B.forEach(function(F){if(!v(F))throw new Error("bbox must only contain numbers")})}ne.validateBBox=l;function L(B){if(!B)throw new Error("id is required");if(["string","number"].indexOf(typeof B)===-1)throw new Error("id must be a number or a string")}ne.validateId=L;function S(){throw new Error("method has been renamed to `radiansToDegrees`")}ne.radians2degrees=S;function k(){throw new Error("method has been renamed to `degreesToRadians`")}ne.degrees2radians=k;function P(){throw new Error("method has been renamed to `lengthToDegrees`")}ne.distanceToDegrees=P;function z(){throw new Error("method has been renamed to `lengthToRadians`")}ne.distanceToRadians=z;function I(){throw new Error("method has been renamed to `radiansToLength`")}ne.radiansToDistance=I;function D(){throw new Error("method has been renamed to `bearingToAzimuth`")}ne.bearingToAngle=D;function R(){throw new Error("method has been renamed to `convertLength`")}ne.convertDistance=R},{}],69:[function(d,re,ne){Object.defineProperty(ne,"__esModule",{value:!0});var w=d("@turf/helpers");function c(_,s,A){if(_!==null)for(var x,v,b,l,L,S,k,P=0,z=0,I,D=_.type,R=D==="FeatureCollection",B=D==="Feature",F=R?_.features.length:1,V=0;V<F;V++){k=R?_.features[V].geometry:B?_.geometry:_,I=k?k.type==="GeometryCollection":!1,L=I?k.geometries.length:1;for(var G=0;G<L;G++){var J=0,j=0;if(l=I?k.geometries[G]:k,l!==null){S=l.coordinates;var Y=l.type;switch(P=A&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(s(S,z,V,J,j)===!1)return!1;z++,J++;break;case"LineString":case"MultiPoint":for(x=0;x<S.length;x++){if(s(S[x],z,V,J,j)===!1)return!1;z++,Y==="MultiPoint"&&J++}Y==="LineString"&&J++;break;case"Polygon":case"MultiLineString":for(x=0;x<S.length;x++){for(v=0;v<S[x].length-P;v++){if(s(S[x][v],z,V,J,j)===!1)return!1;z++}Y==="MultiLineString"&&J++,Y==="Polygon"&&j++}Y==="Polygon"&&J++;break;case"MultiPolygon":for(x=0;x<S.length;x++){for(j=0,v=0;v<S[x].length;v++){for(b=0;b<S[x][v].length-P;b++){if(s(S[x][v][b],z,V,J,j)===!1)return!1;z++}j++}J++}break;case"GeometryCollection":for(x=0;x<l.geometries.length;x++)if(c(l.geometries[x],s,A)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function M(_,s,A,x){var v=A;return c(_,function(b,l,L,S,k){l===0&&A===void 0?v=b:v=s(v,b,l,L,S,k)},x),v}function T(_,s){var A;switch(_.type){case"FeatureCollection":for(A=0;A<_.features.length&&s(_.features[A].properties,A)!==!1;A++);break;case"Feature":s(_.properties,0);break}}function e(_,s,A){var x=A;return T(_,function(v,b){b===0&&A===void 0?x=v:x=s(x,v,b)}),x}function a(_,s){if(_.type==="Feature")s(_,0);else if(_.type==="FeatureCollection")for(var A=0;A<_.features.length&&s(_.features[A],A)!==!1;A++);}function n(_,s,A){var x=A;return a(_,function(v,b){b===0&&A===void 0?x=v:x=s(x,v,b)}),x}function r(_){var s=[];return c(_,function(A){s.push(A)}),s}function t(_,s){var A,x,v,b,l,L,S,k,P,z,I=0,D=_.type==="FeatureCollection",R=_.type==="Feature",B=D?_.features.length:1;for(A=0;A<B;A++){for(L=D?_.features[A].geometry:R?_.geometry:_,k=D?_.features[A].properties:R?_.properties:{},P=D?_.features[A].bbox:R?_.bbox:void 0,z=D?_.features[A].id:R?_.id:void 0,S=L?L.type==="GeometryCollection":!1,l=S?L.geometries.length:1,v=0;v<l;v++){if(b=S?L.geometries[v]:L,b===null){if(s(null,I,k,P,z)===!1)return!1;continue}switch(b.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(s(b,I,k,P,z)===!1)return!1;break}case"GeometryCollection":{for(x=0;x<b.geometries.length;x++)if(s(b.geometries[x],I,k,P,z)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}I++}}function f(_,s,A){var x=A;return t(_,function(v,b,l,L,S){b===0&&A===void 0?x=v:x=s(x,v,b,l,L,S)}),x}function o(_,s){t(_,function(A,x,v,b,l){var L=A===null?null:A.type;switch(L){case null:case"Point":case"LineString":case"Polygon":return s(w.feature(A,v,{bbox:b,id:l}),x,0)===!1?!1:void 0}var S;switch(L){case"MultiPoint":S="Point";break;case"MultiLineString":S="LineString";break;case"MultiPolygon":S="Polygon";break}for(var k=0;k<A.coordinates.length;k++){var P=A.coordinates[k],z={type:S,coordinates:P};if(s(w.feature(z,v),x,k)===!1)return!1}})}function i(_,s,A){var x=A;return o(_,function(v,b,l){b===0&&l===0&&A===void 0?x=v:x=s(x,v,b,l)}),x}function g(_,s){o(_,function(A,x,v){var b=0;if(!!A.geometry){var l=A.geometry.type;if(!(l==="Point"||l==="MultiPoint")){var L,S=0,k=0,P=0;if(c(A,function(z,I,D,R,B){if(L===void 0||x>S||R>k||B>P){L=z,S=x,k=R,P=B,b=0;return}var F=w.lineString([L,z],A.properties);if(s(F,x,v,B,b)===!1)return!1;b++,L=z})===!1)return!1}}})}function p(_,s,A){var x=A,v=!1;return g(_,function(b,l,L,S,k){v===!1&&A===void 0?x=b:x=s(x,b,l,L,S,k),v=!0}),x}function y(_,s){if(!_)throw new Error("geojson is required");o(_,function(A,x,v){if(A.geometry!==null){var b=A.geometry.type,l=A.geometry.coordinates;switch(b){case"LineString":if(s(A,x,v,0,0)===!1)return!1;break;case"Polygon":for(var L=0;L<l.length;L++)if(s(w.lineString(l[L],A.properties),x,v,L)===!1)return!1;break}}})}function h(_,s,A){var x=A;return y(_,function(v,b,l,L){b===0&&A===void 0?x=v:x=s(x,v,b,l,L)}),x}function m(_,s){if(s=s||{},!w.isObject(s))throw new Error("options is invalid");var A=s.featureIndex||0,x=s.multiFeatureIndex||0,v=s.geometryIndex||0,b=s.segmentIndex||0,l=s.properties,L;switch(_.type){case"FeatureCollection":A<0&&(A=_.features.length+A),l=l||_.features[A].properties,L=_.features[A].geometry;break;case"Feature":l=l||_.properties,L=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=_;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var S=L.coordinates;switch(L.type){case"Point":case"MultiPoint":return null;case"LineString":return b<0&&(b=S.length+b-1),w.lineString([S[b],S[b+1]],l,s);case"Polygon":return v<0&&(v=S.length+v),b<0&&(b=S[v].length+b-1),w.lineString([S[v][b],S[v][b+1]],l,s);case"MultiLineString":return x<0&&(x=S.length+x),b<0&&(b=S[x].length+b-1),w.lineString([S[x][b],S[x][b+1]],l,s);case"MultiPolygon":return x<0&&(x=S.length+x),v<0&&(v=S[x].length+v),b<0&&(b=S[x][v].length-b-1),w.lineString([S[x][v][b],S[x][v][b+1]],l,s)}throw new Error("geojson is invalid")}function u(_,s){if(s=s||{},!w.isObject(s))throw new Error("options is invalid");var A=s.featureIndex||0,x=s.multiFeatureIndex||0,v=s.geometryIndex||0,b=s.coordIndex||0,l=s.properties,L;switch(_.type){case"FeatureCollection":A<0&&(A=_.features.length+A),l=l||_.features[A].properties,L=_.features[A].geometry;break;case"Feature":l=l||_.properties,L=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":L=_;break;default:throw new Error("geojson is invalid")}if(L===null)return null;var S=L.coordinates;switch(L.type){case"Point":return w.point(S,l,s);case"MultiPoint":return x<0&&(x=S.length+x),w.point(S[x],l,s);case"LineString":return b<0&&(b=S.length+b),w.point(S[b],l,s);case"Polygon":return v<0&&(v=S.length+v),b<0&&(b=S[v].length+b),w.point(S[v][b],l,s);case"MultiLineString":return x<0&&(x=S.length+x),b<0&&(b=S[x].length+b),w.point(S[x][b],l,s);case"MultiPolygon":return x<0&&(x=S.length+x),v<0&&(v=S[x].length+v),b<0&&(b=S[x][v].length-b),w.point(S[x][v][b],l,s)}throw new Error("geojson is invalid")}ne.coordEach=c,ne.coordReduce=M,ne.propEach=T,ne.propReduce=e,ne.featureEach=a,ne.featureReduce=n,ne.coordAll=r,ne.geomEach=t,ne.geomReduce=f,ne.flattenEach=o,ne.flattenReduce=i,ne.segmentEach=g,ne.segmentReduce=p,ne.lineEach=y,ne.lineReduce=h,ne.findSegment=m,ne.findPoint=u},{"@turf/helpers":68}],70:[function(d,re,ne){re.exports=w;function w(c){var M=0,T=0,e=0,a=0;return c.map(function(n){n=n.slice();var r=n[0],t=r.toUpperCase();if(r!=t)switch(n[0]=t,r){case"a":n[6]+=e,n[7]+=a;break;case"v":n[1]+=a;break;case"h":n[1]+=e;break;default:for(var f=1;f<n.length;)n[f++]+=e,n[f++]+=a}switch(t){case"Z":e=M,a=T;break;case"H":e=n[1];break;case"V":a=n[1];break;case"M":e=M=n[1],a=T=n[2];break;default:e=n[n.length-2],a=n[n.length-1]}return n})}},{}],71:[function(d,re,ne){re.exports=w;function w(c,M){if(!c||c.length==null)throw Error("Argument should be an array");M==null?M=1:M=Math.floor(M);for(var T=Array(M*2),e=0;e<M;e++){for(var a=-1/0,n=1/0,r=e,t=c.length;r<t;r+=M)c[r]>a&&(a=c[r]),c[r]<n&&(n=c[r]);T[e]=n,T[M+e]=a}return T}},{}],72:[function(d,re,ne){re.exports=function(w,c,M){if(typeof Array.prototype.findIndex=="function")return w.findIndex(c,M);if(typeof c!="function")throw new TypeError("predicate must be a function");var T=Object(w),e=T.length;if(e===0)return-1;for(var a=0;a<e;a++)if(c.call(M,T[a],a,T))return a;return-1}},{}],73:[function(d,re,ne){var w=d("array-bounds");re.exports=c;function c(M,T,e){if(!M||M.length==null)throw Error("Argument should be an array");T==null&&(T=1),e==null&&(e=w(M,T));for(var a=0;a<T;a++){var n=e[T+a],r=e[a],t=a,f=M.length;if(n===1/0&&r===-1/0)for(t=a;t<f;t+=T)M[t]=M[t]===n?1:M[t]===r?0:.5;else if(n===1/0)for(t=a;t<f;t+=T)M[t]=M[t]===n?1:0;else if(r===-1/0)for(t=a;t<f;t+=T)M[t]=M[t]===r?0:1;else{var o=n-r;for(t=a;t<f;t+=T)isNaN(M[t])||(M[t]=o===0?.5:(M[t]-r)/o)}}return M}},{"array-bounds":71}],74:[function(d,re,ne){re.exports=function(c,M){var T=typeof c=="number",e=typeof M=="number";T&&!e?(M=c,c=0):!T&&!e&&(c=0,M=0),c=c|0,M=M|0;var a=M-c;if(a<0)throw new Error("array length must be positive");for(var n=new Array(a),r=0,t=c;r<a;r++,t++)n[r]=t;return n}},{}],75:[function(d,re,ne){(function(w){(function(){var c=d("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function M(k,P){if(k===P)return 0;for(var z=k.length,I=P.length,D=0,R=Math.min(z,I);D<R;++D)if(k[D]!==P[D]){z=k[D],I=P[D];break}return z<I?-1:I<z?1:0}function T(k){return w.Buffer&&typeof w.Buffer.isBuffer=="function"?w.Buffer.isBuffer(k):!!(k!=null&&k._isBuffer)}var e=d("util/"),a=Object.prototype.hasOwnProperty,n=Array.prototype.slice,r=function(){return function(){}.name==="foo"}();function t(k){return Object.prototype.toString.call(k)}function f(k){return T(k)||typeof w.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(k):k?!!(k instanceof DataView||k.buffer&&k.buffer instanceof ArrayBuffer):!1}var o=re.exports=u,i=/\s*function\s+([^\(\s]*)\s*/;function g(k){if(!!e.isFunction(k)){if(r)return k.name;var P=k.toString(),z=P.match(i);return z&&z[1]}}o.AssertionError=function(P){this.name="AssertionError",this.actual=P.actual,this.expected=P.expected,this.operator=P.operator,P.message?(this.message=P.message,this.generatedMessage=!1):(this.message=h(this),this.generatedMessage=!0);var z=P.stackStartFunction||m;if(Error.captureStackTrace)Error.captureStackTrace(this,z);else{var I=new Error;if(I.stack){var D=I.stack,R=g(z),B=D.indexOf(`
`+R);if(B>=0){var F=D.indexOf(`
`,B+1);D=D.substring(F+1)}this.stack=D}}},e.inherits(o.AssertionError,Error);function p(k,P){return typeof k=="string"?k.length<P?k:k.slice(0,P):k}function y(k){if(r||!e.isFunction(k))return e.inspect(k);var P=g(k),z=P?": "+P:"";return"[Function"+z+"]"}function h(k){return p(y(k.actual),128)+" "+k.operator+" "+p(y(k.expected),128)}function m(k,P,z,I,D){throw new o.AssertionError({message:z,actual:k,expected:P,operator:I,stackStartFunction:D})}o.fail=m;function u(k,P){k||m(k,!0,P,"==",o.ok)}o.ok=u,o.equal=function(P,z,I){P!=z&&m(P,z,I,"==",o.equal)},o.notEqual=function(P,z,I){P==z&&m(P,z,I,"!=",o.notEqual)},o.deepEqual=function(P,z,I){_(P,z,!1)||m(P,z,I,"deepEqual",o.deepEqual)},o.deepStrictEqual=function(P,z,I){_(P,z,!0)||m(P,z,I,"deepStrictEqual",o.deepStrictEqual)};function _(k,P,z,I){if(k===P)return!0;if(T(k)&&T(P))return M(k,P)===0;if(e.isDate(k)&&e.isDate(P))return k.getTime()===P.getTime();if(e.isRegExp(k)&&e.isRegExp(P))return k.source===P.source&&k.global===P.global&&k.multiline===P.multiline&&k.lastIndex===P.lastIndex&&k.ignoreCase===P.ignoreCase;if((k===null||typeof k!="object")&&(P===null||typeof P!="object"))return z?k===P:k==P;if(f(k)&&f(P)&&t(k)===t(P)&&!(k instanceof Float32Array||k instanceof Float64Array))return M(new Uint8Array(k.buffer),new Uint8Array(P.buffer))===0;if(T(k)!==T(P))return!1;I=I||{actual:[],expected:[]};var D=I.actual.indexOf(k);return D!==-1&&D===I.expected.indexOf(P)?!0:(I.actual.push(k),I.expected.push(P),A(k,P,z,I))}function s(k){return Object.prototype.toString.call(k)=="[object Arguments]"}function A(k,P,z,I){if(k==null||P===null||P===void 0)return!1;if(e.isPrimitive(k)||e.isPrimitive(P))return k===P;if(z&&Object.getPrototypeOf(k)!==Object.getPrototypeOf(P))return!1;var D=s(k),R=s(P);if(D&&!R||!D&&R)return!1;if(D)return k=n.call(k),P=n.call(P),_(k,P,z);var B=S(k),F=S(P),V,G;if(B.length!==F.length)return!1;for(B.sort(),F.sort(),G=B.length-1;G>=0;G--)if(B[G]!==F[G])return!1;for(G=B.length-1;G>=0;G--)if(V=B[G],!_(k[V],P[V],z,I))return!1;return!0}o.notDeepEqual=function(P,z,I){_(P,z,!1)&&m(P,z,I,"notDeepEqual",o.notDeepEqual)},o.notDeepStrictEqual=x;function x(k,P,z){_(k,P,!0)&&m(k,P,z,"notDeepStrictEqual",x)}o.strictEqual=function(P,z,I){P!==z&&m(P,z,I,"===",o.strictEqual)},o.notStrictEqual=function(P,z,I){P===z&&m(P,z,I,"!==",o.notStrictEqual)};function v(k,P){if(!k||!P)return!1;if(Object.prototype.toString.call(P)=="[object RegExp]")return P.test(k);try{if(k instanceof P)return!0}catch{}return Error.isPrototypeOf(P)?!1:P.call({},k)===!0}function b(k){var P;try{k()}catch(z){P=z}return P}function l(k,P,z,I){var D;if(typeof P!="function")throw new TypeError('"block" argument must be a function');typeof z=="string"&&(I=z,z=null),D=b(P),I=(z&&z.name?" ("+z.name+").":".")+(I?" "+I:"."),k&&!D&&m(D,z,"Missing expected exception"+I);var R=typeof I=="string",B=!k&&e.isError(D),F=!k&&D&&!z;if((B&&R&&v(D,z)||F)&&m(D,z,"Got unwanted exception"+I),k&&D&&z&&!v(D,z)||!k&&D)throw D}o.throws=function(k,P,z){l(!0,k,P,z)},o.doesNotThrow=function(k,P,z){l(!1,k,P,z)},o.ifError=function(k){if(k)throw k};function L(k,P){k||m(k,!0,P,"==",L)}o.strict=c(L,o,{equal:o.strictEqual,deepEqual:o.deepStrictEqual,notEqual:o.notStrictEqual,notDeepEqual:o.notDeepStrictEqual}),o.strict.strict=o.strict;var S=Object.keys||function(k){var P=[];for(var z in k)a.call(k,z)&&P.push(z);return P}}).call(this)}).call(this,typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"object-assign":247,"util/":78}],76:[function(d,re,ne){typeof Object.create=="function"?re.exports=function(c,M){c.super_=M,c.prototype=Object.create(M.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}})}:re.exports=function(c,M){c.super_=M;var T=function(){};T.prototype=M.prototype,c.prototype=new T,c.prototype.constructor=c}},{}],77:[function(d,re,ne){re.exports=function(c){return c&&typeof c=="object"&&typeof c.copy=="function"&&typeof c.fill=="function"&&typeof c.readUInt8=="function"}},{}],78:[function(d,re,ne){(function(w,c){(function(){var M=/%[sdj%]/g;ne.format=function(F){if(!A(F)){for(var V=[],G=0;G<arguments.length;G++)V.push(a(arguments[G]));return V.join(" ")}for(var G=1,J=arguments,j=J.length,Y=String(F).replace(M,function(oe){if(oe==="%%")return"%";if(G>=j)return oe;switch(oe){case"%s":return String(J[G++]);case"%d":return Number(J[G++]);case"%j":try{return JSON.stringify(J[G++])}catch{return"[Circular]"}default:return oe}}),X=J[G];G<j;X=J[++G])u(X)||!l(X)?Y+=" "+X:Y+=" "+a(X);return Y},ne.deprecate=function(F,V){if(v(c.process))return function(){return ne.deprecate(F,V).apply(this,arguments)};if(w.noDeprecation===!0)return F;var G=!1;function J(){if(!G){if(w.throwDeprecation)throw new Error(V);w.traceDeprecation?console.trace(V):console.error(V),G=!0}return F.apply(this,arguments)}return J};var T={},e;ne.debuglog=function(F){if(v(e)&&(e={}.NODE_DEBUG||""),F=F.toUpperCase(),!T[F])if(new RegExp("\\b"+F+"\\b","i").test(e)){var V=w.pid;T[F]=function(){var G=ne.format.apply(ne,arguments);console.error("%s %d: %s",F,V,G)}}else T[F]=function(){};return T[F]};function a(F,V){var G={seen:[],stylize:r};return arguments.length>=3&&(G.depth=arguments[2]),arguments.length>=4&&(G.colors=arguments[3]),m(V)?G.showHidden=V:V&&ne._extend(G,V),v(G.showHidden)&&(G.showHidden=!1),v(G.depth)&&(G.depth=2),v(G.colors)&&(G.colors=!1),v(G.customInspect)&&(G.customInspect=!0),G.colors&&(G.stylize=n),f(G,F,G.depth)}ne.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function n(F,V){var G=a.styles[V];return G?"\x1B["+a.colors[G][0]+"m"+F+"\x1B["+a.colors[G][1]+"m":F}function r(F,V){return F}function t(F){var V={};return F.forEach(function(G,J){V[G]=!0}),V}function f(F,V,G){if(F.customInspect&&V&&k(V.inspect)&&V.inspect!==ne.inspect&&!(V.constructor&&V.constructor.prototype===V)){var J=V.inspect(G,F);return A(J)||(J=f(F,J,G)),J}var j=o(F,V);if(j)return j;var Y=Object.keys(V),X=t(Y);if(F.showHidden&&(Y=Object.getOwnPropertyNames(V)),S(V)&&(Y.indexOf("message")>=0||Y.indexOf("description")>=0))return i(V);if(Y.length===0){if(k(V)){var oe=V.name?": "+V.name:"";return F.stylize("[Function"+oe+"]","special")}if(b(V))return F.stylize(RegExp.prototype.toString.call(V),"regexp");if(L(V))return F.stylize(Date.prototype.toString.call(V),"date");if(S(V))return i(V)}var se="",ie=!1,N=["{","}"];if(h(V)&&(ie=!0,N=["[","]"]),k(V)){var U=V.name?": "+V.name:"";se=" [Function"+U+"]"}if(b(V)&&(se=" "+RegExp.prototype.toString.call(V)),L(V)&&(se=" "+Date.prototype.toUTCString.call(V)),S(V)&&(se=" "+i(V)),Y.length===0&&(!ie||V.length==0))return N[0]+se+N[1];if(G<0)return b(V)?F.stylize(RegExp.prototype.toString.call(V),"regexp"):F.stylize("[Object]","special");F.seen.push(V);var q;return ie?q=g(F,V,G,X,Y):q=Y.map(function(Q){return p(F,V,G,X,Q,ie)}),F.seen.pop(),y(q,se,N)}function o(F,V){if(v(V))return F.stylize("undefined","undefined");if(A(V)){var G="'"+JSON.stringify(V).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return F.stylize(G,"string")}if(s(V))return F.stylize(""+V,"number");if(m(V))return F.stylize(""+V,"boolean");if(u(V))return F.stylize("null","null")}function i(F){return"["+Error.prototype.toString.call(F)+"]"}function g(F,V,G,J,j){for(var Y=[],X=0,oe=V.length;X<oe;++X)B(V,String(X))?Y.push(p(F,V,G,J,String(X),!0)):Y.push("");return j.forEach(function(se){se.match(/^\d+$/)||Y.push(p(F,V,G,J,se,!0))}),Y}function p(F,V,G,J,j,Y){var X,oe,se;if(se=Object.getOwnPropertyDescriptor(V,j)||{value:V[j]},se.get?se.set?oe=F.stylize("[Getter/Setter]","special"):oe=F.stylize("[Getter]","special"):se.set&&(oe=F.stylize("[Setter]","special")),B(J,j)||(X="["+j+"]"),oe||(F.seen.indexOf(se.value)<0?(u(G)?oe=f(F,se.value,null):oe=f(F,se.value,G-1),oe.indexOf(`
`)>-1&&(Y?oe=oe.split(`
`).map(function(ie){return"  "+ie}).join(`
`).substr(2):oe=`
`+oe.split(`
`).map(function(ie){return"   "+ie}).join(`
`))):oe=F.stylize("[Circular]","special")),v(X)){if(Y&&j.match(/^\d+$/))return oe;X=JSON.stringify(""+j),X.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(X=X.substr(1,X.length-2),X=F.stylize(X,"name")):(X=X.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),X=F.stylize(X,"string"))}return X+": "+oe}function y(F,V,G){var J=F.reduce(function(j,Y){return Y.indexOf(`
`)>=0,j+Y.replace(/\u001b\[\d\d?m/g,"").length+1},0);return J>60?G[0]+(V===""?"":V+`
 `)+" "+F.join(`,
  `)+" "+G[1]:G[0]+V+" "+F.join(", ")+" "+G[1]}function h(F){return Array.isArray(F)}ne.isArray=h;function m(F){return typeof F=="boolean"}ne.isBoolean=m;function u(F){return F===null}ne.isNull=u;function _(F){return F==null}ne.isNullOrUndefined=_;function s(F){return typeof F=="number"}ne.isNumber=s;function A(F){return typeof F=="string"}ne.isString=A;function x(F){return typeof F=="symbol"}ne.isSymbol=x;function v(F){return F===void 0}ne.isUndefined=v;function b(F){return l(F)&&z(F)==="[object RegExp]"}ne.isRegExp=b;function l(F){return typeof F=="object"&&F!==null}ne.isObject=l;function L(F){return l(F)&&z(F)==="[object Date]"}ne.isDate=L;function S(F){return l(F)&&(z(F)==="[object Error]"||F instanceof Error)}ne.isError=S;function k(F){return typeof F=="function"}ne.isFunction=k;function P(F){return F===null||typeof F=="boolean"||typeof F=="number"||typeof F=="string"||typeof F=="symbol"||typeof F=="undefined"}ne.isPrimitive=P,ne.isBuffer=d("./support/isBuffer");function z(F){return Object.prototype.toString.call(F)}function I(F){return F<10?"0"+F.toString(10):F.toString(10)}var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var F=new Date,V=[I(F.getHours()),I(F.getMinutes()),I(F.getSeconds())].join(":");return[F.getDate(),D[F.getMonth()],V].join(" ")}ne.log=function(){console.log("%s - %s",R(),ne.format.apply(ne,arguments))},ne.inherits=d("inherits"),ne._extend=function(F,V){if(!V||!l(V))return F;for(var G=Object.keys(V),J=G.length;J--;)F[G[J]]=V[G[J]];return F};function B(F,V){return Object.prototype.hasOwnProperty.call(F,V)}}).call(this)}).call(this,d("_process"),typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./support/isBuffer":77,_process:277,inherits:76}],79:[function(d,re,ne){ne.byteLength=r,ne.toByteArray=f,ne.fromByteArray=g;for(var w=[],c=[],M=typeof Uint8Array!="undefined"?Uint8Array:Array,T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,a=T.length;e<a;++e)w[e]=T[e],c[T.charCodeAt(e)]=e;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63;function n(p){var y=p.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var h=p.indexOf("=");h===-1&&(h=y);var m=h===y?0:4-h%4;return[h,m]}function r(p){var y=n(p),h=y[0],m=y[1];return(h+m)*3/4-m}function t(p,y,h){return(y+h)*3/4-h}function f(p){var y,h=n(p),m=h[0],u=h[1],_=new M(t(p,m,u)),s=0,A=u>0?m-4:m,x;for(x=0;x<A;x+=4)y=c[p.charCodeAt(x)]<<18|c[p.charCodeAt(x+1)]<<12|c[p.charCodeAt(x+2)]<<6|c[p.charCodeAt(x+3)],_[s++]=y>>16&255,_[s++]=y>>8&255,_[s++]=y&255;return u===2&&(y=c[p.charCodeAt(x)]<<2|c[p.charCodeAt(x+1)]>>4,_[s++]=y&255),u===1&&(y=c[p.charCodeAt(x)]<<10|c[p.charCodeAt(x+1)]<<4|c[p.charCodeAt(x+2)]>>2,_[s++]=y>>8&255,_[s++]=y&255),_}function o(p){return w[p>>18&63]+w[p>>12&63]+w[p>>6&63]+w[p&63]}function i(p,y,h){for(var m,u=[],_=y;_<h;_+=3)m=(p[_]<<16&16711680)+(p[_+1]<<8&65280)+(p[_+2]&255),u.push(o(m));return u.join("")}function g(p){for(var y,h=p.length,m=h%3,u=[],_=16383,s=0,A=h-m;s<A;s+=_)u.push(i(p,s,s+_>A?A:s+_));return m===1?(y=p[h-1],u.push(w[y>>2]+w[y<<4&63]+"==")):m===2&&(y=(p[h-2]<<8)+p[h-1],u.push(w[y>>10]+w[y>>4&63]+w[y<<2&63]+"=")),u.join("")}},{}],80:[function(d,re,ne){function w(n,r,t,f,o){for(var i=o+1;f<=o;){var g=f+o>>>1,p=n[g],y=t!==void 0?t(p,r):p-r;y>=0?(i=g,o=g-1):f=g+1}return i}function c(n,r,t,f,o){for(var i=o+1;f<=o;){var g=f+o>>>1,p=n[g],y=t!==void 0?t(p,r):p-r;y>0?(i=g,o=g-1):f=g+1}return i}function M(n,r,t,f,o){for(var i=f-1;f<=o;){var g=f+o>>>1,p=n[g],y=t!==void 0?t(p,r):p-r;y<0?(i=g,f=g+1):o=g-1}return i}function T(n,r,t,f,o){for(var i=f-1;f<=o;){var g=f+o>>>1,p=n[g],y=t!==void 0?t(p,r):p-r;y<=0?(i=g,f=g+1):o=g-1}return i}function e(n,r,t,f,o){for(;f<=o;){var i=f+o>>>1,g=n[i],p=t!==void 0?t(g,r):g-r;if(p===0)return i;p<=0?f=i+1:o=i-1}return-1}function a(n,r,t,f,o,i){return typeof t=="function"?i(n,r,t,f===void 0?0:f|0,o===void 0?n.length-1:o|0):i(n,r,void 0,t===void 0?0:t|0,f===void 0?n.length-1:f|0)}re.exports={ge:function(n,r,t,f,o){return a(n,r,t,f,o,w)},gt:function(n,r,t,f,o){return a(n,r,t,f,o,c)},lt:function(n,r,t,f,o){return a(n,r,t,f,o,M)},le:function(n,r,t,f,o){return a(n,r,t,f,o,T)},eq:function(n,r,t,f,o){return a(n,r,t,f,o,e)}}},{}],81:[function(d,re,ne){var w=32;ne.INT_BITS=w,ne.INT_MAX=2147483647,ne.INT_MIN=-1<<w-1,ne.sign=function(T){return(T>0)-(T<0)},ne.abs=function(T){var e=T>>w-1;return(T^e)-e},ne.min=function(T,e){return e^(T^e)&-(T<e)},ne.max=function(T,e){return T^(T^e)&-(T<e)},ne.isPow2=function(T){return!(T&T-1)&&!!T},ne.log2=function(T){var e,a;return e=(T>65535)<<4,T>>>=e,a=(T>255)<<3,T>>>=a,e|=a,a=(T>15)<<2,T>>>=a,e|=a,a=(T>3)<<1,T>>>=a,e|=a,e|T>>1},ne.log10=function(T){return T>=1e9?9:T>=1e8?8:T>=1e7?7:T>=1e6?6:T>=1e5?5:T>=1e4?4:T>=1e3?3:T>=100?2:T>=10?1:0},ne.popCount=function(T){return T=T-(T>>>1&1431655765),T=(T&858993459)+(T>>>2&858993459),(T+(T>>>4)&252645135)*16843009>>>24};function c(T){var e=32;return T&=-T,T&&e--,T&65535&&(e-=16),T&16711935&&(e-=8),T&252645135&&(e-=4),T&858993459&&(e-=2),T&1431655765&&(e-=1),e}ne.countTrailingZeros=c,ne.nextPow2=function(T){return T+=T===0,--T,T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,T|=T>>>16,T+1},ne.prevPow2=function(T){return T|=T>>>1,T|=T>>>2,T|=T>>>4,T|=T>>>8,T|=T>>>16,T-(T>>>1)},ne.parity=function(T){return T^=T>>>16,T^=T>>>8,T^=T>>>4,T&=15,27030>>>T&1};var M=new Array(256);(function(T){for(var e=0;e<256;++e){var a=e,n=e,r=7;for(a>>>=1;a;a>>>=1)n<<=1,n|=a&1,--r;T[e]=n<<r&255}})(M),ne.reverse=function(T){return M[T&255]<<24|M[T>>>8&255]<<16|M[T>>>16&255]<<8|M[T>>>24&255]},ne.interleave2=function(T,e){return T&=65535,T=(T|T<<8)&16711935,T=(T|T<<4)&252645135,T=(T|T<<2)&858993459,T=(T|T<<1)&1431655765,e&=65535,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,T|e<<1},ne.deinterleave2=function(T,e){return T=T>>>e&1431655765,T=(T|T>>>1)&858993459,T=(T|T>>>2)&252645135,T=(T|T>>>4)&16711935,T=(T|T>>>16)&65535,T<<16>>16},ne.interleave3=function(T,e,a){return T&=1023,T=(T|T<<16)&4278190335,T=(T|T<<8)&251719695,T=(T|T<<4)&3272356035,T=(T|T<<2)&1227133513,e&=1023,e=(e|e<<16)&4278190335,e=(e|e<<8)&251719695,e=(e|e<<4)&3272356035,e=(e|e<<2)&1227133513,T|=e<<1,a&=1023,a=(a|a<<16)&4278190335,a=(a|a<<8)&251719695,a=(a|a<<4)&3272356035,a=(a|a<<2)&1227133513,T|a<<2},ne.deinterleave3=function(T,e){return T=T>>>e&1227133513,T=(T|T>>>2)&3272356035,T=(T|T>>>4)&251719695,T=(T|T>>>8)&4278190335,T=(T|T>>>16)&1023,T<<22>>22},ne.nextCombination=function(T){var e=T|T-1;return e+1|(~e&-~e)-1>>>c(T)+1}},{}],82:[function(d,re,ne){var w=d("clamp");re.exports=M;var c=1e20;function M(a,n){n||(n={});var r=n.cutoff==null?.25:n.cutoff,t=n.radius==null?8:n.radius,f=n.channel||0,o,i,g,p,y,h,m,u,_,s,A;if(ArrayBuffer.isView(a)||Array.isArray(a)){if(!n.width||!n.height)throw Error("For raw data width and height should be provided by options");o=n.width,i=n.height,p=a,n.stride?h=n.stride:h=Math.floor(a.length/o/i)}else window.HTMLCanvasElement&&a instanceof window.HTMLCanvasElement?(u=a,m=u.getContext("2d"),o=u.width,i=u.height,_=m.getImageData(0,0,o,i),p=_.data,h=4):window.CanvasRenderingContext2D&&a instanceof window.CanvasRenderingContext2D?(u=a.canvas,m=a,o=u.width,i=u.height,_=m.getImageData(0,0,o,i),p=_.data,h=4):window.ImageData&&a instanceof window.ImageData&&(_=a,o=a.width,i=a.height,p=_.data,h=4);if(g=Math.max(o,i),window.Uint8ClampedArray&&p instanceof window.Uint8ClampedArray||window.Uint8Array&&p instanceof window.Uint8Array)for(y=p,p=Array(o*i),s=0,A=y.length;s<A;s++)p[s]=y[s*h+f]/255;else if(h!==1)throw Error("Raw data can have only 1 value per pixel");var x=Array(o*i),v=Array(o*i),b=Array(g),l=Array(g),L=Array(g+1),S=Array(g);for(s=0,A=o*i;s<A;s++){var k=p[s];x[s]=k===1?0:k===0?c:Math.pow(Math.max(0,.5-k),2),v[s]=k===1?c:k===0?0:Math.pow(Math.max(0,k-.5),2)}T(x,o,i,b,l,S,L),T(v,o,i,b,l,S,L);var P=window.Float32Array?new Float32Array(o*i):new Array(o*i);for(s=0,A=o*i;s<A;s++)P[s]=w(1-((x[s]-v[s])/t+r),0,1);return P}function T(a,n,r,t,f,o,i){for(var g=0;g<n;g++){for(var p=0;p<r;p++)t[p]=a[p*n+g];for(e(t,f,o,i,r),p=0;p<r;p++)a[p*n+g]=f[p]}for(p=0;p<r;p++){for(g=0;g<n;g++)t[g]=a[p*n+g];for(e(t,f,o,i,n),g=0;g<n;g++)a[p*n+g]=Math.sqrt(f[g])}}function e(a,n,r,t,f){r[0]=0,t[0]=-c,t[1]=+c;for(var o=1,i=0;o<f;o++){for(var g=(a[o]+o*o-(a[r[i]]+r[i]*r[i]))/(2*o-2*r[i]);g<=t[i];)i--,g=(a[o]+o*o-(a[r[i]]+r[i]*r[i]))/(2*o-2*r[i]);i++,r[i]=o,t[i]=g,t[i+1]=+c}for(o=0,i=0;o<f;o++){for(;t[i+1]<o;)i++;n[o]=(o-r[i])*(o-r[i])+a[r[i]]}}},{clamp:86}],83:[function(d,re,ne){},{}],84:[function(d,re,ne){var w=typeof Reflect=="object"?Reflect:null,c=w&&typeof w.apply=="function"?w.apply:function(s,A,x){return Function.prototype.apply.call(s,A,x)},M;w&&typeof w.ownKeys=="function"?M=w.ownKeys:Object.getOwnPropertySymbols?M=function(s){return Object.getOwnPropertyNames(s).concat(Object.getOwnPropertySymbols(s))}:M=function(s){return Object.getOwnPropertyNames(s)};function T(_){console&&console.warn&&console.warn(_)}var e=Number.isNaN||function(s){return s!==s};function a(){a.init.call(this)}re.exports=a,re.exports.once=u,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var n=10;function r(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return n},set:function(_){if(typeof _!="number"||_<0||e(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");n=_}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(s){if(typeof s!="number"||s<0||e(s))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+s+".");return this._maxListeners=s,this};function t(_){return _._maxListeners===void 0?a.defaultMaxListeners:_._maxListeners}a.prototype.getMaxListeners=function(){return t(this)},a.prototype.emit=function(s){for(var A=[],x=1;x<arguments.length;x++)A.push(arguments[x]);var v=s==="error",b=this._events;if(b!==void 0)v=v&&b.error===void 0;else if(!v)return!1;if(v){var l;if(A.length>0&&(l=A[0]),l instanceof Error)throw l;var L=new Error("Unhandled error."+(l?" ("+l.message+")":""));throw L.context=l,L}var S=b[s];if(S===void 0)return!1;if(typeof S=="function")c(S,this,A);else for(var k=S.length,P=y(S,k),x=0;x<k;++x)c(P[x],this,A);return!0};function f(_,s,A,x){var v,b,l;if(r(A),b=_._events,b===void 0?(b=_._events=Object.create(null),_._eventsCount=0):(b.newListener!==void 0&&(_.emit("newListener",s,A.listener?A.listener:A),b=_._events),l=b[s]),l===void 0)l=b[s]=A,++_._eventsCount;else if(typeof l=="function"?l=b[s]=x?[A,l]:[l,A]:x?l.unshift(A):l.push(A),v=t(_),v>0&&l.length>v&&!l.warned){l.warned=!0;var L=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(s)+" listeners added. Use emitter.setMaxListeners() to increase limit");L.name="MaxListenersExceededWarning",L.emitter=_,L.type=s,L.count=l.length,T(L)}return _}a.prototype.addListener=function(s,A){return f(this,s,A,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(s,A){return f(this,s,A,!0)};function o(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function i(_,s,A){var x={fired:!1,wrapFn:void 0,target:_,type:s,listener:A},v=o.bind(x);return v.listener=A,x.wrapFn=v,v}a.prototype.once=function(s,A){return r(A),this.on(s,i(this,s,A)),this},a.prototype.prependOnceListener=function(s,A){return r(A),this.prependListener(s,i(this,s,A)),this},a.prototype.removeListener=function(s,A){var x,v,b,l,L;if(r(A),v=this._events,v===void 0)return this;if(x=v[s],x===void 0)return this;if(x===A||x.listener===A)--this._eventsCount===0?this._events=Object.create(null):(delete v[s],v.removeListener&&this.emit("removeListener",s,x.listener||A));else if(typeof x!="function"){for(b=-1,l=x.length-1;l>=0;l--)if(x[l]===A||x[l].listener===A){L=x[l].listener,b=l;break}if(b<0)return this;b===0?x.shift():h(x,b),x.length===1&&(v[s]=x[0]),v.removeListener!==void 0&&this.emit("removeListener",s,L||A)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(s){var A,x,v;if(x=this._events,x===void 0)return this;if(x.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):x[s]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete x[s]),this;if(arguments.length===0){var b=Object.keys(x),l;for(v=0;v<b.length;++v)l=b[v],l!=="removeListener"&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(A=x[s],typeof A=="function")this.removeListener(s,A);else if(A!==void 0)for(v=A.length-1;v>=0;v--)this.removeListener(s,A[v]);return this};function g(_,s,A){var x=_._events;if(x===void 0)return[];var v=x[s];return v===void 0?[]:typeof v=="function"?A?[v.listener||v]:[v]:A?m(v):y(v,v.length)}a.prototype.listeners=function(s){return g(this,s,!0)},a.prototype.rawListeners=function(s){return g(this,s,!1)},a.listenerCount=function(_,s){return typeof _.listenerCount=="function"?_.listenerCount(s):p.call(_,s)},a.prototype.listenerCount=p;function p(_){var s=this._events;if(s!==void 0){var A=s[_];if(typeof A=="function")return 1;if(A!==void 0)return A.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?M(this._events):[]};function y(_,s){for(var A=new Array(s),x=0;x<s;++x)A[x]=_[x];return A}function h(_,s){for(;s+1<_.length;s++)_[s]=_[s+1];_.pop()}function m(_){for(var s=new Array(_.length),A=0;A<s.length;++A)s[A]=_[A].listener||_[A];return s}function u(_,s){return new Promise(function(A,x){function v(){b!==void 0&&_.removeListener("error",b),A([].slice.call(arguments))}var b;s!=="error"&&(b=function(L){_.removeListener(s,v),x(L)},_.once("error",b)),_.once(s,v)})}},{}],85:[function(d,re,ne){(function(w){(function(){var c=d("base64-js"),M=d("ieee754");ne.Buffer=n,ne.SlowBuffer=m,ne.INSPECT_MAX_BYTES=50;var T=2147483647;ne.kMaxLength=T,n.TYPED_ARRAY_SUPPORT=e(),!n.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function e(){try{var te=new Uint8Array(1);return te.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},te.foo()===42}catch{return!1}}Object.defineProperty(n.prototype,"parent",{enumerable:!0,get:function(){if(!!n.isBuffer(this))return this.buffer}}),Object.defineProperty(n.prototype,"offset",{enumerable:!0,get:function(){if(!!n.isBuffer(this))return this.byteOffset}});function a(te){if(te>T)throw new RangeError('The value "'+te+'" is invalid for option "size"');var ae=new Uint8Array(te);return ae.__proto__=n.prototype,ae}function n(te,ae,le){if(typeof te=="number"){if(typeof ae=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return o(te)}return r(te,ae,le)}typeof Symbol!="undefined"&&Symbol.species!=null&&n[Symbol.species]===n&&Object.defineProperty(n,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),n.poolSize=8192;function r(te,ae,le){if(typeof te=="string")return i(te,ae);if(ArrayBuffer.isView(te))return g(te);if(te==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof te);if(Z(te,ArrayBuffer)||te&&Z(te.buffer,ArrayBuffer))return p(te,ae,le);if(typeof te=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ye=te.valueOf&&te.valueOf();if(ye!=null&&ye!==te)return n.from(ye,ae,le);var fe=y(te);if(fe)return fe;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof te[Symbol.toPrimitive]=="function")return n.from(te[Symbol.toPrimitive]("string"),ae,le);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof te)}n.from=function(te,ae,le){return r(te,ae,le)},n.prototype.__proto__=Uint8Array.prototype,n.__proto__=Uint8Array;function t(te){if(typeof te!="number")throw new TypeError('"size" argument must be of type number');if(te<0)throw new RangeError('The value "'+te+'" is invalid for option "size"')}function f(te,ae,le){return t(te),te<=0?a(te):ae!==void 0?typeof le=="string"?a(te).fill(ae,le):a(te).fill(ae):a(te)}n.alloc=function(te,ae,le){return f(te,ae,le)};function o(te){return t(te),a(te<0?0:h(te)|0)}n.allocUnsafe=function(te){return o(te)},n.allocUnsafeSlow=function(te){return o(te)};function i(te,ae){if((typeof ae!="string"||ae==="")&&(ae="utf8"),!n.isEncoding(ae))throw new TypeError("Unknown encoding: "+ae);var le=u(te,ae)|0,ye=a(le),fe=ye.write(te,ae);return fe!==le&&(ye=ye.slice(0,fe)),ye}function g(te){for(var ae=te.length<0?0:h(te.length)|0,le=a(ae),ye=0;ye<ae;ye+=1)le[ye]=te[ye]&255;return le}function p(te,ae,le){if(ae<0||te.byteLength<ae)throw new RangeError('"offset" is outside of buffer bounds');if(te.byteLength<ae+(le||0))throw new RangeError('"length" is outside of buffer bounds');var ye;return ae===void 0&&le===void 0?ye=new Uint8Array(te):le===void 0?ye=new Uint8Array(te,ae):ye=new Uint8Array(te,ae,le),ye.__proto__=n.prototype,ye}function y(te){if(n.isBuffer(te)){var ae=h(te.length)|0,le=a(ae);return le.length===0||te.copy(le,0,0,ae),le}if(te.length!==void 0)return typeof te.length!="number"||ee(te.length)?a(0):g(te);if(te.type==="Buffer"&&Array.isArray(te.data))return g(te.data)}function h(te){if(te>=T)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+T.toString(16)+" bytes");return te|0}function m(te){return+te!=te&&(te=0),n.alloc(+te)}n.isBuffer=function(ae){return ae!=null&&ae._isBuffer===!0&&ae!==n.prototype},n.compare=function(ae,le){if(Z(ae,Uint8Array)&&(ae=n.from(ae,ae.offset,ae.byteLength)),Z(le,Uint8Array)&&(le=n.from(le,le.offset,le.byteLength)),!n.isBuffer(ae)||!n.isBuffer(le))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ae===le)return 0;for(var ye=ae.length,fe=le.length,pe=0,ge=Math.min(ye,fe);pe<ge;++pe)if(ae[pe]!==le[pe]){ye=ae[pe],fe=le[pe];break}return ye<fe?-1:fe<ye?1:0},n.isEncoding=function(ae){switch(String(ae).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(ae,le){if(!Array.isArray(ae))throw new TypeError('"list" argument must be an Array of Buffers');if(ae.length===0)return n.alloc(0);var ye;if(le===void 0)for(le=0,ye=0;ye<ae.length;++ye)le+=ae[ye].length;var fe=n.allocUnsafe(le),pe=0;for(ye=0;ye<ae.length;++ye){var ge=ae[ye];if(Z(ge,Uint8Array)&&(ge=n.from(ge)),!n.isBuffer(ge))throw new TypeError('"list" argument must be an Array of Buffers');ge.copy(fe,pe),pe+=ge.length}return fe};function u(te,ae){if(n.isBuffer(te))return te.length;if(ArrayBuffer.isView(te)||Z(te,ArrayBuffer))return te.byteLength;if(typeof te!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof te);var le=te.length,ye=arguments.length>2&&arguments[2]===!0;if(!ye&&le===0)return 0;for(var fe=!1;;)switch(ae){case"ascii":case"latin1":case"binary":return le;case"utf8":case"utf-8":return N(te).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le*2;case"hex":return le>>>1;case"base64":return Q(te).length;default:if(fe)return ye?-1:N(te).length;ae=(""+ae).toLowerCase(),fe=!0}}n.byteLength=u;function _(te,ae,le){var ye=!1;if((ae===void 0||ae<0)&&(ae=0),ae>this.length||((le===void 0||le>this.length)&&(le=this.length),le<=0)||(le>>>=0,ae>>>=0,le<=ae))return"";for(te||(te="utf8");;)switch(te){case"hex":return F(this,ae,le);case"utf8":case"utf-8":return z(this,ae,le);case"ascii":return R(this,ae,le);case"latin1":case"binary":return B(this,ae,le);case"base64":return P(this,ae,le);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V(this,ae,le);default:if(ye)throw new TypeError("Unknown encoding: "+te);te=(te+"").toLowerCase(),ye=!0}}n.prototype._isBuffer=!0;function s(te,ae,le){var ye=te[ae];te[ae]=te[le],te[le]=ye}n.prototype.swap16=function(){var ae=this.length;if(ae%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var le=0;le<ae;le+=2)s(this,le,le+1);return this},n.prototype.swap32=function(){var ae=this.length;if(ae%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var le=0;le<ae;le+=4)s(this,le,le+3),s(this,le+1,le+2);return this},n.prototype.swap64=function(){var ae=this.length;if(ae%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var le=0;le<ae;le+=8)s(this,le,le+7),s(this,le+1,le+6),s(this,le+2,le+5),s(this,le+3,le+4);return this},n.prototype.toString=function(){var ae=this.length;return ae===0?"":arguments.length===0?z(this,0,ae):_.apply(this,arguments)},n.prototype.toLocaleString=n.prototype.toString,n.prototype.equals=function(ae){if(!n.isBuffer(ae))throw new TypeError("Argument must be a Buffer");return this===ae?!0:n.compare(this,ae)===0},n.prototype.inspect=function(){var ae="",le=ne.INSPECT_MAX_BYTES;return ae=this.toString("hex",0,le).replace(/(.{2})/g,"$1 ").trim(),this.length>le&&(ae+=" ... "),"<Buffer "+ae+">"},n.prototype.compare=function(ae,le,ye,fe,pe){if(Z(ae,Uint8Array)&&(ae=n.from(ae,ae.offset,ae.byteLength)),!n.isBuffer(ae))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ae);if(le===void 0&&(le=0),ye===void 0&&(ye=ae?ae.length:0),fe===void 0&&(fe=0),pe===void 0&&(pe=this.length),le<0||ye>ae.length||fe<0||pe>this.length)throw new RangeError("out of range index");if(fe>=pe&&le>=ye)return 0;if(fe>=pe)return-1;if(le>=ye)return 1;if(le>>>=0,ye>>>=0,fe>>>=0,pe>>>=0,this===ae)return 0;for(var ge=pe-fe,Ae=ye-le,we=Math.min(ge,Ae),De=this.slice(fe,pe),Be=ae.slice(le,ye),Ve=0;Ve<we;++Ve)if(De[Ve]!==Be[Ve]){ge=De[Ve],Ae=Be[Ve];break}return ge<Ae?-1:Ae<ge?1:0};function A(te,ae,le,ye,fe){if(te.length===0)return-1;if(typeof le=="string"?(ye=le,le=0):le>2147483647?le=2147483647:le<-2147483648&&(le=-2147483648),le=+le,ee(le)&&(le=fe?0:te.length-1),le<0&&(le=te.length+le),le>=te.length){if(fe)return-1;le=te.length-1}else if(le<0)if(fe)le=0;else return-1;if(typeof ae=="string"&&(ae=n.from(ae,ye)),n.isBuffer(ae))return ae.length===0?-1:x(te,ae,le,ye,fe);if(typeof ae=="number")return ae=ae&255,typeof Uint8Array.prototype.indexOf=="function"?fe?Uint8Array.prototype.indexOf.call(te,ae,le):Uint8Array.prototype.lastIndexOf.call(te,ae,le):x(te,[ae],le,ye,fe);throw new TypeError("val must be string, number or Buffer")}function x(te,ae,le,ye,fe){var pe=1,ge=te.length,Ae=ae.length;if(ye!==void 0&&(ye=String(ye).toLowerCase(),ye==="ucs2"||ye==="ucs-2"||ye==="utf16le"||ye==="utf-16le")){if(te.length<2||ae.length<2)return-1;pe=2,ge/=2,Ae/=2,le/=2}function we(Le,He){return pe===1?Le[He]:Le.readUInt16BE(He*pe)}var De;if(fe){var Be=-1;for(De=le;De<ge;De++)if(we(te,De)===we(ae,Be===-1?0:De-Be)){if(Be===-1&&(Be=De),De-Be+1===Ae)return Be*pe}else Be!==-1&&(De-=De-Be),Be=-1}else for(le+Ae>ge&&(le=ge-Ae),De=le;De>=0;De--){for(var Ve=!0,xe=0;xe<Ae;xe++)if(we(te,De+xe)!==we(ae,xe)){Ve=!1;break}if(Ve)return De}return-1}n.prototype.includes=function(ae,le,ye){return this.indexOf(ae,le,ye)!==-1},n.prototype.indexOf=function(ae,le,ye){return A(this,ae,le,ye,!0)},n.prototype.lastIndexOf=function(ae,le,ye){return A(this,ae,le,ye,!1)};function v(te,ae,le,ye){le=Number(le)||0;var fe=te.length-le;ye?(ye=Number(ye),ye>fe&&(ye=fe)):ye=fe;var pe=ae.length;ye>pe/2&&(ye=pe/2);for(var ge=0;ge<ye;++ge){var Ae=parseInt(ae.substr(ge*2,2),16);if(ee(Ae))return ge;te[le+ge]=Ae}return ge}function b(te,ae,le,ye){return W(N(ae,te.length-le),te,le,ye)}function l(te,ae,le,ye){return W(U(ae),te,le,ye)}function L(te,ae,le,ye){return l(te,ae,le,ye)}function S(te,ae,le,ye){return W(Q(ae),te,le,ye)}function k(te,ae,le,ye){return W(q(ae,te.length-le),te,le,ye)}n.prototype.write=function(ae,le,ye,fe){if(le===void 0)fe="utf8",ye=this.length,le=0;else if(ye===void 0&&typeof le=="string")fe=le,ye=this.length,le=0;else if(isFinite(le))le=le>>>0,isFinite(ye)?(ye=ye>>>0,fe===void 0&&(fe="utf8")):(fe=ye,ye=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var pe=this.length-le;if((ye===void 0||ye>pe)&&(ye=pe),ae.length>0&&(ye<0||le<0)||le>this.length)throw new RangeError("Attempt to write outside buffer bounds");fe||(fe="utf8");for(var ge=!1;;)switch(fe){case"hex":return v(this,ae,le,ye);case"utf8":case"utf-8":return b(this,ae,le,ye);case"ascii":return l(this,ae,le,ye);case"latin1":case"binary":return L(this,ae,le,ye);case"base64":return S(this,ae,le,ye);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,ae,le,ye);default:if(ge)throw new TypeError("Unknown encoding: "+fe);fe=(""+fe).toLowerCase(),ge=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(te,ae,le){return ae===0&&le===te.length?c.fromByteArray(te):c.fromByteArray(te.slice(ae,le))}function z(te,ae,le){le=Math.min(te.length,le);for(var ye=[],fe=ae;fe<le;){var pe=te[fe],ge=null,Ae=pe>239?4:pe>223?3:pe>191?2:1;if(fe+Ae<=le){var we,De,Be,Ve;switch(Ae){case 1:pe<128&&(ge=pe);break;case 2:we=te[fe+1],(we&192)===128&&(Ve=(pe&31)<<6|we&63,Ve>127&&(ge=Ve));break;case 3:we=te[fe+1],De=te[fe+2],(we&192)===128&&(De&192)===128&&(Ve=(pe&15)<<12|(we&63)<<6|De&63,Ve>2047&&(Ve<55296||Ve>57343)&&(ge=Ve));break;case 4:we=te[fe+1],De=te[fe+2],Be=te[fe+3],(we&192)===128&&(De&192)===128&&(Be&192)===128&&(Ve=(pe&15)<<18|(we&63)<<12|(De&63)<<6|Be&63,Ve>65535&&Ve<1114112&&(ge=Ve))}}ge===null?(ge=65533,Ae=1):ge>65535&&(ge-=65536,ye.push(ge>>>10&1023|55296),ge=56320|ge&1023),ye.push(ge),fe+=Ae}return D(ye)}var I=4096;function D(te){var ae=te.length;if(ae<=I)return String.fromCharCode.apply(String,te);for(var le="",ye=0;ye<ae;)le+=String.fromCharCode.apply(String,te.slice(ye,ye+=I));return le}function R(te,ae,le){var ye="";le=Math.min(te.length,le);for(var fe=ae;fe<le;++fe)ye+=String.fromCharCode(te[fe]&127);return ye}function B(te,ae,le){var ye="";le=Math.min(te.length,le);for(var fe=ae;fe<le;++fe)ye+=String.fromCharCode(te[fe]);return ye}function F(te,ae,le){var ye=te.length;(!ae||ae<0)&&(ae=0),(!le||le<0||le>ye)&&(le=ye);for(var fe="",pe=ae;pe<le;++pe)fe+=ie(te[pe]);return fe}function V(te,ae,le){for(var ye=te.slice(ae,le),fe="",pe=0;pe<ye.length;pe+=2)fe+=String.fromCharCode(ye[pe]+ye[pe+1]*256);return fe}n.prototype.slice=function(ae,le){var ye=this.length;ae=~~ae,le=le===void 0?ye:~~le,ae<0?(ae+=ye,ae<0&&(ae=0)):ae>ye&&(ae=ye),le<0?(le+=ye,le<0&&(le=0)):le>ye&&(le=ye),le<ae&&(le=ae);var fe=this.subarray(ae,le);return fe.__proto__=n.prototype,fe};function G(te,ae,le){if(te%1!==0||te<0)throw new RangeError("offset is not uint");if(te+ae>le)throw new RangeError("Trying to access beyond buffer length")}n.prototype.readUIntLE=function(ae,le,ye){ae=ae>>>0,le=le>>>0,ye||G(ae,le,this.length);for(var fe=this[ae],pe=1,ge=0;++ge<le&&(pe*=256);)fe+=this[ae+ge]*pe;return fe},n.prototype.readUIntBE=function(ae,le,ye){ae=ae>>>0,le=le>>>0,ye||G(ae,le,this.length);for(var fe=this[ae+--le],pe=1;le>0&&(pe*=256);)fe+=this[ae+--le]*pe;return fe},n.prototype.readUInt8=function(ae,le){return ae=ae>>>0,le||G(ae,1,this.length),this[ae]},n.prototype.readUInt16LE=function(ae,le){return ae=ae>>>0,le||G(ae,2,this.length),this[ae]|this[ae+1]<<8},n.prototype.readUInt16BE=function(ae,le){return ae=ae>>>0,le||G(ae,2,this.length),this[ae]<<8|this[ae+1]},n.prototype.readUInt32LE=function(ae,le){return ae=ae>>>0,le||G(ae,4,this.length),(this[ae]|this[ae+1]<<8|this[ae+2]<<16)+this[ae+3]*16777216},n.prototype.readUInt32BE=function(ae,le){return ae=ae>>>0,le||G(ae,4,this.length),this[ae]*16777216+(this[ae+1]<<16|this[ae+2]<<8|this[ae+3])},n.prototype.readIntLE=function(ae,le,ye){ae=ae>>>0,le=le>>>0,ye||G(ae,le,this.length);for(var fe=this[ae],pe=1,ge=0;++ge<le&&(pe*=256);)fe+=this[ae+ge]*pe;return pe*=128,fe>=pe&&(fe-=Math.pow(2,8*le)),fe},n.prototype.readIntBE=function(ae,le,ye){ae=ae>>>0,le=le>>>0,ye||G(ae,le,this.length);for(var fe=le,pe=1,ge=this[ae+--fe];fe>0&&(pe*=256);)ge+=this[ae+--fe]*pe;return pe*=128,ge>=pe&&(ge-=Math.pow(2,8*le)),ge},n.prototype.readInt8=function(ae,le){return ae=ae>>>0,le||G(ae,1,this.length),this[ae]&128?(255-this[ae]+1)*-1:this[ae]},n.prototype.readInt16LE=function(ae,le){ae=ae>>>0,le||G(ae,2,this.length);var ye=this[ae]|this[ae+1]<<8;return ye&32768?ye|4294901760:ye},n.prototype.readInt16BE=function(ae,le){ae=ae>>>0,le||G(ae,2,this.length);var ye=this[ae+1]|this[ae]<<8;return ye&32768?ye|4294901760:ye},n.prototype.readInt32LE=function(ae,le){return ae=ae>>>0,le||G(ae,4,this.length),this[ae]|this[ae+1]<<8|this[ae+2]<<16|this[ae+3]<<24},n.prototype.readInt32BE=function(ae,le){return ae=ae>>>0,le||G(ae,4,this.length),this[ae]<<24|this[ae+1]<<16|this[ae+2]<<8|this[ae+3]},n.prototype.readFloatLE=function(ae,le){return ae=ae>>>0,le||G(ae,4,this.length),M.read(this,ae,!0,23,4)},n.prototype.readFloatBE=function(ae,le){return ae=ae>>>0,le||G(ae,4,this.length),M.read(this,ae,!1,23,4)},n.prototype.readDoubleLE=function(ae,le){return ae=ae>>>0,le||G(ae,8,this.length),M.read(this,ae,!0,52,8)},n.prototype.readDoubleBE=function(ae,le){return ae=ae>>>0,le||G(ae,8,this.length),M.read(this,ae,!1,52,8)};function J(te,ae,le,ye,fe,pe){if(!n.isBuffer(te))throw new TypeError('"buffer" argument must be a Buffer instance');if(ae>fe||ae<pe)throw new RangeError('"value" argument is out of bounds');if(le+ye>te.length)throw new RangeError("Index out of range")}n.prototype.writeUIntLE=function(ae,le,ye,fe){if(ae=+ae,le=le>>>0,ye=ye>>>0,!fe){var pe=Math.pow(2,8*ye)-1;J(this,ae,le,ye,pe,0)}var ge=1,Ae=0;for(this[le]=ae&255;++Ae<ye&&(ge*=256);)this[le+Ae]=ae/ge&255;return le+ye},n.prototype.writeUIntBE=function(ae,le,ye,fe){if(ae=+ae,le=le>>>0,ye=ye>>>0,!fe){var pe=Math.pow(2,8*ye)-1;J(this,ae,le,ye,pe,0)}var ge=ye-1,Ae=1;for(this[le+ge]=ae&255;--ge>=0&&(Ae*=256);)this[le+ge]=ae/Ae&255;return le+ye},n.prototype.writeUInt8=function(ae,le,ye){return ae=+ae,le=le>>>0,ye||J(this,ae,le,1,255,0),this[le]=ae&255,le+1},n.prototype.writeUInt16LE=function(ae,le,ye){return ae=+ae,le=le>>>0,ye||J(this,ae,le,2,65535,0),this[le]=ae&255,this[le+1]=ae>>>8,le+2},n.prototype.writeUInt16BE=function(ae,le,ye){return ae=+ae,le=le>>>0,ye||J(this,ae,le,2,65535,0),this[le]=ae>>>8,this[le+1]=ae&255,le+2},n.prototype.writeUInt32LE=function(ae,le,ye){return ae=+ae,le=le>>>0,ye||J(this,ae,le,4,4294967295,0),this[le+3]=ae>>>24,this[le+2]=ae>>>16,this[le+1]=ae>>>8,this[le]=ae&255,le+4},n.prototype.writeUInt32BE=function(ae,le,ye){return ae=+ae,le=le>>>0,ye||J(this,ae,le,4,4294967295,0),this[le]=ae>>>24,this[le+1]=ae>>>16,this[le+2]=ae>>>8,this[le+3]=ae&255,le+4},n.prototype.writeIntLE=function(ae,le,ye,fe){if(ae=+ae,le=le>>>0,!fe){var pe=Math.pow(2,8*ye-1);J(this,ae,le,ye,pe-1,-pe)}var ge=0,Ae=1,we=0;for(this[le]=ae&255;++ge<ye&&(Ae*=256);)ae<0&&we===0&&this[le+ge-1]!==0&&(we=1),this[le+ge]=(ae/Ae>>0)-we&255;return le+ye},n.prototype.writeIntBE=function(ae,le,ye,fe){if(ae=+ae,le=le>>>0,!fe){var pe=Math.pow(2,8*ye-1);J(this,ae,le,ye,pe-1,-pe)}var ge=ye-1,Ae=1,we=0;for(this[le+ge]=ae&255;--ge>=0&&(Ae*=256);)ae<0&&we===0&&this[le+ge+1]!==0&&(we=1),this[le+ge]=(ae/Ae>>0)-we&255;return le+ye},n.prototype.writeInt8=function(ae,le,ye){return ae=+ae,le=le>>>0,ye||J(this,ae,le,1,127,-128),ae<0&&(ae=255+ae+1),this[le]=ae&255,le+1},n.prototype.writeInt16LE=function(ae,le,ye){return ae=+ae,le=le>>>0,ye||J(this,ae,le,2,32767,-32768),this[le]=ae&255,this[le+1]=ae>>>8,le+2},n.prototype.writeInt16BE=function(ae,le,ye){return ae=+ae,le=le>>>0,ye||J(this,ae,le,2,32767,-32768),this[le]=ae>>>8,this[le+1]=ae&255,le+2},n.prototype.writeInt32LE=function(ae,le,ye){return ae=+ae,le=le>>>0,ye||J(this,ae,le,4,2147483647,-2147483648),this[le]=ae&255,this[le+1]=ae>>>8,this[le+2]=ae>>>16,this[le+3]=ae>>>24,le+4},n.prototype.writeInt32BE=function(ae,le,ye){return ae=+ae,le=le>>>0,ye||J(this,ae,le,4,2147483647,-2147483648),ae<0&&(ae=4294967295+ae+1),this[le]=ae>>>24,this[le+1]=ae>>>16,this[le+2]=ae>>>8,this[le+3]=ae&255,le+4};function j(te,ae,le,ye,fe,pe){if(le+ye>te.length)throw new RangeError("Index out of range");if(le<0)throw new RangeError("Index out of range")}function Y(te,ae,le,ye,fe){return ae=+ae,le=le>>>0,fe||j(te,ae,le,4),M.write(te,ae,le,ye,23,4),le+4}n.prototype.writeFloatLE=function(ae,le,ye){return Y(this,ae,le,!0,ye)},n.prototype.writeFloatBE=function(ae,le,ye){return Y(this,ae,le,!1,ye)};function X(te,ae,le,ye,fe){return ae=+ae,le=le>>>0,fe||j(te,ae,le,8),M.write(te,ae,le,ye,52,8),le+8}n.prototype.writeDoubleLE=function(ae,le,ye){return X(this,ae,le,!0,ye)},n.prototype.writeDoubleBE=function(ae,le,ye){return X(this,ae,le,!1,ye)},n.prototype.copy=function(ae,le,ye,fe){if(!n.isBuffer(ae))throw new TypeError("argument should be a Buffer");if(ye||(ye=0),!fe&&fe!==0&&(fe=this.length),le>=ae.length&&(le=ae.length),le||(le=0),fe>0&&fe<ye&&(fe=ye),fe===ye||ae.length===0||this.length===0)return 0;if(le<0)throw new RangeError("targetStart out of bounds");if(ye<0||ye>=this.length)throw new RangeError("Index out of range");if(fe<0)throw new RangeError("sourceEnd out of bounds");fe>this.length&&(fe=this.length),ae.length-le<fe-ye&&(fe=ae.length-le+ye);var pe=fe-ye;if(this===ae&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(le,ye,fe);else if(this===ae&&ye<le&&le<fe)for(var ge=pe-1;ge>=0;--ge)ae[ge+le]=this[ge+ye];else Uint8Array.prototype.set.call(ae,this.subarray(ye,fe),le);return pe},n.prototype.fill=function(ae,le,ye,fe){if(typeof ae=="string"){if(typeof le=="string"?(fe=le,le=0,ye=this.length):typeof ye=="string"&&(fe=ye,ye=this.length),fe!==void 0&&typeof fe!="string")throw new TypeError("encoding must be a string");if(typeof fe=="string"&&!n.isEncoding(fe))throw new TypeError("Unknown encoding: "+fe);if(ae.length===1){var pe=ae.charCodeAt(0);(fe==="utf8"&&pe<128||fe==="latin1")&&(ae=pe)}}else typeof ae=="number"&&(ae=ae&255);if(le<0||this.length<le||this.length<ye)throw new RangeError("Out of range index");if(ye<=le)return this;le=le>>>0,ye=ye===void 0?this.length:ye>>>0,ae||(ae=0);var ge;if(typeof ae=="number")for(ge=le;ge<ye;++ge)this[ge]=ae;else{var Ae=n.isBuffer(ae)?ae:n.from(ae,fe),we=Ae.length;if(we===0)throw new TypeError('The value "'+ae+'" is invalid for argument "value"');for(ge=0;ge<ye-le;++ge)this[ge+le]=Ae[ge%we]}return this};var oe=/[^+/0-9A-Za-z-_]/g;function se(te){if(te=te.split("=")[0],te=te.trim().replace(oe,""),te.length<2)return"";for(;te.length%4!==0;)te=te+"=";return te}function ie(te){return te<16?"0"+te.toString(16):te.toString(16)}function N(te,ae){ae=ae||1/0;for(var le,ye=te.length,fe=null,pe=[],ge=0;ge<ye;++ge){if(le=te.charCodeAt(ge),le>55295&&le<57344){if(!fe){if(le>56319){(ae-=3)>-1&&pe.push(239,191,189);continue}else if(ge+1===ye){(ae-=3)>-1&&pe.push(239,191,189);continue}fe=le;continue}if(le<56320){(ae-=3)>-1&&pe.push(239,191,189),fe=le;continue}le=(fe-55296<<10|le-56320)+65536}else fe&&(ae-=3)>-1&&pe.push(239,191,189);if(fe=null,le<128){if((ae-=1)<0)break;pe.push(le)}else if(le<2048){if((ae-=2)<0)break;pe.push(le>>6|192,le&63|128)}else if(le<65536){if((ae-=3)<0)break;pe.push(le>>12|224,le>>6&63|128,le&63|128)}else if(le<1114112){if((ae-=4)<0)break;pe.push(le>>18|240,le>>12&63|128,le>>6&63|128,le&63|128)}else throw new Error("Invalid code point")}return pe}function U(te){for(var ae=[],le=0;le<te.length;++le)ae.push(te.charCodeAt(le)&255);return ae}function q(te,ae){for(var le,ye,fe,pe=[],ge=0;ge<te.length&&!((ae-=2)<0);++ge)le=te.charCodeAt(ge),ye=le>>8,fe=le%256,pe.push(fe),pe.push(ye);return pe}function Q(te){return c.toByteArray(se(te))}function W(te,ae,le,ye){for(var fe=0;fe<ye&&!(fe+le>=ae.length||fe>=te.length);++fe)ae[fe+le]=te[fe];return fe}function Z(te,ae){return te instanceof ae||te!=null&&te.constructor!=null&&te.constructor.name!=null&&te.constructor.name===ae.name}function ee(te){return te!==te}}).call(this)}).call(this,d("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(d,re,ne){re.exports=w;function w(c,M,T){return M<T?c<M?M:c>T?T:c:c<T?T:c>M?M:c}},{}],87:[function(d,re,ne){var w=d("clamp");re.exports=c,re.exports.to=c,re.exports.from=M;function c(T,e){e==null&&(e=!0);var a=T[0],n=T[1],r=T[2],t=T[3];t==null&&(t=e?1:255),e&&(a*=255,n*=255,r*=255,t*=255),a=w(a,0,255)&255,n=w(n,0,255)&255,r=w(r,0,255)&255,t=w(t,0,255)&255;var f=a*16777216+(n<<16)+(r<<8)+t;return f}function M(T,e){T=+T;var a=T>>>24,n=(T&16711680)>>>16,r=(T&65280)>>>8,t=T&255;return e===!1?[a,n,r,t]:[a/255,n/255,r/255,t/255]}},{clamp:86}],88:[function(d,re,ne){re.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(d,re,ne){var w=d("color-rgba"),c=d("clamp"),M=d("dtype");re.exports=function(a,n){(n==="float"||!n)&&(n="array"),n==="uint"&&(n="uint8"),n==="uint_clamped"&&(n="uint8_clamped");var r=M(n),t=new r(4),f=n!=="uint8"&&n!=="uint8_clamped";return(!a.length||typeof a=="string")&&(a=w(a),a[0]/=255,a[1]/=255,a[2]/=255),T(a)?(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3]!=null?a[3]:255,f&&(t[0]/=255,t[1]/=255,t[2]/=255,t[3]/=255),t):(f?(t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3]!=null?a[3]:1):(t[0]=c(Math.floor(a[0]*255),0,255),t[1]=c(Math.floor(a[1]*255),0,255),t[2]=c(Math.floor(a[2]*255),0,255),t[3]=a[3]==null?255:c(Math.floor(a[3]*255),0,255)),t)};function T(e){return!!(e instanceof Uint8Array||e instanceof Uint8ClampedArray||Array.isArray(e)&&(e[0]>1||e[0]===0)&&(e[1]>1||e[1]===0)&&(e[2]>1||e[2]===0)&&(!e[3]||e[3]>1))}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(d,re,ne){(function(w){(function(){var c=d("color-name"),M=d("is-plain-obj"),T=d("defined");re.exports=a;var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function a(n){var r,t=[],f=1,o;if(typeof n=="string")if(c[n])t=c[n].slice(),o="rgb";else if(n==="transparent")f=0,o="rgb",t=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(n)){var i=n.slice(1),g=i.length,p=g<=4;f=1,p?(t=[parseInt(i[0]+i[0],16),parseInt(i[1]+i[1],16),parseInt(i[2]+i[2],16)],g===4&&(f=parseInt(i[3]+i[3],16)/255)):(t=[parseInt(i[0]+i[1],16),parseInt(i[2]+i[3],16),parseInt(i[4]+i[5],16)],g===8&&(f=parseInt(i[6]+i[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),o="rgb"}else if(r=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(n)){var y=r[1],h=y==="rgb",i=y.replace(/a$/,"");o=i;var g=i==="cmyk"?4:i==="gray"?1:3;t=r[2].trim().split(/\s*,\s*/).map(function(s,A){if(/%$/.test(s))return A===g?parseFloat(s)/100:i==="rgb"?parseFloat(s)*255/100:parseFloat(s);if(i[A]==="h"){if(/deg$/.test(s))return parseFloat(s);if(e[s]!==void 0)return e[s]}return parseFloat(s)}),y===i&&t.push(1),f=h||t[g]===void 0?1:t[g],t=t.slice(0,g)}else n.length>10&&/[0-9](?:\s|\/)/.test(n)&&(t=n.match(/([0-9]+)/g).map(function(u){return parseFloat(u)}),o=n.match(/([a-z])/ig).join("").toLowerCase());else if(!isNaN(n))o="rgb",t=[n>>>16,(n&65280)>>>8,n&255];else if(M(n)){var m=T(n.r,n.red,n.R,null);m!==null?(o="rgb",t=[m,T(n.g,n.green,n.G),T(n.b,n.blue,n.B)]):(o="hsl",t=[T(n.h,n.hue,n.H),T(n.s,n.saturation,n.S),T(n.l,n.lightness,n.L,n.b,n.brightness)]),f=T(n.a,n.alpha,n.opacity,1),n.opacity!=null&&(f/=100)}else(Array.isArray(n)||w.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(n))&&(t=[n[0],n[1],n[2]],o="rgb",f=n.length===4?n[3]:1);return{space:o,values:t,alpha:f}}}).call(this)}).call(this,typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(d,re,ne){var w=d("color-parse"),c=d("color-space/hsl"),M=d("clamp");re.exports=function(e){var a,n=w(e);return n.space?(a=Array(3),a[0]=M(n.values[0],0,255),a[1]=M(n.values[1],0,255),a[2]=M(n.values[2],0,255),n.space[0]==="h"&&(a=c.rgb(a)),a.push(M(n.alpha,0,1)),a):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(d,re,ne){var w=d("./rgb");re.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(c){var M=c[0]/360,T=c[1]/100,e=c[2]/100,a,n,r,t,f;if(T===0)return f=e*255,[f,f,f];e<.5?n=e*(1+T):n=e+T-e*T,a=2*e-n,t=[0,0,0];for(var o=0;o<3;o++)r=M+1/3*-(o-1),r<0?r++:r>1&&r--,6*r<1?f=a+(n-a)*6*r:2*r<1?f=n:3*r<2?f=a+(n-a)*(2/3-r)*6:f=a,t[o]=f*255;return t}},w.hsl=function(c){var M=c[0]/255,T=c[1]/255,e=c[2]/255,a=Math.min(M,T,e),n=Math.max(M,T,e),r=n-a,t,f,o;return n===a?t=0:M===n?t=(T-e)/r:T===n?t=2+(e-M)/r:e===n&&(t=4+(M-T)/r),t=Math.min(t*60,360),t<0&&(t+=360),o=(a+n)/2,n===a?f=0:o<=.5?f=r/(n+a):f=r/(2-n-a),[t,f*100,o*100]}},{"./rgb":93}],93:[function(d,re,ne){re.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(d,re,ne){re.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(d,re,ne){re.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(d,re,ne){re.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(d,re,ne){re.exports=["normal","italic","oblique"]},{}],98:[function(d,re,ne){re.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(d,re,ne){re.exports={parse:d("./parse"),stringify:d("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(d,re,ne){var w=d("css-font-size-keywords");re.exports={isSize:function(M){return/^[\d\.]/.test(M)||M.indexOf("/")!==-1||w.indexOf(M)!==-1}}},{"css-font-size-keywords":95}],101:[function(d,re,ne){var w=d("unquote"),c=d("css-global-keywords"),M=d("css-system-font-keywords"),T=d("css-font-weight-keywords"),e=d("css-font-style-keywords"),a=d("css-font-stretch-keywords"),n=d("string-split-by"),r=d("./lib/util").isSize;re.exports=f;var t=f.cache={};function f(i){if(typeof i!="string")throw new Error("Font argument must be a string.");if(t[i])return t[i];if(i==="")throw new Error("Cannot parse an empty string.");if(M.indexOf(i)!==-1)return t[i]={system:i};for(var g={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},p=n(i,/\s+/),y;y=p.shift();){if(c.indexOf(y)!==-1)return["style","variant","weight","stretch"].forEach(function(m){g[m]=y}),t[i]=g;if(e.indexOf(y)!==-1){g.style=y;continue}if(y==="normal"||y==="small-caps"){g.variant=y;continue}if(a.indexOf(y)!==-1){g.stretch=y;continue}if(T.indexOf(y)!==-1){g.weight=y;continue}if(r(y)){var h=n(y,"/");if(g.size=h[0],h[1]!=null?g.lineHeight=o(h[1]):p[0]==="/"&&(p.shift(),g.lineHeight=o(p.shift())),!p.length)throw new Error("Missing required font-family.");return g.family=n(p.join(" "),/\s*,\s*/).map(w),t[i]=g}throw new Error("Unknown or unsupported font token: "+y)}throw new Error("Missing required font-size.")}function o(i){var g=parseFloat(i);return g.toString()===i?g:i}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":305,unquote:328}],102:[function(d,re,ne){var w=d("pick-by-alias"),c=d("./lib/util").isSize,M=i(d("css-global-keywords")),T=i(d("css-system-font-keywords")),e=i(d("css-font-weight-keywords")),a=i(d("css-font-style-keywords")),n=i(d("css-font-stretch-keywords")),r={normal:1,"small-caps":1},t={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},f={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};re.exports=function(p){if(p=w(p,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"}),p.system)return p.system&&o(p.system,T),p.system;if(o(p.style,a),o(p.variant,r),o(p.weight,e),o(p.stretch,n),p.size==null&&(p.size=f.size),typeof p.size=="number"&&(p.size+="px"),!c)throw Error("Bad size value `"+p.size+"`");p.family||(p.family=f.family),Array.isArray(p.family)&&(p.family.length||(p.family=[f.family]),p.family=p.family.map(function(h){return t[h]?h:'"'+h+'"'}).join(", "));var y=[];return y.push(p.style),p.variant!==p.style&&y.push(p.variant),p.weight!==p.variant&&p.weight!==p.style&&y.push(p.weight),p.stretch!==p.weight&&p.stretch!==p.variant&&p.stretch!==p.style&&y.push(p.stretch),y.push(p.size+(p.lineHeight==null||p.lineHeight==="normal"||p.lineHeight+""=="1"?"":"/"+p.lineHeight)),y.push(p.family),y.filter(Boolean).join(" ")};function o(g,p){if(g&&!p[g]&&!M[g])throw Error("Unknown keyword `"+g+"`");return g}function i(g){for(var p={},y=0;y<g.length;y++)p[g[y]]=1;return p}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(d,re,ne){re.exports=["inherit","initial","unset"]},{}],104:[function(d,re,ne){re.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(d,re,ne){var w=d("type/value/is"),c=d("type/value/ensure"),M=d("type/plain-function/ensure"),T=d("es5-ext/object/copy"),e=d("es5-ext/object/normalize-options"),a=d("es5-ext/object/map"),n=Function.prototype.bind,r=Object.defineProperty,t=Object.prototype.hasOwnProperty,f;f=function(o,i,g){var p=c(i)&&M(i.value),y;return y=T(i),delete y.writable,delete y.value,y.get=function(){return!g.overwriteDefinition&&t.call(this,o)?p:(i.value=n.call(p,g.resolveContext?g.resolveContext(this):this),r(this,o,i),this[o])},y},re.exports=function(o){var i=e(arguments[1]);return w(i.resolveContext)&&M(i.resolveContext),a(o,function(g,p){return f(p,g,i)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":321,"type/value/ensure":325,"type/value/is":326}],106:[function(d,re,ne){var w=d("type/value/is"),c=d("type/plain-function/is"),M=d("es5-ext/object/assign"),T=d("es5-ext/object/normalize-options"),e=d("es5-ext/string/#/contains"),a=re.exports=function(n,r){var t,f,o,i,g;return arguments.length<2||typeof n!="string"?(i=r,r=n,n=null):i=arguments[2],w(n)?(t=e.call(n,"c"),f=e.call(n,"e"),o=e.call(n,"w")):(t=o=!0,f=!1),g={value:r,configurable:t,enumerable:f,writable:o},i?M(T(i),g):g};a.gs=function(n,r,t){var f,o,i,g;return typeof n!="string"?(i=t,t=r,r=n,n=null):i=arguments[3],w(r)?c(r)?w(t)?c(t)||(i=t,t=void 0):t=void 0:(i=r,r=t=void 0):r=void 0,w(n)?(f=e.call(n,"c"),o=e.call(n,"e")):(f=!0,o=!1),g={get:r,set:t,configurable:f,enumerable:o},i?M(T(i),g):g}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":322,"type/value/is":326}],107:[function(d,re,ne){(function(w,c){c(typeof ne=="object"&&typeof re!="undefined"?ne:w.d3=w.d3||{})})(this,function(w){function c(N,U){return N<U?-1:N>U?1:N>=U?0:NaN}function M(N){return N.length===1&&(N=T(N)),{left:function(U,q,Q,W){for(Q==null&&(Q=0),W==null&&(W=U.length);Q<W;){var Z=Q+W>>>1;N(U[Z],q)<0?Q=Z+1:W=Z}return Q},right:function(U,q,Q,W){for(Q==null&&(Q=0),W==null&&(W=U.length);Q<W;){var Z=Q+W>>>1;N(U[Z],q)>0?W=Z:Q=Z+1}return Q}}}function T(N){return function(U,q){return c(N(U),q)}}var e=M(c),a=e.right,n=e.left;function r(N,U){U==null&&(U=t);for(var q=0,Q=N.length-1,W=N[0],Z=new Array(Q<0?0:Q);q<Q;)Z[q]=U(W,W=N[++q]);return Z}function t(N,U){return[N,U]}function f(N,U,q){var Q=N.length,W=U.length,Z=new Array(Q*W),ee,te,ae,le;for(q==null&&(q=t),ee=ae=0;ee<Q;++ee)for(le=N[ee],te=0;te<W;++te,++ae)Z[ae]=q(le,U[te]);return Z}function o(N,U){return U<N?-1:U>N?1:U>=N?0:NaN}function i(N){return N===null?NaN:+N}function g(N,U){var q=N.length,Q=0,W=-1,Z=0,ee,te,ae=0;if(U==null)for(;++W<q;)isNaN(ee=i(N[W]))||(te=ee-Z,Z+=te/++Q,ae+=te*(ee-Z));else for(;++W<q;)isNaN(ee=i(U(N[W],W,N)))||(te=ee-Z,Z+=te/++Q,ae+=te*(ee-Z));if(Q>1)return ae/(Q-1)}function p(N,U){var q=g(N,U);return q&&Math.sqrt(q)}function y(N,U){var q=N.length,Q=-1,W,Z,ee;if(U==null){for(;++Q<q;)if((W=N[Q])!=null&&W>=W)for(Z=ee=W;++Q<q;)(W=N[Q])!=null&&(Z>W&&(Z=W),ee<W&&(ee=W))}else for(;++Q<q;)if((W=U(N[Q],Q,N))!=null&&W>=W)for(Z=ee=W;++Q<q;)(W=U(N[Q],Q,N))!=null&&(Z>W&&(Z=W),ee<W&&(ee=W));return[Z,ee]}var h=Array.prototype,m=h.slice,u=h.map;function _(N){return function(){return N}}function s(N){return N}function A(N,U,q){N=+N,U=+U,q=(W=arguments.length)<2?(U=N,N=0,1):W<3?1:+q;for(var Q=-1,W=Math.max(0,Math.ceil((U-N)/q))|0,Z=new Array(W);++Q<W;)Z[Q]=N+Q*q;return Z}var x=Math.sqrt(50),v=Math.sqrt(10),b=Math.sqrt(2);function l(N,U,q){var Q,W=-1,Z,ee,te;if(U=+U,N=+N,q=+q,N===U&&q>0)return[N];if((Q=U<N)&&(Z=N,N=U,U=Z),(te=L(N,U,q))===0||!isFinite(te))return[];if(te>0)for(N=Math.ceil(N/te),U=Math.floor(U/te),ee=new Array(Z=Math.ceil(U-N+1));++W<Z;)ee[W]=(N+W)*te;else for(N=Math.floor(N*te),U=Math.ceil(U*te),ee=new Array(Z=Math.ceil(N-U+1));++W<Z;)ee[W]=(N-W)/te;return Q&&ee.reverse(),ee}function L(N,U,q){var Q=(U-N)/Math.max(0,q),W=Math.floor(Math.log(Q)/Math.LN10),Z=Q/Math.pow(10,W);return W>=0?(Z>=x?10:Z>=v?5:Z>=b?2:1)*Math.pow(10,W):-Math.pow(10,-W)/(Z>=x?10:Z>=v?5:Z>=b?2:1)}function S(N,U,q){var Q=Math.abs(U-N)/Math.max(0,q),W=Math.pow(10,Math.floor(Math.log(Q)/Math.LN10)),Z=Q/W;return Z>=x?W*=10:Z>=v?W*=5:Z>=b&&(W*=2),U<N?-W:W}function k(N){return Math.ceil(Math.log(N.length)/Math.LN2)+1}function P(){var N=s,U=y,q=k;function Q(W){var Z,ee=W.length,te,ae=new Array(ee);for(Z=0;Z<ee;++Z)ae[Z]=N(W[Z],Z,W);var le=U(ae),ye=le[0],fe=le[1],pe=q(ae,ye,fe);Array.isArray(pe)||(pe=S(ye,fe,pe),pe=A(Math.ceil(ye/pe)*pe,fe,pe));for(var ge=pe.length;pe[0]<=ye;)pe.shift(),--ge;for(;pe[ge-1]>fe;)pe.pop(),--ge;var Ae=new Array(ge+1),we;for(Z=0;Z<=ge;++Z)we=Ae[Z]=[],we.x0=Z>0?pe[Z-1]:ye,we.x1=Z<ge?pe[Z]:fe;for(Z=0;Z<ee;++Z)te=ae[Z],ye<=te&&te<=fe&&Ae[a(pe,te,0,ge)].push(W[Z]);return Ae}return Q.value=function(W){return arguments.length?(N=typeof W=="function"?W:_(W),Q):N},Q.domain=function(W){return arguments.length?(U=typeof W=="function"?W:_([W[0],W[1]]),Q):U},Q.thresholds=function(W){return arguments.length?(q=typeof W=="function"?W:Array.isArray(W)?_(m.call(W)):_(W),Q):q},Q}function z(N,U,q){if(q==null&&(q=i),!!(Q=N.length)){if((U=+U)<=0||Q<2)return+q(N[0],0,N);if(U>=1)return+q(N[Q-1],Q-1,N);var Q,W=(Q-1)*U,Z=Math.floor(W),ee=+q(N[Z],Z,N),te=+q(N[Z+1],Z+1,N);return ee+(te-ee)*(W-Z)}}function I(N,U,q){return N=u.call(N,i).sort(c),Math.ceil((q-U)/(2*(z(N,.75)-z(N,.25))*Math.pow(N.length,-1/3)))}function D(N,U,q){return Math.ceil((q-U)/(3.5*p(N)*Math.pow(N.length,-1/3)))}function R(N,U){var q=N.length,Q=-1,W,Z;if(U==null){for(;++Q<q;)if((W=N[Q])!=null&&W>=W)for(Z=W;++Q<q;)(W=N[Q])!=null&&W>Z&&(Z=W)}else for(;++Q<q;)if((W=U(N[Q],Q,N))!=null&&W>=W)for(Z=W;++Q<q;)(W=U(N[Q],Q,N))!=null&&W>Z&&(Z=W);return Z}function B(N,U){var q=N.length,Q=q,W=-1,Z,ee=0;if(U==null)for(;++W<q;)isNaN(Z=i(N[W]))?--Q:ee+=Z;else for(;++W<q;)isNaN(Z=i(U(N[W],W,N)))?--Q:ee+=Z;if(Q)return ee/Q}function F(N,U){var q=N.length,Q=-1,W,Z=[];if(U==null)for(;++Q<q;)isNaN(W=i(N[Q]))||Z.push(W);else for(;++Q<q;)isNaN(W=i(U(N[Q],Q,N)))||Z.push(W);return z(Z.sort(c),.5)}function V(N){for(var U=N.length,q,Q=-1,W=0,Z,ee;++Q<U;)W+=N[Q].length;for(Z=new Array(W);--U>=0;)for(ee=N[U],q=ee.length;--q>=0;)Z[--W]=ee[q];return Z}function G(N,U){var q=N.length,Q=-1,W,Z;if(U==null){for(;++Q<q;)if((W=N[Q])!=null&&W>=W)for(Z=W;++Q<q;)(W=N[Q])!=null&&Z>W&&(Z=W)}else for(;++Q<q;)if((W=U(N[Q],Q,N))!=null&&W>=W)for(Z=W;++Q<q;)(W=U(N[Q],Q,N))!=null&&Z>W&&(Z=W);return Z}function J(N,U){for(var q=U.length,Q=new Array(q);q--;)Q[q]=N[U[q]];return Q}function j(N,U){if(!!(q=N.length)){var q,Q=0,W=0,Z,ee=N[W];for(U==null&&(U=c);++Q<q;)(U(Z=N[Q],ee)<0||U(ee,ee)!==0)&&(ee=Z,W=Q);if(U(ee,ee)===0)return W}}function Y(N,U,q){for(var Q=(q==null?N.length:q)-(U=U==null?0:+U),W,Z;Q;)Z=Math.random()*Q--|0,W=N[Q+U],N[Q+U]=N[Z+U],N[Z+U]=W;return N}function X(N,U){var q=N.length,Q=-1,W,Z=0;if(U==null)for(;++Q<q;)(W=+N[Q])&&(Z+=W);else for(;++Q<q;)(W=+U(N[Q],Q,N))&&(Z+=W);return Z}function oe(N){if(!(Z=N.length))return[];for(var U=-1,q=G(N,se),Q=new Array(q);++U<q;)for(var W=-1,Z,ee=Q[U]=new Array(Z);++W<Z;)ee[W]=N[W][U];return Q}function se(N){return N.length}function ie(){return oe(arguments)}w.bisect=a,w.bisectRight=a,w.bisectLeft=n,w.ascending=c,w.bisector=M,w.cross=f,w.descending=o,w.deviation=p,w.extent=y,w.histogram=P,w.thresholdFreedmanDiaconis=I,w.thresholdScott=D,w.thresholdSturges=k,w.max=R,w.mean=B,w.median=F,w.merge=V,w.min=G,w.pairs=r,w.permute=J,w.quantile=z,w.range=A,w.scan=j,w.shuffle=Y,w.sum=X,w.ticks=l,w.tickIncrement=L,w.tickStep=S,w.transpose=oe,w.variance=g,w.zip=ie,Object.defineProperty(w,"__esModule",{value:!0})})},{}],108:[function(d,re,ne){(function(w,c){c(typeof ne=="object"&&typeof re!="undefined"?ne:w.d3=w.d3||{})})(this,function(w){var c="$";function M(){}M.prototype=T.prototype={constructor:M,has:function(h){return c+h in this},get:function(h){return this[c+h]},set:function(h,m){return this[c+h]=m,this},remove:function(h){var m=c+h;return m in this&&delete this[m]},clear:function(){for(var h in this)h[0]===c&&delete this[h]},keys:function(){var h=[];for(var m in this)m[0]===c&&h.push(m.slice(1));return h},values:function(){var h=[];for(var m in this)m[0]===c&&h.push(this[m]);return h},entries:function(){var h=[];for(var m in this)m[0]===c&&h.push({key:m.slice(1),value:this[m]});return h},size:function(){var h=0;for(var m in this)m[0]===c&&++h;return h},empty:function(){for(var h in this)if(h[0]===c)return!1;return!0},each:function(h){for(var m in this)m[0]===c&&h(this[m],m.slice(1),this)}};function T(h,m){var u=new M;if(h instanceof M)h.each(function(v,b){u.set(b,v)});else if(Array.isArray(h)){var _=-1,s=h.length,A;if(m==null)for(;++_<s;)u.set(_,h[_]);else for(;++_<s;)u.set(m(A=h[_],_,h),A)}else if(h)for(var x in h)u.set(x,h[x]);return u}function e(){var h=[],m=[],u,_,s;function A(v,b,l,L){if(b>=h.length)return u!=null&&v.sort(u),_!=null?_(v):v;for(var S=-1,k=v.length,P=h[b++],z,I,D=T(),R,B=l();++S<k;)(R=D.get(z=P(I=v[S])+""))?R.push(I):D.set(z,[I]);return D.each(function(F,V){L(B,V,A(F,b,l,L))}),B}function x(v,b){if(++b>h.length)return v;var l,L=m[b-1];return _!=null&&b>=h.length?l=v.entries():(l=[],v.each(function(S,k){l.push({key:k,values:x(S,b)})})),L!=null?l.sort(function(S,k){return L(S.key,k.key)}):l}return s={object:function(v){return A(v,0,a,n)},map:function(v){return A(v,0,r,t)},entries:function(v){return x(A(v,0,r,t),0)},key:function(v){return h.push(v),s},sortKeys:function(v){return m[h.length-1]=v,s},sortValues:function(v){return u=v,s},rollup:function(v){return _=v,s}}}function a(){return{}}function n(h,m,u){h[m]=u}function r(){return T()}function t(h,m,u){h.set(m,u)}function f(){}var o=T.prototype;f.prototype=i.prototype={constructor:f,has:o.has,add:function(h){return h+="",this[c+h]=h,this},remove:o.remove,clear:o.clear,values:o.keys,size:o.size,empty:o.empty,each:o.each};function i(h,m){var u=new f;if(h instanceof f)h.each(function(A){u.add(A)});else if(h){var _=-1,s=h.length;if(m==null)for(;++_<s;)u.add(h[_]);else for(;++_<s;)u.add(m(h[_],_,h))}return u}function g(h){var m=[];for(var u in h)m.push(u);return m}function p(h){var m=[];for(var u in h)m.push(h[u]);return m}function y(h){var m=[];for(var u in h)m.push({key:u,value:h[u]});return m}w.nest=e,w.set=i,w.map=T,w.keys=g,w.values=p,w.entries=y,Object.defineProperty(w,"__esModule",{value:!0})})},{}],109:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne):(w=w||self,c(w.d3=w.d3||{}))})(this,function(w){function c(Pe,Ue,vt){Pe.prototype=Ue.prototype=vt,vt.constructor=Pe}function M(Pe,Ue){var vt=Object.create(Pe.prototype);for(var Lt in Ue)vt[Lt]=Ue[Lt];return vt}function T(){}var e=.7,a=1/e,n="\\s*([+-]?\\d+)\\s*",r="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",f=/^#([0-9a-f]{3,8})$/,o=new RegExp("^rgb\\("+[n,n,n]+"\\)$"),i=new RegExp("^rgb\\("+[t,t,t]+"\\)$"),g=new RegExp("^rgba\\("+[n,n,n,r]+"\\)$"),p=new RegExp("^rgba\\("+[t,t,t,r]+"\\)$"),y=new RegExp("^hsl\\("+[r,t,t]+"\\)$"),h=new RegExp("^hsla\\("+[r,t,t,r]+"\\)$"),m={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};c(T,A,{copy:function(Pe){return Object.assign(new this.constructor,this,Pe)},displayable:function(){return this.rgb().displayable()},hex:u,formatHex:u,formatHsl:_,formatRgb:s,toString:s});function u(){return this.rgb().formatHex()}function _(){return I(this).formatHsl()}function s(){return this.rgb().formatRgb()}function A(Pe){var Ue,vt;return Pe=(Pe+"").trim().toLowerCase(),(Ue=f.exec(Pe))?(vt=Ue[1].length,Ue=parseInt(Ue[1],16),vt===6?x(Ue):vt===3?new L(Ue>>8&15|Ue>>4&240,Ue>>4&15|Ue&240,(Ue&15)<<4|Ue&15,1):vt===8?v(Ue>>24&255,Ue>>16&255,Ue>>8&255,(Ue&255)/255):vt===4?v(Ue>>12&15|Ue>>8&240,Ue>>8&15|Ue>>4&240,Ue>>4&15|Ue&240,((Ue&15)<<4|Ue&15)/255):null):(Ue=o.exec(Pe))?new L(Ue[1],Ue[2],Ue[3],1):(Ue=i.exec(Pe))?new L(Ue[1]*255/100,Ue[2]*255/100,Ue[3]*255/100,1):(Ue=g.exec(Pe))?v(Ue[1],Ue[2],Ue[3],Ue[4]):(Ue=p.exec(Pe))?v(Ue[1]*255/100,Ue[2]*255/100,Ue[3]*255/100,Ue[4]):(Ue=y.exec(Pe))?z(Ue[1],Ue[2]/100,Ue[3]/100,1):(Ue=h.exec(Pe))?z(Ue[1],Ue[2]/100,Ue[3]/100,Ue[4]):m.hasOwnProperty(Pe)?x(m[Pe]):Pe==="transparent"?new L(NaN,NaN,NaN,0):null}function x(Pe){return new L(Pe>>16&255,Pe>>8&255,Pe&255,1)}function v(Pe,Ue,vt,Lt){return Lt<=0&&(Pe=Ue=vt=NaN),new L(Pe,Ue,vt,Lt)}function b(Pe){return Pe instanceof T||(Pe=A(Pe)),Pe?(Pe=Pe.rgb(),new L(Pe.r,Pe.g,Pe.b,Pe.opacity)):new L}function l(Pe,Ue,vt,Lt){return arguments.length===1?b(Pe):new L(Pe,Ue,vt,Lt==null?1:Lt)}function L(Pe,Ue,vt,Lt){this.r=+Pe,this.g=+Ue,this.b=+vt,this.opacity=+Lt}c(L,l,M(T,{brighter:function(Pe){return Pe=Pe==null?a:Math.pow(a,Pe),new L(this.r*Pe,this.g*Pe,this.b*Pe,this.opacity)},darker:function(Pe){return Pe=Pe==null?e:Math.pow(e,Pe),new L(this.r*Pe,this.g*Pe,this.b*Pe,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:S,formatHex:S,formatRgb:k,toString:k}));function S(){return"#"+P(this.r)+P(this.g)+P(this.b)}function k(){var Pe=this.opacity;return Pe=isNaN(Pe)?1:Math.max(0,Math.min(1,Pe)),(Pe===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(Pe===1?")":", "+Pe+")")}function P(Pe){return Pe=Math.max(0,Math.min(255,Math.round(Pe)||0)),(Pe<16?"0":"")+Pe.toString(16)}function z(Pe,Ue,vt,Lt){return Lt<=0?Pe=Ue=vt=NaN:vt<=0||vt>=1?Pe=Ue=NaN:Ue<=0&&(Pe=NaN),new R(Pe,Ue,vt,Lt)}function I(Pe){if(Pe instanceof R)return new R(Pe.h,Pe.s,Pe.l,Pe.opacity);if(Pe instanceof T||(Pe=A(Pe)),!Pe)return new R;if(Pe instanceof R)return Pe;Pe=Pe.rgb();var Ue=Pe.r/255,vt=Pe.g/255,Lt=Pe.b/255,Yt=Math.min(Ue,vt,Lt),At=Math.max(Ue,vt,Lt),Rt=NaN,Bt=At-Yt,Mt=(At+Yt)/2;return Bt?(Ue===At?Rt=(vt-Lt)/Bt+(vt<Lt)*6:vt===At?Rt=(Lt-Ue)/Bt+2:Rt=(Ue-vt)/Bt+4,Bt/=Mt<.5?At+Yt:2-At-Yt,Rt*=60):Bt=Mt>0&&Mt<1?0:Rt,new R(Rt,Bt,Mt,Pe.opacity)}function D(Pe,Ue,vt,Lt){return arguments.length===1?I(Pe):new R(Pe,Ue,vt,Lt==null?1:Lt)}function R(Pe,Ue,vt,Lt){this.h=+Pe,this.s=+Ue,this.l=+vt,this.opacity=+Lt}c(R,D,M(T,{brighter:function(Pe){return Pe=Pe==null?a:Math.pow(a,Pe),new R(this.h,this.s,this.l*Pe,this.opacity)},darker:function(Pe){return Pe=Pe==null?e:Math.pow(e,Pe),new R(this.h,this.s,this.l*Pe,this.opacity)},rgb:function(){var Pe=this.h%360+(this.h<0)*360,Ue=isNaN(Pe)||isNaN(this.s)?0:this.s,vt=this.l,Lt=vt+(vt<.5?vt:1-vt)*Ue,Yt=2*vt-Lt;return new L(B(Pe>=240?Pe-240:Pe+120,Yt,Lt),B(Pe,Yt,Lt),B(Pe<120?Pe+240:Pe-120,Yt,Lt),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var Pe=this.opacity;return Pe=isNaN(Pe)?1:Math.max(0,Math.min(1,Pe)),(Pe===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(Pe===1?")":", "+Pe+")")}}));function B(Pe,Ue,vt){return(Pe<60?Ue+(vt-Ue)*Pe/60:Pe<180?vt:Pe<240?Ue+(vt-Ue)*(240-Pe)/60:Ue)*255}var F=Math.PI/180,V=180/Math.PI,G=18,J=.96422,j=1,Y=.82521,X=4/29,oe=6/29,se=3*oe*oe,ie=oe*oe*oe;function N(Pe){if(Pe instanceof Q)return new Q(Pe.l,Pe.a,Pe.b,Pe.opacity);if(Pe instanceof fe)return pe(Pe);Pe instanceof L||(Pe=b(Pe));var Ue=te(Pe.r),vt=te(Pe.g),Lt=te(Pe.b),Yt=W((.2225045*Ue+.7168786*vt+.0606169*Lt)/j),At,Rt;return Ue===vt&&vt===Lt?At=Rt=Yt:(At=W((.4360747*Ue+.3850649*vt+.1430804*Lt)/J),Rt=W((.0139322*Ue+.0971045*vt+.7141733*Lt)/Y)),new Q(116*Yt-16,500*(At-Yt),200*(Yt-Rt),Pe.opacity)}function U(Pe,Ue){return new Q(Pe,0,0,Ue==null?1:Ue)}function q(Pe,Ue,vt,Lt){return arguments.length===1?N(Pe):new Q(Pe,Ue,vt,Lt==null?1:Lt)}function Q(Pe,Ue,vt,Lt){this.l=+Pe,this.a=+Ue,this.b=+vt,this.opacity=+Lt}c(Q,q,M(T,{brighter:function(Pe){return new Q(this.l+G*(Pe==null?1:Pe),this.a,this.b,this.opacity)},darker:function(Pe){return new Q(this.l-G*(Pe==null?1:Pe),this.a,this.b,this.opacity)},rgb:function(){var Pe=(this.l+16)/116,Ue=isNaN(this.a)?Pe:Pe+this.a/500,vt=isNaN(this.b)?Pe:Pe-this.b/200;return Ue=J*Z(Ue),Pe=j*Z(Pe),vt=Y*Z(vt),new L(ee(3.1338561*Ue-1.6168667*Pe-.4906146*vt),ee(-.9787684*Ue+1.9161415*Pe+.033454*vt),ee(.0719453*Ue-.2289914*Pe+1.4052427*vt),this.opacity)}}));function W(Pe){return Pe>ie?Math.pow(Pe,1/3):Pe/se+X}function Z(Pe){return Pe>oe?Pe*Pe*Pe:se*(Pe-X)}function ee(Pe){return 255*(Pe<=.0031308?12.92*Pe:1.055*Math.pow(Pe,1/2.4)-.055)}function te(Pe){return(Pe/=255)<=.04045?Pe/12.92:Math.pow((Pe+.055)/1.055,2.4)}function ae(Pe){if(Pe instanceof fe)return new fe(Pe.h,Pe.c,Pe.l,Pe.opacity);if(Pe instanceof Q||(Pe=N(Pe)),Pe.a===0&&Pe.b===0)return new fe(NaN,0<Pe.l&&Pe.l<100?0:NaN,Pe.l,Pe.opacity);var Ue=Math.atan2(Pe.b,Pe.a)*V;return new fe(Ue<0?Ue+360:Ue,Math.sqrt(Pe.a*Pe.a+Pe.b*Pe.b),Pe.l,Pe.opacity)}function le(Pe,Ue,vt,Lt){return arguments.length===1?ae(Pe):new fe(vt,Ue,Pe,Lt==null?1:Lt)}function ye(Pe,Ue,vt,Lt){return arguments.length===1?ae(Pe):new fe(Pe,Ue,vt,Lt==null?1:Lt)}function fe(Pe,Ue,vt,Lt){this.h=+Pe,this.c=+Ue,this.l=+vt,this.opacity=+Lt}function pe(Pe){if(isNaN(Pe.h))return new Q(Pe.l,0,0,Pe.opacity);var Ue=Pe.h*F;return new Q(Pe.l,Math.cos(Ue)*Pe.c,Math.sin(Ue)*Pe.c,Pe.opacity)}c(fe,ye,M(T,{brighter:function(Pe){return new fe(this.h,this.c,this.l+G*(Pe==null?1:Pe),this.opacity)},darker:function(Pe){return new fe(this.h,this.c,this.l-G*(Pe==null?1:Pe),this.opacity)},rgb:function(){return pe(this).rgb()}}));var ge=-.14861,Ae=1.78277,we=-.29227,De=-.90649,Be=1.97294,Ve=Be*De,xe=Be*Ae,Le=Ae*we-De*ge;function He(Pe){if(Pe instanceof Oe)return new Oe(Pe.h,Pe.s,Pe.l,Pe.opacity);Pe instanceof L||(Pe=b(Pe));var Ue=Pe.r/255,vt=Pe.g/255,Lt=Pe.b/255,Yt=(Le*Lt+Ve*Ue-xe*vt)/(Le+Ve-xe),At=Lt-Yt,Rt=(Be*(vt-Yt)-we*At)/De,Bt=Math.sqrt(Rt*Rt+At*At)/(Be*Yt*(1-Yt)),Mt=Bt?Math.atan2(Rt,At)*V-120:NaN;return new Oe(Mt<0?Mt+360:Mt,Bt,Yt,Pe.opacity)}function Je(Pe,Ue,vt,Lt){return arguments.length===1?He(Pe):new Oe(Pe,Ue,vt,Lt==null?1:Lt)}function Oe(Pe,Ue,vt,Lt){this.h=+Pe,this.s=+Ue,this.l=+vt,this.opacity=+Lt}c(Oe,Je,M(T,{brighter:function(Pe){return Pe=Pe==null?a:Math.pow(a,Pe),new Oe(this.h,this.s,this.l*Pe,this.opacity)},darker:function(Pe){return Pe=Pe==null?e:Math.pow(e,Pe),new Oe(this.h,this.s,this.l*Pe,this.opacity)},rgb:function(){var Pe=isNaN(this.h)?0:(this.h+120)*F,Ue=+this.l,vt=isNaN(this.s)?0:this.s*Ue*(1-Ue),Lt=Math.cos(Pe),Yt=Math.sin(Pe);return new L(255*(Ue+vt*(ge*Lt+Ae*Yt)),255*(Ue+vt*(we*Lt+De*Yt)),255*(Ue+vt*(Be*Lt)),this.opacity)}})),w.color=A,w.cubehelix=Je,w.gray=U,w.hcl=ye,w.hsl=D,w.lab=q,w.lch=le,w.rgb=l,Object.defineProperty(w,"__esModule",{value:!0})})},{}],110:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne):(w=w||self,c(w.d3=w.d3||{}))})(this,function(w){var c={value:function(){}};function M(){for(var r=0,t=arguments.length,f={},o;r<t;++r){if(!(o=arguments[r]+"")||o in f||/[\s.]/.test(o))throw new Error("illegal type: "+o);f[o]=[]}return new T(f)}function T(r){this._=r}function e(r,t){return r.trim().split(/^|\s+/).map(function(f){var o="",i=f.indexOf(".");if(i>=0&&(o=f.slice(i+1),f=f.slice(0,i)),f&&!t.hasOwnProperty(f))throw new Error("unknown type: "+f);return{type:f,name:o}})}T.prototype=M.prototype={constructor:T,on:function(r,t){var f=this._,o=e(r+"",f),i,g=-1,p=o.length;if(arguments.length<2){for(;++g<p;)if((i=(r=o[g]).type)&&(i=a(f[i],r.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++g<p;)if(i=(r=o[g]).type)f[i]=n(f[i],r.name,t);else if(t==null)for(i in f)f[i]=n(f[i],r.name,null);return this},copy:function(){var r={},t=this._;for(var f in t)r[f]=t[f].slice();return new T(r)},call:function(r,t){if((i=arguments.length-2)>0)for(var f=new Array(i),o=0,i,g;o<i;++o)f[o]=arguments[o+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(g=this._[r],o=0,i=g.length;o<i;++o)g[o].value.apply(t,f)},apply:function(r,t,f){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var o=this._[r],i=0,g=o.length;i<g;++i)o[i].value.apply(t,f)}};function a(r,t){for(var f=0,o=r.length,i;f<o;++f)if((i=r[f]).name===t)return i.value}function n(r,t,f){for(var o=0,i=r.length;o<i;++o)if(r[o].name===t){r[o]=c,r=r.slice(0,o).concat(r.slice(o+1));break}return f!=null&&r.push({name:t,value:f}),r}w.dispatch=M,Object.defineProperty(w,"__esModule",{value:!0})})},{}],111:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne,d("d3-quadtree"),d("d3-collection"),d("d3-dispatch"),d("d3-timer")):c(w.d3=w.d3||{},w.d3,w.d3,w.d3,w.d3)})(this,function(w,c,M,T,e){function a(b,l){var L;b==null&&(b=0),l==null&&(l=0);function S(){var k,P=L.length,z,I=0,D=0;for(k=0;k<P;++k)z=L[k],I+=z.x,D+=z.y;for(I=I/P-b,D=D/P-l,k=0;k<P;++k)z=L[k],z.x-=I,z.y-=D}return S.initialize=function(k){L=k},S.x=function(k){return arguments.length?(b=+k,S):b},S.y=function(k){return arguments.length?(l=+k,S):l},S}function n(b){return function(){return b}}function r(){return(Math.random()-.5)*1e-6}function t(b){return b.x+b.vx}function f(b){return b.y+b.vy}function o(b){var l,L,S=1,k=1;typeof b!="function"&&(b=n(b==null?1:+b));function P(){for(var D,R=l.length,B,F,V,G,J,j,Y=0;Y<k;++Y)for(B=c.quadtree(l,t,f).visitAfter(z),D=0;D<R;++D)F=l[D],J=L[F.index],j=J*J,V=F.x+F.vx,G=F.y+F.vy,B.visit(X);function X(oe,se,ie,N,U){var q=oe.data,Q=oe.r,W=J+Q;if(q){if(q.index>F.index){var Z=V-q.x-q.vx,ee=G-q.y-q.vy,te=Z*Z+ee*ee;te<W*W&&(Z===0&&(Z=r(),te+=Z*Z),ee===0&&(ee=r(),te+=ee*ee),te=(W-(te=Math.sqrt(te)))/te*S,F.vx+=(Z*=te)*(W=(Q*=Q)/(j+Q)),F.vy+=(ee*=te)*W,q.vx-=Z*(W=1-W),q.vy-=ee*W)}return}return se>V+W||N<V-W||ie>G+W||U<G-W}}function z(D){if(D.data)return D.r=L[D.data.index];for(var R=D.r=0;R<4;++R)D[R]&&D[R].r>D.r&&(D.r=D[R].r)}function I(){if(!!l){var D,R=l.length,B;for(L=new Array(R),D=0;D<R;++D)B=l[D],L[B.index]=+b(B,D,l)}}return P.initialize=function(D){l=D,I()},P.iterations=function(D){return arguments.length?(k=+D,P):k},P.strength=function(D){return arguments.length?(S=+D,P):S},P.radius=function(D){return arguments.length?(b=typeof D=="function"?D:n(+D),I(),P):b},P}function i(b){return b.index}function g(b,l){var L=b.get(l);if(!L)throw new Error("missing: "+l);return L}function p(b){var l=i,L=B,S,k=n(30),P,z,I,D,R=1;b==null&&(b=[]);function B(j){return 1/Math.min(I[j.source.index],I[j.target.index])}function F(j){for(var Y=0,X=b.length;Y<R;++Y)for(var oe=0,se,ie,N,U,q,Q,W;oe<X;++oe)se=b[oe],ie=se.source,N=se.target,U=N.x+N.vx-ie.x-ie.vx||r(),q=N.y+N.vy-ie.y-ie.vy||r(),Q=Math.sqrt(U*U+q*q),Q=(Q-P[oe])/Q*j*S[oe],U*=Q,q*=Q,N.vx-=U*(W=D[oe]),N.vy-=q*W,ie.vx+=U*(W=1-W),ie.vy+=q*W}function V(){if(!!z){var j,Y=z.length,X=b.length,oe=M.map(z,l),se;for(j=0,I=new Array(Y);j<X;++j)se=b[j],se.index=j,typeof se.source!="object"&&(se.source=g(oe,se.source)),typeof se.target!="object"&&(se.target=g(oe,se.target)),I[se.source.index]=(I[se.source.index]||0)+1,I[se.target.index]=(I[se.target.index]||0)+1;for(j=0,D=new Array(X);j<X;++j)se=b[j],D[j]=I[se.source.index]/(I[se.source.index]+I[se.target.index]);S=new Array(X),G(),P=new Array(X),J()}}function G(){if(!!z)for(var j=0,Y=b.length;j<Y;++j)S[j]=+L(b[j],j,b)}function J(){if(!!z)for(var j=0,Y=b.length;j<Y;++j)P[j]=+k(b[j],j,b)}return F.initialize=function(j){z=j,V()},F.links=function(j){return arguments.length?(b=j,V(),F):b},F.id=function(j){return arguments.length?(l=j,F):l},F.iterations=function(j){return arguments.length?(R=+j,F):R},F.strength=function(j){return arguments.length?(L=typeof j=="function"?j:n(+j),G(),F):L},F.distance=function(j){return arguments.length?(k=typeof j=="function"?j:n(+j),J(),F):k},F}function y(b){return b.x}function h(b){return b.y}var m=10,u=Math.PI*(3-Math.sqrt(5));function _(b){var l,L=1,S=.001,k=1-Math.pow(S,1/300),P=0,z=.6,I=M.map(),D=e.timer(B),R=T.dispatch("tick","end");b==null&&(b=[]);function B(){F(),R.call("tick",l),L<S&&(D.stop(),R.call("end",l))}function F(J){var j,Y=b.length,X;J===void 0&&(J=1);for(var oe=0;oe<J;++oe)for(L+=(P-L)*k,I.each(function(se){se(L)}),j=0;j<Y;++j)X=b[j],X.fx==null?X.x+=X.vx*=z:(X.x=X.fx,X.vx=0),X.fy==null?X.y+=X.vy*=z:(X.y=X.fy,X.vy=0);return l}function V(){for(var J=0,j=b.length,Y;J<j;++J){if(Y=b[J],Y.index=J,Y.fx!=null&&(Y.x=Y.fx),Y.fy!=null&&(Y.y=Y.fy),isNaN(Y.x)||isNaN(Y.y)){var X=m*Math.sqrt(J),oe=J*u;Y.x=X*Math.cos(oe),Y.y=X*Math.sin(oe)}(isNaN(Y.vx)||isNaN(Y.vy))&&(Y.vx=Y.vy=0)}}function G(J){return J.initialize&&J.initialize(b),J}return V(),l={tick:F,restart:function(){return D.restart(B),l},stop:function(){return D.stop(),l},nodes:function(J){return arguments.length?(b=J,V(),I.each(G),l):b},alpha:function(J){return arguments.length?(L=+J,l):L},alphaMin:function(J){return arguments.length?(S=+J,l):S},alphaDecay:function(J){return arguments.length?(k=+J,l):+k},alphaTarget:function(J){return arguments.length?(P=+J,l):P},velocityDecay:function(J){return arguments.length?(z=1-J,l):1-z},force:function(J,j){return arguments.length>1?(j==null?I.remove(J):I.set(J,G(j)),l):I.get(J)},find:function(J,j,Y){var X=0,oe=b.length,se,ie,N,U,q;for(Y==null?Y=1/0:Y*=Y,X=0;X<oe;++X)U=b[X],se=J-U.x,ie=j-U.y,N=se*se+ie*ie,N<Y&&(q=U,Y=N);return q},on:function(J,j){return arguments.length>1?(R.on(J,j),l):R.on(J)}}}function s(){var b,l,L,S=n(-30),k,P=1,z=1/0,I=.81;function D(V){var G,J=b.length,j=c.quadtree(b,y,h).visitAfter(B);for(L=V,G=0;G<J;++G)l=b[G],j.visit(F)}function R(){if(!!b){var V,G=b.length,J;for(k=new Array(G),V=0;V<G;++V)J=b[V],k[J.index]=+S(J,V,b)}}function B(V){var G=0,J,j,Y=0,X,oe,se;if(V.length){for(X=oe=se=0;se<4;++se)(J=V[se])&&(j=Math.abs(J.value))&&(G+=J.value,Y+=j,X+=j*J.x,oe+=j*J.y);V.x=X/Y,V.y=oe/Y}else{J=V,J.x=J.data.x,J.y=J.data.y;do G+=k[J.data.index];while(J=J.next)}V.value=G}function F(V,G,J,j){if(!V.value)return!0;var Y=V.x-l.x,X=V.y-l.y,oe=j-G,se=Y*Y+X*X;if(oe*oe/I<se)return se<z&&(Y===0&&(Y=r(),se+=Y*Y),X===0&&(X=r(),se+=X*X),se<P&&(se=Math.sqrt(P*se)),l.vx+=Y*V.value*L/se,l.vy+=X*V.value*L/se),!0;if(V.length||se>=z)return;(V.data!==l||V.next)&&(Y===0&&(Y=r(),se+=Y*Y),X===0&&(X=r(),se+=X*X),se<P&&(se=Math.sqrt(P*se)));do V.data!==l&&(oe=k[V.data.index]*L/se,l.vx+=Y*oe,l.vy+=X*oe);while(V=V.next)}return D.initialize=function(V){b=V,R()},D.strength=function(V){return arguments.length?(S=typeof V=="function"?V:n(+V),R(),D):S},D.distanceMin=function(V){return arguments.length?(P=V*V,D):Math.sqrt(P)},D.distanceMax=function(V){return arguments.length?(z=V*V,D):Math.sqrt(z)},D.theta=function(V){return arguments.length?(I=V*V,D):Math.sqrt(I)},D}function A(b,l,L){var S,k=n(.1),P,z;typeof b!="function"&&(b=n(+b)),l==null&&(l=0),L==null&&(L=0);function I(R){for(var B=0,F=S.length;B<F;++B){var V=S[B],G=V.x-l||1e-6,J=V.y-L||1e-6,j=Math.sqrt(G*G+J*J),Y=(z[B]-j)*P[B]*R/j;V.vx+=G*Y,V.vy+=J*Y}}function D(){if(!!S){var R,B=S.length;for(P=new Array(B),z=new Array(B),R=0;R<B;++R)z[R]=+b(S[R],R,S),P[R]=isNaN(z[R])?0:+k(S[R],R,S)}}return I.initialize=function(R){S=R,D()},I.strength=function(R){return arguments.length?(k=typeof R=="function"?R:n(+R),D(),I):k},I.radius=function(R){return arguments.length?(b=typeof R=="function"?R:n(+R),D(),I):b},I.x=function(R){return arguments.length?(l=+R,I):l},I.y=function(R){return arguments.length?(L=+R,I):L},I}function x(b){var l=n(.1),L,S,k;typeof b!="function"&&(b=n(b==null?0:+b));function P(I){for(var D=0,R=L.length,B;D<R;++D)B=L[D],B.vx+=(k[D]-B.x)*S[D]*I}function z(){if(!!L){var I,D=L.length;for(S=new Array(D),k=new Array(D),I=0;I<D;++I)S[I]=isNaN(k[I]=+b(L[I],I,L))?0:+l(L[I],I,L)}}return P.initialize=function(I){L=I,z()},P.strength=function(I){return arguments.length?(l=typeof I=="function"?I:n(+I),z(),P):l},P.x=function(I){return arguments.length?(b=typeof I=="function"?I:n(+I),z(),P):b},P}function v(b){var l=n(.1),L,S,k;typeof b!="function"&&(b=n(b==null?0:+b));function P(I){for(var D=0,R=L.length,B;D<R;++D)B=L[D],B.vy+=(k[D]-B.y)*S[D]*I}function z(){if(!!L){var I,D=L.length;for(S=new Array(D),k=new Array(D),I=0;I<D;++I)S[I]=isNaN(k[I]=+b(L[I],I,L))?0:+l(L[I],I,L)}}return P.initialize=function(I){L=I,z()},P.strength=function(I){return arguments.length?(l=typeof I=="function"?I:n(+I),z(),P):l},P.y=function(I){return arguments.length?(b=typeof I=="function"?I:n(+I),z(),P):b},P}w.forceCenter=a,w.forceCollide=o,w.forceLink=p,w.forceManyBody=s,w.forceRadial=A,w.forceSimulation=_,w.forceX=x,w.forceY=v,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne):(w=typeof globalThis!="undefined"?globalThis:w||self,c(w.d3=w.d3||{}))})(this,function(w){function c(b){return Math.abs(b=Math.round(b))>=1e21?b.toLocaleString("en").replace(/,/g,""):b.toString(10)}function M(b,l){if((L=(b=l?b.toExponential(l-1):b.toExponential()).indexOf("e"))<0)return null;var L,S=b.slice(0,L);return[S.length>1?S[0]+S.slice(2):S,+b.slice(L+1)]}function T(b){return b=M(Math.abs(b)),b?b[1]:NaN}function e(b,l){return function(L,S){for(var k=L.length,P=[],z=0,I=b[0],D=0;k>0&&I>0&&(D+I+1>S&&(I=Math.max(1,S-D)),P.push(L.substring(k-=I,k+I)),!((D+=I+1)>S));)I=b[z=(z+1)%b.length];return P.reverse().join(l)}}function a(b){return function(l){return l.replace(/[0-9]/g,function(L){return b[+L]})}}var n=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function r(b){if(!(l=n.exec(b)))throw new Error("invalid format: "+b);var l;return new t({fill:l[1],align:l[2],sign:l[3],symbol:l[4],zero:l[5],width:l[6],comma:l[7],precision:l[8]&&l[8].slice(1),trim:l[9],type:l[10]})}r.prototype=t.prototype;function t(b){this.fill=b.fill===void 0?" ":b.fill+"",this.align=b.align===void 0?">":b.align+"",this.sign=b.sign===void 0?"-":b.sign+"",this.symbol=b.symbol===void 0?"":b.symbol+"",this.zero=!!b.zero,this.width=b.width===void 0?void 0:+b.width,this.comma=!!b.comma,this.precision=b.precision===void 0?void 0:+b.precision,this.trim=!!b.trim,this.type=b.type===void 0?"":b.type+""}t.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function f(b){e:for(var l=b.length,L=1,S=-1,k;L<l;++L)switch(b[L]){case".":S=k=L;break;case"0":S===0&&(S=L),k=L;break;default:if(!+b[L])break e;S>0&&(S=0);break}return S>0?b.slice(0,S)+b.slice(k+1):b}var o;function i(b,l){var L=M(b,l);if(!L)return b+"";var S=L[0],k=L[1],P=k-(o=Math.max(-8,Math.min(8,Math.floor(k/3)))*3)+1,z=S.length;return P===z?S:P>z?S+new Array(P-z+1).join("0"):P>0?S.slice(0,P)+"."+S.slice(P):"0."+new Array(1-P).join("0")+M(b,Math.max(0,l+P-1))[0]}function g(b,l){var L=M(b,l);if(!L)return b+"";var S=L[0],k=L[1];return k<0?"0."+new Array(-k).join("0")+S:S.length>k+1?S.slice(0,k+1)+"."+S.slice(k+1):S+new Array(k-S.length+2).join("0")}var p={"%":function(b,l){return(b*100).toFixed(l)},b:function(b){return Math.round(b).toString(2)},c:function(b){return b+""},d:c,e:function(b,l){return b.toExponential(l)},f:function(b,l){return b.toFixed(l)},g:function(b,l){return b.toPrecision(l)},o:function(b){return Math.round(b).toString(8)},p:function(b,l){return g(b*100,l)},r:g,s:i,X:function(b){return Math.round(b).toString(16).toUpperCase()},x:function(b){return Math.round(b).toString(16)}};function y(b){return b}var h=Array.prototype.map,m=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function u(b){var l=b.grouping===void 0||b.thousands===void 0?y:e(h.call(b.grouping,Number),b.thousands+""),L=b.currency===void 0?"":b.currency[0]+"",S=b.currency===void 0?"":b.currency[1]+"",k=b.decimal===void 0?".":b.decimal+"",P=b.numerals===void 0?y:a(h.call(b.numerals,String)),z=b.percent===void 0?"%":b.percent+"",I=b.minus===void 0?"-":b.minus+"",D=b.nan===void 0?"NaN":b.nan+"";function R(F){F=r(F);var V=F.fill,G=F.align,J=F.sign,j=F.symbol,Y=F.zero,X=F.width,oe=F.comma,se=F.precision,ie=F.trim,N=F.type;N==="n"?(oe=!0,N="g"):p[N]||(se===void 0&&(se=12),ie=!0,N="g"),(Y||V==="0"&&G==="=")&&(Y=!0,V="0",G="=");var U=j==="$"?L:j==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",q=j==="$"?S:/[%p]/.test(N)?z:"",Q=p[N],W=/[defgprs%]/.test(N);se=se===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,se)):Math.max(0,Math.min(20,se));function Z(ee){var te=U,ae=q,le,ye,fe;if(N==="c")ae=Q(ee)+ae,ee="";else{ee=+ee;var pe=ee<0||1/ee<0;if(ee=isNaN(ee)?D:Q(Math.abs(ee),se),ie&&(ee=f(ee)),pe&&+ee==0&&J!=="+"&&(pe=!1),te=(pe?J==="("?J:I:J==="-"||J==="("?"":J)+te,ae=(N==="s"?m[8+o/3]:"")+ae+(pe&&J==="("?")":""),W){for(le=-1,ye=ee.length;++le<ye;)if(fe=ee.charCodeAt(le),48>fe||fe>57){ae=(fe===46?k+ee.slice(le+1):ee.slice(le))+ae,ee=ee.slice(0,le);break}}}oe&&!Y&&(ee=l(ee,1/0));var ge=te.length+ee.length+ae.length,Ae=ge<X?new Array(X-ge+1).join(V):"";switch(oe&&Y&&(ee=l(Ae+ee,Ae.length?X-ae.length:1/0),Ae=""),G){case"<":ee=te+ee+ae+Ae;break;case"=":ee=te+Ae+ee+ae;break;case"^":ee=Ae.slice(0,ge=Ae.length>>1)+te+ee+ae+Ae.slice(ge);break;default:ee=Ae+te+ee+ae;break}return P(ee)}return Z.toString=function(){return F+""},Z}function B(F,V){var G=R((F=r(F),F.type="f",F)),J=Math.max(-8,Math.min(8,Math.floor(T(V)/3)))*3,j=Math.pow(10,-J),Y=m[8+J/3];return function(X){return G(j*X)+Y}}return{format:R,formatPrefix:B}}var _;s({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function s(b){return _=u(b),w.format=_.format,w.formatPrefix=_.formatPrefix,_}function A(b){return Math.max(0,-T(Math.abs(b)))}function x(b,l){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(T(l)/3)))*3-T(Math.abs(b)))}function v(b,l){return b=Math.abs(b),l=Math.abs(l)-b,Math.max(0,T(l)-T(b))+1}w.FormatSpecifier=t,w.formatDefaultLocale=s,w.formatLocale=u,w.formatSpecifier=r,w.precisionFixed=A,w.precisionPrefix=x,w.precisionRound=v,Object.defineProperty(w,"__esModule",{value:!0})})},{}],113:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne,d("d3-geo"),d("d3-array")):c(w.d3=w.d3||{},w.d3,w.d3)})(this,function(w,c,M){var T=Math.abs,e=Math.atan,a=Math.atan2,n=Math.cos,r=Math.exp,t=Math.floor,f=Math.log,o=Math.max,i=Math.min,g=Math.pow,p=Math.round,y=Math.sign||function(Re){return Re>0?1:Re<0?-1:0},h=Math.sin,m=Math.tan,u=1e-6,_=1e-12,s=Math.PI,A=s/2,x=s/4,v=Math.SQRT1_2,b=D(2),l=D(s),L=s*2,S=180/s,k=s/180;function P(Re){return Re?Re/Math.sin(Re):1}function z(Re){return Re>1?A:Re<-1?-A:Math.asin(Re)}function I(Re){return Re>1?0:Re<-1?s:Math.acos(Re)}function D(Re){return Re>0?Math.sqrt(Re):0}function R(Re){return Re=r(2*Re),(Re-1)/(Re+1)}function B(Re){return(r(Re)-r(-Re))/2}function F(Re){return(r(Re)+r(-Re))/2}function V(Re){return f(Re+D(Re*Re+1))}function G(Re){return f(Re+D(Re*Re-1))}function J(Re){var Ge=m(Re/2),et=2*f(n(Re/2))/(Ge*Ge);function it(mt,gt){var _t=n(mt),ar=n(gt),fr=h(gt),rr=ar*_t,pr=-((1-rr?f((1+rr)/2)/(1-rr):-.5)+et/(1+rr));return[pr*ar*h(mt),pr*fr]}return it.invert=function(mt,gt){var _t=D(mt*mt+gt*gt),ar=-Re/2,fr=50,rr;if(!_t)return[0,0];do{var pr=ar/2,kr=n(pr),Hr=h(pr),Qr=Hr/kr,mn=-f(T(kr));ar-=rr=(2/Qr*mn-et*Qr-_t)/(-mn/(Hr*Hr)+1-et/(2*kr*kr))*(kr<0?.7:1)}while(T(rr)>u&&--fr>0);var Ln=h(ar);return[a(mt*Ln,_t*n(ar)),z(gt*Ln/_t)]},it}function j(){var Re=A,Ge=c.geoProjectionMutator(J),et=Ge(Re);return et.radius=function(it){return arguments.length?Ge(Re=it*k):Re*S},et.scale(179.976).clipAngle(147)}function Y(Re,Ge){var et=n(Ge),it=P(I(et*n(Re/=2)));return[2*et*h(Re)*it,h(Ge)*it]}Y.invert=function(Re,Ge){if(!(Re*Re+4*Ge*Ge>s*s+u)){var et=Re,it=Ge,mt=25;do{var gt=h(et),_t=h(et/2),ar=n(et/2),fr=h(it),rr=n(it),pr=h(2*it),kr=fr*fr,Hr=rr*rr,Qr=_t*_t,mn=1-Hr*ar*ar,Ln=mn?I(rr*ar)*D(Gn=1/mn):Gn=0,Gn,ga=2*Ln*rr*_t-Re,xa=Ln*fr-Ge,ja=Gn*(Hr*Qr+Ln*rr*ar*kr),Wa=Gn*(.5*gt*pr-Ln*2*fr*_t),qa=Gn*.25*(pr*_t-Ln*fr*Hr*gt),pi=Gn*(kr*ar+Ln*Qr*rr),oo=Wa*qa-pi*ja;if(!oo)break;var ti=(xa*Wa-ga*pi)/oo,Yi=(ga*qa-xa*ja)/oo;et-=ti,it-=Yi}while((T(ti)>u||T(Yi)>u)&&--mt>0);return[et,it]}};function X(){return c.geoProjection(Y).scale(152.63)}function oe(Re){var Ge=h(Re),et=n(Re),it=Re>=0?1:-1,mt=m(it*Re),gt=(1+Ge-et)/2;function _t(ar,fr){var rr=n(fr),pr=n(ar/=2);return[(1+rr)*h(ar),(it*fr>-a(pr,mt)-.001?0:-it*10)+gt+h(fr)*et-(1+rr)*Ge*pr]}return _t.invert=function(ar,fr){var rr=0,pr=0,kr=50;do{var Hr=n(rr),Qr=h(rr),mn=n(pr),Ln=h(pr),Gn=1+mn,ga=Gn*Qr-ar,xa=gt+Ln*et-Gn*Ge*Hr-fr,ja=Gn*Hr/2,Wa=-Qr*Ln,qa=Ge*Gn*Qr/2,pi=et*mn+Ge*Hr*Ln,oo=Wa*qa-pi*ja,ti=(xa*Wa-ga*pi)/oo/2,Yi=(ga*qa-xa*ja)/oo;T(Yi)>2&&(Yi/=2),rr-=ti,pr-=Yi}while((T(ti)>u||T(Yi)>u)&&--kr>0);return it*pr>-a(n(rr),mt)-.001?[rr*2,pr]:null},_t}function se(){var Re=20*k,Ge=Re>=0?1:-1,et=m(Ge*Re),it=c.geoProjectionMutator(oe),mt=it(Re),gt=mt.stream;return mt.parallel=function(_t){return arguments.length?(et=m((Ge=(Re=_t*k)>=0?1:-1)*Re),it(Re)):Re*S},mt.stream=function(_t){var ar=mt.rotate(),fr=gt(_t),rr=(mt.rotate([0,0]),gt(_t)),pr=mt.precision();return mt.rotate(ar),fr.sphere=function(){rr.polygonStart(),rr.lineStart();for(var kr=Ge*-180;Ge*kr<180;kr+=Ge*90)rr.point(kr,Ge*90);if(Re)for(;Ge*(kr-=3*Ge*pr)>=-180;)rr.point(kr,Ge*-a(n(kr*k/2),et)*S);rr.lineEnd(),rr.polygonEnd()},fr},mt.scale(218.695).center([0,28.0974])}function ie(Re,Ge){var et=m(Ge/2),it=D(1-et*et),mt=1+it*n(Re/=2),gt=h(Re)*it/mt,_t=et/mt,ar=gt*gt,fr=_t*_t;return[4/3*gt*(3+ar-3*fr),4/3*_t*(3+3*ar-fr)]}ie.invert=function(Re,Ge){if(Re*=3/8,Ge*=3/8,!Re&&T(Ge)>1)return null;var et=Re*Re,it=Ge*Ge,mt=1+et+it,gt=D((mt-D(mt*mt-4*Ge*Ge))/2),_t=z(gt)/3,ar=gt?G(T(Ge/gt))/3:V(T(Re))/3,fr=n(_t),rr=F(ar),pr=rr*rr-fr*fr;return[y(Re)*2*a(B(ar)*fr,.25-pr),y(Ge)*2*a(rr*h(_t),.25+pr)]};function N(){return c.geoProjection(ie).scale(66.1603)}var U=D(8),q=f(1+b);function Q(Re,Ge){var et=T(Ge);return et<x?[Re,f(m(x+Ge/2))]:[Re*n(et)*(2*b-1/h(et)),y(Ge)*(2*b*(et-x)-f(m(et/2)))]}Q.invert=function(Re,Ge){if((gt=T(Ge))<q)return[Re,2*e(r(Ge))-A];var et=x,it=25,mt,gt;do{var _t=n(et/2),ar=m(et/2);et-=mt=(U*(et-x)-f(ar)-gt)/(U-_t*_t/(2*ar))}while(T(mt)>_&&--it>0);return[Re/(n(et)*(U-1/h(et))),y(Ge)*et]};function W(){return c.geoProjection(Q).scale(112.314)}function Z(Re){var Ge=2*s/Re;function et(it,mt){var gt=c.geoAzimuthalEquidistantRaw(it,mt);if(T(it)>A){var _t=a(gt[1],gt[0]),ar=D(gt[0]*gt[0]+gt[1]*gt[1]),fr=Ge*p((_t-A)/Ge)+A,rr=a(h(_t-=fr),2-n(_t));_t=fr+z(s/ar*h(rr))-rr,gt[0]=ar*n(_t),gt[1]=ar*h(_t)}return gt}return et.invert=function(it,mt){var gt=D(it*it+mt*mt);if(gt>A){var _t=a(mt,it),ar=Ge*p((_t-A)/Ge)+A,fr=_t>ar?-1:1,rr=gt*n(ar-_t),pr=1/m(fr*I((rr-s)/D(s*(s-2*rr)+gt*gt)));_t=ar+2*e((pr+fr*D(pr*pr-3))/3),it=gt*n(_t),mt=gt*h(_t)}return c.geoAzimuthalEquidistantRaw.invert(it,mt)},et}function ee(){var Re=5,Ge=c.geoProjectionMutator(Z),et=Ge(Re),it=et.stream,mt=.01,gt=-n(mt*k),_t=h(mt*k);return et.lobes=function(ar){return arguments.length?Ge(Re=+ar):Re},et.stream=function(ar){var fr=et.rotate(),rr=it(ar),pr=(et.rotate([0,0]),it(ar));return et.rotate(fr),rr.sphere=function(){pr.polygonStart(),pr.lineStart();for(var kr=0,Hr=360/Re,Qr=2*s/Re,mn=90-180/Re,Ln=A;kr<Re;++kr,mn-=Hr,Ln-=Qr)pr.point(a(_t*n(Ln),gt)*S,z(_t*h(Ln))*S),mn<-90?(pr.point(-90,-180-mn-mt),pr.point(-90,-180-mn+mt)):(pr.point(90,mn+mt),pr.point(90,mn-mt));pr.lineEnd(),pr.polygonEnd()},rr},et.scale(87.8076).center([0,17.1875]).clipAngle(180-.001)}function te(Re,Ge){if(arguments.length<2&&(Ge=Re),Ge===1)return c.geoAzimuthalEqualAreaRaw;if(Ge===1/0)return ae;function et(it,mt){var gt=c.geoAzimuthalEqualAreaRaw(it/Ge,mt);return gt[0]*=Re,gt}return et.invert=function(it,mt){var gt=c.geoAzimuthalEqualAreaRaw.invert(it/Re,mt);return gt[0]*=Ge,gt},et}function ae(Re,Ge){return[Re*n(Ge)/n(Ge/=2),2*h(Ge)]}ae.invert=function(Re,Ge){var et=2*z(Ge/2);return[Re*n(et/2)/n(et),et]};function le(){var Re=2,Ge=c.geoProjectionMutator(te),et=Ge(Re);return et.coefficient=function(it){return arguments.length?Ge(Re=+it):Re},et.scale(169.529)}function ye(Re,Ge,et){var it=100,mt,gt,_t;et=et===void 0?0:+et,Ge=+Ge;do gt=Re(et),_t=Re(et+u),gt===_t&&(_t=gt+u),et-=mt=-1*u*(gt-Ge)/(gt-_t);while(it-- >0&&T(mt)>u);return it<0?NaN:et}function fe(Re,Ge,et){return Ge===void 0&&(Ge=40),et===void 0&&(et=_),function(it,mt,gt,_t){var ar,fr,rr;gt=gt===void 0?0:+gt,_t=_t===void 0?0:+_t;for(var pr=0;pr<Ge;pr++){var kr=Re(gt,_t),Hr=kr[0]-it,Qr=kr[1]-mt;if(T(Hr)<et&&T(Qr)<et)break;var mn=Hr*Hr+Qr*Qr;if(mn>ar){gt-=fr/=2,_t-=rr/=2;continue}ar=mn;var Ln=(gt>0?-1:1)*et,Gn=(_t>0?-1:1)*et,ga=Re(gt+Ln,_t),xa=Re(gt,_t+Gn),ja=(ga[0]-kr[0])/Ln,Wa=(ga[1]-kr[1])/Ln,qa=(xa[0]-kr[0])/Gn,pi=(xa[1]-kr[1])/Gn,oo=pi*ja-Wa*qa,ti=(T(oo)<.5?.5:1)/oo;if(fr=(Qr*qa-Hr*pi)*ti,rr=(Hr*Wa-Qr*ja)*ti,gt+=fr,_t+=rr,T(fr)<et&&T(rr)<et)break}return[gt,_t]}}function pe(){var Re=te(1.68,2),Ge=1.4,et=12;function it(mt,gt){if(mt+gt<-Ge){var _t=(mt-gt+1.6)*(mt+gt+Ge)/8;mt+=_t,gt-=.8*_t*h(gt+s/2)}var ar=Re(mt,gt),fr=(1-n(mt*gt))/et;return ar[1]<0&&(ar[0]*=1+fr),ar[1]>0&&(ar[1]*=1+fr/1.5*ar[0]*ar[0]),ar}return it.invert=fe(it),it}function ge(){return c.geoProjection(pe()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])}function Ae(Re,Ge){var et=Re*h(Ge),it=30,mt;do Ge-=mt=(Ge+h(Ge)-et)/(1+n(Ge));while(T(mt)>u&&--it>0);return Ge/2}function we(Re,Ge,et){function it(mt,gt){return[Re*mt*n(gt=Ae(et,gt)),Ge*h(gt)]}return it.invert=function(mt,gt){return gt=z(gt/Ge),[mt/(Re*n(gt)),z((2*gt+h(2*gt))/et)]},it}var De=we(b/A,b,s);function Be(){return c.geoProjection(De).scale(169.529)}var Ve=2.00276,xe=1.11072;function Le(Re,Ge){var et=Ae(s,Ge);return[Ve*Re/(1/n(Ge)+xe/n(et)),(Ge+b*h(et))/Ve]}Le.invert=function(Re,Ge){var et=Ve*Ge,it=Ge<0?-x:x,mt=25,gt,_t;do _t=et-b*h(it),it-=gt=(h(2*it)+2*it-s*h(_t))/(2*n(2*it)+2+s*n(_t)*b*n(it));while(T(gt)>u&&--mt>0);return _t=et-b*h(it),[Re*(1/n(_t)+xe/n(it))/Ve,_t]};function He(){return c.geoProjection(Le).scale(160.857)}function Je(Re){var Ge=0,et=c.geoProjectionMutator(Re),it=et(Ge);return it.parallel=function(mt){return arguments.length?et(Ge=mt*k):Ge*S},it}function Oe(Re,Ge){return[Re*n(Ge),Ge]}Oe.invert=function(Re,Ge){return[Re/n(Ge),Ge]};function Pe(){return c.geoProjection(Oe).scale(152.63)}function Ue(Re){if(!Re)return Oe;var Ge=1/m(Re);function et(it,mt){var gt=Ge+Re-mt,_t=gt&&it*n(mt)/gt;return[gt*h(_t),Ge-gt*n(_t)]}return et.invert=function(it,mt){var gt=D(it*it+(mt=Ge-mt)*mt),_t=Ge+Re-gt;return[gt/n(_t)*a(it,mt),_t]},et}function vt(){return Je(Ue).scale(123.082).center([0,26.1441]).parallel(45)}function Lt(Re){function Ge(et,it){var mt=A-it,gt=mt&&et*Re*h(mt)/mt;return[mt*h(gt)/Re,A-mt*n(gt)]}return Ge.invert=function(et,it){var mt=et*Re,gt=A-it,_t=D(mt*mt+gt*gt),ar=a(mt,gt);return[(_t?_t/h(_t):1)*ar/Re,A-_t]},Ge}function Yt(){var Re=.5,Ge=c.geoProjectionMutator(Lt),et=Ge(Re);return et.fraction=function(it){return arguments.length?Ge(Re=+it):Re},et.scale(158.837)}var At=we(1,4/s,s);function Rt(){return c.geoProjection(At).scale(152.63)}function Bt(Re,Ge,et,it,mt,gt){var _t=n(gt),ar;if(T(Re)>1||T(gt)>1)ar=I(et*mt+Ge*it*_t);else{var fr=h(Re/2),rr=h(gt/2);ar=2*z(D(fr*fr+Ge*it*rr*rr))}return T(ar)>u?[ar,a(it*h(gt),Ge*mt-et*it*_t)]:[0,0]}function Mt(Re,Ge,et){return I((Re*Re+Ge*Ge-et*et)/(2*Re*Ge))}function Tt(Re){return Re-2*s*t((Re+s)/(2*s))}function at(Re,Ge,et){for(var it=[[Re[0],Re[1],h(Re[1]),n(Re[1])],[Ge[0],Ge[1],h(Ge[1]),n(Ge[1])],[et[0],et[1],h(et[1]),n(et[1])]],mt=it[2],gt,_t=0;_t<3;++_t,mt=gt)gt=it[_t],mt.v=Bt(gt[1]-mt[1],mt[3],mt[2],gt[3],gt[2],gt[0]-mt[0]),mt.point=[0,0];var ar=Mt(it[0].v[0],it[2].v[0],it[1].v[0]),fr=Mt(it[0].v[0],it[1].v[0],it[2].v[0]),rr=s-ar;it[2].point[1]=0,it[0].point[0]=-(it[1].point[0]=it[0].v[0]/2);var pr=[it[2].point[0]=it[0].point[0]+it[2].v[0]*n(ar),2*(it[0].point[1]=it[1].point[1]=it[2].v[0]*h(ar))];function kr(Hr,Qr){var mn=h(Qr),Ln=n(Qr),Gn=new Array(3),ga;for(ga=0;ga<3;++ga){var xa=it[ga];if(Gn[ga]=Bt(Qr-xa[1],xa[3],xa[2],Ln,mn,Hr-xa[0]),!Gn[ga][0])return xa.point;Gn[ga][1]=Tt(Gn[ga][1]-xa.v[1])}var ja=pr.slice();for(ga=0;ga<3;++ga){var Wa=ga==2?0:ga+1,qa=Mt(it[ga].v[0],Gn[ga][0],Gn[Wa][0]);Gn[ga][1]<0&&(qa=-qa),ga?ga==1?(qa=fr-qa,ja[0]-=Gn[ga][0]*n(qa),ja[1]-=Gn[ga][0]*h(qa)):(qa=rr-qa,ja[0]+=Gn[ga][0]*n(qa),ja[1]+=Gn[ga][0]*h(qa)):(ja[0]+=Gn[ga][0]*n(qa),ja[1]-=Gn[ga][0]*h(qa))}return ja[0]/=3,ja[1]/=3,ja}return kr}function ct(Re){return Re[0]*=k,Re[1]*=k,Re}function je(){return ke([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])}function ke(Re,Ge,et){var it=c.geoCentroid({type:"MultiPoint",coordinates:[Re,Ge,et]}),mt=[-it[0],-it[1]],gt=c.geoRotation(mt),_t=at(ct(gt(Re)),ct(gt(Ge)),ct(gt(et)));_t.invert=fe(_t);var ar=c.geoProjection(_t).rotate(mt),fr=ar.center;return delete ar.rotate,ar.center=function(rr){return arguments.length?fr(gt(rr)):gt.invert(fr())},ar.clipAngle(90)}function Ye(Re,Ge){var et=D(1-h(Ge));return[2/l*Re*et,l*(1-et)]}Ye.invert=function(Re,Ge){var et=(et=Ge/l-1)*et;return[et>0?Re*D(s/et)/2:0,z(1-et)]};function Ke(){return c.geoProjection(Ye).scale(95.6464).center([0,30])}function st(Re){var Ge=m(Re);function et(it,mt){return[it,(it?it/h(it):1)*(h(mt)*n(it)-Ge*n(mt))]}return et.invert=Ge?function(it,mt){it&&(mt*=h(it)/it);var gt=n(it);return[it,2*a(D(gt*gt+Ge*Ge-mt*mt)-gt,Ge-mt)]}:function(it,mt){return[it,z(it?mt*m(it)/it:mt)]},et}function Et(){return Je(st).scale(249.828).clipAngle(90)}var bt=D(3);function zt(Re,Ge){return[bt*Re*(2*n(2*Ge/3)-1)/l,bt*l*h(Ge/3)]}zt.invert=function(Re,Ge){var et=3*z(Ge/(bt*l));return[l*Re/(bt*(2*n(2*et/3)-1)),et]};function $t(){return c.geoProjection(zt).scale(156.19)}function Ot(Re){var Ge=n(Re);function et(it,mt){return[it*Ge,h(mt)/Ge]}return et.invert=function(it,mt){return[it/Ge,z(mt*Ge)]},et}function Qt(){return Je(Ot).parallel(38.58).scale(195.044)}function tr(Re){var Ge=n(Re);function et(it,mt){return[it*Ge,(1+Ge)*m(mt/2)]}return et.invert=function(it,mt){return[it/Ge,e(mt/(1+Ge))*2]},et}function qt(){return Je(tr).scale(124.75)}function lr(Re,Ge){var et=D(8/(3*s));return[et*Re*(1-T(Ge)/s),et*Ge]}lr.invert=function(Re,Ge){var et=D(8/(3*s)),it=Ge/et;return[Re/(et*(1-T(it)/s)),it]};function Wr(){return c.geoProjection(lr).scale(165.664)}function cn(Re,Ge){var et=D(4-3*h(T(Ge)));return[2/D(6*s)*Re*et,y(Ge)*D(2*s/3)*(2-et)]}cn.invert=function(Re,Ge){var et=2-T(Ge)/D(2*s/3);return[Re*D(6*s)/(2*et),y(Ge)*z((4-et*et)/3)]};function Jr(){return c.geoProjection(cn).scale(165.664)}function ot(Re,Ge){var et=D(s*(4+s));return[2/et*Re*(1+D(1-4*Ge*Ge/(s*s))),4/et*Ge]}ot.invert=function(Re,Ge){var et=D(s*(4+s))/2;return[Re*et/(1+D(1-Ge*Ge*(4+s)/(4*s))),Ge*et/2]};function Vt(){return c.geoProjection(ot).scale(180.739)}function jt(Re,Ge){var et=(2+A)*h(Ge);Ge/=2;for(var it=0,mt=1/0;it<10&&T(mt)>u;it++){var gt=n(Ge);Ge-=mt=(Ge+h(Ge)*(gt+2)-et)/(2*gt*(1+gt))}return[2/D(s*(4+s))*Re*(1+n(Ge)),2*D(s/(4+s))*h(Ge)]}jt.invert=function(Re,Ge){var et=Ge*D((4+s)/s)/2,it=z(et),mt=n(it);return[Re/(2/D(s*(4+s))*(1+mt)),z((it+et*(mt+2))/(2+A))]};function Ut(){return c.geoProjection(jt).scale(180.739)}function yr(Re,Ge){return[Re*(1+n(Ge))/D(2+s),2*Ge/D(2+s)]}yr.invert=function(Re,Ge){var et=D(2+s),it=Ge*et/2;return[et*Re/(1+n(it)),it]};function nt(){return c.geoProjection(yr).scale(173.044)}function _e(Re,Ge){for(var et=(1+A)*h(Ge),it=0,mt=1/0;it<10&&T(mt)>u;it++)Ge-=mt=(Ge+h(Ge)-et)/(1+n(Ge));return et=D(2+s),[Re*(1+n(Ge))/et,2*Ge/et]}_e.invert=function(Re,Ge){var et=1+A,it=D(et/2);return[Re*2*it/(1+n(Ge*=it)),z((Ge+h(Ge))/et)]};function Me(){return c.geoProjection(_e).scale(173.044)}var Ne=3+2*b;function We(Re,Ge){var et=h(Re/=2),it=n(Re),mt=D(n(Ge)),gt=n(Ge/=2),_t=h(Ge)/(gt+b*it*mt),ar=D(2/(1+_t*_t)),fr=D((b*gt+(it+et)*mt)/(b*gt+(it-et)*mt));return[Ne*(ar*(fr-1/fr)-2*f(fr)),Ne*(ar*_t*(fr+1/fr)-2*e(_t))]}We.invert=function(Re,Ge){if(!(gt=ie.invert(Re/1.2,Ge*1.065)))return null;var et=gt[0],it=gt[1],mt=20,gt;Re/=Ne,Ge/=Ne;do{var _t=et/2,ar=it/2,fr=h(_t),rr=n(_t),pr=h(ar),kr=n(ar),Hr=n(it),Qr=D(Hr),mn=pr/(kr+b*rr*Qr),Ln=mn*mn,Gn=D(2/(1+Ln)),ga=b*kr+(rr+fr)*Qr,xa=b*kr+(rr-fr)*Qr,ja=ga/xa,Wa=D(ja),qa=Wa-1/Wa,pi=Wa+1/Wa,oo=Gn*qa-2*f(Wa)-Re,ti=Gn*mn*pi-2*e(mn)-Ge,Yi=pr&&v*Qr*fr*Ln/pr,co=(b*rr*kr+Qr)/(2*(kr+b*rr*Qr)*(kr+b*rr*Qr)*Qr),wo=-.5*mn*Gn*Gn*Gn,wi=wo*Yi,ki=wo*co,cs=(cs=2*kr+b*Qr*(rr-fr))*cs*Wa,yo=(b*rr*kr*Qr+Hr)/cs,Do=-(b*fr*pr)/(Qr*cs),Yo=qa*wi-2*yo/Wa+Gn*(yo+yo/ja),ue=qa*ki-2*Do/Wa+Gn*(Do+Do/ja),be=mn*pi*wi-2*Yi/(1+Ln)+Gn*pi*Yi+Gn*mn*(yo-yo/ja),Ee=mn*pi*ki-2*co/(1+Ln)+Gn*pi*co+Gn*mn*(Do-Do/ja),Fe=ue*be-Ee*Yo;if(!Fe)break;var ze=(ti*ue-oo*Ee)/Fe,Ze=(oo*be-ti*Yo)/Fe;et-=ze,it=o(-A,i(A,it-Ze))}while((T(ze)>u||T(Ze)>u)&&--mt>0);return T(T(it)-A)<u?[0,it]:mt&&[et,it]};function Qe(){return c.geoProjection(We).scale(62.5271)}var rt=n(35*k);function $e(Re,Ge){var et=m(Ge/2);return[Re*rt*D(1-et*et),(1+rt)*et]}$e.invert=function(Re,Ge){var et=Ge/(1+rt);return[Re&&Re/(rt*D(1-et*et)),2*e(et)]};function ht(){return c.geoProjection($e).scale(137.152)}function xt(Re,Ge){var et=Ge/2,it=n(et);return[2*Re/l*n(Ge)*it*it,l*m(et)]}xt.invert=function(Re,Ge){var et=e(Ge/l),it=n(et),mt=2*et;return[Re*l/2/(n(mt)*it*it),mt]};function kt(){return c.geoProjection(xt).scale(135.264)}function Wt(Re){var Ge=1-Re,et=gt(s,0)[0]-gt(-s,0)[0],it=gt(0,A)[1]-gt(0,-A)[1],mt=D(2*it/et);function gt(fr,rr){var pr=n(rr),kr=h(rr);return[pr/(Ge+Re*pr)*fr,Ge*rr+Re*kr]}function _t(fr,rr){var pr=gt(fr,rr);return[pr[0]*mt,pr[1]/mt]}function ar(fr){return _t(0,fr)[1]}return _t.invert=function(fr,rr){var pr=ye(ar,rr),kr=fr/mt*(Re+Ge/n(pr));return[kr,pr]},_t}function Ft(){var Re=.5,Ge=c.geoProjectionMutator(Wt),et=Ge(Re);return et.alpha=function(it){return arguments.length?Ge(Re=+it):Re},et.scale(168.725)}function ir(Re){return[Re[0]/2,z(m(Re[1]/2*k))*S]}function hr(Re){return[Re[0]*2,2*e(h(Re[1]*k))*S]}function _r(Re){Re==null&&(Re=c.geoOrthographic);var Ge=Re(),et=c.geoEquirectangular().scale(S).precision(0).clipAngle(null).translate([0,0]);function it(gt){return Ge(ir(gt))}Ge.invert&&(it.invert=function(gt){return hr(Ge.invert(gt))}),it.stream=function(gt){var _t=Ge.stream(gt),ar=et.stream({point:function(fr,rr){_t.point(fr/2,z(m(-rr/2*k))*S)},lineStart:function(){_t.lineStart()},lineEnd:function(){_t.lineEnd()},polygonStart:function(){_t.polygonStart()},polygonEnd:function(){_t.polygonEnd()}});return ar.sphere=_t.sphere,ar};function mt(gt){it[gt]=function(){return arguments.length?(Ge[gt].apply(Ge,arguments),it):Ge[gt]()}}return it.rotate=function(gt){return arguments.length?(et.rotate(gt),it):et.rotate()},it.center=function(gt){return arguments.length?(Ge.center(ir(gt)),it):hr(Ge.center())},mt("angle"),mt("clipAngle"),mt("clipExtent"),mt("fitExtent"),mt("fitHeight"),mt("fitSize"),mt("fitWidth"),mt("scale"),mt("translate"),mt("precision"),it.scale(249.5)}function an(Re,Ge){var et=2*s/Ge,it=Re*Re;function mt(gt,_t){var ar=c.geoAzimuthalEquidistantRaw(gt,_t),fr=ar[0],rr=ar[1],pr=fr*fr+rr*rr;if(pr>it){var kr=D(pr),Hr=a(rr,fr),Qr=et*p(Hr/et),mn=Hr-Qr,Ln=Re*n(mn),Gn=(Re*h(mn)-mn*h(Ln))/(A-Ln),ga=Rr(mn,Gn),xa=(s-Re)/Vr(ga,Ln,s);fr=kr;var ja=50,Wa;do fr-=Wa=(Re+Vr(ga,Ln,fr)*xa-kr)/(ga(fr)*xa);while(T(Wa)>u&&--ja>0);rr=mn*h(fr),fr<A&&(rr-=Gn*(fr-A));var qa=h(Qr),pi=n(Qr);ar[0]=fr*pi-rr*qa,ar[1]=fr*qa+rr*pi}return ar}return mt.invert=function(gt,_t){var ar=gt*gt+_t*_t;if(ar>it){var fr=D(ar),rr=a(_t,gt),pr=et*p(rr/et),kr=rr-pr;gt=fr*n(kr),_t=fr*h(kr);for(var Hr=gt-A,Qr=h(gt),mn=_t/Qr,Ln=gt<A?1/0:0,Gn=10;;){var ga=Re*h(mn),xa=Re*n(mn),ja=h(xa),Wa=A-xa,qa=(ga-mn*ja)/Wa,pi=Rr(mn,qa);if(T(Ln)<_||!--Gn)break;mn-=Ln=(mn*Qr-qa*Hr-_t)/(Qr-Hr*2*(Wa*(xa+mn*ga*n(xa)-ja)-ga*(ga-mn*ja))/(Wa*Wa))}fr=Re+Vr(pi,xa,gt)*(s-Re)/Vr(pi,xa,s),rr=pr+mn,gt=fr*n(rr),_t=fr*h(rr)}return c.geoAzimuthalEquidistantRaw.invert(gt,_t)},mt}function Rr(Re,Ge){return function(et){var it=Re*n(et);return et<A&&(it-=Ge),D(1+it*it)}}function Vr(Re,Ge,et){for(var it=50,mt=(et-Ge)/it,gt=Re(Ge)+Re(et),_t=1,ar=Ge;_t<it;++_t)gt+=2*Re(ar+=mt);return gt*.5*mt}function fn(){var Re=6,Ge=30*k,et=n(Ge),it=h(Ge),mt=c.geoProjectionMutator(an),gt=mt(Ge,Re),_t=gt.stream,ar=.01,fr=-n(ar*k),rr=h(ar*k);return gt.radius=function(pr){return arguments.length?(et=n(Ge=pr*k),it=h(Ge),mt(Ge,Re)):Ge*S},gt.lobes=function(pr){return arguments.length?mt(Ge,Re=+pr):Re},gt.stream=function(pr){var kr=gt.rotate(),Hr=_t(pr),Qr=(gt.rotate([0,0]),_t(pr));return gt.rotate(kr),Hr.sphere=function(){Qr.polygonStart(),Qr.lineStart();for(var mn=0,Ln=2*s/Re,Gn=0;mn<Re;++mn,Gn-=Ln)Qr.point(a(rr*n(Gn),fr)*S,z(rr*h(Gn))*S),Qr.point(a(it*n(Gn-Ln/2),et)*S,z(it*h(Gn-Ln/2))*S);Qr.lineEnd(),Qr.polygonEnd()},Hr},gt.rotate([90,-40]).scale(91.7095).clipAngle(180-.001)}function xr(Re,Ge,et,it,mt,gt,_t,ar){arguments.length<8&&(ar=0);function fr(rr,pr){if(!pr)return[Re*rr/s,0];var kr=pr*pr,Hr=Re+kr*(Ge+kr*(et+kr*it)),Qr=pr*(mt-1+kr*(gt-ar+kr*_t)),mn=(Hr*Hr+Qr*Qr)/(2*Qr),Ln=rr*z(Hr/mn)/s;return[mn*h(Ln),pr*(1+kr*ar)+mn*(1-n(Ln))]}return fr.invert=function(rr,pr){var kr=s*rr/Re,Hr=pr,Qr,mn,Ln=50;do{var Gn=Hr*Hr,ga=Re+Gn*(Ge+Gn*(et+Gn*it)),xa=Hr*(mt-1+Gn*(gt-ar+Gn*_t)),ja=ga*ga+xa*xa,Wa=2*xa,qa=ja/Wa,pi=qa*qa,oo=z(ga/qa)/s,ti=kr*oo,Yi=ga*ga,co=(2*Ge+Gn*(4*et+Gn*6*it))*Hr,wo=mt+Gn*(3*gt+Gn*5*_t),wi=2*(ga*co+xa*(wo-1)),ki=2*(wo-1),cs=(wi*Wa-ja*ki)/(Wa*Wa),yo=n(ti),Do=h(ti),Yo=qa*yo,ue=qa*Do,be=kr/s*(1/D(1-Yi/pi))*(co*qa-ga*cs)/pi,Ee=ue-rr,Fe=Hr*(1+Gn*ar)+qa-Yo-pr,ze=cs*Do+Yo*be,Ze=Yo*oo,yt=1+cs-(cs*yo-ue*be),ft=ue*oo,St=ze*ft-yt*Ze;if(!St)break;kr-=Qr=(Fe*ze-Ee*yt)/St,Hr-=mn=(Ee*ft-Fe*Ze)/St}while((T(Qr)>u||T(mn)>u)&&--Ln>0);return[kr,Hr]},fr}var mr=xr(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);function Fr(){return c.geoProjection(mr).scale(149.995)}var Ir=xr(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);function Sr(){return c.geoProjection(Ir).scale(153.93)}var tt=xr(5/6*s,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Ct(){return c.geoProjection(tt).scale(130.945)}function Zt(Re,Ge){var et=Re*Re,it=Ge*Ge;return[Re*(1-.162388*it)*(.87-952426e-9*et*et),Ge*(1+it/12)]}Zt.invert=function(Re,Ge){var et=Re,it=Ge,mt=50,gt;do{var _t=it*it;it-=gt=(it*(1+_t/12)-Ge)/(1+_t/4)}while(T(gt)>u&&--mt>0);mt=50,Re/=1-.162388*_t;do{var ar=(ar=et*et)*ar;et-=gt=(et*(.87-952426e-9*ar)-Re)/(.87-.00476213*ar)}while(T(gt)>u&&--mt>0);return[et,it]};function ur(){return c.geoProjection(Zt).scale(131.747)}var Lr=xr(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Br(){return c.geoProjection(Lr).scale(131.087)}function Pr(Re){var Ge=Re(A,0)[0]-Re(-A,0)[0];function et(it,mt){var gt=it>0?-.5:.5,_t=Re(it+gt*s,mt);return _t[0]-=gt*Ge,_t}return Re.invert&&(et.invert=function(it,mt){var gt=it>0?-.5:.5,_t=Re.invert(it+gt*Ge,mt),ar=_t[0]-gt*s;return ar<-s?ar+=2*s:ar>s&&(ar-=2*s),_t[0]=ar,_t}),et}function Tr(Re,Ge){var et=y(Re),it=y(Ge),mt=n(Ge),gt=n(Re)*mt,_t=h(Re)*mt,ar=h(it*Ge);Re=T(a(_t,ar)),Ge=z(gt),T(Re-A)>u&&(Re%=A);var fr=jr(Re>s/4?A-Re:Re,Ge);return Re>s/4&&(ar=fr[0],fr[0]=-fr[1],fr[1]=-ar),fr[0]*=et,fr[1]*=-it,fr}Tr.invert=function(Re,Ge){T(Re)>1&&(Re=y(Re)*2-Re),T(Ge)>1&&(Ge=y(Ge)*2-Ge);var et=y(Re),it=y(Ge),mt=-et*Re,gt=-it*Ge,_t=gt/mt<1,ar=Pn(_t?gt:mt,_t?mt:gt),fr=ar[0],rr=ar[1],pr=n(rr);return _t&&(fr=-A-fr),[et*(a(h(fr)*pr,-h(rr))+s),it*z(n(fr)*pr)]};function jr(Re,Ge){if(Ge===A)return[0,0];var et=h(Ge),it=et*et,mt=it*it,gt=1+mt,_t=1+3*mt,ar=1-mt,fr=z(1/D(gt)),rr=ar+it*gt*fr,pr=(1-et)/rr,kr=D(pr),Hr=pr*gt,Qr=D(Hr),mn=kr*ar,Ln,Gn;if(Re===0)return[0,-(mn+it*Qr)];var ga=n(Ge),xa=1/ga,ja=2*et*ga,Wa=(-3*it+fr*_t)*ja,qa=(-rr*ga-(1-et)*Wa)/(rr*rr),pi=.5*qa/kr,oo=ar*pi-2*it*kr*ja,ti=it*gt*qa+pr*_t*ja,Yi=-xa*ja,co=-xa*ti,wo=-2*xa*oo,wi=4*Re/s,ki;if(Re>.222*s||Ge<s/4&&Re>.175*s){if(Ln=(mn+it*D(Hr*(1+mt)-mn*mn))/(1+mt),Re>s/4)return[Ln,Ln];var cs=Ln,yo=.5*Ln;Ln=.5*(yo+cs),Gn=50;do{var Do=D(Hr-Ln*Ln),Yo=Ln*(wo+Yi*Do)+co*z(Ln/Qr)-wi;if(!Yo)break;Yo<0?yo=Ln:cs=Ln,Ln=.5*(yo+cs)}while(T(cs-yo)>u&&--Gn>0)}else{Ln=u,Gn=25;do{var ue=Ln*Ln,be=D(Hr-ue),Ee=wo+Yi*be,Fe=Ln*Ee+co*z(Ln/Qr)-wi,ze=Ee+(co-Yi*ue)/be;Ln-=ki=be?Fe/ze:0}while(T(ki)>u&&--Gn>0)}return[Ln,-mn-it*D(Hr-Ln*Ln)]}function Pn(Re,Ge){for(var et=0,it=1,mt=.5,gt=50;;){var _t=mt*mt,ar=D(mt),fr=z(1/D(1+_t)),rr=1-_t+mt*(1+_t)*fr,pr=(1-ar)/rr,kr=D(pr),Hr=pr*(1+_t),Qr=kr*(1-_t),mn=Hr-Re*Re,Ln=D(mn),Gn=Ge+Qr+mt*Ln;if(T(it-et)<_||--gt===0||Gn===0)break;Gn>0?et=mt:it=mt,mt=.5*(et+it)}if(!gt)return null;var ga=z(ar),xa=n(ga),ja=1/xa,Wa=2*ar*xa,qa=(-3*mt+fr*(1+3*_t))*Wa,pi=(-rr*xa-(1-ar)*qa)/(rr*rr),oo=.5*pi/kr,ti=(1-_t)*oo-2*mt*kr*Wa,Yi=-2*ja*ti,co=-ja*Wa,wo=-ja*(mt*(1+_t)*pi+pr*(1+3*_t)*Wa);return[s/4*(Re*(Yi+co*Ln)+wo*z(Re/D(Hr))),ga]}function An(){return c.geoProjection(Pr(Tr)).scale(239.75)}function $n(Re,Ge,et){var it,mt,gt;return Re?(it=zn(Re,et),Ge?(mt=zn(Ge,1-et),gt=mt[1]*mt[1]+et*it[0]*it[0]*mt[0]*mt[0],[[it[0]*mt[2]/gt,it[1]*it[2]*mt[0]*mt[1]/gt],[it[1]*mt[1]/gt,-it[0]*it[2]*mt[0]*mt[2]/gt],[it[2]*mt[1]*mt[2]/gt,-et*it[0]*it[1]*mt[0]/gt]]):[[it[0],0],[it[1],0],[it[2],0]]):(mt=zn(Ge,1-et),[[0,mt[0]/mt[1]],[1/mt[1],0],[mt[2]/mt[1],0]])}function zn(Re,Ge){var et,it,mt,gt,_t;if(Ge<u)return gt=h(Re),it=n(Re),et=Ge*(Re-gt*it)/4,[gt-et*it,it+et*gt,1-Ge*gt*gt/2,Re-et];if(Ge>=1-u)return et=(1-Ge)/4,it=F(Re),gt=R(Re),mt=1/it,_t=it*B(Re),[gt+et*(_t-Re)/(it*it),mt-et*gt*mt*(_t-Re),mt+et*gt*mt*(_t+Re),2*e(r(Re))-A+et*(_t-Re)/it];var ar=[1,0,0,0,0,0,0,0,0],fr=[D(Ge),0,0,0,0,0,0,0,0],rr=0;for(it=D(1-Ge),_t=1;T(fr[rr]/ar[rr])>u&&rr<8;)et=ar[rr++],fr[rr]=(et-it)/2,ar[rr]=(et+it)/2,it=D(et*it),_t*=2;mt=_t*ar[rr]*Re;do gt=fr[rr]*h(it=mt)/ar[rr],mt=(z(gt)+mt)/2;while(--rr);return[h(mt),gt=n(mt),gt/n(mt-it),mt]}function Yn(Re,Ge,et){var it=T(Re),mt=T(Ge),gt=B(mt);if(it){var _t=1/h(it),ar=1/(m(it)*m(it)),fr=-(ar+et*(gt*gt*_t*_t)-1+et),rr=(et-1)*ar,pr=(-fr+D(fr*fr-4*rr))/2;return[Kn(e(1/D(pr)),et)*y(Re),Kn(e(D((pr/ar-1)/et)),1-et)*y(Ge)]}return[0,Kn(e(gt),1-et)*y(Ge)]}function Kn(Re,Ge){if(!Ge)return Re;if(Ge===1)return f(m(Re/2+x));for(var et=1,it=D(1-Ge),mt=D(Ge),gt=0;T(mt)>u;gt++){if(Re%s){var _t=e(it*m(Re)/et);_t<0&&(_t+=s),Re+=_t+~~(Re/s)*s}else Re+=Re;mt=(et+it)/2,it=D(et*it),mt=((et=mt)-it)/2}return Re/(g(2,gt)*et)}function Aa(Re,Ge){var et=(b-1)/(b+1),it=D(1-et*et),mt=Kn(A,it*it),gt=-1,_t=f(m(s/4+T(Ge)/2)),ar=r(gt*_t)/D(et),fr=Ua(ar*n(gt*Re),ar*h(gt*Re)),rr=Yn(fr[0],fr[1],it*it);return[-rr[1],(Ge>=0?1:-1)*(.5*mt-rr[0])]}function Ua(Re,Ge){var et=Re*Re,it=Ge+1,mt=1-et-Ge*Ge;return[.5*((Re>=0?A:-A)-a(mt,2*Re)),-.25*f(mt*mt+4*et)+.5*f(it*it+et)]}function vi(Re,Ge){var et=Ge[0]*Ge[0]+Ge[1]*Ge[1];return[(Re[0]*Ge[0]+Re[1]*Ge[1])/et,(Re[1]*Ge[0]-Re[0]*Ge[1])/et]}Aa.invert=function(Re,Ge){var et=(b-1)/(b+1),it=D(1-et*et),mt=Kn(A,it*it),gt=-1,_t=$n(.5*mt-Ge,-Re,it*it),ar=vi(_t[0],_t[1]),fr=a(ar[1],ar[0])/gt;return[fr,2*e(r(.5/gt*f(et*ar[0]*ar[0]+et*ar[1]*ar[1])))-A]};function ci(){return c.geoProjection(Pr(Aa)).scale(151.496)}function ui(Re){var Ge=h(Re),et=n(Re),it=Ga(Re);it.invert=Ga(-Re);function mt(gt,_t){var ar=it(gt,_t);gt=ar[0],_t=ar[1];var fr=h(_t),rr=n(_t),pr=n(gt),kr=I(Ge*fr+et*rr*pr),Hr=h(kr),Qr=T(Hr)>u?kr/Hr:1;return[Qr*et*h(gt),(T(gt)>A?Qr:-Qr)*(Ge*rr-et*fr*pr)]}return mt.invert=function(gt,_t){var ar=D(gt*gt+_t*_t),fr=-h(ar),rr=n(ar),pr=ar*rr,kr=-_t*fr,Hr=ar*Ge,Qr=D(pr*pr+kr*kr-Hr*Hr),mn=a(pr*Hr+kr*Qr,kr*Hr-pr*Qr),Ln=(ar>A?-1:1)*a(gt*fr,ar*n(mn)*rr+_t*h(mn)*fr);return it.invert(Ln,mn)},mt}function Ga(Re){var Ge=h(Re),et=n(Re);return function(it,mt){var gt=n(mt),_t=n(it)*gt,ar=h(it)*gt,fr=h(mt);return[a(ar,_t*et-fr*Ge),z(fr*et+_t*Ge)]}}function wr(){var Re=0,Ge=c.geoProjectionMutator(ui),et=Ge(Re),it=et.rotate,mt=et.stream,gt=c.geoCircle();return et.parallel=function(_t){if(!arguments.length)return Re*S;var ar=et.rotate();return Ge(Re=_t*k).rotate(ar)},et.rotate=function(_t){return arguments.length?(it.call(et,[_t[0],_t[1]-Re*S]),gt.center([-_t[0],-_t[1]]),et):(_t=it.call(et),_t[1]+=Re*S,_t)},et.stream=function(_t){return _t=mt(_t),_t.sphere=function(){_t.polygonStart();var ar=.01,fr=gt.radius(90-ar)().coordinates[0],rr=fr.length-1,pr=-1,kr;for(_t.lineStart();++pr<rr;)_t.point((kr=fr[pr])[0],kr[1]);for(_t.lineEnd(),fr=gt.radius(90+ar)().coordinates[0],rr=fr.length-1,_t.lineStart();--pr>=0;)_t.point((kr=fr[pr])[0],kr[1]);_t.lineEnd(),_t.polygonEnd()},_t},et.scale(79.4187).parallel(45).clipAngle(180-.001)}var vn=3,on=z(1-1/vn)*S,_n=Ot(0);function Bn(Re){var Ge=on*k,et=Ye(s,Ge)[0]-Ye(-s,Ge)[0],it=_n(0,Ge)[1],mt=Ye(0,Ge)[1],gt=l-mt,_t=L/Re,ar=4/L,fr=it+gt*gt*4/L;function rr(pr,kr){var Hr,Qr=T(kr);if(Qr>Ge){var mn=i(Re-1,o(0,t((pr+s)/_t)));pr+=s*(Re-1)/Re-mn*_t,Hr=Ye(pr,Qr),Hr[0]=Hr[0]*L/et-L*(Re-1)/(2*Re)+mn*L/Re,Hr[1]=it+(Hr[1]-mt)*4*gt/L,kr<0&&(Hr[1]=-Hr[1])}else Hr=_n(pr,kr);return Hr[0]*=ar,Hr[1]/=fr,Hr}return rr.invert=function(pr,kr){pr/=ar,kr*=fr;var Hr=T(kr);if(Hr>it){var Qr=i(Re-1,o(0,t((pr+s)/_t)));pr=(pr+s*(Re-1)/Re-Qr*_t)*et/L;var mn=Ye.invert(pr,.25*(Hr-it)*L/gt+mt);return mn[0]-=s*(Re-1)/Re-Qr*_t,kr<0&&(mn[1]=-mn[1]),mn}return _n.invert(pr,kr)},rr}function sa(Re,Ge){return[Re,Ge&1?90-u:on]}function ra(Re,Ge){return[Re,Ge&1?-90+u:-on]}function In(Re){return[Re[0]*(1-u),Re[1]]}function ea(Re){var Ge=[].concat(M.range(-180,180+Re/2,Re).map(sa),M.range(180,-180-Re/2,-Re).map(ra));return{type:"Polygon",coordinates:[Re===180?Ge.map(In):Ge]}}function Va(){var Re=4,Ge=c.geoProjectionMutator(Bn),et=Ge(Re),it=et.stream;return et.lobes=function(mt){return arguments.length?Ge(Re=+mt):Re},et.stream=function(mt){var gt=et.rotate(),_t=it(mt),ar=(et.rotate([0,0]),it(mt));return et.rotate(gt),_t.sphere=function(){c.geoStream(ea(180/Re),ar)},_t},et.scale(239.75)}function hi(Re){var Ge=1+Re,et=h(1/Ge),it=z(et),mt=2*D(s/(gt=s+4*it*Ge)),gt,_t=.5*mt*(Ge+D(Re*(2+Re))),ar=Re*Re,fr=Ge*Ge;function rr(pr,kr){var Hr=1-h(kr),Qr,mn;if(Hr&&Hr<2){var Ln=A-kr,Gn=25,ga;do{var xa=h(Ln),ja=n(Ln),Wa=it+a(xa,Ge-ja),qa=1+fr-2*Ge*ja;Ln-=ga=(Ln-ar*it-Ge*xa+qa*Wa-.5*Hr*gt)/(2*Ge*xa*Wa)}while(T(ga)>_&&--Gn>0);Qr=mt*D(qa),mn=pr*Wa/s}else Qr=mt*(Re+Hr),mn=pr*it/s;return[Qr*h(mn),_t-Qr*n(mn)]}return rr.invert=function(pr,kr){var Hr=pr*pr+(kr-=_t)*kr,Qr=(1+fr-Hr/(mt*mt))/(2*Ge),mn=I(Qr),Ln=h(mn),Gn=it+a(Ln,Ge-Qr);return[z(pr/D(Hr))*s/Gn,z(1-2*(mn-ar*it-Ge*Ln+(1+fr-2*Ge*Qr)*Gn)/gt)]},rr}function It(){var Re=1,Ge=c.geoProjectionMutator(hi),et=Ge(Re);return et.ratio=function(it){return arguments.length?Ge(Re=+it):Re},et.scale(167.774).center([0,18.67])}var vr=.7109889596207567,rn=.0528035274542;function hn(Re,Ge){return Ge>-vr?(Re=De(Re,Ge),Re[1]+=rn,Re):Oe(Re,Ge)}hn.invert=function(Re,Ge){return Ge>-vr?De.invert(Re,Ge-rn):Oe.invert(Re,Ge)};function un(){return c.geoProjection(hn).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}function kn(Re,Ge){return T(Ge)>vr?(Re=De(Re,Ge),Re[1]-=Ge>0?rn:-rn,Re):Oe(Re,Ge)}kn.invert=function(Re,Ge){return T(Ge)>vr?De.invert(Re,Ge+(Ge>0?rn:-rn)):Oe.invert(Re,Ge)};function bn(){return c.geoProjection(kn).scale(152.63)}function ln(Re,Ge,et,it){var mt=D(4*s/(2*et+(1+Re-Ge/2)*h(2*et)+(Re+Ge)/2*h(4*et)+Ge/2*h(6*et))),gt=D(it*h(et)*D((1+Re*n(2*et)+Ge*n(4*et))/(1+Re+Ge))),_t=et*fr(1);function ar(kr){return D(1+Re*n(2*kr)+Ge*n(4*kr))}function fr(kr){var Hr=kr*et;return(2*Hr+(1+Re-Ge/2)*h(2*Hr)+(Re+Ge)/2*h(4*Hr)+Ge/2*h(6*Hr))/et}function rr(kr){return ar(kr)*h(kr)}var pr=function(kr,Hr){var Qr=et*ye(fr,_t*h(Hr)/et,Hr/s);isNaN(Qr)&&(Qr=et*y(Hr));var mn=mt*ar(Qr);return[mn*gt*kr/s*n(Qr),mn/gt*h(Qr)]};return pr.invert=function(kr,Hr){var Qr=ye(rr,Hr*gt/mt);return[kr*s/(n(Qr)*mt*gt*ar(Qr)),z(et*fr(Qr/et)/_t)]},et===0&&(mt=D(it/s),pr=function(kr,Hr){return[kr*mt,h(Hr)/mt]},pr.invert=function(kr,Hr){return[kr/mt,z(Hr*mt)]}),pr}function gr(){var Re=1,Ge=0,et=45*k,it=2,mt=c.geoProjectionMutator(ln),gt=mt(Re,Ge,et,it);return gt.a=function(_t){return arguments.length?mt(Re=+_t,Ge,et,it):Re},gt.b=function(_t){return arguments.length?mt(Re,Ge=+_t,et,it):Ge},gt.psiMax=function(_t){return arguments.length?mt(Re,Ge,et=+_t*k,it):et*S},gt.ratio=function(_t){return arguments.length?mt(Re,Ge,et,it=+_t):it},gt.scale(180.739)}function dr(Re,Ge,et,it,mt,gt,_t,ar,fr,rr,pr){if(pr.nanEncountered)return NaN;var kr,Hr,Qr,mn,Ln,Gn,ga,xa,ja,Wa;if(kr=et-Ge,Hr=Re(Ge+kr*.25),Qr=Re(et-kr*.25),isNaN(Hr)){pr.nanEncountered=!0;return}if(isNaN(Qr)){pr.nanEncountered=!0;return}return mn=kr*(it+4*Hr+mt)/12,Ln=kr*(mt+4*Qr+gt)/12,Gn=mn+Ln,Wa=(Gn-_t)/15,rr>fr?(pr.maxDepthCount++,Gn+Wa):Math.abs(Wa)<ar?Gn+Wa:(ga=Ge+kr*.5,xa=dr(Re,Ge,ga,it,Hr,mt,mn,ar*.5,fr,rr+1,pr),isNaN(xa)?(pr.nanEncountered=!0,NaN):(ja=dr(Re,ga,et,mt,Qr,gt,Ln,ar*.5,fr,rr+1,pr),isNaN(ja)?(pr.nanEncountered=!0,NaN):xa+ja))}function Cr(Re,Ge,et,it,mt){var gt={maxDepthCount:0,nanEncountered:!1};it===void 0&&(it=1e-8),mt===void 0&&(mt=20);var _t=Re(Ge),ar=Re(.5*(Ge+et)),fr=Re(et),rr=(_t+4*ar+fr)*(et-Ge)/6,pr=dr(Re,Ge,et,_t,ar,fr,rr,it,mt,1,gt);return pr}function dn(Re,Ge,et){function it(Qr){return Re+(1-Re)*g(1-g(Qr,Ge),1/Ge)}function mt(Qr){return Cr(it,0,Qr,1e-4)}for(var gt=1/mt(1),_t=1e3,ar=(1+1e-8)*gt,fr=[],rr=0;rr<=_t;rr++)fr.push(mt(rr/_t)*ar);function pr(Qr){var mn=0,Ln=_t,Gn=_t>>1;do fr[Gn]>Qr?Ln=Gn:mn=Gn,Gn=mn+Ln>>1;while(Gn>mn);var ga=fr[Gn+1]-fr[Gn];return ga&&(ga=(Qr-fr[Gn+1])/ga),(Gn+1+ga)/_t}var kr=2*pr(1)/s*gt/et,Hr=function(Qr,mn){var Ln=pr(T(h(mn))),Gn=it(Ln)*Qr;return Ln/=kr,[Gn,mn>=0?Ln:-Ln]};return Hr.invert=function(Qr,mn){var Ln;return mn*=kr,T(mn)<1&&(Ln=y(mn)*z(mt(T(mn))*gt)),[Qr/it(T(mn)),Ln]},Hr}function On(){var Re=0,Ge=2.5,et=1.183136,it=c.geoProjectionMutator(dn),mt=it(Re,Ge,et);return mt.alpha=function(gt){return arguments.length?it(Re=+gt,Ge,et):Re},mt.k=function(gt){return arguments.length?it(Re,Ge=+gt,et):Ge},mt.gamma=function(gt){return arguments.length?it(Re,Ge,et=+gt):et},mt.scale(152.63)}function qn(Re,Ge){return T(Re[0]-Ge[0])<u&&T(Re[1]-Ge[1])<u}function xn(Re,Ge){for(var et=-1,it=Re.length,mt=Re[0],gt,_t,ar,fr=[];++et<it;){gt=Re[et],_t=(gt[0]-mt[0])/Ge,ar=(gt[1]-mt[1])/Ge;for(var rr=0;rr<Ge;++rr)fr.push([mt[0]+rr*_t,mt[1]+rr*ar]);mt=gt}return fr.push(gt),fr}function Wn(Re){var Ge=[],et,it,mt,gt,_t,ar,fr,rr=Re[0].length;for(fr=0;fr<rr;++fr)et=Re[0][fr],it=et[0][0],mt=et[0][1],gt=et[1][1],_t=et[2][0],ar=et[2][1],Ge.push(xn([[it+u,mt+u],[it+u,gt-u],[_t-u,gt-u],[_t-u,ar+u]],30));for(fr=Re[1].length-1;fr>=0;--fr)et=Re[1][fr],it=et[0][0],mt=et[0][1],gt=et[1][1],_t=et[2][0],ar=et[2][1],Ge.push(xn([[_t-u,ar-u],[_t-u,gt+u],[it+u,gt+u],[it+u,mt-u]],30));return{type:"Polygon",coordinates:[M.merge(Ge)]}}function aa(Re,Ge,et){var it,mt;function gt(fr,rr){for(var pr=rr<0?-1:1,kr=Ge[+(rr<0)],Hr=0,Qr=kr.length-1;Hr<Qr&&fr>kr[Hr][2][0];++Hr);var mn=Re(fr-kr[Hr][1][0],rr);return mn[0]+=Re(kr[Hr][1][0],pr*rr>pr*kr[Hr][0][1]?kr[Hr][0][1]:rr)[0],mn}et?gt.invert=et(gt):Re.invert&&(gt.invert=function(fr,rr){for(var pr=mt[+(rr<0)],kr=Ge[+(rr<0)],Hr=0,Qr=pr.length;Hr<Qr;++Hr){var mn=pr[Hr];if(mn[0][0]<=fr&&fr<mn[1][0]&&mn[0][1]<=rr&&rr<mn[1][1]){var Ln=Re.invert(fr-Re(kr[Hr][1][0],0)[0],rr);return Ln[0]+=kr[Hr][1][0],qn(gt(Ln[0],Ln[1]),[fr,rr])?Ln:null}}});var _t=c.geoProjection(gt),ar=_t.stream;return _t.stream=function(fr){var rr=_t.rotate(),pr=ar(fr),kr=(_t.rotate([0,0]),ar(fr));return _t.rotate(rr),pr.sphere=function(){c.geoStream(it,kr)},pr},_t.lobes=function(fr){return arguments.length?(it=Wn(fr),Ge=fr.map(function(rr){return rr.map(function(pr){return[[pr[0][0]*k,pr[0][1]*k],[pr[1][0]*k,pr[1][1]*k],[pr[2][0]*k,pr[2][1]*k]]})}),mt=Ge.map(function(rr){return rr.map(function(pr){var kr=Re(pr[0][0],pr[0][1])[0],Hr=Re(pr[2][0],pr[2][1])[0],Qr=Re(pr[1][0],pr[0][1])[1],mn=Re(pr[1][0],pr[1][1])[1],Ln;return Qr>mn&&(Ln=Qr,Qr=mn,mn=Ln),[[kr,Qr],[Hr,mn]]})}),_t):Ge.map(function(rr){return rr.map(function(pr){return[[pr[0][0]*S,pr[0][1]*S],[pr[1][0]*S,pr[1][1]*S],[pr[2][0]*S,pr[2][1]*S]]})})},Ge!=null&&_t.lobes(Ge),_t}var da=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function ma(){return aa(Le,da).scale(160.857)}var la=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function Ma(){return aa(kn,la).scale(152.63)}var po=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function zo(){return aa(De,po).scale(169.529)}var Ko=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function nl(){return aa(De,Ko).scale(169.529).rotate([20,0])}var pl=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]];function Yl(){return aa(hn,pl,fe).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}var di=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Gs(){return aa(Oe,di).scale(152.63).rotate([-20,0])}function Rs(Re,Ge){return[3/L*Re*D(s*s/3-Ge*Ge),Ge]}Rs.invert=function(Re,Ge){return[L/3*Re/D(s*s/3-Ge*Ge),Ge]};function Hi(){return c.geoProjection(Rs).scale(158.837)}function So(Re){function Ge(et,it){if(T(T(it)-A)<u)return[0,it<0?-2:2];var mt=h(it),gt=g((1+mt)/(1-mt),Re/2),_t=.5*(gt+1/gt)+n(et*=Re);return[2*h(et)/_t,(gt-1/gt)/_t]}return Ge.invert=function(et,it){var mt=T(it);if(T(mt-2)<u)return et?null:[0,y(it)*A];if(mt>2)return null;et/=2,it/=2;var gt=et*et,_t=it*it,ar=2*it/(1+gt+_t);return ar=g((1+ar)/(1-ar),1/Re),[a(2*et,1-gt-_t)/Re,z((ar-1)/(ar+1))]},Ge}function dl(){var Re=.5,Ge=c.geoProjectionMutator(So),et=Ge(Re);return et.spacing=function(it){return arguments.length?Ge(Re=+it):Re},et.scale(124.75)}var ps=s/b;function Ii(Re,Ge){return[Re*(1+D(n(Ge)))/2,Ge/(n(Ge/2)*n(Re/6))]}Ii.invert=function(Re,Ge){var et=T(Re),it=T(Ge),mt=u,gt=A;it<ps?gt*=it/ps:mt+=6*I(ps/it);for(var _t=0;_t<25;_t++){var ar=h(gt),fr=D(n(gt)),rr=h(gt/2),pr=n(gt/2),kr=h(mt/6),Hr=n(mt/6),Qr=.5*mt*(1+fr)-et,mn=gt/(pr*Hr)-it,Ln=fr?-.25*mt*ar/fr:0,Gn=.5*(1+fr),ga=(1+.5*gt*rr/pr)/(pr*Hr),xa=gt/pr*(kr/6)/(Hr*Hr),ja=Ln*xa-ga*Gn,Wa=(Qr*xa-mn*Gn)/ja,qa=(mn*Ln-Qr*ga)/ja;if(gt-=Wa,mt-=qa,T(Wa)<u&&T(qa)<u)break}return[Re<0?-mt:mt,Ge<0?-gt:gt]};function al(){return c.geoProjection(Ii).scale(97.2672)}function Qi(Re,Ge){var et=Re*Re,it=Ge*Ge;return[Re*(.975534+it*(-.119161+et*-.0143059+it*-.0547009)),Ge*(1.00384+et*(.0802894+it*-.02855+et*199025e-9)+it*(.0998909+it*-.0491032))]}Qi.invert=function(Re,Ge){var et=y(Re)*s,it=Ge/2,mt=50;do{var gt=et*et,_t=it*it,ar=et*it,fr=et*(.975534+_t*(-.119161+gt*-.0143059+_t*-.0547009))-Re,rr=it*(1.00384+gt*(.0802894+_t*-.02855+gt*199025e-9)+_t*(.0998909+_t*-.0491032))-Ge,pr=.975534-_t*(.119161+3*gt*.0143059+_t*.0547009),kr=-ar*(2*.119161+4*.0547009*_t+2*.0143059*gt),Hr=ar*(2*.0802894+4*199025e-9*gt+2*-.02855*_t),Qr=1.00384+gt*(.0802894+199025e-9*gt)+_t*(3*(.0998909-.02855*gt)-5*.0491032*_t),mn=kr*Hr-Qr*pr,Ln=(rr*kr-fr*Qr)/mn,Gn=(fr*Hr-rr*pr)/mn;et-=Ln,it-=Gn}while((T(Ln)>u||T(Gn)>u)&&--mt>0);return mt&&[et,it]};function Bi(){return c.geoProjection(Qi).scale(139.98)}function io(Re,Ge){return[h(Re)/n(Ge),m(Ge)*n(Re)]}io.invert=function(Re,Ge){var et=Re*Re,it=Ge*Ge,mt=it+1,gt=et+mt,_t=Re?v*D((gt-D(gt*gt-4*et))/et):1/D(mt);return[z(Re*_t),y(Ge)*I(_t)]};function $i(){return c.geoProjection(io).scale(144.049).clipAngle(90-.001)}function rs(Re){var Ge=n(Re),et=m(x+Re/2);function it(mt,gt){var _t=gt-Re,ar=T(_t)<u?mt*Ge:T(ar=x+gt/2)<u||T(T(ar)-A)<u?0:mt*_t/f(m(ar)/et);return[ar,_t]}return it.invert=function(mt,gt){var _t,ar=gt+Re;return[T(gt)<u?mt/Ge:T(_t=x+ar/2)<u||T(T(_t)-A)<u?0:mt*f(m(_t)/et)/gt,ar]},it}function Ys(){return Je(rs).parallel(40).scale(158.837)}function au(Re,Ge){return[Re,1.25*f(m(x+.4*Ge))]}au.invert=function(Re,Ge){return[Re,2.5*e(r(.8*Ge))-.625*s]};function Jo(){return c.geoProjection(au).scale(108.318)}function iu(Re){var Ge=Re.length-1;function et(it,mt){for(var gt=n(mt),_t=2/(1+gt*n(it)),ar=_t*gt*h(it),fr=_t*h(mt),rr=Ge,pr=Re[rr],kr=pr[0],Hr=pr[1],Qr;--rr>=0;)pr=Re[rr],kr=pr[0]+ar*(Qr=kr)-fr*Hr,Hr=pr[1]+ar*Hr+fr*Qr;return kr=ar*(Qr=kr)-fr*Hr,Hr=ar*Hr+fr*Qr,[kr,Hr]}return et.invert=function(it,mt){var gt=20,_t=it,ar=mt;do{for(var fr=Ge,rr=Re[fr],pr=rr[0],kr=rr[1],Hr=0,Qr=0,mn;--fr>=0;)rr=Re[fr],Hr=pr+_t*(mn=Hr)-ar*Qr,Qr=kr+_t*Qr+ar*mn,pr=rr[0]+_t*(mn=pr)-ar*kr,kr=rr[1]+_t*kr+ar*mn;Hr=pr+_t*(mn=Hr)-ar*Qr,Qr=kr+_t*Qr+ar*mn,pr=_t*(mn=pr)-ar*kr-it,kr=_t*kr+ar*mn-mt;var Ln=Hr*Hr+Qr*Qr,Gn,ga;_t-=Gn=(pr*Hr+kr*Qr)/Ln,ar-=ga=(kr*Hr-pr*Qr)/Ln}while(T(Gn)+T(ga)>u*u&&--gt>0);if(gt){var xa=D(_t*_t+ar*ar),ja=2*e(xa*.5),Wa=h(ja);return[a(_t*Wa,xa*n(ja)),xa?z(ar*Wa/xa):0]}},et}var Is=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],ko=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],Mu=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],zs=[[.9245,0],[0,0],[.01943,0]],ws=[[.721316,0],[0,0],[-.00881625,-.00617325]];function Ll(){return Ts(Is,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)}function Su(){return Ts(ko,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])}function ku(){return Ts(Mu,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])}function Ws(){return Ts(zs,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)}function Pl(){return Ts(ws,[165,10]).scale(250).clipAngle(130).center([-165,-10])}function Ts(Re,Ge){var et=c.geoProjection(iu(Re)).rotate(Ge).clipAngle(90),it=c.geoRotation(Ge),mt=et.center;return delete et.rotate,et.center=function(gt){return arguments.length?mt(it(gt)):it.invert(mt())},et}var Wl=D(6),il=D(7);function Xl(Re,Ge){var et=z(7*h(Ge)/(3*Wl));return[Wl*Re*(2*n(2*et/3)-1)/il,9*h(et/3)/il]}Xl.invert=function(Re,Ge){var et=3*z(Ge*il/9);return[Re*il/(Wl*(2*n(2*et/3)-1)),z(h(et)*3*Wl/7)]};function ou(){return c.geoProjection(Xl).scale(164.859)}function Dl(Re,Ge){for(var et=(1+v)*h(Ge),it=Ge,mt=0,gt;mt<25&&(it-=gt=(h(it/2)+h(it)-et)/(.5*n(it/2)+n(it)),!(T(gt)<u));mt++);return[Re*(1+2*n(it)/n(it/2))/(3*b),2*D(3)*h(it/2)/D(2+b)]}Dl.invert=function(Re,Ge){var et=Ge*D(2+b)/(2*D(3)),it=2*z(et);return[3*b*Re/(1+2*n(it)/n(it/2)),z((et+h(it))/(1+v))]};function Eu(){return c.geoProjection(Dl).scale(188.209)}function Xs(Re,Ge){for(var et=D(6/(4+s)),it=(1+s/4)*h(Ge),mt=Ge/2,gt=0,_t;gt<25&&(mt-=_t=(mt/2+h(mt)-it)/(.5+n(mt)),!(T(_t)<u));gt++);return[et*(.5+n(mt))*Re/1.5,et*mt]}Xs.invert=function(Re,Ge){var et=D(6/(4+s)),it=Ge/et;return T(T(it)-A)<u&&(it=it<0?-A:A),[1.5*Re/(et*(.5+n(it))),z((it/2+h(it))/(1+s/4))]};function Zl(){return c.geoProjection(Xs).scale(166.518)}function Rl(Re,Ge){var et=Ge*Ge,it=et*et,mt=et*it;return[Re*(.84719-.13063*et+mt*mt*(-.04515+.05494*et-.02326*it+.00331*mt)),Ge*(1.01183+it*it*(-.02625+.01926*et-.00396*it))]}Rl.invert=function(Re,Ge){var et=Ge,it=25,mt,gt,_t,ar;do gt=et*et,_t=gt*gt,et-=mt=(et*(1.01183+_t*_t*(-.02625+.01926*gt-.00396*_t))-Ge)/(1.01183+_t*_t*(9*-.02625+11*.01926*gt+13*-.00396*_t));while(T(mt)>_&&--it>0);return gt=et*et,_t=gt*gt,ar=gt*_t,[Re/(.84719-.13063*gt+ar*ar*(-.04515+.05494*gt-.02326*_t+.00331*ar)),et]};function ds(){return c.geoProjection(Rl).scale(175.295)}function yl(Re,Ge){return[Re*(1+n(Ge))/2,2*(Ge-m(Ge/2))]}yl.invert=function(Re,Ge){for(var et=Ge/2,it=0,mt=1/0;it<10&&T(mt)>u;++it){var gt=n(Ge/2);Ge-=mt=(Ge-m(Ge/2)-et)/(1-.5/(gt*gt))}return[2*Re/(1+n(Ge)),Ge]};function jl(){return c.geoProjection(yl).scale(152.63)}var su=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function lu(){return aa(te(1/0),su).rotate([20,0]).scale(152.63)}function Il(Re,Ge){var et=h(Ge),it=n(Ge),mt=y(Re);if(Re===0||T(Ge)===A)return[0,Ge];if(Ge===0)return[Re,0];if(T(Re)===A)return[Re*it,A*et];var gt=s/(2*Re)-2*Re/s,_t=2*Ge/s,ar=(1-_t*_t)/(et-_t),fr=gt*gt,rr=ar*ar,pr=1+fr/rr,kr=1+rr/fr,Hr=(gt*et/ar-gt/2)/pr,Qr=(rr*et/fr+ar/2)/kr,mn=Hr*Hr+it*it/pr,Ln=Qr*Qr-(rr*et*et/fr+ar*et-1)/kr;return[A*(Hr+D(mn)*mt),A*(Qr+D(Ln<0?0:Ln)*y(-Ge*gt)*mt)]}Il.invert=function(Re,Ge){Re/=A,Ge/=A;var et=Re*Re,it=Ge*Ge,mt=et+it,gt=s*s;return[Re?(mt-1+D((1-mt)*(1-mt)+4*et))/(2*Re)*A:0,ye(function(_t){return mt*(s*h(_t)-2*_t)*s+4*_t*_t*(Ge-h(_t))+2*s*_t-gt*Ge},0)]};function Cu(){return c.geoProjection(Il).scale(127.267)}var uu=1.0148,Qo=.23185,ol=-.14499,sl=.02406,Kl=uu,gs=5*Qo,Eo=7*ol,zl=9*sl,As=1.790857183;function Ms(Re,Ge){var et=Ge*Ge;return[Re,Ge*(uu+et*et*(Qo+et*(ol+sl*et)))]}Ms.invert=function(Re,Ge){Ge>As?Ge=As:Ge<-As&&(Ge=-As);var et=Ge,it;do{var mt=et*et;et-=it=(et*(uu+mt*mt*(Qo+mt*(ol+sl*mt)))-Ge)/(Kl+mt*mt*(gs+mt*(Eo+zl*mt)))}while(T(it)>u);return[Re,et]};function lo(){return c.geoProjection(Ms).scale(139.319)}function ml(Re,Ge){if(T(Ge)<u)return[Re,0];var et=m(Ge),it=Re*h(Ge);return[h(it)/et,Ge+(1-n(it))/et]}ml.invert=function(Re,Ge){if(T(Ge)<u)return[Re,0];var et=Re*Re+Ge*Ge,it=Ge*.5,mt=10,gt;do{var _t=m(it),ar=1/n(it),fr=et-2*Ge*it+it*it;it-=gt=(_t*fr+2*(it-Ge))/(2+fr*ar*ar+2*(it-Ge)*_t)}while(T(gt)>u&&--mt>0);return _t=m(it),[(T(Ge)<T(it+1/_t)?z(Re*_t):y(Ge)*y(Re)*(I(T(Re*_t))+A))/h(it),it]};function xl(){return c.geoProjection(ml).scale(103.74)}function Zs(Re,Ge){var et=ll(Re[1],Re[0]),it=ll(Ge[1],Ge[0]),mt=_l(et,it),gt=Fl(et)/Fl(it);return bl([1,0,Re[0][0],0,1,Re[0][1]],bl([gt,0,0,0,gt,0],bl([n(mt),h(mt),0,-h(mt),n(mt),0],[1,0,-Ge[0][0],0,1,-Ge[0][1]])))}function ys(Re){var Ge=1/(Re[0]*Re[4]-Re[1]*Re[3]);return[Ge*Re[4],-Ge*Re[1],Ge*(Re[1]*Re[5]-Re[2]*Re[4]),-Ge*Re[3],Ge*Re[0],Ge*(Re[2]*Re[3]-Re[0]*Re[5])]}function bl(Re,Ge){return[Re[0]*Ge[0]+Re[1]*Ge[3],Re[0]*Ge[1]+Re[1]*Ge[4],Re[0]*Ge[2]+Re[1]*Ge[5]+Re[2],Re[3]*Ge[0]+Re[4]*Ge[3],Re[3]*Ge[1]+Re[4]*Ge[4],Re[3]*Ge[2]+Re[4]*Ge[5]+Re[5]]}function ll(Re,Ge){return[Re[0]-Ge[0],Re[1]-Ge[1]]}function Fl(Re){return D(Re[0]*Re[0]+Re[1]*Re[1])}function _l(Re,Ge){return a(Re[0]*Ge[1]-Re[1]*Ge[0],Re[0]*Ge[0]+Re[1]*Ge[1])}function js(Re,Ge,et){it(Re,{transform:null});function it(rr,pr){if(rr.edges=Jl(rr.face),pr.face){var kr=rr.shared=Yu(rr.face,pr.face),Hr=Zs(kr.map(pr.project),kr.map(rr.project));rr.transform=pr.transform?bl(pr.transform,Hr):Hr;for(var Qr=pr.edges,mn=0,Ln=Qr.length;mn<Ln;++mn)ns(kr[0],Qr[mn][1])&&ns(kr[1],Qr[mn][0])&&(Qr[mn]=rr),ns(kr[0],Qr[mn][0])&&ns(kr[1],Qr[mn][1])&&(Qr[mn]=rr);for(Qr=rr.edges,mn=0,Ln=Qr.length;mn<Ln;++mn)ns(kr[0],Qr[mn][0])&&ns(kr[1],Qr[mn][1])&&(Qr[mn]=pr),ns(kr[0],Qr[mn][1])&&ns(kr[1],Qr[mn][0])&&(Qr[mn]=pr)}else rr.transform=pr.transform;return rr.children&&rr.children.forEach(function(Gn){it(Gn,rr)}),rr}function mt(rr,pr){var kr=Ge(rr,pr),Hr=kr.project([rr*S,pr*S]),Qr;return(Qr=kr.transform)?[Qr[0]*Hr[0]+Qr[1]*Hr[1]+Qr[2],-(Qr[3]*Hr[0]+Qr[4]*Hr[1]+Qr[5])]:(Hr[1]=-Hr[1],Hr)}ul(Re)&&(mt.invert=function(rr,pr){var kr=gt(Re,[rr,-pr]);return kr&&(kr[0]*=k,kr[1]*=k,kr)});function gt(rr,pr){var kr=rr.project.invert,Hr=rr.transform,Qr=pr;if(Hr&&(Hr=ys(Hr),Qr=[Hr[0]*Qr[0]+Hr[1]*Qr[1]+Hr[2],Hr[3]*Qr[0]+Hr[4]*Qr[1]+Hr[5]]),kr&&rr===_t(mn=kr(Qr)))return mn;for(var mn,Ln=rr.children,Gn=0,ga=Ln&&Ln.length;Gn<ga;++Gn)if(mn=gt(Ln[Gn],pr))return mn}function _t(rr){return Ge(rr[0]*k,rr[1]*k)}var ar=c.geoProjection(mt),fr=ar.stream;return ar.stream=function(rr){var pr=ar.rotate(),kr=fr(rr),Hr=(ar.rotate([0,0]),fr(rr));return ar.rotate(pr),kr.sphere=function(){Hr.polygonStart(),Hr.lineStart(),Lu(Hr,Re),Hr.lineEnd(),Hr.polygonEnd()},kr},ar.angle(et==null?-30:et*S)}function Lu(Re,Ge,et){var it,mt=Ge.edges,gt=mt.length,_t,ar={type:"MultiPoint",coordinates:Ge.face},fr=Ge.face.filter(function(Ln){return T(Ln[1])!==90}),rr=c.geoBounds({type:"MultiPoint",coordinates:fr}),pr=!1,kr=-1,Hr=rr[1][0]-rr[0][0],Qr=Hr===180||Hr===360?[(rr[0][0]+rr[1][0])/2,(rr[0][1]+rr[1][1])/2]:c.geoCentroid(ar);if(et)for(;++kr<gt&&mt[kr]!==et;);++kr;for(var mn=0;mn<gt;++mn)_t=mt[(mn+kr)%gt],Array.isArray(_t)?(pr||(Re.point((it=c.geoInterpolate(_t[0],Qr)(u))[0],it[1]),pr=!0),Re.point((it=c.geoInterpolate(_t[1],Qr)(u))[0],it[1])):(pr=!1,_t!==et&&Lu(Re,_t,Ge))}function ns(Re,Ge){return Re&&Ge&&Re[0]===Ge[0]&&Re[1]===Ge[1]}function Yu(Re,Ge){for(var et,it,mt=Re.length,gt=null,_t=0;_t<mt;++_t){et=Re[_t];for(var ar=Ge.length;--ar>=0;)if(it=Ge[ar],et[0]===it[0]&&et[1]===it[1]){if(gt)return[gt,et];gt=et}}}function Jl(Re){for(var Ge=Re.length,et=[],it=Re[Ge-1],mt=0;mt<Ge;++mt)et.push([it,it=Re[mt]]);return et}function ul(Re){return Re.project.invert||Re.children&&Re.children.some(ul)}var wl=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],Ks=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(Re){return Re.map(function(Ge){return wl[Ge]})});function Tl(Re){Re=Re||function(et){var it=c.geoCentroid({type:"MultiPoint",coordinates:et});return c.geoGnomonic().scale(1).translate([0,0]).rotate([-it[0],-it[1]])};var Ge=Ks.map(function(et){return{face:et,project:Re(et)}});return[-1,0,0,1,0,1,4,5].forEach(function(et,it){var mt=Ge[et];mt&&(mt.children||(mt.children=[])).push(Ge[it])}),js(Ge[0],function(et,it){return Ge[et<-s/2?it<0?6:4:et<0?it<0?2:0:et<s/2?it<0?3:1:it<0?7:5]}).angle(-30).scale(101.858).center([0,45])}var fu=2/D(3);function cu(Re,Ge){var et=Ye(Re,Ge);return[et[0]*fu,et[1]]}cu.invert=function(Re,Ge){return Ye.invert(Re/fu,Ge)};function Wu(Re){Re=Re||function(et){var it=c.geoCentroid({type:"MultiPoint",coordinates:et});return c.geoProjection(cu).translate([0,0]).scale(1).rotate(it[1]>0?[-it[0],0]:[180-it[0],180])};var Ge=Ks.map(function(et){return{face:et,project:Re(et)}});return[-1,0,0,1,0,1,4,5].forEach(function(et,it){var mt=Ge[et];mt&&(mt.children||(mt.children=[])).push(Ge[it])}),js(Ge[0],function(et,it){return Ge[et<-s/2?it<0?6:4:et<0?it<0?2:0:et<s/2?it<0?3:1:it<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])}function zi(Re){Re=Re||function(_t){var ar=_t.length===6?c.geoCentroid({type:"MultiPoint",coordinates:_t}):_t[0];return c.geoGnomonic().scale(1).translate([0,0]).rotate([-ar[0],-ar[1]])};var Ge=Ks.map(function(_t){for(var ar=_t.map(as),fr=ar.length,rr=ar[fr-1],pr,kr=[],Hr=0;Hr<fr;++Hr)pr=ar[Hr],kr.push($o([rr[0]*.9486832980505138+pr[0]*.31622776601683794,rr[1]*.9486832980505138+pr[1]*.31622776601683794,rr[2]*.9486832980505138+pr[2]*.31622776601683794]),$o([pr[0]*.9486832980505138+rr[0]*.31622776601683794,pr[1]*.9486832980505138+rr[1]*.31622776601683794,pr[2]*.9486832980505138+rr[2]*.31622776601683794])),rr=pr;return kr}),et=[],it=[-1,0,0,1,0,1,4,5];Ge.forEach(function(_t,ar){for(var fr=Ks[ar],rr=fr.length,pr=et[ar]=[],kr=0;kr<rr;++kr)Ge.push([fr[kr],_t[(kr*2+2)%(2*rr)],_t[(kr*2+1)%(2*rr)]]),it.push(ar),pr.push(Js(as(_t[(kr*2+2)%(2*rr)]),as(_t[(kr*2+1)%(2*rr)])))});var mt=Ge.map(function(_t){return{project:Re(_t),face:_t}});it.forEach(function(_t,ar){var fr=mt[_t];fr&&(fr.children||(fr.children=[])).push(mt[ar])});function gt(_t,ar){var fr=n(ar),rr=[fr*n(_t),fr*h(_t),h(ar)],pr=_t<-s/2?ar<0?6:4:_t<0?ar<0?2:0:_t<s/2?ar<0?3:1:ar<0?7:5,kr=et[pr];return mt[fl(kr[0],rr)<0?8+3*pr:fl(kr[1],rr)<0?8+3*pr+1:fl(kr[2],rr)<0?8+3*pr+2:pr]}return js(mt[0],gt).angle(-30).scale(110.625).center([0,45])}function fl(Re,Ge){for(var et=0,it=Re.length,mt=0;et<it;++et)mt+=Re[et]*Ge[et];return mt}function Js(Re,Ge){return[Re[1]*Ge[2]-Re[2]*Ge[1],Re[2]*Ge[0]-Re[0]*Ge[2],Re[0]*Ge[1]-Re[1]*Ge[0]]}function $o(Re){return[a(Re[1],Re[0])*S,z(o(-1,i(1,Re[2])))*S]}function as(Re){var Ge=Re[0]*k,et=Re[1]*k,it=n(et);return[it*n(Ge),it*h(Ge),h(et)]}function Al(){}function uo(Re){if((et=Re.length)<4)return!1;for(var Ge=0,et,it=Re[et-1][1]*Re[0][0]-Re[et-1][0]*Re[0][1];++Ge<et;)it+=Re[Ge-1][1]*Re[Ge][0]-Re[Ge-1][0]*Re[Ge][1];return it<=0}function hu(Re,Ge){for(var et=Ge[0],it=Ge[1],mt=!1,gt=0,_t=Re.length,ar=_t-1;gt<_t;ar=gt++){var fr=Re[gt],rr=fr[0],pr=fr[1],kr=Re[ar],Hr=kr[0],Qr=kr[1];pr>it^Qr>it&&et<(Hr-rr)*(it-pr)/(Qr-pr)+rr&&(mt=!mt)}return mt}function is(Re,Ge){var et=Ge.stream,it;if(!et)throw new Error("invalid projection");switch(Re&&Re.type){case"Feature":it=Os;break;case"FeatureCollection":it=Fs;break;default:it=os;break}return it(Re,et)}function Fs(Re,Ge){return{type:"FeatureCollection",features:Re.features.map(function(et){return Os(et,Ge)})}}function Os(Re,Ge){return{type:"Feature",id:Re.id,properties:Re.properties,geometry:os(Re.geometry,Ge)}}function Ss(Re,Ge){return{type:"GeometryCollection",geometries:Re.geometries.map(function(et){return os(et,Ge)})}}function os(Re,Ge){if(!Re)return null;if(Re.type==="GeometryCollection")return Ss(Re,Ge);var et;switch(Re.type){case"Point":et=ss;break;case"MultiPoint":et=ss;break;case"LineString":et=vu;break;case"MultiLineString":et=vu;break;case"Polygon":et=Ol;break;case"MultiPolygon":et=Ol;break;case"Sphere":et=Ol;break;default:return null}return c.geoStream(Re,Ge(et)),et.result()}var Gi=[],Co=[],ss={point:function(Re,Ge){Gi.push([Re,Ge])},result:function(){var Re=Gi.length?Gi.length<2?{type:"Point",coordinates:Gi[0]}:{type:"MultiPoint",coordinates:Gi}:null;return Gi=[],Re}},vu={lineStart:Al,point:function(Re,Ge){Gi.push([Re,Ge])},lineEnd:function(){Gi.length&&(Co.push(Gi),Gi=[])},result:function(){var Re=Co.length?Co.length<2?{type:"LineString",coordinates:Co[0]}:{type:"MultiLineString",coordinates:Co}:null;return Co=[],Re}},Ol={polygonStart:Al,lineStart:Al,point:function(Re,Ge){Gi.push([Re,Ge])},lineEnd:function(){var Re=Gi.length;if(Re){do Gi.push(Gi[0].slice());while(++Re<4);Co.push(Gi),Gi=[]}},polygonEnd:Al,result:function(){if(!Co.length)return null;var Re=[],Ge=[];return Co.forEach(function(et){uo(et)?Re.push([et]):Ge.push(et)}),Ge.forEach(function(et){var it=et[0];Re.some(function(mt){if(hu(mt[0],it))return mt.push(et),!0})||Re.push([et])}),Co=[],Re.length?Re.length>1?{type:"MultiPolygon",coordinates:Re}:{type:"Polygon",coordinates:Re[0]}:null}};function pu(Re){var Ge=Re(A,0)[0]-Re(-A,0)[0];function et(it,mt){var gt=T(it)<A,_t=Re(gt?it:it>0?it-s:it+s,mt),ar=(_t[0]-_t[1])*v,fr=(_t[0]+_t[1])*v;if(gt)return[ar,fr];var rr=Ge*v,pr=ar>0^fr>0?-1:1;return[pr*ar-y(fr)*rr,pr*fr-y(ar)*rr]}return Re.invert&&(et.invert=function(it,mt){var gt=(it+mt)*v,_t=(mt-it)*v,ar=T(gt)<.5*Ge&&T(_t)<.5*Ge;if(!ar){var fr=Ge*v,rr=gt>0^_t>0?-1:1,pr=-rr*it+(_t>0?1:-1)*fr,kr=-rr*mt+(gt>0?1:-1)*fr;gt=(-pr-kr)*v,_t=(pr-kr)*v}var Hr=Re.invert(gt,_t);return ar||(Hr[0]+=gt>0?s:-s),Hr}),c.geoProjection(et).rotate([-90,-90,45]).clipAngle(180-.001)}function dt(){return pu(Tr).scale(176.423)}function Dt(){return pu(Aa).scale(111.48)}function or(Re,Ge){if(!(0<=(Ge=+Ge)&&Ge<=20))throw new Error("invalid digits");function et(rr){var pr=rr.length,kr=2,Hr=new Array(pr);for(Hr[0]=+rr[0].toFixed(Ge),Hr[1]=+rr[1].toFixed(Ge);kr<pr;)Hr[kr]=rr[kr],++kr;return Hr}function it(rr){return rr.map(et)}function mt(rr){for(var pr=et(rr[0]),kr=[pr],Hr=1;Hr<rr.length;Hr++){var Qr=et(rr[Hr]);(Qr.length>2||Qr[0]!=pr[0]||Qr[1]!=pr[1])&&(kr.push(Qr),pr=Qr)}return kr.length===1&&rr.length>1&&kr.push(et(rr[rr.length-1])),kr}function gt(rr){return rr.map(mt)}function _t(rr){if(rr==null)return rr;var pr;switch(rr.type){case"GeometryCollection":pr={type:"GeometryCollection",geometries:rr.geometries.map(_t)};break;case"Point":pr={type:"Point",coordinates:et(rr.coordinates)};break;case"MultiPoint":pr={type:rr.type,coordinates:it(rr.coordinates)};break;case"LineString":pr={type:rr.type,coordinates:mt(rr.coordinates)};break;case"MultiLineString":case"Polygon":pr={type:rr.type,coordinates:gt(rr.coordinates)};break;case"MultiPolygon":pr={type:"MultiPolygon",coordinates:rr.coordinates.map(gt)};break;default:return rr}return rr.bbox!=null&&(pr.bbox=rr.bbox),pr}function ar(rr){var pr={type:"Feature",properties:rr.properties,geometry:_t(rr.geometry)};return rr.id!=null&&(pr.id=rr.id),rr.bbox!=null&&(pr.bbox=rr.bbox),pr}if(Re!=null)switch(Re.type){case"Feature":return ar(Re);case"FeatureCollection":{var fr={type:"FeatureCollection",features:Re.features.map(ar)};return Re.bbox!=null&&(fr.bbox=Re.bbox),fr}default:return _t(Re)}return Re}function er(Re){var Ge=h(Re);function et(it,mt){var gt=Ge?m(it*Ge/2)/Ge:it/2;if(!mt)return[2*gt,-Re];var _t=2*e(gt*h(mt)),ar=1/m(mt);return[h(_t)*ar,mt+(1-n(_t))*ar-Re]}return et.invert=function(it,mt){if(T(mt+=Re)<u)return[Ge?2*e(Ge*it/2)/Ge:it,0];var gt=it*it+mt*mt,_t=0,ar=10,fr;do{var rr=m(_t),pr=1/n(_t),kr=gt-2*mt*_t+_t*_t;_t-=fr=(rr*kr+2*(_t-mt))/(2+kr*pr*pr+2*(_t-mt)*rr)}while(T(fr)>u&&--ar>0);var Hr=it*(rr=m(_t)),Qr=m(T(mt)<T(_t+1/rr)?z(Hr)*.5:I(Hr)*.5+s/4)/h(_t);return[Ge?2*e(Ge*Qr)/Ge:2*Qr,_t]},et}function Er(){return Je(er).scale(131.215)}var $r=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];$r.forEach(function(Re){Re[1]*=1.0144});function pn(Re,Ge){var et=i(18,T(Ge)*36/s),it=t(et),mt=et-it,gt=(kr=$r[it])[0],_t=kr[1],ar=(kr=$r[++it])[0],fr=kr[1],rr=(kr=$r[i(19,++it)])[0],pr=kr[1],kr;return[Re*(ar+mt*(rr-gt)/2+mt*mt*(rr-2*ar+gt)/2),(Ge>0?A:-A)*(fr+mt*(pr-_t)/2+mt*mt*(pr-2*fr+_t)/2)]}pn.invert=function(Re,Ge){var et=Ge/A,it=et*90,mt=i(18,T(it/5)),gt=o(0,t(mt));do{var _t=$r[gt][1],ar=$r[gt+1][1],fr=$r[i(19,gt+2)][1],rr=fr-_t,pr=fr-2*ar+_t,kr=2*(T(et)-ar)/rr,Hr=pr/rr,Qr=kr*(1-Hr*kr*(1-2*Hr*kr));if(Qr>=0||gt===1){it=(Ge>=0?5:-5)*(Qr+mt);var mn=50,Ln;do mt=i(18,T(it)/5),gt=t(mt),Qr=mt-gt,_t=$r[gt][1],ar=$r[gt+1][1],fr=$r[i(19,gt+2)][1],it-=(Ln=(Ge>=0?A:-A)*(ar+Qr*(fr-_t)/2+Qr*Qr*(fr-2*ar+_t)/2)-Ge)*S;while(T(Ln)>_&&--mn>0);break}}while(--gt>=0);var Gn=$r[gt][0],ga=$r[gt+1][0],xa=$r[i(19,gt+2)][0];return[Re/(ga+Qr*(xa-Gn)/2+Qr*Qr*(xa-2*ga+Gn)/2),it*k]};function wn(){return c.geoProjection(pn).scale(152.63)}function En(Re){function Ge(et,it){var mt=n(it),gt=(Re-1)/(Re-mt*n(et));return[gt*mt*h(et),gt*h(it)]}return Ge.invert=function(et,it){var mt=et*et+it*it,gt=D(mt),_t=(Re-D(1-mt*(Re+1)/(Re-1)))/((Re-1)/gt+gt/(Re-1));return[a(et*_t,gt*D(1-_t*_t)),gt?z(it*_t/gt):0]},Ge}function Nn(Re,Ge){var et=En(Re);if(!Ge)return et;var it=n(Ge),mt=h(Ge);function gt(_t,ar){var fr=et(_t,ar),rr=fr[1],pr=rr*mt/(Re-1)+it;return[fr[0]*it/pr,rr/pr]}return gt.invert=function(_t,ar){var fr=(Re-1)/(Re-1-ar*mt);return et.invert(fr*_t,fr*ar*it)},gt}function gn(){var Re=2,Ge=0,et=c.geoProjectionMutator(Nn),it=et(Re,Ge);return it.distance=function(mt){return arguments.length?et(Re=+mt,Ge):Re},it.tilt=function(mt){return arguments.length?et(Re,Ge=mt*k):Ge*S},it.scale(432.147).clipAngle(I(1/Re)*S-1e-6)}var Rn=1e-4,Cn=1e4,Vn=-180,Jn=Vn+Rn,za=180,Ea=za-Rn,Fa=-90,Oa=Fa+Rn,Zn=90,ha=Zn-Rn;function Ya(Re){return Re.length>0}function Ja(Re){return Math.floor(Re*Cn)/Cn}function yi(Re){return Re===Fa||Re===Zn?[0,Re]:[Vn,Ja(Re)]}function mi(Re){var Ge=Re[0],et=Re[1],it=!1;return Ge<=Jn?(Ge=Vn,it=!0):Ge>=Ea&&(Ge=za,it=!0),et<=Oa?(et=Fa,it=!0):et>=ha&&(et=Zn,it=!0),it?[Ge,et]:Re}function bi(Re){return Re.map(mi)}function Si(Re,Ge,et){for(var it=0,mt=Re.length;it<mt;++it){var gt=Re[it].slice();et.push({index:-1,polygon:Ge,ring:gt});for(var _t=0,ar=gt.length;_t<ar;++_t){var fr=gt[_t],rr=fr[0],pr=fr[1];if(rr<=Jn||rr>=Ea||pr<=Oa||pr>=ha){gt[_t]=mi(fr);for(var kr=_t+1;kr<ar;++kr){var Hr=gt[kr],Qr=Hr[0],mn=Hr[1];if(Qr>Jn&&Qr<Ea&&mn>Oa&&mn<ha)break}if(kr===_t+1)continue;if(_t){var Ln={index:-1,polygon:Ge,ring:gt.slice(0,_t+1)};Ln.ring[Ln.ring.length-1]=yi(pr),et[et.length-1]=Ln}else et.pop();if(kr>=ar)break;et.push({index:-1,polygon:Ge,ring:gt=gt.slice(kr-1)}),gt[0]=yi(gt[0][1]),_t=-1,ar=gt.length}}}}function oi(Re){var Ge,et=Re.length,it={},mt={},gt,_t,ar,fr,rr;for(Ge=0;Ge<et;++Ge){if(gt=Re[Ge],_t=gt.ring[0],fr=gt.ring[gt.ring.length-1],_t[0]===fr[0]&&_t[1]===fr[1]){gt.polygon.push(gt.ring),Re[Ge]=null;continue}gt.index=Ge,it[_t]=mt[fr]=gt}for(Ge=0;Ge<et;++Ge)if(gt=Re[Ge],gt){if(_t=gt.ring[0],fr=gt.ring[gt.ring.length-1],ar=mt[_t],rr=it[fr],delete it[_t],delete mt[fr],_t[0]===fr[0]&&_t[1]===fr[1]){gt.polygon.push(gt.ring);continue}ar?(delete mt[_t],delete it[ar.ring[0]],ar.ring.pop(),Re[ar.index]=null,gt={index:-1,polygon:ar.polygon,ring:ar.ring.concat(gt.ring)},ar===rr?gt.polygon.push(gt.ring):(gt.index=et++,Re.push(it[gt.ring[0]]=mt[gt.ring[gt.ring.length-1]]=gt))):rr?(delete it[fr],delete mt[rr.ring[rr.ring.length-1]],gt.ring.pop(),gt={index:et++,polygon:rr.polygon,ring:gt.ring.concat(rr.ring)},Re[rr.index]=null,Re.push(it[gt.ring[0]]=mt[gt.ring[gt.ring.length-1]]=gt)):(gt.ring.push(gt.ring[0]),gt.polygon.push(gt.ring))}}function xo(Re){var Ge={type:"Feature",geometry:to(Re.geometry)};return Re.id!=null&&(Ge.id=Re.id),Re.bbox!=null&&(Ge.bbox=Re.bbox),Re.properties!=null&&(Ge.properties=Re.properties),Ge}function to(Re){if(Re==null)return Re;var Ge,et,it,mt;switch(Re.type){case"GeometryCollection":Ge={type:"GeometryCollection",geometries:Re.geometries.map(to)};break;case"Point":Ge={type:"Point",coordinates:mi(Re.coordinates)};break;case"MultiPoint":case"LineString":Ge={type:Re.type,coordinates:bi(Re.coordinates)};break;case"MultiLineString":Ge={type:"MultiLineString",coordinates:Re.coordinates.map(bi)};break;case"Polygon":{var gt=[];Si(Re.coordinates,gt,et=[]),oi(et),Ge={type:"Polygon",coordinates:gt};break}case"MultiPolygon":{et=[],it=-1,mt=Re.coordinates.length;for(var _t=new Array(mt);++it<mt;)Si(Re.coordinates[it],_t[it]=[],et);oi(et),Ge={type:"MultiPolygon",coordinates:_t.filter(Ya)};break}default:return Re}return Re.bbox!=null&&(Ge.bbox=Re.bbox),Ge}function Ka(Re){if(Re==null)return Re;switch(Re.type){case"Feature":return xo(Re);case"FeatureCollection":{var Ge={type:"FeatureCollection",features:Re.features.map(xo)};return Re.bbox!=null&&(Ge.bbox=Re.bbox),Ge}default:return to(Re)}}function pa(Re,Ge){var et=m(Ge/2),it=h(x*et);return[Re*(.74482-.34588*it*it),1.70711*et]}pa.invert=function(Re,Ge){var et=Ge/1.70711,it=h(x*et);return[Re/(.74482-.34588*it*it),2*e(et)]};function _i(){return c.geoProjection(pa).scale(146.153)}function fo(Re,Ge,et){var it=c.geoInterpolate(Ge,et),mt=it(.5),gt=c.geoRotation([-mt[0],-mt[1]])(Ge),_t=it.distance/2,ar=-z(h(gt[1]*k)/h(_t)),fr=[-mt[0],-mt[1],-(gt[0]>0?s-ar:ar)*S],rr=c.geoProjection(Re(_t)).rotate(fr),pr=c.geoRotation(fr),kr=rr.center;return delete rr.rotate,rr.center=function(Hr){return arguments.length?kr(pr(Hr)):pr.invert(kr())},rr.clipAngle(90)}function go(Re){var Ge=n(Re);function et(it,mt){var gt=c.geoGnomonicRaw(it,mt);return gt[0]*=Ge,gt}return et.invert=function(it,mt){return c.geoGnomonicRaw.invert(it/Ge,mt)},et}function ls(){return ks([-158,21.5],[-77,39]).clipAngle(60).scale(400)}function ks(Re,Ge){return fo(go,Re,Ge)}function Fo(Re){if(!(Re*=2))return c.geoAzimuthalEquidistantRaw;var Ge=-Re/2,et=-Ge,it=Re*Re,mt=m(et),gt=.5/h(et);function _t(ar,fr){var rr=I(n(fr)*n(ar-Ge)),pr=I(n(fr)*n(ar-et)),kr=fr<0?-1:1;return rr*=rr,pr*=pr,[(rr-pr)/(2*Re),kr*D(4*it*pr-(it-rr+pr)*(it-rr+pr))/(2*Re)]}return _t.invert=function(ar,fr){var rr=fr*fr,pr=n(D(rr+(Hr=ar+Ge)*Hr)),kr=n(D(rr+(Hr=ar+et)*Hr)),Hr,Qr;return[a(Qr=pr-kr,Hr=(pr+kr)*mt),(fr<0?-1:1)*I(D(Hr*Hr+Qr*Qr)*gt)]},_t}function Qs(){return ms([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)}function ms(Re,Ge){return fo(Fo,Re,Ge)}function us(Re,Ge){if(T(Ge)<u)return[Re,0];var et=T(Ge/A),it=z(et);if(T(Re)<u||T(T(Ge)-A)<u)return[0,y(Ge)*s*m(it/2)];var mt=n(it),gt=T(s/Re-Re/s)/2,_t=gt*gt,ar=mt/(et+mt-1),fr=ar*(2/et-1),rr=fr*fr,pr=rr+_t,kr=ar-rr,Hr=_t+ar;return[y(Re)*s*(gt*kr+D(_t*kr*kr-pr*(ar*ar-rr)))/pr,y(Ge)*s*(fr*Hr-gt*D((_t+1)*pr-Hr*Hr))/pr]}us.invert=function(Re,Ge){if(T(Ge)<u)return[Re,0];if(T(Re)<u)return[0,A*h(2*e(Ge/s))];var et=(Re/=s)*Re,it=(Ge/=s)*Ge,mt=et+it,gt=mt*mt,_t=-T(Ge)*(1+mt),ar=_t-2*it+et,fr=-2*_t+1+2*it+gt,rr=it/fr+(2*ar*ar*ar/(fr*fr*fr)-9*_t*ar/(fr*fr))/27,pr=(_t-ar*ar/(3*fr))/fr,kr=2*D(-pr/3),Hr=I(3*rr/(pr*kr))/3;return[s*(mt-1+D(1+2*(et-it)+gt))/(2*Re),y(Ge)*s*(-kr*n(Hr+s/3)-ar/(3*fr))]};function bo(){return c.geoProjection(us).scale(79.4183)}function Bl(Re,Ge){if(T(Ge)<u)return[Re,0];var et=T(Ge/A),it=z(et);if(T(Re)<u||T(T(Ge)-A)<u)return[0,y(Ge)*s*m(it/2)];var mt=n(it),gt=T(s/Re-Re/s)/2,_t=gt*gt,ar=mt*(D(1+_t)-gt*mt)/(1+_t*et*et);return[y(Re)*s*ar,y(Ge)*s*D(1-ar*(2*gt+ar))]}Bl.invert=function(Re,Ge){if(!Re)return[0,A*h(2*e(Ge/s))];var et=T(Re/s),it=(1-et*et-(Ge/=s)*Ge)/(2*et),mt=it*it,gt=D(mt+1);return[y(Re)*s*(gt-it),y(Ge)*A*h(2*a(D((1-2*it*et)*(it+gt)-et),D(gt+it+et)))]};function Ql(){return c.geoProjection(Bl).scale(79.4183)}function fs(Re,Ge){if(T(Ge)<u)return[Re,0];var et=Ge/A,it=z(et);if(T(Re)<u||T(T(Ge)-A)<u)return[0,s*m(it/2)];var mt=(s/Re-Re/s)/2,gt=et/(1+n(it));return[s*(y(Re)*D(mt*mt+1-gt*gt)-mt),s*gt]}fs.invert=function(Re,Ge){if(!Ge)return[Re,0];var et=Ge/s,it=(s*s*(1-et*et)-Re*Re)/(2*s*Re);return[Re?s*(y(Re)*D(it*it+1)-it):0,A*h(2*e(et))]};function du(){return c.geoProjection(fs).scale(79.4183)}function Nl(Re,Ge){if(!Ge)return[Re,0];var et=T(Ge);if(!Re||et===A)return[0,Ge];var it=et/A,mt=it*it,gt=(8*it-mt*(mt+2)-5)/(2*mt*(it-1)),_t=gt*gt,ar=it*gt,fr=mt+_t+2*ar,rr=it+3*gt,pr=Re/A,kr=pr+1/pr,Hr=y(T(Re)-A)*D(kr*kr-4),Qr=Hr*Hr,mn=fr*(mt+_t*Qr-1)+(1-mt)*(mt*(rr*rr+4*_t)+12*ar*_t+4*_t*_t),Ln=(Hr*(fr+_t-1)+2*D(mn))/(4*fr+Qr);return[y(Re)*A*Ln,y(Ge)*A*D(1+Hr*T(Ln)-Ln*Ln)]}Nl.invert=function(Re,Ge){var et;if(!Re||!Ge)return[Re,Ge];Ge/=s;var it=y(Re)*Re/A,mt=(it*it-1+4*Ge*Ge)/T(it),gt=mt*mt,_t=2*Ge,ar=50;do{var fr=_t*_t,rr=(8*_t-fr*(fr+2)-5)/(2*fr*(_t-1)),pr=(3*_t-fr*_t-10)/(2*fr*_t),kr=rr*rr,Hr=_t*rr,Qr=_t+rr,mn=Qr*Qr,Ln=_t+3*rr,Gn=mn*(fr+kr*gt-1)+(1-fr)*(fr*(Ln*Ln+4*kr)+kr*(12*Hr+4*kr)),ga=-2*Qr*(4*Hr*kr+(1-4*fr+3*fr*fr)*(1+pr)+kr*(-6+14*fr-gt+(-8+8*fr-2*gt)*pr)+Hr*(-8+12*fr+(-10+10*fr-gt)*pr)),xa=D(Gn),ja=mt*(mn+kr-1)+2*xa-it*(4*mn+gt),Wa=mt*(2*rr*pr+2*Qr*(1+pr))+ga/xa-8*Qr*(mt*(-1+kr+mn)+2*xa)*(1+pr)/(gt+4*mn);_t-=et=ja/Wa}while(et>u&&--ar>0);return[y(Re)*(D(mt*mt+4)+mt)*s/4,A*_t]};function vf(){return c.geoProjection(Nl).scale(127.16)}function Pu(Re,Ge,et,it,mt){function gt(_t,ar){var fr=et*h(it*ar),rr=D(1-fr*fr),pr=D(2/(1+rr*n(_t*=mt)));return[Re*rr*pr*h(_t),Ge*fr*pr]}return gt.invert=function(_t,ar){var fr=_t/Re,rr=ar/Ge,pr=D(fr*fr+rr*rr),kr=2*z(pr/2);return[a(_t*m(kr),Re*pr)/mt,pr&&z(ar*h(kr)/(Ge*et*pr))/it]},gt}function gu(Re,Ge,et,it){var mt=s/3;Re=o(Re,u),Ge=o(Ge,u),Re=i(Re,A),Ge=i(Ge,s-u),et=o(et,0),et=i(et,100-u),it=o(it,u);var gt=et/100+1,_t=it/100,ar=I(gt*n(mt))/mt,fr=h(Re)/h(ar*A),rr=Ge/s,pr=D(_t*h(Re/2)/h(Ge/2)),kr=pr/D(rr*fr*ar),Hr=1/(pr*D(rr*fr*ar));return Pu(kr,Hr,fr,ar,rr)}function Du(){var Re=65*k,Ge=60*k,et=20,it=200,mt=c.geoProjectionMutator(gu),gt=mt(Re,Ge,et,it);return gt.poleline=function(_t){return arguments.length?mt(Re=+_t*k,Ge,et,it):Re*S},gt.parallels=function(_t){return arguments.length?mt(Re,Ge=+_t*k,et,it):Ge*S},gt.inflation=function(_t){return arguments.length?mt(Re,Ge,et=+_t,it):et},gt.ratio=function(_t){return arguments.length?mt(Re,Ge,et,it=+_t):it},gt.scale(163.775)}function Es(){return Du().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)}var Xu=4*s+3*D(3),Ru=2*D(2*s*D(3)/Xu),Iu=we(Ru*D(3)/s,Ru,Xu/6);function Oo(){return c.geoProjection(Iu).scale(176.84)}function zu(Re,Ge){return[Re*D(1-3*Ge*Ge/(s*s)),Ge]}zu.invert=function(Re,Ge){return[Re/D(1-3*Ge*Ge/(s*s)),Ge]};function $u(){return c.geoProjection(zu).scale(152.63)}function xs(Re,Ge){var et=n(Ge),it=n(Re)*et,mt=1-it,gt=n(Re=a(h(Re)*et,-h(Ge))),_t=h(Re);return et=D(1-it*it),[_t*et-gt*mt,-gt*et-_t*mt]}xs.invert=function(Re,Ge){var et=(Re*Re+Ge*Ge)/-2,it=D(-et*(2+et)),mt=Ge*et+Re*it,gt=Re*et-Ge*it,_t=D(gt*gt+mt*mt);return[a(it*mt,_t*(1+et)),_t?-z(it*gt/_t):0]};function yu(){return c.geoProjection(xs).rotate([0,-90,45]).scale(124.75).clipAngle(180-.001)}function mu(Re,Ge){var et=Y(Re,Ge);return[(et[0]+Re/A)/2,(et[1]+Ge)/2]}mu.invert=function(Re,Ge){var et=Re,it=Ge,mt=25;do{var gt=n(it),_t=h(it),ar=h(2*it),fr=_t*_t,rr=gt*gt,pr=h(et),kr=n(et/2),Hr=h(et/2),Qr=Hr*Hr,mn=1-rr*kr*kr,Ln=mn?I(gt*kr)*D(Gn=1/mn):Gn=0,Gn,ga=.5*(2*Ln*gt*Hr+et/A)-Re,xa=.5*(Ln*_t+it)-Ge,ja=.5*Gn*(rr*Qr+Ln*gt*kr*fr)+.5/A,Wa=Gn*(pr*ar/4-Ln*_t*Hr),qa=.125*Gn*(ar*Hr-Ln*_t*rr*pr),pi=.5*Gn*(fr*kr+Ln*Qr*gt)+.5,oo=Wa*qa-pi*ja,ti=(xa*Wa-ga*pi)/oo,Yi=(ga*qa-xa*ja)/oo;et-=ti,it-=Yi}while((T(ti)>u||T(Yi)>u)&&--mt>0);return[et,it]};function Fu(){return c.geoProjection(mu).scale(158.837)}w.geoNaturalEarth=c.geoNaturalEarth1,w.geoNaturalEarthRaw=c.geoNaturalEarth1Raw,w.geoAiry=j,w.geoAiryRaw=J,w.geoAitoff=X,w.geoAitoffRaw=Y,w.geoArmadillo=se,w.geoArmadilloRaw=oe,w.geoAugust=N,w.geoAugustRaw=ie,w.geoBaker=W,w.geoBakerRaw=Q,w.geoBerghaus=ee,w.geoBerghausRaw=Z,w.geoBertin1953=ge,w.geoBertin1953Raw=pe,w.geoBoggs=He,w.geoBoggsRaw=Le,w.geoBonne=vt,w.geoBonneRaw=Ue,w.geoBottomley=Yt,w.geoBottomleyRaw=Lt,w.geoBromley=Rt,w.geoBromleyRaw=At,w.geoChamberlin=ke,w.geoChamberlinRaw=at,w.geoChamberlinAfrica=je,w.geoCollignon=Ke,w.geoCollignonRaw=Ye,w.geoCraig=Et,w.geoCraigRaw=st,w.geoCraster=$t,w.geoCrasterRaw=zt,w.geoCylindricalEqualArea=Qt,w.geoCylindricalEqualAreaRaw=Ot,w.geoCylindricalStereographic=qt,w.geoCylindricalStereographicRaw=tr,w.geoEckert1=Wr,w.geoEckert1Raw=lr,w.geoEckert2=Jr,w.geoEckert2Raw=cn,w.geoEckert3=Vt,w.geoEckert3Raw=ot,w.geoEckert4=Ut,w.geoEckert4Raw=jt,w.geoEckert5=nt,w.geoEckert5Raw=yr,w.geoEckert6=Me,w.geoEckert6Raw=_e,w.geoEisenlohr=Qe,w.geoEisenlohrRaw=We,w.geoFahey=ht,w.geoFaheyRaw=$e,w.geoFoucaut=kt,w.geoFoucautRaw=xt,w.geoFoucautSinusoidal=Ft,w.geoFoucautSinusoidalRaw=Wt,w.geoGilbert=_r,w.geoGingery=fn,w.geoGingeryRaw=an,w.geoGinzburg4=Fr,w.geoGinzburg4Raw=mr,w.geoGinzburg5=Sr,w.geoGinzburg5Raw=Ir,w.geoGinzburg6=Ct,w.geoGinzburg6Raw=tt,w.geoGinzburg8=ur,w.geoGinzburg8Raw=Zt,w.geoGinzburg9=Br,w.geoGinzburg9Raw=Lr,w.geoGringorten=An,w.geoGringortenRaw=Tr,w.geoGuyou=ci,w.geoGuyouRaw=Aa,w.geoHammer=le,w.geoHammerRaw=te,w.geoHammerRetroazimuthal=wr,w.geoHammerRetroazimuthalRaw=ui,w.geoHealpix=Va,w.geoHealpixRaw=Bn,w.geoHill=It,w.geoHillRaw=hi,w.geoHomolosine=bn,w.geoHomolosineRaw=kn,w.geoHufnagel=gr,w.geoHufnagelRaw=ln,w.geoHyperelliptical=On,w.geoHyperellipticalRaw=dn,w.geoInterrupt=aa,w.geoInterruptedBoggs=ma,w.geoInterruptedHomolosine=Ma,w.geoInterruptedMollweide=zo,w.geoInterruptedMollweideHemispheres=nl,w.geoInterruptedSinuMollweide=Yl,w.geoInterruptedSinusoidal=Gs,w.geoKavrayskiy7=Hi,w.geoKavrayskiy7Raw=Rs,w.geoLagrange=dl,w.geoLagrangeRaw=So,w.geoLarrivee=al,w.geoLarriveeRaw=Ii,w.geoLaskowski=Bi,w.geoLaskowskiRaw=Qi,w.geoLittrow=$i,w.geoLittrowRaw=io,w.geoLoximuthal=Ys,w.geoLoximuthalRaw=rs,w.geoMiller=Jo,w.geoMillerRaw=au,w.geoModifiedStereographic=Ts,w.geoModifiedStereographicRaw=iu,w.geoModifiedStereographicAlaska=Ll,w.geoModifiedStereographicGs48=Su,w.geoModifiedStereographicGs50=ku,w.geoModifiedStereographicMiller=Ws,w.geoModifiedStereographicLee=Pl,w.geoMollweide=Be,w.geoMollweideRaw=De,w.geoMtFlatPolarParabolic=ou,w.geoMtFlatPolarParabolicRaw=Xl,w.geoMtFlatPolarQuartic=Eu,w.geoMtFlatPolarQuarticRaw=Dl,w.geoMtFlatPolarSinusoidal=Zl,w.geoMtFlatPolarSinusoidalRaw=Xs,w.geoNaturalEarth2=ds,w.geoNaturalEarth2Raw=Rl,w.geoNellHammer=jl,w.geoNellHammerRaw=yl,w.geoInterruptedQuarticAuthalic=lu,w.geoNicolosi=Cu,w.geoNicolosiRaw=Il,w.geoPatterson=lo,w.geoPattersonRaw=Ms,w.geoPolyconic=xl,w.geoPolyconicRaw=ml,w.geoPolyhedral=js,w.geoPolyhedralButterfly=Tl,w.geoPolyhedralCollignon=Wu,w.geoPolyhedralWaterman=zi,w.geoProject=is,w.geoGringortenQuincuncial=dt,w.geoPeirceQuincuncial=Dt,w.geoPierceQuincuncial=Dt,w.geoQuantize=or,w.geoQuincuncial=pu,w.geoRectangularPolyconic=Er,w.geoRectangularPolyconicRaw=er,w.geoRobinson=wn,w.geoRobinsonRaw=pn,w.geoSatellite=gn,w.geoSatelliteRaw=Nn,w.geoSinuMollweide=un,w.geoSinuMollweideRaw=hn,w.geoSinusoidal=Pe,w.geoSinusoidalRaw=Oe,w.geoStitch=Ka,w.geoTimes=_i,w.geoTimesRaw=pa,w.geoTwoPointAzimuthal=ks,w.geoTwoPointAzimuthalRaw=go,w.geoTwoPointAzimuthalUsa=ls,w.geoTwoPointEquidistant=ms,w.geoTwoPointEquidistantRaw=Fo,w.geoTwoPointEquidistantUsa=Qs,w.geoVanDerGrinten=bo,w.geoVanDerGrintenRaw=us,w.geoVanDerGrinten2=Ql,w.geoVanDerGrinten2Raw=Bl,w.geoVanDerGrinten3=du,w.geoVanDerGrinten3Raw=fs,w.geoVanDerGrinten4=vf,w.geoVanDerGrinten4Raw=Nl,w.geoWagner=Du,w.geoWagner7=Es,w.geoWagnerRaw=gu,w.geoWagner4=Oo,w.geoWagner4Raw=Iu,w.geoWagner6=$u,w.geoWagner6Raw=zu,w.geoWiechel=yu,w.geoWiechelRaw=xs,w.geoWinkel3=Fu,w.geoWinkel3Raw=mu,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-array":107,"d3-geo":114}],114:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne,d("d3-array")):(w=w||self,c(w.d3=w.d3||{},w.d3))})(this,function(w,c){function M(){return new T}function T(){this.reset()}T.prototype={constructor:T,reset:function(){this.s=this.t=0},add:function(dt){a(e,dt,this.t),a(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new T;function a(dt,Dt,or){var er=dt.s=Dt+or,Er=er-Dt,$r=er-Er;dt.t=Dt-$r+(or-Er)}var n=1e-6,r=1e-12,t=Math.PI,f=t/2,o=t/4,i=t*2,g=180/t,p=t/180,y=Math.abs,h=Math.atan,m=Math.atan2,u=Math.cos,_=Math.ceil,s=Math.exp,A=Math.log,x=Math.pow,v=Math.sin,b=Math.sign||function(dt){return dt>0?1:dt<0?-1:0},l=Math.sqrt,L=Math.tan;function S(dt){return dt>1?0:dt<-1?t:Math.acos(dt)}function k(dt){return dt>1?f:dt<-1?-f:Math.asin(dt)}function P(dt){return(dt=v(dt/2))*dt}function z(){}function I(dt,Dt){dt&&R.hasOwnProperty(dt.type)&&R[dt.type](dt,Dt)}var D={Feature:function(dt,Dt){I(dt.geometry,Dt)},FeatureCollection:function(dt,Dt){for(var or=dt.features,er=-1,Er=or.length;++er<Er;)I(or[er].geometry,Dt)}},R={Sphere:function(dt,Dt){Dt.sphere()},Point:function(dt,Dt){dt=dt.coordinates,Dt.point(dt[0],dt[1],dt[2])},MultiPoint:function(dt,Dt){for(var or=dt.coordinates,er=-1,Er=or.length;++er<Er;)dt=or[er],Dt.point(dt[0],dt[1],dt[2])},LineString:function(dt,Dt){B(dt.coordinates,Dt,0)},MultiLineString:function(dt,Dt){for(var or=dt.coordinates,er=-1,Er=or.length;++er<Er;)B(or[er],Dt,0)},Polygon:function(dt,Dt){F(dt.coordinates,Dt)},MultiPolygon:function(dt,Dt){for(var or=dt.coordinates,er=-1,Er=or.length;++er<Er;)F(or[er],Dt)},GeometryCollection:function(dt,Dt){for(var or=dt.geometries,er=-1,Er=or.length;++er<Er;)I(or[er],Dt)}};function B(dt,Dt,or){var er=-1,Er=dt.length-or,$r;for(Dt.lineStart();++er<Er;)$r=dt[er],Dt.point($r[0],$r[1],$r[2]);Dt.lineEnd()}function F(dt,Dt){var or=-1,er=dt.length;for(Dt.polygonStart();++or<er;)B(dt[or],Dt,1);Dt.polygonEnd()}function V(dt,Dt){dt&&D.hasOwnProperty(dt.type)?D[dt.type](dt,Dt):I(dt,Dt)}var G=M(),J=M(),j,Y,X,oe,se,ie={point:z,lineStart:z,lineEnd:z,polygonStart:function(){G.reset(),ie.lineStart=N,ie.lineEnd=U},polygonEnd:function(){var dt=+G;J.add(dt<0?i+dt:dt),this.lineStart=this.lineEnd=this.point=z},sphere:function(){J.add(i)}};function N(){ie.point=q}function U(){Q(j,Y)}function q(dt,Dt){ie.point=Q,j=dt,Y=Dt,dt*=p,Dt*=p,X=dt,oe=u(Dt=Dt/2+o),se=v(Dt)}function Q(dt,Dt){dt*=p,Dt*=p,Dt=Dt/2+o;var or=dt-X,er=or>=0?1:-1,Er=er*or,$r=u(Dt),pn=v(Dt),wn=se*pn,En=oe*$r+wn*u(Er),Nn=wn*er*v(Er);G.add(m(Nn,En)),X=dt,oe=$r,se=pn}function W(dt){return J.reset(),V(dt,ie),J*2}function Z(dt){return[m(dt[1],dt[0]),k(dt[2])]}function ee(dt){var Dt=dt[0],or=dt[1],er=u(or);return[er*u(Dt),er*v(Dt),v(or)]}function te(dt,Dt){return dt[0]*Dt[0]+dt[1]*Dt[1]+dt[2]*Dt[2]}function ae(dt,Dt){return[dt[1]*Dt[2]-dt[2]*Dt[1],dt[2]*Dt[0]-dt[0]*Dt[2],dt[0]*Dt[1]-dt[1]*Dt[0]]}function le(dt,Dt){dt[0]+=Dt[0],dt[1]+=Dt[1],dt[2]+=Dt[2]}function ye(dt,Dt){return[dt[0]*Dt,dt[1]*Dt,dt[2]*Dt]}function fe(dt){var Dt=l(dt[0]*dt[0]+dt[1]*dt[1]+dt[2]*dt[2]);dt[0]/=Dt,dt[1]/=Dt,dt[2]/=Dt}var pe,ge,Ae,we,De,Be,Ve,xe,Le=M(),He,Je,Oe={point:Pe,lineStart:vt,lineEnd:Lt,polygonStart:function(){Oe.point=Yt,Oe.lineStart=At,Oe.lineEnd=Rt,Le.reset(),ie.polygonStart()},polygonEnd:function(){ie.polygonEnd(),Oe.point=Pe,Oe.lineStart=vt,Oe.lineEnd=Lt,G<0?(pe=-(Ae=180),ge=-(we=90)):Le>n?we=90:Le<-n&&(ge=-90),Je[0]=pe,Je[1]=Ae},sphere:function(){pe=-(Ae=180),ge=-(we=90)}};function Pe(dt,Dt){He.push(Je=[pe=dt,Ae=dt]),Dt<ge&&(ge=Dt),Dt>we&&(we=Dt)}function Ue(dt,Dt){var or=ee([dt*p,Dt*p]);if(xe){var er=ae(xe,or),Er=[er[1],-er[0],0],$r=ae(Er,er);fe($r),$r=Z($r);var pn=dt-De,wn=pn>0?1:-1,En=$r[0]*g*wn,Nn,gn=y(pn)>180;gn^(wn*De<En&&En<wn*dt)?(Nn=$r[1]*g,Nn>we&&(we=Nn)):(En=(En+360)%360-180,gn^(wn*De<En&&En<wn*dt)?(Nn=-$r[1]*g,Nn<ge&&(ge=Nn)):(Dt<ge&&(ge=Dt),Dt>we&&(we=Dt))),gn?dt<De?Bt(pe,dt)>Bt(pe,Ae)&&(Ae=dt):Bt(dt,Ae)>Bt(pe,Ae)&&(pe=dt):Ae>=pe?(dt<pe&&(pe=dt),dt>Ae&&(Ae=dt)):dt>De?Bt(pe,dt)>Bt(pe,Ae)&&(Ae=dt):Bt(dt,Ae)>Bt(pe,Ae)&&(pe=dt)}else He.push(Je=[pe=dt,Ae=dt]);Dt<ge&&(ge=Dt),Dt>we&&(we=Dt),xe=or,De=dt}function vt(){Oe.point=Ue}function Lt(){Je[0]=pe,Je[1]=Ae,Oe.point=Pe,xe=null}function Yt(dt,Dt){if(xe){var or=dt-De;Le.add(y(or)>180?or+(or>0?360:-360):or)}else Be=dt,Ve=Dt;ie.point(dt,Dt),Ue(dt,Dt)}function At(){ie.lineStart()}function Rt(){Yt(Be,Ve),ie.lineEnd(),y(Le)>n&&(pe=-(Ae=180)),Je[0]=pe,Je[1]=Ae,xe=null}function Bt(dt,Dt){return(Dt-=dt)<0?Dt+360:Dt}function Mt(dt,Dt){return dt[0]-Dt[0]}function Tt(dt,Dt){return dt[0]<=dt[1]?dt[0]<=Dt&&Dt<=dt[1]:Dt<dt[0]||dt[1]<Dt}function at(dt){var Dt,or,er,Er,$r,pn,wn;if(we=Ae=-(pe=ge=1/0),He=[],V(dt,Oe),or=He.length){for(He.sort(Mt),Dt=1,er=He[0],$r=[er];Dt<or;++Dt)Er=He[Dt],Tt(er,Er[0])||Tt(er,Er[1])?(Bt(er[0],Er[1])>Bt(er[0],er[1])&&(er[1]=Er[1]),Bt(Er[0],er[1])>Bt(er[0],er[1])&&(er[0]=Er[0])):$r.push(er=Er);for(pn=-1/0,or=$r.length-1,Dt=0,er=$r[or];Dt<=or;er=Er,++Dt)Er=$r[Dt],(wn=Bt(er[1],Er[0]))>pn&&(pn=wn,pe=Er[0],Ae=er[1])}return He=Je=null,pe===1/0||ge===1/0?[[NaN,NaN],[NaN,NaN]]:[[pe,ge],[Ae,we]]}var ct,je,ke,Ye,Ke,st,Et,bt,zt,$t,Ot,Qt,tr,qt,lr,Wr,cn={sphere:z,point:Jr,lineStart:Vt,lineEnd:yr,polygonStart:function(){cn.lineStart=nt,cn.lineEnd=_e},polygonEnd:function(){cn.lineStart=Vt,cn.lineEnd=yr}};function Jr(dt,Dt){dt*=p,Dt*=p;var or=u(Dt);ot(or*u(dt),or*v(dt),v(Dt))}function ot(dt,Dt,or){++ct,ke+=(dt-ke)/ct,Ye+=(Dt-Ye)/ct,Ke+=(or-Ke)/ct}function Vt(){cn.point=jt}function jt(dt,Dt){dt*=p,Dt*=p;var or=u(Dt);qt=or*u(dt),lr=or*v(dt),Wr=v(Dt),cn.point=Ut,ot(qt,lr,Wr)}function Ut(dt,Dt){dt*=p,Dt*=p;var or=u(Dt),er=or*u(dt),Er=or*v(dt),$r=v(Dt),pn=m(l((pn=lr*$r-Wr*Er)*pn+(pn=Wr*er-qt*$r)*pn+(pn=qt*Er-lr*er)*pn),qt*er+lr*Er+Wr*$r);je+=pn,st+=pn*(qt+(qt=er)),Et+=pn*(lr+(lr=Er)),bt+=pn*(Wr+(Wr=$r)),ot(qt,lr,Wr)}function yr(){cn.point=Jr}function nt(){cn.point=Me}function _e(){Ne(Qt,tr),cn.point=Jr}function Me(dt,Dt){Qt=dt,tr=Dt,dt*=p,Dt*=p,cn.point=Ne;var or=u(Dt);qt=or*u(dt),lr=or*v(dt),Wr=v(Dt),ot(qt,lr,Wr)}function Ne(dt,Dt){dt*=p,Dt*=p;var or=u(Dt),er=or*u(dt),Er=or*v(dt),$r=v(Dt),pn=lr*$r-Wr*Er,wn=Wr*er-qt*$r,En=qt*Er-lr*er,Nn=l(pn*pn+wn*wn+En*En),gn=k(Nn),Rn=Nn&&-gn/Nn;zt+=Rn*pn,$t+=Rn*wn,Ot+=Rn*En,je+=gn,st+=gn*(qt+(qt=er)),Et+=gn*(lr+(lr=Er)),bt+=gn*(Wr+(Wr=$r)),ot(qt,lr,Wr)}function We(dt){ct=je=ke=Ye=Ke=st=Et=bt=zt=$t=Ot=0,V(dt,cn);var Dt=zt,or=$t,er=Ot,Er=Dt*Dt+or*or+er*er;return Er<r&&(Dt=st,or=Et,er=bt,je<n&&(Dt=ke,or=Ye,er=Ke),Er=Dt*Dt+or*or+er*er,Er<r)?[NaN,NaN]:[m(or,Dt)*g,k(er/l(Er))*g]}function Qe(dt){return function(){return dt}}function rt(dt,Dt){function or(er,Er){return er=dt(er,Er),Dt(er[0],er[1])}return dt.invert&&Dt.invert&&(or.invert=function(er,Er){return er=Dt.invert(er,Er),er&&dt.invert(er[0],er[1])}),or}function $e(dt,Dt){return[y(dt)>t?dt+Math.round(-dt/i)*i:dt,Dt]}$e.invert=$e;function ht(dt,Dt,or){return(dt%=i)?Dt||or?rt(kt(dt),Wt(Dt,or)):kt(dt):Dt||or?Wt(Dt,or):$e}function xt(dt){return function(Dt,or){return Dt+=dt,[Dt>t?Dt-i:Dt<-t?Dt+i:Dt,or]}}function kt(dt){var Dt=xt(dt);return Dt.invert=xt(-dt),Dt}function Wt(dt,Dt){var or=u(dt),er=v(dt),Er=u(Dt),$r=v(Dt);function pn(wn,En){var Nn=u(En),gn=u(wn)*Nn,Rn=v(wn)*Nn,Cn=v(En),Vn=Cn*or+gn*er;return[m(Rn*Er-Vn*$r,gn*or-Cn*er),k(Vn*Er+Rn*$r)]}return pn.invert=function(wn,En){var Nn=u(En),gn=u(wn)*Nn,Rn=v(wn)*Nn,Cn=v(En),Vn=Cn*Er-Rn*$r;return[m(Rn*Er+Cn*$r,gn*or+Vn*er),k(Vn*or-gn*er)]},pn}function Ft(dt){dt=ht(dt[0]*p,dt[1]*p,dt.length>2?dt[2]*p:0);function Dt(or){return or=dt(or[0]*p,or[1]*p),or[0]*=g,or[1]*=g,or}return Dt.invert=function(or){return or=dt.invert(or[0]*p,or[1]*p),or[0]*=g,or[1]*=g,or},Dt}function ir(dt,Dt,or,er,Er,$r){if(!!or){var pn=u(Dt),wn=v(Dt),En=er*or;Er==null?(Er=Dt+er*i,$r=Dt-En/2):(Er=hr(pn,Er),$r=hr(pn,$r),(er>0?Er<$r:Er>$r)&&(Er+=er*i));for(var Nn,gn=Er;er>0?gn>$r:gn<$r;gn-=En)Nn=Z([pn,-wn*u(gn),-wn*v(gn)]),dt.point(Nn[0],Nn[1])}}function hr(dt,Dt){Dt=ee(Dt),Dt[0]-=dt,fe(Dt);var or=S(-Dt[1]);return((-Dt[2]<0?-or:or)+i-n)%i}function _r(){var dt=Qe([0,0]),Dt=Qe(90),or=Qe(6),er,Er,$r={point:pn};function pn(En,Nn){er.push(En=Er(En,Nn)),En[0]*=g,En[1]*=g}function wn(){var En=dt.apply(this,arguments),Nn=Dt.apply(this,arguments)*p,gn=or.apply(this,arguments)*p;return er=[],Er=ht(-En[0]*p,-En[1]*p,0).invert,ir($r,Nn,gn,1),En={type:"Polygon",coordinates:[er]},er=Er=null,En}return wn.center=function(En){return arguments.length?(dt=typeof En=="function"?En:Qe([+En[0],+En[1]]),wn):dt},wn.radius=function(En){return arguments.length?(Dt=typeof En=="function"?En:Qe(+En),wn):Dt},wn.precision=function(En){return arguments.length?(or=typeof En=="function"?En:Qe(+En),wn):or},wn}function an(){var dt=[],Dt;return{point:function(or,er,Er){Dt.push([or,er,Er])},lineStart:function(){dt.push(Dt=[])},lineEnd:z,rejoin:function(){dt.length>1&&dt.push(dt.pop().concat(dt.shift()))},result:function(){var or=dt;return dt=[],Dt=null,or}}}function Rr(dt,Dt){return y(dt[0]-Dt[0])<n&&y(dt[1]-Dt[1])<n}function Vr(dt,Dt,or,er){this.x=dt,this.z=Dt,this.o=or,this.e=er,this.v=!1,this.n=this.p=null}function fn(dt,Dt,or,er,Er){var $r=[],pn=[],wn,En;if(dt.forEach(function(Jn){if(!((za=Jn.length-1)<=0)){var za,Ea=Jn[0],Fa=Jn[za],Oa;if(Rr(Ea,Fa)){if(!Ea[2]&&!Fa[2]){for(Er.lineStart(),wn=0;wn<za;++wn)Er.point((Ea=Jn[wn])[0],Ea[1]);Er.lineEnd();return}Fa[0]+=2*n}$r.push(Oa=new Vr(Ea,Jn,null,!0)),pn.push(Oa.o=new Vr(Ea,null,Oa,!1)),$r.push(Oa=new Vr(Fa,Jn,null,!1)),pn.push(Oa.o=new Vr(Fa,null,Oa,!0))}}),!!$r.length){for(pn.sort(Dt),xr($r),xr(pn),wn=0,En=pn.length;wn<En;++wn)pn[wn].e=or=!or;for(var Nn=$r[0],gn,Rn;;){for(var Cn=Nn,Vn=!0;Cn.v;)if((Cn=Cn.n)===Nn)return;gn=Cn.z,Er.lineStart();do{if(Cn.v=Cn.o.v=!0,Cn.e){if(Vn)for(wn=0,En=gn.length;wn<En;++wn)Er.point((Rn=gn[wn])[0],Rn[1]);else er(Cn.x,Cn.n.x,1,Er);Cn=Cn.n}else{if(Vn)for(gn=Cn.p.z,wn=gn.length-1;wn>=0;--wn)Er.point((Rn=gn[wn])[0],Rn[1]);else er(Cn.x,Cn.p.x,-1,Er);Cn=Cn.p}Cn=Cn.o,gn=Cn.z,Vn=!Vn}while(!Cn.v);Er.lineEnd()}}}function xr(dt){if(!!(Dt=dt.length)){for(var Dt,or=0,er=dt[0],Er;++or<Dt;)er.n=Er=dt[or],Er.p=er,er=Er;er.n=Er=dt[0],Er.p=er}}var mr=M();function Fr(dt){return y(dt[0])<=t?dt[0]:b(dt[0])*((y(dt[0])+t)%i-t)}function Ir(dt,Dt){var or=Fr(Dt),er=Dt[1],Er=v(er),$r=[v(or),-u(or),0],pn=0,wn=0;mr.reset(),Er===1?er=f+n:Er===-1&&(er=-f-n);for(var En=0,Nn=dt.length;En<Nn;++En)if(!!(Rn=(gn=dt[En]).length))for(var gn,Rn,Cn=gn[Rn-1],Vn=Fr(Cn),Jn=Cn[1]/2+o,za=v(Jn),Ea=u(Jn),Fa=0;Fa<Rn;++Fa,Vn=Zn,za=Ya,Ea=Ja,Cn=Oa){var Oa=gn[Fa],Zn=Fr(Oa),ha=Oa[1]/2+o,Ya=v(ha),Ja=u(ha),yi=Zn-Vn,mi=yi>=0?1:-1,bi=mi*yi,Si=bi>t,oi=za*Ya;if(mr.add(m(oi*mi*v(bi),Ea*Ja+oi*u(bi))),pn+=Si?yi+mi*i:yi,Si^Vn>=or^Zn>=or){var xo=ae(ee(Cn),ee(Oa));fe(xo);var to=ae($r,xo);fe(to);var Ka=(Si^yi>=0?-1:1)*k(to[2]);(er>Ka||er===Ka&&(xo[0]||xo[1]))&&(wn+=Si^yi>=0?1:-1)}}return(pn<-n||pn<n&&mr<-n)^wn&1}function Sr(dt,Dt,or,er){return function(Er){var $r=Dt(Er),pn=an(),wn=Dt(pn),En=!1,Nn,gn,Rn,Cn={point:Vn,lineStart:za,lineEnd:Ea,polygonStart:function(){Cn.point=Fa,Cn.lineStart=Oa,Cn.lineEnd=Zn,gn=[],Nn=[]},polygonEnd:function(){Cn.point=Vn,Cn.lineStart=za,Cn.lineEnd=Ea,gn=c.merge(gn);var ha=Ir(Nn,er);gn.length?(En||(Er.polygonStart(),En=!0),fn(gn,Ct,ha,or,Er)):ha&&(En||(Er.polygonStart(),En=!0),Er.lineStart(),or(null,null,1,Er),Er.lineEnd()),En&&(Er.polygonEnd(),En=!1),gn=Nn=null},sphere:function(){Er.polygonStart(),Er.lineStart(),or(null,null,1,Er),Er.lineEnd(),Er.polygonEnd()}};function Vn(ha,Ya){dt(ha,Ya)&&Er.point(ha,Ya)}function Jn(ha,Ya){$r.point(ha,Ya)}function za(){Cn.point=Jn,$r.lineStart()}function Ea(){Cn.point=Vn,$r.lineEnd()}function Fa(ha,Ya){Rn.push([ha,Ya]),wn.point(ha,Ya)}function Oa(){wn.lineStart(),Rn=[]}function Zn(){Fa(Rn[0][0],Rn[0][1]),wn.lineEnd();var ha=wn.clean(),Ya=pn.result(),Ja,yi=Ya.length,mi,bi,Si;if(Rn.pop(),Nn.push(Rn),Rn=null,!!yi){if(ha&1){if(bi=Ya[0],(mi=bi.length-1)>0){for(En||(Er.polygonStart(),En=!0),Er.lineStart(),Ja=0;Ja<mi;++Ja)Er.point((Si=bi[Ja])[0],Si[1]);Er.lineEnd()}return}yi>1&&ha&2&&Ya.push(Ya.pop().concat(Ya.shift())),gn.push(Ya.filter(tt))}}return Cn}}function tt(dt){return dt.length>1}function Ct(dt,Dt){return((dt=dt.x)[0]<0?dt[1]-f-n:f-dt[1])-((Dt=Dt.x)[0]<0?Dt[1]-f-n:f-Dt[1])}var Zt=Sr(function(){return!0},ur,Br,[-t,-f]);function ur(dt){var Dt=NaN,or=NaN,er=NaN,Er;return{lineStart:function(){dt.lineStart(),Er=1},point:function($r,pn){var wn=$r>0?t:-t,En=y($r-Dt);y(En-t)<n?(dt.point(Dt,or=(or+pn)/2>0?f:-f),dt.point(er,or),dt.lineEnd(),dt.lineStart(),dt.point(wn,or),dt.point($r,or),Er=0):er!==wn&&En>=t&&(y(Dt-er)<n&&(Dt-=er*n),y($r-wn)<n&&($r-=wn*n),or=Lr(Dt,or,$r,pn),dt.point(er,or),dt.lineEnd(),dt.lineStart(),dt.point(wn,or),Er=0),dt.point(Dt=$r,or=pn),er=wn},lineEnd:function(){dt.lineEnd(),Dt=or=NaN},clean:function(){return 2-Er}}}function Lr(dt,Dt,or,er){var Er,$r,pn=v(dt-or);return y(pn)>n?h((v(Dt)*($r=u(er))*v(or)-v(er)*(Er=u(Dt))*v(dt))/(Er*$r*pn)):(Dt+er)/2}function Br(dt,Dt,or,er){var Er;if(dt==null)Er=or*f,er.point(-t,Er),er.point(0,Er),er.point(t,Er),er.point(t,0),er.point(t,-Er),er.point(0,-Er),er.point(-t,-Er),er.point(-t,0),er.point(-t,Er);else if(y(dt[0]-Dt[0])>n){var $r=dt[0]<Dt[0]?t:-t;Er=or*$r/2,er.point(-$r,Er),er.point(0,Er),er.point($r,Er)}else er.point(Dt[0],Dt[1])}function Pr(dt){var Dt=u(dt),or=6*p,er=Dt>0,Er=y(Dt)>n;function $r(gn,Rn,Cn,Vn){ir(Vn,dt,or,Cn,gn,Rn)}function pn(gn,Rn){return u(gn)*u(Rn)>Dt}function wn(gn){var Rn,Cn,Vn,Jn,za;return{lineStart:function(){Jn=Vn=!1,za=1},point:function(Ea,Fa){var Oa=[Ea,Fa],Zn,ha=pn(Ea,Fa),Ya=er?ha?0:Nn(Ea,Fa):ha?Nn(Ea+(Ea<0?t:-t),Fa):0;if(!Rn&&(Jn=Vn=ha)&&gn.lineStart(),ha!==Vn&&(Zn=En(Rn,Oa),(!Zn||Rr(Rn,Zn)||Rr(Oa,Zn))&&(Oa[2]=1)),ha!==Vn)za=0,ha?(gn.lineStart(),Zn=En(Oa,Rn),gn.point(Zn[0],Zn[1])):(Zn=En(Rn,Oa),gn.point(Zn[0],Zn[1],2),gn.lineEnd()),Rn=Zn;else if(Er&&Rn&&er^ha){var Ja;!(Ya&Cn)&&(Ja=En(Oa,Rn,!0))&&(za=0,er?(gn.lineStart(),gn.point(Ja[0][0],Ja[0][1]),gn.point(Ja[1][0],Ja[1][1]),gn.lineEnd()):(gn.point(Ja[1][0],Ja[1][1]),gn.lineEnd(),gn.lineStart(),gn.point(Ja[0][0],Ja[0][1],3)))}ha&&(!Rn||!Rr(Rn,Oa))&&gn.point(Oa[0],Oa[1]),Rn=Oa,Vn=ha,Cn=Ya},lineEnd:function(){Vn&&gn.lineEnd(),Rn=null},clean:function(){return za|(Jn&&Vn)<<1}}}function En(gn,Rn,Cn){var Vn=ee(gn),Jn=ee(Rn),za=[1,0,0],Ea=ae(Vn,Jn),Fa=te(Ea,Ea),Oa=Ea[0],Zn=Fa-Oa*Oa;if(!Zn)return!Cn&&gn;var ha=Dt*Fa/Zn,Ya=-Dt*Oa/Zn,Ja=ae(za,Ea),yi=ye(za,ha),mi=ye(Ea,Ya);le(yi,mi);var bi=Ja,Si=te(yi,bi),oi=te(bi,bi),xo=Si*Si-oi*(te(yi,yi)-1);if(!(xo<0)){var to=l(xo),Ka=ye(bi,(-Si-to)/oi);if(le(Ka,yi),Ka=Z(Ka),!Cn)return Ka;var pa=gn[0],_i=Rn[0],fo=gn[1],go=Rn[1],ls;_i<pa&&(ls=pa,pa=_i,_i=ls);var ks=_i-pa,Fo=y(ks-t)<n,Qs=Fo||ks<n;if(!Fo&&go<fo&&(ls=fo,fo=go,go=ls),Qs?Fo?fo+go>0^Ka[1]<(y(Ka[0]-pa)<n?fo:go):fo<=Ka[1]&&Ka[1]<=go:ks>t^(pa<=Ka[0]&&Ka[0]<=_i)){var ms=ye(bi,(-Si+to)/oi);return le(ms,yi),[Ka,Z(ms)]}}}function Nn(gn,Rn){var Cn=er?dt:t-dt,Vn=0;return gn<-Cn?Vn|=1:gn>Cn&&(Vn|=2),Rn<-Cn?Vn|=4:Rn>Cn&&(Vn|=8),Vn}return Sr(pn,wn,$r,er?[0,-dt]:[-t,dt-t])}function Tr(dt,Dt,or,er,Er,$r){var pn=dt[0],wn=dt[1],En=Dt[0],Nn=Dt[1],gn=0,Rn=1,Cn=En-pn,Vn=Nn-wn,Jn;if(Jn=or-pn,!(!Cn&&Jn>0)){if(Jn/=Cn,Cn<0){if(Jn<gn)return;Jn<Rn&&(Rn=Jn)}else if(Cn>0){if(Jn>Rn)return;Jn>gn&&(gn=Jn)}if(Jn=Er-pn,!(!Cn&&Jn<0)){if(Jn/=Cn,Cn<0){if(Jn>Rn)return;Jn>gn&&(gn=Jn)}else if(Cn>0){if(Jn<gn)return;Jn<Rn&&(Rn=Jn)}if(Jn=er-wn,!(!Vn&&Jn>0)){if(Jn/=Vn,Vn<0){if(Jn<gn)return;Jn<Rn&&(Rn=Jn)}else if(Vn>0){if(Jn>Rn)return;Jn>gn&&(gn=Jn)}if(Jn=$r-wn,!(!Vn&&Jn<0)){if(Jn/=Vn,Vn<0){if(Jn>Rn)return;Jn>gn&&(gn=Jn)}else if(Vn>0){if(Jn<gn)return;Jn<Rn&&(Rn=Jn)}return gn>0&&(dt[0]=pn+gn*Cn,dt[1]=wn+gn*Vn),Rn<1&&(Dt[0]=pn+Rn*Cn,Dt[1]=wn+Rn*Vn),!0}}}}}var jr=1e9,Pn=-jr;function An(dt,Dt,or,er){function Er(Nn,gn){return dt<=Nn&&Nn<=or&&Dt<=gn&&gn<=er}function $r(Nn,gn,Rn,Cn){var Vn=0,Jn=0;if(Nn==null||(Vn=pn(Nn,Rn))!==(Jn=pn(gn,Rn))||En(Nn,gn)<0^Rn>0)do Cn.point(Vn===0||Vn===3?dt:or,Vn>1?er:Dt);while((Vn=(Vn+Rn+4)%4)!==Jn);else Cn.point(gn[0],gn[1])}function pn(Nn,gn){return y(Nn[0]-dt)<n?gn>0?0:3:y(Nn[0]-or)<n?gn>0?2:1:y(Nn[1]-Dt)<n?gn>0?1:0:gn>0?3:2}function wn(Nn,gn){return En(Nn.x,gn.x)}function En(Nn,gn){var Rn=pn(Nn,1),Cn=pn(gn,1);return Rn!==Cn?Rn-Cn:Rn===0?gn[1]-Nn[1]:Rn===1?Nn[0]-gn[0]:Rn===2?Nn[1]-gn[1]:gn[0]-Nn[0]}return function(Nn){var gn=Nn,Rn=an(),Cn,Vn,Jn,za,Ea,Fa,Oa,Zn,ha,Ya,Ja,yi={point:mi,lineStart:xo,lineEnd:to,polygonStart:Si,polygonEnd:oi};function mi(pa,_i){Er(pa,_i)&&gn.point(pa,_i)}function bi(){for(var pa=0,_i=0,fo=Vn.length;_i<fo;++_i)for(var go=Vn[_i],ls=1,ks=go.length,Fo=go[0],Qs,ms,us=Fo[0],bo=Fo[1];ls<ks;++ls)Qs=us,ms=bo,Fo=go[ls],us=Fo[0],bo=Fo[1],ms<=er?bo>er&&(us-Qs)*(er-ms)>(bo-ms)*(dt-Qs)&&++pa:bo<=er&&(us-Qs)*(er-ms)<(bo-ms)*(dt-Qs)&&--pa;return pa}function Si(){gn=Rn,Cn=[],Vn=[],Ja=!0}function oi(){var pa=bi(),_i=Ja&&pa,fo=(Cn=c.merge(Cn)).length;(_i||fo)&&(Nn.polygonStart(),_i&&(Nn.lineStart(),$r(null,null,1,Nn),Nn.lineEnd()),fo&&fn(Cn,wn,pa,$r,Nn),Nn.polygonEnd()),gn=Nn,Cn=Vn=Jn=null}function xo(){yi.point=Ka,Vn&&Vn.push(Jn=[]),Ya=!0,ha=!1,Oa=Zn=NaN}function to(){Cn&&(Ka(za,Ea),Fa&&ha&&Rn.rejoin(),Cn.push(Rn.result())),yi.point=mi,ha&&gn.lineEnd()}function Ka(pa,_i){var fo=Er(pa,_i);if(Vn&&Jn.push([pa,_i]),Ya)za=pa,Ea=_i,Fa=fo,Ya=!1,fo&&(gn.lineStart(),gn.point(pa,_i));else if(fo&&ha)gn.point(pa,_i);else{var go=[Oa=Math.max(Pn,Math.min(jr,Oa)),Zn=Math.max(Pn,Math.min(jr,Zn))],ls=[pa=Math.max(Pn,Math.min(jr,pa)),_i=Math.max(Pn,Math.min(jr,_i))];Tr(go,ls,dt,Dt,or,er)?(ha||(gn.lineStart(),gn.point(go[0],go[1])),gn.point(ls[0],ls[1]),fo||gn.lineEnd(),Ja=!1):fo&&(gn.lineStart(),gn.point(pa,_i),Ja=!1)}Oa=pa,Zn=_i,ha=fo}return yi}}function $n(){var dt=0,Dt=0,or=960,er=500,Er,$r,pn;return pn={stream:function(wn){return Er&&$r===wn?Er:Er=An(dt,Dt,or,er)($r=wn)},extent:function(wn){return arguments.length?(dt=+wn[0][0],Dt=+wn[0][1],or=+wn[1][0],er=+wn[1][1],Er=$r=null,pn):[[dt,Dt],[or,er]]}}}var zn=M(),Yn,Kn,Aa,Ua={sphere:z,point:z,lineStart:vi,lineEnd:z,polygonStart:z,polygonEnd:z};function vi(){Ua.point=ui,Ua.lineEnd=ci}function ci(){Ua.point=Ua.lineEnd=z}function ui(dt,Dt){dt*=p,Dt*=p,Yn=dt,Kn=v(Dt),Aa=u(Dt),Ua.point=Ga}function Ga(dt,Dt){dt*=p,Dt*=p;var or=v(Dt),er=u(Dt),Er=y(dt-Yn),$r=u(Er),pn=v(Er),wn=er*pn,En=Aa*or-Kn*er*$r,Nn=Kn*or+Aa*er*$r;zn.add(m(l(wn*wn+En*En),Nn)),Yn=dt,Kn=or,Aa=er}function wr(dt){return zn.reset(),V(dt,Ua),+zn}var vn=[null,null],on={type:"LineString",coordinates:vn};function _n(dt,Dt){return vn[0]=dt,vn[1]=Dt,wr(on)}var Bn={Feature:function(dt,Dt){return ra(dt.geometry,Dt)},FeatureCollection:function(dt,Dt){for(var or=dt.features,er=-1,Er=or.length;++er<Er;)if(ra(or[er].geometry,Dt))return!0;return!1}},sa={Sphere:function(){return!0},Point:function(dt,Dt){return In(dt.coordinates,Dt)},MultiPoint:function(dt,Dt){for(var or=dt.coordinates,er=-1,Er=or.length;++er<Er;)if(In(or[er],Dt))return!0;return!1},LineString:function(dt,Dt){return ea(dt.coordinates,Dt)},MultiLineString:function(dt,Dt){for(var or=dt.coordinates,er=-1,Er=or.length;++er<Er;)if(ea(or[er],Dt))return!0;return!1},Polygon:function(dt,Dt){return Va(dt.coordinates,Dt)},MultiPolygon:function(dt,Dt){for(var or=dt.coordinates,er=-1,Er=or.length;++er<Er;)if(Va(or[er],Dt))return!0;return!1},GeometryCollection:function(dt,Dt){for(var or=dt.geometries,er=-1,Er=or.length;++er<Er;)if(ra(or[er],Dt))return!0;return!1}};function ra(dt,Dt){return dt&&sa.hasOwnProperty(dt.type)?sa[dt.type](dt,Dt):!1}function In(dt,Dt){return _n(dt,Dt)===0}function ea(dt,Dt){for(var or,er,Er,$r=0,pn=dt.length;$r<pn;$r++){if(er=_n(dt[$r],Dt),er===0||$r>0&&(Er=_n(dt[$r],dt[$r-1]),Er>0&&or<=Er&&er<=Er&&(or+er-Er)*(1-Math.pow((or-er)/Er,2))<r*Er))return!0;or=er}return!1}function Va(dt,Dt){return!!Ir(dt.map(hi),It(Dt))}function hi(dt){return dt=dt.map(It),dt.pop(),dt}function It(dt){return[dt[0]*p,dt[1]*p]}function vr(dt,Dt){return(dt&&Bn.hasOwnProperty(dt.type)?Bn[dt.type]:ra)(dt,Dt)}function rn(dt,Dt,or){var er=c.range(dt,Dt-n,or).concat(Dt);return function(Er){return er.map(function($r){return[Er,$r]})}}function hn(dt,Dt,or){var er=c.range(dt,Dt-n,or).concat(Dt);return function(Er){return er.map(function($r){return[$r,Er]})}}function un(){var dt,Dt,or,er,Er,$r,pn,wn,En=10,Nn=En,gn=90,Rn=360,Cn,Vn,Jn,za,Ea=2.5;function Fa(){return{type:"MultiLineString",coordinates:Oa()}}function Oa(){return c.range(_(er/gn)*gn,or,gn).map(Jn).concat(c.range(_(wn/Rn)*Rn,pn,Rn).map(za)).concat(c.range(_(Dt/En)*En,dt,En).filter(function(Zn){return y(Zn%gn)>n}).map(Cn)).concat(c.range(_($r/Nn)*Nn,Er,Nn).filter(function(Zn){return y(Zn%Rn)>n}).map(Vn))}return Fa.lines=function(){return Oa().map(function(Zn){return{type:"LineString",coordinates:Zn}})},Fa.outline=function(){return{type:"Polygon",coordinates:[Jn(er).concat(za(pn).slice(1),Jn(or).reverse().slice(1),za(wn).reverse().slice(1))]}},Fa.extent=function(Zn){return arguments.length?Fa.extentMajor(Zn).extentMinor(Zn):Fa.extentMinor()},Fa.extentMajor=function(Zn){return arguments.length?(er=+Zn[0][0],or=+Zn[1][0],wn=+Zn[0][1],pn=+Zn[1][1],er>or&&(Zn=er,er=or,or=Zn),wn>pn&&(Zn=wn,wn=pn,pn=Zn),Fa.precision(Ea)):[[er,wn],[or,pn]]},Fa.extentMinor=function(Zn){return arguments.length?(Dt=+Zn[0][0],dt=+Zn[1][0],$r=+Zn[0][1],Er=+Zn[1][1],Dt>dt&&(Zn=Dt,Dt=dt,dt=Zn),$r>Er&&(Zn=$r,$r=Er,Er=Zn),Fa.precision(Ea)):[[Dt,$r],[dt,Er]]},Fa.step=function(Zn){return arguments.length?Fa.stepMajor(Zn).stepMinor(Zn):Fa.stepMinor()},Fa.stepMajor=function(Zn){return arguments.length?(gn=+Zn[0],Rn=+Zn[1],Fa):[gn,Rn]},Fa.stepMinor=function(Zn){return arguments.length?(En=+Zn[0],Nn=+Zn[1],Fa):[En,Nn]},Fa.precision=function(Zn){return arguments.length?(Ea=+Zn,Cn=rn($r,Er,90),Vn=hn(Dt,dt,Ea),Jn=rn(wn,pn,90),za=hn(er,or,Ea),Fa):Ea},Fa.extentMajor([[-180,-90+n],[180,90-n]]).extentMinor([[-180,-80-n],[180,80+n]])}function kn(){return un()()}function bn(dt,Dt){var or=dt[0]*p,er=dt[1]*p,Er=Dt[0]*p,$r=Dt[1]*p,pn=u(er),wn=v(er),En=u($r),Nn=v($r),gn=pn*u(or),Rn=pn*v(or),Cn=En*u(Er),Vn=En*v(Er),Jn=2*k(l(P($r-er)+pn*En*P(Er-or))),za=v(Jn),Ea=Jn?function(Fa){var Oa=v(Fa*=Jn)/za,Zn=v(Jn-Fa)/za,ha=Zn*gn+Oa*Cn,Ya=Zn*Rn+Oa*Vn,Ja=Zn*wn+Oa*Nn;return[m(Ya,ha)*g,m(Ja,l(ha*ha+Ya*Ya))*g]}:function(){return[or*g,er*g]};return Ea.distance=Jn,Ea}function ln(dt){return dt}var gr=M(),dr=M(),Cr,dn,On,qn,xn={point:z,lineStart:z,lineEnd:z,polygonStart:function(){xn.lineStart=Wn,xn.lineEnd=ma},polygonEnd:function(){xn.lineStart=xn.lineEnd=xn.point=z,gr.add(y(dr)),dr.reset()},result:function(){var dt=gr/2;return gr.reset(),dt}};function Wn(){xn.point=aa}function aa(dt,Dt){xn.point=da,Cr=On=dt,dn=qn=Dt}function da(dt,Dt){dr.add(qn*dt-On*Dt),On=dt,qn=Dt}function ma(){da(Cr,dn)}var la=1/0,Ma=la,po=-la,zo=po,Ko={point:nl,lineStart:z,lineEnd:z,polygonStart:z,polygonEnd:z,result:function(){var dt=[[la,Ma],[po,zo]];return po=zo=-(Ma=la=1/0),dt}};function nl(dt,Dt){dt<la&&(la=dt),dt>po&&(po=dt),Dt<Ma&&(Ma=Dt),Dt>zo&&(zo=Dt)}var pl=0,Yl=0,di=0,Gs=0,Rs=0,Hi=0,So=0,dl=0,ps=0,Ii,al,Qi,Bi,io={point:$i,lineStart:rs,lineEnd:Jo,polygonStart:function(){io.lineStart=iu,io.lineEnd=Is},polygonEnd:function(){io.point=$i,io.lineStart=rs,io.lineEnd=Jo},result:function(){var dt=ps?[So/ps,dl/ps]:Hi?[Gs/Hi,Rs/Hi]:di?[pl/di,Yl/di]:[NaN,NaN];return pl=Yl=di=Gs=Rs=Hi=So=dl=ps=0,dt}};function $i(dt,Dt){pl+=dt,Yl+=Dt,++di}function rs(){io.point=Ys}function Ys(dt,Dt){io.point=au,$i(Qi=dt,Bi=Dt)}function au(dt,Dt){var or=dt-Qi,er=Dt-Bi,Er=l(or*or+er*er);Gs+=Er*(Qi+dt)/2,Rs+=Er*(Bi+Dt)/2,Hi+=Er,$i(Qi=dt,Bi=Dt)}function Jo(){io.point=$i}function iu(){io.point=ko}function Is(){Mu(Ii,al)}function ko(dt,Dt){io.point=Mu,$i(Ii=Qi=dt,al=Bi=Dt)}function Mu(dt,Dt){var or=dt-Qi,er=Dt-Bi,Er=l(or*or+er*er);Gs+=Er*(Qi+dt)/2,Rs+=Er*(Bi+Dt)/2,Hi+=Er,Er=Bi*dt-Qi*Dt,So+=Er*(Qi+dt),dl+=Er*(Bi+Dt),ps+=Er*3,$i(Qi=dt,Bi=Dt)}function zs(dt){this._context=dt}zs.prototype={_radius:4.5,pointRadius:function(dt){return this._radius=dt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(dt,Dt){switch(this._point){case 0:{this._context.moveTo(dt,Dt),this._point=1;break}case 1:{this._context.lineTo(dt,Dt);break}default:{this._context.moveTo(dt+this._radius,Dt),this._context.arc(dt,Dt,this._radius,0,i);break}}},result:z};var ws=M(),Ll,Su,ku,Ws,Pl,Ts={point:z,lineStart:function(){Ts.point=Wl},lineEnd:function(){Ll&&il(Su,ku),Ts.point=z},polygonStart:function(){Ll=!0},polygonEnd:function(){Ll=null},result:function(){var dt=+ws;return ws.reset(),dt}};function Wl(dt,Dt){Ts.point=il,Su=Ws=dt,ku=Pl=Dt}function il(dt,Dt){Ws-=dt,Pl-=Dt,ws.add(l(Ws*Ws+Pl*Pl)),Ws=dt,Pl=Dt}function Xl(){this._string=[]}Xl.prototype={_radius:4.5,_circle:ou(4.5),pointRadius:function(dt){return(dt=+dt)!==this._radius&&(this._radius=dt,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(dt,Dt){switch(this._point){case 0:{this._string.push("M",dt,",",Dt),this._point=1;break}case 1:{this._string.push("L",dt,",",Dt);break}default:{this._circle==null&&(this._circle=ou(this._radius)),this._string.push("M",dt,",",Dt,this._circle);break}}},result:function(){if(this._string.length){var dt=this._string.join("");return this._string=[],dt}else return null}};function ou(dt){return"m0,"+dt+"a"+dt+","+dt+" 0 1,1 0,"+-2*dt+"a"+dt+","+dt+" 0 1,1 0,"+2*dt+"z"}function Dl(dt,Dt){var or=4.5,er,Er;function $r(pn){return pn&&(typeof or=="function"&&Er.pointRadius(+or.apply(this,arguments)),V(pn,er(Er))),Er.result()}return $r.area=function(pn){return V(pn,er(xn)),xn.result()},$r.measure=function(pn){return V(pn,er(Ts)),Ts.result()},$r.bounds=function(pn){return V(pn,er(Ko)),Ko.result()},$r.centroid=function(pn){return V(pn,er(io)),io.result()},$r.projection=function(pn){return arguments.length?(er=pn==null?(dt=null,ln):(dt=pn).stream,$r):dt},$r.context=function(pn){return arguments.length?(Er=pn==null?(Dt=null,new Xl):new zs(Dt=pn),typeof or!="function"&&Er.pointRadius(or),$r):Dt},$r.pointRadius=function(pn){return arguments.length?(or=typeof pn=="function"?pn:(Er.pointRadius(+pn),+pn),$r):or},$r.projection(dt).context(Dt)}function Eu(dt){return{stream:Xs(dt)}}function Xs(dt){return function(Dt){var or=new Zl;for(var er in dt)or[er]=dt[er];return or.stream=Dt,or}}function Zl(){}Zl.prototype={constructor:Zl,point:function(dt,Dt){this.stream.point(dt,Dt)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Rl(dt,Dt,or){var er=dt.clipExtent&&dt.clipExtent();return dt.scale(150).translate([0,0]),er!=null&&dt.clipExtent(null),V(or,dt.stream(Ko)),Dt(Ko.result()),er!=null&&dt.clipExtent(er),dt}function ds(dt,Dt,or){return Rl(dt,function(er){var Er=Dt[1][0]-Dt[0][0],$r=Dt[1][1]-Dt[0][1],pn=Math.min(Er/(er[1][0]-er[0][0]),$r/(er[1][1]-er[0][1])),wn=+Dt[0][0]+(Er-pn*(er[1][0]+er[0][0]))/2,En=+Dt[0][1]+($r-pn*(er[1][1]+er[0][1]))/2;dt.scale(150*pn).translate([wn,En])},or)}function yl(dt,Dt,or){return ds(dt,[[0,0],Dt],or)}function jl(dt,Dt,or){return Rl(dt,function(er){var Er=+Dt,$r=Er/(er[1][0]-er[0][0]),pn=(Er-$r*(er[1][0]+er[0][0]))/2,wn=-$r*er[0][1];dt.scale(150*$r).translate([pn,wn])},or)}function su(dt,Dt,or){return Rl(dt,function(er){var Er=+Dt,$r=Er/(er[1][1]-er[0][1]),pn=-$r*er[0][0],wn=(Er-$r*(er[1][1]+er[0][1]))/2;dt.scale(150*$r).translate([pn,wn])},or)}var lu=16,Il=u(30*p);function Cu(dt,Dt){return+Dt?Qo(dt,Dt):uu(dt)}function uu(dt){return Xs({point:function(Dt,or){Dt=dt(Dt,or),this.stream.point(Dt[0],Dt[1])}})}function Qo(dt,Dt){function or(er,Er,$r,pn,wn,En,Nn,gn,Rn,Cn,Vn,Jn,za,Ea){var Fa=Nn-er,Oa=gn-Er,Zn=Fa*Fa+Oa*Oa;if(Zn>4*Dt&&za--){var ha=pn+Cn,Ya=wn+Vn,Ja=En+Jn,yi=l(ha*ha+Ya*Ya+Ja*Ja),mi=k(Ja/=yi),bi=y(y(Ja)-1)<n||y($r-Rn)<n?($r+Rn)/2:m(Ya,ha),Si=dt(bi,mi),oi=Si[0],xo=Si[1],to=oi-er,Ka=xo-Er,pa=Oa*to-Fa*Ka;(pa*pa/Zn>Dt||y((Fa*to+Oa*Ka)/Zn-.5)>.3||pn*Cn+wn*Vn+En*Jn<Il)&&(or(er,Er,$r,pn,wn,En,oi,xo,bi,ha/=yi,Ya/=yi,Ja,za,Ea),Ea.point(oi,xo),or(oi,xo,bi,ha,Ya,Ja,Nn,gn,Rn,Cn,Vn,Jn,za,Ea))}}return function(er){var Er,$r,pn,wn,En,Nn,gn,Rn,Cn,Vn,Jn,za,Ea={point:Fa,lineStart:Oa,lineEnd:ha,polygonStart:function(){er.polygonStart(),Ea.lineStart=Ya},polygonEnd:function(){er.polygonEnd(),Ea.lineStart=Oa}};function Fa(mi,bi){mi=dt(mi,bi),er.point(mi[0],mi[1])}function Oa(){Rn=NaN,Ea.point=Zn,er.lineStart()}function Zn(mi,bi){var Si=ee([mi,bi]),oi=dt(mi,bi);or(Rn,Cn,gn,Vn,Jn,za,Rn=oi[0],Cn=oi[1],gn=mi,Vn=Si[0],Jn=Si[1],za=Si[2],lu,er),er.point(Rn,Cn)}function ha(){Ea.point=Fa,er.lineEnd()}function Ya(){Oa(),Ea.point=Ja,Ea.lineEnd=yi}function Ja(mi,bi){Zn(Er=mi,bi),$r=Rn,pn=Cn,wn=Vn,En=Jn,Nn=za,Ea.point=Zn}function yi(){or(Rn,Cn,gn,Vn,Jn,za,$r,pn,Er,wn,En,Nn,lu,er),Ea.lineEnd=ha,ha()}return Ea}}var ol=Xs({point:function(dt,Dt){this.stream.point(dt*p,Dt*p)}});function sl(dt){return Xs({point:function(Dt,or){var er=dt(Dt,or);return this.stream.point(er[0],er[1])}})}function Kl(dt,Dt,or,er,Er){function $r(pn,wn){return pn*=er,wn*=Er,[Dt+dt*pn,or-dt*wn]}return $r.invert=function(pn,wn){return[(pn-Dt)/dt*er,(or-wn)/dt*Er]},$r}function gs(dt,Dt,or,er,Er,$r){var pn=u($r),wn=v($r),En=pn*dt,Nn=wn*dt,gn=pn/dt,Rn=wn/dt,Cn=(wn*or-pn*Dt)/dt,Vn=(wn*Dt+pn*or)/dt;function Jn(za,Ea){return za*=er,Ea*=Er,[En*za-Nn*Ea+Dt,or-Nn*za-En*Ea]}return Jn.invert=function(za,Ea){return[er*(gn*za-Rn*Ea+Cn),Er*(Vn-Rn*za-gn*Ea)]},Jn}function Eo(dt){return zl(function(){return dt})()}function zl(dt){var Dt,or=150,er=480,Er=250,$r=0,pn=0,wn=0,En=0,Nn=0,gn,Rn=0,Cn=1,Vn=1,Jn=null,za=Zt,Ea=null,Fa,Oa,Zn,ha=ln,Ya=.5,Ja,yi,mi,bi,Si;function oi(pa){return mi(pa[0]*p,pa[1]*p)}function xo(pa){return pa=mi.invert(pa[0],pa[1]),pa&&[pa[0]*g,pa[1]*g]}oi.stream=function(pa){return bi&&Si===pa?bi:bi=ol(sl(gn)(za(Ja(ha(Si=pa)))))},oi.preclip=function(pa){return arguments.length?(za=pa,Jn=void 0,Ka()):za},oi.postclip=function(pa){return arguments.length?(ha=pa,Ea=Fa=Oa=Zn=null,Ka()):ha},oi.clipAngle=function(pa){return arguments.length?(za=+pa?Pr(Jn=pa*p):(Jn=null,Zt),Ka()):Jn*g},oi.clipExtent=function(pa){return arguments.length?(ha=pa==null?(Ea=Fa=Oa=Zn=null,ln):An(Ea=+pa[0][0],Fa=+pa[0][1],Oa=+pa[1][0],Zn=+pa[1][1]),Ka()):Ea==null?null:[[Ea,Fa],[Oa,Zn]]},oi.scale=function(pa){return arguments.length?(or=+pa,to()):or},oi.translate=function(pa){return arguments.length?(er=+pa[0],Er=+pa[1],to()):[er,Er]},oi.center=function(pa){return arguments.length?($r=pa[0]%360*p,pn=pa[1]%360*p,to()):[$r*g,pn*g]},oi.rotate=function(pa){return arguments.length?(wn=pa[0]%360*p,En=pa[1]%360*p,Nn=pa.length>2?pa[2]%360*p:0,to()):[wn*g,En*g,Nn*g]},oi.angle=function(pa){return arguments.length?(Rn=pa%360*p,to()):Rn*g},oi.reflectX=function(pa){return arguments.length?(Cn=pa?-1:1,to()):Cn<0},oi.reflectY=function(pa){return arguments.length?(Vn=pa?-1:1,to()):Vn<0},oi.precision=function(pa){return arguments.length?(Ja=Cu(yi,Ya=pa*pa),Ka()):l(Ya)},oi.fitExtent=function(pa,_i){return ds(oi,pa,_i)},oi.fitSize=function(pa,_i){return yl(oi,pa,_i)},oi.fitWidth=function(pa,_i){return jl(oi,pa,_i)},oi.fitHeight=function(pa,_i){return su(oi,pa,_i)};function to(){var pa=gs(or,0,0,Cn,Vn,Rn).apply(null,Dt($r,pn)),_i=(Rn?gs:Kl)(or,er-pa[0],Er-pa[1],Cn,Vn,Rn);return gn=ht(wn,En,Nn),yi=rt(Dt,_i),mi=rt(gn,yi),Ja=Cu(yi,Ya),Ka()}function Ka(){return bi=Si=null,oi}return function(){return Dt=dt.apply(this,arguments),oi.invert=Dt.invert&&xo,to()}}function As(dt){var Dt=0,or=t/3,er=zl(dt),Er=er(Dt,or);return Er.parallels=function($r){return arguments.length?er(Dt=$r[0]*p,or=$r[1]*p):[Dt*g,or*g]},Er}function Ms(dt){var Dt=u(dt);function or(er,Er){return[er*Dt,v(Er)/Dt]}return or.invert=function(er,Er){return[er/Dt,k(Er*Dt)]},or}function lo(dt,Dt){var or=v(dt),er=(or+v(Dt))/2;if(y(er)<n)return Ms(dt);var Er=1+or*(2*er-or),$r=l(Er)/er;function pn(wn,En){var Nn=l(Er-2*er*v(En))/er;return[Nn*v(wn*=er),$r-Nn*u(wn)]}return pn.invert=function(wn,En){var Nn=$r-En,gn=m(wn,y(Nn))*b(Nn);return Nn*er<0&&(gn-=t*b(wn)*b(Nn)),[gn/er,k((Er-(wn*wn+Nn*Nn)*er*er)/(2*er))]},pn}function ml(){return As(lo).scale(155.424).center([0,33.6442])}function xl(){return ml().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Zs(dt){var Dt=dt.length;return{point:function(or,er){for(var Er=-1;++Er<Dt;)dt[Er].point(or,er)},sphere:function(){for(var or=-1;++or<Dt;)dt[or].sphere()},lineStart:function(){for(var or=-1;++or<Dt;)dt[or].lineStart()},lineEnd:function(){for(var or=-1;++or<Dt;)dt[or].lineEnd()},polygonStart:function(){for(var or=-1;++or<Dt;)dt[or].polygonStart()},polygonEnd:function(){for(var or=-1;++or<Dt;)dt[or].polygonEnd()}}}function ys(){var dt,Dt,or=xl(),er,Er=ml().rotate([154,0]).center([-2,58.5]).parallels([55,65]),$r,pn=ml().rotate([157,0]).center([-3,19.9]).parallels([8,18]),wn,En,Nn={point:function(Cn,Vn){En=[Cn,Vn]}};function gn(Cn){var Vn=Cn[0],Jn=Cn[1];return En=null,er.point(Vn,Jn),En||($r.point(Vn,Jn),En)||(wn.point(Vn,Jn),En)}gn.invert=function(Cn){var Vn=or.scale(),Jn=or.translate(),za=(Cn[0]-Jn[0])/Vn,Ea=(Cn[1]-Jn[1])/Vn;return(Ea>=.12&&Ea<.234&&za>=-.425&&za<-.214?Er:Ea>=.166&&Ea<.234&&za>=-.214&&za<-.115?pn:or).invert(Cn)},gn.stream=function(Cn){return dt&&Dt===Cn?dt:dt=Zs([or.stream(Dt=Cn),Er.stream(Cn),pn.stream(Cn)])},gn.precision=function(Cn){return arguments.length?(or.precision(Cn),Er.precision(Cn),pn.precision(Cn),Rn()):or.precision()},gn.scale=function(Cn){return arguments.length?(or.scale(Cn),Er.scale(Cn*.35),pn.scale(Cn),gn.translate(or.translate())):or.scale()},gn.translate=function(Cn){if(!arguments.length)return or.translate();var Vn=or.scale(),Jn=+Cn[0],za=+Cn[1];return er=or.translate(Cn).clipExtent([[Jn-.455*Vn,za-.238*Vn],[Jn+.455*Vn,za+.238*Vn]]).stream(Nn),$r=Er.translate([Jn-.307*Vn,za+.201*Vn]).clipExtent([[Jn-.425*Vn+n,za+.12*Vn+n],[Jn-.214*Vn-n,za+.234*Vn-n]]).stream(Nn),wn=pn.translate([Jn-.205*Vn,za+.212*Vn]).clipExtent([[Jn-.214*Vn+n,za+.166*Vn+n],[Jn-.115*Vn-n,za+.234*Vn-n]]).stream(Nn),Rn()},gn.fitExtent=function(Cn,Vn){return ds(gn,Cn,Vn)},gn.fitSize=function(Cn,Vn){return yl(gn,Cn,Vn)},gn.fitWidth=function(Cn,Vn){return jl(gn,Cn,Vn)},gn.fitHeight=function(Cn,Vn){return su(gn,Cn,Vn)};function Rn(){return dt=Dt=null,gn}return gn.scale(1070)}function bl(dt){return function(Dt,or){var er=u(Dt),Er=u(or),$r=dt(er*Er);return[$r*Er*v(Dt),$r*v(or)]}}function ll(dt){return function(Dt,or){var er=l(Dt*Dt+or*or),Er=dt(er),$r=v(Er),pn=u(Er);return[m(Dt*$r,er*pn),k(er&&or*$r/er)]}}var Fl=bl(function(dt){return l(2/(1+dt))});Fl.invert=ll(function(dt){return 2*k(dt/2)});function _l(){return Eo(Fl).scale(124.75).clipAngle(180-.001)}var js=bl(function(dt){return(dt=S(dt))&&dt/v(dt)});js.invert=ll(function(dt){return dt});function Lu(){return Eo(js).scale(79.4188).clipAngle(180-.001)}function ns(dt,Dt){return[dt,A(L((f+Dt)/2))]}ns.invert=function(dt,Dt){return[dt,2*h(s(Dt))-f]};function Yu(){return Jl(ns).scale(961/i)}function Jl(dt){var Dt=Eo(dt),or=Dt.center,er=Dt.scale,Er=Dt.translate,$r=Dt.clipExtent,pn=null,wn,En,Nn;Dt.scale=function(Rn){return arguments.length?(er(Rn),gn()):er()},Dt.translate=function(Rn){return arguments.length?(Er(Rn),gn()):Er()},Dt.center=function(Rn){return arguments.length?(or(Rn),gn()):or()},Dt.clipExtent=function(Rn){return arguments.length?(Rn==null?pn=wn=En=Nn=null:(pn=+Rn[0][0],wn=+Rn[0][1],En=+Rn[1][0],Nn=+Rn[1][1]),gn()):pn==null?null:[[pn,wn],[En,Nn]]};function gn(){var Rn=t*er(),Cn=Dt(Ft(Dt.rotate()).invert([0,0]));return $r(pn==null?[[Cn[0]-Rn,Cn[1]-Rn],[Cn[0]+Rn,Cn[1]+Rn]]:dt===ns?[[Math.max(Cn[0]-Rn,pn),wn],[Math.min(Cn[0]+Rn,En),Nn]]:[[pn,Math.max(Cn[1]-Rn,wn)],[En,Math.min(Cn[1]+Rn,Nn)]])}return gn()}function ul(dt){return L((f+dt)/2)}function wl(dt,Dt){var or=u(dt),er=dt===Dt?v(dt):A(or/u(Dt))/A(ul(Dt)/ul(dt)),Er=or*x(ul(dt),er)/er;if(!er)return ns;function $r(pn,wn){Er>0?wn<-f+n&&(wn=-f+n):wn>f-n&&(wn=f-n);var En=Er/x(ul(wn),er);return[En*v(er*pn),Er-En*u(er*pn)]}return $r.invert=function(pn,wn){var En=Er-wn,Nn=b(er)*l(pn*pn+En*En),gn=m(pn,y(En))*b(En);return En*er<0&&(gn-=t*b(pn)*b(En)),[gn/er,2*h(x(Er/Nn,1/er))-f]},$r}function Ks(){return As(wl).scale(109.5).parallels([30,30])}function Tl(dt,Dt){return[dt,Dt]}Tl.invert=Tl;function fu(){return Eo(Tl).scale(152.63)}function cu(dt,Dt){var or=u(dt),er=dt===Dt?v(dt):(or-u(Dt))/(Dt-dt),Er=or/er+dt;if(y(er)<n)return Tl;function $r(pn,wn){var En=Er-wn,Nn=er*pn;return[En*v(Nn),Er-En*u(Nn)]}return $r.invert=function(pn,wn){var En=Er-wn,Nn=m(pn,y(En))*b(En);return En*er<0&&(Nn-=t*b(pn)*b(En)),[Nn/er,Er-b(er)*l(pn*pn+En*En)]},$r}function Wu(){return As(cu).scale(131.154).center([0,13.9389])}var zi=1.340264,fl=-.081106,Js=893e-6,$o=.003796,as=l(3)/2,Al=12;function uo(dt,Dt){var or=k(as*v(Dt)),er=or*or,Er=er*er*er;return[dt*u(or)/(as*(zi+3*fl*er+Er*(7*Js+9*$o*er))),or*(zi+fl*er+Er*(Js+$o*er))]}uo.invert=function(dt,Dt){for(var or=Dt,er=or*or,Er=er*er*er,$r=0,pn,wn,En;$r<Al&&(wn=or*(zi+fl*er+Er*(Js+$o*er))-Dt,En=zi+3*fl*er+Er*(7*Js+9*$o*er),or-=pn=wn/En,er=or*or,Er=er*er*er,!(y(pn)<r));++$r);return[as*dt*(zi+3*fl*er+Er*(7*Js+9*$o*er))/u(or),k(v(or)/as)]};function hu(){return Eo(uo).scale(177.158)}function is(dt,Dt){var or=u(Dt),er=u(dt)*or;return[or*v(dt)/er,v(Dt)/er]}is.invert=ll(h);function Fs(){return Eo(is).scale(144.049).clipAngle(60)}function Os(){var dt=1,Dt=0,or=0,er=1,Er=1,$r=0,pn,wn,En=null,Nn,gn,Rn,Cn=1,Vn=1,Jn=Xs({point:function(ha,Ya){var Ja=Zn([ha,Ya]);this.stream.point(Ja[0],Ja[1])}}),za=ln,Ea,Fa;function Oa(){return Cn=dt*er,Vn=dt*Er,Ea=Fa=null,Zn}function Zn(ha){var Ya=ha[0]*Cn,Ja=ha[1]*Vn;if($r){var yi=Ja*pn-Ya*wn;Ya=Ya*pn+Ja*wn,Ja=yi}return[Ya+Dt,Ja+or]}return Zn.invert=function(ha){var Ya=ha[0]-Dt,Ja=ha[1]-or;if($r){var yi=Ja*pn+Ya*wn;Ya=Ya*pn-Ja*wn,Ja=yi}return[Ya/Cn,Ja/Vn]},Zn.stream=function(ha){return Ea&&Fa===ha?Ea:Ea=Jn(za(Fa=ha))},Zn.postclip=function(ha){return arguments.length?(za=ha,En=Nn=gn=Rn=null,Oa()):za},Zn.clipExtent=function(ha){return arguments.length?(za=ha==null?(En=Nn=gn=Rn=null,ln):An(En=+ha[0][0],Nn=+ha[0][1],gn=+ha[1][0],Rn=+ha[1][1]),Oa()):En==null?null:[[En,Nn],[gn,Rn]]},Zn.scale=function(ha){return arguments.length?(dt=+ha,Oa()):dt},Zn.translate=function(ha){return arguments.length?(Dt=+ha[0],or=+ha[1],Oa()):[Dt,or]},Zn.angle=function(ha){return arguments.length?($r=ha%360*p,wn=v($r),pn=u($r),Oa()):$r*g},Zn.reflectX=function(ha){return arguments.length?(er=ha?-1:1,Oa()):er<0},Zn.reflectY=function(ha){return arguments.length?(Er=ha?-1:1,Oa()):Er<0},Zn.fitExtent=function(ha,Ya){return ds(Zn,ha,Ya)},Zn.fitSize=function(ha,Ya){return yl(Zn,ha,Ya)},Zn.fitWidth=function(ha,Ya){return jl(Zn,ha,Ya)},Zn.fitHeight=function(ha,Ya){return su(Zn,ha,Ya)},Zn}function Ss(dt,Dt){var or=Dt*Dt,er=or*or;return[dt*(.8707-.131979*or+er*(-.013791+er*(.003971*or-.001529*er))),Dt*(1.007226+or*(.015085+er*(-.044475+.028874*or-.005916*er)))]}Ss.invert=function(dt,Dt){var or=Dt,er=25,Er;do{var $r=or*or,pn=$r*$r;or-=Er=(or*(1.007226+$r*(.015085+pn*(-.044475+.028874*$r-.005916*pn)))-Dt)/(1.007226+$r*(.015085*3+pn*(-.044475*7+.028874*9*$r-.005916*11*pn)))}while(y(Er)>n&&--er>0);return[dt/(.8707+($r=or*or)*(-.131979+$r*(-.013791+$r*$r*$r*(.003971-.001529*$r)))),or]};function os(){return Eo(Ss).scale(175.295)}function Gi(dt,Dt){return[u(Dt)*v(dt),v(Dt)]}Gi.invert=ll(k);function Co(){return Eo(Gi).scale(249.5).clipAngle(90+n)}function ss(dt,Dt){var or=u(Dt),er=1+u(dt)*or;return[or*v(dt)/er,v(Dt)/er]}ss.invert=ll(function(dt){return 2*h(dt)});function vu(){return Eo(ss).scale(250).clipAngle(142)}function Ol(dt,Dt){return[A(L((f+Dt)/2)),-dt]}Ol.invert=function(dt,Dt){return[-Dt,2*h(s(dt))-f]};function pu(){var dt=Jl(Ol),Dt=dt.center,or=dt.rotate;return dt.center=function(er){return arguments.length?Dt([-er[1],er[0]]):(er=Dt(),[er[1],-er[0]])},dt.rotate=function(er){return arguments.length?or([er[0],er[1],er.length>2?er[2]+90:90]):(er=or(),[er[0],er[1],er[2]-90])},or([0,0,90]).scale(159.155)}w.geoAlbers=xl,w.geoAlbersUsa=ys,w.geoArea=W,w.geoAzimuthalEqualArea=_l,w.geoAzimuthalEqualAreaRaw=Fl,w.geoAzimuthalEquidistant=Lu,w.geoAzimuthalEquidistantRaw=js,w.geoBounds=at,w.geoCentroid=We,w.geoCircle=_r,w.geoClipAntimeridian=Zt,w.geoClipCircle=Pr,w.geoClipExtent=$n,w.geoClipRectangle=An,w.geoConicConformal=Ks,w.geoConicConformalRaw=wl,w.geoConicEqualArea=ml,w.geoConicEqualAreaRaw=lo,w.geoConicEquidistant=Wu,w.geoConicEquidistantRaw=cu,w.geoContains=vr,w.geoDistance=_n,w.geoEqualEarth=hu,w.geoEqualEarthRaw=uo,w.geoEquirectangular=fu,w.geoEquirectangularRaw=Tl,w.geoGnomonic=Fs,w.geoGnomonicRaw=is,w.geoGraticule=un,w.geoGraticule10=kn,w.geoIdentity=Os,w.geoInterpolate=bn,w.geoLength=wr,w.geoMercator=Yu,w.geoMercatorRaw=ns,w.geoNaturalEarth1=os,w.geoNaturalEarth1Raw=Ss,w.geoOrthographic=Co,w.geoOrthographicRaw=Gi,w.geoPath=Dl,w.geoProjection=Eo,w.geoProjectionMutator=zl,w.geoRotation=Ft,w.geoStereographic=vu,w.geoStereographicRaw=ss,w.geoStream=V,w.geoTransform=Eu,w.geoTransverseMercator=pu,w.geoTransverseMercatorRaw=Ol,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-array":107}],115:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne):(w=w||self,c(w.d3=w.d3||{}))})(this,function(w){function c(je,ke){return je.parent===ke.parent?1:2}function M(je){return je.reduce(T,0)/je.length}function T(je,ke){return je+ke.x}function e(je){return 1+je.reduce(a,0)}function a(je,ke){return Math.max(je,ke.y)}function n(je){for(var ke;ke=je.children;)je=ke[0];return je}function r(je){for(var ke;ke=je.children;)je=ke[ke.length-1];return je}function t(){var je=c,ke=1,Ye=1,Ke=!1;function st(Et){var bt,zt=0;Et.eachAfter(function(qt){var lr=qt.children;lr?(qt.x=M(lr),qt.y=e(lr)):(qt.x=bt?zt+=je(qt,bt):0,qt.y=0,bt=qt)});var $t=n(Et),Ot=r(Et),Qt=$t.x-je($t,Ot)/2,tr=Ot.x+je(Ot,$t)/2;return Et.eachAfter(Ke?function(qt){qt.x=(qt.x-Et.x)*ke,qt.y=(Et.y-qt.y)*Ye}:function(qt){qt.x=(qt.x-Qt)/(tr-Qt)*ke,qt.y=(1-(Et.y?qt.y/Et.y:1))*Ye})}return st.separation=function(Et){return arguments.length?(je=Et,st):je},st.size=function(Et){return arguments.length?(Ke=!1,ke=+Et[0],Ye=+Et[1],st):Ke?null:[ke,Ye]},st.nodeSize=function(Et){return arguments.length?(Ke=!0,ke=+Et[0],Ye=+Et[1],st):Ke?[ke,Ye]:null},st}function f(je){var ke=0,Ye=je.children,Ke=Ye&&Ye.length;if(!Ke)ke=1;else for(;--Ke>=0;)ke+=Ye[Ke].value;je.value=ke}function o(){return this.eachAfter(f)}function i(je){var ke=this,Ye,Ke=[ke],st,Et,bt;do for(Ye=Ke.reverse(),Ke=[];ke=Ye.pop();)if(je(ke),st=ke.children,st)for(Et=0,bt=st.length;Et<bt;++Et)Ke.push(st[Et]);while(Ke.length);return this}function g(je){for(var ke=this,Ye=[ke],Ke,st;ke=Ye.pop();)if(je(ke),Ke=ke.children,Ke)for(st=Ke.length-1;st>=0;--st)Ye.push(Ke[st]);return this}function p(je){for(var ke=this,Ye=[ke],Ke=[],st,Et,bt;ke=Ye.pop();)if(Ke.push(ke),st=ke.children,st)for(Et=0,bt=st.length;Et<bt;++Et)Ye.push(st[Et]);for(;ke=Ke.pop();)je(ke);return this}function y(je){return this.eachAfter(function(ke){for(var Ye=+je(ke.data)||0,Ke=ke.children,st=Ke&&Ke.length;--st>=0;)Ye+=Ke[st].value;ke.value=Ye})}function h(je){return this.eachBefore(function(ke){ke.children&&ke.children.sort(je)})}function m(je){for(var ke=this,Ye=u(ke,je),Ke=[ke];ke!==Ye;)ke=ke.parent,Ke.push(ke);for(var st=Ke.length;je!==Ye;)Ke.splice(st,0,je),je=je.parent;return Ke}function u(je,ke){if(je===ke)return je;var Ye=je.ancestors(),Ke=ke.ancestors(),st=null;for(je=Ye.pop(),ke=Ke.pop();je===ke;)st=je,je=Ye.pop(),ke=Ke.pop();return st}function _(){for(var je=this,ke=[je];je=je.parent;)ke.push(je);return ke}function s(){var je=[];return this.each(function(ke){je.push(ke)}),je}function A(){var je=[];return this.eachBefore(function(ke){ke.children||je.push(ke)}),je}function x(){var je=this,ke=[];return je.each(function(Ye){Ye!==je&&ke.push({source:Ye.parent,target:Ye})}),ke}function v(je,ke){var Ye=new k(je),Ke=+je.value&&(Ye.value=je.value),st,Et=[Ye],bt,zt,$t,Ot;for(ke==null&&(ke=l);st=Et.pop();)if(Ke&&(st.value=+st.data.value),(zt=ke(st.data))&&(Ot=zt.length))for(st.children=new Array(Ot),$t=Ot-1;$t>=0;--$t)Et.push(bt=st.children[$t]=new k(zt[$t])),bt.parent=st,bt.depth=st.depth+1;return Ye.eachBefore(S)}function b(){return v(this).eachBefore(L)}function l(je){return je.children}function L(je){je.data=je.data.data}function S(je){var ke=0;do je.height=ke;while((je=je.parent)&&je.height<++ke)}function k(je){this.data=je,this.depth=this.height=0,this.parent=null}k.prototype=v.prototype={constructor:k,count:o,each:i,eachAfter:p,eachBefore:g,sum:y,sort:h,path:m,ancestors:_,descendants:s,leaves:A,links:x,copy:b};var P=Array.prototype.slice;function z(je){for(var ke=je.length,Ye,Ke;ke;)Ke=Math.random()*ke--|0,Ye=je[ke],je[ke]=je[Ke],je[Ke]=Ye;return je}function I(je){for(var ke=0,Ye=(je=z(P.call(je))).length,Ke=[],st,Et;ke<Ye;)st=je[ke],Et&&B(Et,st)?++ke:(Et=V(Ke=D(Ke,st)),ke=0);return Et}function D(je,ke){var Ye,Ke;if(F(ke,je))return[ke];for(Ye=0;Ye<je.length;++Ye)if(R(ke,je[Ye])&&F(J(je[Ye],ke),je))return[je[Ye],ke];for(Ye=0;Ye<je.length-1;++Ye)for(Ke=Ye+1;Ke<je.length;++Ke)if(R(J(je[Ye],je[Ke]),ke)&&R(J(je[Ye],ke),je[Ke])&&R(J(je[Ke],ke),je[Ye])&&F(j(je[Ye],je[Ke],ke),je))return[je[Ye],je[Ke],ke];throw new Error}function R(je,ke){var Ye=je.r-ke.r,Ke=ke.x-je.x,st=ke.y-je.y;return Ye<0||Ye*Ye<Ke*Ke+st*st}function B(je,ke){var Ye=je.r-ke.r+1e-6,Ke=ke.x-je.x,st=ke.y-je.y;return Ye>0&&Ye*Ye>Ke*Ke+st*st}function F(je,ke){for(var Ye=0;Ye<ke.length;++Ye)if(!B(je,ke[Ye]))return!1;return!0}function V(je){switch(je.length){case 1:return G(je[0]);case 2:return J(je[0],je[1]);case 3:return j(je[0],je[1],je[2])}}function G(je){return{x:je.x,y:je.y,r:je.r}}function J(je,ke){var Ye=je.x,Ke=je.y,st=je.r,Et=ke.x,bt=ke.y,zt=ke.r,$t=Et-Ye,Ot=bt-Ke,Qt=zt-st,tr=Math.sqrt($t*$t+Ot*Ot);return{x:(Ye+Et+$t/tr*Qt)/2,y:(Ke+bt+Ot/tr*Qt)/2,r:(tr+st+zt)/2}}function j(je,ke,Ye){var Ke=je.x,st=je.y,Et=je.r,bt=ke.x,zt=ke.y,$t=ke.r,Ot=Ye.x,Qt=Ye.y,tr=Ye.r,qt=Ke-bt,lr=Ke-Ot,Wr=st-zt,cn=st-Qt,Jr=$t-Et,ot=tr-Et,Vt=Ke*Ke+st*st-Et*Et,jt=Vt-bt*bt-zt*zt+$t*$t,Ut=Vt-Ot*Ot-Qt*Qt+tr*tr,yr=lr*Wr-qt*cn,nt=(Wr*Ut-cn*jt)/(yr*2)-Ke,_e=(cn*Jr-Wr*ot)/yr,Me=(lr*jt-qt*Ut)/(yr*2)-st,Ne=(qt*ot-lr*Jr)/yr,We=_e*_e+Ne*Ne-1,Qe=2*(Et+nt*_e+Me*Ne),rt=nt*nt+Me*Me-Et*Et,$e=-(We?(Qe+Math.sqrt(Qe*Qe-4*We*rt))/(2*We):rt/Qe);return{x:Ke+nt+_e*$e,y:st+Me+Ne*$e,r:$e}}function Y(je,ke,Ye){var Ke=je.x-ke.x,st,Et,bt=je.y-ke.y,zt,$t,Ot=Ke*Ke+bt*bt;Ot?(Et=ke.r+Ye.r,Et*=Et,$t=je.r+Ye.r,$t*=$t,Et>$t?(st=(Ot+$t-Et)/(2*Ot),zt=Math.sqrt(Math.max(0,$t/Ot-st*st)),Ye.x=je.x-st*Ke-zt*bt,Ye.y=je.y-st*bt+zt*Ke):(st=(Ot+Et-$t)/(2*Ot),zt=Math.sqrt(Math.max(0,Et/Ot-st*st)),Ye.x=ke.x+st*Ke-zt*bt,Ye.y=ke.y+st*bt+zt*Ke)):(Ye.x=ke.x+Ye.r,Ye.y=ke.y)}function X(je,ke){var Ye=je.r+ke.r-1e-6,Ke=ke.x-je.x,st=ke.y-je.y;return Ye>0&&Ye*Ye>Ke*Ke+st*st}function oe(je){var ke=je._,Ye=je.next._,Ke=ke.r+Ye.r,st=(ke.x*Ye.r+Ye.x*ke.r)/Ke,Et=(ke.y*Ye.r+Ye.y*ke.r)/Ke;return st*st+Et*Et}function se(je){this._=je,this.next=null,this.previous=null}function ie(je){if(!(st=je.length))return 0;var ke,Ye,Ke,st,Et,bt,zt,$t,Ot,Qt,tr;if(ke=je[0],ke.x=0,ke.y=0,!(st>1))return ke.r;if(Ye=je[1],ke.x=-Ye.r,Ye.x=ke.r,Ye.y=0,!(st>2))return ke.r+Ye.r;Y(Ye,ke,Ke=je[2]),ke=new se(ke),Ye=new se(Ye),Ke=new se(Ke),ke.next=Ke.previous=Ye,Ye.next=ke.previous=Ke,Ke.next=Ye.previous=ke;e:for(zt=3;zt<st;++zt){Y(ke._,Ye._,Ke=je[zt]),Ke=new se(Ke),$t=Ye.next,Ot=ke.previous,Qt=Ye._.r,tr=ke._.r;do if(Qt<=tr){if(X($t._,Ke._)){Ye=$t,ke.next=Ye,Ye.previous=ke,--zt;continue e}Qt+=$t._.r,$t=$t.next}else{if(X(Ot._,Ke._)){ke=Ot,ke.next=Ye,Ye.previous=ke,--zt;continue e}tr+=Ot._.r,Ot=Ot.previous}while($t!==Ot.next);for(Ke.previous=ke,Ke.next=Ye,ke.next=Ye.previous=Ye=Ke,Et=oe(ke);(Ke=Ke.next)!==Ye;)(bt=oe(Ke))<Et&&(ke=Ke,Et=bt);Ye=ke.next}for(ke=[Ye._],Ke=Ye;(Ke=Ke.next)!==Ye;)ke.push(Ke._);for(Ke=I(ke),zt=0;zt<st;++zt)ke=je[zt],ke.x-=Ke.x,ke.y-=Ke.y;return Ke.r}function N(je){return ie(je),je}function U(je){return je==null?null:q(je)}function q(je){if(typeof je!="function")throw new Error;return je}function Q(){return 0}function W(je){return function(){return je}}function Z(je){return Math.sqrt(je.value)}function ee(){var je=null,ke=1,Ye=1,Ke=Q;function st(Et){return Et.x=ke/2,Et.y=Ye/2,je?Et.eachBefore(te(je)).eachAfter(ae(Ke,.5)).eachBefore(le(1)):Et.eachBefore(te(Z)).eachAfter(ae(Q,1)).eachAfter(ae(Ke,Et.r/Math.min(ke,Ye))).eachBefore(le(Math.min(ke,Ye)/(2*Et.r))),Et}return st.radius=function(Et){return arguments.length?(je=U(Et),st):je},st.size=function(Et){return arguments.length?(ke=+Et[0],Ye=+Et[1],st):[ke,Ye]},st.padding=function(Et){return arguments.length?(Ke=typeof Et=="function"?Et:W(+Et),st):Ke},st}function te(je){return function(ke){ke.children||(ke.r=Math.max(0,+je(ke)||0))}}function ae(je,ke){return function(Ye){if(Ke=Ye.children){var Ke,st,Et=Ke.length,bt=je(Ye)*ke||0,zt;if(bt)for(st=0;st<Et;++st)Ke[st].r+=bt;if(zt=ie(Ke),bt)for(st=0;st<Et;++st)Ke[st].r-=bt;Ye.r=zt+bt}}}function le(je){return function(ke){var Ye=ke.parent;ke.r*=je,Ye&&(ke.x=Ye.x+je*ke.x,ke.y=Ye.y+je*ke.y)}}function ye(je){je.x0=Math.round(je.x0),je.y0=Math.round(je.y0),je.x1=Math.round(je.x1),je.y1=Math.round(je.y1)}function fe(je,ke,Ye,Ke,st){for(var Et=je.children,bt,zt=-1,$t=Et.length,Ot=je.value&&(Ke-ke)/je.value;++zt<$t;)bt=Et[zt],bt.y0=Ye,bt.y1=st,bt.x0=ke,bt.x1=ke+=bt.value*Ot}function pe(){var je=1,ke=1,Ye=0,Ke=!1;function st(bt){var zt=bt.height+1;return bt.x0=bt.y0=Ye,bt.x1=je,bt.y1=ke/zt,bt.eachBefore(Et(ke,zt)),Ke&&bt.eachBefore(ye),bt}function Et(bt,zt){return function($t){$t.children&&fe($t,$t.x0,bt*($t.depth+1)/zt,$t.x1,bt*($t.depth+2)/zt);var Ot=$t.x0,Qt=$t.y0,tr=$t.x1-Ye,qt=$t.y1-Ye;tr<Ot&&(Ot=tr=(Ot+tr)/2),qt<Qt&&(Qt=qt=(Qt+qt)/2),$t.x0=Ot,$t.y0=Qt,$t.x1=tr,$t.y1=qt}}return st.round=function(bt){return arguments.length?(Ke=!!bt,st):Ke},st.size=function(bt){return arguments.length?(je=+bt[0],ke=+bt[1],st):[je,ke]},st.padding=function(bt){return arguments.length?(Ye=+bt,st):Ye},st}var ge="$",Ae={depth:-1},we={};function De(je){return je.id}function Be(je){return je.parentId}function Ve(){var je=De,ke=Be;function Ye(Ke){var st,Et,bt=Ke.length,zt,$t,Ot,Qt=new Array(bt),tr,qt,lr={};for(Et=0;Et<bt;++Et)st=Ke[Et],Ot=Qt[Et]=new k(st),(tr=je(st,Et,Ke))!=null&&(tr+="")&&(qt=ge+(Ot.id=tr),lr[qt]=qt in lr?we:Ot);for(Et=0;Et<bt;++Et)if(Ot=Qt[Et],tr=ke(Ke[Et],Et,Ke),tr==null||!(tr+="")){if(zt)throw new Error("multiple roots");zt=Ot}else{if($t=lr[ge+tr],!$t)throw new Error("missing: "+tr);if($t===we)throw new Error("ambiguous: "+tr);$t.children?$t.children.push(Ot):$t.children=[Ot],Ot.parent=$t}if(!zt)throw new Error("no root");if(zt.parent=Ae,zt.eachBefore(function(Wr){Wr.depth=Wr.parent.depth+1,--bt}).eachBefore(S),zt.parent=null,bt>0)throw new Error("cycle");return zt}return Ye.id=function(Ke){return arguments.length?(je=q(Ke),Ye):je},Ye.parentId=function(Ke){return arguments.length?(ke=q(Ke),Ye):ke},Ye}function xe(je,ke){return je.parent===ke.parent?1:2}function Le(je){var ke=je.children;return ke?ke[0]:je.t}function He(je){var ke=je.children;return ke?ke[ke.length-1]:je.t}function Je(je,ke,Ye){var Ke=Ye/(ke.i-je.i);ke.c-=Ke,ke.s+=Ye,je.c+=Ke,ke.z+=Ye,ke.m+=Ye}function Oe(je){for(var ke=0,Ye=0,Ke=je.children,st=Ke.length,Et;--st>=0;)Et=Ke[st],Et.z+=ke,Et.m+=ke,ke+=Et.s+(Ye+=Et.c)}function Pe(je,ke,Ye){return je.a.parent===ke.parent?je.a:Ye}function Ue(je,ke){this._=je,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=ke}Ue.prototype=Object.create(k.prototype);function vt(je){for(var ke=new Ue(je,0),Ye,Ke=[ke],st,Et,bt,zt;Ye=Ke.pop();)if(Et=Ye._.children)for(Ye.children=new Array(zt=Et.length),bt=zt-1;bt>=0;--bt)Ke.push(st=Ye.children[bt]=new Ue(Et[bt],bt)),st.parent=Ye;return(ke.parent=new Ue(null,0)).children=[ke],ke}function Lt(){var je=xe,ke=1,Ye=1,Ke=null;function st(Ot){var Qt=vt(Ot);if(Qt.eachAfter(Et),Qt.parent.m=-Qt.z,Qt.eachBefore(bt),Ke)Ot.eachBefore($t);else{var tr=Ot,qt=Ot,lr=Ot;Ot.eachBefore(function(Vt){Vt.x<tr.x&&(tr=Vt),Vt.x>qt.x&&(qt=Vt),Vt.depth>lr.depth&&(lr=Vt)});var Wr=tr===qt?1:je(tr,qt)/2,cn=Wr-tr.x,Jr=ke/(qt.x+Wr+cn),ot=Ye/(lr.depth||1);Ot.eachBefore(function(Vt){Vt.x=(Vt.x+cn)*Jr,Vt.y=Vt.depth*ot})}return Ot}function Et(Ot){var Qt=Ot.children,tr=Ot.parent.children,qt=Ot.i?tr[Ot.i-1]:null;if(Qt){Oe(Ot);var lr=(Qt[0].z+Qt[Qt.length-1].z)/2;qt?(Ot.z=qt.z+je(Ot._,qt._),Ot.m=Ot.z-lr):Ot.z=lr}else qt&&(Ot.z=qt.z+je(Ot._,qt._));Ot.parent.A=zt(Ot,qt,Ot.parent.A||tr[0])}function bt(Ot){Ot._.x=Ot.z+Ot.parent.m,Ot.m+=Ot.parent.m}function zt(Ot,Qt,tr){if(Qt){for(var qt=Ot,lr=Ot,Wr=Qt,cn=qt.parent.children[0],Jr=qt.m,ot=lr.m,Vt=Wr.m,jt=cn.m,Ut;Wr=He(Wr),qt=Le(qt),Wr&&qt;)cn=Le(cn),lr=He(lr),lr.a=Ot,Ut=Wr.z+Vt-qt.z-Jr+je(Wr._,qt._),Ut>0&&(Je(Pe(Wr,Ot,tr),Ot,Ut),Jr+=Ut,ot+=Ut),Vt+=Wr.m,Jr+=qt.m,jt+=cn.m,ot+=lr.m;Wr&&!He(lr)&&(lr.t=Wr,lr.m+=Vt-ot),qt&&!Le(cn)&&(cn.t=qt,cn.m+=Jr-jt,tr=Ot)}return tr}function $t(Ot){Ot.x*=ke,Ot.y=Ot.depth*Ye}return st.separation=function(Ot){return arguments.length?(je=Ot,st):je},st.size=function(Ot){return arguments.length?(Ke=!1,ke=+Ot[0],Ye=+Ot[1],st):Ke?null:[ke,Ye]},st.nodeSize=function(Ot){return arguments.length?(Ke=!0,ke=+Ot[0],Ye=+Ot[1],st):Ke?[ke,Ye]:null},st}function Yt(je,ke,Ye,Ke,st){for(var Et=je.children,bt,zt=-1,$t=Et.length,Ot=je.value&&(st-Ye)/je.value;++zt<$t;)bt=Et[zt],bt.x0=ke,bt.x1=Ke,bt.y0=Ye,bt.y1=Ye+=bt.value*Ot}var At=(1+Math.sqrt(5))/2;function Rt(je,ke,Ye,Ke,st,Et){for(var bt=[],zt=ke.children,$t,Ot,Qt=0,tr=0,qt=zt.length,lr,Wr,cn=ke.value,Jr,ot,Vt,jt,Ut,yr,nt;Qt<qt;){lr=st-Ye,Wr=Et-Ke;do Jr=zt[tr++].value;while(!Jr&&tr<qt);for(ot=Vt=Jr,yr=Math.max(Wr/lr,lr/Wr)/(cn*je),nt=Jr*Jr*yr,Ut=Math.max(Vt/nt,nt/ot);tr<qt;++tr){if(Jr+=Ot=zt[tr].value,Ot<ot&&(ot=Ot),Ot>Vt&&(Vt=Ot),nt=Jr*Jr*yr,jt=Math.max(Vt/nt,nt/ot),jt>Ut){Jr-=Ot;break}Ut=jt}bt.push($t={value:Jr,dice:lr<Wr,children:zt.slice(Qt,tr)}),$t.dice?fe($t,Ye,Ke,st,cn?Ke+=Wr*Jr/cn:Et):Yt($t,Ye,Ke,cn?Ye+=lr*Jr/cn:st,Et),cn-=Jr,Qt=tr}return bt}var Bt=function je(ke){function Ye(Ke,st,Et,bt,zt){Rt(ke,Ke,st,Et,bt,zt)}return Ye.ratio=function(Ke){return je((Ke=+Ke)>1?Ke:1)},Ye}(At);function Mt(){var je=Bt,ke=!1,Ye=1,Ke=1,st=[0],Et=Q,bt=Q,zt=Q,$t=Q,Ot=Q;function Qt(qt){return qt.x0=qt.y0=0,qt.x1=Ye,qt.y1=Ke,qt.eachBefore(tr),st=[0],ke&&qt.eachBefore(ye),qt}function tr(qt){var lr=st[qt.depth],Wr=qt.x0+lr,cn=qt.y0+lr,Jr=qt.x1-lr,ot=qt.y1-lr;Jr<Wr&&(Wr=Jr=(Wr+Jr)/2),ot<cn&&(cn=ot=(cn+ot)/2),qt.x0=Wr,qt.y0=cn,qt.x1=Jr,qt.y1=ot,qt.children&&(lr=st[qt.depth+1]=Et(qt)/2,Wr+=Ot(qt)-lr,cn+=bt(qt)-lr,Jr-=zt(qt)-lr,ot-=$t(qt)-lr,Jr<Wr&&(Wr=Jr=(Wr+Jr)/2),ot<cn&&(cn=ot=(cn+ot)/2),je(qt,Wr,cn,Jr,ot))}return Qt.round=function(qt){return arguments.length?(ke=!!qt,Qt):ke},Qt.size=function(qt){return arguments.length?(Ye=+qt[0],Ke=+qt[1],Qt):[Ye,Ke]},Qt.tile=function(qt){return arguments.length?(je=q(qt),Qt):je},Qt.padding=function(qt){return arguments.length?Qt.paddingInner(qt).paddingOuter(qt):Qt.paddingInner()},Qt.paddingInner=function(qt){return arguments.length?(Et=typeof qt=="function"?qt:W(+qt),Qt):Et},Qt.paddingOuter=function(qt){return arguments.length?Qt.paddingTop(qt).paddingRight(qt).paddingBottom(qt).paddingLeft(qt):Qt.paddingTop()},Qt.paddingTop=function(qt){return arguments.length?(bt=typeof qt=="function"?qt:W(+qt),Qt):bt},Qt.paddingRight=function(qt){return arguments.length?(zt=typeof qt=="function"?qt:W(+qt),Qt):zt},Qt.paddingBottom=function(qt){return arguments.length?($t=typeof qt=="function"?qt:W(+qt),Qt):$t},Qt.paddingLeft=function(qt){return arguments.length?(Ot=typeof qt=="function"?qt:W(+qt),Qt):Ot},Qt}function Tt(je,ke,Ye,Ke,st){var Et=je.children,bt,zt=Et.length,$t,Ot=new Array(zt+1);for(Ot[0]=$t=bt=0;bt<zt;++bt)Ot[bt+1]=$t+=Et[bt].value;Qt(0,zt,je.value,ke,Ye,Ke,st);function Qt(tr,qt,lr,Wr,cn,Jr,ot){if(tr>=qt-1){var Vt=Et[tr];Vt.x0=Wr,Vt.y0=cn,Vt.x1=Jr,Vt.y1=ot;return}for(var jt=Ot[tr],Ut=lr/2+jt,yr=tr+1,nt=qt-1;yr<nt;){var _e=yr+nt>>>1;Ot[_e]<Ut?yr=_e+1:nt=_e}Ut-Ot[yr-1]<Ot[yr]-Ut&&tr+1<yr&&--yr;var Me=Ot[yr]-jt,Ne=lr-Me;if(Jr-Wr>ot-cn){var We=(Wr*Ne+Jr*Me)/lr;Qt(tr,yr,Me,Wr,cn,We,ot),Qt(yr,qt,Ne,We,cn,Jr,ot)}else{var Qe=(cn*Ne+ot*Me)/lr;Qt(tr,yr,Me,Wr,cn,Jr,Qe),Qt(yr,qt,Ne,Wr,Qe,Jr,ot)}}}function at(je,ke,Ye,Ke,st){(je.depth&1?Yt:fe)(je,ke,Ye,Ke,st)}var ct=function je(ke){function Ye(Ke,st,Et,bt,zt){if(($t=Ke._squarify)&&$t.ratio===ke)for(var $t,Ot,Qt,tr,qt=-1,lr,Wr=$t.length,cn=Ke.value;++qt<Wr;){for(Ot=$t[qt],Qt=Ot.children,tr=Ot.value=0,lr=Qt.length;tr<lr;++tr)Ot.value+=Qt[tr].value;Ot.dice?fe(Ot,st,Et,bt,Et+=(zt-Et)*Ot.value/cn):Yt(Ot,st,Et,st+=(bt-st)*Ot.value/cn,zt),cn-=Ot.value}else Ke._squarify=$t=Rt(ke,Ke,st,Et,bt,zt),$t.ratio=ke}return Ye.ratio=function(Ke){return je((Ke=+Ke)>1?Ke:1)},Ye}(At);w.cluster=t,w.hierarchy=v,w.pack=ee,w.packEnclose=I,w.packSiblings=N,w.partition=pe,w.stratify=Ve,w.tree=Lt,w.treemap=Mt,w.treemapBinary=Tt,w.treemapDice=fe,w.treemapResquarify=ct,w.treemapSlice=Yt,w.treemapSliceDice=at,w.treemapSquarify=Bt,Object.defineProperty(w,"__esModule",{value:!0})})},{}],116:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne,d("d3-color")):(w=w||self,c(w.d3=w.d3||{},w.d3))})(this,function(w,c){function M(xe,Le,He,Je,Oe){var Pe=xe*xe,Ue=Pe*xe;return((1-3*xe+3*Pe-Ue)*Le+(4-6*Pe+3*Ue)*He+(1+3*xe+3*Pe-3*Ue)*Je+Ue*Oe)/6}function T(xe){var Le=xe.length-1;return function(He){var Je=He<=0?He=0:He>=1?(He=1,Le-1):Math.floor(He*Le),Oe=xe[Je],Pe=xe[Je+1],Ue=Je>0?xe[Je-1]:2*Oe-Pe,vt=Je<Le-1?xe[Je+2]:2*Pe-Oe;return M((He-Je/Le)*Le,Ue,Oe,Pe,vt)}}function e(xe){var Le=xe.length;return function(He){var Je=Math.floor(((He%=1)<0?++He:He)*Le),Oe=xe[(Je+Le-1)%Le],Pe=xe[Je%Le],Ue=xe[(Je+1)%Le],vt=xe[(Je+2)%Le];return M((He-Je/Le)*Le,Oe,Pe,Ue,vt)}}function a(xe){return function(){return xe}}function n(xe,Le){return function(He){return xe+He*Le}}function r(xe,Le,He){return xe=Math.pow(xe,He),Le=Math.pow(Le,He)-xe,He=1/He,function(Je){return Math.pow(xe+Je*Le,He)}}function t(xe,Le){var He=Le-xe;return He?n(xe,He>180||He<-180?He-360*Math.round(He/360):He):a(isNaN(xe)?Le:xe)}function f(xe){return(xe=+xe)==1?o:function(Le,He){return He-Le?r(Le,He,xe):a(isNaN(Le)?He:Le)}}function o(xe,Le){var He=Le-xe;return He?n(xe,He):a(isNaN(xe)?Le:xe)}var i=function xe(Le){var He=f(Le);function Je(Oe,Pe){var Ue=He((Oe=c.rgb(Oe)).r,(Pe=c.rgb(Pe)).r),vt=He(Oe.g,Pe.g),Lt=He(Oe.b,Pe.b),Yt=o(Oe.opacity,Pe.opacity);return function(At){return Oe.r=Ue(At),Oe.g=vt(At),Oe.b=Lt(At),Oe.opacity=Yt(At),Oe+""}}return Je.gamma=xe,Je}(1);function g(xe){return function(Le){var He=Le.length,Je=new Array(He),Oe=new Array(He),Pe=new Array(He),Ue,vt;for(Ue=0;Ue<He;++Ue)vt=c.rgb(Le[Ue]),Je[Ue]=vt.r||0,Oe[Ue]=vt.g||0,Pe[Ue]=vt.b||0;return Je=xe(Je),Oe=xe(Oe),Pe=xe(Pe),vt.opacity=1,function(Lt){return vt.r=Je(Lt),vt.g=Oe(Lt),vt.b=Pe(Lt),vt+""}}}var p=g(T),y=g(e);function h(xe,Le){Le||(Le=[]);var He=xe?Math.min(Le.length,xe.length):0,Je=Le.slice(),Oe;return function(Pe){for(Oe=0;Oe<He;++Oe)Je[Oe]=xe[Oe]*(1-Pe)+Le[Oe]*Pe;return Je}}function m(xe){return ArrayBuffer.isView(xe)&&!(xe instanceof DataView)}function u(xe,Le){return(m(Le)?h:_)(xe,Le)}function _(xe,Le){var He=Le?Le.length:0,Je=xe?Math.min(He,xe.length):0,Oe=new Array(Je),Pe=new Array(He),Ue;for(Ue=0;Ue<Je;++Ue)Oe[Ue]=k(xe[Ue],Le[Ue]);for(;Ue<He;++Ue)Pe[Ue]=Le[Ue];return function(vt){for(Ue=0;Ue<Je;++Ue)Pe[Ue]=Oe[Ue](vt);return Pe}}function s(xe,Le){var He=new Date;return xe=+xe,Le=+Le,function(Je){return He.setTime(xe*(1-Je)+Le*Je),He}}function A(xe,Le){return xe=+xe,Le=+Le,function(He){return xe*(1-He)+Le*He}}function x(xe,Le){var He={},Je={},Oe;(xe===null||typeof xe!="object")&&(xe={}),(Le===null||typeof Le!="object")&&(Le={});for(Oe in Le)Oe in xe?He[Oe]=k(xe[Oe],Le[Oe]):Je[Oe]=Le[Oe];return function(Pe){for(Oe in He)Je[Oe]=He[Oe](Pe);return Je}}var v=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,b=new RegExp(v.source,"g");function l(xe){return function(){return xe}}function L(xe){return function(Le){return xe(Le)+""}}function S(xe,Le){var He=v.lastIndex=b.lastIndex=0,Je,Oe,Pe,Ue=-1,vt=[],Lt=[];for(xe=xe+"",Le=Le+"";(Je=v.exec(xe))&&(Oe=b.exec(Le));)(Pe=Oe.index)>He&&(Pe=Le.slice(He,Pe),vt[Ue]?vt[Ue]+=Pe:vt[++Ue]=Pe),(Je=Je[0])===(Oe=Oe[0])?vt[Ue]?vt[Ue]+=Oe:vt[++Ue]=Oe:(vt[++Ue]=null,Lt.push({i:Ue,x:A(Je,Oe)})),He=b.lastIndex;return He<Le.length&&(Pe=Le.slice(He),vt[Ue]?vt[Ue]+=Pe:vt[++Ue]=Pe),vt.length<2?Lt[0]?L(Lt[0].x):l(Le):(Le=Lt.length,function(Yt){for(var At=0,Rt;At<Le;++At)vt[(Rt=Lt[At]).i]=Rt.x(Yt);return vt.join("")})}function k(xe,Le){var He=typeof Le,Je;return Le==null||He==="boolean"?a(Le):(He==="number"?A:He==="string"?(Je=c.color(Le))?(Le=Je,i):S:Le instanceof c.color?i:Le instanceof Date?s:m(Le)?h:Array.isArray(Le)?_:typeof Le.valueOf!="function"&&typeof Le.toString!="function"||isNaN(Le)?x:A)(xe,Le)}function P(xe){var Le=xe.length;return function(He){return xe[Math.max(0,Math.min(Le-1,Math.floor(He*Le)))]}}function z(xe,Le){var He=t(+xe,+Le);return function(Je){var Oe=He(Je);return Oe-360*Math.floor(Oe/360)}}function I(xe,Le){return xe=+xe,Le=+Le,function(He){return Math.round(xe*(1-He)+Le*He)}}var D=180/Math.PI,R={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function B(xe,Le,He,Je,Oe,Pe){var Ue,vt,Lt;return(Ue=Math.sqrt(xe*xe+Le*Le))&&(xe/=Ue,Le/=Ue),(Lt=xe*He+Le*Je)&&(He-=xe*Lt,Je-=Le*Lt),(vt=Math.sqrt(He*He+Je*Je))&&(He/=vt,Je/=vt,Lt/=vt),xe*Je<Le*He&&(xe=-xe,Le=-Le,Lt=-Lt,Ue=-Ue),{translateX:Oe,translateY:Pe,rotate:Math.atan2(Le,xe)*D,skewX:Math.atan(Lt)*D,scaleX:Ue,scaleY:vt}}var F,V,G,J;function j(xe){return xe==="none"?R:(F||(F=document.createElement("DIV"),V=document.documentElement,G=document.defaultView),F.style.transform=xe,xe=G.getComputedStyle(V.appendChild(F),null).getPropertyValue("transform"),V.removeChild(F),xe=xe.slice(7,-1).split(","),B(+xe[0],+xe[1],+xe[2],+xe[3],+xe[4],+xe[5]))}function Y(xe){return xe==null||(J||(J=document.createElementNS("http://www.w3.org/2000/svg","g")),J.setAttribute("transform",xe),!(xe=J.transform.baseVal.consolidate()))?R:(xe=xe.matrix,B(xe.a,xe.b,xe.c,xe.d,xe.e,xe.f))}function X(xe,Le,He,Je){function Oe(Yt){return Yt.length?Yt.pop()+" ":""}function Pe(Yt,At,Rt,Bt,Mt,Tt){if(Yt!==Rt||At!==Bt){var at=Mt.push("translate(",null,Le,null,He);Tt.push({i:at-4,x:A(Yt,Rt)},{i:at-2,x:A(At,Bt)})}else(Rt||Bt)&&Mt.push("translate("+Rt+Le+Bt+He)}function Ue(Yt,At,Rt,Bt){Yt!==At?(Yt-At>180?At+=360:At-Yt>180&&(Yt+=360),Bt.push({i:Rt.push(Oe(Rt)+"rotate(",null,Je)-2,x:A(Yt,At)})):At&&Rt.push(Oe(Rt)+"rotate("+At+Je)}function vt(Yt,At,Rt,Bt){Yt!==At?Bt.push({i:Rt.push(Oe(Rt)+"skewX(",null,Je)-2,x:A(Yt,At)}):At&&Rt.push(Oe(Rt)+"skewX("+At+Je)}function Lt(Yt,At,Rt,Bt,Mt,Tt){if(Yt!==Rt||At!==Bt){var at=Mt.push(Oe(Mt)+"scale(",null,",",null,")");Tt.push({i:at-4,x:A(Yt,Rt)},{i:at-2,x:A(At,Bt)})}else(Rt!==1||Bt!==1)&&Mt.push(Oe(Mt)+"scale("+Rt+","+Bt+")")}return function(Yt,At){var Rt=[],Bt=[];return Yt=xe(Yt),At=xe(At),Pe(Yt.translateX,Yt.translateY,At.translateX,At.translateY,Rt,Bt),Ue(Yt.rotate,At.rotate,Rt,Bt),vt(Yt.skewX,At.skewX,Rt,Bt),Lt(Yt.scaleX,Yt.scaleY,At.scaleX,At.scaleY,Rt,Bt),Yt=At=null,function(Mt){for(var Tt=-1,at=Bt.length,ct;++Tt<at;)Rt[(ct=Bt[Tt]).i]=ct.x(Mt);return Rt.join("")}}}var oe=X(j,"px, ","px)","deg)"),se=X(Y,", ",")",")"),ie=Math.SQRT2,N=2,U=4,q=1e-12;function Q(xe){return((xe=Math.exp(xe))+1/xe)/2}function W(xe){return((xe=Math.exp(xe))-1/xe)/2}function Z(xe){return((xe=Math.exp(2*xe))-1)/(xe+1)}function ee(xe,Le){var He=xe[0],Je=xe[1],Oe=xe[2],Pe=Le[0],Ue=Le[1],vt=Le[2],Lt=Pe-He,Yt=Ue-Je,At=Lt*Lt+Yt*Yt,Rt,Bt;if(At<q)Bt=Math.log(vt/Oe)/ie,Rt=function(ke){return[He+ke*Lt,Je+ke*Yt,Oe*Math.exp(ie*ke*Bt)]};else{var Mt=Math.sqrt(At),Tt=(vt*vt-Oe*Oe+U*At)/(2*Oe*N*Mt),at=(vt*vt-Oe*Oe-U*At)/(2*vt*N*Mt),ct=Math.log(Math.sqrt(Tt*Tt+1)-Tt),je=Math.log(Math.sqrt(at*at+1)-at);Bt=(je-ct)/ie,Rt=function(ke){var Ye=ke*Bt,Ke=Q(ct),st=Oe/(N*Mt)*(Ke*Z(ie*Ye+ct)-W(ct));return[He+st*Lt,Je+st*Yt,Oe*Ke/Q(ie*Ye+ct)]}}return Rt.duration=Bt*1e3,Rt}function te(xe){return function(Le,He){var Je=xe((Le=c.hsl(Le)).h,(He=c.hsl(He)).h),Oe=o(Le.s,He.s),Pe=o(Le.l,He.l),Ue=o(Le.opacity,He.opacity);return function(vt){return Le.h=Je(vt),Le.s=Oe(vt),Le.l=Pe(vt),Le.opacity=Ue(vt),Le+""}}}var ae=te(t),le=te(o);function ye(xe,Le){var He=o((xe=c.lab(xe)).l,(Le=c.lab(Le)).l),Je=o(xe.a,Le.a),Oe=o(xe.b,Le.b),Pe=o(xe.opacity,Le.opacity);return function(Ue){return xe.l=He(Ue),xe.a=Je(Ue),xe.b=Oe(Ue),xe.opacity=Pe(Ue),xe+""}}function fe(xe){return function(Le,He){var Je=xe((Le=c.hcl(Le)).h,(He=c.hcl(He)).h),Oe=o(Le.c,He.c),Pe=o(Le.l,He.l),Ue=o(Le.opacity,He.opacity);return function(vt){return Le.h=Je(vt),Le.c=Oe(vt),Le.l=Pe(vt),Le.opacity=Ue(vt),Le+""}}}var pe=fe(t),ge=fe(o);function Ae(xe){return function Le(He){He=+He;function Je(Oe,Pe){var Ue=xe((Oe=c.cubehelix(Oe)).h,(Pe=c.cubehelix(Pe)).h),vt=o(Oe.s,Pe.s),Lt=o(Oe.l,Pe.l),Yt=o(Oe.opacity,Pe.opacity);return function(At){return Oe.h=Ue(At),Oe.s=vt(At),Oe.l=Lt(Math.pow(At,He)),Oe.opacity=Yt(At),Oe+""}}return Je.gamma=Le,Je}(1)}var we=Ae(t),De=Ae(o);function Be(xe,Le){for(var He=0,Je=Le.length-1,Oe=Le[0],Pe=new Array(Je<0?0:Je);He<Je;)Pe[He]=xe(Oe,Oe=Le[++He]);return function(Ue){var vt=Math.max(0,Math.min(Je-1,Math.floor(Ue*=Je)));return Pe[vt](Ue-vt)}}function Ve(xe,Le){for(var He=new Array(Le),Je=0;Je<Le;++Je)He[Je]=xe(Je/(Le-1));return He}w.interpolate=k,w.interpolateArray=u,w.interpolateBasis=T,w.interpolateBasisClosed=e,w.interpolateCubehelix=we,w.interpolateCubehelixLong=De,w.interpolateDate=s,w.interpolateDiscrete=P,w.interpolateHcl=pe,w.interpolateHclLong=ge,w.interpolateHsl=ae,w.interpolateHslLong=le,w.interpolateHue=z,w.interpolateLab=ye,w.interpolateNumber=A,w.interpolateNumberArray=h,w.interpolateObject=x,w.interpolateRgb=i,w.interpolateRgbBasis=p,w.interpolateRgbBasisClosed=y,w.interpolateRound=I,w.interpolateString=S,w.interpolateTransformCss=oe,w.interpolateTransformSvg=se,w.interpolateZoom=ee,w.piecewise=Be,w.quantize=Ve,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-color":109}],117:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne):(w=w||self,c(w.d3=w.d3||{}))})(this,function(w){var c=Math.PI,M=2*c,T=1e-6,e=M-T;function a(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function n(){return new a}a.prototype=n.prototype={constructor:a,moveTo:function(r,t){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(r,t){this._+="L"+(this._x1=+r)+","+(this._y1=+t)},quadraticCurveTo:function(r,t,f,o){this._+="Q"+ +r+","+ +t+","+(this._x1=+f)+","+(this._y1=+o)},bezierCurveTo:function(r,t,f,o,i,g){this._+="C"+ +r+","+ +t+","+ +f+","+ +o+","+(this._x1=+i)+","+(this._y1=+g)},arcTo:function(r,t,f,o,i){r=+r,t=+t,f=+f,o=+o,i=+i;var g=this._x1,p=this._y1,y=f-r,h=o-t,m=g-r,u=p-t,_=m*m+u*u;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=r)+","+(this._y1=t);else if(_>T)if(!(Math.abs(u*y-h*m)>T)||!i)this._+="L"+(this._x1=r)+","+(this._y1=t);else{var s=f-g,A=o-p,x=y*y+h*h,v=s*s+A*A,b=Math.sqrt(x),l=Math.sqrt(_),L=i*Math.tan((c-Math.acos((x+_-v)/(2*b*l)))/2),S=L/l,k=L/b;Math.abs(S-1)>T&&(this._+="L"+(r+S*m)+","+(t+S*u)),this._+="A"+i+","+i+",0,0,"+ +(u*s>m*A)+","+(this._x1=r+k*y)+","+(this._y1=t+k*h)}},arc:function(r,t,f,o,i,g){r=+r,t=+t,f=+f,g=!!g;var p=f*Math.cos(o),y=f*Math.sin(o),h=r+p,m=t+y,u=1^g,_=g?o-i:i-o;if(f<0)throw new Error("negative radius: "+f);this._x1===null?this._+="M"+h+","+m:(Math.abs(this._x1-h)>T||Math.abs(this._y1-m)>T)&&(this._+="L"+h+","+m),f&&(_<0&&(_=_%M+M),_>e?this._+="A"+f+","+f+",0,1,"+u+","+(r-p)+","+(t-y)+"A"+f+","+f+",0,1,"+u+","+(this._x1=h)+","+(this._y1=m):_>T&&(this._+="A"+f+","+f+",0,"+ +(_>=c)+","+u+","+(this._x1=r+f*Math.cos(i))+","+(this._y1=t+f*Math.sin(i))))},rect:function(r,t,f,o){this._+="M"+(this._x0=this._x1=+r)+","+(this._y0=this._y1=+t)+"h"+ +f+"v"+ +o+"h"+-f+"Z"},toString:function(){return this._}},w.path=n,Object.defineProperty(w,"__esModule",{value:!0})})},{}],118:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne):(w=w||self,c(w.d3=w.d3||{}))})(this,function(w){function c(b){var l=+this._x.call(null,b),L=+this._y.call(null,b);return M(this.cover(l,L),l,L,b)}function M(b,l,L,S){if(isNaN(l)||isNaN(L))return b;var k,P=b._root,z={data:S},I=b._x0,D=b._y0,R=b._x1,B=b._y1,F,V,G,J,j,Y,X,oe;if(!P)return b._root=z,b;for(;P.length;)if((j=l>=(F=(I+R)/2))?I=F:R=F,(Y=L>=(V=(D+B)/2))?D=V:B=V,k=P,!(P=P[X=Y<<1|j]))return k[X]=z,b;if(G=+b._x.call(null,P.data),J=+b._y.call(null,P.data),l===G&&L===J)return z.next=P,k?k[X]=z:b._root=z,b;do k=k?k[X]=new Array(4):b._root=new Array(4),(j=l>=(F=(I+R)/2))?I=F:R=F,(Y=L>=(V=(D+B)/2))?D=V:B=V;while((X=Y<<1|j)===(oe=(J>=V)<<1|G>=F));return k[oe]=P,k[X]=z,b}function T(b){var l,L,S=b.length,k,P,z=new Array(S),I=new Array(S),D=1/0,R=1/0,B=-1/0,F=-1/0;for(L=0;L<S;++L)isNaN(k=+this._x.call(null,l=b[L]))||isNaN(P=+this._y.call(null,l))||(z[L]=k,I[L]=P,k<D&&(D=k),k>B&&(B=k),P<R&&(R=P),P>F&&(F=P));if(D>B||R>F)return this;for(this.cover(D,R).cover(B,F),L=0;L<S;++L)M(this,z[L],I[L],b[L]);return this}function e(b,l){if(isNaN(b=+b)||isNaN(l=+l))return this;var L=this._x0,S=this._y0,k=this._x1,P=this._y1;if(isNaN(L))k=(L=Math.floor(b))+1,P=(S=Math.floor(l))+1;else{for(var z=k-L,I=this._root,D,R;L>b||b>=k||S>l||l>=P;)switch(R=(l<S)<<1|b<L,D=new Array(4),D[R]=I,I=D,z*=2,R){case 0:k=L+z,P=S+z;break;case 1:L=k-z,P=S+z;break;case 2:k=L+z,S=P-z;break;case 3:L=k-z,S=P-z;break}this._root&&this._root.length&&(this._root=I)}return this._x0=L,this._y0=S,this._x1=k,this._y1=P,this}function a(){var b=[];return this.visit(function(l){if(!l.length)do b.push(l.data);while(l=l.next)}),b}function n(b){return arguments.length?this.cover(+b[0][0],+b[0][1]).cover(+b[1][0],+b[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function r(b,l,L,S,k){this.node=b,this.x0=l,this.y0=L,this.x1=S,this.y1=k}function t(b,l,L){var S,k=this._x0,P=this._y0,z,I,D,R,B=this._x1,F=this._y1,V=[],G=this._root,J,j;for(G&&V.push(new r(G,k,P,B,F)),L==null?L=1/0:(k=b-L,P=l-L,B=b+L,F=l+L,L*=L);J=V.pop();)if(!(!(G=J.node)||(z=J.x0)>B||(I=J.y0)>F||(D=J.x1)<k||(R=J.y1)<P))if(G.length){var Y=(z+D)/2,X=(I+R)/2;V.push(new r(G[3],Y,X,D,R),new r(G[2],z,X,Y,R),new r(G[1],Y,I,D,X),new r(G[0],z,I,Y,X)),(j=(l>=X)<<1|b>=Y)&&(J=V[V.length-1],V[V.length-1]=V[V.length-1-j],V[V.length-1-j]=J)}else{var oe=b-+this._x.call(null,G.data),se=l-+this._y.call(null,G.data),ie=oe*oe+se*se;if(ie<L){var N=Math.sqrt(L=ie);k=b-N,P=l-N,B=b+N,F=l+N,S=G.data}}return S}function f(b){if(isNaN(B=+this._x.call(null,b))||isNaN(F=+this._y.call(null,b)))return this;var l,L=this._root,S,k,P,z=this._x0,I=this._y0,D=this._x1,R=this._y1,B,F,V,G,J,j,Y,X;if(!L)return this;if(L.length)for(;;){if((J=B>=(V=(z+D)/2))?z=V:D=V,(j=F>=(G=(I+R)/2))?I=G:R=G,l=L,!(L=L[Y=j<<1|J]))return this;if(!L.length)break;(l[Y+1&3]||l[Y+2&3]||l[Y+3&3])&&(S=l,X=Y)}for(;L.data!==b;)if(k=L,!(L=L.next))return this;return(P=L.next)&&delete L.next,k?(P?k.next=P:delete k.next,this):l?(P?l[Y]=P:delete l[Y],(L=l[0]||l[1]||l[2]||l[3])&&L===(l[3]||l[2]||l[1]||l[0])&&!L.length&&(S?S[X]=L:this._root=L),this):(this._root=P,this)}function o(b){for(var l=0,L=b.length;l<L;++l)this.remove(b[l]);return this}function i(){return this._root}function g(){var b=0;return this.visit(function(l){if(!l.length)do++b;while(l=l.next)}),b}function p(b){var l=[],L,S=this._root,k,P,z,I,D;for(S&&l.push(new r(S,this._x0,this._y0,this._x1,this._y1));L=l.pop();)if(!b(S=L.node,P=L.x0,z=L.y0,I=L.x1,D=L.y1)&&S.length){var R=(P+I)/2,B=(z+D)/2;(k=S[3])&&l.push(new r(k,R,B,I,D)),(k=S[2])&&l.push(new r(k,P,B,R,D)),(k=S[1])&&l.push(new r(k,R,z,I,B)),(k=S[0])&&l.push(new r(k,P,z,R,B))}return this}function y(b){var l=[],L=[],S;for(this._root&&l.push(new r(this._root,this._x0,this._y0,this._x1,this._y1));S=l.pop();){var k=S.node;if(k.length){var P,z=S.x0,I=S.y0,D=S.x1,R=S.y1,B=(z+D)/2,F=(I+R)/2;(P=k[0])&&l.push(new r(P,z,I,B,F)),(P=k[1])&&l.push(new r(P,B,I,D,F)),(P=k[2])&&l.push(new r(P,z,F,B,R)),(P=k[3])&&l.push(new r(P,B,F,D,R))}L.push(S)}for(;S=L.pop();)b(S.node,S.x0,S.y0,S.x1,S.y1);return this}function h(b){return b[0]}function m(b){return arguments.length?(this._x=b,this):this._x}function u(b){return b[1]}function _(b){return arguments.length?(this._y=b,this):this._y}function s(b,l,L){var S=new A(l==null?h:l,L==null?u:L,NaN,NaN,NaN,NaN);return b==null?S:S.addAll(b)}function A(b,l,L,S,k,P){this._x=b,this._y=l,this._x0=L,this._y0=S,this._x1=k,this._y1=P,this._root=void 0}function x(b){for(var l={data:b.data},L=l;b=b.next;)L=L.next={data:b.data};return l}var v=s.prototype=A.prototype;v.copy=function(){var b=new A(this._x,this._y,this._x0,this._y0,this._x1,this._y1),l=this._root,L,S;if(!l)return b;if(!l.length)return b._root=x(l),b;for(L=[{source:l,target:b._root=new Array(4)}];l=L.pop();)for(var k=0;k<4;++k)(S=l.source[k])&&(S.length?L.push({source:S,target:l.target[k]=new Array(4)}):l.target[k]=x(S));return b},v.add=c,v.addAll=T,v.cover=e,v.data=a,v.extent=n,v.find=t,v.remove=f,v.removeAll=o,v.root=i,v.size=g,v.visit=p,v.visitAfter=y,v.x=m,v.y=_,w.quadtree=s,Object.defineProperty(w,"__esModule",{value:!0})})},{}],119:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne,d("d3-path")):(w=w||self,c(w.d3=w.d3||{},w.d3))})(this,function(w,c){function M(tt){return function(){return tt}}var T=Math.abs,e=Math.atan2,a=Math.cos,n=Math.max,r=Math.min,t=Math.sin,f=Math.sqrt,o=1e-12,i=Math.PI,g=i/2,p=2*i;function y(tt){return tt>1?0:tt<-1?i:Math.acos(tt)}function h(tt){return tt>=1?g:tt<=-1?-g:Math.asin(tt)}function m(tt){return tt.innerRadius}function u(tt){return tt.outerRadius}function _(tt){return tt.startAngle}function s(tt){return tt.endAngle}function A(tt){return tt&&tt.padAngle}function x(tt,Ct,Zt,ur,Lr,Br,Pr,Tr){var jr=Zt-tt,Pn=ur-Ct,An=Pr-Lr,$n=Tr-Br,zn=$n*jr-An*Pn;if(!(zn*zn<o))return zn=(An*(Ct-Br)-$n*(tt-Lr))/zn,[tt+zn*jr,Ct+zn*Pn]}function v(tt,Ct,Zt,ur,Lr,Br,Pr){var Tr=tt-Zt,jr=Ct-ur,Pn=(Pr?Br:-Br)/f(Tr*Tr+jr*jr),An=Pn*jr,$n=-Pn*Tr,zn=tt+An,Yn=Ct+$n,Kn=Zt+An,Aa=ur+$n,Ua=(zn+Kn)/2,vi=(Yn+Aa)/2,ci=Kn-zn,ui=Aa-Yn,Ga=ci*ci+ui*ui,wr=Lr-Br,vn=zn*Aa-Kn*Yn,on=(ui<0?-1:1)*f(n(0,wr*wr*Ga-vn*vn)),_n=(vn*ui-ci*on)/Ga,Bn=(-vn*ci-ui*on)/Ga,sa=(vn*ui+ci*on)/Ga,ra=(-vn*ci+ui*on)/Ga,In=_n-Ua,ea=Bn-vi,Va=sa-Ua,hi=ra-vi;return In*In+ea*ea>Va*Va+hi*hi&&(_n=sa,Bn=ra),{cx:_n,cy:Bn,x01:-An,y01:-$n,x11:_n*(Lr/wr-1),y11:Bn*(Lr/wr-1)}}function b(){var tt=m,Ct=u,Zt=M(0),ur=null,Lr=_,Br=s,Pr=A,Tr=null;function jr(){var Pn,An,$n=+tt.apply(this,arguments),zn=+Ct.apply(this,arguments),Yn=Lr.apply(this,arguments)-g,Kn=Br.apply(this,arguments)-g,Aa=T(Kn-Yn),Ua=Kn>Yn;if(Tr||(Tr=Pn=c.path()),zn<$n&&(An=zn,zn=$n,$n=An),!(zn>o))Tr.moveTo(0,0);else if(Aa>p-o)Tr.moveTo(zn*a(Yn),zn*t(Yn)),Tr.arc(0,0,zn,Yn,Kn,!Ua),$n>o&&(Tr.moveTo($n*a(Kn),$n*t(Kn)),Tr.arc(0,0,$n,Kn,Yn,Ua));else{var vi=Yn,ci=Kn,ui=Yn,Ga=Kn,wr=Aa,vn=Aa,on=Pr.apply(this,arguments)/2,_n=on>o&&(ur?+ur.apply(this,arguments):f($n*$n+zn*zn)),Bn=r(T(zn-$n)/2,+Zt.apply(this,arguments)),sa=Bn,ra=Bn,In,ea;if(_n>o){var Va=h(_n/$n*t(on)),hi=h(_n/zn*t(on));(wr-=Va*2)>o?(Va*=Ua?1:-1,ui+=Va,Ga-=Va):(wr=0,ui=Ga=(Yn+Kn)/2),(vn-=hi*2)>o?(hi*=Ua?1:-1,vi+=hi,ci-=hi):(vn=0,vi=ci=(Yn+Kn)/2)}var It=zn*a(vi),vr=zn*t(vi),rn=$n*a(Ga),hn=$n*t(Ga);if(Bn>o){var un=zn*a(ci),kn=zn*t(ci),bn=$n*a(ui),ln=$n*t(ui),gr;if(Aa<i&&(gr=x(It,vr,bn,ln,un,kn,rn,hn))){var dr=It-gr[0],Cr=vr-gr[1],dn=un-gr[0],On=kn-gr[1],qn=1/t(y((dr*dn+Cr*On)/(f(dr*dr+Cr*Cr)*f(dn*dn+On*On)))/2),xn=f(gr[0]*gr[0]+gr[1]*gr[1]);sa=r(Bn,($n-xn)/(qn-1)),ra=r(Bn,(zn-xn)/(qn+1))}}vn>o?ra>o?(In=v(bn,ln,It,vr,zn,ra,Ua),ea=v(un,kn,rn,hn,zn,ra,Ua),Tr.moveTo(In.cx+In.x01,In.cy+In.y01),ra<Bn?Tr.arc(In.cx,In.cy,ra,e(In.y01,In.x01),e(ea.y01,ea.x01),!Ua):(Tr.arc(In.cx,In.cy,ra,e(In.y01,In.x01),e(In.y11,In.x11),!Ua),Tr.arc(0,0,zn,e(In.cy+In.y11,In.cx+In.x11),e(ea.cy+ea.y11,ea.cx+ea.x11),!Ua),Tr.arc(ea.cx,ea.cy,ra,e(ea.y11,ea.x11),e(ea.y01,ea.x01),!Ua))):(Tr.moveTo(It,vr),Tr.arc(0,0,zn,vi,ci,!Ua)):Tr.moveTo(It,vr),!($n>o)||!(wr>o)?Tr.lineTo(rn,hn):sa>o?(In=v(rn,hn,un,kn,$n,-sa,Ua),ea=v(It,vr,bn,ln,$n,-sa,Ua),Tr.lineTo(In.cx+In.x01,In.cy+In.y01),sa<Bn?Tr.arc(In.cx,In.cy,sa,e(In.y01,In.x01),e(ea.y01,ea.x01),!Ua):(Tr.arc(In.cx,In.cy,sa,e(In.y01,In.x01),e(In.y11,In.x11),!Ua),Tr.arc(0,0,$n,e(In.cy+In.y11,In.cx+In.x11),e(ea.cy+ea.y11,ea.cx+ea.x11),Ua),Tr.arc(ea.cx,ea.cy,sa,e(ea.y11,ea.x11),e(ea.y01,ea.x01),!Ua))):Tr.arc(0,0,$n,Ga,ui,Ua)}if(Tr.closePath(),Pn)return Tr=null,Pn+""||null}return jr.centroid=function(){var Pn=(+tt.apply(this,arguments)+ +Ct.apply(this,arguments))/2,An=(+Lr.apply(this,arguments)+ +Br.apply(this,arguments))/2-i/2;return[a(An)*Pn,t(An)*Pn]},jr.innerRadius=function(Pn){return arguments.length?(tt=typeof Pn=="function"?Pn:M(+Pn),jr):tt},jr.outerRadius=function(Pn){return arguments.length?(Ct=typeof Pn=="function"?Pn:M(+Pn),jr):Ct},jr.cornerRadius=function(Pn){return arguments.length?(Zt=typeof Pn=="function"?Pn:M(+Pn),jr):Zt},jr.padRadius=function(Pn){return arguments.length?(ur=Pn==null?null:typeof Pn=="function"?Pn:M(+Pn),jr):ur},jr.startAngle=function(Pn){return arguments.length?(Lr=typeof Pn=="function"?Pn:M(+Pn),jr):Lr},jr.endAngle=function(Pn){return arguments.length?(Br=typeof Pn=="function"?Pn:M(+Pn),jr):Br},jr.padAngle=function(Pn){return arguments.length?(Pr=typeof Pn=="function"?Pn:M(+Pn),jr):Pr},jr.context=function(Pn){return arguments.length?(Tr=Pn==null?null:Pn,jr):Tr},jr}function l(tt){this._context=tt}l.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Ct){switch(tt=+tt,Ct=+Ct,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Ct):this._context.moveTo(tt,Ct);break;case 1:this._point=2;default:this._context.lineTo(tt,Ct);break}}};function L(tt){return new l(tt)}function S(tt){return tt[0]}function k(tt){return tt[1]}function P(){var tt=S,Ct=k,Zt=M(!0),ur=null,Lr=L,Br=null;function Pr(Tr){var jr,Pn=Tr.length,An,$n=!1,zn;for(ur==null&&(Br=Lr(zn=c.path())),jr=0;jr<=Pn;++jr)!(jr<Pn&&Zt(An=Tr[jr],jr,Tr))===$n&&(($n=!$n)?Br.lineStart():Br.lineEnd()),$n&&Br.point(+tt(An,jr,Tr),+Ct(An,jr,Tr));if(zn)return Br=null,zn+""||null}return Pr.x=function(Tr){return arguments.length?(tt=typeof Tr=="function"?Tr:M(+Tr),Pr):tt},Pr.y=function(Tr){return arguments.length?(Ct=typeof Tr=="function"?Tr:M(+Tr),Pr):Ct},Pr.defined=function(Tr){return arguments.length?(Zt=typeof Tr=="function"?Tr:M(!!Tr),Pr):Zt},Pr.curve=function(Tr){return arguments.length?(Lr=Tr,ur!=null&&(Br=Lr(ur)),Pr):Lr},Pr.context=function(Tr){return arguments.length?(Tr==null?ur=Br=null:Br=Lr(ur=Tr),Pr):ur},Pr}function z(){var tt=S,Ct=null,Zt=M(0),ur=k,Lr=M(!0),Br=null,Pr=L,Tr=null;function jr(An){var $n,zn,Yn,Kn=An.length,Aa,Ua=!1,vi,ci=new Array(Kn),ui=new Array(Kn);for(Br==null&&(Tr=Pr(vi=c.path())),$n=0;$n<=Kn;++$n){if(!($n<Kn&&Lr(Aa=An[$n],$n,An))===Ua)if(Ua=!Ua)zn=$n,Tr.areaStart(),Tr.lineStart();else{for(Tr.lineEnd(),Tr.lineStart(),Yn=$n-1;Yn>=zn;--Yn)Tr.point(ci[Yn],ui[Yn]);Tr.lineEnd(),Tr.areaEnd()}Ua&&(ci[$n]=+tt(Aa,$n,An),ui[$n]=+Zt(Aa,$n,An),Tr.point(Ct?+Ct(Aa,$n,An):ci[$n],ur?+ur(Aa,$n,An):ui[$n]))}if(vi)return Tr=null,vi+""||null}function Pn(){return P().defined(Lr).curve(Pr).context(Br)}return jr.x=function(An){return arguments.length?(tt=typeof An=="function"?An:M(+An),Ct=null,jr):tt},jr.x0=function(An){return arguments.length?(tt=typeof An=="function"?An:M(+An),jr):tt},jr.x1=function(An){return arguments.length?(Ct=An==null?null:typeof An=="function"?An:M(+An),jr):Ct},jr.y=function(An){return arguments.length?(Zt=typeof An=="function"?An:M(+An),ur=null,jr):Zt},jr.y0=function(An){return arguments.length?(Zt=typeof An=="function"?An:M(+An),jr):Zt},jr.y1=function(An){return arguments.length?(ur=An==null?null:typeof An=="function"?An:M(+An),jr):ur},jr.lineX0=jr.lineY0=function(){return Pn().x(tt).y(Zt)},jr.lineY1=function(){return Pn().x(tt).y(ur)},jr.lineX1=function(){return Pn().x(Ct).y(Zt)},jr.defined=function(An){return arguments.length?(Lr=typeof An=="function"?An:M(!!An),jr):Lr},jr.curve=function(An){return arguments.length?(Pr=An,Br!=null&&(Tr=Pr(Br)),jr):Pr},jr.context=function(An){return arguments.length?(An==null?Br=Tr=null:Tr=Pr(Br=An),jr):Br},jr}function I(tt,Ct){return Ct<tt?-1:Ct>tt?1:Ct>=tt?0:NaN}function D(tt){return tt}function R(){var tt=D,Ct=I,Zt=null,ur=M(0),Lr=M(p),Br=M(0);function Pr(Tr){var jr,Pn=Tr.length,An,$n,zn=0,Yn=new Array(Pn),Kn=new Array(Pn),Aa=+ur.apply(this,arguments),Ua=Math.min(p,Math.max(-p,Lr.apply(this,arguments)-Aa)),vi,ci=Math.min(Math.abs(Ua)/Pn,Br.apply(this,arguments)),ui=ci*(Ua<0?-1:1),Ga;for(jr=0;jr<Pn;++jr)(Ga=Kn[Yn[jr]=jr]=+tt(Tr[jr],jr,Tr))>0&&(zn+=Ga);for(Ct!=null?Yn.sort(function(wr,vn){return Ct(Kn[wr],Kn[vn])}):Zt!=null&&Yn.sort(function(wr,vn){return Zt(Tr[wr],Tr[vn])}),jr=0,$n=zn?(Ua-Pn*ui)/zn:0;jr<Pn;++jr,Aa=vi)An=Yn[jr],Ga=Kn[An],vi=Aa+(Ga>0?Ga*$n:0)+ui,Kn[An]={data:Tr[An],index:jr,value:Ga,startAngle:Aa,endAngle:vi,padAngle:ci};return Kn}return Pr.value=function(Tr){return arguments.length?(tt=typeof Tr=="function"?Tr:M(+Tr),Pr):tt},Pr.sortValues=function(Tr){return arguments.length?(Ct=Tr,Zt=null,Pr):Ct},Pr.sort=function(Tr){return arguments.length?(Zt=Tr,Ct=null,Pr):Zt},Pr.startAngle=function(Tr){return arguments.length?(ur=typeof Tr=="function"?Tr:M(+Tr),Pr):ur},Pr.endAngle=function(Tr){return arguments.length?(Lr=typeof Tr=="function"?Tr:M(+Tr),Pr):Lr},Pr.padAngle=function(Tr){return arguments.length?(Br=typeof Tr=="function"?Tr:M(+Tr),Pr):Br},Pr}var B=V(L);function F(tt){this._curve=tt}F.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(tt,Ct){this._curve.point(Ct*Math.sin(tt),Ct*-Math.cos(tt))}};function V(tt){function Ct(Zt){return new F(tt(Zt))}return Ct._curve=tt,Ct}function G(tt){var Ct=tt.curve;return tt.angle=tt.x,delete tt.x,tt.radius=tt.y,delete tt.y,tt.curve=function(Zt){return arguments.length?Ct(V(Zt)):Ct()._curve},tt}function J(){return G(P().curve(B))}function j(){var tt=z().curve(B),Ct=tt.curve,Zt=tt.lineX0,ur=tt.lineX1,Lr=tt.lineY0,Br=tt.lineY1;return tt.angle=tt.x,delete tt.x,tt.startAngle=tt.x0,delete tt.x0,tt.endAngle=tt.x1,delete tt.x1,tt.radius=tt.y,delete tt.y,tt.innerRadius=tt.y0,delete tt.y0,tt.outerRadius=tt.y1,delete tt.y1,tt.lineStartAngle=function(){return G(Zt())},delete tt.lineX0,tt.lineEndAngle=function(){return G(ur())},delete tt.lineX1,tt.lineInnerRadius=function(){return G(Lr())},delete tt.lineY0,tt.lineOuterRadius=function(){return G(Br())},delete tt.lineY1,tt.curve=function(Pr){return arguments.length?Ct(V(Pr)):Ct()._curve},tt}function Y(tt,Ct){return[(Ct=+Ct)*Math.cos(tt-=Math.PI/2),Ct*Math.sin(tt)]}var X=Array.prototype.slice;function oe(tt){return tt.source}function se(tt){return tt.target}function ie(tt){var Ct=oe,Zt=se,ur=S,Lr=k,Br=null;function Pr(){var Tr,jr=X.call(arguments),Pn=Ct.apply(this,jr),An=Zt.apply(this,jr);if(Br||(Br=Tr=c.path()),tt(Br,+ur.apply(this,(jr[0]=Pn,jr)),+Lr.apply(this,jr),+ur.apply(this,(jr[0]=An,jr)),+Lr.apply(this,jr)),Tr)return Br=null,Tr+""||null}return Pr.source=function(Tr){return arguments.length?(Ct=Tr,Pr):Ct},Pr.target=function(Tr){return arguments.length?(Zt=Tr,Pr):Zt},Pr.x=function(Tr){return arguments.length?(ur=typeof Tr=="function"?Tr:M(+Tr),Pr):ur},Pr.y=function(Tr){return arguments.length?(Lr=typeof Tr=="function"?Tr:M(+Tr),Pr):Lr},Pr.context=function(Tr){return arguments.length?(Br=Tr==null?null:Tr,Pr):Br},Pr}function N(tt,Ct,Zt,ur,Lr){tt.moveTo(Ct,Zt),tt.bezierCurveTo(Ct=(Ct+ur)/2,Zt,Ct,Lr,ur,Lr)}function U(tt,Ct,Zt,ur,Lr){tt.moveTo(Ct,Zt),tt.bezierCurveTo(Ct,Zt=(Zt+Lr)/2,ur,Zt,ur,Lr)}function q(tt,Ct,Zt,ur,Lr){var Br=Y(Ct,Zt),Pr=Y(Ct,Zt=(Zt+Lr)/2),Tr=Y(ur,Zt),jr=Y(ur,Lr);tt.moveTo(Br[0],Br[1]),tt.bezierCurveTo(Pr[0],Pr[1],Tr[0],Tr[1],jr[0],jr[1])}function Q(){return ie(N)}function W(){return ie(U)}function Z(){var tt=ie(q);return tt.angle=tt.x,delete tt.x,tt.radius=tt.y,delete tt.y,tt}var ee={draw:function(tt,Ct){var Zt=Math.sqrt(Ct/i);tt.moveTo(Zt,0),tt.arc(0,0,Zt,0,p)}},te={draw:function(tt,Ct){var Zt=Math.sqrt(Ct/5)/2;tt.moveTo(-3*Zt,-Zt),tt.lineTo(-Zt,-Zt),tt.lineTo(-Zt,-3*Zt),tt.lineTo(Zt,-3*Zt),tt.lineTo(Zt,-Zt),tt.lineTo(3*Zt,-Zt),tt.lineTo(3*Zt,Zt),tt.lineTo(Zt,Zt),tt.lineTo(Zt,3*Zt),tt.lineTo(-Zt,3*Zt),tt.lineTo(-Zt,Zt),tt.lineTo(-3*Zt,Zt),tt.closePath()}},ae=Math.sqrt(1/3),le=ae*2,ye={draw:function(tt,Ct){var Zt=Math.sqrt(Ct/le),ur=Zt*ae;tt.moveTo(0,-Zt),tt.lineTo(ur,0),tt.lineTo(0,Zt),tt.lineTo(-ur,0),tt.closePath()}},fe=.8908130915292852,pe=Math.sin(i/10)/Math.sin(7*i/10),ge=Math.sin(p/10)*pe,Ae=-Math.cos(p/10)*pe,we={draw:function(tt,Ct){var Zt=Math.sqrt(Ct*fe),ur=ge*Zt,Lr=Ae*Zt;tt.moveTo(0,-Zt),tt.lineTo(ur,Lr);for(var Br=1;Br<5;++Br){var Pr=p*Br/5,Tr=Math.cos(Pr),jr=Math.sin(Pr);tt.lineTo(jr*Zt,-Tr*Zt),tt.lineTo(Tr*ur-jr*Lr,jr*ur+Tr*Lr)}tt.closePath()}},De={draw:function(tt,Ct){var Zt=Math.sqrt(Ct),ur=-Zt/2;tt.rect(ur,ur,Zt,Zt)}},Be=Math.sqrt(3),Ve={draw:function(tt,Ct){var Zt=-Math.sqrt(Ct/(Be*3));tt.moveTo(0,Zt*2),tt.lineTo(-Be*Zt,-Zt),tt.lineTo(Be*Zt,-Zt),tt.closePath()}},xe=-.5,Le=Math.sqrt(3)/2,He=1/Math.sqrt(12),Je=(He/2+1)*3,Oe={draw:function(tt,Ct){var Zt=Math.sqrt(Ct/Je),ur=Zt/2,Lr=Zt*He,Br=ur,Pr=Zt*He+Zt,Tr=-Br,jr=Pr;tt.moveTo(ur,Lr),tt.lineTo(Br,Pr),tt.lineTo(Tr,jr),tt.lineTo(xe*ur-Le*Lr,Le*ur+xe*Lr),tt.lineTo(xe*Br-Le*Pr,Le*Br+xe*Pr),tt.lineTo(xe*Tr-Le*jr,Le*Tr+xe*jr),tt.lineTo(xe*ur+Le*Lr,xe*Lr-Le*ur),tt.lineTo(xe*Br+Le*Pr,xe*Pr-Le*Br),tt.lineTo(xe*Tr+Le*jr,xe*jr-Le*Tr),tt.closePath()}},Pe=[ee,te,ye,De,we,Ve,Oe];function Ue(){var tt=M(ee),Ct=M(64),Zt=null;function ur(){var Lr;if(Zt||(Zt=Lr=c.path()),tt.apply(this,arguments).draw(Zt,+Ct.apply(this,arguments)),Lr)return Zt=null,Lr+""||null}return ur.type=function(Lr){return arguments.length?(tt=typeof Lr=="function"?Lr:M(Lr),ur):tt},ur.size=function(Lr){return arguments.length?(Ct=typeof Lr=="function"?Lr:M(+Lr),ur):Ct},ur.context=function(Lr){return arguments.length?(Zt=Lr==null?null:Lr,ur):Zt},ur}function vt(){}function Lt(tt,Ct,Zt){tt._context.bezierCurveTo((2*tt._x0+tt._x1)/3,(2*tt._y0+tt._y1)/3,(tt._x0+2*tt._x1)/3,(tt._y0+2*tt._y1)/3,(tt._x0+4*tt._x1+Ct)/6,(tt._y0+4*tt._y1+Zt)/6)}function Yt(tt){this._context=tt}Yt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Lt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Ct){switch(tt=+tt,Ct=+Ct,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Ct):this._context.moveTo(tt,Ct);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Lt(this,tt,Ct);break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Ct}};function At(tt){return new Yt(tt)}function Rt(tt){this._context=tt}Rt.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(tt,Ct){switch(tt=+tt,Ct=+Ct,this._point){case 0:this._point=1,this._x2=tt,this._y2=Ct;break;case 1:this._point=2,this._x3=tt,this._y3=Ct;break;case 2:this._point=3,this._x4=tt,this._y4=Ct,this._context.moveTo((this._x0+4*this._x1+tt)/6,(this._y0+4*this._y1+Ct)/6);break;default:Lt(this,tt,Ct);break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Ct}};function Bt(tt){return new Rt(tt)}function Mt(tt){this._context=tt}Mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Ct){switch(tt=+tt,Ct=+Ct,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var Zt=(this._x0+4*this._x1+tt)/6,ur=(this._y0+4*this._y1+Ct)/6;this._line?this._context.lineTo(Zt,ur):this._context.moveTo(Zt,ur);break;case 3:this._point=4;default:Lt(this,tt,Ct);break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Ct}};function Tt(tt){return new Mt(tt)}function at(tt,Ct){this._basis=new Yt(tt),this._beta=Ct}at.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var tt=this._x,Ct=this._y,Zt=tt.length-1;if(Zt>0)for(var ur=tt[0],Lr=Ct[0],Br=tt[Zt]-ur,Pr=Ct[Zt]-Lr,Tr=-1,jr;++Tr<=Zt;)jr=Tr/Zt,this._basis.point(this._beta*tt[Tr]+(1-this._beta)*(ur+jr*Br),this._beta*Ct[Tr]+(1-this._beta)*(Lr+jr*Pr));this._x=this._y=null,this._basis.lineEnd()},point:function(tt,Ct){this._x.push(+tt),this._y.push(+Ct)}};var ct=function tt(Ct){function Zt(ur){return Ct===1?new Yt(ur):new at(ur,Ct)}return Zt.beta=function(ur){return tt(+ur)},Zt}(.85);function je(tt,Ct,Zt){tt._context.bezierCurveTo(tt._x1+tt._k*(tt._x2-tt._x0),tt._y1+tt._k*(tt._y2-tt._y0),tt._x2+tt._k*(tt._x1-Ct),tt._y2+tt._k*(tt._y1-Zt),tt._x2,tt._y2)}function ke(tt,Ct){this._context=tt,this._k=(1-Ct)/6}ke.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:je(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Ct){switch(tt=+tt,Ct=+Ct,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Ct):this._context.moveTo(tt,Ct);break;case 1:this._point=2,this._x1=tt,this._y1=Ct;break;case 2:this._point=3;default:je(this,tt,Ct);break}this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Ct}};var Ye=function tt(Ct){function Zt(ur){return new ke(ur,Ct)}return Zt.tension=function(ur){return tt(+ur)},Zt}(0);function Ke(tt,Ct){this._context=tt,this._k=(1-Ct)/6}Ke.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(tt,Ct){switch(tt=+tt,Ct=+Ct,this._point){case 0:this._point=1,this._x3=tt,this._y3=Ct;break;case 1:this._point=2,this._context.moveTo(this._x4=tt,this._y4=Ct);break;case 2:this._point=3,this._x5=tt,this._y5=Ct;break;default:je(this,tt,Ct);break}this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Ct}};var st=function tt(Ct){function Zt(ur){return new Ke(ur,Ct)}return Zt.tension=function(ur){return tt(+ur)},Zt}(0);function Et(tt,Ct){this._context=tt,this._k=(1-Ct)/6}Et.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Ct){switch(tt=+tt,Ct=+Ct,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:je(this,tt,Ct);break}this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Ct}};var bt=function tt(Ct){function Zt(ur){return new Et(ur,Ct)}return Zt.tension=function(ur){return tt(+ur)},Zt}(0);function zt(tt,Ct,Zt){var ur=tt._x1,Lr=tt._y1,Br=tt._x2,Pr=tt._y2;if(tt._l01_a>o){var Tr=2*tt._l01_2a+3*tt._l01_a*tt._l12_a+tt._l12_2a,jr=3*tt._l01_a*(tt._l01_a+tt._l12_a);ur=(ur*Tr-tt._x0*tt._l12_2a+tt._x2*tt._l01_2a)/jr,Lr=(Lr*Tr-tt._y0*tt._l12_2a+tt._y2*tt._l01_2a)/jr}if(tt._l23_a>o){var Pn=2*tt._l23_2a+3*tt._l23_a*tt._l12_a+tt._l12_2a,An=3*tt._l23_a*(tt._l23_a+tt._l12_a);Br=(Br*Pn+tt._x1*tt._l23_2a-Ct*tt._l12_2a)/An,Pr=(Pr*Pn+tt._y1*tt._l23_2a-Zt*tt._l12_2a)/An}tt._context.bezierCurveTo(ur,Lr,Br,Pr,tt._x2,tt._y2)}function $t(tt,Ct){this._context=tt,this._alpha=Ct}$t.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Ct){if(tt=+tt,Ct=+Ct,this._point){var Zt=this._x2-tt,ur=this._y2-Ct;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Zt*Zt+ur*ur,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Ct):this._context.moveTo(tt,Ct);break;case 1:this._point=2;break;case 2:this._point=3;default:zt(this,tt,Ct);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Ct}};var Ot=function tt(Ct){function Zt(ur){return Ct?new $t(ur,Ct):new ke(ur,0)}return Zt.alpha=function(ur){return tt(+ur)},Zt}(.5);function Qt(tt,Ct){this._context=tt,this._alpha=Ct}Qt.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(tt,Ct){if(tt=+tt,Ct=+Ct,this._point){var Zt=this._x2-tt,ur=this._y2-Ct;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Zt*Zt+ur*ur,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=tt,this._y3=Ct;break;case 1:this._point=2,this._context.moveTo(this._x4=tt,this._y4=Ct);break;case 2:this._point=3,this._x5=tt,this._y5=Ct;break;default:zt(this,tt,Ct);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Ct}};var tr=function tt(Ct){function Zt(ur){return Ct?new Qt(ur,Ct):new Ke(ur,0)}return Zt.alpha=function(ur){return tt(+ur)},Zt}(.5);function qt(tt,Ct){this._context=tt,this._alpha=Ct}qt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Ct){if(tt=+tt,Ct=+Ct,this._point){var Zt=this._x2-tt,ur=this._y2-Ct;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Zt*Zt+ur*ur,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:zt(this,tt,Ct);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=tt,this._y0=this._y1,this._y1=this._y2,this._y2=Ct}};var lr=function tt(Ct){function Zt(ur){return Ct?new qt(ur,Ct):new Et(ur,0)}return Zt.alpha=function(ur){return tt(+ur)},Zt}(.5);function Wr(tt){this._context=tt}Wr.prototype={areaStart:vt,areaEnd:vt,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(tt,Ct){tt=+tt,Ct=+Ct,this._point?this._context.lineTo(tt,Ct):(this._point=1,this._context.moveTo(tt,Ct))}};function cn(tt){return new Wr(tt)}function Jr(tt){return tt<0?-1:1}function ot(tt,Ct,Zt){var ur=tt._x1-tt._x0,Lr=Ct-tt._x1,Br=(tt._y1-tt._y0)/(ur||Lr<0&&-0),Pr=(Zt-tt._y1)/(Lr||ur<0&&-0),Tr=(Br*Lr+Pr*ur)/(ur+Lr);return(Jr(Br)+Jr(Pr))*Math.min(Math.abs(Br),Math.abs(Pr),.5*Math.abs(Tr))||0}function Vt(tt,Ct){var Zt=tt._x1-tt._x0;return Zt?(3*(tt._y1-tt._y0)/Zt-Ct)/2:Ct}function jt(tt,Ct,Zt){var ur=tt._x0,Lr=tt._y0,Br=tt._x1,Pr=tt._y1,Tr=(Br-ur)/3;tt._context.bezierCurveTo(ur+Tr,Lr+Tr*Ct,Br-Tr,Pr-Tr*Zt,Br,Pr)}function Ut(tt){this._context=tt}Ut.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:jt(this,this._t0,Vt(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(tt,Ct){var Zt=NaN;if(tt=+tt,Ct=+Ct,!(tt===this._x1&&Ct===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Ct):this._context.moveTo(tt,Ct);break;case 1:this._point=2;break;case 2:this._point=3,jt(this,Vt(this,Zt=ot(this,tt,Ct)),Zt);break;default:jt(this,this._t0,Zt=ot(this,tt,Ct));break}this._x0=this._x1,this._x1=tt,this._y0=this._y1,this._y1=Ct,this._t0=Zt}}};function yr(tt){this._context=new nt(tt)}(yr.prototype=Object.create(Ut.prototype)).point=function(tt,Ct){Ut.prototype.point.call(this,Ct,tt)};function nt(tt){this._context=tt}nt.prototype={moveTo:function(tt,Ct){this._context.moveTo(Ct,tt)},closePath:function(){this._context.closePath()},lineTo:function(tt,Ct){this._context.lineTo(Ct,tt)},bezierCurveTo:function(tt,Ct,Zt,ur,Lr,Br){this._context.bezierCurveTo(Ct,tt,ur,Zt,Br,Lr)}};function _e(tt){return new Ut(tt)}function Me(tt){return new yr(tt)}function Ne(tt){this._context=tt}Ne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var tt=this._x,Ct=this._y,Zt=tt.length;if(Zt)if(this._line?this._context.lineTo(tt[0],Ct[0]):this._context.moveTo(tt[0],Ct[0]),Zt===2)this._context.lineTo(tt[1],Ct[1]);else for(var ur=We(tt),Lr=We(Ct),Br=0,Pr=1;Pr<Zt;++Br,++Pr)this._context.bezierCurveTo(ur[0][Br],Lr[0][Br],ur[1][Br],Lr[1][Br],tt[Pr],Ct[Pr]);(this._line||this._line!==0&&Zt===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(tt,Ct){this._x.push(+tt),this._y.push(+Ct)}};function We(tt){var Ct,Zt=tt.length-1,ur,Lr=new Array(Zt),Br=new Array(Zt),Pr=new Array(Zt);for(Lr[0]=0,Br[0]=2,Pr[0]=tt[0]+2*tt[1],Ct=1;Ct<Zt-1;++Ct)Lr[Ct]=1,Br[Ct]=4,Pr[Ct]=4*tt[Ct]+2*tt[Ct+1];for(Lr[Zt-1]=2,Br[Zt-1]=7,Pr[Zt-1]=8*tt[Zt-1]+tt[Zt],Ct=1;Ct<Zt;++Ct)ur=Lr[Ct]/Br[Ct-1],Br[Ct]-=ur,Pr[Ct]-=ur*Pr[Ct-1];for(Lr[Zt-1]=Pr[Zt-1]/Br[Zt-1],Ct=Zt-2;Ct>=0;--Ct)Lr[Ct]=(Pr[Ct]-Lr[Ct+1])/Br[Ct];for(Br[Zt-1]=(tt[Zt]+Lr[Zt-1])/2,Ct=0;Ct<Zt-1;++Ct)Br[Ct]=2*tt[Ct+1]-Lr[Ct+1];return[Lr,Br]}function Qe(tt){return new Ne(tt)}function rt(tt,Ct){this._context=tt,this._t=Ct}rt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(tt,Ct){switch(tt=+tt,Ct=+Ct,this._point){case 0:this._point=1,this._line?this._context.lineTo(tt,Ct):this._context.moveTo(tt,Ct);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,Ct),this._context.lineTo(tt,Ct);else{var Zt=this._x*(1-this._t)+tt*this._t;this._context.lineTo(Zt,this._y),this._context.lineTo(Zt,Ct)}break}}this._x=tt,this._y=Ct}};function $e(tt){return new rt(tt,.5)}function ht(tt){return new rt(tt,0)}function xt(tt){return new rt(tt,1)}function kt(tt,Ct){if((Pr=tt.length)>1)for(var Zt=1,ur,Lr,Br=tt[Ct[0]],Pr,Tr=Br.length;Zt<Pr;++Zt)for(Lr=Br,Br=tt[Ct[Zt]],ur=0;ur<Tr;++ur)Br[ur][1]+=Br[ur][0]=isNaN(Lr[ur][1])?Lr[ur][0]:Lr[ur][1]}function Wt(tt){for(var Ct=tt.length,Zt=new Array(Ct);--Ct>=0;)Zt[Ct]=Ct;return Zt}function Ft(tt,Ct){return tt[Ct]}function ir(){var tt=M([]),Ct=Wt,Zt=kt,ur=Ft;function Lr(Br){var Pr=tt.apply(this,arguments),Tr,jr=Br.length,Pn=Pr.length,An=new Array(Pn),$n;for(Tr=0;Tr<Pn;++Tr){for(var zn=Pr[Tr],Yn=An[Tr]=new Array(jr),Kn=0,Aa;Kn<jr;++Kn)Yn[Kn]=Aa=[0,+ur(Br[Kn],zn,Kn,Br)],Aa.data=Br[Kn];Yn.key=zn}for(Tr=0,$n=Ct(An);Tr<Pn;++Tr)An[$n[Tr]].index=Tr;return Zt(An,$n),An}return Lr.keys=function(Br){return arguments.length?(tt=typeof Br=="function"?Br:M(X.call(Br)),Lr):tt},Lr.value=function(Br){return arguments.length?(ur=typeof Br=="function"?Br:M(+Br),Lr):ur},Lr.order=function(Br){return arguments.length?(Ct=Br==null?Wt:typeof Br=="function"?Br:M(X.call(Br)),Lr):Ct},Lr.offset=function(Br){return arguments.length?(Zt=Br==null?kt:Br,Lr):Zt},Lr}function hr(tt,Ct){if((ur=tt.length)>0){for(var Zt,ur,Lr=0,Br=tt[0].length,Pr;Lr<Br;++Lr){for(Pr=Zt=0;Zt<ur;++Zt)Pr+=tt[Zt][Lr][1]||0;if(Pr)for(Zt=0;Zt<ur;++Zt)tt[Zt][Lr][1]/=Pr}kt(tt,Ct)}}function _r(tt,Ct){if((jr=tt.length)>0)for(var Zt,ur=0,Lr,Br,Pr,Tr,jr,Pn=tt[Ct[0]].length;ur<Pn;++ur)for(Pr=Tr=0,Zt=0;Zt<jr;++Zt)(Br=(Lr=tt[Ct[Zt]][ur])[1]-Lr[0])>0?(Lr[0]=Pr,Lr[1]=Pr+=Br):Br<0?(Lr[1]=Tr,Lr[0]=Tr+=Br):(Lr[0]=0,Lr[1]=Br)}function an(tt,Ct){if((Lr=tt.length)>0){for(var Zt=0,ur=tt[Ct[0]],Lr,Br=ur.length;Zt<Br;++Zt){for(var Pr=0,Tr=0;Pr<Lr;++Pr)Tr+=tt[Pr][Zt][1]||0;ur[Zt][1]+=ur[Zt][0]=-Tr/2}kt(tt,Ct)}}function Rr(tt,Ct){if(!(!((Pr=tt.length)>0)||!((Br=(Lr=tt[Ct[0]]).length)>0))){for(var Zt=0,ur=1,Lr,Br,Pr;ur<Br;++ur){for(var Tr=0,jr=0,Pn=0;Tr<Pr;++Tr){for(var An=tt[Ct[Tr]],$n=An[ur][1]||0,zn=An[ur-1][1]||0,Yn=($n-zn)/2,Kn=0;Kn<Tr;++Kn){var Aa=tt[Ct[Kn]],Ua=Aa[ur][1]||0,vi=Aa[ur-1][1]||0;Yn+=Ua-vi}jr+=$n,Pn+=Yn*$n}Lr[ur-1][1]+=Lr[ur-1][0]=Zt,jr&&(Zt-=Pn/jr)}Lr[ur-1][1]+=Lr[ur-1][0]=Zt,kt(tt,Ct)}}function Vr(tt){var Ct=tt.map(fn);return Wt(tt).sort(function(Zt,ur){return Ct[Zt]-Ct[ur]})}function fn(tt){for(var Ct=-1,Zt=0,ur=tt.length,Lr,Br=-1/0;++Ct<ur;)(Lr=+tt[Ct][1])>Br&&(Br=Lr,Zt=Ct);return Zt}function xr(tt){var Ct=tt.map(mr);return Wt(tt).sort(function(Zt,ur){return Ct[Zt]-Ct[ur]})}function mr(tt){for(var Ct=0,Zt=-1,ur=tt.length,Lr;++Zt<ur;)(Lr=+tt[Zt][1])&&(Ct+=Lr);return Ct}function Fr(tt){return xr(tt).reverse()}function Ir(tt){var Ct=tt.length,Zt,ur,Lr=tt.map(mr),Br=Vr(tt),Pr=0,Tr=0,jr=[],Pn=[];for(Zt=0;Zt<Ct;++Zt)ur=Br[Zt],Pr<Tr?(Pr+=Lr[ur],jr.push(ur)):(Tr+=Lr[ur],Pn.push(ur));return Pn.reverse().concat(jr)}function Sr(tt){return Wt(tt).reverse()}w.arc=b,w.area=z,w.areaRadial=j,w.curveBasis=At,w.curveBasisClosed=Bt,w.curveBasisOpen=Tt,w.curveBundle=ct,w.curveCardinal=Ye,w.curveCardinalClosed=st,w.curveCardinalOpen=bt,w.curveCatmullRom=Ot,w.curveCatmullRomClosed=tr,w.curveCatmullRomOpen=lr,w.curveLinear=L,w.curveLinearClosed=cn,w.curveMonotoneX=_e,w.curveMonotoneY=Me,w.curveNatural=Qe,w.curveStep=$e,w.curveStepAfter=xt,w.curveStepBefore=ht,w.line=P,w.lineRadial=J,w.linkHorizontal=Q,w.linkRadial=Z,w.linkVertical=W,w.pie=R,w.pointRadial=Y,w.radialArea=j,w.radialLine=J,w.stack=ir,w.stackOffsetDiverging=_r,w.stackOffsetExpand=hr,w.stackOffsetNone=kt,w.stackOffsetSilhouette=an,w.stackOffsetWiggle=Rr,w.stackOrderAppearance=Vr,w.stackOrderAscending=xr,w.stackOrderDescending=Fr,w.stackOrderInsideOut=Ir,w.stackOrderNone=Wt,w.stackOrderReverse=Sr,w.symbol=Ue,w.symbolCircle=ee,w.symbolCross=te,w.symbolDiamond=ye,w.symbolSquare=De,w.symbolStar=we,w.symbolTriangle=Ve,w.symbolWye=Oe,w.symbols=Pe,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-path":117}],120:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne,d("d3-time")):(w=w||self,c(w.d3=w.d3||{},w.d3))})(this,function(w,c){function M(at){if(0<=at.y&&at.y<100){var ct=new Date(-1,at.m,at.d,at.H,at.M,at.S,at.L);return ct.setFullYear(at.y),ct}return new Date(at.y,at.m,at.d,at.H,at.M,at.S,at.L)}function T(at){if(0<=at.y&&at.y<100){var ct=new Date(Date.UTC(-1,at.m,at.d,at.H,at.M,at.S,at.L));return ct.setUTCFullYear(at.y),ct}return new Date(Date.UTC(at.y,at.m,at.d,at.H,at.M,at.S,at.L))}function e(at,ct,je){return{y:at,m:ct,d:je,H:0,M:0,S:0,L:0}}function a(at){var ct=at.dateTime,je=at.date,ke=at.time,Ye=at.periods,Ke=at.days,st=at.shortDays,Et=at.months,bt=at.shortMonths,zt=g(Ye),$t=p(Ye),Ot=g(Ke),Qt=p(Ke),tr=g(st),qt=p(st),lr=g(Et),Wr=p(Et),cn=g(bt),Jr=p(bt),ot={a:xt,A:kt,b:Wt,B:Ft,c:null,d:F,e:F,f:Y,H:V,I:G,j:J,L:j,m:X,M:oe,p:ir,q:hr,Q:Ue,s:vt,S:se,u:ie,U:N,V:U,w:q,W:Q,x:null,X:null,y:W,Y:Z,Z:ee,"%":Pe},Vt={a:_r,A:an,b:Rr,B:Vr,c:null,d:te,e:te,f:pe,H:ae,I:le,j:ye,L:fe,m:ge,M:Ae,p:fn,q:xr,Q:Ue,s:vt,S:we,u:De,U:Be,V:Ve,w:xe,W:Le,x:null,X:null,y:He,Y:Je,Z:Oe,"%":Pe},jt={a:Me,A:Ne,b:We,B:Qe,c:rt,d:l,e:l,f:I,H:S,I:S,j:L,L:z,m:b,M:k,p:_e,q:v,Q:R,s:B,S:P,u:h,U:m,V:u,w:y,W:_,x:$e,X:ht,y:A,Y:s,Z:x,"%":D};ot.x=Ut(je,ot),ot.X=Ut(ke,ot),ot.c=Ut(ct,ot),Vt.x=Ut(je,Vt),Vt.X=Ut(ke,Vt),Vt.c=Ut(ct,Vt);function Ut(mr,Fr){return function(Ir){var Sr=[],tt=-1,Ct=0,Zt=mr.length,ur,Lr,Br;for(Ir instanceof Date||(Ir=new Date(+Ir));++tt<Zt;)mr.charCodeAt(tt)===37&&(Sr.push(mr.slice(Ct,tt)),(Lr=n[ur=mr.charAt(++tt)])!=null?ur=mr.charAt(++tt):Lr=ur==="e"?" ":"0",(Br=Fr[ur])&&(ur=Br(Ir,Lr)),Sr.push(ur),Ct=tt+1);return Sr.push(mr.slice(Ct,tt)),Sr.join("")}}function yr(mr,Fr){return function(Ir){var Sr=e(1900,void 0,1),tt=nt(Sr,mr,Ir+="",0),Ct,Zt;if(tt!=Ir.length)return null;if("Q"in Sr)return new Date(Sr.Q);if("s"in Sr)return new Date(Sr.s*1e3+("L"in Sr?Sr.L:0));if(Fr&&!("Z"in Sr)&&(Sr.Z=0),"p"in Sr&&(Sr.H=Sr.H%12+Sr.p*12),Sr.m===void 0&&(Sr.m="q"in Sr?Sr.q:0),"V"in Sr){if(Sr.V<1||Sr.V>53)return null;"w"in Sr||(Sr.w=1),"Z"in Sr?(Ct=T(e(Sr.y,0,1)),Zt=Ct.getUTCDay(),Ct=Zt>4||Zt===0?c.utcMonday.ceil(Ct):c.utcMonday(Ct),Ct=c.utcDay.offset(Ct,(Sr.V-1)*7),Sr.y=Ct.getUTCFullYear(),Sr.m=Ct.getUTCMonth(),Sr.d=Ct.getUTCDate()+(Sr.w+6)%7):(Ct=M(e(Sr.y,0,1)),Zt=Ct.getDay(),Ct=Zt>4||Zt===0?c.timeMonday.ceil(Ct):c.timeMonday(Ct),Ct=c.timeDay.offset(Ct,(Sr.V-1)*7),Sr.y=Ct.getFullYear(),Sr.m=Ct.getMonth(),Sr.d=Ct.getDate()+(Sr.w+6)%7)}else("W"in Sr||"U"in Sr)&&("w"in Sr||(Sr.w="u"in Sr?Sr.u%7:"W"in Sr?1:0),Zt="Z"in Sr?T(e(Sr.y,0,1)).getUTCDay():M(e(Sr.y,0,1)).getDay(),Sr.m=0,Sr.d="W"in Sr?(Sr.w+6)%7+Sr.W*7-(Zt+5)%7:Sr.w+Sr.U*7-(Zt+6)%7);return"Z"in Sr?(Sr.H+=Sr.Z/100|0,Sr.M+=Sr.Z%100,T(Sr)):M(Sr)}}function nt(mr,Fr,Ir,Sr){for(var tt=0,Ct=Fr.length,Zt=Ir.length,ur,Lr;tt<Ct;){if(Sr>=Zt)return-1;if(ur=Fr.charCodeAt(tt++),ur===37){if(ur=Fr.charAt(tt++),Lr=jt[ur in n?Fr.charAt(tt++):ur],!Lr||(Sr=Lr(mr,Ir,Sr))<0)return-1}else if(ur!=Ir.charCodeAt(Sr++))return-1}return Sr}function _e(mr,Fr,Ir){var Sr=zt.exec(Fr.slice(Ir));return Sr?(mr.p=$t[Sr[0].toLowerCase()],Ir+Sr[0].length):-1}function Me(mr,Fr,Ir){var Sr=tr.exec(Fr.slice(Ir));return Sr?(mr.w=qt[Sr[0].toLowerCase()],Ir+Sr[0].length):-1}function Ne(mr,Fr,Ir){var Sr=Ot.exec(Fr.slice(Ir));return Sr?(mr.w=Qt[Sr[0].toLowerCase()],Ir+Sr[0].length):-1}function We(mr,Fr,Ir){var Sr=cn.exec(Fr.slice(Ir));return Sr?(mr.m=Jr[Sr[0].toLowerCase()],Ir+Sr[0].length):-1}function Qe(mr,Fr,Ir){var Sr=lr.exec(Fr.slice(Ir));return Sr?(mr.m=Wr[Sr[0].toLowerCase()],Ir+Sr[0].length):-1}function rt(mr,Fr,Ir){return nt(mr,ct,Fr,Ir)}function $e(mr,Fr,Ir){return nt(mr,je,Fr,Ir)}function ht(mr,Fr,Ir){return nt(mr,ke,Fr,Ir)}function xt(mr){return st[mr.getDay()]}function kt(mr){return Ke[mr.getDay()]}function Wt(mr){return bt[mr.getMonth()]}function Ft(mr){return Et[mr.getMonth()]}function ir(mr){return Ye[+(mr.getHours()>=12)]}function hr(mr){return 1+~~(mr.getMonth()/3)}function _r(mr){return st[mr.getUTCDay()]}function an(mr){return Ke[mr.getUTCDay()]}function Rr(mr){return bt[mr.getUTCMonth()]}function Vr(mr){return Et[mr.getUTCMonth()]}function fn(mr){return Ye[+(mr.getUTCHours()>=12)]}function xr(mr){return 1+~~(mr.getUTCMonth()/3)}return{format:function(mr){var Fr=Ut(mr+="",ot);return Fr.toString=function(){return mr},Fr},parse:function(mr){var Fr=yr(mr+="",!1);return Fr.toString=function(){return mr},Fr},utcFormat:function(mr){var Fr=Ut(mr+="",Vt);return Fr.toString=function(){return mr},Fr},utcParse:function(mr){var Fr=yr(mr+="",!0);return Fr.toString=function(){return mr},Fr}}}var n={"-":"",_:" ","0":"0"},r=/^\s*\d+/,t=/^%/,f=/[\\^$*+?|[\]().{}]/g;function o(at,ct,je){var ke=at<0?"-":"",Ye=(ke?-at:at)+"",Ke=Ye.length;return ke+(Ke<je?new Array(je-Ke+1).join(ct)+Ye:Ye)}function i(at){return at.replace(f,"\\$&")}function g(at){return new RegExp("^(?:"+at.map(i).join("|")+")","i")}function p(at){for(var ct={},je=-1,ke=at.length;++je<ke;)ct[at[je].toLowerCase()]=je;return ct}function y(at,ct,je){var ke=r.exec(ct.slice(je,je+1));return ke?(at.w=+ke[0],je+ke[0].length):-1}function h(at,ct,je){var ke=r.exec(ct.slice(je,je+1));return ke?(at.u=+ke[0],je+ke[0].length):-1}function m(at,ct,je){var ke=r.exec(ct.slice(je,je+2));return ke?(at.U=+ke[0],je+ke[0].length):-1}function u(at,ct,je){var ke=r.exec(ct.slice(je,je+2));return ke?(at.V=+ke[0],je+ke[0].length):-1}function _(at,ct,je){var ke=r.exec(ct.slice(je,je+2));return ke?(at.W=+ke[0],je+ke[0].length):-1}function s(at,ct,je){var ke=r.exec(ct.slice(je,je+4));return ke?(at.y=+ke[0],je+ke[0].length):-1}function A(at,ct,je){var ke=r.exec(ct.slice(je,je+2));return ke?(at.y=+ke[0]+(+ke[0]>68?1900:2e3),je+ke[0].length):-1}function x(at,ct,je){var ke=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(ct.slice(je,je+6));return ke?(at.Z=ke[1]?0:-(ke[2]+(ke[3]||"00")),je+ke[0].length):-1}function v(at,ct,je){var ke=r.exec(ct.slice(je,je+1));return ke?(at.q=ke[0]*3-3,je+ke[0].length):-1}function b(at,ct,je){var ke=r.exec(ct.slice(je,je+2));return ke?(at.m=ke[0]-1,je+ke[0].length):-1}function l(at,ct,je){var ke=r.exec(ct.slice(je,je+2));return ke?(at.d=+ke[0],je+ke[0].length):-1}function L(at,ct,je){var ke=r.exec(ct.slice(je,je+3));return ke?(at.m=0,at.d=+ke[0],je+ke[0].length):-1}function S(at,ct,je){var ke=r.exec(ct.slice(je,je+2));return ke?(at.H=+ke[0],je+ke[0].length):-1}function k(at,ct,je){var ke=r.exec(ct.slice(je,je+2));return ke?(at.M=+ke[0],je+ke[0].length):-1}function P(at,ct,je){var ke=r.exec(ct.slice(je,je+2));return ke?(at.S=+ke[0],je+ke[0].length):-1}function z(at,ct,je){var ke=r.exec(ct.slice(je,je+3));return ke?(at.L=+ke[0],je+ke[0].length):-1}function I(at,ct,je){var ke=r.exec(ct.slice(je,je+6));return ke?(at.L=Math.floor(ke[0]/1e3),je+ke[0].length):-1}function D(at,ct,je){var ke=t.exec(ct.slice(je,je+1));return ke?je+ke[0].length:-1}function R(at,ct,je){var ke=r.exec(ct.slice(je));return ke?(at.Q=+ke[0],je+ke[0].length):-1}function B(at,ct,je){var ke=r.exec(ct.slice(je));return ke?(at.s=+ke[0],je+ke[0].length):-1}function F(at,ct){return o(at.getDate(),ct,2)}function V(at,ct){return o(at.getHours(),ct,2)}function G(at,ct){return o(at.getHours()%12||12,ct,2)}function J(at,ct){return o(1+c.timeDay.count(c.timeYear(at),at),ct,3)}function j(at,ct){return o(at.getMilliseconds(),ct,3)}function Y(at,ct){return j(at,ct)+"000"}function X(at,ct){return o(at.getMonth()+1,ct,2)}function oe(at,ct){return o(at.getMinutes(),ct,2)}function se(at,ct){return o(at.getSeconds(),ct,2)}function ie(at){var ct=at.getDay();return ct===0?7:ct}function N(at,ct){return o(c.timeSunday.count(c.timeYear(at)-1,at),ct,2)}function U(at,ct){var je=at.getDay();return at=je>=4||je===0?c.timeThursday(at):c.timeThursday.ceil(at),o(c.timeThursday.count(c.timeYear(at),at)+(c.timeYear(at).getDay()===4),ct,2)}function q(at){return at.getDay()}function Q(at,ct){return o(c.timeMonday.count(c.timeYear(at)-1,at),ct,2)}function W(at,ct){return o(at.getFullYear()%100,ct,2)}function Z(at,ct){return o(at.getFullYear()%1e4,ct,4)}function ee(at){var ct=at.getTimezoneOffset();return(ct>0?"-":(ct*=-1,"+"))+o(ct/60|0,"0",2)+o(ct%60,"0",2)}function te(at,ct){return o(at.getUTCDate(),ct,2)}function ae(at,ct){return o(at.getUTCHours(),ct,2)}function le(at,ct){return o(at.getUTCHours()%12||12,ct,2)}function ye(at,ct){return o(1+c.utcDay.count(c.utcYear(at),at),ct,3)}function fe(at,ct){return o(at.getUTCMilliseconds(),ct,3)}function pe(at,ct){return fe(at,ct)+"000"}function ge(at,ct){return o(at.getUTCMonth()+1,ct,2)}function Ae(at,ct){return o(at.getUTCMinutes(),ct,2)}function we(at,ct){return o(at.getUTCSeconds(),ct,2)}function De(at){var ct=at.getUTCDay();return ct===0?7:ct}function Be(at,ct){return o(c.utcSunday.count(c.utcYear(at)-1,at),ct,2)}function Ve(at,ct){var je=at.getUTCDay();return at=je>=4||je===0?c.utcThursday(at):c.utcThursday.ceil(at),o(c.utcThursday.count(c.utcYear(at),at)+(c.utcYear(at).getUTCDay()===4),ct,2)}function xe(at){return at.getUTCDay()}function Le(at,ct){return o(c.utcMonday.count(c.utcYear(at)-1,at),ct,2)}function He(at,ct){return o(at.getUTCFullYear()%100,ct,2)}function Je(at,ct){return o(at.getUTCFullYear()%1e4,ct,4)}function Oe(){return"+0000"}function Pe(){return"%"}function Ue(at){return+at}function vt(at){return Math.floor(+at/1e3)}var Lt;Yt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Yt(at){return Lt=a(at),w.timeFormat=Lt.format,w.timeParse=Lt.parse,w.utcFormat=Lt.utcFormat,w.utcParse=Lt.utcParse,Lt}var At="%Y-%m-%dT%H:%M:%S.%LZ";function Rt(at){return at.toISOString()}var Bt=Date.prototype.toISOString?Rt:w.utcFormat(At);function Mt(at){var ct=new Date(at);return isNaN(ct)?null:ct}var Tt=+new Date("2000-01-01T00:00:00.000Z")?Mt:w.utcParse(At);w.isoFormat=Bt,w.isoParse=Tt,w.timeFormatDefaultLocale=Yt,w.timeFormatLocale=a,Object.defineProperty(w,"__esModule",{value:!0})})},{"d3-time":121}],121:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne):(w=w||self,c(w.d3=w.d3||{}))})(this,function(w){var c=new Date,M=new Date;function T(xe,Le,He,Je){function Oe(Pe){return xe(Pe=arguments.length===0?new Date:new Date(+Pe)),Pe}return Oe.floor=function(Pe){return xe(Pe=new Date(+Pe)),Pe},Oe.ceil=function(Pe){return xe(Pe=new Date(Pe-1)),Le(Pe,1),xe(Pe),Pe},Oe.round=function(Pe){var Ue=Oe(Pe),vt=Oe.ceil(Pe);return Pe-Ue<vt-Pe?Ue:vt},Oe.offset=function(Pe,Ue){return Le(Pe=new Date(+Pe),Ue==null?1:Math.floor(Ue)),Pe},Oe.range=function(Pe,Ue,vt){var Lt=[],Yt;if(Pe=Oe.ceil(Pe),vt=vt==null?1:Math.floor(vt),!(Pe<Ue)||!(vt>0))return Lt;do Lt.push(Yt=new Date(+Pe)),Le(Pe,vt),xe(Pe);while(Yt<Pe&&Pe<Ue);return Lt},Oe.filter=function(Pe){return T(function(Ue){if(Ue>=Ue)for(;xe(Ue),!Pe(Ue);)Ue.setTime(Ue-1)},function(Ue,vt){if(Ue>=Ue)if(vt<0)for(;++vt<=0;)for(;Le(Ue,-1),!Pe(Ue););else for(;--vt>=0;)for(;Le(Ue,1),!Pe(Ue););})},He&&(Oe.count=function(Pe,Ue){return c.setTime(+Pe),M.setTime(+Ue),xe(c),xe(M),Math.floor(He(c,M))},Oe.every=function(Pe){return Pe=Math.floor(Pe),!isFinite(Pe)||!(Pe>0)?null:Pe>1?Oe.filter(Je?function(Ue){return Je(Ue)%Pe===0}:function(Ue){return Oe.count(0,Ue)%Pe===0}):Oe}),Oe}var e=T(function(){},function(xe,Le){xe.setTime(+xe+Le)},function(xe,Le){return Le-xe});e.every=function(xe){return xe=Math.floor(xe),!isFinite(xe)||!(xe>0)?null:xe>1?T(function(Le){Le.setTime(Math.floor(Le/xe)*xe)},function(Le,He){Le.setTime(+Le+He*xe)},function(Le,He){return(He-Le)/xe}):e};var a=e.range,n=1e3,r=6e4,t=36e5,f=864e5,o=6048e5,i=T(function(xe){xe.setTime(xe-xe.getMilliseconds())},function(xe,Le){xe.setTime(+xe+Le*n)},function(xe,Le){return(Le-xe)/n},function(xe){return xe.getUTCSeconds()}),g=i.range,p=T(function(xe){xe.setTime(xe-xe.getMilliseconds()-xe.getSeconds()*n)},function(xe,Le){xe.setTime(+xe+Le*r)},function(xe,Le){return(Le-xe)/r},function(xe){return xe.getMinutes()}),y=p.range,h=T(function(xe){xe.setTime(xe-xe.getMilliseconds()-xe.getSeconds()*n-xe.getMinutes()*r)},function(xe,Le){xe.setTime(+xe+Le*t)},function(xe,Le){return(Le-xe)/t},function(xe){return xe.getHours()}),m=h.range,u=T(function(xe){xe.setHours(0,0,0,0)},function(xe,Le){xe.setDate(xe.getDate()+Le)},function(xe,Le){return(Le-xe-(Le.getTimezoneOffset()-xe.getTimezoneOffset())*r)/f},function(xe){return xe.getDate()-1}),_=u.range;function s(xe){return T(function(Le){Le.setDate(Le.getDate()-(Le.getDay()+7-xe)%7),Le.setHours(0,0,0,0)},function(Le,He){Le.setDate(Le.getDate()+He*7)},function(Le,He){return(He-Le-(He.getTimezoneOffset()-Le.getTimezoneOffset())*r)/o})}var A=s(0),x=s(1),v=s(2),b=s(3),l=s(4),L=s(5),S=s(6),k=A.range,P=x.range,z=v.range,I=b.range,D=l.range,R=L.range,B=S.range,F=T(function(xe){xe.setDate(1),xe.setHours(0,0,0,0)},function(xe,Le){xe.setMonth(xe.getMonth()+Le)},function(xe,Le){return Le.getMonth()-xe.getMonth()+(Le.getFullYear()-xe.getFullYear())*12},function(xe){return xe.getMonth()}),V=F.range,G=T(function(xe){xe.setMonth(0,1),xe.setHours(0,0,0,0)},function(xe,Le){xe.setFullYear(xe.getFullYear()+Le)},function(xe,Le){return Le.getFullYear()-xe.getFullYear()},function(xe){return xe.getFullYear()});G.every=function(xe){return!isFinite(xe=Math.floor(xe))||!(xe>0)?null:T(function(Le){Le.setFullYear(Math.floor(Le.getFullYear()/xe)*xe),Le.setMonth(0,1),Le.setHours(0,0,0,0)},function(Le,He){Le.setFullYear(Le.getFullYear()+He*xe)})};var J=G.range,j=T(function(xe){xe.setUTCSeconds(0,0)},function(xe,Le){xe.setTime(+xe+Le*r)},function(xe,Le){return(Le-xe)/r},function(xe){return xe.getUTCMinutes()}),Y=j.range,X=T(function(xe){xe.setUTCMinutes(0,0,0)},function(xe,Le){xe.setTime(+xe+Le*t)},function(xe,Le){return(Le-xe)/t},function(xe){return xe.getUTCHours()}),oe=X.range,se=T(function(xe){xe.setUTCHours(0,0,0,0)},function(xe,Le){xe.setUTCDate(xe.getUTCDate()+Le)},function(xe,Le){return(Le-xe)/f},function(xe){return xe.getUTCDate()-1}),ie=se.range;function N(xe){return T(function(Le){Le.setUTCDate(Le.getUTCDate()-(Le.getUTCDay()+7-xe)%7),Le.setUTCHours(0,0,0,0)},function(Le,He){Le.setUTCDate(Le.getUTCDate()+He*7)},function(Le,He){return(He-Le)/o})}var U=N(0),q=N(1),Q=N(2),W=N(3),Z=N(4),ee=N(5),te=N(6),ae=U.range,le=q.range,ye=Q.range,fe=W.range,pe=Z.range,ge=ee.range,Ae=te.range,we=T(function(xe){xe.setUTCDate(1),xe.setUTCHours(0,0,0,0)},function(xe,Le){xe.setUTCMonth(xe.getUTCMonth()+Le)},function(xe,Le){return Le.getUTCMonth()-xe.getUTCMonth()+(Le.getUTCFullYear()-xe.getUTCFullYear())*12},function(xe){return xe.getUTCMonth()}),De=we.range,Be=T(function(xe){xe.setUTCMonth(0,1),xe.setUTCHours(0,0,0,0)},function(xe,Le){xe.setUTCFullYear(xe.getUTCFullYear()+Le)},function(xe,Le){return Le.getUTCFullYear()-xe.getUTCFullYear()},function(xe){return xe.getUTCFullYear()});Be.every=function(xe){return!isFinite(xe=Math.floor(xe))||!(xe>0)?null:T(function(Le){Le.setUTCFullYear(Math.floor(Le.getUTCFullYear()/xe)*xe),Le.setUTCMonth(0,1),Le.setUTCHours(0,0,0,0)},function(Le,He){Le.setUTCFullYear(Le.getUTCFullYear()+He*xe)})};var Ve=Be.range;w.timeDay=u,w.timeDays=_,w.timeFriday=L,w.timeFridays=R,w.timeHour=h,w.timeHours=m,w.timeInterval=T,w.timeMillisecond=e,w.timeMilliseconds=a,w.timeMinute=p,w.timeMinutes=y,w.timeMonday=x,w.timeMondays=P,w.timeMonth=F,w.timeMonths=V,w.timeSaturday=S,w.timeSaturdays=B,w.timeSecond=i,w.timeSeconds=g,w.timeSunday=A,w.timeSundays=k,w.timeThursday=l,w.timeThursdays=D,w.timeTuesday=v,w.timeTuesdays=z,w.timeWednesday=b,w.timeWednesdays=I,w.timeWeek=A,w.timeWeeks=k,w.timeYear=G,w.timeYears=J,w.utcDay=se,w.utcDays=ie,w.utcFriday=ee,w.utcFridays=ge,w.utcHour=X,w.utcHours=oe,w.utcMillisecond=e,w.utcMilliseconds=a,w.utcMinute=j,w.utcMinutes=Y,w.utcMonday=q,w.utcMondays=le,w.utcMonth=we,w.utcMonths=De,w.utcSaturday=te,w.utcSaturdays=Ae,w.utcSecond=i,w.utcSeconds=g,w.utcSunday=U,w.utcSundays=ae,w.utcThursday=Z,w.utcThursdays=pe,w.utcTuesday=Q,w.utcTuesdays=ye,w.utcWednesday=W,w.utcWednesdays=fe,w.utcWeek=U,w.utcWeeks=ae,w.utcYear=Be,w.utcYears=Ve,Object.defineProperty(w,"__esModule",{value:!0})})},{}],122:[function(d,re,ne){arguments[4][121][0].apply(ne,arguments)},{dup:121}],123:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne):(w=w||self,c(w.d3=w.d3||{}))})(this,function(w){var c=0,M=0,T=0,e=1e3,a,n,r=0,t=0,f=0,o=typeof performance=="object"&&performance.now?performance:Date,i=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(b){setTimeout(b,17)};function g(){return t||(i(p),t=o.now()+f)}function p(){t=0}function y(){this._call=this._time=this._next=null}y.prototype=h.prototype={constructor:y,restart:function(b,l,L){if(typeof b!="function")throw new TypeError("callback is not a function");L=(L==null?g():+L)+(l==null?0:+l),!this._next&&n!==this&&(n?n._next=this:a=this,n=this),this._call=b,this._time=L,A()},stop:function(){this._call&&(this._call=null,this._time=1/0,A())}};function h(b,l,L){var S=new y;return S.restart(b,l,L),S}function m(){g(),++c;for(var b=a,l;b;)(l=t-b._time)>=0&&b._call.call(null,l),b=b._next;--c}function u(){t=(r=o.now())+f,c=M=0;try{m()}finally{c=0,s(),t=0}}function _(){var b=o.now(),l=b-r;l>e&&(f-=l,r=b)}function s(){for(var b,l=a,L,S=1/0;l;)l._call?(S>l._time&&(S=l._time),b=l,l=l._next):(L=l._next,l._next=null,l=b?b._next=L:a=L);n=b,A(S)}function A(b){if(!c){M&&(M=clearTimeout(M));var l=b-t;l>24?(b<1/0&&(M=setTimeout(u,b-o.now()-f)),T&&(T=clearInterval(T))):(T||(r=o.now(),T=setInterval(_,e)),c=1,i(u))}}function x(b,l,L){var S=new y;return l=l==null?0:+l,S.restart(function(k){S.stop(),b(k+l)},l,L),S}function v(b,l,L){var S=new y,k=l;return l==null?(S.restart(b,l,L),S):(l=+l,L=L==null?g():+L,S.restart(function P(z){z+=k,S.restart(P,k+=l,L),b(z)},l,L),S)}w.interval=v,w.now=g,w.timeout=x,w.timer=h,w.timerFlush=m,Object.defineProperty(w,"__esModule",{value:!0})})},{}],124:[function(d,re,ne){re.exports=function(){for(var w=0;w<arguments.length;w++)if(arguments[w]!==void 0)return arguments[w]}},{}],125:[function(d,re,ne){re.exports=T;var w=T.canvas=document.createElement("canvas"),c=w.getContext("2d"),M=e([32,126]);T.createPairs=e,T.ascii=M;function T(a,n){Array.isArray(a)&&(a=a.join(", "));var r={},t,f=16,o=.05;n&&(n.length===2&&typeof n[0]=="number"?t=e(n):Array.isArray(n)?t=n:(n.o?t=e(n.o):n.pairs&&(t=n.pairs),n.fontSize&&(f=n.fontSize),n.threshold!=null&&(o=n.threshold))),t||(t=M),c.font=f+"px "+a;for(var i=0;i<t.length;i++){var g=t[i],p=c.measureText(g[0]).width+c.measureText(g[1]).width,y=c.measureText(g).width;if(Math.abs(p-y)>f*o){var h=(y-p)/f;r[g]=h*1e3}}return r}function e(a){for(var n=[],r=a[0];r<=a[1];r++)for(var t=String.fromCharCode(r),f=a[0];f<a[1];f++){var o=String.fromCharCode(f),i=t+o;n.push(i)}return n}},{}],126:[function(d,re,ne){var w=d("abs-svg-path"),c=d("normalize-svg-path"),M={M:"moveTo",C:"bezierCurveTo"};re.exports=function(T,e){T.beginPath(),c(w(e)).forEach(function(a){var n=a[0],r=a.slice(1);T[M[n]].apply(T,r)}),T.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(d,re,ne){re.exports=function(w){switch(w){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(d,re,ne){function w(T,e,a){var n=T[a]|0;if(n<=0)return[];var r=new Array(n),t;if(a===T.length-1)for(t=0;t<n;++t)r[t]=e;else for(t=0;t<n;++t)r[t]=w(T,e,a+1);return r}function c(T,e){var a,n;for(a=new Array(T),n=0;n<T;++n)a[n]=e;return a}function M(T,e){switch(typeof e=="undefined"&&(e=0),typeof T){case"number":if(T>0)return c(T|0,e);break;case"object":if(typeof T.length=="number")return w(T,e,0);break}return[]}re.exports=M},{}],129:[function(d,re,ne){re.exports=w,re.exports.default=w;function w(R,B,F){F=F||2;var V=B&&B.length,G=V?B[0]*F:R.length,J=c(R,0,G,F,!0),j=[];if(!J||J.next===J.prev)return j;var Y,X,oe,se,ie,N,U;if(V&&(J=t(R,B,J,F)),R.length>80*F){Y=oe=R[0],X=se=R[1];for(var q=F;q<G;q+=F)ie=R[q],N=R[q+1],ie<Y&&(Y=ie),N<X&&(X=N),ie>oe&&(oe=ie),N>se&&(se=N);U=Math.max(oe-Y,se-X),U=U!==0?1/U:0}return T(J,j,F,Y,X,U),j}function c(R,B,F,V,G){var J,j;if(G===D(R,B,F,V)>0)for(J=B;J<F;J+=V)j=P(J,R[J],R[J+1],j);else for(J=F-V;J>=B;J-=V)j=P(J,R[J],R[J+1],j);return j&&A(j,j.next)&&(z(j),j=j.next),j}function M(R,B){if(!R)return R;B||(B=R);var F=R,V;do if(V=!1,!F.steiner&&(A(F,F.next)||s(F.prev,F,F.next)===0)){if(z(F),F=B=F.prev,F===F.next)break;V=!0}else F=F.next;while(V||F!==B);return B}function T(R,B,F,V,G,J,j){if(!!R){!j&&J&&p(R,V,G,J);for(var Y=R,X,oe;R.prev!==R.next;){if(X=R.prev,oe=R.next,J?a(R,V,G,J):e(R)){B.push(X.i/F),B.push(R.i/F),B.push(oe.i/F),z(R),R=oe.next,Y=oe.next;continue}if(R=oe,R===Y){j?j===1?(R=n(M(R),B,F),T(R,B,F,V,G,J,2)):j===2&&r(R,B,F,V,G,J):T(M(R),B,F,V,G,J,1);break}}}}function e(R){var B=R.prev,F=R,V=R.next;if(s(B,F,V)>=0)return!1;for(var G=R.next.next;G!==R.prev;){if(u(B.x,B.y,F.x,F.y,V.x,V.y,G.x,G.y)&&s(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function a(R,B,F,V){var G=R.prev,J=R,j=R.next;if(s(G,J,j)>=0)return!1;for(var Y=G.x<J.x?G.x<j.x?G.x:j.x:J.x<j.x?J.x:j.x,X=G.y<J.y?G.y<j.y?G.y:j.y:J.y<j.y?J.y:j.y,oe=G.x>J.x?G.x>j.x?G.x:j.x:J.x>j.x?J.x:j.x,se=G.y>J.y?G.y>j.y?G.y:j.y:J.y>j.y?J.y:j.y,ie=h(Y,X,B,F,V),N=h(oe,se,B,F,V),U=R.prevZ,q=R.nextZ;U&&U.z>=ie&&q&&q.z<=N;){if(U!==R.prev&&U!==R.next&&u(G.x,G.y,J.x,J.y,j.x,j.y,U.x,U.y)&&s(U.prev,U,U.next)>=0||(U=U.prevZ,q!==R.prev&&q!==R.next&&u(G.x,G.y,J.x,J.y,j.x,j.y,q.x,q.y)&&s(q.prev,q,q.next)>=0))return!1;q=q.nextZ}for(;U&&U.z>=ie;){if(U!==R.prev&&U!==R.next&&u(G.x,G.y,J.x,J.y,j.x,j.y,U.x,U.y)&&s(U.prev,U,U.next)>=0)return!1;U=U.prevZ}for(;q&&q.z<=N;){if(q!==R.prev&&q!==R.next&&u(G.x,G.y,J.x,J.y,j.x,j.y,q.x,q.y)&&s(q.prev,q,q.next)>=0)return!1;q=q.nextZ}return!0}function n(R,B,F){var V=R;do{var G=V.prev,J=V.next.next;!A(G,J)&&x(G,V,V.next,J)&&L(G,J)&&L(J,G)&&(B.push(G.i/F),B.push(V.i/F),B.push(J.i/F),z(V),z(V.next),V=R=J),V=V.next}while(V!==R);return M(V)}function r(R,B,F,V,G,J){var j=R;do{for(var Y=j.next.next;Y!==j.prev;){if(j.i!==Y.i&&_(j,Y)){var X=k(j,Y);j=M(j,j.next),X=M(X,X.next),T(j,B,F,V,G,J),T(X,B,F,V,G,J);return}Y=Y.next}j=j.next}while(j!==R)}function t(R,B,F,V){var G=[],J,j,Y,X,oe;for(J=0,j=B.length;J<j;J++)Y=B[J]*V,X=J<j-1?B[J+1]*V:R.length,oe=c(R,Y,X,V,!1),oe===oe.next&&(oe.steiner=!0),G.push(m(oe));for(G.sort(f),J=0;J<G.length;J++)o(G[J],F),F=M(F,F.next);return F}function f(R,B){return R.x-B.x}function o(R,B){if(B=i(R,B),B){var F=k(B,R);M(B,B.next),M(F,F.next)}}function i(R,B){var F=B,V=R.x,G=R.y,J=-1/0,j;do{if(G<=F.y&&G>=F.next.y&&F.next.y!==F.y){var Y=F.x+(G-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(Y<=V&&Y>J){if(J=Y,Y===V){if(G===F.y)return F;if(G===F.next.y)return F.next}j=F.x<F.next.x?F:F.next}}F=F.next}while(F!==B);if(!j)return null;if(V===J)return j;var X=j,oe=j.x,se=j.y,ie=1/0,N;F=j;do V>=F.x&&F.x>=oe&&V!==F.x&&u(G<se?V:J,G,oe,se,G<se?J:V,G,F.x,F.y)&&(N=Math.abs(G-F.y)/(V-F.x),L(F,R)&&(N<ie||N===ie&&(F.x>j.x||F.x===j.x&&g(j,F)))&&(j=F,ie=N)),F=F.next;while(F!==X);return j}function g(R,B){return s(R.prev,R,B.prev)<0&&s(B.next,R,R.next)<0}function p(R,B,F,V){var G=R;do G.z===null&&(G.z=h(G.x,G.y,B,F,V)),G.prevZ=G.prev,G.nextZ=G.next,G=G.next;while(G!==R);G.prevZ.nextZ=null,G.prevZ=null,y(G)}function y(R){var B,F,V,G,J,j,Y,X,oe=1;do{for(F=R,R=null,J=null,j=0;F;){for(j++,V=F,Y=0,B=0;B<oe&&(Y++,V=V.nextZ,!!V);B++);for(X=oe;Y>0||X>0&&V;)Y!==0&&(X===0||!V||F.z<=V.z)?(G=F,F=F.nextZ,Y--):(G=V,V=V.nextZ,X--),J?J.nextZ=G:R=G,G.prevZ=J,J=G;F=V}J.nextZ=null,oe*=2}while(j>1);return R}function h(R,B,F,V,G){return R=32767*(R-F)*G,B=32767*(B-V)*G,R=(R|R<<8)&16711935,R=(R|R<<4)&252645135,R=(R|R<<2)&858993459,R=(R|R<<1)&1431655765,B=(B|B<<8)&16711935,B=(B|B<<4)&252645135,B=(B|B<<2)&858993459,B=(B|B<<1)&1431655765,R|B<<1}function m(R){var B=R,F=R;do(B.x<F.x||B.x===F.x&&B.y<F.y)&&(F=B),B=B.next;while(B!==R);return F}function u(R,B,F,V,G,J,j,Y){return(G-j)*(B-Y)-(R-j)*(J-Y)>=0&&(R-j)*(V-Y)-(F-j)*(B-Y)>=0&&(F-j)*(J-Y)-(G-j)*(V-Y)>=0}function _(R,B){return R.next.i!==B.i&&R.prev.i!==B.i&&!l(R,B)&&(L(R,B)&&L(B,R)&&S(R,B)&&(s(R.prev,R,B.prev)||s(R,B.prev,B))||A(R,B)&&s(R.prev,R,R.next)>0&&s(B.prev,B,B.next)>0)}function s(R,B,F){return(B.y-R.y)*(F.x-B.x)-(B.x-R.x)*(F.y-B.y)}function A(R,B){return R.x===B.x&&R.y===B.y}function x(R,B,F,V){var G=b(s(R,B,F)),J=b(s(R,B,V)),j=b(s(F,V,R)),Y=b(s(F,V,B));return!!(G!==J&&j!==Y||G===0&&v(R,F,B)||J===0&&v(R,V,B)||j===0&&v(F,R,V)||Y===0&&v(F,B,V))}function v(R,B,F){return B.x<=Math.max(R.x,F.x)&&B.x>=Math.min(R.x,F.x)&&B.y<=Math.max(R.y,F.y)&&B.y>=Math.min(R.y,F.y)}function b(R){return R>0?1:R<0?-1:0}function l(R,B){var F=R;do{if(F.i!==R.i&&F.next.i!==R.i&&F.i!==B.i&&F.next.i!==B.i&&x(F,F.next,R,B))return!0;F=F.next}while(F!==R);return!1}function L(R,B){return s(R.prev,R,R.next)<0?s(R,B,R.next)>=0&&s(R,R.prev,B)>=0:s(R,B,R.prev)<0||s(R,R.next,B)<0}function S(R,B){var F=R,V=!1,G=(R.x+B.x)/2,J=(R.y+B.y)/2;do F.y>J!=F.next.y>J&&F.next.y!==F.y&&G<(F.next.x-F.x)*(J-F.y)/(F.next.y-F.y)+F.x&&(V=!V),F=F.next;while(F!==R);return V}function k(R,B){var F=new I(R.i,R.x,R.y),V=new I(B.i,B.x,B.y),G=R.next,J=B.prev;return R.next=B,B.prev=R,F.next=G,G.prev=F,V.next=F,F.prev=V,J.next=V,V.prev=J,V}function P(R,B,F,V){var G=new I(R,B,F);return V?(G.next=V.next,G.prev=V,V.next.prev=G,V.next=G):(G.prev=G,G.next=G),G}function z(R){R.next.prev=R.prev,R.prev.next=R.next,R.prevZ&&(R.prevZ.nextZ=R.nextZ),R.nextZ&&(R.nextZ.prevZ=R.prevZ)}function I(R,B,F){this.i=R,this.x=B,this.y=F,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}w.deviation=function(R,B,F,V){var G=B&&B.length,J=G?B[0]*F:R.length,j=Math.abs(D(R,0,J,F));if(G)for(var Y=0,X=B.length;Y<X;Y++){var oe=B[Y]*F,se=Y<X-1?B[Y+1]*F:R.length;j-=Math.abs(D(R,oe,se,F))}var ie=0;for(Y=0;Y<V.length;Y+=3){var N=V[Y]*F,U=V[Y+1]*F,q=V[Y+2]*F;ie+=Math.abs((R[N]-R[q])*(R[U+1]-R[N+1])-(R[N]-R[U])*(R[q+1]-R[N+1]))}return j===0&&ie===0?0:Math.abs((ie-j)/j)};function D(R,B,F,V){for(var G=0,J=B,j=F-V;J<F;J+=V)G+=(R[j]-R[J])*(R[J+1]+R[j+1]),j=J;return G}w.flatten=function(R){for(var B=R[0][0].length,F={vertices:[],holes:[],dimensions:B},V=0,G=0;G<R.length;G++){for(var J=0;J<R[G].length;J++)for(var j=0;j<B;j++)F.vertices.push(R[G][J][j]);G>0&&(V+=R[G-1].length,F.holes.push(V))}return F}},{}],130:[function(d,re,ne){var w=d("strongly-connected-components");re.exports=function(M,T){var e=[],a=[],n=[],r={},t=[],f;function o(A){n[A]=!1,r.hasOwnProperty(A)&&Object.keys(r[A]).forEach(function(x){delete r[A][x],n[x]&&o(x)})}function i(A){var x=!1;a.push(A),n[A]=!0;var v,b;for(v=0;v<t[A].length;v++)b=t[A][v],b===f?(g(f,a),x=!0):n[b]||(x=i(b));if(x)o(A);else for(v=0;v<t[A].length;v++){b=t[A][v];var l=r[b];l||(l={},r[b]=l),l[b]=!0}return a.pop(),x}function g(A,x){var v=[].concat(x).concat(A);T?T(i):e.push(v)}function p(A){for(var x=0;x<M.length;x++)x<A&&(M[x]=[]),M[x]=M[x].filter(function(v){return v>=A})}function y(A){p(A);for(var x=M,v=w(x),b=v.components.filter(function(I){return I.length>1}),l=1/0,L,S=0;S<b.length;S++)for(var k=0;k<b[S].length;k++)b[S][k]<l&&(l=b[S][k],L=S);var P=b[L];if(!P)return!1;var z=M.map(function(I,D){return P.indexOf(D)===-1?[]:I.filter(function(R){return P.indexOf(R)!==-1})});return{leastVertex:l,adjList:z}}f=0;for(var h=M.length;f<h;){var m=y(f);if(f=m.leastVertex,t=m.adjList,t){for(var u=0;u<t.length;u++)for(var _=0;_<t[u].length;_++){var s=t[u][_];n[+s]=!1,r[s]={}}i(f),f=f+1}else f=h}if(!T)return e}},{"strongly-connected-components":306}],131:[function(d,re,ne){var w=d("../../object/valid-value");re.exports=function(){return w(this).length=0,this}},{"../../object/valid-value":162}],132:[function(d,re,ne){re.exports=d("./is-implemented")()?Array.from:d("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(d,re,ne){re.exports=function(){var w=Array.from,c,M;return typeof w!="function"?!1:(c=["raz","dwa"],M=w(c),Boolean(M&&M!==c&&M[1]==="dwa"))}},{}],134:[function(d,re,ne){var w=d("es6-symbol").iterator,c=d("../../function/is-arguments"),M=d("../../function/is-function"),T=d("../../number/to-pos-integer"),e=d("../../object/valid-callable"),a=d("../../object/valid-value"),n=d("../../object/is-value"),r=d("../../string/is-string"),t=Array.isArray,f=Function.prototype.call,o={configurable:!0,enumerable:!0,writable:!0,value:null},i=Object.defineProperty;re.exports=function(g){var p=arguments[1],y=arguments[2],h,m,u,_,s,A,x,v,b,l;if(g=Object(a(g)),n(p)&&e(p),!this||this===Array||!M(this)){if(!p){if(c(g))return s=g.length,s!==1?Array.apply(null,g):(_=new Array(1),_[0]=g[0],_);if(t(g)){for(_=new Array(s=g.length),m=0;m<s;++m)_[m]=g[m];return _}}_=[]}else h=this;if(!t(g)){if((b=g[w])!==void 0){for(x=e(b).call(g),h&&(_=new h),v=x.next(),m=0;!v.done;)l=p?f.call(p,y,v.value,m):v.value,h?(o.value=l,i(_,m,o)):_[m]=l,v=x.next(),++m;s=m}else if(r(g)){for(s=g.length,h&&(_=new h),m=0,u=0;m<s;++m)l=g[m],m+1<s&&(A=l.charCodeAt(0),A>=55296&&A<=56319&&(l+=g[++m])),l=p?f.call(p,y,l,u):l,h?(o.value=l,i(_,u,o)):_[u]=l,++u;s=u}}if(s===void 0)for(s=T(g.length),h&&(_=new h(s)),m=0;m<s;++m)l=p?f.call(p,y,g[m],m):g[m],h?(o.value=l,i(_,m,o)):_[m]=l;return h&&(o.value=null,_.length=s),_}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(d,re,ne){var w=Object.prototype.toString,c=w.call(function(){return arguments}());re.exports=function(M){return w.call(M)===c}},{}],136:[function(d,re,ne){var w=Object.prototype.toString,c=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);re.exports=function(M){return typeof M=="function"&&c(w.call(M))}},{}],137:[function(d,re,ne){re.exports=function(){}},{}],138:[function(d,re,ne){re.exports=d("./is-implemented")()?Math.sign:d("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(d,re,ne){re.exports=function(){var w=Math.sign;return typeof w!="function"?!1:w(10)===1&&w(-20)===-1}},{}],140:[function(d,re,ne){re.exports=function(w){return w=Number(w),isNaN(w)||w===0?w:w>0?1:-1}},{}],141:[function(d,re,ne){var w=d("../math/sign"),c=Math.abs,M=Math.floor;re.exports=function(T){return isNaN(T)?0:(T=Number(T),T===0||!isFinite(T)?T:w(T)*M(c(T)))}},{"../math/sign":138}],142:[function(d,re,ne){var w=d("./to-integer"),c=Math.max;re.exports=function(M){return c(0,w(M))}},{"./to-integer":141}],143:[function(d,re,ne){var w=d("./valid-callable"),c=d("./valid-value"),M=Function.prototype.bind,T=Function.prototype.call,e=Object.keys,a=Object.prototype.propertyIsEnumerable;re.exports=function(n,r){return function(t,f){var o,i=arguments[2],g=arguments[3];return t=Object(c(t)),w(f),o=e(t),g&&o.sort(typeof g=="function"?M.call(g,t):void 0),typeof n!="function"&&(n=o[n]),T.call(n,o,function(p,y){return a.call(t,p)?T.call(f,i,t[p],p,t,y):r})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(d,re,ne){re.exports=d("./is-implemented")()?Object.assign:d("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(d,re,ne){re.exports=function(){var w=Object.assign,c;return typeof w!="function"?!1:(c={foo:"raz"},w(c,{bar:"dwa"},{trzy:"trzy"}),c.foo+c.bar+c.trzy==="razdwatrzy")}},{}],146:[function(d,re,ne){var w=d("../keys"),c=d("../valid-value"),M=Math.max;re.exports=function(T,e){var a,n,r=M(arguments.length,2),t;for(T=Object(c(T)),t=function(f){try{T[f]=e[f]}catch(o){a||(a=o)}},n=1;n<r;++n)e=arguments[n],w(e).forEach(t);if(a!==void 0)throw a;return T}},{"../keys":152,"../valid-value":162}],147:[function(d,re,ne){var w=d("../array/from"),c=d("./assign"),M=d("./valid-value");re.exports=function(T){var e=Object(M(T)),a=arguments[1],n=Object(arguments[2]);if(e!==T&&!a)return e;var r={};return a?w(a,function(t){(n.ensure||t in T)&&(r[t]=T[t])}):c(r,T),r}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(d,re,ne){var w=Object.create,c;d("./set-prototype-of/is-implemented")()||(c=d("./set-prototype-of/shim")),re.exports=function(){var M,T,e;return!c||c.level!==1?w:(M={},T={},e={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(a){if(a==="__proto__"){T[a]={configurable:!0,enumerable:!1,writable:!0,value:void 0};return}T[a]=e}),Object.defineProperties(M,T),Object.defineProperty(c,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:M}),function(a,n){return w(a===null?M:a,n)})}()},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(d,re,ne){re.exports=d("./_iterate")("forEach")},{"./_iterate":143}],150:[function(d,re,ne){var w=d("./is-value"),c={function:!0,object:!0};re.exports=function(M){return w(M)&&c[typeof M]||!1}},{"./is-value":151}],151:[function(d,re,ne){var w=d("../function/noop")();re.exports=function(c){return c!==w&&c!==null}},{"../function/noop":137}],152:[function(d,re,ne){re.exports=d("./is-implemented")()?Object.keys:d("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(d,re,ne){re.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],154:[function(d,re,ne){var w=d("../is-value"),c=Object.keys;re.exports=function(M){return c(w(M)?Object(M):M)}},{"../is-value":151}],155:[function(d,re,ne){var w=d("./valid-callable"),c=d("./for-each"),M=Function.prototype.call;re.exports=function(T,e){var a={},n=arguments[2];return w(e),c(T,function(r,t,f,o){a[t]=M.call(e,n,r,t,f,o)}),a}},{"./for-each":149,"./valid-callable":160}],156:[function(d,re,ne){var w=d("./is-value"),c=Array.prototype.forEach,M=Object.create,T=function(e,a){var n;for(n in e)a[n]=e[n]};re.exports=function(e){var a=M(null);return c.call(arguments,function(n){!w(n)||T(Object(n),a)}),a}},{"./is-value":151}],157:[function(d,re,ne){re.exports=d("./is-implemented")()?Object.setPrototypeOf:d("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(d,re,ne){var w=Object.create,c=Object.getPrototypeOf,M={};re.exports=function(){var T=Object.setPrototypeOf,e=arguments[0]||w;return typeof T!="function"?!1:c(T(e(null),M))===M}},{}],159:[function(d,re,ne){var w=d("../is-object"),c=d("../valid-value"),M=Object.prototype.isPrototypeOf,T=Object.defineProperty,e={configurable:!0,enumerable:!1,writable:!0,value:void 0},a;a=function(n,r){if(c(n),r===null||w(r))return n;throw new TypeError("Prototype must be null or an object")},re.exports=function(n){var r,t;return n?(n.level===2?n.set?(t=n.set,r=function(f,o){return t.call(a(f,o),o),f}):r=function(f,o){return a(f,o).__proto__=o,f}:r=function f(o,i){var g;return a(o,i),g=M.call(f.nullPolyfill,o),g&&delete f.nullPolyfill.__proto__,i===null&&(i=f.nullPolyfill),o.__proto__=i,g&&T(f.nullPolyfill,"__proto__",e),o},Object.defineProperty(r,"level",{configurable:!1,enumerable:!1,writable:!1,value:n.level})):null}(function(){var n=Object.create(null),r={},t,f=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(f){try{t=f.set,t.call(n,r)}catch{}if(Object.getPrototypeOf(n)===r)return{set:t,level:2}}return n.__proto__=r,Object.getPrototypeOf(n)===r?{level:2}:(n={},n.__proto__=r,Object.getPrototypeOf(n)===r?{level:1}:!1)}()),d("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(d,re,ne){re.exports=function(w){if(typeof w!="function")throw new TypeError(w+" is not a function");return w}},{}],161:[function(d,re,ne){var w=d("./is-object");re.exports=function(c){if(!w(c))throw new TypeError(c+" is not an Object");return c}},{"./is-object":150}],162:[function(d,re,ne){var w=d("./is-value");re.exports=function(c){if(!w(c))throw new TypeError("Cannot use null or undefined");return c}},{"./is-value":151}],163:[function(d,re,ne){re.exports=d("./is-implemented")()?String.prototype.contains:d("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(d,re,ne){var w="razdwatrzy";re.exports=function(){return typeof w.contains!="function"?!1:w.contains("dwa")===!0&&w.contains("foo")===!1}},{}],165:[function(d,re,ne){var w=String.prototype.indexOf;re.exports=function(c){return w.call(this,c,arguments[1])>-1}},{}],166:[function(d,re,ne){var w=Object.prototype.toString,c=w.call("");re.exports=function(M){return typeof M=="string"||M&&typeof M=="object"&&(M instanceof String||w.call(M)===c)||!1}},{}],167:[function(d,re,ne){var w=Object.create(null),c=Math.random;re.exports=function(){var M;do M=c().toString(36).slice(2);while(w[M]);return M}},{}],168:[function(d,re,ne){var w=d("es5-ext/object/set-prototype-of"),c=d("es5-ext/string/#/contains"),M=d("d"),T=d("es6-symbol"),e=d("./"),a=Object.defineProperty,n;n=re.exports=function(r,t){if(!(this instanceof n))throw new TypeError("Constructor requires 'new'");e.call(this,r),t?c.call(t,"key+value")?t="key+value":c.call(t,"key")?t="key":t="value":t="value",a(this,"__kind__",M("",t))},w&&w(n,e),delete n.prototype.constructor,n.prototype=Object.create(e.prototype,{_resolve:M(function(r){return this.__kind__==="value"?this.__list__[r]:this.__kind__==="key+value"?[r,this.__list__[r]]:r})}),a(n.prototype,T.toStringTag,M("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(d,re,ne){var w=d("es5-ext/function/is-arguments"),c=d("es5-ext/object/valid-callable"),M=d("es5-ext/string/is-string"),T=d("./get"),e=Array.isArray,a=Function.prototype.call,n=Array.prototype.some;re.exports=function(r,t){var f,o=arguments[2],i,g,p,y,h,m,u;if(e(r)||w(r)?f="array":M(r)?f="string":r=T(r),c(t),g=function(){p=!0},f==="array"){n.call(r,function(_){return a.call(t,o,_,g),p});return}if(f==="string"){for(h=r.length,y=0;y<h&&(m=r[y],y+1<h&&(u=m.charCodeAt(0),u>=55296&&u<=56319&&(m+=r[++y])),a.call(t,o,m,g),!p);++y);return}for(i=r.next();!i.done;){if(a.call(t,o,i.value,g),p)return;i=r.next()}}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(d,re,ne){var w=d("es5-ext/function/is-arguments"),c=d("es5-ext/string/is-string"),M=d("./array"),T=d("./string"),e=d("./valid-iterable"),a=d("es6-symbol").iterator;re.exports=function(n){return typeof e(n)[a]=="function"?n[a]():w(n)?new M(n):c(n)?new T(n):new M(n)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(d,re,ne){var w=d("es5-ext/array/#/clear"),c=d("es5-ext/object/assign"),M=d("es5-ext/object/valid-callable"),T=d("es5-ext/object/valid-value"),e=d("d"),a=d("d/auto-bind"),n=d("es6-symbol"),r=Object.defineProperty,t=Object.defineProperties,f;re.exports=f=function(o,i){if(!(this instanceof f))throw new TypeError("Constructor requires 'new'");t(this,{__list__:e("w",T(o)),__context__:e("w",i),__nextIndex__:e("w",0)}),i&&(M(i.on),i.on("_add",this._onAdd),i.on("_delete",this._onDelete),i.on("_clear",this._onClear))},delete f.prototype.constructor,t(f.prototype,c({_next:e(function(){var o;if(!!this.__list__){if(this.__redo__&&(o=this.__redo__.shift(),o!==void 0))return o;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:e(function(){return this._createResult(this._next())}),_createResult:e(function(o){return o===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(o)}}),_resolve:e(function(o){return this.__list__[o]}),_unBind:e(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:e(function(){return"[object "+(this[n.toStringTag]||"Object")+"]"})},a({_onAdd:e(function(o){if(!(o>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__){r(this,"__redo__",e("c",[o]));return}this.__redo__.forEach(function(i,g){i>=o&&(this.__redo__[g]=++i)},this),this.__redo__.push(o)}}),_onDelete:e(function(o){var i;o>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(i=this.__redo__.indexOf(o),i!==-1&&this.__redo__.splice(i,1),this.__redo__.forEach(function(g,p){g>o&&(this.__redo__[p]=--g)},this)))}),_onClear:e(function(){this.__redo__&&w.call(this.__redo__),this.__nextIndex__=0})}))),r(f.prototype,n.iterator,e(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(d,re,ne){var w=d("es5-ext/function/is-arguments"),c=d("es5-ext/object/is-value"),M=d("es5-ext/string/is-string"),T=d("es6-symbol").iterator,e=Array.isArray;re.exports=function(a){return c(a)?e(a)||M(a)||w(a)?!0:typeof a[T]=="function":!1}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(d,re,ne){var w=d("es5-ext/object/set-prototype-of"),c=d("d"),M=d("es6-symbol"),T=d("./"),e=Object.defineProperty,a;a=re.exports=function(n){if(!(this instanceof a))throw new TypeError("Constructor requires 'new'");n=String(n),T.call(this,n),e(this,"__length__",c("",n.length))},w&&w(a,T),delete a.prototype.constructor,a.prototype=Object.create(T.prototype,{_next:c(function(){if(!!this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:c(function(n){var r=this.__list__[n],t;return this.__nextIndex__===this.__length__?r:(t=r.charCodeAt(0),t>=55296&&t<=56319?r+this.__list__[this.__nextIndex__++]:r)})}),e(a.prototype,M.toStringTag,c("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(d,re,ne){var w=d("./is-iterable");re.exports=function(c){if(!w(c))throw new TypeError(c+" is not iterable");return c}},{"./is-iterable":172}],175:[function(d,re,ne){re.exports=d("./is-implemented")()?d("ext/global-this").Symbol:d("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(d,re,ne){var w=d("ext/global-this"),c={object:!0,symbol:!0};re.exports=function(){var M=w.Symbol,T;if(typeof M!="function")return!1;T=M("test symbol");try{String(T)}catch{return!1}return!(!c[typeof M.iterator]||!c[typeof M.toPrimitive]||!c[typeof M.toStringTag])}},{"ext/global-this":188}],177:[function(d,re,ne){re.exports=function(w){return w?typeof w=="symbol"?!0:!w.constructor||w.constructor.name!=="Symbol"?!1:w[w.constructor.toStringTag]==="Symbol":!1}},{}],178:[function(d,re,ne){var w=d("d"),c=Object.create,M=Object.defineProperty,T=Object.prototype,e=c(null);re.exports=function(a){for(var n=0,r,t;e[a+(n||"")];)++n;return a+=n||"",e[a]=!0,r="@@"+a,M(T,r,w.gs(null,function(f){t||(t=!0,M(this,r,w(f)),t=!1)})),r}},{d:106}],179:[function(d,re,ne){var w=d("d"),c=d("ext/global-this").Symbol;re.exports=function(M){return Object.defineProperties(M,{hasInstance:w("",c&&c.hasInstance||M("hasInstance")),isConcatSpreadable:w("",c&&c.isConcatSpreadable||M("isConcatSpreadable")),iterator:w("",c&&c.iterator||M("iterator")),match:w("",c&&c.match||M("match")),replace:w("",c&&c.replace||M("replace")),search:w("",c&&c.search||M("search")),species:w("",c&&c.species||M("species")),split:w("",c&&c.split||M("split")),toPrimitive:w("",c&&c.toPrimitive||M("toPrimitive")),toStringTag:w("",c&&c.toStringTag||M("toStringTag")),unscopables:w("",c&&c.unscopables||M("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(d,re,ne){var w=d("d"),c=d("../../../validate-symbol"),M=Object.create(null);re.exports=function(T){return Object.defineProperties(T,{for:w(function(e){return M[e]?M[e]:M[e]=T(String(e))}),keyFor:w(function(e){var a;c(e);for(a in M)if(M[a]===e)return a})})}},{"../../../validate-symbol":182,d:106}],181:[function(d,re,ne){var w=d("d"),c=d("./validate-symbol"),M=d("ext/global-this").Symbol,T=d("./lib/private/generate-name"),e=d("./lib/private/setup/standard-symbols"),a=d("./lib/private/setup/symbol-registry"),n=Object.create,r=Object.defineProperties,t=Object.defineProperty,f,o,i;if(typeof M=="function")try{String(M()),i=!0}catch{}else M=null;o=function(p){if(this instanceof o)throw new TypeError("Symbol is not a constructor");return f(p)},re.exports=f=function g(p){var y;if(this instanceof g)throw new TypeError("Symbol is not a constructor");return i?M(p):(y=n(o.prototype),p=p===void 0?"":String(p),r(y,{__description__:w("",p),__name__:w("",T(p))}))},e(f),a(f),r(o.prototype,{constructor:w(f),toString:w("",function(){return this.__name__})}),r(f.prototype,{toString:w(function(){return"Symbol ("+c(this).__description__+")"}),valueOf:w(function(){return c(this)})}),t(f.prototype,f.toPrimitive,w("",function(){var g=c(this);return typeof g=="symbol"?g:g.toString()})),t(f.prototype,f.toStringTag,w("c","Symbol")),t(o.prototype,f.toStringTag,w("c",f.prototype[f.toStringTag])),t(o.prototype,f.toPrimitive,w("c",f.prototype[f.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(d,re,ne){var w=d("./is-symbol");re.exports=function(c){if(!w(c))throw new TypeError(c+" is not a symbol");return c}},{"./is-symbol":177}],183:[function(d,re,ne){re.exports=d("./is-implemented")()?WeakMap:d("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(d,re,ne){re.exports=function(){var w,c;if(typeof WeakMap!="function")return!1;try{w=new WeakMap([[c={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return!(String(w)!=="[object WeakMap]"||typeof w.set!="function"||w.set({},1)!==w||typeof w.delete!="function"||typeof w.has!="function"||w.get(c)!=="one")}},{}],185:[function(d,re,ne){re.exports=function(){return typeof WeakMap!="function"?!1:Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"}()},{}],186:[function(d,re,ne){var w=d("es5-ext/object/is-value"),c=d("es5-ext/object/set-prototype-of"),M=d("es5-ext/object/valid-object"),T=d("es5-ext/object/valid-value"),e=d("es5-ext/string/random-uniq"),a=d("d"),n=d("es6-iterator/get"),r=d("es6-iterator/for-of"),t=d("es6-symbol").toStringTag,f=d("./is-native-implemented"),o=Array.isArray,i=Object.defineProperty,g=Object.prototype.hasOwnProperty,p=Object.getPrototypeOf,y;re.exports=y=function(){var h=arguments[0],m;if(!(this instanceof y))throw new TypeError("Constructor requires 'new'");return m=f&&c&&WeakMap!==y?c(new WeakMap,p(this)):this,w(h)&&(o(h)||(h=n(h))),i(m,"__weakMapData__",a("c","$weakMap$"+e())),h&&r(h,function(u){T(u),m.set(u[0],u[1])}),m},f&&(c&&c(y,WeakMap),y.prototype=Object.create(WeakMap.prototype,{constructor:a(y)})),Object.defineProperties(y.prototype,{delete:a(function(h){return g.call(M(h),this.__weakMapData__)?(delete h[this.__weakMapData__],!0):!1}),get:a(function(h){if(!!g.call(M(h),this.__weakMapData__))return h[this.__weakMapData__]}),has:a(function(h){return g.call(M(h),this.__weakMapData__)}),set:a(function(h,m){return i(M(h),this.__weakMapData__,a("c",m)),this}),toString:a(function(){return"[object WeakMap]"})}),i(y.prototype,t,a("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(d,re,ne){var w=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};re.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return w()}try{return __global__||w()}finally{delete Object.prototype.__global__}}()},{}],188:[function(d,re,ne){re.exports=d("./is-implemented")()?globalThis:d("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(d,re,ne){re.exports=function(){return typeof globalThis!="object"||!globalThis?!1:globalThis.Array===Array}},{}],190:[function(d,re,ne){var w=d("is-string-blank");re.exports=function(c){var M=typeof c;if(M==="string"){var T=c;if(c=+c,c===0&&w(T))return!1}else if(M!=="number")return!1;return c-c<1}},{"is-string-blank":237}],191:[function(d,re,ne){var w=d("dtype");re.exports=c;function c(M,T,e){if(!M)throw new TypeError("must specify data as first parameter");if(e=+(e||0)|0,Array.isArray(M)&&M[0]&&typeof M[0][0]=="number"){var a=M[0].length,n=M.length*a,r,t,f,o;(!T||typeof T=="string")&&(T=new(w(T||"float32"))(n+e));var i=T.length-e;if(n!==i)throw new Error("source length "+n+" ("+a+"x"+M.length+") does not match destination length "+i);for(r=0,f=e;r<M.length;r++)for(t=0;t<a;t++)T[f++]=M[r][t]===null?NaN:M[r][t]}else if(!T||typeof T=="string"){var g=w(T||"float32");if(Array.isArray(M)||T==="array")for(T=new g(M.length+e),r=0,f=e,o=T.length;f<o;f++,r++)T[f]=M[r]===null?NaN:M[r];else e===0?T=new g(M):(T=new g(M.length+e),T.set(M,e))}else T.set(M,e);return T}},{dtype:127}],192:[function(d,re,ne){var w=d("css-font/stringify"),c=[32,126];re.exports=M;function M(T){T=T||{};var e=T.shape?T.shape:T.canvas?[T.canvas.width,T.canvas.height]:[512,512],a=T.canvas||document.createElement("canvas"),n=T.font,r=typeof T.step=="number"?[T.step,T.step]:T.step||[32,32],t=T.chars||c;if(n&&typeof n!="string"&&(n=w(n)),!Array.isArray(t))t=String(t).split("");else if(t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"){for(var f=[],o=t[0],i=0;o<=t[1];o++)f[i++]=String.fromCharCode(o);t=f}e=e.slice(),a.width=e[0],a.height=e[1];var g=a.getContext("2d");g.fillStyle="#000",g.fillRect(0,0,a.width,a.height),g.font=n,g.textAlign="center",g.textBaseline="middle",g.fillStyle="#fff";for(var p=r[0]/2,y=r[1]/2,o=0;o<t.length;o++)g.fillText(t[o],p,y),(p+=r[0])>e[0]-r[0]/2&&(p=r[0]/2,y+=r[1]);return a}},{"css-font/stringify":102}],193:[function(d,re,ne){re.exports=w,w.canvas=document.createElement("canvas"),w.cache={};function w(o,a){a||(a={}),(typeof o=="string"||Array.isArray(o))&&(a.family=o);var n=Array.isArray(a.family)?a.family.join(", "):a.family;if(!n)throw Error("`family` must be defined");var r=a.size||a.fontSize||a.em||48,t=a.weight||a.fontWeight||"",f=a.style||a.fontStyle||"",o=[f,t,r].join(" ")+"px "+n,i=a.origin||"top";if(w.cache[n]&&r<=w.cache[n].em)return c(w.cache[n],i);var g=a.canvas||w.canvas,p=g.getContext("2d"),y={upper:a.upper!==void 0?a.upper:"H",lower:a.lower!==void 0?a.lower:"x",descent:a.descent!==void 0?a.descent:"p",ascent:a.ascent!==void 0?a.ascent:"h",tittle:a.tittle!==void 0?a.tittle:"i",overshoot:a.overshoot!==void 0?a.overshoot:"O"},h=Math.ceil(r*1.5);g.height=h,g.width=h*.5,p.font=o;var m="H",u={top:0};p.clearRect(0,0,h,h),p.textBaseline="top",p.fillStyle="black",p.fillText(m,0,0);var _=M(p.getImageData(0,0,h,h));p.clearRect(0,0,h,h),p.textBaseline="bottom",p.fillText(m,0,h);var s=M(p.getImageData(0,0,h,h));u.lineHeight=u.bottom=h-s+_,p.clearRect(0,0,h,h),p.textBaseline="alphabetic",p.fillText(m,0,h);var A=M(p.getImageData(0,0,h,h)),x=h-A-1+_;u.baseline=u.alphabetic=x,p.clearRect(0,0,h,h),p.textBaseline="middle",p.fillText(m,0,h*.5);var v=M(p.getImageData(0,0,h,h));u.median=u.middle=h-v-1+_-h*.5,p.clearRect(0,0,h,h),p.textBaseline="hanging",p.fillText(m,0,h*.5);var b=M(p.getImageData(0,0,h,h));u.hanging=h-b-1+_-h*.5,p.clearRect(0,0,h,h),p.textBaseline="ideographic",p.fillText(m,0,h);var l=M(p.getImageData(0,0,h,h));if(u.ideographic=h-l-1+_,y.upper&&(p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(y.upper,0,0),u.upper=M(p.getImageData(0,0,h,h)),u.capHeight=u.baseline-u.upper),y.lower&&(p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(y.lower,0,0),u.lower=M(p.getImageData(0,0,h,h)),u.xHeight=u.baseline-u.lower),y.tittle&&(p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(y.tittle,0,0),u.tittle=M(p.getImageData(0,0,h,h))),y.ascent&&(p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(y.ascent,0,0),u.ascent=M(p.getImageData(0,0,h,h))),y.descent&&(p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(y.descent,0,0),u.descent=T(p.getImageData(0,0,h,h))),y.overshoot){p.clearRect(0,0,h,h),p.textBaseline="top",p.fillText(y.overshoot,0,0);var L=T(p.getImageData(0,0,h,h));u.overshoot=L-x}for(var S in u)u[S]/=r;return u.em=r,w.cache[n]=u,c(u,i)}function c(e,a){var n={};typeof a=="string"&&(a=e[a]);for(var r in e)r!=="em"&&(n[r]=e[r]-a);return n}function M(e){for(var a=e.height,n=e.data,r=3;r<n.length;r+=4)if(n[r]!==0)return Math.floor((r-3)*.25/a)}function T(e){for(var a=e.height,n=e.data,r=n.length-1;r>0;r-=4)if(n[r]!==0)return Math.floor((r-3)*.25/a)}},{}],194:[function(d,re,ne){re.exports=w;function w(c,M){if(typeof c!="string")throw new TypeError("must specify type string");if(M=M||{},typeof document=="undefined"&&!M.canvas)return null;var T=M.canvas||document.createElement("canvas");typeof M.width=="number"&&(T.width=M.width),typeof M.height=="number"&&(T.height=M.height);var e=M,a;try{var n=[c];c.indexOf("webgl")===0&&n.push("experimental-"+c);for(var r=0;r<n.length;r++)if(a=T.getContext(n[r],e),a)return a}catch{a=null}return a||null}},{}],195:[function(d,re,ne){re.exports=w;function w(c,M){var T=M[0],e=M[1],a=M[2],n=M[3],r=M[4],t=M[5],f=M[6],o=M[7],i=M[8],g=M[9],p=M[10],y=M[11],h=M[12],m=M[13],u=M[14],_=M[15];return c[0]=t*(p*_-y*u)-g*(f*_-o*u)+m*(f*y-o*p),c[1]=-(e*(p*_-y*u)-g*(a*_-n*u)+m*(a*y-n*p)),c[2]=e*(f*_-o*u)-t*(a*_-n*u)+m*(a*o-n*f),c[3]=-(e*(f*y-o*p)-t*(a*y-n*p)+g*(a*o-n*f)),c[4]=-(r*(p*_-y*u)-i*(f*_-o*u)+h*(f*y-o*p)),c[5]=T*(p*_-y*u)-i*(a*_-n*u)+h*(a*y-n*p),c[6]=-(T*(f*_-o*u)-r*(a*_-n*u)+h*(a*o-n*f)),c[7]=T*(f*y-o*p)-r*(a*y-n*p)+i*(a*o-n*f),c[8]=r*(g*_-y*m)-i*(t*_-o*m)+h*(t*y-o*g),c[9]=-(T*(g*_-y*m)-i*(e*_-n*m)+h*(e*y-n*g)),c[10]=T*(t*_-o*m)-r*(e*_-n*m)+h*(e*o-n*t),c[11]=-(T*(t*y-o*g)-r*(e*y-n*g)+i*(e*o-n*t)),c[12]=-(r*(g*u-p*m)-i*(t*u-f*m)+h*(t*p-f*g)),c[13]=T*(g*u-p*m)-i*(e*u-a*m)+h*(e*p-a*g),c[14]=-(T*(t*u-f*m)-r*(e*u-a*m)+h*(e*f-a*t)),c[15]=T*(t*p-f*g)-r*(e*p-a*g)+i*(e*f-a*t),c}},{}],196:[function(d,re,ne){re.exports=w;function w(c){var M=new Float32Array(16);return M[0]=c[0],M[1]=c[1],M[2]=c[2],M[3]=c[3],M[4]=c[4],M[5]=c[5],M[6]=c[6],M[7]=c[7],M[8]=c[8],M[9]=c[9],M[10]=c[10],M[11]=c[11],M[12]=c[12],M[13]=c[13],M[14]=c[14],M[15]=c[15],M}},{}],197:[function(d,re,ne){re.exports=w;function w(c,M){return c[0]=M[0],c[1]=M[1],c[2]=M[2],c[3]=M[3],c[4]=M[4],c[5]=M[5],c[6]=M[6],c[7]=M[7],c[8]=M[8],c[9]=M[9],c[10]=M[10],c[11]=M[11],c[12]=M[12],c[13]=M[13],c[14]=M[14],c[15]=M[15],c}},{}],198:[function(d,re,ne){re.exports=w;function w(){var c=new Float32Array(16);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}},{}],199:[function(d,re,ne){re.exports=w;function w(c){var M=c[0],T=c[1],e=c[2],a=c[3],n=c[4],r=c[5],t=c[6],f=c[7],o=c[8],i=c[9],g=c[10],p=c[11],y=c[12],h=c[13],m=c[14],u=c[15],_=M*r-T*n,s=M*t-e*n,A=M*f-a*n,x=T*t-e*r,v=T*f-a*r,b=e*f-a*t,l=o*h-i*y,L=o*m-g*y,S=o*u-p*y,k=i*m-g*h,P=i*u-p*h,z=g*u-p*m;return _*z-s*P+A*k+x*S-v*L+b*l}},{}],200:[function(d,re,ne){re.exports=w;function w(c,M){var T=M[0],e=M[1],a=M[2],n=M[3],r=T+T,t=e+e,f=a+a,o=T*r,i=e*r,g=e*t,p=a*r,y=a*t,h=a*f,m=n*r,u=n*t,_=n*f;return c[0]=1-g-h,c[1]=i+_,c[2]=p-u,c[3]=0,c[4]=i-_,c[5]=1-o-h,c[6]=y+m,c[7]=0,c[8]=p+u,c[9]=y-m,c[10]=1-o-g,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}},{}],201:[function(d,re,ne){re.exports=w;function w(c,M,T){var e,a,n,r=T[0],t=T[1],f=T[2],o=Math.sqrt(r*r+t*t+f*f);return Math.abs(o)<1e-6?null:(o=1/o,r*=o,t*=o,f*=o,e=Math.sin(M),a=Math.cos(M),n=1-a,c[0]=r*r*n+a,c[1]=t*r*n+f*e,c[2]=f*r*n-t*e,c[3]=0,c[4]=r*t*n-f*e,c[5]=t*t*n+a,c[6]=f*t*n+r*e,c[7]=0,c[8]=r*f*n+t*e,c[9]=t*f*n-r*e,c[10]=f*f*n+a,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}},{}],202:[function(d,re,ne){re.exports=w;function w(c,M,T){var e=M[0],a=M[1],n=M[2],r=M[3],t=e+e,f=a+a,o=n+n,i=e*t,g=e*f,p=e*o,y=a*f,h=a*o,m=n*o,u=r*t,_=r*f,s=r*o;return c[0]=1-(y+m),c[1]=g+s,c[2]=p-_,c[3]=0,c[4]=g-s,c[5]=1-(i+m),c[6]=h+u,c[7]=0,c[8]=p+_,c[9]=h-u,c[10]=1-(i+y),c[11]=0,c[12]=T[0],c[13]=T[1],c[14]=T[2],c[15]=1,c}},{}],203:[function(d,re,ne){re.exports=w;function w(c,M){return c[0]=M[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=M[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=M[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}},{}],204:[function(d,re,ne){re.exports=w;function w(c,M){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=M[0],c[13]=M[1],c[14]=M[2],c[15]=1,c}},{}],205:[function(d,re,ne){re.exports=w;function w(c,M){var T=Math.sin(M),e=Math.cos(M);return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=e,c[6]=T,c[7]=0,c[8]=0,c[9]=-T,c[10]=e,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}},{}],206:[function(d,re,ne){re.exports=w;function w(c,M){var T=Math.sin(M),e=Math.cos(M);return c[0]=e,c[1]=0,c[2]=-T,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=T,c[9]=0,c[10]=e,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}},{}],207:[function(d,re,ne){re.exports=w;function w(c,M){var T=Math.sin(M),e=Math.cos(M);return c[0]=e,c[1]=T,c[2]=0,c[3]=0,c[4]=-T,c[5]=e,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}},{}],208:[function(d,re,ne){re.exports=w;function w(c,M,T,e,a,n,r){var t=1/(T-M),f=1/(a-e),o=1/(n-r);return c[0]=n*2*t,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=n*2*f,c[6]=0,c[7]=0,c[8]=(T+M)*t,c[9]=(a+e)*f,c[10]=(r+n)*o,c[11]=-1,c[12]=0,c[13]=0,c[14]=r*n*2*o,c[15]=0,c}},{}],209:[function(d,re,ne){re.exports=w;function w(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}},{}],210:[function(d,re,ne){re.exports={create:d("./create"),clone:d("./clone"),copy:d("./copy"),identity:d("./identity"),transpose:d("./transpose"),invert:d("./invert"),adjoint:d("./adjoint"),determinant:d("./determinant"),multiply:d("./multiply"),translate:d("./translate"),scale:d("./scale"),rotate:d("./rotate"),rotateX:d("./rotateX"),rotateY:d("./rotateY"),rotateZ:d("./rotateZ"),fromRotation:d("./fromRotation"),fromRotationTranslation:d("./fromRotationTranslation"),fromScaling:d("./fromScaling"),fromTranslation:d("./fromTranslation"),fromXRotation:d("./fromXRotation"),fromYRotation:d("./fromYRotation"),fromZRotation:d("./fromZRotation"),fromQuat:d("./fromQuat"),frustum:d("./frustum"),perspective:d("./perspective"),perspectiveFromFieldOfView:d("./perspectiveFromFieldOfView"),ortho:d("./ortho"),lookAt:d("./lookAt"),str:d("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(d,re,ne){re.exports=w;function w(c,M){var T=M[0],e=M[1],a=M[2],n=M[3],r=M[4],t=M[5],f=M[6],o=M[7],i=M[8],g=M[9],p=M[10],y=M[11],h=M[12],m=M[13],u=M[14],_=M[15],s=T*t-e*r,A=T*f-a*r,x=T*o-n*r,v=e*f-a*t,b=e*o-n*t,l=a*o-n*f,L=i*m-g*h,S=i*u-p*h,k=i*_-y*h,P=g*u-p*m,z=g*_-y*m,I=p*_-y*u,D=s*I-A*z+x*P+v*k-b*S+l*L;return D?(D=1/D,c[0]=(t*I-f*z+o*P)*D,c[1]=(a*z-e*I-n*P)*D,c[2]=(m*l-u*b+_*v)*D,c[3]=(p*b-g*l-y*v)*D,c[4]=(f*k-r*I-o*S)*D,c[5]=(T*I-a*k+n*S)*D,c[6]=(u*x-h*l-_*A)*D,c[7]=(i*l-p*x+y*A)*D,c[8]=(r*z-t*k+o*L)*D,c[9]=(e*k-T*z-n*L)*D,c[10]=(h*b-m*x+_*s)*D,c[11]=(g*x-i*b-y*s)*D,c[12]=(t*S-r*P-f*L)*D,c[13]=(T*P-e*S+a*L)*D,c[14]=(m*A-h*v-u*s)*D,c[15]=(i*v-g*A+p*s)*D,c):null}},{}],212:[function(d,re,ne){var w=d("./identity");re.exports=c;function c(M,T,e,a){var n,r,t,f,o,i,g,p,y,h,m=T[0],u=T[1],_=T[2],s=a[0],A=a[1],x=a[2],v=e[0],b=e[1],l=e[2];return Math.abs(m-v)<1e-6&&Math.abs(u-b)<1e-6&&Math.abs(_-l)<1e-6?w(M):(g=m-v,p=u-b,y=_-l,h=1/Math.sqrt(g*g+p*p+y*y),g*=h,p*=h,y*=h,n=A*y-x*p,r=x*g-s*y,t=s*p-A*g,h=Math.sqrt(n*n+r*r+t*t),h?(h=1/h,n*=h,r*=h,t*=h):(n=0,r=0,t=0),f=p*t-y*r,o=y*n-g*t,i=g*r-p*n,h=Math.sqrt(f*f+o*o+i*i),h?(h=1/h,f*=h,o*=h,i*=h):(f=0,o=0,i=0),M[0]=n,M[1]=f,M[2]=g,M[3]=0,M[4]=r,M[5]=o,M[6]=p,M[7]=0,M[8]=t,M[9]=i,M[10]=y,M[11]=0,M[12]=-(n*m+r*u+t*_),M[13]=-(f*m+o*u+i*_),M[14]=-(g*m+p*u+y*_),M[15]=1,M)}},{"./identity":209}],213:[function(d,re,ne){re.exports=w;function w(c,M,T){var e=M[0],a=M[1],n=M[2],r=M[3],t=M[4],f=M[5],o=M[6],i=M[7],g=M[8],p=M[9],y=M[10],h=M[11],m=M[12],u=M[13],_=M[14],s=M[15],A=T[0],x=T[1],v=T[2],b=T[3];return c[0]=A*e+x*t+v*g+b*m,c[1]=A*a+x*f+v*p+b*u,c[2]=A*n+x*o+v*y+b*_,c[3]=A*r+x*i+v*h+b*s,A=T[4],x=T[5],v=T[6],b=T[7],c[4]=A*e+x*t+v*g+b*m,c[5]=A*a+x*f+v*p+b*u,c[6]=A*n+x*o+v*y+b*_,c[7]=A*r+x*i+v*h+b*s,A=T[8],x=T[9],v=T[10],b=T[11],c[8]=A*e+x*t+v*g+b*m,c[9]=A*a+x*f+v*p+b*u,c[10]=A*n+x*o+v*y+b*_,c[11]=A*r+x*i+v*h+b*s,A=T[12],x=T[13],v=T[14],b=T[15],c[12]=A*e+x*t+v*g+b*m,c[13]=A*a+x*f+v*p+b*u,c[14]=A*n+x*o+v*y+b*_,c[15]=A*r+x*i+v*h+b*s,c}},{}],214:[function(d,re,ne){re.exports=w;function w(c,M,T,e,a,n,r){var t=1/(M-T),f=1/(e-a),o=1/(n-r);return c[0]=-2*t,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*f,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*o,c[11]=0,c[12]=(M+T)*t,c[13]=(a+e)*f,c[14]=(r+n)*o,c[15]=1,c}},{}],215:[function(d,re,ne){re.exports=w;function w(c,M,T,e,a){var n=1/Math.tan(M/2),r=1/(e-a);return c[0]=n/T,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=n,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=(a+e)*r,c[11]=-1,c[12]=0,c[13]=0,c[14]=2*a*e*r,c[15]=0,c}},{}],216:[function(d,re,ne){re.exports=w;function w(c,M,T,e){var a=Math.tan(M.upDegrees*Math.PI/180),n=Math.tan(M.downDegrees*Math.PI/180),r=Math.tan(M.leftDegrees*Math.PI/180),t=Math.tan(M.rightDegrees*Math.PI/180),f=2/(r+t),o=2/(a+n);return c[0]=f,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=o,c[6]=0,c[7]=0,c[8]=-((r-t)*f*.5),c[9]=(a-n)*o*.5,c[10]=e/(T-e),c[11]=-1,c[12]=0,c[13]=0,c[14]=e*T/(T-e),c[15]=0,c}},{}],217:[function(d,re,ne){re.exports=w;function w(c,M,T,e){var a=e[0],n=e[1],r=e[2],t=Math.sqrt(a*a+n*n+r*r),f,o,i,g,p,y,h,m,u,_,s,A,x,v,b,l,L,S,k,P,z,I,D,R;return Math.abs(t)<1e-6?null:(t=1/t,a*=t,n*=t,r*=t,f=Math.sin(T),o=Math.cos(T),i=1-o,g=M[0],p=M[1],y=M[2],h=M[3],m=M[4],u=M[5],_=M[6],s=M[7],A=M[8],x=M[9],v=M[10],b=M[11],l=a*a*i+o,L=n*a*i+r*f,S=r*a*i-n*f,k=a*n*i-r*f,P=n*n*i+o,z=r*n*i+a*f,I=a*r*i+n*f,D=n*r*i-a*f,R=r*r*i+o,c[0]=g*l+m*L+A*S,c[1]=p*l+u*L+x*S,c[2]=y*l+_*L+v*S,c[3]=h*l+s*L+b*S,c[4]=g*k+m*P+A*z,c[5]=p*k+u*P+x*z,c[6]=y*k+_*P+v*z,c[7]=h*k+s*P+b*z,c[8]=g*I+m*D+A*R,c[9]=p*I+u*D+x*R,c[10]=y*I+_*D+v*R,c[11]=h*I+s*D+b*R,M!==c&&(c[12]=M[12],c[13]=M[13],c[14]=M[14],c[15]=M[15]),c)}},{}],218:[function(d,re,ne){re.exports=w;function w(c,M,T){var e=Math.sin(T),a=Math.cos(T),n=M[4],r=M[5],t=M[6],f=M[7],o=M[8],i=M[9],g=M[10],p=M[11];return M!==c&&(c[0]=M[0],c[1]=M[1],c[2]=M[2],c[3]=M[3],c[12]=M[12],c[13]=M[13],c[14]=M[14],c[15]=M[15]),c[4]=n*a+o*e,c[5]=r*a+i*e,c[6]=t*a+g*e,c[7]=f*a+p*e,c[8]=o*a-n*e,c[9]=i*a-r*e,c[10]=g*a-t*e,c[11]=p*a-f*e,c}},{}],219:[function(d,re,ne){re.exports=w;function w(c,M,T){var e=Math.sin(T),a=Math.cos(T),n=M[0],r=M[1],t=M[2],f=M[3],o=M[8],i=M[9],g=M[10],p=M[11];return M!==c&&(c[4]=M[4],c[5]=M[5],c[6]=M[6],c[7]=M[7],c[12]=M[12],c[13]=M[13],c[14]=M[14],c[15]=M[15]),c[0]=n*a-o*e,c[1]=r*a-i*e,c[2]=t*a-g*e,c[3]=f*a-p*e,c[8]=n*e+o*a,c[9]=r*e+i*a,c[10]=t*e+g*a,c[11]=f*e+p*a,c}},{}],220:[function(d,re,ne){re.exports=w;function w(c,M,T){var e=Math.sin(T),a=Math.cos(T),n=M[0],r=M[1],t=M[2],f=M[3],o=M[4],i=M[5],g=M[6],p=M[7];return M!==c&&(c[8]=M[8],c[9]=M[9],c[10]=M[10],c[11]=M[11],c[12]=M[12],c[13]=M[13],c[14]=M[14],c[15]=M[15]),c[0]=n*a+o*e,c[1]=r*a+i*e,c[2]=t*a+g*e,c[3]=f*a+p*e,c[4]=o*a-n*e,c[5]=i*a-r*e,c[6]=g*a-t*e,c[7]=p*a-f*e,c}},{}],221:[function(d,re,ne){re.exports=w;function w(c,M,T){var e=T[0],a=T[1],n=T[2];return c[0]=M[0]*e,c[1]=M[1]*e,c[2]=M[2]*e,c[3]=M[3]*e,c[4]=M[4]*a,c[5]=M[5]*a,c[6]=M[6]*a,c[7]=M[7]*a,c[8]=M[8]*n,c[9]=M[9]*n,c[10]=M[10]*n,c[11]=M[11]*n,c[12]=M[12],c[13]=M[13],c[14]=M[14],c[15]=M[15],c}},{}],222:[function(d,re,ne){re.exports=w;function w(c){return"mat4("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+", "+c[9]+", "+c[10]+", "+c[11]+", "+c[12]+", "+c[13]+", "+c[14]+", "+c[15]+")"}},{}],223:[function(d,re,ne){re.exports=w;function w(c,M,T){var e=T[0],a=T[1],n=T[2],r,t,f,o,i,g,p,y,h,m,u,_;return M===c?(c[12]=M[0]*e+M[4]*a+M[8]*n+M[12],c[13]=M[1]*e+M[5]*a+M[9]*n+M[13],c[14]=M[2]*e+M[6]*a+M[10]*n+M[14],c[15]=M[3]*e+M[7]*a+M[11]*n+M[15]):(r=M[0],t=M[1],f=M[2],o=M[3],i=M[4],g=M[5],p=M[6],y=M[7],h=M[8],m=M[9],u=M[10],_=M[11],c[0]=r,c[1]=t,c[2]=f,c[3]=o,c[4]=i,c[5]=g,c[6]=p,c[7]=y,c[8]=h,c[9]=m,c[10]=u,c[11]=_,c[12]=r*e+i*a+h*n+M[12],c[13]=t*e+g*a+m*n+M[13],c[14]=f*e+p*a+u*n+M[14],c[15]=o*e+y*a+_*n+M[15]),c}},{}],224:[function(d,re,ne){re.exports=w;function w(c,M){if(c===M){var T=M[1],e=M[2],a=M[3],n=M[6],r=M[7],t=M[11];c[1]=M[4],c[2]=M[8],c[3]=M[12],c[4]=T,c[6]=M[9],c[7]=M[13],c[8]=e,c[9]=n,c[11]=M[14],c[12]=a,c[13]=r,c[14]=t}else c[0]=M[0],c[1]=M[4],c[2]=M[8],c[3]=M[12],c[4]=M[1],c[5]=M[5],c[6]=M[9],c[7]=M[13],c[8]=M[2],c[9]=M[6],c[10]=M[10],c[11]=M[14],c[12]=M[3],c[13]=M[7],c[14]=M[11],c[15]=M[15];return c}},{}],225:[function(d,re,ne){var w=d("css-font"),c=d("pick-by-alias"),M=d("regl"),T=d("gl-util/context"),e=d("es6-weak-map"),a=d("color-normalize"),n=d("font-atlas"),r=d("typedarray-pool"),t=d("parse-rect"),f=d("is-plain-obj"),o=d("parse-unit"),i=d("to-px"),g=d("detect-kerning"),p=d("object-assign"),y=d("font-measure"),h=d("flatten-vertex-data"),m=d("bit-twiddle"),u=m.nextPow2,_=new e,s=!1;if(document.body){var A=document.body.appendChild(document.createElement("div"));A.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(A).fontStretch&&(s=!0),document.body.removeChild(A)}var x=function(l){v(l)?(l={regl:l},this.gl=l.regl._gl):this.gl=T(l),this.shader=_.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=l.regl||M({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),_.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(f(l)?l:{})};x.prototype.createShader=function(){var l=this.regl,L=l({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:l.prop("count"),offset:l.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:l.this("sizeBuffer")},width:{offset:0,stride:8,buffer:l.this("sizeBuffer")},char:l.this("charBuffer"),position:l.this("position")},uniforms:{atlasSize:function(k,P){return[P.atlas.width,P.atlas.height]},atlasDim:function(k,P){return[P.atlas.cols,P.atlas.rows]},atlas:function(k,P){return P.atlas.texture},charStep:function(k,P){return P.atlas.step},em:function(k,P){return P.atlas.em},color:l.prop("color"),opacity:l.prop("opacity"),viewport:l.this("viewportArray"),scale:l.this("scale"),align:l.prop("align"),baseline:l.prop("baseline"),translate:l.this("translate"),positionOffset:l.prop("positionOffset")},primitive:"points",viewport:l.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`}),S={};return{regl:l,draw:L,atlas:S}},x.prototype.update=function(l){var L=this;if(typeof l=="string")l={text:l};else if(!l)return;l=c(l,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0),l.opacity!=null&&(Array.isArray(l.opacity)?this.opacity=l.opacity.map(function(xe){return parseFloat(xe)}):this.opacity=parseFloat(l.opacity)),l.viewport!=null&&(this.viewport=t(l.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),l.kerning!=null&&(this.kerning=l.kerning),l.offset!=null&&(typeof l.offset=="number"&&(l.offset=[l.offset,0]),this.positionOffset=h(l.offset)),l.direction&&(this.direction=l.direction),l.range&&(this.range=l.range,this.scale=[1/(l.range[2]-l.range[0]),1/(l.range[3]-l.range[1])],this.translate=[-l.range[0],-l.range[1]]),l.scale&&(this.scale=l.scale),l.translate&&(this.translate=l.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),!this.font.length&&!l.font&&(l.font=x.baseFontSize+"px sans-serif");var S=!1,k=!1;if(l.font&&(Array.isArray(l.font)?l.font:[l.font]).forEach(function(xe,Le){if(typeof xe=="string")try{xe=w.parse(xe)}catch{xe=w.parse(x.baseFontSize+"px "+xe)}else xe=w.parse(w.stringify(xe));var He=w.stringify({size:x.baseFontSize,family:xe.family,stretch:s?xe.stretch:void 0,variant:xe.variant,weight:xe.weight,style:xe.style}),Je=o(xe.size),Oe=Math.round(Je[0]*i(Je[1]));if(Oe!==L.fontSize[Le]&&(k=!0,L.fontSize[Le]=Oe),(!L.font[Le]||He!=L.font[Le].baseString)&&(S=!0,L.font[Le]=x.fonts[He],!L.font[Le])){var Pe=xe.family.join(", "),Ue=[xe.style];xe.style!=xe.variant&&Ue.push(xe.variant),xe.variant!=xe.weight&&Ue.push(xe.weight),s&&xe.weight!=xe.stretch&&Ue.push(xe.stretch),L.font[Le]={baseString:He,family:Pe,weight:xe.weight,stretch:xe.stretch,style:xe.style,variant:xe.variant,width:{},kerning:{},metrics:y(Pe,{origin:"top",fontSize:x.baseFontSize,fontStyle:Ue.join(" ")})},x.fonts[He]=L.font[Le]}}),(S||k)&&this.font.forEach(function(xe,Le){var He=w.stringify({size:L.fontSize[Le],family:xe.family,stretch:s?xe.stretch:void 0,variant:xe.variant,weight:xe.weight,style:xe.style});if(L.fontAtlas[Le]=L.shader.atlas[He],!L.fontAtlas[Le]){var Je=xe.metrics;L.shader.atlas[He]=L.fontAtlas[Le]={fontString:He,step:Math.ceil(L.fontSize[Le]*Je.bottom*.5)*2,em:L.fontSize[Le],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:L.regl.texture()}}l.text==null&&(l.text=L.text)}),typeof l.text=="string"&&l.position&&l.position.length>2){for(var P=Array(l.position.length*.5),z=0;z<P.length;z++)P[z]=l.text;l.text=P}var I;if(l.text!=null||S){if(this.textOffsets=[0],Array.isArray(l.text)){this.count=l.text[0].length,this.counts=[this.count];for(var D=1;D<l.text.length;D++)this.textOffsets[D]=this.textOffsets[D-1]+l.text[D-1].length,this.count+=l.text[D].length,this.counts.push(l.text[D].length);this.text=l.text.join("")}else this.text=l.text,this.count=this.text.length,this.counts=[this.count];I=[],this.font.forEach(function(xe,Le){x.atlasContext.font=xe.baseString;for(var He=L.fontAtlas[Le],Je=0;Je<L.text.length;Je++){var Oe=L.text.charAt(Je);if(He.ids[Oe]==null&&(He.ids[Oe]=He.chars.length,He.chars.push(Oe),I.push(Oe)),xe.width[Oe]==null&&(xe.width[Oe]=x.atlasContext.measureText(Oe).width/x.baseFontSize,L.kerning)){var Pe=[];for(var Ue in xe.width)Pe.push(Ue+Oe,Oe+Ue);p(xe.kerning,g(xe.family,{pairs:Pe}))}}})}if(l.position)if(l.position.length>2){for(var R=!l.position[0].length,B=r.mallocFloat(this.count*2),F=0,V=0;F<this.counts.length;F++){var G=this.counts[F];if(R)for(var J=0;J<G;J++)B[V++]=l.position[F*2],B[V++]=l.position[F*2+1];else for(var j=0;j<G;j++)B[V++]=l.position[F][0],B[V++]=l.position[F][1]}this.position.call?this.position({type:"float",data:B}):this.position=this.regl.buffer({type:"float",data:B}),r.freeFloat(B)}else this.position.destroy&&this.position.destroy(),this.position={constant:l.position};if(l.text||S){var Y=r.mallocUint8(this.count),X=r.mallocFloat(this.count*2);this.textWidth=[];for(var oe=0,se=0;oe<this.counts.length;oe++){for(var ie=this.counts[oe],N=this.font[oe]||this.font[0],U=this.fontAtlas[oe]||this.fontAtlas[0],q=0;q<ie;q++){var Q=this.text.charAt(se),W=this.text.charAt(se-1);if(Y[se]=U.ids[Q],X[se*2]=N.width[Q],q){var Z=X[se*2-2],ee=X[se*2],te=X[se*2-1],ae=te+Z*.5+ee*.5;if(this.kerning){var le=N.kerning[W+Q];le&&(ae+=le*.001)}X[se*2+1]=ae}else X[se*2+1]=X[se*2]*.5;se++}this.textWidth.push(X.length?X[se*2-2]*.5+X[se*2-1]:0)}l.align||(l.align=this.align),this.charBuffer({data:Y,type:"uint8",usage:"stream"}),this.sizeBuffer({data:X,type:"float",usage:"stream"}),r.freeUint8(Y),r.freeFloat(X),I.length&&this.font.forEach(function(xe,Le){var He=L.fontAtlas[Le],Je=He.step,Oe=Math.floor(x.maxAtlasSize/Je),Pe=Math.min(Oe,He.chars.length),Ue=Math.ceil(He.chars.length/Pe),vt=u(Pe*Je),Lt=u(Ue*Je);He.width=vt,He.height=Lt,He.rows=Ue,He.cols=Pe,He.em&&He.texture({data:n({canvas:x.atlasCanvas,font:He.fontString,chars:He.chars,shape:[vt,Lt],step:[Je,Je]})})})}if(l.align&&(this.align=l.align,this.alignOffset=this.textWidth.map(function(xe,Le){var He=Array.isArray(L.align)?L.align.length>1?L.align[Le]:L.align[0]:L.align;if(typeof He=="number")return He;switch(He){case"right":case"end":return-xe;case"center":case"centre":case"middle":return-xe*.5}return 0})),this.baseline==null&&l.baseline==null&&(l.baseline=0),l.baseline!=null&&(this.baseline=l.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(xe,Le){var He=(L.font[Le]||L.font[0]).metrics,Je=0;return Je+=He.bottom*.5,typeof xe=="number"?Je+=xe-He.baseline:Je+=-He[xe],Je*=-1,Je})),l.color!=null)if(l.color||(l.color="transparent"),typeof l.color=="string"||!isNaN(l.color))this.color=a(l.color,"uint8");else{var ye;if(typeof l.color[0]=="number"&&l.color.length>this.counts.length){var fe=l.color.length;ye=r.mallocUint8(fe);for(var pe=(l.color.subarray||l.color.slice).bind(l.color),ge=0;ge<fe;ge+=4)ye.set(a(pe(ge,ge+4),"uint8"),ge)}else{var Ae=l.color.length;ye=r.mallocUint8(Ae*4);for(var we=0;we<Ae;we++)ye.set(a(l.color[we]||0,"uint8"),we*4)}this.color=ye}if(l.position||l.text||l.color||l.baseline||l.align||l.font||l.offset||l.opacity){var De=this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2;if(De){var Be=Math.max(this.position.length*.5||0,this.color.length*.25||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,this.positionOffset.length*.5||0);this.batch=Array(Be);for(var Ve=0;Ve<this.batch.length;Ve++)this.batch[Ve]={count:this.counts.length>1?this.counts[Ve]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[Ve]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(Ve*4,Ve*4+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[Ve]:this.opacity,baseline:this.baselineOffset[Ve]!=null?this.baselineOffset[Ve]:this.baselineOffset[0],align:this.align?this.alignOffset[Ve]!=null?this.alignOffset[Ve]:this.alignOffset[0]:0,atlas:this.fontAtlas[Ve]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(Ve*2,Ve*2+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]}},x.prototype.destroy=function(){},x.prototype.kerning=!0,x.prototype.position={constant:new Float32Array(2)},x.prototype.translate=null,x.prototype.scale=null,x.prototype.font=null,x.prototype.text="",x.prototype.positionOffset=[0,0],x.prototype.opacity=1,x.prototype.color=new Uint8Array([0,0,0,255]),x.prototype.alignOffset=[0,0],x.maxAtlasSize=1024,x.atlasCanvas=document.createElement("canvas"),x.atlasContext=x.atlasCanvas.getContext("2d",{alpha:!1}),x.baseFontSize=64,x.fonts={};function v(b){return typeof b=="function"&&b._gl&&b.prop&&b.texture&&b.buffer}re.exports=x},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:283,"to-px":314,"typedarray-pool":327}],226:[function(d,re,ne){(function(w){(function(){var c=d("pick-by-alias");re.exports=function(t){if(t?typeof t=="string"&&(t={container:t}):t={},T(t)?t={container:t}:e(t)?t={container:t}:a(t)?t={gl:t}:t=c(t,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),t.pixelRatio||(t.pixelRatio=w.pixelRatio||1),t.gl)return t.gl;if(t.canvas&&(t.container=t.canvas.parentNode),t.container){if(typeof t.container=="string"){var f=document.querySelector(t.container);if(!f)throw Error("Element "+t.container+" is not found");t.container=f}T(t.container)?(t.canvas=t.container,t.container=t.canvas.parentNode):t.canvas||(t.canvas=n(),t.container.appendChild(t.canvas),M(t))}else if(!t.canvas)if(typeof document!="undefined")t.container=document.body||document.documentElement,t.canvas=n(),t.container.appendChild(t.canvas),M(t);else throw Error("Not DOM environment. Use headless-gl.");return t.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(o){try{t.gl=t.canvas.getContext(o,t.attrs)}catch{}return t.gl}),t.gl};function M(r){if(r.container)if(r.container==document.body)document.body.style.width||(r.canvas.width=r.width||r.pixelRatio*w.innerWidth),document.body.style.height||(r.canvas.height=r.height||r.pixelRatio*w.innerHeight);else{var t=r.container.getBoundingClientRect();r.canvas.width=r.width||t.right-t.left,r.canvas.height=r.height||t.bottom-t.top}}function T(r){return typeof r.getContext=="function"&&"width"in r&&"height"in r}function e(r){return typeof r.nodeName=="string"&&typeof r.appendChild=="function"&&typeof r.getBoundingClientRect=="function"}function a(r){return typeof r.drawArrays=="function"||typeof r.drawElements=="function"}function n(){var r=document.createElement("canvas");return r.style.position="absolute",r.style.top=0,r.style.left=0,r}}).call(this)}).call(this,typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"pick-by-alias":253}],227:[function(d,re,ne){re.exports=function(w){typeof w=="string"&&(w=[w]);for(var c=[].slice.call(arguments,1),M=[],T=0;T<w.length-1;T++)M.push(w[T],c[T]||"");return M.push(w[T]),M.join("")}},{}],228:[function(d,re,ne){(function(w){(function(){var c=d("is-browser"),M;typeof w.matchMedia=="function"?M=!w.matchMedia("(hover: none)").matches:M=c,re.exports=M}).call(this)}).call(this,typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"is-browser":232}],229:[function(d,re,ne){var w=d("is-browser");function c(){var M=!1;try{var T=Object.defineProperty({},"passive",{get:function(){M=!0}});window.addEventListener("test",null,T),window.removeEventListener("test",null,T)}catch{M=!1}return M}re.exports=w&&c()},{"is-browser":232}],230:[function(d,re,ne){ne.read=function(w,c,M,T,e){var a,n,r=e*8-T-1,t=(1<<r)-1,f=t>>1,o=-7,i=M?e-1:0,g=M?-1:1,p=w[c+i];for(i+=g,a=p&(1<<-o)-1,p>>=-o,o+=r;o>0;a=a*256+w[c+i],i+=g,o-=8);for(n=a&(1<<-o)-1,a>>=-o,o+=T;o>0;n=n*256+w[c+i],i+=g,o-=8);if(a===0)a=1-f;else{if(a===t)return n?NaN:(p?-1:1)*(1/0);n=n+Math.pow(2,T),a=a-f}return(p?-1:1)*n*Math.pow(2,a-T)},ne.write=function(w,c,M,T,e,a){var n,r,t,f=a*8-e-1,o=(1<<f)-1,i=o>>1,g=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=T?0:a-1,y=T?1:-1,h=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(r=isNaN(c)?1:0,n=o):(n=Math.floor(Math.log(c)/Math.LN2),c*(t=Math.pow(2,-n))<1&&(n--,t*=2),n+i>=1?c+=g/t:c+=g*Math.pow(2,1-i),c*t>=2&&(n++,t/=2),n+i>=o?(r=0,n=o):n+i>=1?(r=(c*t-1)*Math.pow(2,e),n=n+i):(r=c*Math.pow(2,i-1)*Math.pow(2,e),n=0));e>=8;w[M+p]=r&255,p+=y,r/=256,e-=8);for(n=n<<e|r,f+=e;f>0;w[M+p]=n&255,p+=y,n/=256,f-=8);w[M+p-y]|=h*128}},{}],231:[function(d,re,ne){typeof Object.create=="function"?re.exports=function(c,M){M&&(c.super_=M,c.prototype=Object.create(M.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}))}:re.exports=function(c,M){if(M){c.super_=M;var T=function(){};T.prototype=M.prototype,c.prototype=new T,c.prototype.constructor=c}}},{}],232:[function(d,re,ne){re.exports=!0},{}],233:[function(d,re,ne){re.exports=typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(d,re,ne){re.exports=M,re.exports.isMobile=M,re.exports.default=M;var w=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,c=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function M(T){T||(T={});var e=T.ua;if(!e&&typeof navigator!="undefined"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var a=T.tablet?c.test(e):w.test(e);return!a&&T.tablet&&T.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(a=!0),a}},{}],235:[function(d,re,ne){re.exports=function(w){var c=typeof w;return w!==null&&(c==="object"||c==="function")}},{}],236:[function(d,re,ne){var w=Object.prototype.toString;re.exports=function(c){var M;return w.call(c)==="[object Object]"&&(M=Object.getPrototypeOf(c),M===null||M===Object.getPrototypeOf({}))}},{}],237:[function(d,re,ne){re.exports=function(w){for(var c=w.length,M,T=0;T<c;T++)if(M=w.charCodeAt(T),(M<9||M>13)&&M!==32&&M!==133&&M!==160&&M!==5760&&M!==6158&&(M<8192||M>8205)&&M!==8232&&M!==8233&&M!==8239&&M!==8287&&M!==8288&&M!==12288&&M!==65279)return!1;return!0}},{}],238:[function(d,re,ne){re.exports=function(c){return typeof c!="string"?!1:(c=c.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(c)&&/[\dz]$/i.test(c)&&c.length>4))}},{}],239:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?re.exports=c():(w=w||self,w.mapboxgl=c())})(this,function(){var w,c,M;function T(e,a){if(!w)w=a;else if(!c)c=a;else{var n="var sharedChunk = {}; ("+w+")(sharedChunk); ("+c+")(sharedChunk);",r={};w(r),M=a(r),M.workerUrl=window.URL.createObjectURL(new Blob([n],{type:"text/javascript"}))}}return T(["exports"],function(e){function a(E,C){return C={exports:{}},E(C,C.exports),C.exports}var n="1.10.1",r=t;function t(E,C,O,$){this.cx=3*E,this.bx=3*(O-E)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*C,this.by=3*($-C)-this.cy,this.ay=1-this.cy-this.by,this.p1x=E,this.p1y=$,this.p2x=O,this.p2y=$}t.prototype.sampleCurveX=function(E){return((this.ax*E+this.bx)*E+this.cx)*E},t.prototype.sampleCurveY=function(E){return((this.ay*E+this.by)*E+this.cy)*E},t.prototype.sampleCurveDerivativeX=function(E){return(3*this.ax*E+2*this.bx)*E+this.cx},t.prototype.solveCurveX=function(E,C){typeof C=="undefined"&&(C=1e-6);var O,$,he,me,Te;for(he=E,Te=0;Te<8;Te++){if(me=this.sampleCurveX(he)-E,Math.abs(me)<C)return he;var Ie=this.sampleCurveDerivativeX(he);if(Math.abs(Ie)<1e-6)break;he=he-me/Ie}if(O=0,$=1,he=E,he<O)return O;if(he>$)return $;for(;O<$;){if(me=this.sampleCurveX(he),Math.abs(me-E)<C)return he;E>me?O=he:$=he,he=($-O)*.5+O}return he},t.prototype.solve=function(E,C){return this.sampleCurveY(this.solveCurveX(E,C))};var f=o;function o(E,C){this.x=E,this.y=C}o.prototype={clone:function(){return new o(this.x,this.y)},add:function(E){return this.clone()._add(E)},sub:function(E){return this.clone()._sub(E)},multByPoint:function(E){return this.clone()._multByPoint(E)},divByPoint:function(E){return this.clone()._divByPoint(E)},mult:function(E){return this.clone()._mult(E)},div:function(E){return this.clone()._div(E)},rotate:function(E){return this.clone()._rotate(E)},rotateAround:function(E,C){return this.clone()._rotateAround(E,C)},matMult:function(E){return this.clone()._matMult(E)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(E){return this.x===E.x&&this.y===E.y},dist:function(E){return Math.sqrt(this.distSqr(E))},distSqr:function(E){var C=E.x-this.x,O=E.y-this.y;return C*C+O*O},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(E){return Math.atan2(this.y-E.y,this.x-E.x)},angleWith:function(E){return this.angleWithSep(E.x,E.y)},angleWithSep:function(E,C){return Math.atan2(this.x*C-this.y*E,this.x*E+this.y*C)},_matMult:function(E){var C=E[0]*this.x+E[1]*this.y,O=E[2]*this.x+E[3]*this.y;return this.x=C,this.y=O,this},_add:function(E){return this.x+=E.x,this.y+=E.y,this},_sub:function(E){return this.x-=E.x,this.y-=E.y,this},_mult:function(E){return this.x*=E,this.y*=E,this},_div:function(E){return this.x/=E,this.y/=E,this},_multByPoint:function(E){return this.x*=E.x,this.y*=E.y,this},_divByPoint:function(E){return this.x/=E.x,this.y/=E.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var E=this.y;return this.y=this.x,this.x=-E,this},_rotate:function(E){var C=Math.cos(E),O=Math.sin(E),$=C*this.x-O*this.y,he=O*this.x+C*this.y;return this.x=$,this.y=he,this},_rotateAround:function(E,C){var O=Math.cos(E),$=Math.sin(E),he=C.x+O*(this.x-C.x)-$*(this.y-C.y),me=C.y+$*(this.x-C.x)+O*(this.y-C.y);return this.x=he,this.y=me,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},o.convert=function(E){return E instanceof o?E:Array.isArray(E)?new o(E[0],E[1]):E};function i(E,C){if(Array.isArray(E)){if(!Array.isArray(C)||E.length!==C.length)return!1;for(var O=0;O<E.length;O++)if(!i(E[O],C[O]))return!1;return!0}if(typeof E=="object"&&E!==null&&C!==null){if(typeof C!="object")return!1;var $=Object.keys(E);if($.length!==Object.keys(C).length)return!1;for(var he in E)if(!i(E[he],C[he]))return!1;return!0}return E===C}function g(E){if(E<=0)return 0;if(E>=1)return 1;var C=E*E,O=C*E;return 4*(E<.5?O:3*(E-C)+O-.75)}function p(E,C,O,$){var he=new r(E,C,O,$);return function(me){return he.solve(me)}}var y=p(.25,.1,.25,1);function h(E,C,O){return Math.min(O,Math.max(C,E))}function m(E,C,O){var $=O-C,he=((E-C)%$+$)%$+C;return he===C?O:he}function u(E,C,O){if(!E.length)return O(null,[]);var $=E.length,he=new Array(E.length),me=null;E.forEach(function(Te,Ie){C(Te,function(qe,ut){qe&&(me=qe),he[Ie]=ut,--$===0&&O(me,he)})})}function _(E){var C=[];for(var O in E)C.push(E[O]);return C}function s(E,C){var O=[];for(var $ in E)$ in C||O.push($);return O}function A(E){for(var C=[],O=arguments.length-1;O-- >0;)C[O]=arguments[O+1];for(var $=0,he=C;$<he.length;$+=1){var me=he[$];for(var Te in me)E[Te]=me[Te]}return E}function x(E,C){for(var O={},$=0;$<C.length;$++){var he=C[$];he in E&&(O[he]=E[he])}return O}var v=1;function b(){return v++}function l(){function E(C){return C?(C^Math.random()*16>>C/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,E)}return E()}function L(E){return E?/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(E):!1}function S(E,C){E.forEach(function(O){!C[O]||(C[O]=C[O].bind(C))})}function k(E,C){return E.indexOf(C,E.length-C.length)!==-1}function P(E,C,O){var $={};for(var he in E)$[he]=C.call(O||this,E[he],he,E);return $}function z(E,C,O){var $={};for(var he in E)C.call(O||this,E[he],he,E)&&($[he]=E[he]);return $}function I(E){return Array.isArray(E)?E.map(I):typeof E=="object"&&E?P(E,I):E}function D(E,C){for(var O=0;O<E.length;O++)if(C.indexOf(E[O])>=0)return!0;return!1}var R={};function B(E){R[E]||(typeof console!="undefined"&&console.warn(E),R[E]=!0)}function F(E,C,O){return(O.y-E.y)*(C.x-E.x)>(C.y-E.y)*(O.x-E.x)}function V(E){for(var C=0,O=0,$=E.length,he=$-1,me=void 0,Te=void 0;O<$;he=O++)me=E[O],Te=E[he],C+=(Te.x-me.x)*(me.y+Te.y);return C}function G(E){var C=E[0],O=E[1],$=E[2];return O+=90,O*=Math.PI/180,$*=Math.PI/180,{x:C*Math.cos(O)*Math.sin($),y:C*Math.sin(O)*Math.sin($),z:C*Math.cos($)}}function J(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function j(E){var C=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,O={};if(E.replace(C,function(he,me,Te,Ie){var qe=Te||Ie;return O[me]=qe?qe.toLowerCase():!0,""}),O["max-age"]){var $=parseInt(O["max-age"],10);isNaN($)?delete O["max-age"]:O["max-age"]=$}return O}var Y=null;function X(E){if(Y==null){var C=E.navigator?E.navigator.userAgent:null;Y=!!E.safari||!!(C&&(/\b(iPad|iPhone|iPod)\b/.test(C)||!!C.match("Safari")&&!C.match("Chrome")))}return Y}function oe(E){try{var C=self[E];return C.setItem("_mapbox_test_",1),C.removeItem("_mapbox_test_"),!0}catch{return!1}}function se(E){return self.btoa(encodeURIComponent(E).replace(/%([0-9A-F]{2})/g,function(C,O){return String.fromCharCode(Number("0x"+O))}))}function ie(E){return decodeURIComponent(self.atob(E).split("").map(function(C){return"%"+("00"+C.charCodeAt(0).toString(16)).slice(-2)}).join(""))}var N=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),U=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,q=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,Q,W,Z={now:N,frame:function(C){var O=U(C);return{cancel:function(){return q(O)}}},getImageData:function(C,O){O===void 0&&(O=0);var $=self.document.createElement("canvas"),he=$.getContext("2d");if(!he)throw new Error("failed to create canvas 2d context");return $.width=C.width,$.height=C.height,he.drawImage(C,0,0,C.width,C.height),he.getImageData(-O,-O,C.width+2*O,C.height+2*O)},resolveURL:function(C){return Q||(Q=self.document.createElement("a")),Q.href=C,Q.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return self.matchMedia?(W==null&&(W=self.matchMedia("(prefers-reduced-motion: reduce)")),W.matches):!1}},ee={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},te={supported:!1,testSupport:pe},ae,le=!1,ye,fe=!1;self.document&&(ye=self.document.createElement("img"),ye.onload=function(){ae&&ge(ae),ae=null,fe=!0},ye.onerror=function(){le=!0,ae=null},ye.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function pe(E){le||!ye||(fe?ge(E):ae=E)}function ge(E){var C=E.createTexture();E.bindTexture(E.TEXTURE_2D,C);try{if(E.texImage2D(E.TEXTURE_2D,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,ye),E.isContextLost())return;te.supported=!0}catch{}E.deleteTexture(C),le=!0}var Ae="01";function we(){for(var E="1",C="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",O="",$=0;$<10;$++)O+=C[Math.floor(Math.random()*62)];var he=12*60*60*1e3,me=[E,Ae,O].join(""),Te=Date.now()+he;return{token:me,tokenExpiresAt:Te}}var De=function(C,O){this._transformRequestFn=C,this._customAccessToken=O,this._createSkuToken()};De.prototype._createSkuToken=function(){var C=we();this._skuToken=C.token,this._skuTokenExpiresAt=C.tokenExpiresAt},De.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},De.prototype.transformRequest=function(C,O){return this._transformRequestFn?this._transformRequestFn(C,O)||{url:C}:{url:C}},De.prototype.normalizeStyleURL=function(C,O){if(!Be(C))return C;var $=Oe(C);return $.path="/styles/v1"+$.path,this._makeAPIURL($,this._customAccessToken||O)},De.prototype.normalizeGlyphsURL=function(C,O){if(!Be(C))return C;var $=Oe(C);return $.path="/fonts/v1"+$.path,this._makeAPIURL($,this._customAccessToken||O)},De.prototype.normalizeSourceURL=function(C,O){if(!Be(C))return C;var $=Oe(C);return $.path="/v4/"+$.authority+".json",$.params.push("secure"),this._makeAPIURL($,this._customAccessToken||O)},De.prototype.normalizeSpriteURL=function(C,O,$,he){var me=Oe(C);return Be(C)?(me.path="/styles/v1"+me.path+"/sprite"+O+$,this._makeAPIURL(me,this._customAccessToken||he)):(me.path+=""+O+$,Pe(me))},De.prototype.normalizeTileURL=function(C,O){if(this._isSkuTokenExpired()&&this._createSkuToken(),C&&!Be(C))return C;var $=Oe(C),he=/(\.(png|jpg)\d*)(?=$)/,me=/^.+\/v4\//,Te=Z.devicePixelRatio>=2||O===512?"@2x":"",Ie=te.supported?".webp":"$1";$.path=$.path.replace(he,""+Te+Ie),$.path=$.path.replace(me,"/"),$.path="/v4"+$.path;var qe=this._customAccessToken||He($.params)||ee.ACCESS_TOKEN;return ee.REQUIRE_ACCESS_TOKEN&&qe&&this._skuToken&&$.params.push("sku="+this._skuToken),this._makeAPIURL($,qe)},De.prototype.canonicalizeTileURL=function(C,O){var $="/v4/",he=/\.[\w]+$/,me=Oe(C);if(!me.path.match(/(^\/v4\/)/)||!me.path.match(he))return C;var Te="mapbox://tiles/";Te+=me.path.replace($,"");var Ie=me.params;return O&&(Ie=Ie.filter(function(qe){return!qe.match(/^access_token=/)})),Ie.length&&(Te+="?"+Ie.join("&")),Te},De.prototype.canonicalizeTileset=function(C,O){for(var $=O?Be(O):!1,he=[],me=0,Te=C.tiles||[];me<Te.length;me+=1){var Ie=Te[me];xe(Ie)?he.push(this.canonicalizeTileURL(Ie,$)):he.push(Ie)}return he},De.prototype._makeAPIURL=function(C,O){var $="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",he=Oe(ee.API_URL);if(C.protocol=he.protocol,C.authority=he.authority,he.path!=="/"&&(C.path=""+he.path+C.path),!ee.REQUIRE_ACCESS_TOKEN)return Pe(C);if(O=O||ee.ACCESS_TOKEN,!O)throw new Error("An API access token is required to use Mapbox GL. "+$);if(O[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+$);return C.params=C.params.filter(function(me){return me.indexOf("access_token")===-1}),C.params.push("access_token="+O),Pe(C)};function Be(E){return E.indexOf("mapbox:")===0}var Ve=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function xe(E){return Ve.test(E)}function Le(E){return E.indexOf("sku=")>0&&xe(E)}function He(E){for(var C=0,O=E;C<O.length;C+=1){var $=O[C],he=$.match(/^access_token=(.*)$/);if(he)return he[1]}return null}var Je=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Oe(E){var C=E.match(Je);if(!C)throw new Error("Unable to parse URL object");return{protocol:C[1],authority:C[2],path:C[3]||"/",params:C[4]?C[4].split("&"):[]}}function Pe(E){var C=E.params.length?"?"+E.params.join("&"):"";return E.protocol+"://"+E.authority+E.path+C}var Ue="mapbox.eventData";function vt(E){if(!E)return null;var C=E.split(".");if(!C||C.length!==3)return null;try{var O=JSON.parse(ie(C[1]));return O}catch{return null}}var Lt=function(C){this.type=C,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Lt.prototype.getStorageKey=function(C){var O=vt(ee.ACCESS_TOKEN),$="";return O&&O.u?$=se(O.u):$=ee.ACCESS_TOKEN||"",C?Ue+"."+C+":"+$:Ue+":"+$},Lt.prototype.fetchEventData=function(){var C=oe("localStorage"),O=this.getStorageKey(),$=this.getStorageKey("uuid");if(C)try{var he=self.localStorage.getItem(O);he&&(this.eventData=JSON.parse(he));var me=self.localStorage.getItem($);me&&(this.anonId=me)}catch{B("Unable to read from LocalStorage")}},Lt.prototype.saveEventData=function(){var C=oe("localStorage"),O=this.getStorageKey(),$=this.getStorageKey("uuid");if(C)try{self.localStorage.setItem($,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(O,JSON.stringify(this.eventData))}catch{B("Unable to write to LocalStorage")}},Lt.prototype.processRequests=function(C){},Lt.prototype.postEvent=function(C,O,$,he){var me=this;if(!!ee.EVENTS_URL){var Te=Oe(ee.EVENTS_URL);Te.params.push("access_token="+(he||ee.ACCESS_TOKEN||""));var Ie={event:this.type,created:new Date(C).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:n,skuId:Ae,userId:this.anonId},qe=O?A(Ie,O):Ie,ut={url:Pe(Te),headers:{"Content-Type":"text/plain"},body:JSON.stringify([qe])};this.pendingRequest=We(ut,function(pt){me.pendingRequest=null,$(pt),me.saveEventData(),me.processRequests(he)})}},Lt.prototype.queueRequest=function(C,O){this.queue.push(C),this.processRequests(O)};var Yt=function(E){function C(){E.call(this,"map.load"),this.success={},this.skuToken=""}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.postMapLoadEvent=function($,he,me,Te){this.skuToken=me,(ee.EVENTS_URL&&Te||ee.ACCESS_TOKEN&&Array.isArray($)&&$.some(function(Ie){return Be(Ie)||xe(Ie)}))&&this.queueRequest({id:he,timestamp:Date.now()},Te)},C.prototype.processRequests=function($){var he=this;if(!(this.pendingRequest||this.queue.length===0)){var me=this.queue.shift(),Te=me.id,Ie=me.timestamp;Te&&this.success[Te]||(this.anonId||this.fetchEventData(),L(this.anonId)||(this.anonId=l()),this.postEvent(Ie,{skuToken:this.skuToken},function(qe){qe||Te&&(he.success[Te]=!0)},$))}},C}(Lt),At=function(E){function C(O){E.call(this,"appUserTurnstile"),this._customAccessToken=O}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.postTurnstileEvent=function($,he){ee.EVENTS_URL&&ee.ACCESS_TOKEN&&Array.isArray($)&&$.some(function(me){return Be(me)||xe(me)})&&this.queueRequest(Date.now(),he)},C.prototype.processRequests=function($){var he=this;if(!(this.pendingRequest||this.queue.length===0)){(!this.anonId||!this.eventData.lastSuccess||!this.eventData.tokenU)&&this.fetchEventData();var me=vt(ee.ACCESS_TOKEN),Te=me?me.u:ee.ACCESS_TOKEN,Ie=Te!==this.eventData.tokenU;L(this.anonId)||(this.anonId=l(),Ie=!0);var qe=this.queue.shift();if(this.eventData.lastSuccess){var ut=new Date(this.eventData.lastSuccess),pt=new Date(qe),Pt=(qe-this.eventData.lastSuccess)/(24*60*60*1e3);Ie=Ie||Pt>=1||Pt<-1||ut.getDate()!==pt.getDate()}else Ie=!0;if(!Ie)return this.processRequests();this.postEvent(qe,{"enabled.telemetry":!1},function(Jt){Jt||(he.eventData.lastSuccess=qe,he.eventData.tokenU=Te)},$)}},C}(Lt),Rt=new At,Bt=Rt.postTurnstileEvent.bind(Rt),Mt=new Yt,Tt=Mt.postMapLoadEvent.bind(Mt),at="mapbox-tiles",ct=500,je=50,ke=1e3*60*7,Ye;function Ke(){self.caches&&!Ye&&(Ye=self.caches.open(at))}var st;function Et(E,C){if(st===void 0)try{new Response(new ReadableStream),st=!0}catch{st=!1}st?C(E.body):E.blob().then(C)}function bt(E,C,O){if(Ke(),!!Ye){var $={status:C.status,statusText:C.statusText,headers:new self.Headers};C.headers.forEach(function(Te,Ie){return $.headers.set(Ie,Te)});var he=j(C.headers.get("Cache-Control")||"");if(!he["no-store"]){he["max-age"]&&$.headers.set("Expires",new Date(O+he["max-age"]*1e3).toUTCString());var me=new Date($.headers.get("Expires")).getTime()-O;me<ke||Et(C,function(Te){var Ie=new self.Response(Te,$);Ke(),Ye&&Ye.then(function(qe){return qe.put(zt(E.url),Ie)}).catch(function(qe){return B(qe.message)})})}}}function zt(E){var C=E.indexOf("?");return C<0?E:E.slice(0,C)}function $t(E,C){if(Ke(),!Ye)return C(null);var O=zt(E.url);Ye.then(function($){$.match(O).then(function(he){var me=Ot(he);$.delete(O),me&&$.put(O,he.clone()),C(null,he,me)}).catch(C)}).catch(C)}function Ot(E){if(!E)return!1;var C=new Date(E.headers.get("Expires")||0),O=j(E.headers.get("Cache-Control")||"");return C>Date.now()&&!O["no-cache"]}var Qt=1/0;function tr(E){Qt++,Qt>je&&(E.getActor().send("enforceCacheSizeLimit",ct),Qt=0)}function qt(E){Ke(),Ye&&Ye.then(function(C){C.keys().then(function(O){for(var $=0;$<O.length-E;$++)C.delete(O[$])})})}function lr(E){var C=self.caches.delete(at);E&&C.catch(E).then(function(){return E()})}function Wr(E,C){ct=E,je=C}var cn;function Jr(){return cn==null&&(cn=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),cn}var ot={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ot);var Vt=function(E){function C(O,$,he){$===401&&xe(he)&&(O+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),E.call(this,O),this.status=$,this.url=he,this.name=this.constructor.name,this.message=O}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},C}(Error),jt=J()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href},Ut=function(E){return/^file:/.test(E)||/^file:/.test(jt())&&!/^\w+:/.test(E)};function yr(E,C){var O=new self.AbortController,$=new self.Request(E.url,{method:E.method||"GET",body:E.body,credentials:E.credentials,headers:E.headers,referrer:jt(),signal:O.signal}),he=!1,me=!1,Te=Le($.url);E.type==="json"&&$.headers.set("Accept","application/json");var Ie=function(ut,pt,Pt){if(!me){if(ut&&ut.message!=="SecurityError"&&B(ut),pt&&Pt)return qe(pt);var Jt=Date.now();self.fetch($).then(function(Gt){if(Gt.ok){var cr=Te?Gt.clone():null;return qe(Gt,cr,Jt)}else return C(new Vt(Gt.statusText,Gt.status,E.url))}).catch(function(Gt){Gt.code!==20&&C(new Error(Gt.message))})}},qe=function(ut,pt,Pt){(E.type==="arrayBuffer"?ut.arrayBuffer():E.type==="json"?ut.json():ut.text()).then(function(Jt){me||(pt&&Pt&&bt($,pt,Pt),he=!0,C(null,Jt,ut.headers.get("Cache-Control"),ut.headers.get("Expires")))}).catch(function(Jt){me||C(new Error(Jt.message))})};return Te?$t($,Ie):Ie(null,null),{cancel:function(){me=!0,he||O.abort()}}}function nt(E,C){var O=new self.XMLHttpRequest;O.open(E.method||"GET",E.url,!0),E.type==="arrayBuffer"&&(O.responseType="arraybuffer");for(var $ in E.headers)O.setRequestHeader($,E.headers[$]);return E.type==="json"&&(O.responseType="text",O.setRequestHeader("Accept","application/json")),O.withCredentials=E.credentials==="include",O.onerror=function(){C(new Error(O.statusText))},O.onload=function(){if((O.status>=200&&O.status<300||O.status===0)&&O.response!==null){var he=O.response;if(E.type==="json")try{he=JSON.parse(O.response)}catch(me){return C(me)}C(null,he,O.getResponseHeader("Cache-Control"),O.getResponseHeader("Expires"))}else C(new Vt(O.statusText,O.status,E.url))},O.send(E.body),{cancel:function(){return O.abort()}}}var _e=function(E,C){if(!Ut(E.url)){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return yr(E,C);if(J()&&self.worker&&self.worker.actor){var O=!0;return self.worker.actor.send("getResource",E,C,void 0,O)}}return nt(E,C)},Me=function(E,C){return _e(A(E,{type:"json"}),C)},Ne=function(E,C){return _e(A(E,{type:"arrayBuffer"}),C)},We=function(E,C){return _e(A(E,{method:"POST"}),C)};function Qe(E){var C=self.document.createElement("a");return C.href=E,C.protocol===self.document.location.protocol&&C.host===self.document.location.host}var rt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function $e(E,C,O,$){var he=new self.Image,me=self.URL;he.onload=function(){C(null,he),me.revokeObjectURL(he.src)},he.onerror=function(){return C(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Te=new self.Blob([new Uint8Array(E)],{type:"image/png"});he.cacheControl=O,he.expires=$,he.src=E.byteLength?me.createObjectURL(Te):rt}function ht(E,C){var O=new self.Blob([new Uint8Array(E)],{type:"image/png"});self.createImageBitmap(O).then(function($){C(null,$)}).catch(function($){C(new Error("Could not load image because of "+$.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}var xt,kt,Wt=function(){xt=[],kt=0};Wt();var Ft=function(E,C){if(te.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*"),kt>=ee.MAX_PARALLEL_IMAGE_REQUESTS){var O={requestParameters:E,callback:C,cancelled:!1,cancel:function(){this.cancelled=!0}};return xt.push(O),O}kt++;var $=!1,he=function(){if(!$)for($=!0,kt--;xt.length&&kt<ee.MAX_PARALLEL_IMAGE_REQUESTS;){var Te=xt.shift(),Ie=Te.requestParameters,qe=Te.callback,ut=Te.cancelled;ut||(Te.cancel=Ft(Ie,qe).cancel)}},me=Ne(E,function(Te,Ie,qe,ut){he(),Te?C(Te):Ie&&(Jr()?ht(Ie,C):$e(Ie,C,qe,ut))});return{cancel:function(){me.cancel(),he()}}},ir=function(E,C){var O=self.document.createElement("video");O.muted=!0,O.onloadstart=function(){C(null,O)};for(var $=0;$<E.length;$++){var he=self.document.createElement("source");Qe(E[$])||(O.crossOrigin="Anonymous"),he.src=E[$],O.appendChild(he)}return{cancel:function(){}}};function hr(E,C,O){var $=O[E]&&O[E].indexOf(C)!==-1;$||(O[E]=O[E]||[],O[E].push(C))}function _r(E,C,O){if(O&&O[E]){var $=O[E].indexOf(C);$!==-1&&O[E].splice($,1)}}var an=function(C,O){O===void 0&&(O={}),A(this,O),this.type=C},Rr=function(E){function C(O,$){$===void 0&&($={}),E.call(this,"error",A({error:O},$))}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(an),Vr=function(){};Vr.prototype.on=function(C,O){return this._listeners=this._listeners||{},hr(C,O,this._listeners),this},Vr.prototype.off=function(C,O){return _r(C,O,this._listeners),_r(C,O,this._oneTimeListeners),this},Vr.prototype.once=function(C,O){return this._oneTimeListeners=this._oneTimeListeners||{},hr(C,O,this._oneTimeListeners),this},Vr.prototype.fire=function(C,O){typeof C=="string"&&(C=new an(C,O||{}));var $=C.type;if(this.listens($)){C.target=this;for(var he=this._listeners&&this._listeners[$]?this._listeners[$].slice():[],me=0,Te=he;me<Te.length;me+=1){var Ie=Te[me];Ie.call(this,C)}for(var qe=this._oneTimeListeners&&this._oneTimeListeners[$]?this._oneTimeListeners[$].slice():[],ut=0,pt=qe;ut<pt.length;ut+=1){var Pt=pt[ut];_r($,Pt,this._oneTimeListeners),Pt.call(this,C)}var Jt=this._eventedParent;Jt&&(A(C,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Jt.fire(C))}else C instanceof Rr&&console.error(C.error);return this},Vr.prototype.listens=function(C){return this._listeners&&this._listeners[C]&&this._listeners[C].length>0||this._oneTimeListeners&&this._oneTimeListeners[C]&&this._oneTimeListeners[C].length>0||this._eventedParent&&this._eventedParent.listens(C)},Vr.prototype.setEventedParent=function(C,O){return this._eventedParent=C,this._eventedParentData=O,this};var fn=8,xr={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},mr={"*":{type:"source"}},Fr=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Ir={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},Sr={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},tt={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},Ct={type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Zt={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},ur={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Lr={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Br=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Pr={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Tr={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},jr={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Pn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},An={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},$n={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},zn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Yn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Kn={type:"array",value:"*"},Aa={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},Ua={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},vi={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},ci={type:"array",value:"*",minimum:1},ui={type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},Ga={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},wr=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],vn={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},on={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},_n={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},Bn={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},sa={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},ra={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},In={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ea={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Va={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},hi={"*":{type:"string"}},It={$version:fn,$root:xr,sources:mr,source:Fr,source_vector:Ir,source_raster:Sr,source_raster_dem:tt,source_geojson:Ct,source_video:Zt,source_image:ur,layer:Lr,layout:Br,layout_background:Pr,layout_fill:Tr,layout_circle:jr,layout_heatmap:Pn,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:An,layout_symbol:$n,layout_raster:zn,layout_hillshade:Yn,filter:Kn,filter_operator:Aa,geometry_type:Ua,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:vi,expression:ci,expression_name:ui,light:Ga,paint:wr,paint_fill:vn,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:on,paint_circle:_n,paint_heatmap:Bn,paint_symbol:sa,paint_raster:ra,paint_hillshade:In,paint_background:ea,transition:Va,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:hi},vr=function(C,O,$,he){this.message=(C?C+": ":"")+$,he&&(this.identifier=he),O!=null&&O.__line__&&(this.line=O.__line__)};function rn(E){var C=E.key,O=E.value;return O?[new vr(C,O,"constants have been deprecated as of v8")]:[]}function hn(E){for(var C=[],O=arguments.length-1;O-- >0;)C[O]=arguments[O+1];for(var $=0,he=C;$<he.length;$+=1){var me=he[$];for(var Te in me)E[Te]=me[Te]}return E}function un(E){return E instanceof Number||E instanceof String||E instanceof Boolean?E.valueOf():E}function kn(E){if(Array.isArray(E))return E.map(kn);if(E instanceof Object&&!(E instanceof Number||E instanceof String||E instanceof Boolean)){var C={};for(var O in E)C[O]=kn(E[O]);return C}return un(E)}var bn=function(E){function C(O,$){E.call(this,$),this.message=$,this.key=O}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(Error),ln=function(C,O){O===void 0&&(O=[]),this.parent=C,this.bindings={};for(var $=0,he=O;$<he.length;$+=1){var me=he[$],Te=me[0],Ie=me[1];this.bindings[Te]=Ie}};ln.prototype.concat=function(C){return new ln(this,C)},ln.prototype.get=function(C){if(this.bindings[C])return this.bindings[C];if(this.parent)return this.parent.get(C);throw new Error(C+" not found in scope.")},ln.prototype.has=function(C){return this.bindings[C]?!0:this.parent?this.parent.has(C):!1};var gr={kind:"null"},dr={kind:"number"},Cr={kind:"string"},dn={kind:"boolean"},On={kind:"color"},qn={kind:"object"},xn={kind:"value"},Wn={kind:"error"},aa={kind:"collator"},da={kind:"formatted"},ma={kind:"resolvedImage"};function la(E,C){return{kind:"array",itemType:E,N:C}}function Ma(E){if(E.kind==="array"){var C=Ma(E.itemType);return typeof E.N=="number"?"array<"+C+", "+E.N+">":E.itemType.kind==="value"?"array":"array<"+C+">"}else return E.kind}var po=[gr,dr,Cr,dn,On,da,qn,la(xn),ma];function zo(E,C){if(C.kind==="error")return null;if(E.kind==="array"){if(C.kind==="array"&&(C.N===0&&C.itemType.kind==="value"||!zo(E.itemType,C.itemType))&&(typeof E.N!="number"||E.N===C.N))return null}else{if(E.kind===C.kind)return null;if(E.kind==="value")for(var O=0,$=po;O<$.length;O+=1){var he=$[O];if(!zo(he,C))return null}}return"Expected "+Ma(E)+" but found "+Ma(C)+" instead."}function Ko(E,C){return C.some(function(O){return O.kind===E.kind})}function nl(E,C){return C.some(function(O){return O==="null"?E===null:O==="array"?Array.isArray(E):O==="object"?E&&!Array.isArray(E)&&typeof E=="object":O===typeof E})}var pl=a(function(E,C){var O={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function $(ut){return ut=Math.round(ut),ut<0?0:ut>255?255:ut}function he(ut){return ut<0?0:ut>1?1:ut}function me(ut){return ut[ut.length-1]==="%"?$(parseFloat(ut)/100*255):$(parseInt(ut))}function Te(ut){return ut[ut.length-1]==="%"?he(parseFloat(ut)/100):he(parseFloat(ut))}function Ie(ut,pt,Pt){return Pt<0?Pt+=1:Pt>1&&(Pt-=1),Pt*6<1?ut+(pt-ut)*Pt*6:Pt*2<1?pt:Pt*3<2?ut+(pt-ut)*(2/3-Pt)*6:ut}function qe(ut){var pt=ut.replace(/ /g,"").toLowerCase();if(pt in O)return O[pt].slice();if(pt[0]==="#"){if(pt.length===4){var Pt=parseInt(pt.substr(1),16);return Pt>=0&&Pt<=4095?[(Pt&3840)>>4|(Pt&3840)>>8,Pt&240|(Pt&240)>>4,Pt&15|(Pt&15)<<4,1]:null}else if(pt.length===7){var Pt=parseInt(pt.substr(1),16);return Pt>=0&&Pt<=16777215?[(Pt&16711680)>>16,(Pt&65280)>>8,Pt&255,1]:null}return null}var Jt=pt.indexOf("("),Gt=pt.indexOf(")");if(Jt!==-1&&Gt+1===pt.length){var cr=pt.substr(0,Jt),Dr=pt.substr(Jt+1,Gt-(Jt+1)).split(","),en=1;switch(cr){case"rgba":if(Dr.length!==4)return null;en=Te(Dr.pop());case"rgb":return Dr.length!==3?null:[me(Dr[0]),me(Dr[1]),me(Dr[2]),en];case"hsla":if(Dr.length!==4)return null;en=Te(Dr.pop());case"hsl":if(Dr.length!==3)return null;var Kr=(parseFloat(Dr[0])%360+360)%360/360,Mn=Te(Dr[1]),yn=Te(Dr[2]),Tn=yn<=.5?yn*(Mn+1):yn+Mn-yn*Mn,Dn=yn*2-Tn;return[$(Ie(Dn,Tn,Kr+1/3)*255),$(Ie(Dn,Tn,Kr)*255),$(Ie(Dn,Tn,Kr-1/3)*255),en];default:return null}}return null}try{C.parseCSSColor=qe}catch{}}),Yl=pl.parseCSSColor,di=function(C,O,$,he){he===void 0&&(he=1),this.r=C,this.g=O,this.b=$,this.a=he};di.parse=function(C){if(!!C){if(C instanceof di)return C;if(typeof C=="string"){var O=Yl(C);if(!!O)return new di(O[0]/255*O[3],O[1]/255*O[3],O[2]/255*O[3],O[3])}}},di.prototype.toString=function(){var C=this.toArray(),O=C[0],$=C[1],he=C[2],me=C[3];return"rgba("+Math.round(O)+","+Math.round($)+","+Math.round(he)+","+me+")"},di.prototype.toArray=function(){var C=this,O=C.r,$=C.g,he=C.b,me=C.a;return me===0?[0,0,0,0]:[O*255/me,$*255/me,he*255/me,me]},di.black=new di(0,0,0,1),di.white=new di(1,1,1,1),di.transparent=new di(0,0,0,0),di.red=new di(1,0,0,1);var Gs=function(C,O,$){C?this.sensitivity=O?"variant":"case":this.sensitivity=O?"accent":"base",this.locale=$,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Gs.prototype.compare=function(C,O){return this.collator.compare(C,O)},Gs.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Rs=function(C,O,$,he,me){this.text=C,this.image=O,this.scale=$,this.fontStack=he,this.textColor=me},Hi=function(C){this.sections=C};Hi.fromString=function(C){return new Hi([new Rs(C,null,null,null,null)])},Hi.prototype.isEmpty=function(){return this.sections.length===0?!0:!this.sections.some(function(C){return C.text.length!==0||C.image&&C.image.name.length!==0})},Hi.factory=function(C){return C instanceof Hi?C:Hi.fromString(C)},Hi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(C){return C.text}).join("")},Hi.prototype.serialize=function(){for(var C=["format"],O=0,$=this.sections;O<$.length;O+=1){var he=$[O];if(he.image){C.push(["image",he.image.name]);continue}C.push(he.text);var me={};he.fontStack&&(me["text-font"]=["literal",he.fontStack.split(",")]),he.scale&&(me["font-scale"]=he.scale),he.textColor&&(me["text-color"]=["rgba"].concat(he.textColor.toArray())),C.push(me)}return C};var So=function(C){this.name=C.name,this.available=C.available};So.prototype.toString=function(){return this.name},So.fromString=function(C){return C?new So({name:C,available:!1}):null},So.prototype.serialize=function(){return["image",this.name]};function dl(E,C,O,$){if(!(typeof E=="number"&&E>=0&&E<=255&&typeof C=="number"&&C>=0&&C<=255&&typeof O=="number"&&O>=0&&O<=255)){var he=typeof $=="number"?[E,C,O,$]:[E,C,O];return"Invalid rgba value ["+he.join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}return typeof $=="undefined"||typeof $=="number"&&$>=0&&$<=1?null:"Invalid rgba value ["+[E,C,O,$].join(", ")+"]: 'a' must be between 0 and 1."}function ps(E){if(E===null)return!0;if(typeof E=="string")return!0;if(typeof E=="boolean")return!0;if(typeof E=="number")return!0;if(E instanceof di)return!0;if(E instanceof Gs)return!0;if(E instanceof Hi)return!0;if(E instanceof So)return!0;if(Array.isArray(E)){for(var C=0,O=E;C<O.length;C+=1){var $=O[C];if(!ps($))return!1}return!0}else if(typeof E=="object"){for(var he in E)if(!ps(E[he]))return!1;return!0}else return!1}function Ii(E){if(E===null)return gr;if(typeof E=="string")return Cr;if(typeof E=="boolean")return dn;if(typeof E=="number")return dr;if(E instanceof di)return On;if(E instanceof Gs)return aa;if(E instanceof Hi)return da;if(E instanceof So)return ma;if(Array.isArray(E)){for(var C=E.length,O,$=0,he=E;$<he.length;$+=1){var me=he[$],Te=Ii(me);if(!O)O=Te;else{if(O===Te)continue;O=xn;break}}return la(O||xn,C)}else return qn}function al(E){var C=typeof E;return E===null?"":C==="string"||C==="number"||C==="boolean"?String(E):E instanceof di||E instanceof Hi||E instanceof So?E.toString():JSON.stringify(E)}var Qi=function(C,O){this.type=C,this.value=O};Qi.parse=function(C,O){if(C.length!==2)return O.error("'literal' expression requires exactly one argument, but found "+(C.length-1)+" instead.");if(!ps(C[1]))return O.error("invalid value");var $=C[1],he=Ii($),me=O.expectedType;return he.kind==="array"&&he.N===0&&me&&me.kind==="array"&&(typeof me.N!="number"||me.N===0)&&(he=me),new Qi(he,$)},Qi.prototype.evaluate=function(){return this.value},Qi.prototype.eachChild=function(){},Qi.prototype.outputDefined=function(){return!0},Qi.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof di?["rgba"].concat(this.value.toArray()):this.value instanceof Hi?this.value.serialize():this.value};var Bi=function(C){this.name="ExpressionEvaluationError",this.message=C};Bi.prototype.toJSON=function(){return this.message};var io={string:Cr,number:dr,boolean:dn,object:qn},$i=function(C,O){this.type=C,this.args=O};$i.parse=function(C,O){if(C.length<2)return O.error("Expected at least one argument.");var $=1,he,me=C[0];if(me==="array"){var Te;if(C.length>2){var Ie=C[1];if(typeof Ie!="string"||!(Ie in io)||Ie==="object")return O.error('The item type argument of "array" must be one of string, number, boolean',1);Te=io[Ie],$++}else Te=xn;var qe;if(C.length>3){if(C[2]!==null&&(typeof C[2]!="number"||C[2]<0||C[2]!==Math.floor(C[2])))return O.error('The length argument to "array" must be a positive integer literal',2);qe=C[2],$++}he=la(Te,qe)}else he=io[me];for(var ut=[];$<C.length;$++){var pt=O.parse(C[$],$,xn);if(!pt)return null;ut.push(pt)}return new $i(he,ut)},$i.prototype.evaluate=function(C){for(var O=0;O<this.args.length;O++){var $=this.args[O].evaluate(C),he=zo(this.type,Ii($));if(he){if(O===this.args.length-1)throw new Bi("Expected value to be of type "+Ma(this.type)+", but found "+Ma(Ii($))+" instead.")}else return $}return null},$i.prototype.eachChild=function(C){this.args.forEach(C)},$i.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},$i.prototype.serialize=function(){var C=this.type,O=[C.kind];if(C.kind==="array"){var $=C.itemType;if($.kind==="string"||$.kind==="number"||$.kind==="boolean"){O.push($.kind);var he=C.N;(typeof he=="number"||this.args.length>1)&&O.push(he)}}return O.concat(this.args.map(function(me){return me.serialize()}))};var rs=function(C){this.type=da,this.sections=C};rs.parse=function(C,O){if(C.length<2)return O.error("Expected at least one argument.");var $=C[1];if(!Array.isArray($)&&typeof $=="object")return O.error("First argument must be an image or text section.");for(var he=[],me=!1,Te=1;Te<=C.length-1;++Te){var Ie=C[Te];if(me&&typeof Ie=="object"&&!Array.isArray(Ie)){me=!1;var qe=null;if(Ie["font-scale"]&&(qe=O.parse(Ie["font-scale"],1,dr),!qe))return null;var ut=null;if(Ie["text-font"]&&(ut=O.parse(Ie["text-font"],1,la(Cr)),!ut))return null;var pt=null;if(Ie["text-color"]&&(pt=O.parse(Ie["text-color"],1,On),!pt))return null;var Pt=he[he.length-1];Pt.scale=qe,Pt.font=ut,Pt.textColor=pt}else{var Jt=O.parse(C[Te],1,xn);if(!Jt)return null;var Gt=Jt.type.kind;if(Gt!=="string"&&Gt!=="value"&&Gt!=="null"&&Gt!=="resolvedImage")return O.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");me=!0,he.push({content:Jt,scale:null,font:null,textColor:null})}}return new rs(he)},rs.prototype.evaluate=function(C){var O=function($){var he=$.content.evaluate(C);return Ii(he)===ma?new Rs("",he,null,null,null):new Rs(al(he),null,$.scale?$.scale.evaluate(C):null,$.font?$.font.evaluate(C).join(","):null,$.textColor?$.textColor.evaluate(C):null)};return new Hi(this.sections.map(O))},rs.prototype.eachChild=function(C){for(var O=0,$=this.sections;O<$.length;O+=1){var he=$[O];C(he.content),he.scale&&C(he.scale),he.font&&C(he.font),he.textColor&&C(he.textColor)}},rs.prototype.outputDefined=function(){return!1},rs.prototype.serialize=function(){for(var C=["format"],O=0,$=this.sections;O<$.length;O+=1){var he=$[O];C.push(he.content.serialize());var me={};he.scale&&(me["font-scale"]=he.scale.serialize()),he.font&&(me["text-font"]=he.font.serialize()),he.textColor&&(me["text-color"]=he.textColor.serialize()),C.push(me)}return C};var Ys=function(C){this.type=ma,this.input=C};Ys.parse=function(C,O){if(C.length!==2)return O.error("Expected two arguments.");var $=O.parse(C[1],1,Cr);return $?new Ys($):O.error("No image name provided.")},Ys.prototype.evaluate=function(C){var O=this.input.evaluate(C),$=So.fromString(O);return $&&C.availableImages&&($.available=C.availableImages.indexOf(O)>-1),$},Ys.prototype.eachChild=function(C){C(this.input)},Ys.prototype.outputDefined=function(){return!1},Ys.prototype.serialize=function(){return["image",this.input.serialize()]};var au={"to-boolean":dn,"to-color":On,"to-number":dr,"to-string":Cr},Jo=function(C,O){this.type=C,this.args=O};Jo.parse=function(C,O){if(C.length<2)return O.error("Expected at least one argument.");var $=C[0];if(($==="to-boolean"||$==="to-string")&&C.length!==2)return O.error("Expected one argument.");for(var he=au[$],me=[],Te=1;Te<C.length;Te++){var Ie=O.parse(C[Te],Te,xn);if(!Ie)return null;me.push(Ie)}return new Jo(he,me)},Jo.prototype.evaluate=function(C){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(C));if(this.type.kind==="color"){for(var O,$,he=0,me=this.args;he<me.length;he+=1){var Te=me[he];if(O=Te.evaluate(C),$=null,O instanceof di)return O;if(typeof O=="string"){var Ie=C.parseColor(O);if(Ie)return Ie}else if(Array.isArray(O)&&(O.length<3||O.length>4?$="Invalid rbga value "+JSON.stringify(O)+": expected an array containing either three or four numeric values.":$=dl(O[0],O[1],O[2],O[3]),!$))return new di(O[0]/255,O[1]/255,O[2]/255,O[3])}throw new Bi($||"Could not parse color from value '"+(typeof O=="string"?O:String(JSON.stringify(O)))+"'")}else if(this.type.kind==="number"){for(var qe=null,ut=0,pt=this.args;ut<pt.length;ut+=1){var Pt=pt[ut];if(qe=Pt.evaluate(C),qe===null)return 0;var Jt=Number(qe);if(!isNaN(Jt))return Jt}throw new Bi("Could not convert "+JSON.stringify(qe)+" to number.")}else return this.type.kind==="formatted"?Hi.fromString(al(this.args[0].evaluate(C))):this.type.kind==="resolvedImage"?So.fromString(al(this.args[0].evaluate(C))):al(this.args[0].evaluate(C))},Jo.prototype.eachChild=function(C){this.args.forEach(C)},Jo.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},Jo.prototype.serialize=function(){if(this.type.kind==="formatted")return new rs([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ys(this.args[0]).serialize();var C=["to-"+this.type.kind];return this.eachChild(function(O){C.push(O.serialize())}),C};var iu=["Unknown","Point","LineString","Polygon"],Is=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Is.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Is.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?iu[this.feature.type]:this.feature.type:null},Is.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Is.prototype.canonicalID=function(){return this.canonical},Is.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Is.prototype.parseColor=function(C){var O=this._parseColorCache[C];return O||(O=this._parseColorCache[C]=di.parse(C)),O};var ko=function(C,O,$,he){this.name=C,this.type=O,this._evaluate=$,this.args=he};ko.prototype.evaluate=function(C){return this._evaluate(C,this.args)},ko.prototype.eachChild=function(C){this.args.forEach(C)},ko.prototype.outputDefined=function(){return!1},ko.prototype.serialize=function(){return[this.name].concat(this.args.map(function(C){return C.serialize()}))},ko.parse=function(C,O){var $,he=C[0],me=ko.definitions[he];if(!me)return O.error('Unknown expression "'+he+'". If you wanted a literal array, use ["literal", [...]].',0);for(var Te=Array.isArray(me)?me[0]:me.type,Ie=Array.isArray(me)?[[me[1],me[2]]]:me.overloads,qe=Ie.filter(function(La){var Da=La[0];return!Array.isArray(Da)||Da.length===C.length-1}),ut=null,pt=0,Pt=qe;pt<Pt.length;pt+=1){var Jt=Pt[pt],Gt=Jt[0],cr=Jt[1];ut=new Eo(O.registry,O.path,null,O.scope);for(var Dr=[],en=!1,Kr=1;Kr<C.length;Kr++){var Mn=C[Kr],yn=Array.isArray(Gt)?Gt[Kr-1]:Gt.type,Tn=ut.parse(Mn,1+Dr.length,yn);if(!Tn){en=!0;break}Dr.push(Tn)}if(!en){if(Array.isArray(Gt)&&Gt.length!==Dr.length){ut.error("Expected "+Gt.length+" arguments, but found "+Dr.length+" instead.");continue}for(var Dn=0;Dn<Dr.length;Dn++){var Hn=Array.isArray(Gt)?Gt[Dn]:Gt.type,oa=Dr[Dn];ut.concat(Dn+1).checkSubtype(Hn,oa.type)}if(ut.errors.length===0)return new ko(he,Te,cr,Dr)}}if(qe.length===1)($=O.errors).push.apply($,ut.errors);else{for(var na=qe.length?qe:Ie,Ra=na.map(function(La){var Da=La[0];return Mu(Da)}).join(" | "),wa=[],Sa=1;Sa<C.length;Sa++){var ei=O.parse(C[Sa],1+wa.length);if(!ei)return null;wa.push(Ma(ei.type))}O.error("Expected arguments of type "+Ra+", but found ("+wa.join(", ")+") instead.")}return null},ko.register=function(C,O){ko.definitions=O;for(var $ in O)C[$]=ko};function Mu(E){return Array.isArray(E)?"("+E.map(Ma).join(", ")+")":"("+Ma(E.type)+"...)"}var zs=function(C,O,$){this.type=aa,this.locale=$,this.caseSensitive=C,this.diacriticSensitive=O};zs.parse=function(C,O){if(C.length!==2)return O.error("Expected one argument.");var $=C[1];if(typeof $!="object"||Array.isArray($))return O.error("Collator options argument must be an object.");var he=O.parse($["case-sensitive"]===void 0?!1:$["case-sensitive"],1,dn);if(!he)return null;var me=O.parse($["diacritic-sensitive"]===void 0?!1:$["diacritic-sensitive"],1,dn);if(!me)return null;var Te=null;return $.locale&&(Te=O.parse($.locale,1,Cr),!Te)?null:new zs(he,me,Te)},zs.prototype.evaluate=function(C){return new Gs(this.caseSensitive.evaluate(C),this.diacriticSensitive.evaluate(C),this.locale?this.locale.evaluate(C):null)},zs.prototype.eachChild=function(C){C(this.caseSensitive),C(this.diacriticSensitive),this.locale&&C(this.locale)},zs.prototype.outputDefined=function(){return!1},zs.prototype.serialize=function(){var C={};return C["case-sensitive"]=this.caseSensitive.serialize(),C["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(C.locale=this.locale.serialize()),["collator",C]};var ws=8192;function Ll(E,C){E[0]=Math.min(E[0],C[0]),E[1]=Math.min(E[1],C[1]),E[2]=Math.max(E[2],C[0]),E[3]=Math.max(E[3],C[1])}function Su(E){return(180+E)/360}function ku(E){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+E*Math.PI/360)))/360}function Ws(E,C){return!(E[0]<=C[0]||E[2]>=C[2]||E[1]<=C[1]||E[3]>=C[3])}function Pl(E,C){var O=Su(E[0]),$=ku(E[1]),he=Math.pow(2,C.z);return[Math.round(O*he*ws),Math.round($*he*ws)]}function Ts(E,C,O){var $=E[0]-C[0],he=E[1]-C[1],me=E[0]-O[0],Te=E[1]-O[1];return $*Te-me*he===0&&$*me<=0&&he*Te<=0}function Wl(E,C,O){return C[1]>E[1]!=O[1]>E[1]&&E[0]<(O[0]-C[0])*(E[1]-C[1])/(O[1]-C[1])+C[0]}function il(E,C){for(var O=!1,$=0,he=C.length;$<he;$++)for(var me=C[$],Te=0,Ie=me.length;Te<Ie-1;Te++){if(Ts(E,me[Te],me[Te+1]))return!1;Wl(E,me[Te],me[Te+1])&&(O=!O)}return O}function Xl(E,C){for(var O=0;O<C.length;O++)if(il(E,C[O]))return!0;return!1}function ou(E,C){return E[0]*C[1]-E[1]*C[0]}function Dl(E,C,O,$){var he=E[0]-O[0],me=E[1]-O[1],Te=C[0]-O[0],Ie=C[1]-O[1],qe=$[0]-O[0],ut=$[1]-O[1],pt=he*ut-qe*me,Pt=Te*ut-qe*Ie;return pt>0&&Pt<0||pt<0&&Pt>0}function Eu(E,C,O,$){var he=[C[0]-E[0],C[1]-E[1]],me=[$[0]-O[0],$[1]-O[1]];return ou(me,he)===0?!1:!!(Dl(E,C,O,$)&&Dl(O,$,E,C))}function Xs(E,C,O){for(var $=0,he=O;$<he.length;$+=1)for(var me=he[$],Te=0;Te<me.length-1;++Te)if(Eu(E,C,me[Te],me[Te+1]))return!0;return!1}function Zl(E,C){for(var O=0;O<E.length;++O)if(!il(E[O],C))return!1;for(var $=0;$<E.length-1;++$)if(Xs(E[$],E[$+1],C))return!1;return!0}function Rl(E,C){for(var O=0;O<C.length;O++)if(Zl(E,C[O]))return!0;return!1}function ds(E,C,O){for(var $=[],he=0;he<E.length;he++){for(var me=[],Te=0;Te<E[he].length;Te++){var Ie=Pl(E[he][Te],O);Ll(C,Ie),me.push(Ie)}$.push(me)}return $}function yl(E,C,O){for(var $=[],he=0;he<E.length;he++){var me=ds(E[he],C,O);$.push(me)}return $}function jl(E,C,O,$){if(E[0]<O[0]||E[0]>O[2]){var he=$*.5,me=E[0]-O[0]>he?-$:O[0]-E[0]>he?$:0;me===0&&(me=E[0]-O[2]>he?-$:O[2]-E[0]>he?$:0),E[0]+=me}Ll(C,E)}function su(E){E[0]=E[1]=1/0,E[2]=E[3]=-1/0}function lu(E,C,O,$){for(var he=Math.pow(2,$.z)*ws,me=[$.x*ws,$.y*ws],Te=[],Ie=0,qe=E;Ie<qe.length;Ie+=1)for(var ut=qe[Ie],pt=0,Pt=ut;pt<Pt.length;pt+=1){var Jt=Pt[pt],Gt=[Jt.x+me[0],Jt.y+me[1]];jl(Gt,C,O,he),Te.push(Gt)}return Te}function Il(E,C,O,$){for(var he=Math.pow(2,$.z)*ws,me=[$.x*ws,$.y*ws],Te=[],Ie=0,qe=E;Ie<qe.length;Ie+=1){for(var ut=qe[Ie],pt=[],Pt=0,Jt=ut;Pt<Jt.length;Pt+=1){var Gt=Jt[Pt],cr=[Gt.x+me[0],Gt.y+me[1]];Ll(C,cr),pt.push(cr)}Te.push(pt)}if(C[2]-C[0]<=he/2){su(C);for(var Dr=0,en=Te;Dr<en.length;Dr+=1)for(var Kr=en[Dr],Mn=0,yn=Kr;Mn<yn.length;Mn+=1){var Tn=yn[Mn];jl(Tn,C,O,he)}}return Te}function Cu(E,C){var O=[1/0,1/0,-1/0,-1/0],$=[1/0,1/0,-1/0,-1/0],he=E.canonicalID();if(C.type==="Polygon"){var me=ds(C.coordinates,$,he),Te=lu(E.geometry(),O,$,he);if(!Ws(O,$))return!1;for(var Ie=0,qe=Te;Ie<qe.length;Ie+=1){var ut=qe[Ie];if(!il(ut,me))return!1}}if(C.type==="MultiPolygon"){var pt=yl(C.coordinates,$,he),Pt=lu(E.geometry(),O,$,he);if(!Ws(O,$))return!1;for(var Jt=0,Gt=Pt;Jt<Gt.length;Jt+=1){var cr=Gt[Jt];if(!Xl(cr,pt))return!1}}return!0}function uu(E,C){var O=[1/0,1/0,-1/0,-1/0],$=[1/0,1/0,-1/0,-1/0],he=E.canonicalID();if(C.type==="Polygon"){var me=ds(C.coordinates,$,he),Te=Il(E.geometry(),O,$,he);if(!Ws(O,$))return!1;for(var Ie=0,qe=Te;Ie<qe.length;Ie+=1){var ut=qe[Ie];if(!Zl(ut,me))return!1}}if(C.type==="MultiPolygon"){var pt=yl(C.coordinates,$,he),Pt=Il(E.geometry(),O,$,he);if(!Ws(O,$))return!1;for(var Jt=0,Gt=Pt;Jt<Gt.length;Jt+=1){var cr=Gt[Jt];if(!Rl(cr,pt))return!1}}return!0}var Qo=function(C,O){this.type=dn,this.geojson=C,this.geometries=O};Qo.parse=function(C,O){if(C.length!==2)return O.error("'within' expression requires exactly one argument, but found "+(C.length-1)+" instead.");if(ps(C[1])){var $=C[1];if($.type==="FeatureCollection")for(var he=0;he<$.features.length;++he){var me=$.features[he].geometry.type;if(me==="Polygon"||me==="MultiPolygon")return new Qo($,$.features[he].geometry)}else if($.type==="Feature"){var Te=$.geometry.type;if(Te==="Polygon"||Te==="MultiPolygon")return new Qo($,$.geometry)}else if($.type==="Polygon"||$.type==="MultiPolygon")return new Qo($,$)}return O.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Qo.prototype.evaluate=function(C){if(C.geometry()!=null&&C.canonicalID()!=null){if(C.geometryType()==="Point")return Cu(C,this.geometries);if(C.geometryType()==="LineString")return uu(C,this.geometries)}return!1},Qo.prototype.eachChild=function(){},Qo.prototype.outputDefined=function(){return!0},Qo.prototype.serialize=function(){return["within",this.geojson]};function ol(E){if(E instanceof ko){if(E.name==="get"&&E.args.length===1)return!1;if(E.name==="feature-state")return!1;if(E.name==="has"&&E.args.length===1)return!1;if(E.name==="properties"||E.name==="geometry-type"||E.name==="id")return!1;if(/^filter-/.test(E.name))return!1}if(E instanceof Qo)return!1;var C=!0;return E.eachChild(function(O){C&&!ol(O)&&(C=!1)}),C}function sl(E){if(E instanceof ko&&E.name==="feature-state")return!1;var C=!0;return E.eachChild(function(O){C&&!sl(O)&&(C=!1)}),C}function Kl(E,C){if(E instanceof ko&&C.indexOf(E.name)>=0)return!1;var O=!0;return E.eachChild(function($){O&&!Kl($,C)&&(O=!1)}),O}var gs=function(C,O){this.type=O.type,this.name=C,this.boundExpression=O};gs.parse=function(C,O){if(C.length!==2||typeof C[1]!="string")return O.error("'var' expression requires exactly one string literal argument.");var $=C[1];return O.scope.has($)?new gs($,O.scope.get($)):O.error('Unknown variable "'+$+'". Make sure "'+$+'" has been bound in an enclosing "let" expression before using it.',1)},gs.prototype.evaluate=function(C){return this.boundExpression.evaluate(C)},gs.prototype.eachChild=function(){},gs.prototype.outputDefined=function(){return!1},gs.prototype.serialize=function(){return["var",this.name]};var Eo=function(C,O,$,he,me){O===void 0&&(O=[]),he===void 0&&(he=new ln),me===void 0&&(me=[]),this.registry=C,this.path=O,this.key=O.map(function(Te){return"["+Te+"]"}).join(""),this.scope=he,this.errors=me,this.expectedType=$};Eo.prototype.parse=function(C,O,$,he,me){return me===void 0&&(me={}),O?this.concat(O,$,he)._parse(C,me):this._parse(C,me)},Eo.prototype._parse=function(C,O){(C===null||typeof C=="string"||typeof C=="boolean"||typeof C=="number")&&(C=["literal",C]);function $(pt,Pt,Jt){return Jt==="assert"?new $i(Pt,[pt]):Jt==="coerce"?new Jo(Pt,[pt]):pt}if(Array.isArray(C)){if(C.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var he=C[0];if(typeof he!="string")return this.error("Expression name must be a string, but found "+typeof he+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var me=this.registry[he];if(me){var Te=me.parse(C,this);if(!Te)return null;if(this.expectedType){var Ie=this.expectedType,qe=Te.type;if((Ie.kind==="string"||Ie.kind==="number"||Ie.kind==="boolean"||Ie.kind==="object"||Ie.kind==="array")&&qe.kind==="value")Te=$(Te,Ie,O.typeAnnotation||"assert");else if((Ie.kind==="color"||Ie.kind==="formatted"||Ie.kind==="resolvedImage")&&(qe.kind==="value"||qe.kind==="string"))Te=$(Te,Ie,O.typeAnnotation||"coerce");else if(this.checkSubtype(Ie,qe))return null}if(!(Te instanceof Qi)&&Te.type.kind!=="resolvedImage"&&zl(Te)){var ut=new Is;try{Te=new Qi(Te.type,Te.evaluate(ut))}catch(pt){return this.error(pt.message),null}}return Te}return this.error('Unknown expression "'+he+'". If you wanted a literal array, use ["literal", [...]].',0)}else return typeof C=="undefined"?this.error("'undefined' value invalid. Use null instead."):typeof C=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof C+" instead.")},Eo.prototype.concat=function(C,O,$){var he=typeof C=="number"?this.path.concat(C):this.path,me=$?this.scope.concat($):this.scope;return new Eo(this.registry,he,O||null,me,this.errors)},Eo.prototype.error=function(C){for(var O=[],$=arguments.length-1;$-- >0;)O[$]=arguments[$+1];var he=""+this.key+O.map(function(me){return"["+me+"]"}).join("");this.errors.push(new bn(he,C))},Eo.prototype.checkSubtype=function(C,O){var $=zo(C,O);return $&&this.error($),$};function zl(E){if(E instanceof gs)return zl(E.boundExpression);if(E instanceof ko&&E.name==="error")return!1;if(E instanceof zs)return!1;if(E instanceof Qo)return!1;var C=E instanceof Jo||E instanceof $i,O=!0;return E.eachChild(function($){C?O=O&&zl($):O=O&&$ instanceof Qi}),O?ol(E)&&Kl(E,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function As(E,C){for(var O=E.length-1,$=0,he=O,me=0,Te,Ie;$<=he;)if(me=Math.floor(($+he)/2),Te=E[me],Ie=E[me+1],Te<=C){if(me===O||C<Ie)return me;$=me+1}else if(Te>C)he=me-1;else throw new Bi("Input is not a number.");return 0}var Ms=function(C,O,$){this.type=C,this.input=O,this.labels=[],this.outputs=[];for(var he=0,me=$;he<me.length;he+=1){var Te=me[he],Ie=Te[0],qe=Te[1];this.labels.push(Ie),this.outputs.push(qe)}};Ms.parse=function(C,O){if(C.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if((C.length-1)%2!==0)return O.error("Expected an even number of arguments.");var $=O.parse(C[1],1,dr);if(!$)return null;var he=[],me=null;O.expectedType&&O.expectedType.kind!=="value"&&(me=O.expectedType);for(var Te=1;Te<C.length;Te+=2){var Ie=Te===1?-1/0:C[Te],qe=C[Te+1],ut=Te,pt=Te+1;if(typeof Ie!="number")return O.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ut);if(he.length&&he[he.length-1][0]>=Ie)return O.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ut);var Pt=O.parse(qe,pt,me);if(!Pt)return null;me=me||Pt.type,he.push([Ie,Pt])}return new Ms(me,$,he)},Ms.prototype.evaluate=function(C){var O=this.labels,$=this.outputs;if(O.length===1)return $[0].evaluate(C);var he=this.input.evaluate(C);if(he<=O[0])return $[0].evaluate(C);var me=O.length;if(he>=O[me-1])return $[me-1].evaluate(C);var Te=As(O,he);return $[Te].evaluate(C)},Ms.prototype.eachChild=function(C){C(this.input);for(var O=0,$=this.outputs;O<$.length;O+=1){var he=$[O];C(he)}},Ms.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})},Ms.prototype.serialize=function(){for(var C=["step",this.input.serialize()],O=0;O<this.labels.length;O++)O>0&&C.push(this.labels[O]),C.push(this.outputs[O].serialize());return C};function lo(E,C,O){return E*(1-O)+C*O}function ml(E,C,O){return new di(lo(E.r,C.r,O),lo(E.g,C.g,O),lo(E.b,C.b,O),lo(E.a,C.a,O))}function xl(E,C,O){return E.map(function($,he){return lo($,C[he],O)})}var Zs=Object.freeze({__proto__:null,number:lo,color:ml,array:xl}),ys=.95047,bl=1,ll=1.08883,Fl=4/29,_l=6/29,js=3*_l*_l,Lu=_l*_l*_l,ns=Math.PI/180,Yu=180/Math.PI;function Jl(E){return E>Lu?Math.pow(E,1/3):E/js+Fl}function ul(E){return E>_l?E*E*E:js*(E-Fl)}function wl(E){return 255*(E<=.0031308?12.92*E:1.055*Math.pow(E,1/2.4)-.055)}function Ks(E){return E/=255,E<=.04045?E/12.92:Math.pow((E+.055)/1.055,2.4)}function Tl(E){var C=Ks(E.r),O=Ks(E.g),$=Ks(E.b),he=Jl((.4124564*C+.3575761*O+.1804375*$)/ys),me=Jl((.2126729*C+.7151522*O+.072175*$)/bl),Te=Jl((.0193339*C+.119192*O+.9503041*$)/ll);return{l:116*me-16,a:500*(he-me),b:200*(me-Te),alpha:E.a}}function fu(E){var C=(E.l+16)/116,O=isNaN(E.a)?C:C+E.a/500,$=isNaN(E.b)?C:C-E.b/200;return C=bl*ul(C),O=ys*ul(O),$=ll*ul($),new di(wl(3.2404542*O-1.5371385*C-.4985314*$),wl(-.969266*O+1.8760108*C+.041556*$),wl(.0556434*O-.2040259*C+1.0572252*$),E.alpha)}function cu(E,C,O){return{l:lo(E.l,C.l,O),a:lo(E.a,C.a,O),b:lo(E.b,C.b,O),alpha:lo(E.alpha,C.alpha,O)}}function Wu(E){var C=Tl(E),O=C.l,$=C.a,he=C.b,me=Math.atan2(he,$)*Yu;return{h:me<0?me+360:me,c:Math.sqrt($*$+he*he),l:O,alpha:E.a}}function zi(E){var C=E.h*ns,O=E.c,$=E.l;return fu({l:$,a:Math.cos(C)*O,b:Math.sin(C)*O,alpha:E.alpha})}function fl(E,C,O){var $=C-E;return E+O*($>180||$<-180?$-360*Math.round($/360):$)}function Js(E,C,O){return{h:fl(E.h,C.h,O),c:lo(E.c,C.c,O),l:lo(E.l,C.l,O),alpha:lo(E.alpha,C.alpha,O)}}var $o={forward:Tl,reverse:fu,interpolate:cu},as={forward:Wu,reverse:zi,interpolate:Js},Al=Object.freeze({__proto__:null,lab:$o,hcl:as}),uo=function(C,O,$,he,me){this.type=C,this.operator=O,this.interpolation=$,this.input=he,this.labels=[],this.outputs=[];for(var Te=0,Ie=me;Te<Ie.length;Te+=1){var qe=Ie[Te],ut=qe[0],pt=qe[1];this.labels.push(ut),this.outputs.push(pt)}};uo.interpolationFactor=function(C,O,$,he){var me=0;if(C.name==="exponential")me=hu(O,C.base,$,he);else if(C.name==="linear")me=hu(O,1,$,he);else if(C.name==="cubic-bezier"){var Te=C.controlPoints,Ie=new r(Te[0],Te[1],Te[2],Te[3]);me=Ie.solve(hu(O,1,$,he))}return me},uo.parse=function(C,O){var $=C[0],he=C[1],me=C[2],Te=C.slice(3);if(!Array.isArray(he)||he.length===0)return O.error("Expected an interpolation type expression.",1);if(he[0]==="linear")he={name:"linear"};else if(he[0]==="exponential"){var Ie=he[1];if(typeof Ie!="number")return O.error("Exponential interpolation requires a numeric base.",1,1);he={name:"exponential",base:Ie}}else if(he[0]==="cubic-bezier"){var qe=he.slice(1);if(qe.length!==4||qe.some(function(Kr){return typeof Kr!="number"||Kr<0||Kr>1}))return O.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);he={name:"cubic-bezier",controlPoints:qe}}else return O.error("Unknown interpolation type "+String(he[0]),1,0);if(C.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if((C.length-1)%2!==0)return O.error("Expected an even number of arguments.");if(me=O.parse(me,2,dr),!me)return null;var ut=[],pt=null;$==="interpolate-hcl"||$==="interpolate-lab"?pt=On:O.expectedType&&O.expectedType.kind!=="value"&&(pt=O.expectedType);for(var Pt=0;Pt<Te.length;Pt+=2){var Jt=Te[Pt],Gt=Te[Pt+1],cr=Pt+3,Dr=Pt+4;if(typeof Jt!="number")return O.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',cr);if(ut.length&&ut[ut.length-1][0]>=Jt)return O.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',cr);var en=O.parse(Gt,Dr,pt);if(!en)return null;pt=pt||en.type,ut.push([Jt,en])}return pt.kind!=="number"&&pt.kind!=="color"&&!(pt.kind==="array"&&pt.itemType.kind==="number"&&typeof pt.N=="number")?O.error("Type "+Ma(pt)+" is not interpolatable."):new uo(pt,$,he,me,ut)},uo.prototype.evaluate=function(C){var O=this.labels,$=this.outputs;if(O.length===1)return $[0].evaluate(C);var he=this.input.evaluate(C);if(he<=O[0])return $[0].evaluate(C);var me=O.length;if(he>=O[me-1])return $[me-1].evaluate(C);var Te=As(O,he),Ie=O[Te],qe=O[Te+1],ut=uo.interpolationFactor(this.interpolation,he,Ie,qe),pt=$[Te].evaluate(C),Pt=$[Te+1].evaluate(C);return this.operator==="interpolate"?Zs[this.type.kind.toLowerCase()](pt,Pt,ut):this.operator==="interpolate-hcl"?as.reverse(as.interpolate(as.forward(pt),as.forward(Pt),ut)):$o.reverse($o.interpolate($o.forward(pt),$o.forward(Pt),ut))},uo.prototype.eachChild=function(C){C(this.input);for(var O=0,$=this.outputs;O<$.length;O+=1){var he=$[O];C(he)}},uo.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})},uo.prototype.serialize=function(){var C;this.interpolation.name==="linear"?C=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?C=["linear"]:C=["exponential",this.interpolation.base]:C=["cubic-bezier"].concat(this.interpolation.controlPoints);for(var O=[this.operator,C,this.input.serialize()],$=0;$<this.labels.length;$++)O.push(this.labels[$],this.outputs[$].serialize());return O};function hu(E,C,O,$){var he=$-O,me=E-O;return he===0?0:C===1?me/he:(Math.pow(C,me)-1)/(Math.pow(C,he)-1)}var is=function(C,O){this.type=C,this.args=O};is.parse=function(C,O){if(C.length<2)return O.error("Expectected at least one argument.");var $=null,he=O.expectedType;he&&he.kind!=="value"&&($=he);for(var me=[],Te=0,Ie=C.slice(1);Te<Ie.length;Te+=1){var qe=Ie[Te],ut=O.parse(qe,1+me.length,$,void 0,{typeAnnotation:"omit"});if(!ut)return null;$=$||ut.type,me.push(ut)}var pt=he&&me.some(function(Pt){return zo(he,Pt.type)});return pt?new is(xn,me):new is($,me)},is.prototype.evaluate=function(C){for(var O=null,$=0,he,me=0,Te=this.args;me<Te.length;me+=1){var Ie=Te[me];if($++,O=Ie.evaluate(C),O&&O instanceof So&&!O.available&&(he||(he=O.name),O=null,$===this.args.length&&(O=he)),O!==null)break}return O},is.prototype.eachChild=function(C){this.args.forEach(C)},is.prototype.outputDefined=function(){return this.args.every(function(C){return C.outputDefined()})},is.prototype.serialize=function(){var C=["coalesce"];return this.eachChild(function(O){C.push(O.serialize())}),C};var Fs=function(C,O){this.type=O.type,this.bindings=[].concat(C),this.result=O};Fs.prototype.evaluate=function(C){return this.result.evaluate(C)},Fs.prototype.eachChild=function(C){for(var O=0,$=this.bindings;O<$.length;O+=1){var he=$[O];C(he[1])}C(this.result)},Fs.parse=function(C,O){if(C.length<4)return O.error("Expected at least 3 arguments, but found "+(C.length-1)+" instead.");for(var $=[],he=1;he<C.length-1;he+=2){var me=C[he];if(typeof me!="string")return O.error("Expected string, but found "+typeof me+" instead.",he);if(/[^a-zA-Z0-9_]/.test(me))return O.error("Variable names must contain only alphanumeric characters or '_'.",he);var Te=O.parse(C[he+1],he+1);if(!Te)return null;$.push([me,Te])}var Ie=O.parse(C[C.length-1],C.length-1,O.expectedType,$);return Ie?new Fs($,Ie):null},Fs.prototype.outputDefined=function(){return this.result.outputDefined()},Fs.prototype.serialize=function(){for(var C=["let"],O=0,$=this.bindings;O<$.length;O+=1){var he=$[O],me=he[0],Te=he[1];C.push(me,Te.serialize())}return C.push(this.result.serialize()),C};var Os=function(C,O,$){this.type=C,this.index=O,this.input=$};Os.parse=function(C,O){if(C.length!==3)return O.error("Expected 2 arguments, but found "+(C.length-1)+" instead.");var $=O.parse(C[1],1,dr),he=O.parse(C[2],2,la(O.expectedType||xn));if(!$||!he)return null;var me=he.type;return new Os(me.itemType,$,he)},Os.prototype.evaluate=function(C){var O=this.index.evaluate(C),$=this.input.evaluate(C);if(O<0)throw new Bi("Array index out of bounds: "+O+" < 0.");if(O>=$.length)throw new Bi("Array index out of bounds: "+O+" > "+($.length-1)+".");if(O!==Math.floor(O))throw new Bi("Array index must be an integer, but found "+O+" instead.");return $[O]},Os.prototype.eachChild=function(C){C(this.index),C(this.input)},Os.prototype.outputDefined=function(){return!1},Os.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Ss=function(C,O){this.type=dn,this.needle=C,this.haystack=O};Ss.parse=function(C,O){if(C.length!==3)return O.error("Expected 2 arguments, but found "+(C.length-1)+" instead.");var $=O.parse(C[1],1,xn),he=O.parse(C[2],2,xn);return!$||!he?null:Ko($.type,[dn,Cr,dr,gr,xn])?new Ss($,he):O.error("Expected first argument to be of type boolean, string, number or null, but found "+Ma($.type)+" instead")},Ss.prototype.evaluate=function(C){var O=this.needle.evaluate(C),$=this.haystack.evaluate(C);if(!$)return!1;if(!nl(O,["boolean","string","number","null"]))throw new Bi("Expected first argument to be of type boolean, string, number or null, but found "+Ma(Ii(O))+" instead.");if(!nl($,["string","array"]))throw new Bi("Expected second argument to be of type array or string, but found "+Ma(Ii($))+" instead.");return $.indexOf(O)>=0},Ss.prototype.eachChild=function(C){C(this.needle),C(this.haystack)},Ss.prototype.outputDefined=function(){return!0},Ss.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var os=function(C,O,$){this.type=dr,this.needle=C,this.haystack=O,this.fromIndex=$};os.parse=function(C,O){if(C.length<=2||C.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(C.length-1)+" instead.");var $=O.parse(C[1],1,xn),he=O.parse(C[2],2,xn);if(!$||!he)return null;if(!Ko($.type,[dn,Cr,dr,gr,xn]))return O.error("Expected first argument to be of type boolean, string, number or null, but found "+Ma($.type)+" instead");if(C.length===4){var me=O.parse(C[3],3,dr);return me?new os($,he,me):null}else return new os($,he)},os.prototype.evaluate=function(C){var O=this.needle.evaluate(C),$=this.haystack.evaluate(C);if(!nl(O,["boolean","string","number","null"]))throw new Bi("Expected first argument to be of type boolean, string, number or null, but found "+Ma(Ii(O))+" instead.");if(!nl($,["string","array"]))throw new Bi("Expected second argument to be of type array or string, but found "+Ma(Ii($))+" instead.");if(this.fromIndex){var he=this.fromIndex.evaluate(C);return $.indexOf(O,he)}return $.indexOf(O)},os.prototype.eachChild=function(C){C(this.needle),C(this.haystack),this.fromIndex&&C(this.fromIndex)},os.prototype.outputDefined=function(){return!1},os.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var C=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),C]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Gi=function(C,O,$,he,me,Te){this.inputType=C,this.type=O,this.input=$,this.cases=he,this.outputs=me,this.otherwise=Te};Gi.parse=function(C,O){if(C.length<5)return O.error("Expected at least 4 arguments, but found only "+(C.length-1)+".");if(C.length%2!==1)return O.error("Expected an even number of arguments.");var $,he;O.expectedType&&O.expectedType.kind!=="value"&&(he=O.expectedType);for(var me={},Te=[],Ie=2;Ie<C.length-1;Ie+=2){var qe=C[Ie],ut=C[Ie+1];Array.isArray(qe)||(qe=[qe]);var pt=O.concat(Ie);if(qe.length===0)return pt.error("Expected at least one branch label.");for(var Pt=0,Jt=qe;Pt<Jt.length;Pt+=1){var Gt=Jt[Pt];if(typeof Gt!="number"&&typeof Gt!="string")return pt.error("Branch labels must be numbers or strings.");if(typeof Gt=="number"&&Math.abs(Gt)>Number.MAX_SAFE_INTEGER)return pt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Gt=="number"&&Math.floor(Gt)!==Gt)return pt.error("Numeric branch labels must be integer values.");if(!$)$=Ii(Gt);else if(pt.checkSubtype($,Ii(Gt)))return null;if(typeof me[String(Gt)]!="undefined")return pt.error("Branch labels must be unique.");me[String(Gt)]=Te.length}var cr=O.parse(ut,Ie,he);if(!cr)return null;he=he||cr.type,Te.push(cr)}var Dr=O.parse(C[1],1,xn);if(!Dr)return null;var en=O.parse(C[C.length-1],C.length-1,he);return!en||Dr.type.kind!=="value"&&O.concat(1).checkSubtype($,Dr.type)?null:new Gi($,he,Dr,me,Te,en)},Gi.prototype.evaluate=function(C){var O=this.input.evaluate(C),$=Ii(O)===this.inputType&&this.outputs[this.cases[O]]||this.otherwise;return $.evaluate(C)},Gi.prototype.eachChild=function(C){C(this.input),this.outputs.forEach(C),C(this.otherwise)},Gi.prototype.outputDefined=function(){return this.outputs.every(function(C){return C.outputDefined()})&&this.otherwise.outputDefined()},Gi.prototype.serialize=function(){for(var C=this,O=["match",this.input.serialize()],$=Object.keys(this.cases).sort(),he=[],me={},Te=0,Ie=$;Te<Ie.length;Te+=1){var qe=Ie[Te],ut=me[this.cases[qe]];ut===void 0?(me[this.cases[qe]]=he.length,he.push([this.cases[qe],[qe]])):he[ut][1].push(qe)}for(var pt=function(Dr){return C.inputType.kind==="number"?Number(Dr):Dr},Pt=0,Jt=he;Pt<Jt.length;Pt+=1){var Gt=Jt[Pt],ut=Gt[0],cr=Gt[1];cr.length===1?O.push(pt(cr[0])):O.push(cr.map(pt)),O.push(this.outputs[outputIndex$1].serialize())}return O.push(this.otherwise.serialize()),O};var Co=function(C,O,$){this.type=C,this.branches=O,this.otherwise=$};Co.parse=function(C,O){if(C.length<4)return O.error("Expected at least 3 arguments, but found only "+(C.length-1)+".");if(C.length%2!==0)return O.error("Expected an odd number of arguments.");var $;O.expectedType&&O.expectedType.kind!=="value"&&($=O.expectedType);for(var he=[],me=1;me<C.length-1;me+=2){var Te=O.parse(C[me],me,dn);if(!Te)return null;var Ie=O.parse(C[me+1],me+1,$);if(!Ie)return null;he.push([Te,Ie]),$=$||Ie.type}var qe=O.parse(C[C.length-1],C.length-1,$);return qe?new Co($,he,qe):null},Co.prototype.evaluate=function(C){for(var O=0,$=this.branches;O<$.length;O+=1){var he=$[O],me=he[0],Te=he[1];if(me.evaluate(C))return Te.evaluate(C)}return this.otherwise.evaluate(C)},Co.prototype.eachChild=function(C){for(var O=0,$=this.branches;O<$.length;O+=1){var he=$[O],me=he[0],Te=he[1];C(me),C(Te)}C(this.otherwise)},Co.prototype.outputDefined=function(){return this.branches.every(function(C){C[0];var O=C[1];return O.outputDefined()})&&this.otherwise.outputDefined()},Co.prototype.serialize=function(){var C=["case"];return this.eachChild(function(O){C.push(O.serialize())}),C};var ss=function(C,O,$,he){this.type=C,this.input=O,this.beginIndex=$,this.endIndex=he};ss.parse=function(C,O){if(C.length<=2||C.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(C.length-1)+" instead.");var $=O.parse(C[1],1,xn),he=O.parse(C[2],2,dr);if(!$||!he)return null;if(!Ko($.type,[la(xn),Cr,xn]))return O.error("Expected first argument to be of type array or string, but found "+Ma($.type)+" instead");if(C.length===4){var me=O.parse(C[3],3,dr);return me?new ss($.type,$,he,me):null}else return new ss($.type,$,he)},ss.prototype.evaluate=function(C){var O=this.input.evaluate(C),$=this.beginIndex.evaluate(C);if(!nl(O,["string","array"]))throw new Bi("Expected first argument to be of type array or string, but found "+Ma(Ii(O))+" instead.");if(this.endIndex){var he=this.endIndex.evaluate(C);return O.slice($,he)}return O.slice($)},ss.prototype.eachChild=function(C){C(this.input),C(this.beginIndex),this.endIndex&&C(this.endIndex)},ss.prototype.outputDefined=function(){return!1},ss.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var C=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),C]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};function vu(E,C){return E==="=="||E==="!="?C.kind==="boolean"||C.kind==="string"||C.kind==="number"||C.kind==="null"||C.kind==="value":C.kind==="string"||C.kind==="number"||C.kind==="value"}function Ol(E,C,O){return C===O}function pu(E,C,O){return C!==O}function dt(E,C,O){return C<O}function Dt(E,C,O){return C>O}function or(E,C,O){return C<=O}function er(E,C,O){return C>=O}function Er(E,C,O,$){return $.compare(C,O)===0}function $r(E,C,O,$){return!Er(E,C,O,$)}function pn(E,C,O,$){return $.compare(C,O)<0}function wn(E,C,O,$){return $.compare(C,O)>0}function En(E,C,O,$){return $.compare(C,O)<=0}function Nn(E,C,O,$){return $.compare(C,O)>=0}function gn(E,C,O){var $=E!=="=="&&E!=="!=";return function(){function he(me,Te,Ie){this.type=dn,this.lhs=me,this.rhs=Te,this.collator=Ie,this.hasUntypedArgument=me.type.kind==="value"||Te.type.kind==="value"}return he.parse=function(Te,Ie){if(Te.length!==3&&Te.length!==4)return Ie.error("Expected two or three arguments.");var qe=Te[0],ut=Ie.parse(Te[1],1,xn);if(!ut)return null;if(!vu(qe,ut.type))return Ie.concat(1).error('"'+qe+`" comparisons are not supported for type '`+Ma(ut.type)+"'.");var pt=Ie.parse(Te[2],2,xn);if(!pt)return null;if(!vu(qe,pt.type))return Ie.concat(2).error('"'+qe+`" comparisons are not supported for type '`+Ma(pt.type)+"'.");if(ut.type.kind!==pt.type.kind&&ut.type.kind!=="value"&&pt.type.kind!=="value")return Ie.error("Cannot compare types '"+Ma(ut.type)+"' and '"+Ma(pt.type)+"'.");$&&(ut.type.kind==="value"&&pt.type.kind!=="value"?ut=new $i(pt.type,[ut]):ut.type.kind!=="value"&&pt.type.kind==="value"&&(pt=new $i(ut.type,[pt])));var Pt=null;if(Te.length===4){if(ut.type.kind!=="string"&&pt.type.kind!=="string"&&ut.type.kind!=="value"&&pt.type.kind!=="value")return Ie.error("Cannot use collator to compare non-string types.");if(Pt=Ie.parse(Te[3],3,aa),!Pt)return null}return new he(ut,pt,Pt)},he.prototype.evaluate=function(Te){var Ie=this.lhs.evaluate(Te),qe=this.rhs.evaluate(Te);if($&&this.hasUntypedArgument){var ut=Ii(Ie),pt=Ii(qe);if(ut.kind!==pt.kind||!(ut.kind==="string"||ut.kind==="number"))throw new Bi('Expected arguments for "'+E+'" to be (string, string) or (number, number), but found ('+ut.kind+", "+pt.kind+") instead.")}if(this.collator&&!$&&this.hasUntypedArgument){var Pt=Ii(Ie),Jt=Ii(qe);if(Pt.kind!=="string"||Jt.kind!=="string")return C(Te,Ie,qe)}return this.collator?O(Te,Ie,qe,this.collator.evaluate(Te)):C(Te,Ie,qe)},he.prototype.eachChild=function(Te){Te(this.lhs),Te(this.rhs),this.collator&&Te(this.collator)},he.prototype.outputDefined=function(){return!0},he.prototype.serialize=function(){var Te=[E];return this.eachChild(function(Ie){Te.push(Ie.serialize())}),Te},he}()}var Rn=gn("==",Ol,Er),Cn=gn("!=",pu,$r),Vn=gn("<",dt,pn),Jn=gn(">",Dt,wn),za=gn("<=",or,En),Ea=gn(">=",er,Nn),Fa=function(C,O,$,he,me){this.type=Cr,this.number=C,this.locale=O,this.currency=$,this.minFractionDigits=he,this.maxFractionDigits=me};Fa.parse=function(C,O){if(C.length!==3)return O.error("Expected two arguments.");var $=O.parse(C[1],1,dr);if(!$)return null;var he=C[2];if(typeof he!="object"||Array.isArray(he))return O.error("NumberFormat options argument must be an object.");var me=null;if(he.locale&&(me=O.parse(he.locale,1,Cr),!me))return null;var Te=null;if(he.currency&&(Te=O.parse(he.currency,1,Cr),!Te))return null;var Ie=null;if(he["min-fraction-digits"]&&(Ie=O.parse(he["min-fraction-digits"],1,dr),!Ie))return null;var qe=null;return he["max-fraction-digits"]&&(qe=O.parse(he["max-fraction-digits"],1,dr),!qe)?null:new Fa($,me,Te,Ie,qe)},Fa.prototype.evaluate=function(C){return new Intl.NumberFormat(this.locale?this.locale.evaluate(C):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(C):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(C):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(C):void 0}).format(this.number.evaluate(C))},Fa.prototype.eachChild=function(C){C(this.number),this.locale&&C(this.locale),this.currency&&C(this.currency),this.minFractionDigits&&C(this.minFractionDigits),this.maxFractionDigits&&C(this.maxFractionDigits)},Fa.prototype.outputDefined=function(){return!1},Fa.prototype.serialize=function(){var C={};return this.locale&&(C.locale=this.locale.serialize()),this.currency&&(C.currency=this.currency.serialize()),this.minFractionDigits&&(C["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(C["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),C]};var Oa=function(C){this.type=dr,this.input=C};Oa.parse=function(C,O){if(C.length!==2)return O.error("Expected 1 argument, but found "+(C.length-1)+" instead.");var $=O.parse(C[1],1);return $?$.type.kind!=="array"&&$.type.kind!=="string"&&$.type.kind!=="value"?O.error("Expected argument of type string or array, but found "+Ma($.type)+" instead."):new Oa($):null},Oa.prototype.evaluate=function(C){var O=this.input.evaluate(C);if(typeof O=="string")return O.length;if(Array.isArray(O))return O.length;throw new Bi("Expected value to be of type string or array, but found "+Ma(Ii(O))+" instead.")},Oa.prototype.eachChild=function(C){C(this.input)},Oa.prototype.outputDefined=function(){return!1},Oa.prototype.serialize=function(){var C=["length"];return this.eachChild(function(O){C.push(O.serialize())}),C};var Zn={"==":Rn,"!=":Cn,">":Jn,"<":Vn,">=":Ea,"<=":za,array:$i,at:Os,boolean:$i,case:Co,coalesce:is,collator:zs,format:rs,image:Ys,in:Ss,"index-of":os,interpolate:uo,"interpolate-hcl":uo,"interpolate-lab":uo,length:Oa,let:Fs,literal:Qi,match:Gi,number:$i,"number-format":Fa,object:$i,slice:ss,step:Ms,string:$i,"to-boolean":Jo,"to-color":Jo,"to-number":Jo,"to-string":Jo,var:gs,within:Qo};function ha(E,C){var O=C[0],$=C[1],he=C[2],me=C[3];O=O.evaluate(E),$=$.evaluate(E),he=he.evaluate(E);var Te=me?me.evaluate(E):1,Ie=dl(O,$,he,Te);if(Ie)throw new Bi(Ie);return new di(O/255*Te,$/255*Te,he/255*Te,Te)}function Ya(E,C){return E in C}function Ja(E,C){var O=C[E];return typeof O=="undefined"?null:O}function yi(E,C,O,$){for(;O<=$;){var he=O+$>>1;if(C[he]===E)return!0;C[he]>E?$=he-1:O=he+1}return!1}function mi(E){return{type:E}}ko.register(Zn,{error:[Wn,[Cr],function(E,C){var O=C[0];throw new Bi(O.evaluate(E))}],typeof:[Cr,[xn],function(E,C){var O=C[0];return Ma(Ii(O.evaluate(E)))}],"to-rgba":[la(dr,4),[On],function(E,C){var O=C[0];return O.evaluate(E).toArray()}],rgb:[On,[dr,dr,dr],ha],rgba:[On,[dr,dr,dr,dr],ha],has:{type:dn,overloads:[[[Cr],function(E,C){var O=C[0];return Ya(O.evaluate(E),E.properties())}],[[Cr,qn],function(E,C){var O=C[0],$=C[1];return Ya(O.evaluate(E),$.evaluate(E))}]]},get:{type:xn,overloads:[[[Cr],function(E,C){var O=C[0];return Ja(O.evaluate(E),E.properties())}],[[Cr,qn],function(E,C){var O=C[0],$=C[1];return Ja(O.evaluate(E),$.evaluate(E))}]]},"feature-state":[xn,[Cr],function(E,C){var O=C[0];return Ja(O.evaluate(E),E.featureState||{})}],properties:[qn,[],function(E){return E.properties()}],"geometry-type":[Cr,[],function(E){return E.geometryType()}],id:[xn,[],function(E){return E.id()}],zoom:[dr,[],function(E){return E.globals.zoom}],"heatmap-density":[dr,[],function(E){return E.globals.heatmapDensity||0}],"line-progress":[dr,[],function(E){return E.globals.lineProgress||0}],accumulated:[xn,[],function(E){return E.globals.accumulated===void 0?null:E.globals.accumulated}],"+":[dr,mi(dr),function(E,C){for(var O=0,$=0,he=C;$<he.length;$+=1){var me=he[$];O+=me.evaluate(E)}return O}],"*":[dr,mi(dr),function(E,C){for(var O=1,$=0,he=C;$<he.length;$+=1){var me=he[$];O*=me.evaluate(E)}return O}],"-":{type:dr,overloads:[[[dr,dr],function(E,C){var O=C[0],$=C[1];return O.evaluate(E)-$.evaluate(E)}],[[dr],function(E,C){var O=C[0];return-O.evaluate(E)}]]},"/":[dr,[dr,dr],function(E,C){var O=C[0],$=C[1];return O.evaluate(E)/$.evaluate(E)}],"%":[dr,[dr,dr],function(E,C){var O=C[0],$=C[1];return O.evaluate(E)%$.evaluate(E)}],ln2:[dr,[],function(){return Math.LN2}],pi:[dr,[],function(){return Math.PI}],e:[dr,[],function(){return Math.E}],"^":[dr,[dr,dr],function(E,C){var O=C[0],$=C[1];return Math.pow(O.evaluate(E),$.evaluate(E))}],sqrt:[dr,[dr],function(E,C){var O=C[0];return Math.sqrt(O.evaluate(E))}],log10:[dr,[dr],function(E,C){var O=C[0];return Math.log(O.evaluate(E))/Math.LN10}],ln:[dr,[dr],function(E,C){var O=C[0];return Math.log(O.evaluate(E))}],log2:[dr,[dr],function(E,C){var O=C[0];return Math.log(O.evaluate(E))/Math.LN2}],sin:[dr,[dr],function(E,C){var O=C[0];return Math.sin(O.evaluate(E))}],cos:[dr,[dr],function(E,C){var O=C[0];return Math.cos(O.evaluate(E))}],tan:[dr,[dr],function(E,C){var O=C[0];return Math.tan(O.evaluate(E))}],asin:[dr,[dr],function(E,C){var O=C[0];return Math.asin(O.evaluate(E))}],acos:[dr,[dr],function(E,C){var O=C[0];return Math.acos(O.evaluate(E))}],atan:[dr,[dr],function(E,C){var O=C[0];return Math.atan(O.evaluate(E))}],min:[dr,mi(dr),function(E,C){return Math.min.apply(Math,C.map(function(O){return O.evaluate(E)}))}],max:[dr,mi(dr),function(E,C){return Math.max.apply(Math,C.map(function(O){return O.evaluate(E)}))}],abs:[dr,[dr],function(E,C){var O=C[0];return Math.abs(O.evaluate(E))}],round:[dr,[dr],function(E,C){var O=C[0],$=O.evaluate(E);return $<0?-Math.round(-$):Math.round($)}],floor:[dr,[dr],function(E,C){var O=C[0];return Math.floor(O.evaluate(E))}],ceil:[dr,[dr],function(E,C){var O=C[0];return Math.ceil(O.evaluate(E))}],"filter-==":[dn,[Cr,xn],function(E,C){var O=C[0],$=C[1];return E.properties()[O.value]===$.value}],"filter-id-==":[dn,[xn],function(E,C){var O=C[0];return E.id()===O.value}],"filter-type-==":[dn,[Cr],function(E,C){var O=C[0];return E.geometryType()===O.value}],"filter-<":[dn,[Cr,xn],function(E,C){var O=C[0],$=C[1],he=E.properties()[O.value],me=$.value;return typeof he==typeof me&&he<me}],"filter-id-<":[dn,[xn],function(E,C){var O=C[0],$=E.id(),he=O.value;return typeof $==typeof he&&$<he}],"filter->":[dn,[Cr,xn],function(E,C){var O=C[0],$=C[1],he=E.properties()[O.value],me=$.value;return typeof he==typeof me&&he>me}],"filter-id->":[dn,[xn],function(E,C){var O=C[0],$=E.id(),he=O.value;return typeof $==typeof he&&$>he}],"filter-<=":[dn,[Cr,xn],function(E,C){var O=C[0],$=C[1],he=E.properties()[O.value],me=$.value;return typeof he==typeof me&&he<=me}],"filter-id-<=":[dn,[xn],function(E,C){var O=C[0],$=E.id(),he=O.value;return typeof $==typeof he&&$<=he}],"filter->=":[dn,[Cr,xn],function(E,C){var O=C[0],$=C[1],he=E.properties()[O.value],me=$.value;return typeof he==typeof me&&he>=me}],"filter-id->=":[dn,[xn],function(E,C){var O=C[0],$=E.id(),he=O.value;return typeof $==typeof he&&$>=he}],"filter-has":[dn,[xn],function(E,C){var O=C[0];return O.value in E.properties()}],"filter-has-id":[dn,[],function(E){return E.id()!==null&&E.id()!==void 0}],"filter-type-in":[dn,[la(Cr)],function(E,C){var O=C[0];return O.value.indexOf(E.geometryType())>=0}],"filter-id-in":[dn,[la(xn)],function(E,C){var O=C[0];return O.value.indexOf(E.id())>=0}],"filter-in-small":[dn,[Cr,la(xn)],function(E,C){var O=C[0],$=C[1];return $.value.indexOf(E.properties()[O.value])>=0}],"filter-in-large":[dn,[Cr,la(xn)],function(E,C){var O=C[0],$=C[1];return yi(E.properties()[O.value],$.value,0,$.value.length-1)}],all:{type:dn,overloads:[[[dn,dn],function(E,C){var O=C[0],$=C[1];return O.evaluate(E)&&$.evaluate(E)}],[mi(dn),function(E,C){for(var O=0,$=C;O<$.length;O+=1){var he=$[O];if(!he.evaluate(E))return!1}return!0}]]},any:{type:dn,overloads:[[[dn,dn],function(E,C){var O=C[0],$=C[1];return O.evaluate(E)||$.evaluate(E)}],[mi(dn),function(E,C){for(var O=0,$=C;O<$.length;O+=1){var he=$[O];if(he.evaluate(E))return!0}return!1}]]},"!":[dn,[dn],function(E,C){var O=C[0];return!O.evaluate(E)}],"is-supported-script":[dn,[Cr],function(E,C){var O=C[0],$=E.globals&&E.globals.isSupportedScript;return $?$(O.evaluate(E)):!0}],upcase:[Cr,[Cr],function(E,C){var O=C[0];return O.evaluate(E).toUpperCase()}],downcase:[Cr,[Cr],function(E,C){var O=C[0];return O.evaluate(E).toLowerCase()}],concat:[Cr,mi(xn),function(E,C){return C.map(function(O){return al(O.evaluate(E))}).join("")}],"resolved-locale":[Cr,[aa],function(E,C){var O=C[0];return O.evaluate(E).resolvedLocale()}]});function bi(E){return{result:"success",value:E}}function Si(E){return{result:"error",value:E}}function oi(E){return E["property-type"]==="data-driven"||E["property-type"]==="cross-faded-data-driven"}function xo(E){return!!E.expression&&E.expression.parameters.indexOf("zoom")>-1}function to(E){return!!E.expression&&E.expression.interpolated}function Ka(E){return E instanceof Number?"number":E instanceof String?"string":E instanceof Boolean?"boolean":Array.isArray(E)?"array":E===null?"null":typeof E}function pa(E){return typeof E=="object"&&E!==null&&!Array.isArray(E)}function _i(E){return E}function fo(E,C){var O=C.type==="color",$=E.stops&&typeof E.stops[0][0]=="object",he=$||E.property!==void 0,me=$||!he,Te=E.type||(to(C)?"exponential":"interval");if(O&&(E=hn({},E),E.stops&&(E.stops=E.stops.map(function(na){return[na[0],di.parse(na[1])]})),E.default?E.default=di.parse(E.default):E.default=di.parse(C.default)),E.colorSpace&&E.colorSpace!=="rgb"&&!Al[E.colorSpace])throw new Error("Unknown color space: "+E.colorSpace);var Ie,qe,ut;if(Te==="exponential")Ie=Fo;else if(Te==="interval")Ie=ks;else if(Te==="categorical"){Ie=ls,qe=Object.create(null);for(var pt=0,Pt=E.stops;pt<Pt.length;pt+=1){var Jt=Pt[pt];qe[Jt[0]]=Jt[1]}ut=typeof E.stops[0][0]}else if(Te==="identity")Ie=Qs;else throw new Error('Unknown function type "'+Te+'"');if($){for(var Gt={},cr=[],Dr=0;Dr<E.stops.length;Dr++){var en=E.stops[Dr],Kr=en[0].zoom;Gt[Kr]===void 0&&(Gt[Kr]={zoom:Kr,type:E.type,property:E.property,default:E.default,stops:[]},cr.push(Kr)),Gt[Kr].stops.push([en[0].value,en[1]])}for(var Mn=[],yn=0,Tn=cr;yn<Tn.length;yn+=1){var Dn=Tn[yn];Mn.push([Gt[Dn].zoom,fo(Gt[Dn],C)])}var Hn={name:"linear"};return{kind:"composite",interpolationType:Hn,interpolationFactor:uo.interpolationFactor.bind(void 0,Hn),zoomStops:Mn.map(function(na){return na[0]}),evaluate:function(Ra,wa){var Sa=Ra.zoom;return Fo({stops:Mn,base:E.base},C,Sa).evaluate(Sa,wa)}}}else if(me){var oa=Te==="exponential"?{name:"exponential",base:E.base!==void 0?E.base:1}:null;return{kind:"camera",interpolationType:oa,interpolationFactor:uo.interpolationFactor.bind(void 0,oa),zoomStops:E.stops.map(function(na){return na[0]}),evaluate:function(na){var Ra=na.zoom;return Ie(E,C,Ra,qe,ut)}}}else return{kind:"source",evaluate:function(Ra,wa){var Sa=wa&&wa.properties?wa.properties[E.property]:void 0;return Sa===void 0?go(E.default,C.default):Ie(E,C,Sa,qe,ut)}}}function go(E,C,O){if(E!==void 0)return E;if(C!==void 0)return C;if(O!==void 0)return O}function ls(E,C,O,$,he){var me=typeof O===he?$[O]:void 0;return go(me,E.default,C.default)}function ks(E,C,O){if(Ka(O)!=="number")return go(E.default,C.default);var $=E.stops.length;if($===1||O<=E.stops[0][0])return E.stops[0][1];if(O>=E.stops[$-1][0])return E.stops[$-1][1];var he=As(E.stops.map(function(me){return me[0]}),O);return E.stops[he][1]}function Fo(E,C,O){var $=E.base!==void 0?E.base:1;if(Ka(O)!=="number")return go(E.default,C.default);var he=E.stops.length;if(he===1||O<=E.stops[0][0])return E.stops[0][1];if(O>=E.stops[he-1][0])return E.stops[he-1][1];var me=As(E.stops.map(function(Pt){return Pt[0]}),O),Te=ms(O,$,E.stops[me][0],E.stops[me+1][0]),Ie=E.stops[me][1],qe=E.stops[me+1][1],ut=Zs[C.type]||_i;if(E.colorSpace&&E.colorSpace!=="rgb"){var pt=Al[E.colorSpace];ut=function(Pt,Jt){return pt.reverse(pt.interpolate(pt.forward(Pt),pt.forward(Jt),Te))}}return typeof Ie.evaluate=="function"?{evaluate:function(){for(var Jt=[],Gt=arguments.length;Gt--;)Jt[Gt]=arguments[Gt];var cr=Ie.evaluate.apply(void 0,Jt),Dr=qe.evaluate.apply(void 0,Jt);if(!(cr===void 0||Dr===void 0))return ut(cr,Dr,Te)}}:ut(Ie,qe,Te)}function Qs(E,C,O){return C.type==="color"?O=di.parse(O):C.type==="formatted"?O=Hi.fromString(O.toString()):C.type==="resolvedImage"?O=So.fromString(O.toString()):Ka(O)!==C.type&&(C.type!=="enum"||!C.values[O])&&(O=void 0),go(O,E.default,C.default)}function ms(E,C,O,$){var he=$-O,me=E-O;return he===0?0:C===1?me/he:(Math.pow(C,me)-1)/(Math.pow(C,he)-1)}var us=function(C,O){this.expression=C,this._warningHistory={},this._evaluator=new Is,this._defaultValue=O?Du(O):null,this._enumValues=O&&O.type==="enum"?O.values:null};us.prototype.evaluateWithoutErrorHandling=function(C,O,$,he,me,Te){return this._evaluator.globals=C,this._evaluator.feature=O,this._evaluator.featureState=$,this._evaluator.canonical=he,this._evaluator.availableImages=me||null,this._evaluator.formattedSection=Te,this.expression.evaluate(this._evaluator)},us.prototype.evaluate=function(C,O,$,he,me,Te){this._evaluator.globals=C,this._evaluator.feature=O||null,this._evaluator.featureState=$||null,this._evaluator.canonical=he,this._evaluator.availableImages=me||null,this._evaluator.formattedSection=Te||null;try{var Ie=this.expression.evaluate(this._evaluator);if(Ie==null||typeof Ie=="number"&&Ie!==Ie)return this._defaultValue;if(this._enumValues&&!(Ie in this._enumValues))throw new Bi("Expected value to be one of "+Object.keys(this._enumValues).map(function(qe){return JSON.stringify(qe)}).join(", ")+", but found "+JSON.stringify(Ie)+" instead.");return Ie}catch(qe){return this._warningHistory[qe.message]||(this._warningHistory[qe.message]=!0,typeof console!="undefined"&&console.warn(qe.message)),this._defaultValue}};function bo(E){return Array.isArray(E)&&E.length>0&&typeof E[0]=="string"&&E[0]in Zn}function Bl(E,C){var O=new Eo(Zn,[],C?gu(C):void 0),$=O.parse(E,void 0,void 0,void 0,C&&C.type==="string"?{typeAnnotation:"coerce"}:void 0);return $?bi(new us($,C)):Si(O.errors)}var Ql=function(C,O){this.kind=C,this._styleExpression=O,this.isStateDependent=C!=="constant"&&!sl(O.expression)};Ql.prototype.evaluateWithoutErrorHandling=function(C,O,$,he,me,Te){return this._styleExpression.evaluateWithoutErrorHandling(C,O,$,he,me,Te)},Ql.prototype.evaluate=function(C,O,$,he,me,Te){return this._styleExpression.evaluate(C,O,$,he,me,Te)};var fs=function(C,O,$,he){this.kind=C,this.zoomStops=$,this._styleExpression=O,this.isStateDependent=C!=="camera"&&!sl(O.expression),this.interpolationType=he};fs.prototype.evaluateWithoutErrorHandling=function(C,O,$,he,me,Te){return this._styleExpression.evaluateWithoutErrorHandling(C,O,$,he,me,Te)},fs.prototype.evaluate=function(C,O,$,he,me,Te){return this._styleExpression.evaluate(C,O,$,he,me,Te)},fs.prototype.interpolationFactor=function(C,O,$){return this.interpolationType?uo.interpolationFactor(this.interpolationType,C,O,$):0};function du(E,C){if(E=Bl(E,C),E.result==="error")return E;var O=E.value.expression,$=ol(O);if(!$&&!oi(C))return Si([new bn("","data expressions not supported")]);var he=Kl(O,["zoom"]);if(!he&&!xo(C))return Si([new bn("","zoom expressions not supported")]);var me=Pu(O);if(!me&&!he)return Si([new bn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(me instanceof bn)return Si([me]);if(me instanceof uo&&!to(C))return Si([new bn("",'"interpolate" expressions cannot be used with this property')]);if(!me)return bi($?new Ql("constant",E.value):new Ql("source",E.value));var Te=me instanceof uo?me.interpolation:void 0;return bi($?new fs("camera",E.value,me.labels,Te):new fs("composite",E.value,me.labels,Te))}var Nl=function(C,O){this._parameters=C,this._specification=O,hn(this,fo(this._parameters,this._specification))};Nl.deserialize=function(C){return new Nl(C._parameters,C._specification)},Nl.serialize=function(C){return{_parameters:C._parameters,_specification:C._specification}};function vf(E,C){if(pa(E))return new Nl(E,C);if(bo(E)){var O=du(E,C);if(O.result==="error")throw new Error(O.value.map(function(he){return he.key+": "+he.message}).join(", "));return O.value}else{var $=E;return typeof E=="string"&&C.type==="color"&&($=di.parse(E)),{kind:"constant",evaluate:function(){return $}}}}function Pu(E){var C=null;if(E instanceof Fs)C=Pu(E.result);else if(E instanceof is)for(var O=0,$=E.args;O<$.length;O+=1){var he=$[O];if(C=Pu(he),C)break}else(E instanceof Ms||E instanceof uo)&&E.input instanceof ko&&E.input.name==="zoom"&&(C=E);return C instanceof bn||E.eachChild(function(me){var Te=Pu(me);Te instanceof bn?C=Te:!C&&Te?C=new bn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):C&&Te&&C!==Te&&(C=new bn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),C}function gu(E){var C={color:On,string:Cr,number:dr,enum:Cr,boolean:dn,formatted:da,resolvedImage:ma};return E.type==="array"?la(C[E.value]||xn,E.length):C[E.type]}function Du(E){return E.type==="color"&&pa(E.default)?new di(0,0,0,0):E.type==="color"?di.parse(E.default)||null:E.default===void 0?null:E.default}function Es(E){var C=E.key,O=E.value,$=E.valueSpec||{},he=E.objectElementValidators||{},me=E.style,Te=E.styleSpec,Ie=[],qe=Ka(O);if(qe!=="object")return[new vr(C,O,"object expected, "+qe+" found")];for(var ut in O){var pt=ut.split(".")[0],Pt=$[pt]||$["*"],Jt=void 0;if(he[pt])Jt=he[pt];else if($[pt])Jt=pi;else if(he["*"])Jt=he["*"];else if($["*"])Jt=pi;else{Ie.push(new vr(C,O[ut],'unknown property "'+ut+'"'));continue}Ie=Ie.concat(Jt({key:(C&&C+".")+ut,value:O[ut],valueSpec:Pt,style:me,styleSpec:Te,object:O,objectKey:ut},O))}for(var Gt in $)he[Gt]||$[Gt].required&&$[Gt].default===void 0&&O[Gt]===void 0&&Ie.push(new vr(C,O,'missing required property "'+Gt+'"'));return Ie}function Xu(E){var C=E.value,O=E.valueSpec,$=E.style,he=E.styleSpec,me=E.key,Te=E.arrayElementValidator||pi;if(Ka(C)!=="array")return[new vr(me,C,"array expected, "+Ka(C)+" found")];if(O.length&&C.length!==O.length)return[new vr(me,C,"array length "+O.length+" expected, length "+C.length+" found")];if(O["min-length"]&&C.length<O["min-length"])return[new vr(me,C,"array length at least "+O["min-length"]+" expected, length "+C.length+" found")];var Ie={type:O.value,values:O.values};he.$version<7&&(Ie.function=O.function),Ka(O.value)==="object"&&(Ie=O.value);for(var qe=[],ut=0;ut<C.length;ut++)qe=qe.concat(Te({array:C,arrayIndex:ut,value:C[ut],valueSpec:Ie,style:$,styleSpec:he,key:me+"["+ut+"]"}));return qe}function Ru(E){var C=E.key,O=E.value,$=E.valueSpec,he=Ka(O);return he==="number"&&O!==O&&(he="NaN"),he!=="number"?[new vr(C,O,"number expected, "+he+" found")]:"minimum"in $&&O<$.minimum?[new vr(C,O,O+" is less than the minimum value "+$.minimum)]:"maximum"in $&&O>$.maximum?[new vr(C,O,O+" is greater than the maximum value "+$.maximum)]:[]}function Iu(E){var C=E.valueSpec,O=un(E.value.type),$,he={},me,Te,Ie=O!=="categorical"&&E.value.property===void 0,qe=!Ie,ut=Ka(E.value.stops)==="array"&&Ka(E.value.stops[0])==="array"&&Ka(E.value.stops[0][0])==="object",pt=Es({key:E.key,value:E.value,valueSpec:E.styleSpec.function,style:E.style,styleSpec:E.styleSpec,objectElementValidators:{stops:Pt,default:cr}});return O==="identity"&&Ie&&pt.push(new vr(E.key,E.value,'missing required property "property"')),O!=="identity"&&!E.value.stops&&pt.push(new vr(E.key,E.value,'missing required property "stops"')),O==="exponential"&&E.valueSpec.expression&&!to(E.valueSpec)&&pt.push(new vr(E.key,E.value,"exponential functions not supported")),E.styleSpec.$version>=8&&(qe&&!oi(E.valueSpec)?pt.push(new vr(E.key,E.value,"property functions not supported")):Ie&&!xo(E.valueSpec)&&pt.push(new vr(E.key,E.value,"zoom functions not supported"))),(O==="categorical"||ut)&&E.value.property===void 0&&pt.push(new vr(E.key,E.value,'"property" property is required')),pt;function Pt(Dr){if(O==="identity")return[new vr(Dr.key,Dr.value,'identity function may not have a "stops" property')];var en=[],Kr=Dr.value;return en=en.concat(Xu({key:Dr.key,value:Kr,valueSpec:Dr.valueSpec,style:Dr.style,styleSpec:Dr.styleSpec,arrayElementValidator:Jt})),Ka(Kr)==="array"&&Kr.length===0&&en.push(new vr(Dr.key,Kr,"array must have at least one stop")),en}function Jt(Dr){var en=[],Kr=Dr.value,Mn=Dr.key;if(Ka(Kr)!=="array")return[new vr(Mn,Kr,"array expected, "+Ka(Kr)+" found")];if(Kr.length!==2)return[new vr(Mn,Kr,"array length 2 expected, length "+Kr.length+" found")];if(ut){if(Ka(Kr[0])!=="object")return[new vr(Mn,Kr,"object expected, "+Ka(Kr[0])+" found")];if(Kr[0].zoom===void 0)return[new vr(Mn,Kr,"object stop key must have zoom")];if(Kr[0].value===void 0)return[new vr(Mn,Kr,"object stop key must have value")];if(Te&&Te>un(Kr[0].zoom))return[new vr(Mn,Kr[0].zoom,"stop zoom values must appear in ascending order")];un(Kr[0].zoom)!==Te&&(Te=un(Kr[0].zoom),me=void 0,he={}),en=en.concat(Es({key:Mn+"[0]",value:Kr[0],valueSpec:{zoom:{}},style:Dr.style,styleSpec:Dr.styleSpec,objectElementValidators:{zoom:Ru,value:Gt}}))}else en=en.concat(Gt({key:Mn+"[0]",value:Kr[0],valueSpec:{},style:Dr.style,styleSpec:Dr.styleSpec},Kr));return bo(kn(Kr[1]))?en.concat([new vr(Mn+"[1]",Kr[1],"expressions are not allowed in function stops.")]):en.concat(pi({key:Mn+"[1]",value:Kr[1],valueSpec:C,style:Dr.style,styleSpec:Dr.styleSpec}))}function Gt(Dr,en){var Kr=Ka(Dr.value),Mn=un(Dr.value),yn=Dr.value!==null?Dr.value:en;if(!$)$=Kr;else if(Kr!==$)return[new vr(Dr.key,yn,Kr+" stop domain type must match previous stop domain type "+$)];if(Kr!=="number"&&Kr!=="string"&&Kr!=="boolean")return[new vr(Dr.key,yn,"stop domain value must be a number, string, or boolean")];if(Kr!=="number"&&O!=="categorical"){var Tn="number expected, "+Kr+" found";return oi(C)&&O===void 0&&(Tn+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new vr(Dr.key,yn,Tn)]}return O==="categorical"&&Kr==="number"&&(!isFinite(Mn)||Math.floor(Mn)!==Mn)?[new vr(Dr.key,yn,"integer expected, found "+Mn)]:O!=="categorical"&&Kr==="number"&&me!==void 0&&Mn<me?[new vr(Dr.key,yn,"stop domain values must appear in ascending order")]:(me=Mn,O==="categorical"&&Mn in he?[new vr(Dr.key,yn,"stop domain values must be unique")]:(he[Mn]=!0,[]))}function cr(Dr){return pi({key:Dr.key,value:Dr.value,valueSpec:C,style:Dr.style,styleSpec:Dr.styleSpec})}}function Oo(E){var C=(E.expressionContext==="property"?du:Bl)(kn(E.value),E.valueSpec);if(C.result==="error")return C.value.map(function($){return new vr(""+E.key+$.key,E.value,$.message)});var O=C.value.expression||C.value._styleExpression.expression;if(E.expressionContext==="property"&&E.propertyKey==="text-font"&&!O.outputDefined())return[new vr(E.key,E.value,'Invalid data expression for "'+E.propertyKey+'". Output values must be contained as literals within the expression.')];if(E.expressionContext==="property"&&E.propertyType==="layout"&&!sl(O))return[new vr(E.key,E.value,'"feature-state" data expressions are not supported with layout properties.')];if(E.expressionContext==="filter"&&!sl(O))return[new vr(E.key,E.value,'"feature-state" data expressions are not supported with filters.')];if(E.expressionContext&&E.expressionContext.indexOf("cluster")===0){if(!Kl(O,["zoom","feature-state"]))return[new vr(E.key,E.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(E.expressionContext==="cluster-initial"&&!ol(O))return[new vr(E.key,E.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function zu(E){var C=E.value,O=E.key,$=Ka(C);return $!=="boolean"?[new vr(O,C,"boolean expected, "+$+" found")]:[]}function $u(E){var C=E.key,O=E.value,$=Ka(O);return $!=="string"?[new vr(C,O,"color expected, "+$+" found")]:Yl(O)===null?[new vr(C,O,'color expected, "'+O+'" found')]:[]}function xs(E){var C=E.key,O=E.value,$=E.valueSpec,he=[];return Array.isArray($.values)?$.values.indexOf(un(O))===-1&&he.push(new vr(C,O,"expected one of ["+$.values.join(", ")+"], "+JSON.stringify(O)+" found")):Object.keys($.values).indexOf(un(O))===-1&&he.push(new vr(C,O,"expected one of ["+Object.keys($.values).join(", ")+"], "+JSON.stringify(O)+" found")),he}function yu(E){if(E===!0||E===!1)return!0;if(!Array.isArray(E)||E.length===0)return!1;switch(E[0]){case"has":return E.length>=2&&E[1]!=="$id"&&E[1]!=="$type";case"in":return E.length>=3&&(typeof E[1]!="string"||Array.isArray(E[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return E.length!==3||Array.isArray(E[1])||Array.isArray(E[2]);case"any":case"all":for(var C=0,O=E.slice(1);C<O.length;C+=1){var $=O[C];if(!yu($)&&typeof $!="boolean")return!1}return!0;default:return!0}}var mu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Fu(E){if(E==null)return{filter:function(){return!0},needGeometry:!1};yu(E)||(E=et(E));var C=Bl(E,mu);if(C.result==="error")throw new Error(C.value.map(function($){return $.key+": "+$.message}).join(", "));var O=Ge(E);return{filter:function($,he,me){return C.value.evaluate($,he,{},me)},needGeometry:O}}function Re(E,C){return E<C?-1:E>C?1:0}function Ge(E){if(!Array.isArray(E))return!1;if(E[0]==="within")return!0;for(var C=1;C<E.length;C++)if(Ge(E[C]))return!0;return!1}function et(E){if(!E)return!0;var C=E[0];if(E.length<=1)return C!=="any";var O=C==="=="?it(E[1],E[2],"=="):C==="!="?ar(it(E[1],E[2],"==")):C==="<"||C===">"||C==="<="||C===">="?it(E[1],E[2],C):C==="any"?mt(E.slice(1)):C==="all"?["all"].concat(E.slice(1).map(et)):C==="none"?["all"].concat(E.slice(1).map(et).map(ar)):C==="in"?gt(E[1],E.slice(2)):C==="!in"?ar(gt(E[1],E.slice(2))):C==="has"?_t(E[1]):C==="!has"?ar(_t(E[1])):C==="within"?E:!0;return O}function it(E,C,O){switch(E){case"$type":return["filter-type-"+O,C];case"$id":return["filter-id-"+O,C];default:return["filter-"+O,E,C]}}function mt(E){return["any"].concat(E.map(et))}function gt(E,C){if(C.length===0)return!1;switch(E){case"$type":return["filter-type-in",["literal",C]];case"$id":return["filter-id-in",["literal",C]];default:return C.length>200&&!C.some(function(O){return typeof O!=typeof C[0]})?["filter-in-large",E,["literal",C.sort(Re)]]:["filter-in-small",E,["literal",C]]}}function _t(E){switch(E){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",E]}}function ar(E){return["!",E]}function fr(E){return yu(kn(E.value))?Oo(hn({},E,{expressionContext:"filter",valueSpec:{value:"boolean"}})):rr(E)}function rr(E){var C=E.value,O=E.key;if(Ka(C)!=="array")return[new vr(O,C,"array expected, "+Ka(C)+" found")];var $=E.styleSpec,he,me=[];if(C.length<1)return[new vr(O,C,"filter array must have at least 1 element")];switch(me=me.concat(xs({key:O+"[0]",value:C[0],valueSpec:$.filter_operator,style:E.style,styleSpec:E.styleSpec})),un(C[0])){case"<":case"<=":case">":case">=":C.length>=2&&un(C[1])==="$type"&&me.push(new vr(O,C,'"$type" cannot be use with operator "'+C[0]+'"'));case"==":case"!=":C.length!==3&&me.push(new vr(O,C,'filter array for operator "'+C[0]+'" must have 3 elements'));case"in":case"!in":C.length>=2&&(he=Ka(C[1]),he!=="string"&&me.push(new vr(O+"[1]",C[1],"string expected, "+he+" found")));for(var Te=2;Te<C.length;Te++)he=Ka(C[Te]),un(C[1])==="$type"?me=me.concat(xs({key:O+"["+Te+"]",value:C[Te],valueSpec:$.geometry_type,style:E.style,styleSpec:E.styleSpec})):he!=="string"&&he!=="number"&&he!=="boolean"&&me.push(new vr(O+"["+Te+"]",C[Te],"string, number, or boolean expected, "+he+" found"));break;case"any":case"all":case"none":for(var Ie=1;Ie<C.length;Ie++)me=me.concat(rr({key:O+"["+Ie+"]",value:C[Ie],style:E.style,styleSpec:E.styleSpec}));break;case"has":case"!has":he=Ka(C[1]),C.length!==2?me.push(new vr(O,C,'filter array for "'+C[0]+'" operator must have 2 elements')):he!=="string"&&me.push(new vr(O+"[1]",C[1],"string expected, "+he+" found"));break;case"within":he=Ka(C[1]),C.length!==2?me.push(new vr(O,C,'filter array for "'+C[0]+'" operator must have 2 elements')):he!=="object"&&me.push(new vr(O+"[1]",C[1],"object expected, "+he+" found"));break}return me}function pr(E,C){var O=E.key,$=E.style,he=E.styleSpec,me=E.value,Te=E.objectKey,Ie=he[C+"_"+E.layerType];if(!Ie)return[];var qe=Te.match(/^(.*)-transition$/);if(C==="paint"&&qe&&Ie[qe[1]]&&Ie[qe[1]].transition)return pi({key:O,value:me,valueSpec:he.transition,style:$,styleSpec:he});var ut=E.valueSpec||Ie[Te];if(!ut)return[new vr(O,me,'unknown property "'+Te+'"')];var pt;if(Ka(me)==="string"&&oi(ut)&&!ut.tokens&&(pt=/^{([^}]+)}$/.exec(me)))return[new vr(O,me,'"'+Te+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(pt[1])+" }`.")];var Pt=[];return E.layerType==="symbol"&&(Te==="text-field"&&$&&!$.glyphs&&Pt.push(new vr(O,me,'use of "text-field" requires a style "glyphs" property')),Te==="text-font"&&pa(kn(me))&&un(me.type)==="identity"&&Pt.push(new vr(O,me,'"text-font" does not support identity functions'))),Pt.concat(pi({key:E.key,value:me,valueSpec:ut,style:$,styleSpec:he,expressionContext:"property",propertyType:C,propertyKey:Te}))}function kr(E){return pr(E,"paint")}function Hr(E){return pr(E,"layout")}function Qr(E){var C=[],O=E.value,$=E.key,he=E.style,me=E.styleSpec;!O.type&&!O.ref&&C.push(new vr($,O,'either "type" or "ref" is required'));var Te=un(O.type),Ie=un(O.ref);if(O.id)for(var qe=un(O.id),ut=0;ut<E.arrayIndex;ut++){var pt=he.layers[ut];un(pt.id)===qe&&C.push(new vr($,O.id,'duplicate layer id "'+O.id+'", previously used at line '+pt.id.__line__))}if("ref"in O){["type","source","source-layer","filter","layout"].forEach(function(cr){cr in O&&C.push(new vr($,O[cr],'"'+cr+'" is prohibited for ref layers'))});var Pt;he.layers.forEach(function(cr){un(cr.id)===Ie&&(Pt=cr)}),Pt?Pt.ref?C.push(new vr($,O.ref,"ref cannot reference another ref layer")):Te=un(Pt.type):C.push(new vr($,O.ref,'ref layer "'+Ie+'" not found'))}else if(Te!=="background")if(!O.source)C.push(new vr($,O,'missing required property "source"'));else{var Jt=he.sources&&he.sources[O.source],Gt=Jt&&un(Jt.type);Jt?Gt==="vector"&&Te==="raster"?C.push(new vr($,O.source,'layer "'+O.id+'" requires a raster source')):Gt==="raster"&&Te!=="raster"?C.push(new vr($,O.source,'layer "'+O.id+'" requires a vector source')):Gt==="vector"&&!O["source-layer"]?C.push(new vr($,O,'layer "'+O.id+'" must specify a "source-layer"')):Gt==="raster-dem"&&Te!=="hillshade"?C.push(new vr($,O.source,"raster-dem source can only be used with layer type 'hillshade'.")):Te==="line"&&O.paint&&O.paint["line-gradient"]&&(Gt!=="geojson"||!Jt.lineMetrics)&&C.push(new vr($,O,'layer "'+O.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):C.push(new vr($,O.source,'source "'+O.source+'" not found'))}return C=C.concat(Es({key:$,value:O,valueSpec:me.layer,style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return pi({key:$+".type",value:O.type,valueSpec:me.layer.type,style:E.style,styleSpec:E.styleSpec,object:O,objectKey:"type"})},filter:fr,layout:function(Dr){return Es({layer:O,key:Dr.key,value:Dr.value,style:Dr.style,styleSpec:Dr.styleSpec,objectElementValidators:{"*":function(Kr){return Hr(hn({layerType:Te},Kr))}}})},paint:function(Dr){return Es({layer:O,key:Dr.key,value:Dr.value,style:Dr.style,styleSpec:Dr.styleSpec,objectElementValidators:{"*":function(Kr){return kr(hn({layerType:Te},Kr))}}})}}})),C}function mn(E){var C=E.value,O=E.key,$=Ka(C);return $!=="string"?[new vr(O,C,"string expected, "+$+" found")]:[]}var Ln={promoteId:ga};function Gn(E){var C=E.value,O=E.key,$=E.styleSpec,he=E.style;if(!C.type)return[new vr(O,C,'"type" is required')];var me=un(C.type),Te;switch(me){case"vector":case"raster":case"raster-dem":return Te=Es({key:O,value:C,valueSpec:$["source_"+me.replace("-","_")],style:E.style,styleSpec:$,objectElementValidators:Ln}),Te;case"geojson":if(Te=Es({key:O,value:C,valueSpec:$.source_geojson,style:he,styleSpec:$,objectElementValidators:Ln}),C.cluster)for(var Ie in C.clusterProperties){var qe=C.clusterProperties[Ie],ut=qe[0],pt=qe[1],Pt=typeof ut=="string"?[ut,["accumulated"],["get",Ie]]:ut;Te.push.apply(Te,Oo({key:O+"."+Ie+".map",value:pt,expressionContext:"cluster-map"})),Te.push.apply(Te,Oo({key:O+"."+Ie+".reduce",value:Pt,expressionContext:"cluster-reduce"}))}return Te;case"video":return Es({key:O,value:C,valueSpec:$.source_video,style:he,styleSpec:$});case"image":return Es({key:O,value:C,valueSpec:$.source_image,style:he,styleSpec:$});case"canvas":return[new vr(O,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return xs({key:O+".type",value:C.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:he,styleSpec:$})}}function ga(E){var C=E.key,O=E.value;if(Ka(O)==="string")return mn({key:C,value:O});var $=[];for(var he in O)$.push.apply($,mn({key:C+"."+he,value:O[he]}));return $}function xa(E){var C=E.value,O=E.styleSpec,$=O.light,he=E.style,me=[],Te=Ka(C);if(C===void 0)return me;if(Te!=="object")return me=me.concat([new vr("light",C,"object expected, "+Te+" found")]),me;for(var Ie in C){var qe=Ie.match(/^(.*)-transition$/);qe&&$[qe[1]]&&$[qe[1]].transition?me=me.concat(pi({key:Ie,value:C[Ie],valueSpec:O.transition,style:he,styleSpec:O})):$[Ie]?me=me.concat(pi({key:Ie,value:C[Ie],valueSpec:$[Ie],style:he,styleSpec:O})):me=me.concat([new vr(Ie,C[Ie],'unknown property "'+Ie+'"')])}return me}function ja(E){return mn(E).length===0?[]:Oo(E)}function Wa(E){return mn(E).length===0?[]:Oo(E)}var qa={"*":function(){return[]},array:Xu,boolean:zu,number:Ru,color:$u,constants:rn,enum:xs,filter:fr,function:Iu,layer:Qr,object:Es,source:Gn,light:xa,string:mn,formatted:ja,resolvedImage:Wa};function pi(E){var C=E.value,O=E.valueSpec,$=E.styleSpec;if(O.expression&&pa(un(C)))return Iu(E);if(O.expression&&bo(kn(C)))return Oo(E);if(O.type&&qa[O.type])return qa[O.type](E);var he=Es(hn({},E,{valueSpec:O.type?$[O.type]:O}));return he}function oo(E){var C=E.value,O=E.key,$=mn(E);return $.length||(C.indexOf("{fontstack}")===-1&&$.push(new vr(O,C,'"glyphs" url must include a "{fontstack}" token')),C.indexOf("{range}")===-1&&$.push(new vr(O,C,'"glyphs" url must include a "{range}" token'))),$}function ti(E,C){C===void 0&&(C=It);var O=[];return O=O.concat(pi({key:"",value:E,valueSpec:C.$root,styleSpec:C,style:E,objectElementValidators:{glyphs:oo,"*":function(){return[]}}})),E.constants&&(O=O.concat(rn({key:"constants",value:E.constants,style:E,styleSpec:C}))),Yi(O)}ti.source=co(Gn),ti.light=co(xa),ti.layer=co(Qr),ti.filter=co(fr),ti.paintProperty=co(kr),ti.layoutProperty=co(Hr);function Yi(E){return[].concat(E).sort(function(C,O){return C.line-O.line})}function co(E){return function(){for(var C=[],O=arguments.length;O--;)C[O]=arguments[O];return Yi(E.apply(this,C))}}var wo=ti,wi=wo.light,ki=wo.paintProperty,cs=wo.layoutProperty;function yo(E,C){var O=!1;if(C&&C.length)for(var $=0,he=C;$<he.length;$+=1){var me=he[$];E.fire(new Rr(new Error(me.message))),O=!0}return O}var Do=ue,Yo=3;function ue(E,C,O){var $=this.cells=[];if(E instanceof ArrayBuffer){this.arrayBuffer=E;var he=new Int32Array(this.arrayBuffer);E=he[0],C=he[1],O=he[2],this.d=C+2*O;for(var me=0;me<this.d*this.d;me++){var Te=he[Yo+me],Ie=he[Yo+me+1];$.push(Te===Ie?null:he.subarray(Te,Ie))}var qe=he[Yo+$.length],ut=he[Yo+$.length+1];this.keys=he.subarray(qe,ut),this.bboxes=he.subarray(ut),this.insert=this._insertReadonly}else{this.d=C+2*O;for(var pt=0;pt<this.d*this.d;pt++)$.push([]);this.keys=[],this.bboxes=[]}this.n=C,this.extent=E,this.padding=O,this.scale=C/E,this.uid=0;var Pt=O/C*E;this.min=-Pt,this.max=E+Pt}ue.prototype.insert=function(E,C,O,$,he){this._forEachCell(C,O,$,he,this._insertCell,this.uid++),this.keys.push(E),this.bboxes.push(C),this.bboxes.push(O),this.bboxes.push($),this.bboxes.push(he)},ue.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ue.prototype._insertCell=function(E,C,O,$,he,me){this.cells[he].push(me)},ue.prototype.query=function(E,C,O,$,he){var me=this.min,Te=this.max;if(E<=me&&C<=me&&Te<=O&&Te<=$&&!he)return Array.prototype.slice.call(this.keys);var Ie=[],qe={};return this._forEachCell(E,C,O,$,this._queryCell,Ie,qe,he),Ie},ue.prototype._queryCell=function(E,C,O,$,he,me,Te,Ie){var qe=this.cells[he];if(qe!==null)for(var ut=this.keys,pt=this.bboxes,Pt=0;Pt<qe.length;Pt++){var Jt=qe[Pt];if(Te[Jt]===void 0){var Gt=Jt*4;(Ie?Ie(pt[Gt+0],pt[Gt+1],pt[Gt+2],pt[Gt+3]):E<=pt[Gt+2]&&C<=pt[Gt+3]&&O>=pt[Gt+0]&&$>=pt[Gt+1])?(Te[Jt]=!0,me.push(ut[Jt])):Te[Jt]=!1}}},ue.prototype._forEachCell=function(E,C,O,$,he,me,Te,Ie){for(var qe=this._convertToCellCoord(E),ut=this._convertToCellCoord(C),pt=this._convertToCellCoord(O),Pt=this._convertToCellCoord($),Jt=qe;Jt<=pt;Jt++)for(var Gt=ut;Gt<=Pt;Gt++){var cr=this.d*Gt+Jt;if(!(Ie&&!Ie(this._convertFromCellCoord(Jt),this._convertFromCellCoord(Gt),this._convertFromCellCoord(Jt+1),this._convertFromCellCoord(Gt+1)))&&he.call(this,E,C,O,$,cr,me,Te,Ie))return}},ue.prototype._convertFromCellCoord=function(E){return(E-this.padding)/this.scale},ue.prototype._convertToCellCoord=function(E){return Math.max(0,Math.min(this.d-1,Math.floor(E*this.scale)+this.padding))},ue.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var E=this.cells,C=Yo+this.cells.length+1+1,O=0,$=0;$<this.cells.length;$++)O+=this.cells[$].length;var he=new Int32Array(C+O+this.keys.length+this.bboxes.length);he[0]=this.extent,he[1]=this.n,he[2]=this.padding;for(var me=C,Te=0;Te<E.length;Te++){var Ie=E[Te];he[Yo+Te]=me,he.set(Ie,me),me+=Ie.length}return he[Yo+E.length]=me,he.set(this.keys,me),me+=this.keys.length,he[Yo+E.length+1]=me,he.set(this.bboxes,me),me+=this.bboxes.length,he.buffer};var be=self.ImageData,Ee=self.ImageBitmap,Fe={};function ze(E,C,O){O===void 0&&(O={}),Object.defineProperty(C,"_classRegistryKey",{value:E,writeable:!1}),Fe[E]={klass:C,omit:O.omit||[],shallow:O.shallow||[]}}ze("Object",Object),Do.serialize=function(C,O){var $=C.toArrayBuffer();return O&&O.push($),{buffer:$}},Do.deserialize=function(C){return new Do(C.buffer)},ze("Grid",Do),ze("Color",di),ze("Error",Error),ze("ResolvedImage",So),ze("StylePropertyFunction",Nl),ze("StyleExpression",us,{omit:["_evaluator"]}),ze("ZoomDependentExpression",fs),ze("ZoomConstantExpression",Ql),ze("CompoundExpression",ko,{omit:["_evaluate"]});for(var Ze in Zn)Zn[Ze]._classRegistryKey||ze("Expression_"+Ze,Zn[Ze]);function yt(E){return E&&typeof ArrayBuffer!="undefined"&&(E instanceof ArrayBuffer||E.constructor&&E.constructor.name==="ArrayBuffer")}function ft(E){return Ee&&E instanceof Ee}function St(E,C){if(E==null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"||E instanceof Boolean||E instanceof Number||E instanceof String||E instanceof Date||E instanceof RegExp)return E;if(yt(E)||ft(E))return C&&C.push(E),E;if(ArrayBuffer.isView(E)){var O=E;return C&&C.push(O.buffer),O}if(E instanceof be)return C&&C.push(E.data.buffer),E;if(Array.isArray(E)){for(var $=[],he=0,me=E;he<me.length;he+=1){var Te=me[he];$.push(St(Te,C))}return $}if(typeof E=="object"){var Ie=E.constructor,qe=Ie._classRegistryKey;if(!qe)throw new Error("can't serialize object of unregistered class");var ut=Ie.serialize?Ie.serialize(E,C):{};if(!Ie.serialize){for(var pt in E)if(!!E.hasOwnProperty(pt)&&!(Fe[qe].omit.indexOf(pt)>=0)){var Pt=E[pt];ut[pt]=Fe[qe].shallow.indexOf(pt)>=0?Pt:St(Pt,C)}E instanceof Error&&(ut.message=E.message)}if(ut.$name)throw new Error("$name property is reserved for worker serialization logic.");return qe!=="Object"&&(ut.$name=qe),ut}throw new Error("can't serialize object of type "+typeof E)}function Nt(E){if(E==null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"||E instanceof Boolean||E instanceof Number||E instanceof String||E instanceof Date||E instanceof RegExp||yt(E)||ft(E)||ArrayBuffer.isView(E)||E instanceof be)return E;if(Array.isArray(E))return E.map(Nt);if(typeof E=="object"){var C=E.$name||"Object",O=Fe[C],$=O.klass;if(!$)throw new Error("can't deserialize unregistered class "+C);if($.deserialize)return $.deserialize(E);for(var he=Object.create($.prototype),me=0,Te=Object.keys(E);me<Te.length;me+=1){var Ie=Te[me];if(Ie!=="$name"){var qe=E[Ie];he[Ie]=Fe[C].shallow.indexOf(Ie)>=0?qe:Nt(qe)}}return he}throw new Error("can't deserialize object of type "+typeof E)}var Xt=function(){this.first=!0};Xt.prototype.update=function(C,O){var $=Math.floor(C);return this.first?(this.first=!1,this.lastIntegerZoom=$,this.lastIntegerZoomTime=0,this.lastZoom=C,this.lastFloorZoom=$,!0):(this.lastFloorZoom>$?(this.lastIntegerZoom=$+1,this.lastIntegerZoomTime=O):this.lastFloorZoom<$&&(this.lastIntegerZoom=$,this.lastIntegerZoomTime=O),C!==this.lastZoom?(this.lastZoom=C,this.lastFloorZoom=$,!0):!1)};var Kt={"Latin-1 Supplement":function(E){return E>=128&&E<=255},Arabic:function(E){return E>=1536&&E<=1791},"Arabic Supplement":function(E){return E>=1872&&E<=1919},"Arabic Extended-A":function(E){return E>=2208&&E<=2303},"Hangul Jamo":function(E){return E>=4352&&E<=4607},"Unified Canadian Aboriginal Syllabics":function(E){return E>=5120&&E<=5759},Khmer:function(E){return E>=6016&&E<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(E){return E>=6320&&E<=6399},"General Punctuation":function(E){return E>=8192&&E<=8303},"Letterlike Symbols":function(E){return E>=8448&&E<=8527},"Number Forms":function(E){return E>=8528&&E<=8591},"Miscellaneous Technical":function(E){return E>=8960&&E<=9215},"Control Pictures":function(E){return E>=9216&&E<=9279},"Optical Character Recognition":function(E){return E>=9280&&E<=9311},"Enclosed Alphanumerics":function(E){return E>=9312&&E<=9471},"Geometric Shapes":function(E){return E>=9632&&E<=9727},"Miscellaneous Symbols":function(E){return E>=9728&&E<=9983},"Miscellaneous Symbols and Arrows":function(E){return E>=11008&&E<=11263},"CJK Radicals Supplement":function(E){return E>=11904&&E<=12031},"Kangxi Radicals":function(E){return E>=12032&&E<=12255},"Ideographic Description Characters":function(E){return E>=12272&&E<=12287},"CJK Symbols and Punctuation":function(E){return E>=12288&&E<=12351},Hiragana:function(E){return E>=12352&&E<=12447},Katakana:function(E){return E>=12448&&E<=12543},Bopomofo:function(E){return E>=12544&&E<=12591},"Hangul Compatibility Jamo":function(E){return E>=12592&&E<=12687},Kanbun:function(E){return E>=12688&&E<=12703},"Bopomofo Extended":function(E){return E>=12704&&E<=12735},"CJK Strokes":function(E){return E>=12736&&E<=12783},"Katakana Phonetic Extensions":function(E){return E>=12784&&E<=12799},"Enclosed CJK Letters and Months":function(E){return E>=12800&&E<=13055},"CJK Compatibility":function(E){return E>=13056&&E<=13311},"CJK Unified Ideographs Extension A":function(E){return E>=13312&&E<=19903},"Yijing Hexagram Symbols":function(E){return E>=19904&&E<=19967},"CJK Unified Ideographs":function(E){return E>=19968&&E<=40959},"Yi Syllables":function(E){return E>=40960&&E<=42127},"Yi Radicals":function(E){return E>=42128&&E<=42191},"Hangul Jamo Extended-A":function(E){return E>=43360&&E<=43391},"Hangul Syllables":function(E){return E>=44032&&E<=55215},"Hangul Jamo Extended-B":function(E){return E>=55216&&E<=55295},"Private Use Area":function(E){return E>=57344&&E<=63743},"CJK Compatibility Ideographs":function(E){return E>=63744&&E<=64255},"Arabic Presentation Forms-A":function(E){return E>=64336&&E<=65023},"Vertical Forms":function(E){return E>=65040&&E<=65055},"CJK Compatibility Forms":function(E){return E>=65072&&E<=65103},"Small Form Variants":function(E){return E>=65104&&E<=65135},"Arabic Presentation Forms-B":function(E){return E>=65136&&E<=65279},"Halfwidth and Fullwidth Forms":function(E){return E>=65280&&E<=65519}};function br(E){for(var C=0,O=E;C<O.length;C+=1){var $=O[C];if(zr($.charCodeAt(0)))return!0}return!1}function Zr(E){for(var C=0,O=E;C<O.length;C+=1){var $=O[C];if(!nn($.charCodeAt(0)))return!1}return!0}function nn(E){return!(Kt.Arabic(E)||Kt["Arabic Supplement"](E)||Kt["Arabic Extended-A"](E)||Kt["Arabic Presentation Forms-A"](E)||Kt["Arabic Presentation Forms-B"](E))}function Mr(E){return E<11904?!1:!!(Kt["Bopomofo Extended"](E)||Kt.Bopomofo(E)||Kt["CJK Compatibility Forms"](E)||Kt["CJK Compatibility Ideographs"](E)||Kt["CJK Compatibility"](E)||Kt["CJK Radicals Supplement"](E)||Kt["CJK Strokes"](E)||Kt["CJK Symbols and Punctuation"](E)||Kt["CJK Unified Ideographs Extension A"](E)||Kt["CJK Unified Ideographs"](E)||Kt["Enclosed CJK Letters and Months"](E)||Kt["Halfwidth and Fullwidth Forms"](E)||Kt.Hiragana(E)||Kt["Ideographic Description Characters"](E)||Kt["Kangxi Radicals"](E)||Kt["Katakana Phonetic Extensions"](E)||Kt.Katakana(E)||Kt["Vertical Forms"](E)||Kt["Yi Radicals"](E)||Kt["Yi Syllables"](E))}function zr(E){return E===746||E===747?!0:E<4352?!1:!!(Kt["Bopomofo Extended"](E)||Kt.Bopomofo(E)||Kt["CJK Compatibility Forms"](E)&&!(E>=65097&&E<=65103)||Kt["CJK Compatibility Ideographs"](E)||Kt["CJK Compatibility"](E)||Kt["CJK Radicals Supplement"](E)||Kt["CJK Strokes"](E)||Kt["CJK Symbols and Punctuation"](E)&&!(E>=12296&&E<=12305)&&!(E>=12308&&E<=12319)&&E!==12336||Kt["CJK Unified Ideographs Extension A"](E)||Kt["CJK Unified Ideographs"](E)||Kt["Enclosed CJK Letters and Months"](E)||Kt["Hangul Compatibility Jamo"](E)||Kt["Hangul Jamo Extended-A"](E)||Kt["Hangul Jamo Extended-B"](E)||Kt["Hangul Jamo"](E)||Kt["Hangul Syllables"](E)||Kt.Hiragana(E)||Kt["Ideographic Description Characters"](E)||Kt.Kanbun(E)||Kt["Kangxi Radicals"](E)||Kt["Katakana Phonetic Extensions"](E)||Kt.Katakana(E)&&E!==12540||Kt["Halfwidth and Fullwidth Forms"](E)&&E!==65288&&E!==65289&&E!==65293&&!(E>=65306&&E<=65310)&&E!==65339&&E!==65341&&E!==65343&&!(E>=65371&&E<=65503)&&E!==65507&&!(E>=65512&&E<=65519)||Kt["Small Form Variants"](E)&&!(E>=65112&&E<=65118)&&!(E>=65123&&E<=65126)||Kt["Unified Canadian Aboriginal Syllabics"](E)||Kt["Unified Canadian Aboriginal Syllabics Extended"](E)||Kt["Vertical Forms"](E)||Kt["Yijing Hexagram Symbols"](E)||Kt["Yi Syllables"](E)||Kt["Yi Radicals"](E))}function Gr(E){return!!(Kt["Latin-1 Supplement"](E)&&(E===167||E===169||E===174||E===177||E===188||E===189||E===190||E===215||E===247)||Kt["General Punctuation"](E)&&(E===8214||E===8224||E===8225||E===8240||E===8241||E===8251||E===8252||E===8258||E===8263||E===8264||E===8265||E===8273)||Kt["Letterlike Symbols"](E)||Kt["Number Forms"](E)||Kt["Miscellaneous Technical"](E)&&(E>=8960&&E<=8967||E>=8972&&E<=8991||E>=8996&&E<=9e3||E===9003||E>=9085&&E<=9114||E>=9150&&E<=9165||E===9167||E>=9169&&E<=9179||E>=9186&&E<=9215)||Kt["Control Pictures"](E)&&E!==9251||Kt["Optical Character Recognition"](E)||Kt["Enclosed Alphanumerics"](E)||Kt["Geometric Shapes"](E)||Kt["Miscellaneous Symbols"](E)&&!(E>=9754&&E<=9759)||Kt["Miscellaneous Symbols and Arrows"](E)&&(E>=11026&&E<=11055||E>=11088&&E<=11097||E>=11192&&E<=11243)||Kt["CJK Symbols and Punctuation"](E)||Kt.Katakana(E)||Kt["Private Use Area"](E)||Kt["CJK Compatibility Forms"](E)||Kt["Small Form Variants"](E)||Kt["Halfwidth and Fullwidth Forms"](E)||E===8734||E===8756||E===8757||E>=9984&&E<=10087||E>=10102&&E<=10131||E===65532||E===65533)}function qr(E){return!(zr(E)||Gr(E))}function tn(E){return Kt.Arabic(E)||Kt["Arabic Supplement"](E)||Kt["Arabic Extended-A"](E)||Kt["Arabic Presentation Forms-A"](E)||Kt["Arabic Presentation Forms-B"](E)}function Yr(E){return E>=1424&&E<=2303||Kt["Arabic Presentation Forms-A"](E)||Kt["Arabic Presentation Forms-B"](E)}function Un(E,C){return!(!C&&Yr(E)||E>=2304&&E<=3583||E>=3840&&E<=4255||Kt.Khmer(E))}function ta(E){for(var C=0,O=E;C<O.length;C+=1){var $=O[C];if(Yr($.charCodeAt(0)))return!0}return!1}function _a(E,C){for(var O=0,$=E;O<$.length;O+=1){var he=$[O];if(!Un(he.charCodeAt(0),C))return!1}return!0}var ia={unavailable:"unavailable",deferred:"deferred",loading:"loading",loaded:"loaded",error:"error"},ka=null,ua=ia.unavailable,Na=null,Pa=function(E){E&&typeof E=="string"&&E.indexOf("NetworkError")>-1&&(ua=ia.error),ka&&ka(E)};function Qa(){xi.fire(new an("pluginStateChange",{pluginStatus:ua,pluginURL:Na}))}var xi=new Vr,ho=function(){return ua},Fi=function(E){return E({pluginStatus:ua,pluginURL:Na}),xi.on("pluginStateChange",E),E},fa=function(E,C,O){if(O===void 0&&(O=!1),ua===ia.deferred||ua===ia.loading||ua===ia.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Na=Z.resolveURL(E),ua=ia.deferred,ka=C,Qa(),O||ni()},ni=function(){if(ua!==ia.deferred||!Na)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ua=ia.loading,Qa(),Na&&Ne({url:Na},function(E){E?Pa(E):(ua=ia.loaded,Qa())})},Xa={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return ua===ia.loaded||Xa.applyArabicShaping!=null},isLoading:function(){return ua===ia.loading},setState:function(C){ua=C.pluginStatus,Na=C.pluginURL},isParsed:function(){return Xa.applyArabicShaping!=null&&Xa.processBidirectionalText!=null&&Xa.processStyledBidirectionalText!=null},getPluginURL:function(){return Na}},Ei=function(){!Xa.isLoading()&&!Xa.isLoaded()&&ho()==="deferred"&&ni()},si=function(C,O){this.zoom=C,O?(this.now=O.now,this.fadeDuration=O.fadeDuration,this.zoomHistory=O.zoomHistory,this.transition=O.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Xt,this.transition={})};si.prototype.isSupportedScript=function(C){return _a(C,Xa.isLoaded())},si.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},si.prototype.getCrossfadeParameters=function(){var C=this.zoom,O=C-Math.floor(C),$=this.crossFadingFactor();return C>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:O+(1-O)*$}:{fromScale:.5,toScale:1,t:1-(1-$)*O}};var so=function(C,O){this.property=C,this.value=O,this.expression=vf(O===void 0?C.specification.default:O,C.specification)};so.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},so.prototype.possiblyEvaluate=function(C,O,$){return this.property.possiblyEvaluate(this,C,O,$)};var qi=function(C){this.property=C,this.value=new so(C,void 0)};qi.prototype.transitioned=function(C,O){return new Wo(this.property,this.value,O,A({},C.transition,this.transition),C.now)},qi.prototype.untransitioned=function(){return new Wo(this.property,this.value,null,{},0)};var mo=function(C){this._properties=C,this._values=Object.create(C.defaultTransitionablePropertyValues)};mo.prototype.getValue=function(C){return I(this._values[C].value.value)},mo.prototype.setValue=function(C,O){this._values.hasOwnProperty(C)||(this._values[C]=new qi(this._values[C].property)),this._values[C].value=new so(this._values[C].property,O===null?void 0:I(O))},mo.prototype.getTransition=function(C){return I(this._values[C].transition)},mo.prototype.setTransition=function(C,O){this._values.hasOwnProperty(C)||(this._values[C]=new qi(this._values[C].property)),this._values[C].transition=I(O)||void 0},mo.prototype.serialize=function(){for(var C={},O=0,$=Object.keys(this._values);O<$.length;O+=1){var he=$[O],me=this.getValue(he);me!==void 0&&(C[he]=me);var Te=this.getTransition(he);Te!==void 0&&(C[he+"-transition"]=Te)}return C},mo.prototype.transitioned=function(C,O){for(var $=new Bo(this._properties),he=0,me=Object.keys(this._values);he<me.length;he+=1){var Te=me[he];$._values[Te]=this._values[Te].transitioned(C,O._values[Te])}return $},mo.prototype.untransitioned=function(){for(var C=new Bo(this._properties),O=0,$=Object.keys(this._values);O<$.length;O+=1){var he=$[O];C._values[he]=this._values[he].untransitioned()}return C};var Wo=function(C,O,$,he,me){this.property=C,this.value=O,this.begin=me+he.delay||0,this.end=this.begin+he.duration||0,C.specification.transition&&(he.delay||he.duration)&&(this.prior=$)};Wo.prototype.possiblyEvaluate=function(C,O,$){var he=C.now||0,me=this.value.possiblyEvaluate(C,O,$),Te=this.prior;if(Te){if(he>this.end)return this.prior=null,me;if(this.value.isDataDriven())return this.prior=null,me;if(he<this.begin)return Te.possiblyEvaluate(C,O,$);var Ie=(he-this.begin)/(this.end-this.begin);return this.property.interpolate(Te.possiblyEvaluate(C,O,$),me,g(Ie))}else return me};var Bo=function(C){this._properties=C,this._values=Object.create(C.defaultTransitioningPropertyValues)};Bo.prototype.possiblyEvaluate=function(C,O,$){for(var he=new Ui(this._properties),me=0,Te=Object.keys(this._values);me<Te.length;me+=1){var Ie=Te[me];he._values[Ie]=this._values[Ie].possiblyEvaluate(C,O,$)}return he},Bo.prototype.hasTransition=function(){for(var C=0,O=Object.keys(this._values);C<O.length;C+=1){var $=O[C];if(this._values[$].prior)return!0}return!1};var Xo=function(C){this._properties=C,this._values=Object.create(C.defaultPropertyValues)};Xo.prototype.getValue=function(C){return I(this._values[C].value)},Xo.prototype.setValue=function(C,O){this._values[C]=new so(this._values[C].property,O===null?void 0:I(O))},Xo.prototype.serialize=function(){for(var C={},O=0,$=Object.keys(this._values);O<$.length;O+=1){var he=$[O],me=this.getValue(he);me!==void 0&&(C[he]=me)}return C},Xo.prototype.possiblyEvaluate=function(C,O,$){for(var he=new Ui(this._properties),me=0,Te=Object.keys(this._values);me<Te.length;me+=1){var Ie=Te[me];he._values[Ie]=this._values[Ie].possiblyEvaluate(C,O,$)}return he};var Wi=function(C,O,$){this.property=C,this.value=O,this.parameters=$};Wi.prototype.isConstant=function(){return this.value.kind==="constant"},Wi.prototype.constantOr=function(C){return this.value.kind==="constant"?this.value.value:C},Wi.prototype.evaluate=function(C,O,$,he){return this.property.evaluate(this.value,this.parameters,C,O,$,he)};var Ui=function(C){this._properties=C,this._values=Object.create(C.defaultPossiblyEvaluatedValues)};Ui.prototype.get=function(C){return this._values[C]};var Ia=function(C){this.specification=C};Ia.prototype.possiblyEvaluate=function(C,O){return C.expression.evaluate(O)},Ia.prototype.interpolate=function(C,O,$){var he=Zs[this.specification.type];return he?he(C,O,$):C};var Za=function(C,O){this.specification=C,this.overrides=O};Za.prototype.possiblyEvaluate=function(C,O,$,he){return C.expression.kind==="constant"||C.expression.kind==="camera"?new Wi(this,{kind:"constant",value:C.expression.evaluate(O,null,{},$,he)},O):new Wi(this,C.expression,O)},Za.prototype.interpolate=function(C,O,$){if(C.value.kind!=="constant"||O.value.kind!=="constant")return C;if(C.value.value===void 0||O.value.value===void 0)return new Wi(this,{kind:"constant",value:void 0},C.parameters);var he=Zs[this.specification.type];return he?new Wi(this,{kind:"constant",value:he(C.value.value,O.value.value,$)},C.parameters):C},Za.prototype.evaluate=function(C,O,$,he,me,Te){return C.kind==="constant"?C.value:C.evaluate(O,$,he,me,Te)};var _o=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.possiblyEvaluate=function($,he,me,Te){if($.value===void 0)return new Wi(this,{kind:"constant",value:void 0},he);if($.expression.kind==="constant"){var Ie=$.expression.evaluate(he,null,{},me,Te),qe=$.property.specification.type==="resolvedImage",ut=qe&&typeof Ie!="string"?Ie.name:Ie,pt=this._calculate(ut,ut,ut,he);return new Wi(this,{kind:"constant",value:pt},he)}else if($.expression.kind==="camera"){var Pt=this._calculate($.expression.evaluate({zoom:he.zoom-1}),$.expression.evaluate({zoom:he.zoom}),$.expression.evaluate({zoom:he.zoom+1}),he);return new Wi(this,{kind:"constant",value:Pt},he)}else return new Wi(this,$.expression,he)},C.prototype.evaluate=function($,he,me,Te,Ie,qe){if($.kind==="source"){var ut=$.evaluate(he,me,Te,Ie,qe);return this._calculate(ut,ut,ut,he)}else return $.kind==="composite"?this._calculate($.evaluate({zoom:Math.floor(he.zoom)-1},me,Te),$.evaluate({zoom:Math.floor(he.zoom)},me,Te),$.evaluate({zoom:Math.floor(he.zoom)+1},me,Te),he):$.value},C.prototype._calculate=function($,he,me,Te){var Ie=Te.zoom;return Ie>Te.zoomHistory.lastIntegerZoom?{from:$,to:he}:{from:me,to:he}},C.prototype.interpolate=function($){return $},C}(Za),ro=function(C){this.specification=C};ro.prototype.possiblyEvaluate=function(C,O,$,he){if(C.value!==void 0)if(C.expression.kind==="constant"){var me=C.expression.evaluate(O,null,{},$,he);return this._calculate(me,me,me,O)}else return this._calculate(C.expression.evaluate(new si(Math.floor(O.zoom-1),O)),C.expression.evaluate(new si(Math.floor(O.zoom),O)),C.expression.evaluate(new si(Math.floor(O.zoom+1),O)),O)},ro.prototype._calculate=function(C,O,$,he){var me=he.zoom;return me>he.zoomHistory.lastIntegerZoom?{from:C,to:O}:{from:$,to:O}},ro.prototype.interpolate=function(C){return C};var Ro=function(C){this.specification=C};Ro.prototype.possiblyEvaluate=function(C,O,$,he){return!!C.expression.evaluate(O,null,{},$,he)},Ro.prototype.interpolate=function(){return!1};var ji=function(C){this.properties=C,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(var O in C){var $=C[O];$.specification.overridable&&this.overridableProperties.push(O);var he=this.defaultPropertyValues[O]=new so($,void 0),me=this.defaultTransitionablePropertyValues[O]=new qi($);this.defaultTransitioningPropertyValues[O]=me.untransitioned(),this.defaultPossiblyEvaluatedValues[O]=he.possiblyEvaluate({})}};ze("DataDrivenProperty",Za),ze("DataConstantProperty",Ia),ze("CrossFadedDataDrivenProperty",_o),ze("CrossFadedProperty",ro),ze("ColorRampProperty",Ro);var Zo="-transition",bs=function(E){function C(O,$){if(E.call(this),this.id=O.id,this.type=O.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},O.type!=="custom"&&(O=O,this.metadata=O.metadata,this.minzoom=O.minzoom,this.maxzoom=O.maxzoom,O.type!=="background"&&(this.source=O.source,this.sourceLayer=O["source-layer"],this.filter=O.filter),$.layout&&(this._unevaluatedLayout=new Xo($.layout)),$.paint)){this._transitionablePaint=new mo($.paint);for(var he in O.paint)this.setPaintProperty(he,O.paint[he],{validate:!1});for(var me in O.layout)this.setLayoutProperty(me,O.layout[me],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ui($.paint)}}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},C.prototype.getLayoutProperty=function($){return $==="visibility"?this.visibility:this._unevaluatedLayout.getValue($)},C.prototype.setLayoutProperty=function($,he,me){if(me===void 0&&(me={}),he!=null){var Te="layers."+this.id+".layout."+$;if(this._validate(cs,Te,$,he,me))return}if($==="visibility"){this.visibility=he;return}this._unevaluatedLayout.setValue($,he)},C.prototype.getPaintProperty=function($){return k($,Zo)?this._transitionablePaint.getTransition($.slice(0,-Zo.length)):this._transitionablePaint.getValue($)},C.prototype.setPaintProperty=function($,he,me){if(me===void 0&&(me={}),he!=null){var Te="layers."+this.id+".paint."+$;if(this._validate(ki,Te,$,he,me))return!1}if(k($,Zo))return this._transitionablePaint.setTransition($.slice(0,-Zo.length),he||void 0),!1;var Ie=this._transitionablePaint._values[$],qe=Ie.property.specification["property-type"]==="cross-faded-data-driven",ut=Ie.value.isDataDriven(),pt=Ie.value;this._transitionablePaint.setValue($,he),this._handleSpecialPaintPropertyUpdate($);var Pt=this._transitionablePaint._values[$].value,Jt=Pt.isDataDriven();return Jt||ut||qe||this._handleOverridablePaintPropertyUpdate($,pt,Pt)},C.prototype._handleSpecialPaintPropertyUpdate=function($){},C.prototype._handleOverridablePaintPropertyUpdate=function($,he,me){return!1},C.prototype.isHidden=function($){return this.minzoom&&$<this.minzoom||this.maxzoom&&$>=this.maxzoom?!0:this.visibility==="none"},C.prototype.updateTransitions=function($){this._transitioningPaint=this._transitionablePaint.transitioned($,this._transitioningPaint)},C.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},C.prototype.recalculate=function($,he){$.getCrossfadeParameters&&(this._crossfadeParameters=$.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate($,void 0,he)),this.paint=this._transitioningPaint.possiblyEvaluate($,void 0,he)},C.prototype.serialize=function(){var $={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&($.layout=$.layout||{},$.layout.visibility=this.visibility),z($,function(he,me){return he!==void 0&&!(me==="layout"&&!Object.keys(he).length)&&!(me==="paint"&&!Object.keys(he).length)})},C.prototype._validate=function($,he,me,Te,Ie){return Ie===void 0&&(Ie={}),Ie&&Ie.validate===!1?!1:yo(this,$.call(wo,{key:he,layerType:this.type,objectKey:me,value:Te,styleSpec:It,style:{glyphs:!0,sprite:!0}}))},C.prototype.is3D=function(){return!1},C.prototype.isTileClipped=function(){return!1},C.prototype.hasOffscreenPass=function(){return!1},C.prototype.resize=function(){},C.prototype.isStateDependent=function(){for(var $ in this.paint._values){var he=this.paint.get($);if(!(!(he instanceof Wi)||!oi(he.property.specification))&&(he.value.kind==="source"||he.value.kind==="composite")&&he.value.isStateDependent)return!0}return!1},C}(Vr),Ul={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Ki=function(C,O){this._structArray=C,this._pos1=O*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},qu=128,Ml=5,Ni=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};Ni.serialize=function(C,O){return C._trim(),O&&(C.isTransferred=!0,O.push(C.arrayBuffer)),{length:C.length,arrayBuffer:C.arrayBuffer}},Ni.deserialize=function(C){var O=Object.create(this.prototype);return O.arrayBuffer=C.arrayBuffer,O.length=C.length,O.capacity=C.arrayBuffer.byteLength/O.bytesPerElement,O._refreshViews(),O},Ni.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Ni.prototype.clear=function(){this.length=0},Ni.prototype.resize=function(C){this.reserve(C),this.length=C},Ni.prototype.reserve=function(C){if(C>this.capacity){this.capacity=Math.max(C,Math.floor(this.capacity*Ml),qu),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var O=this.uint8;this._refreshViews(),O&&this.uint8.set(O)}},Ni.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};function Io(E,C){C===void 0&&(C=1);var O=0,$=0,he=E.map(function(Te){var Ie=ah(Te.type),qe=O=Sf(O,Math.max(C,Ie)),ut=Te.components||1;return $=Math.max($,Ie),O+=Ie*ut,{name:Te.name,type:Te.type,components:ut,offset:qe}}),me=Sf(O,Math.max($,C));return{members:he,size:me,alignment:C}}function ah(E){return Ul[E].BYTES_PER_ELEMENT}function Sf(E,C){return Math.ceil(E/C)*C}var pf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he){var me=this.length;return this.resize(me+1),this.emplace(me,$,he)},C.prototype.emplace=function($,he,me){var Te=$*2;return this.int16[Te+0]=he,this.int16[Te+1]=me,$},C}(Ni);pf.prototype.bytesPerElement=4,ze("StructArrayLayout2i4",pf);var Ou=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te){var Ie=this.length;return this.resize(Ie+1),this.emplace(Ie,$,he,me,Te)},C.prototype.emplace=function($,he,me,Te,Ie){var qe=$*4;return this.int16[qe+0]=he,this.int16[qe+1]=me,this.int16[qe+2]=Te,this.int16[qe+3]=Ie,$},C}(Ni);Ou.prototype.bytesPerElement=8,ze("StructArrayLayout4i8",Ou);var ef=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te,Ie,qe){var ut=this.length;return this.resize(ut+1),this.emplace(ut,$,he,me,Te,Ie,qe)},C.prototype.emplace=function($,he,me,Te,Ie,qe,ut){var pt=$*6;return this.int16[pt+0]=he,this.int16[pt+1]=me,this.int16[pt+2]=Te,this.int16[pt+3]=Ie,this.int16[pt+4]=qe,this.int16[pt+5]=ut,$},C}(Ni);ef.prototype.bytesPerElement=12,ze("StructArrayLayout2i4i12",ef);var kf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te,Ie,qe){var ut=this.length;return this.resize(ut+1),this.emplace(ut,$,he,me,Te,Ie,qe)},C.prototype.emplace=function($,he,me,Te,Ie,qe,ut){var pt=$*4,Pt=$*8;return this.int16[pt+0]=he,this.int16[pt+1]=me,this.uint8[Pt+4]=Te,this.uint8[Pt+5]=Ie,this.uint8[Pt+6]=qe,this.uint8[Pt+7]=ut,$},C}(Ni);kf.prototype.bytesPerElement=8,ze("StructArrayLayout2i4ub8",kf);var Bs=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te,Ie,qe,ut,pt,Pt,Jt){var Gt=this.length;return this.resize(Gt+1),this.emplace(Gt,$,he,me,Te,Ie,qe,ut,pt,Pt,Jt)},C.prototype.emplace=function($,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt){var cr=$*9,Dr=$*18;return this.uint16[cr+0]=he,this.uint16[cr+1]=me,this.uint16[cr+2]=Te,this.uint16[cr+3]=Ie,this.uint16[cr+4]=qe,this.uint16[cr+5]=ut,this.uint16[cr+6]=pt,this.uint16[cr+7]=Pt,this.uint8[Dr+16]=Jt,this.uint8[Dr+17]=Gt,$},C}(Ni);Bs.prototype.bytesPerElement=18,ze("StructArrayLayout8ui2ub18",Bs);var Bu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr){var Dr=this.length;return this.resize(Dr+1),this.emplace(Dr,$,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr)},C.prototype.emplace=function($,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr,Dr){var en=$*12;return this.int16[en+0]=he,this.int16[en+1]=me,this.int16[en+2]=Te,this.int16[en+3]=Ie,this.uint16[en+4]=qe,this.uint16[en+5]=ut,this.uint16[en+6]=pt,this.uint16[en+7]=Pt,this.int16[en+8]=Jt,this.int16[en+9]=Gt,this.int16[en+10]=cr,this.int16[en+11]=Dr,$},C}(Ni);Bu.prototype.bytesPerElement=24,ze("StructArrayLayout4i4ui4i24",Bu);var qf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me){var Te=this.length;return this.resize(Te+1),this.emplace(Te,$,he,me)},C.prototype.emplace=function($,he,me,Te){var Ie=$*3;return this.float32[Ie+0]=he,this.float32[Ie+1]=me,this.float32[Ie+2]=Te,$},C}(Ni);qf.prototype.bytesPerElement=12,ze("StructArrayLayout3f12",qf);var ec=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},C.prototype.emplaceBack=function($){var he=this.length;return this.resize(he+1),this.emplace(he,$)},C.prototype.emplace=function($,he){var me=$*1;return this.uint32[me+0]=he,$},C}(Ni);ec.prototype.bytesPerElement=4,ze("StructArrayLayout1ul4",ec);var df=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te,Ie,qe,ut,pt,Pt){var Jt=this.length;return this.resize(Jt+1),this.emplace(Jt,$,he,me,Te,Ie,qe,ut,pt,Pt)},C.prototype.emplace=function($,he,me,Te,Ie,qe,ut,pt,Pt,Jt){var Gt=$*10,cr=$*5;return this.int16[Gt+0]=he,this.int16[Gt+1]=me,this.int16[Gt+2]=Te,this.int16[Gt+3]=Ie,this.int16[Gt+4]=qe,this.int16[Gt+5]=ut,this.uint32[cr+3]=pt,this.uint16[Gt+8]=Pt,this.uint16[Gt+9]=Jt,$},C}(Ni);df.prototype.bytesPerElement=20,ze("StructArrayLayout6i1ul2ui20",df);var Ef=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te,Ie,qe){var ut=this.length;return this.resize(ut+1),this.emplace(ut,$,he,me,Te,Ie,qe)},C.prototype.emplace=function($,he,me,Te,Ie,qe,ut){var pt=$*6;return this.int16[pt+0]=he,this.int16[pt+1]=me,this.int16[pt+2]=Te,this.int16[pt+3]=Ie,this.int16[pt+4]=qe,this.int16[pt+5]=ut,$},C}(Ni);Ef.prototype.bytesPerElement=12,ze("StructArrayLayout2i2i2i12",Ef);var xu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te,Ie){var qe=this.length;return this.resize(qe+1),this.emplace(qe,$,he,me,Te,Ie)},C.prototype.emplace=function($,he,me,Te,Ie,qe){var ut=$*4,pt=$*8;return this.float32[ut+0]=he,this.float32[ut+1]=me,this.float32[ut+2]=Te,this.int16[pt+6]=Ie,this.int16[pt+7]=qe,$},C}(Ni);xu.prototype.bytesPerElement=16,ze("StructArrayLayout2f1f2i16",xu);var $s=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te){var Ie=this.length;return this.resize(Ie+1),this.emplace(Ie,$,he,me,Te)},C.prototype.emplace=function($,he,me,Te,Ie){var qe=$*12,ut=$*3;return this.uint8[qe+0]=he,this.uint8[qe+1]=me,this.float32[ut+1]=Te,this.float32[ut+2]=Ie,$},C}(Ni);$s.prototype.bytesPerElement=12,ze("StructArrayLayout2ub2f12",$s);var bu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me){var Te=this.length;return this.resize(Te+1),this.emplace(Te,$,he,me)},C.prototype.emplace=function($,he,me,Te){var Ie=$*3;return this.uint16[Ie+0]=he,this.uint16[Ie+1]=me,this.uint16[Ie+2]=Te,$},C}(Ni);bu.prototype.bytesPerElement=6,ze("StructArrayLayout3ui6",bu);var gf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr,Dr,en,Kr,Mn,yn){var Tn=this.length;return this.resize(Tn+1),this.emplace(Tn,$,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr,Dr,en,Kr,Mn,yn)},C.prototype.emplace=function($,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr,Dr,en,Kr,Mn,yn,Tn){var Dn=$*24,Hn=$*12,oa=$*48;return this.int16[Dn+0]=he,this.int16[Dn+1]=me,this.uint16[Dn+2]=Te,this.uint16[Dn+3]=Ie,this.uint32[Hn+2]=qe,this.uint32[Hn+3]=ut,this.uint32[Hn+4]=pt,this.uint16[Dn+10]=Pt,this.uint16[Dn+11]=Jt,this.uint16[Dn+12]=Gt,this.float32[Hn+7]=cr,this.float32[Hn+8]=Dr,this.uint8[oa+36]=en,this.uint8[oa+37]=Kr,this.uint8[oa+38]=Mn,this.uint32[Hn+10]=yn,this.int16[Dn+22]=Tn,$},C}(Ni);gf.prototype.bytesPerElement=48,ze("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",gf);var Cf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr,Dr,en,Kr,Mn,yn,Tn,Dn,Hn,oa,na,Ra,wa,Sa,ei,La,Da){var fi=this.length;return this.resize(fi+1),this.emplace(fi,$,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr,Dr,en,Kr,Mn,yn,Tn,Dn,Hn,oa,na,Ra,wa,Sa,ei,La,Da)},C.prototype.emplace=function($,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr,Dr,en,Kr,Mn,yn,Tn,Dn,Hn,oa,na,Ra,wa,Sa,ei,La,Da,fi){var $a=$*34,Ci=$*17;return this.int16[$a+0]=he,this.int16[$a+1]=me,this.int16[$a+2]=Te,this.int16[$a+3]=Ie,this.int16[$a+4]=qe,this.int16[$a+5]=ut,this.int16[$a+6]=pt,this.int16[$a+7]=Pt,this.uint16[$a+8]=Jt,this.uint16[$a+9]=Gt,this.uint16[$a+10]=cr,this.uint16[$a+11]=Dr,this.uint16[$a+12]=en,this.uint16[$a+13]=Kr,this.uint16[$a+14]=Mn,this.uint16[$a+15]=yn,this.uint16[$a+16]=Tn,this.uint16[$a+17]=Dn,this.uint16[$a+18]=Hn,this.uint16[$a+19]=oa,this.uint16[$a+20]=na,this.uint16[$a+21]=Ra,this.uint16[$a+22]=wa,this.uint32[Ci+12]=Sa,this.float32[Ci+13]=ei,this.float32[Ci+14]=La,this.float32[Ci+15]=Da,this.float32[Ci+16]=fi,$},C}(Ni);Cf.prototype.bytesPerElement=68,ze("StructArrayLayout8i15ui1ul4f68",Cf);var tf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function($){var he=this.length;return this.resize(he+1),this.emplace(he,$)},C.prototype.emplace=function($,he){var me=$*1;return this.float32[me+0]=he,$},C}(Ni);tf.prototype.bytesPerElement=4,ze("StructArrayLayout1f4",tf);var tc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me){var Te=this.length;return this.resize(Te+1),this.emplace(Te,$,he,me)},C.prototype.emplace=function($,he,me,Te){var Ie=$*3;return this.int16[Ie+0]=he,this.int16[Ie+1]=me,this.int16[Ie+2]=Te,$},C}(Ni);tc.prototype.bytesPerElement=6,ze("StructArrayLayout3i6",tc);var Nu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me){var Te=this.length;return this.resize(Te+1),this.emplace(Te,$,he,me)},C.prototype.emplace=function($,he,me,Te){var Ie=$*2,qe=$*4;return this.uint32[Ie+0]=he,this.uint16[qe+2]=me,this.uint16[qe+3]=Te,$},C}(Ni);Nu.prototype.bytesPerElement=8,ze("StructArrayLayout1ul2ui8",Nu);var yf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he){var me=this.length;return this.resize(me+1),this.emplace(me,$,he)},C.prototype.emplace=function($,he,me){var Te=$*2;return this.uint16[Te+0]=he,this.uint16[Te+1]=me,$},C}(Ni);yf.prototype.bytesPerElement=4,ze("StructArrayLayout2ui4",yf);var rf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},C.prototype.emplaceBack=function($){var he=this.length;return this.resize(he+1),this.emplace(he,$)},C.prototype.emplace=function($,he){var me=$*1;return this.uint16[me+0]=he,$},C}(Ni);rf.prototype.bytesPerElement=2,ze("StructArrayLayout1ui2",rf);var Uu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he){var me=this.length;return this.resize(me+1),this.emplace(me,$,he)},C.prototype.emplace=function($,he,me){var Te=$*2;return this.float32[Te+0]=he,this.float32[Te+1]=me,$},C}(Ni);Uu.prototype.bytesPerElement=8,ze("StructArrayLayout2f8",Uu);var rc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},C.prototype.emplaceBack=function($,he,me,Te){var Ie=this.length;return this.resize(Ie+1),this.emplace(Ie,$,he,me,Te)},C.prototype.emplace=function($,he,me,Te,Ie){var qe=$*4;return this.float32[qe+0]=he,this.float32[qe+1]=me,this.float32[qe+2]=Te,this.float32[qe+3]=Ie,$},C}(Ni);rc.prototype.bytesPerElement=16,ze("StructArrayLayout4f16",rc);var Mc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var O={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return O.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},O.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},O.x1.get=function(){return this._structArray.int16[this._pos2+2]},O.y1.get=function(){return this._structArray.int16[this._pos2+3]},O.x2.get=function(){return this._structArray.int16[this._pos2+4]},O.y2.get=function(){return this._structArray.int16[this._pos2+5]},O.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},O.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},O.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},O.anchorPoint.get=function(){return new f(this.anchorPointX,this.anchorPointY)},Object.defineProperties(C.prototype,O),C}(Ki);Mc.prototype.size=20;var Vu=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function($){return new Mc(this,$)},C}(df);ze("CollisionBoxArray",Vu);var nc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var O={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return O.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},O.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},O.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},O.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},O.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},O.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},O.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},O.segment.get=function(){return this._structArray.uint16[this._pos2+10]},O.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},O.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},O.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},O.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},O.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},O.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},O.placedOrientation.set=function($){this._structArray.uint8[this._pos1+37]=$},O.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},O.hidden.set=function($){this._structArray.uint8[this._pos1+38]=$},O.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},O.crossTileID.set=function($){this._structArray.uint32[this._pos4+10]=$},O.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(C.prototype,O),C}(Ki);nc.prototype.size=48;var nf=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function($){return new nc(this,$)},C}(gf);ze("PlacedSymbolArray",nf);var Sc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var O={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return O.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},O.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},O.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},O.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},O.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},O.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},O.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},O.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},O.key.get=function(){return this._structArray.uint16[this._pos2+8]},O.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},O.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},O.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},O.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},O.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},O.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},O.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},O.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},O.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},O.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},O.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},O.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},O.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},O.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},O.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},O.crossTileID.set=function($){this._structArray.uint32[this._pos4+12]=$},O.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},O.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},O.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},O.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(C.prototype,O),C}(Ki);Sc.prototype.size=68;var kc=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function($){return new Sc(this,$)},C}(Cf);ze("SymbolInstanceArray",kc);var Vl=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getoffsetX=function($){return this.float32[$*1+0]},C}(tf);ze("GlyphOffsetArray",Vl);var Ec=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.getx=function($){return this.int16[$*3+0]},C.prototype.gety=function($){return this.int16[$*3+1]},C.prototype.gettileUnitDistanceFromAnchor=function($){return this.int16[$*3+2]},C}(tc);ze("SymbolLineVertexArray",Ec);var Cc=function(E){function C(){E.apply(this,arguments)}E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C;var O={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return O.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},O.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},O.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(C.prototype,O),C}(Ki);Cc.prototype.size=8;var ac=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.get=function($){return new Cc(this,$)},C}(Nu);ze("FeatureIndexArray",ac);var Lc=Io([{name:"a_pos",components:2,type:"Int16"}],4),ce=Lc.members,H=function(C){C===void 0&&(C=[]),this.segments=C};H.prototype.prepareSegment=function(C,O,$,he){var me=this.segments[this.segments.length-1];return C>H.MAX_VERTEX_ARRAY_LENGTH&&B("Max vertices per segment is "+H.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+C),(!me||me.vertexLength+C>H.MAX_VERTEX_ARRAY_LENGTH||me.sortKey!==he)&&(me={vertexOffset:O.length,primitiveOffset:$.length,vertexLength:0,primitiveLength:0},he!==void 0&&(me.sortKey=he),this.segments.push(me)),me},H.prototype.get=function(){return this.segments},H.prototype.destroy=function(){for(var C=0,O=this.segments;C<O.length;C+=1){var $=O[C];for(var he in $.vaos)$.vaos[he].destroy()}},H.simpleSegment=function(C,O,$,he){return new H([{vertexOffset:C,primitiveOffset:O,vertexLength:$,primitiveLength:he,vaos:{},sortKey:0}])},H.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ze("SegmentVector",H);function ve(E,C){return E=h(Math.floor(E),0,255),C=h(Math.floor(C),0,255),256*E+C}var K=Io([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),de=a(function(E){function C(O,$){var he,me,Te,Ie,qe,ut,pt,Pt;for(he=O.length&3,me=O.length-he,Te=$,qe=3432918353,ut=461845907,Pt=0;Pt<me;)pt=O.charCodeAt(Pt)&255|(O.charCodeAt(++Pt)&255)<<8|(O.charCodeAt(++Pt)&255)<<16|(O.charCodeAt(++Pt)&255)<<24,++Pt,pt=(pt&65535)*qe+(((pt>>>16)*qe&65535)<<16)&4294967295,pt=pt<<15|pt>>>17,pt=(pt&65535)*ut+(((pt>>>16)*ut&65535)<<16)&4294967295,Te^=pt,Te=Te<<13|Te>>>19,Ie=(Te&65535)*5+(((Te>>>16)*5&65535)<<16)&4294967295,Te=(Ie&65535)+27492+(((Ie>>>16)+58964&65535)<<16);switch(pt=0,he){case 3:pt^=(O.charCodeAt(Pt+2)&255)<<16;case 2:pt^=(O.charCodeAt(Pt+1)&255)<<8;case 1:pt^=O.charCodeAt(Pt)&255,pt=(pt&65535)*qe+(((pt>>>16)*qe&65535)<<16)&4294967295,pt=pt<<15|pt>>>17,pt=(pt&65535)*ut+(((pt>>>16)*ut&65535)<<16)&4294967295,Te^=pt}return Te^=O.length,Te^=Te>>>16,Te=(Te&65535)*2246822507+(((Te>>>16)*2246822507&65535)<<16)&4294967295,Te^=Te>>>13,Te=(Te&65535)*3266489909+(((Te>>>16)*3266489909&65535)<<16)&4294967295,Te^=Te>>>16,Te>>>0}E.exports=C}),Se=a(function(E){function C(O,$){for(var he=O.length,me=$^he,Te=0,Ie;he>=4;)Ie=O.charCodeAt(Te)&255|(O.charCodeAt(++Te)&255)<<8|(O.charCodeAt(++Te)&255)<<16|(O.charCodeAt(++Te)&255)<<24,Ie=(Ie&65535)*1540483477+(((Ie>>>16)*1540483477&65535)<<16),Ie^=Ie>>>24,Ie=(Ie&65535)*1540483477+(((Ie>>>16)*1540483477&65535)<<16),me=(me&65535)*1540483477+(((me>>>16)*1540483477&65535)<<16)^Ie,he-=4,++Te;switch(he){case 3:me^=(O.charCodeAt(Te+2)&255)<<16;case 2:me^=(O.charCodeAt(Te+1)&255)<<8;case 1:me^=O.charCodeAt(Te)&255,me=(me&65535)*1540483477+(((me>>>16)*1540483477&65535)<<16)}return me^=me>>>13,me=(me&65535)*1540483477+(((me>>>16)*1540483477&65535)<<16),me^=me>>>15,me>>>0}E.exports=C}),Ce=de,Xe=de,lt=Se;Ce.murmur3=Xe,Ce.murmur2=lt;var wt=function(){this.ids=[],this.positions=[],this.indexed=!1};wt.prototype.add=function(C,O,$,he){this.ids.push(nr(C)),this.positions.push(O,$,he)},wt.prototype.getPositions=function(C){for(var O=nr(C),$=0,he=this.ids.length-1;$<he;){var me=$+he>>1;this.ids[me]>=O?he=me:$=me+1}for(var Te=[];this.ids[$]===O;){var Ie=this.positions[3*$],qe=this.positions[3*$+1],ut=this.positions[3*$+2];Te.push({index:Ie,start:qe,end:ut}),$++}return Te},wt.serialize=function(C,O){var $=new Float64Array(C.ids),he=new Uint32Array(C.positions);return sr($,he,0,$.length-1),O&&O.push($.buffer,he.buffer),{ids:$,positions:he}},wt.deserialize=function(C){var O=new wt;return O.ids=C.ids,O.positions=C.positions,O.indexed=!0,O};var Ht=Math.pow(2,53)-1;function nr(E){var C=+E;return!isNaN(C)&&C<=Ht?C:Ce(String(E))}function sr(E,C,O,$){for(;O<$;){for(var he=E[O+$>>1],me=O-1,Te=$+1;;){do me++;while(E[me]<he);do Te--;while(E[Te]>he);if(me>=Te)break;Ar(E,me,Te),Ar(C,3*me,3*Te),Ar(C,3*me+1,3*Te+1),Ar(C,3*me+2,3*Te+2)}Te-O<$-Te?(sr(E,C,O,Te),O=Te+1):(sr(E,C,Te+1,$),$=Te)}}function Ar(E,C,O){var $=E[C];E[C]=E[O],E[O]=$}ze("FeaturePositionMap",wt);var Nr=function(C,O){this.gl=C.gl,this.location=O},Ur=function(E){function C(O,$){E.call(this,O,$),this.current=0}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function($){this.current!==$&&(this.current=$,this.gl.uniform1i(this.location,$))},C}(Nr),Or=function(E){function C(O,$){E.call(this,O,$),this.current=0}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function($){this.current!==$&&(this.current=$,this.gl.uniform1f(this.location,$))},C}(Nr),Xr=function(E){function C(O,$){E.call(this,O,$),this.current=[0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function($){($[0]!==this.current[0]||$[1]!==this.current[1])&&(this.current=$,this.gl.uniform2f(this.location,$[0],$[1]))},C}(Nr),sn=function(E){function C(O,$){E.call(this,O,$),this.current=[0,0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function($){($[0]!==this.current[0]||$[1]!==this.current[1]||$[2]!==this.current[2])&&(this.current=$,this.gl.uniform3f(this.location,$[0],$[1],$[2]))},C}(Nr),Sn=function(E){function C(O,$){E.call(this,O,$),this.current=[0,0,0,0]}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function($){($[0]!==this.current[0]||$[1]!==this.current[1]||$[2]!==this.current[2]||$[3]!==this.current[3])&&(this.current=$,this.gl.uniform4f(this.location,$[0],$[1],$[2],$[3]))},C}(Nr),Fn=function(E){function C(O,$){E.call(this,O,$),this.current=di.transparent}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function($){($.r!==this.current.r||$.g!==this.current.g||$.b!==this.current.b||$.a!==this.current.a)&&(this.current=$,this.gl.uniform4f(this.location,$.r,$.g,$.b,$.a))},C}(Nr),Xn=new Float32Array(16),Qn=function(E){function C(O,$){E.call(this,O,$),this.current=Xn}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.set=function($){if($[12]!==this.current[12]||$[0]!==this.current[0]){this.current=$,this.gl.uniformMatrix4fv(this.location,!1,$);return}for(var he=1;he<16;he++)if($[he]!==this.current[he]){this.current=$,this.gl.uniformMatrix4fv(this.location,!1,$);break}},C}(Nr);function jn(E){return[ve(255*E.r,255*E.g),ve(255*E.b,255*E.a)]}var ca=function(C,O,$){this.value=C,this.uniformNames=O.map(function(he){return"u_"+he}),this.type=$};ca.prototype.setUniform=function(C,O,$){C.set($.constantOr(this.value))},ca.prototype.getBinding=function(C,O,$){return this.type==="color"?new Fn(C,O):new Or(C,O)};var ba=function(C,O){this.uniformNames=O.map(function($){return"u_"+$}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ba.prototype.setConstantPatternPositions=function(C,O){this.pixelRatioFrom=O.pixelRatio,this.pixelRatioTo=C.pixelRatio,this.patternFrom=O.tlbr,this.patternTo=C.tlbr},ba.prototype.setUniform=function(C,O,$,he){var me=he==="u_pattern_to"?this.patternTo:he==="u_pattern_from"?this.patternFrom:he==="u_pixel_ratio_to"?this.pixelRatioTo:he==="u_pixel_ratio_from"?this.pixelRatioFrom:null;me&&C.set(me)},ba.prototype.getBinding=function(C,O,$){return $.substr(0,9)==="u_pattern"?new Sn(C,O):new Or(C,O)};var ya=function(C,O,$,he){this.expression=C,this.type=$,this.maxValue=0,this.paintVertexAttributes=O.map(function(me){return{name:"a_"+me,type:"Float32",components:$==="color"?2:1,offset:0}}),this.paintVertexArray=new he};ya.prototype.populatePaintArray=function(C,O,$,he,me){var Te=this.paintVertexArray.length,Ie=this.expression.evaluate(new si(0),O,{},he,[],me);this.paintVertexArray.resize(C),this._setPaintValue(Te,C,Ie)},ya.prototype.updatePaintArray=function(C,O,$,he){var me=this.expression.evaluate({zoom:0},$,he);this._setPaintValue(C,O,me)},ya.prototype._setPaintValue=function(C,O,$){if(this.type==="color")for(var he=jn($),me=C;me<O;me++)this.paintVertexArray.emplace(me,he[0],he[1]);else{for(var Te=C;Te<O;Te++)this.paintVertexArray.emplace(Te,$);this.maxValue=Math.max(this.maxValue,Math.abs($))}},ya.prototype.upload=function(C){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=C.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ya.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ta=function(C,O,$,he,me,Te){this.expression=C,this.uniformNames=O.map(function(Ie){return"u_"+Ie+"_t"}),this.type=$,this.useIntegerZoom=he,this.zoom=me,this.maxValue=0,this.paintVertexAttributes=O.map(function(Ie){return{name:"a_"+Ie,type:"Float32",components:$==="color"?4:2,offset:0}}),this.paintVertexArray=new Te};Ta.prototype.populatePaintArray=function(C,O,$,he,me){var Te=this.expression.evaluate(new si(this.zoom),O,{},he,[],me),Ie=this.expression.evaluate(new si(this.zoom+1),O,{},he,[],me),qe=this.paintVertexArray.length;this.paintVertexArray.resize(C),this._setPaintValue(qe,C,Te,Ie)},Ta.prototype.updatePaintArray=function(C,O,$,he){var me=this.expression.evaluate({zoom:this.zoom},$,he),Te=this.expression.evaluate({zoom:this.zoom+1},$,he);this._setPaintValue(C,O,me,Te)},Ta.prototype._setPaintValue=function(C,O,$,he){if(this.type==="color")for(var me=jn($),Te=jn(he),Ie=C;Ie<O;Ie++)this.paintVertexArray.emplace(Ie,me[0],me[1],Te[0],Te[1]);else{for(var qe=C;qe<O;qe++)this.paintVertexArray.emplace(qe,$,he);this.maxValue=Math.max(this.maxValue,Math.abs($),Math.abs(he))}},Ta.prototype.upload=function(C){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=C.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ta.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ta.prototype.setUniform=function(C,O){var $=this.useIntegerZoom?Math.floor(O.zoom):O.zoom,he=h(this.expression.interpolationFactor($,this.zoom,this.zoom+1),0,1);C.set(he)},Ta.prototype.getBinding=function(C,O,$){return new Or(C,O)};var Ca=function(C,O,$,he,me,Te){this.expression=C,this.type=O,this.useIntegerZoom=$,this.zoom=he,this.layerId=Te,this.zoomInPaintVertexArray=new me,this.zoomOutPaintVertexArray=new me};Ca.prototype.populatePaintArray=function(C,O,$){var he=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(C),this.zoomOutPaintVertexArray.resize(C),this._setPaintValues(he,C,O.patterns&&O.patterns[this.layerId],$)},Ca.prototype.updatePaintArray=function(C,O,$,he,me){this._setPaintValues(C,O,$.patterns&&$.patterns[this.layerId],me)},Ca.prototype._setPaintValues=function(C,O,$,he){if(!(!he||!$)){var me=$.min,Te=$.mid,Ie=$.max,qe=he[me],ut=he[Te],pt=he[Ie];if(!(!qe||!ut||!pt))for(var Pt=C;Pt<O;Pt++)this.zoomInPaintVertexArray.emplace(Pt,ut.tl[0],ut.tl[1],ut.br[0],ut.br[1],qe.tl[0],qe.tl[1],qe.br[0],qe.br[1],ut.pixelRatio,qe.pixelRatio),this.zoomOutPaintVertexArray.emplace(Pt,ut.tl[0],ut.tl[1],ut.br[0],ut.br[1],pt.tl[0],pt.tl[1],pt.br[0],pt.br[1],ut.pixelRatio,pt.pixelRatio)}},Ca.prototype.upload=function(C){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=C.createVertexBuffer(this.zoomInPaintVertexArray,K.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=C.createVertexBuffer(this.zoomOutPaintVertexArray,K.members,this.expression.isStateDependent))},Ca.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ha=function(C,O,$,he){this.binders={},this.layoutAttributes=he,this._buffers=[];var me=[];for(var Te in C.paint._values)if(!!$(Te)){var Ie=C.paint.get(Te);if(!(!(Ie instanceof Wi)||!oi(Ie.property.specification))){var qe=Di(Te,C.type),ut=Ie.value,pt=Ie.property.specification.type,Pt=Ie.property.useIntegerZoom,Jt=Ie.property.specification["property-type"],Gt=Jt==="cross-faded"||Jt==="cross-faded-data-driven";if(ut.kind==="constant")this.binders[Te]=Gt?new ba(ut.value,qe):new ca(ut.value,qe,pt),me.push("/u_"+Te);else if(ut.kind==="source"||Gt){var cr=gi(Te,pt,"source");this.binders[Te]=Gt?new Ca(ut,pt,Pt,O,cr,C.id):new ya(ut,qe,pt,cr),me.push("/a_"+Te)}else{var Dr=gi(Te,pt,"composite");this.binders[Te]=new Ta(ut,qe,pt,Pt,O,Dr),me.push("/z_"+Te)}}}this.cacheKey=me.sort().join("")};Ha.prototype.getMaxValue=function(C){var O=this.binders[C];return O instanceof ya||O instanceof Ta?O.maxValue:0},Ha.prototype.populatePaintArrays=function(C,O,$,he,me){for(var Te in this.binders){var Ie=this.binders[Te];(Ie instanceof ya||Ie instanceof Ta||Ie instanceof Ca)&&Ie.populatePaintArray(C,O,$,he,me)}},Ha.prototype.setConstantPatternPositions=function(C,O){for(var $ in this.binders){var he=this.binders[$];he instanceof ba&&he.setConstantPatternPositions(C,O)}},Ha.prototype.updatePaintArrays=function(C,O,$,he,me){var Te=!1;for(var Ie in C)for(var qe=O.getPositions(Ie),ut=0,pt=qe;ut<pt.length;ut+=1){var Pt=pt[ut],Jt=$.feature(Pt.index);for(var Gt in this.binders){var cr=this.binders[Gt];if((cr instanceof ya||cr instanceof Ta||cr instanceof Ca)&&cr.expression.isStateDependent===!0){var Dr=he.paint.get(Gt);cr.expression=Dr.value,cr.updatePaintArray(Pt.start,Pt.end,Jt,C[Ie],me),Te=!0}}}return Te},Ha.prototype.defines=function(){var C=[];for(var O in this.binders){var $=this.binders[O];($ instanceof ca||$ instanceof ba)&&C.push.apply(C,$.uniformNames.map(function(he){return"#define HAS_UNIFORM_"+he}))}return C},Ha.prototype.getPaintVertexBuffers=function(){return this._buffers},Ha.prototype.getUniforms=function(C,O){var $=[];for(var he in this.binders){var me=this.binders[he];if(me instanceof ca||me instanceof ba||me instanceof Ta)for(var Te=0,Ie=me.uniformNames;Te<Ie.length;Te+=1){var qe=Ie[Te];if(O[qe]){var ut=me.getBinding(C,O[qe],qe);$.push({name:qe,property:he,binding:ut})}}}return $},Ha.prototype.setUniforms=function(C,O,$,he){for(var me=0,Te=O;me<Te.length;me+=1){var Ie=Te[me],qe=Ie.name,ut=Ie.property,pt=Ie.binding;this.binders[ut].setUniform(pt,he,$.get(ut),qe)}},Ha.prototype.updatePaintBuffers=function(C){this._buffers=[];for(var O in this.binders){var $=this.binders[O];if(C&&$ instanceof Ca){var he=C.fromScale===2?$.zoomInPaintVertexBuffer:$.zoomOutPaintVertexBuffer;he&&this._buffers.push(he)}else($ instanceof ya||$ instanceof Ta)&&$.paintVertexBuffer&&this._buffers.push($.paintVertexBuffer)}},Ha.prototype.upload=function(C){for(var O in this.binders){var $=this.binders[O];($ instanceof ya||$ instanceof Ta||$ instanceof Ca)&&$.upload(C)}this.updatePaintBuffers()},Ha.prototype.destroy=function(){for(var C in this.binders){var O=this.binders[C];(O instanceof ya||O instanceof Ta||O instanceof Ca)&&O.destroy()}};var ri=function(C,O,$,he){he===void 0&&(he=function(){return!0}),this.programConfigurations={};for(var me=0,Te=O;me<Te.length;me+=1){var Ie=Te[me];this.programConfigurations[Ie.id]=new Ha(Ie,$,he,C)}this.needsUpload=!1,this._featureMap=new wt,this._bufferOffset=0};ri.prototype.populatePaintArrays=function(C,O,$,he,me,Te){for(var Ie in this.programConfigurations)this.programConfigurations[Ie].populatePaintArrays(C,O,he,me,Te);O.id!==void 0&&this._featureMap.add(O.id,$,this._bufferOffset,C),this._bufferOffset=C,this.needsUpload=!0},ri.prototype.updatePaintArrays=function(C,O,$,he){for(var me=0,Te=$;me<Te.length;me+=1){var Ie=Te[me];this.needsUpload=this.programConfigurations[Ie.id].updatePaintArrays(C,this._featureMap,O,Ie,he)||this.needsUpload}},ri.prototype.get=function(C){return this.programConfigurations[C]},ri.prototype.upload=function(C){if(!!this.needsUpload){for(var O in this.programConfigurations)this.programConfigurations[O].upload(C);this.needsUpload=!1}},ri.prototype.destroy=function(){for(var C in this.programConfigurations)this.programConfigurations[C].destroy()};function Di(E,C){var O={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]};return O[E]||[E.replace(C+"-","").replace(/-/g,"_")]}function li(E){var C={"line-pattern":{source:Bs,composite:Bs},"fill-pattern":{source:Bs,composite:Bs},"fill-extrusion-pattern":{source:Bs,composite:Bs}};return C[E]}function gi(E,C,O){var $={color:{source:Uu,composite:rc},number:{source:tf,composite:Uu}},he=li(E);return he&&he[O]||$[C][O]}ze("ConstantBinder",ca),ze("CrossFadedConstantBinder",ba),ze("SourceExpressionBinder",ya),ze("CrossFadedCompositeBinder",Ca),ze("CompositeExpressionBinder",Ta),ze("ProgramConfiguration",Ha,{omit:["_buffers"]}),ze("ProgramConfigurationSet",ri);var Ba=8192;function Ri(E){return{min:-1*Math.pow(2,E-1),max:Math.pow(2,E-1)-1}}var Oi=Ri(15);function Vi(E){for(var C=Ba/E.extent,O=E.loadGeometry(),$=0;$<O.length;$++)for(var he=O[$],me=0;me<he.length;me++){var Te=he[me];Te.x=Math.round(Te.x*C),Te.y=Math.round(Te.y*C),(Te.x<Oi.min||Te.x>Oi.max||Te.y<Oi.min||Te.y>Oi.max)&&(B("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Te.x=h(Te.x,Oi.min,Oi.max),Te.y=h(Te.y,Oi.min,Oi.max))}return O}function Ti(E,C,O,$,he){E.emplaceBack(C*2+($+1)/2,O*2+(he+1)/2)}var Ji=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=C.index,this.hasPattern=!1,this.layoutVertexArray=new pf,this.indexArray=new bu,this.segments=new H,this.programConfigurations=new ri(ce,C.layers,C.zoom),this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};Ji.prototype.populate=function(C,O,$){var he=this.layers[0],me=[],Te=null;he.type==="circle"&&(Te=he.layout.get("circle-sort-key"));for(var Ie=0,qe=C;Ie<qe.length;Ie+=1){var ut=qe[Ie],pt=ut.feature,Pt=ut.id,Jt=ut.index,Gt=ut.sourceLayerIndex,cr=this.layers[0]._featureFilter.needGeometry,Dr={type:pt.type,id:Pt,properties:pt.properties,geometry:cr?Vi(pt):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),Dr,$)){cr||(Dr.geometry=Vi(pt));var en=Te?Te.evaluate(Dr,{},$):void 0,Kr={id:Pt,properties:pt.properties,type:pt.type,sourceLayerIndex:Gt,index:Jt,geometry:Dr.geometry,patterns:{},sortKey:en};me.push(Kr)}}Te&&me.sort(function(wa,Sa){return wa.sortKey-Sa.sortKey});for(var Mn=0,yn=me;Mn<yn.length;Mn+=1){var Tn=yn[Mn],Dn=Tn,Hn=Dn.geometry,oa=Dn.index,na=Dn.sourceLayerIndex,Ra=C[oa].feature;this.addFeature(Tn,Hn,oa,$),O.featureIndex.insert(Ra,Hn,oa,na,this.index)}},Ji.prototype.update=function(C,O,$){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,O,this.stateDependentLayers,$)},Ji.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ji.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ji.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,ce),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},Ji.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ji.prototype.addFeature=function(C,O,$,he){for(var me=0,Te=O;me<Te.length;me+=1)for(var Ie=Te[me],qe=0,ut=Ie;qe<ut.length;qe+=1){var pt=ut[qe],Pt=pt.x,Jt=pt.y;if(!(Pt<0||Pt>=Ba||Jt<0||Jt>=Ba)){var Gt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,C.sortKey),cr=Gt.vertexLength;Ti(this.layoutVertexArray,Pt,Jt,-1,-1),Ti(this.layoutVertexArray,Pt,Jt,1,-1),Ti(this.layoutVertexArray,Pt,Jt,1,1),Ti(this.layoutVertexArray,Pt,Jt,-1,1),this.indexArray.emplaceBack(cr,cr+1,cr+2),this.indexArray.emplaceBack(cr,cr+3,cr+2),Gt.vertexLength+=4,Gt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,$,{},he)},ze("CircleBucket",Ji,{omit:["layers"]});function ai(E,C){for(var O=0;O<E.length;O++)if(Ns(C,E[O]))return!0;for(var $=0;$<C.length;$++)if(Ns(E,C[$]))return!0;return!!kl(E,C)}function Ai(E,C,O){return!!(Ns(E,C)||ql(C,E,O))}function To(E,C){if(E.length===1)return eu(C,E[0]);for(var O=0;O<C.length;O++)for(var $=C[O],he=0;he<$.length;he++)if(Ns(E,$[he]))return!0;for(var me=0;me<E.length;me++)if(eu(C,E[me]))return!0;for(var Te=0;Te<C.length;Te++)if(kl(E,C[Te]))return!0;return!1}function No(E,C,O){for(var $=0;$<C.length;$++){var he=C[$];if(E.length>=3){for(var me=0;me<he.length;me++)if(Ns(E,he[me]))return!0}if(Sl(E,he,O))return!0}return!1}function Sl(E,C,O){if(E.length>1){if(kl(E,C))return!0;for(var $=0;$<C.length;$++)if(ql(C[$],E,O))return!0}for(var he=0;he<E.length;he++)if(ql(E[he],C,O))return!0;return!1}function kl(E,C){if(E.length===0||C.length===0)return!1;for(var O=0;O<E.length-1;O++)for(var $=E[O],he=E[O+1],me=0;me<C.length-1;me++){var Te=C[me],Ie=C[me+1];if($l($,he,Te,Ie))return!0}return!1}function $l(E,C,O,$){return F(E,O,$)!==F(C,O,$)&&F(E,C,O)!==F(E,C,$)}function ql(E,C,O){var $=O*O;if(C.length===1)return E.distSqr(C[0])<$;for(var he=1;he<C.length;he++){var me=C[he-1],Te=C[he];if(_u(E,me,Te)<$)return!0}return!1}function _u(E,C,O){var $=C.distSqr(O);if($===0)return E.distSqr(C);var he=((E.x-C.x)*(O.x-C.x)+(E.y-C.y)*(O.y-C.y))/$;return he<0?E.distSqr(C):he>1?E.distSqr(O):E.distSqr(O.sub(C)._mult(he)._add(C))}function eu(E,C){for(var O=!1,$,he,me,Te=0;Te<E.length;Te++){$=E[Te];for(var Ie=0,qe=$.length-1;Ie<$.length;qe=Ie++)he=$[Ie],me=$[qe],he.y>C.y!=me.y>C.y&&C.x<(me.x-he.x)*(C.y-he.y)/(me.y-he.y)+he.x&&(O=!O)}return O}function Ns(E,C){for(var O=!1,$=0,he=E.length-1;$<E.length;he=$++){var me=E[$],Te=E[he];me.y>C.y!=Te.y>C.y&&C.x<(Te.x-me.x)*(C.y-me.y)/(Te.y-me.y)+me.x&&(O=!O)}return O}function Hu(E,C,O,$,he){for(var me=0,Te=E;me<Te.length;me+=1){var Ie=Te[me];if(C<=Ie.x&&O<=Ie.y&&$>=Ie.x&&he>=Ie.y)return!0}var qe=[new f(C,O),new f(C,he),new f($,he),new f($,O)];if(E.length>2)for(var ut=0,pt=qe;ut<pt.length;ut+=1){var Pt=pt[ut];if(Ns(E,Pt))return!0}for(var Jt=0;Jt<E.length-1;Jt++){var Gt=E[Jt],cr=E[Jt+1];if(_s(Gt,cr,qe))return!0}return!1}function _s(E,C,O){var $=O[0],he=O[2];if(E.x<$.x&&C.x<$.x||E.x>he.x&&C.x>he.x||E.y<$.y&&C.y<$.y||E.y>he.y&&C.y>he.y)return!1;var me=F(E,C,O[0]);return me!==F(E,C,O[1])||me!==F(E,C,O[2])||me!==F(E,C,O[3])}function cl(E,C,O){var $=C.paint.get(E).value;return $.kind==="constant"?$.value:O.programConfigurations.get(C.id).getMaxValue(E)}function tu(E){return Math.sqrt(E[0]*E[0]+E[1]*E[1])}function Hl(E,C,O,$,he){if(!C[0]&&!C[1])return E;var me=f.convert(C)._mult(he);O==="viewport"&&me._rotate(-$);for(var Te=[],Ie=0;Ie<E.length;Ie++){var qe=E[Ie];Te.push(qe.sub(me))}return Te}var ru=new ji({"circle-sort-key":new Za(It.layout_circle["circle-sort-key"])}),Lf=new ji({"circle-radius":new Za(It.paint_circle["circle-radius"]),"circle-color":new Za(It.paint_circle["circle-color"]),"circle-blur":new Za(It.paint_circle["circle-blur"]),"circle-opacity":new Za(It.paint_circle["circle-opacity"]),"circle-translate":new Ia(It.paint_circle["circle-translate"]),"circle-translate-anchor":new Ia(It.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ia(It.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ia(It.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Za(It.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Za(It.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Za(It.paint_circle["circle-stroke-opacity"])}),Zu={paint:Lf,layout:ru},hs=typeof Float32Array!="undefined"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var E=arguments,C=0,O=arguments.length;O--;)C+=E[O]*E[O];return Math.sqrt(C)});function mf(){var E=new hs(4);return hs!=Float32Array&&(E[1]=0,E[2]=0),E[0]=1,E[3]=1,E}function Cs(E,C,O){var $=C[0],he=C[1],me=C[2],Te=C[3],Ie=Math.sin(O),qe=Math.cos(O);return E[0]=$*qe+me*Ie,E[1]=he*qe+Te*Ie,E[2]=$*-Ie+me*qe,E[3]=he*-Ie+Te*qe,E}function xf(){var E=new hs(9);return hs!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[5]=0,E[6]=0,E[7]=0),E[0]=1,E[4]=1,E[8]=1,E}function Pf(E,C){var O=Math.sin(C),$=Math.cos(C);return E[0]=$,E[1]=O,E[2]=0,E[3]=-O,E[4]=$,E[5]=0,E[6]=0,E[7]=0,E[8]=1,E}function Df(){var E=new hs(16);return hs!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=0,E[12]=0,E[13]=0,E[14]=0),E[0]=1,E[5]=1,E[10]=1,E[15]=1,E}function Pc(E){var C=new hs(16);return C[0]=E[0],C[1]=E[1],C[2]=E[2],C[3]=E[3],C[4]=E[4],C[5]=E[5],C[6]=E[6],C[7]=E[7],C[8]=E[8],C[9]=E[9],C[10]=E[10],C[11]=E[11],C[12]=E[12],C[13]=E[13],C[14]=E[14],C[15]=E[15],C}function Rf(E){return E[0]=1,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=1,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=1,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,E}function af(E,C){var O=C[0],$=C[1],he=C[2],me=C[3],Te=C[4],Ie=C[5],qe=C[6],ut=C[7],pt=C[8],Pt=C[9],Jt=C[10],Gt=C[11],cr=C[12],Dr=C[13],en=C[14],Kr=C[15],Mn=O*Ie-$*Te,yn=O*qe-he*Te,Tn=O*ut-me*Te,Dn=$*qe-he*Ie,Hn=$*ut-me*Ie,oa=he*ut-me*qe,na=pt*Dr-Pt*cr,Ra=pt*en-Jt*cr,wa=pt*Kr-Gt*cr,Sa=Pt*en-Jt*Dr,ei=Pt*Kr-Gt*Dr,La=Jt*Kr-Gt*en,Da=Mn*La-yn*ei+Tn*Sa+Dn*wa-Hn*Ra+oa*na;return Da?(Da=1/Da,E[0]=(Ie*La-qe*ei+ut*Sa)*Da,E[1]=(he*ei-$*La-me*Sa)*Da,E[2]=(Dr*oa-en*Hn+Kr*Dn)*Da,E[3]=(Jt*Hn-Pt*oa-Gt*Dn)*Da,E[4]=(qe*wa-Te*La-ut*Ra)*Da,E[5]=(O*La-he*wa+me*Ra)*Da,E[6]=(en*Tn-cr*oa-Kr*yn)*Da,E[7]=(pt*oa-Jt*Tn+Gt*yn)*Da,E[8]=(Te*ei-Ie*wa+ut*na)*Da,E[9]=($*wa-O*ei-me*na)*Da,E[10]=(cr*Hn-Dr*Tn+Kr*Mn)*Da,E[11]=(Pt*Tn-pt*Hn-Gt*Mn)*Da,E[12]=(Ie*Ra-Te*Sa-qe*na)*Da,E[13]=(O*Sa-$*Ra+he*na)*Da,E[14]=(Dr*yn-cr*Dn-en*Mn)*Da,E[15]=(pt*Dn-Pt*yn+Jt*Mn)*Da,E):null}function of(E,C,O){var $=C[0],he=C[1],me=C[2],Te=C[3],Ie=C[4],qe=C[5],ut=C[6],pt=C[7],Pt=C[8],Jt=C[9],Gt=C[10],cr=C[11],Dr=C[12],en=C[13],Kr=C[14],Mn=C[15],yn=O[0],Tn=O[1],Dn=O[2],Hn=O[3];return E[0]=yn*$+Tn*Ie+Dn*Pt+Hn*Dr,E[1]=yn*he+Tn*qe+Dn*Jt+Hn*en,E[2]=yn*me+Tn*ut+Dn*Gt+Hn*Kr,E[3]=yn*Te+Tn*pt+Dn*cr+Hn*Mn,yn=O[4],Tn=O[5],Dn=O[6],Hn=O[7],E[4]=yn*$+Tn*Ie+Dn*Pt+Hn*Dr,E[5]=yn*he+Tn*qe+Dn*Jt+Hn*en,E[6]=yn*me+Tn*ut+Dn*Gt+Hn*Kr,E[7]=yn*Te+Tn*pt+Dn*cr+Hn*Mn,yn=O[8],Tn=O[9],Dn=O[10],Hn=O[11],E[8]=yn*$+Tn*Ie+Dn*Pt+Hn*Dr,E[9]=yn*he+Tn*qe+Dn*Jt+Hn*en,E[10]=yn*me+Tn*ut+Dn*Gt+Hn*Kr,E[11]=yn*Te+Tn*pt+Dn*cr+Hn*Mn,yn=O[12],Tn=O[13],Dn=O[14],Hn=O[15],E[12]=yn*$+Tn*Ie+Dn*Pt+Hn*Dr,E[13]=yn*he+Tn*qe+Dn*Jt+Hn*en,E[14]=yn*me+Tn*ut+Dn*Gt+Hn*Kr,E[15]=yn*Te+Tn*pt+Dn*cr+Hn*Mn,E}function Lo(E,C,O){var $=O[0],he=O[1],me=O[2],Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr,Dr,en,Kr;return C===E?(E[12]=C[0]*$+C[4]*he+C[8]*me+C[12],E[13]=C[1]*$+C[5]*he+C[9]*me+C[13],E[14]=C[2]*$+C[6]*he+C[10]*me+C[14],E[15]=C[3]*$+C[7]*he+C[11]*me+C[15]):(Te=C[0],Ie=C[1],qe=C[2],ut=C[3],pt=C[4],Pt=C[5],Jt=C[6],Gt=C[7],cr=C[8],Dr=C[9],en=C[10],Kr=C[11],E[0]=Te,E[1]=Ie,E[2]=qe,E[3]=ut,E[4]=pt,E[5]=Pt,E[6]=Jt,E[7]=Gt,E[8]=cr,E[9]=Dr,E[10]=en,E[11]=Kr,E[12]=Te*$+pt*he+cr*me+C[12],E[13]=Ie*$+Pt*he+Dr*me+C[13],E[14]=qe*$+Jt*he+en*me+C[14],E[15]=ut*$+Gt*he+Kr*me+C[15]),E}function qs(E,C,O){var $=O[0],he=O[1],me=O[2];return E[0]=C[0]*$,E[1]=C[1]*$,E[2]=C[2]*$,E[3]=C[3]*$,E[4]=C[4]*he,E[5]=C[5]*he,E[6]=C[6]*he,E[7]=C[7]*he,E[8]=C[8]*me,E[9]=C[9]*me,E[10]=C[10]*me,E[11]=C[11]*me,E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15],E}function el(E,C,O){var $=Math.sin(O),he=Math.cos(O),me=C[4],Te=C[5],Ie=C[6],qe=C[7],ut=C[8],pt=C[9],Pt=C[10],Jt=C[11];return C!==E&&(E[0]=C[0],E[1]=C[1],E[2]=C[2],E[3]=C[3],E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15]),E[4]=me*he+ut*$,E[5]=Te*he+pt*$,E[6]=Ie*he+Pt*$,E[7]=qe*he+Jt*$,E[8]=ut*he-me*$,E[9]=pt*he-Te*$,E[10]=Pt*he-Ie*$,E[11]=Jt*he-qe*$,E}function If(E,C,O){var $=Math.sin(O),he=Math.cos(O),me=C[0],Te=C[1],Ie=C[2],qe=C[3],ut=C[4],pt=C[5],Pt=C[6],Jt=C[7];return C!==E&&(E[8]=C[8],E[9]=C[9],E[10]=C[10],E[11]=C[11],E[12]=C[12],E[13]=C[13],E[14]=C[14],E[15]=C[15]),E[0]=me*he+ut*$,E[1]=Te*he+pt*$,E[2]=Ie*he+Pt*$,E[3]=qe*he+Jt*$,E[4]=ut*he-me*$,E[5]=pt*he-Te*$,E[6]=Pt*he-Ie*$,E[7]=Jt*he-qe*$,E}function ic(E,C,O,$,he){var me=1/Math.tan(C/2),Te;return E[0]=me/O,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=me,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[11]=-1,E[12]=0,E[13]=0,E[15]=0,he!=null&&he!==1/0?(Te=1/($-he),E[10]=(he+$)*Te,E[14]=2*he*$*Te):(E[10]=-1,E[14]=-2*$),E}function ih(E,C,O,$,he,me,Te){var Ie=1/(C-O),qe=1/($-he),ut=1/(me-Te);return E[0]=-2*Ie,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=-2*qe,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=2*ut,E[11]=0,E[12]=(C+O)*Ie,E[13]=(he+$)*qe,E[14]=(Te+me)*ut,E[15]=1,E}var oh=of;function bf(){var E=new hs(3);return hs!=Float32Array&&(E[0]=0,E[1]=0,E[2]=0),E}function sh(E){var C=new hs(3);return C[0]=E[0],C[1]=E[1],C[2]=E[2],C}function zf(E,C,O){return E[0]=C[0]+O[0],E[1]=C[1]+O[1],E[2]=C[2]+O[2],E}function lh(E,C,O){return E[0]=C[0]-O[0],E[1]=C[1]-O[1],E[2]=C[2]-O[2],E}function uh(E,C,O){return E[0]=C[0]*O,E[1]=C[1]*O,E[2]=C[2]*O,E}function oc(E,C){var O=C[0],$=C[1],he=C[2],me=O*O+$*$+he*he;return me>0&&(me=1/Math.sqrt(me)),E[0]=C[0]*me,E[1]=C[1]*me,E[2]=C[2]*me,E}function np(E,C){return E[0]*C[0]+E[1]*C[1]+E[2]*C[2]}function ap(E,C,O){var $=C[0],he=C[1],me=C[2],Te=O[0],Ie=O[1],qe=O[2];return E[0]=he*qe-me*Ie,E[1]=me*Te-$*qe,E[2]=$*Ie-he*Te,E}function ip(E,C,O){var $=C[0],he=C[1],me=C[2];return E[0]=$*O[0]+he*O[3]+me*O[6],E[1]=$*O[1]+he*O[4]+me*O[7],E[2]=$*O[2]+he*O[5]+me*O[8],E}var op=lh;(function(){var E=bf();return function(C,O,$,he,me,Te){var Ie,qe;for(O||(O=3),$||($=0),he?qe=Math.min(he*O+$,C.length):qe=C.length,Ie=$;Ie<qe;Ie+=O)E[0]=C[Ie],E[1]=C[Ie+1],E[2]=C[Ie+2],me(E,E,Te),C[Ie]=E[0],C[Ie+1]=E[1],C[Ie+2]=E[2];return C}})();function sp(){var E=new hs(4);return hs!=Float32Array&&(E[0]=0,E[1]=0,E[2]=0,E[3]=0),E}function lp(E,C,O){return E[0]=C[0]*O,E[1]=C[1]*O,E[2]=C[2]*O,E[3]=C[3]*O,E}function up(E,C){return E[0]*C[0]+E[1]*C[1]+E[2]*C[2]+E[3]*C[3]}function Dc(E,C,O){var $=C[0],he=C[1],me=C[2],Te=C[3];return E[0]=O[0]*$+O[4]*he+O[8]*me+O[12]*Te,E[1]=O[1]*$+O[5]*he+O[9]*me+O[13]*Te,E[2]=O[2]*$+O[6]*he+O[10]*me+O[14]*Te,E[3]=O[3]*$+O[7]*he+O[11]*me+O[15]*Te,E}(function(){var E=sp();return function(C,O,$,he,me,Te){var Ie,qe;for(O||(O=4),$||($=0),he?qe=Math.min(he*O+$,C.length):qe=C.length,Ie=$;Ie<qe;Ie+=O)E[0]=C[Ie],E[1]=C[Ie+1],E[2]=C[Ie+2],E[3]=C[Ie+3],me(E,E,Te),C[Ie]=E[0],C[Ie+1]=E[1],C[Ie+2]=E[2],C[Ie+3]=E[3];return C}})();function fp(){var E=new hs(2);return hs!=Float32Array&&(E[0]=0,E[1]=0),E}function cp(E){var C=E[0],O=E[1];return C*C+O*O}var hp=cp;(function(){var E=fp();return function(C,O,$,he,me,Te){var Ie,qe;for(O||(O=2),$||($=0),he?qe=Math.min(he*O+$,C.length):qe=C.length,Ie=$;Ie<qe;Ie+=O)E[0]=C[Ie],E[1]=C[Ie+1],me(E,E,Te),C[Ie]=E[0],C[Ie+1]=E[1];return C}})();var vp=function(E){function C(O){E.call(this,O,Zu)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function($){return new Ji($)},C.prototype.queryRadius=function($){var he=$;return cl("circle-radius",this,he)+cl("circle-stroke-width",this,he)+tu(this.paint.get("circle-translate"))},C.prototype.queryIntersectsFeature=function($,he,me,Te,Ie,qe,ut,pt){for(var Pt=Hl($,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),qe.angle,ut),Jt=this.paint.get("circle-radius").evaluate(he,me),Gt=this.paint.get("circle-stroke-width").evaluate(he,me),cr=Jt+Gt,Dr=this.paint.get("circle-pitch-alignment")==="map",en=Dr?Pt:pp(Pt,pt),Kr=Dr?cr*ut:cr,Mn=0,yn=Te;Mn<yn.length;Mn+=1)for(var Tn=yn[Mn],Dn=0,Hn=Tn;Dn<Hn.length;Dn+=1){var oa=Hn[Dn],na=Dr?oa:Bh(oa,pt),Ra=Kr,wa=Dc([],[oa.x,oa.y,0,1],pt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ra*=wa[3]/qe.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ra*=qe.cameraToCenterDistance/wa[3]),Ai(en,na,Ra))return!0}return!1},C}(bs);function Bh(E,C){var O=Dc([],[E.x,E.y,0,1],C);return new f(O[0]/O[3],O[1]/O[3])}function pp(E,C){return E.map(function(O){return Bh(O,C)})}var Nh=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(Ji);ze("HeatmapBucket",Nh,{omit:["layers"]});function fh(E,C,O,$){var he=C.width,me=C.height;if(!$)$=new Uint8Array(he*me*O);else if($ instanceof Uint8ClampedArray)$=new Uint8Array($.buffer);else if($.length!==he*me*O)throw new RangeError("mismatched image size");return E.width=he,E.height=me,E.data=$,E}function Uh(E,C,O){var $=C.width,he=C.height;if(!($===E.width&&he===E.height)){var me=fh({},{width:$,height:he},O);ch(E,me,{x:0,y:0},{x:0,y:0},{width:Math.min(E.width,$),height:Math.min(E.height,he)},O),E.width=$,E.height=he,E.data=me.data}}function ch(E,C,O,$,he,me){if(he.width===0||he.height===0)return C;if(he.width>E.width||he.height>E.height||O.x>E.width-he.width||O.y>E.height-he.height)throw new RangeError("out of range source coordinates for image copy");if(he.width>C.width||he.height>C.height||$.x>C.width-he.width||$.y>C.height-he.height)throw new RangeError("out of range destination coordinates for image copy");for(var Te=E.data,Ie=C.data,qe=0;qe<he.height;qe++)for(var ut=((O.y+qe)*E.width+O.x)*me,pt=(($.y+qe)*C.width+$.x)*me,Pt=0;Pt<he.width*me;Pt++)Ie[pt+Pt]=Te[ut+Pt];return C}var _f=function(C,O){fh(this,C,1,O)};_f.prototype.resize=function(C){Uh(this,C,1)},_f.prototype.clone=function(){return new _f({width:this.width,height:this.height},new Uint8Array(this.data))},_f.copy=function(C,O,$,he,me){ch(C,O,$,he,me,1)};var tl=function(C,O){fh(this,C,4,O)};tl.prototype.resize=function(C){Uh(this,C,4)},tl.prototype.replace=function(C,O){O?this.data.set(C):C instanceof Uint8ClampedArray?this.data=new Uint8Array(C.buffer):this.data=C},tl.prototype.clone=function(){return new tl({width:this.width,height:this.height},new Uint8Array(this.data))},tl.copy=function(C,O,$,he,me){ch(C,O,$,he,me,4)},ze("AlphaImage",_f),ze("RGBAImage",tl);var dp=new ji({"heatmap-radius":new Za(It.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Za(It.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ia(It.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ro(It.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ia(It.paint_heatmap["heatmap-opacity"])}),gp={paint:dp};function Vh(E,C){for(var O=new Uint8Array(1024),$={},he=0,me=0;he<256;he++,me+=4){$[C]=he/255;var Te=E.evaluate($);O[me+0]=Math.floor(Te.r*255/Te.a),O[me+1]=Math.floor(Te.g*255/Te.a),O[me+2]=Math.floor(Te.b*255/Te.a),O[me+3]=Math.floor(Te.a*255)}return new tl({width:256,height:1},O)}var yp=function(E){function C(O){E.call(this,O,gp),this._updateColorRamp()}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function($){return new Nh($)},C.prototype._handleSpecialPaintPropertyUpdate=function($){$==="heatmap-color"&&this._updateColorRamp()},C.prototype._updateColorRamp=function(){var $=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Vh($,"heatmapDensity"),this.colorRampTexture=null},C.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},C.prototype.queryRadius=function(){return 0},C.prototype.queryIntersectsFeature=function(){return!1},C.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},C}(bs),mp=new ji({"hillshade-illumination-direction":new Ia(It.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ia(It.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ia(It.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ia(It.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ia(It.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ia(It.paint_hillshade["hillshade-accent-color"])}),xp={paint:mp},bp=function(E){function C(O){E.call(this,O,xp)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},C}(bs),_p=Io([{name:"a_pos",components:2,type:"Int16"}],4),Hh=_p.members,hh=Rc,wp=Rc;function Rc(E,C,O){O=O||2;var $=C&&C.length,he=$?C[0]*O:E.length,me=Gh(E,0,he,O,!0),Te=[];if(!me||me.next===me.prev)return Te;var Ie,qe,ut,pt,Pt,Jt,Gt;if($&&(me=kp(E,C,me,O)),E.length>80*O){Ie=ut=E[0],qe=pt=E[1];for(var cr=O;cr<he;cr+=O)Pt=E[cr],Jt=E[cr+1],Pt<Ie&&(Ie=Pt),Jt<qe&&(qe=Jt),Pt>ut&&(ut=Pt),Jt>pt&&(pt=Jt);Gt=Math.max(ut-Ie,pt-qe),Gt=Gt!==0?1/Gt:0}return sc(me,Te,O,Ie,qe,Gt),Te}function Gh(E,C,O,$,he){var me,Te;if(he===dh(E,C,O,$)>0)for(me=C;me<O;me+=$)Te=Xh(me,E[me],E[me+1],Te);else for(me=O-$;me>=C;me-=$)Te=Xh(me,E[me],E[me+1],Te);return Te&&Ic(Te,Te.next)&&(uc(Te),Te=Te.next),Te}function sf(E,C){if(!E)return E;C||(C=E);var O=E,$;do if($=!1,!O.steiner&&(Ic(O,O.next)||Uo(O.prev,O,O.next)===0)){if(uc(O),O=C=O.prev,O===O.next)break;$=!0}else O=O.next;while($||O!==C);return C}function sc(E,C,O,$,he,me,Te){if(!!E){!Te&&me&&Dp(E,$,he,me);for(var Ie=E,qe,ut;E.prev!==E.next;){if(qe=E.prev,ut=E.next,me?Ap(E,$,he,me):Tp(E)){C.push(qe.i/O),C.push(E.i/O),C.push(ut.i/O),uc(E),E=ut.next,Ie=ut.next;continue}if(E=ut,E===Ie){Te?Te===1?(E=Mp(sf(E),C,O),sc(E,C,O,$,he,me,2)):Te===2&&Sp(E,C,O,$,he,me):sc(sf(E),C,O,$,he,me,1);break}}}}function Tp(E){var C=E.prev,O=E,$=E.next;if(Uo(C,O,$)>=0)return!1;for(var he=E.next.next;he!==E.prev;){if(Ff(C.x,C.y,O.x,O.y,$.x,$.y,he.x,he.y)&&Uo(he.prev,he,he.next)>=0)return!1;he=he.next}return!0}function Ap(E,C,O,$){var he=E.prev,me=E,Te=E.next;if(Uo(he,me,Te)>=0)return!1;for(var Ie=he.x<me.x?he.x<Te.x?he.x:Te.x:me.x<Te.x?me.x:Te.x,qe=he.y<me.y?he.y<Te.y?he.y:Te.y:me.y<Te.y?me.y:Te.y,ut=he.x>me.x?he.x>Te.x?he.x:Te.x:me.x>Te.x?me.x:Te.x,pt=he.y>me.y?he.y>Te.y?he.y:Te.y:me.y>Te.y?me.y:Te.y,Pt=vh(Ie,qe,C,O,$),Jt=vh(ut,pt,C,O,$),Gt=E.prevZ,cr=E.nextZ;Gt&&Gt.z>=Pt&&cr&&cr.z<=Jt;){if(Gt!==E.prev&&Gt!==E.next&&Ff(he.x,he.y,me.x,me.y,Te.x,Te.y,Gt.x,Gt.y)&&Uo(Gt.prev,Gt,Gt.next)>=0||(Gt=Gt.prevZ,cr!==E.prev&&cr!==E.next&&Ff(he.x,he.y,me.x,me.y,Te.x,Te.y,cr.x,cr.y)&&Uo(cr.prev,cr,cr.next)>=0))return!1;cr=cr.nextZ}for(;Gt&&Gt.z>=Pt;){if(Gt!==E.prev&&Gt!==E.next&&Ff(he.x,he.y,me.x,me.y,Te.x,Te.y,Gt.x,Gt.y)&&Uo(Gt.prev,Gt,Gt.next)>=0)return!1;Gt=Gt.prevZ}for(;cr&&cr.z<=Jt;){if(cr!==E.prev&&cr!==E.next&&Ff(he.x,he.y,me.x,me.y,Te.x,Te.y,cr.x,cr.y)&&Uo(cr.prev,cr,cr.next)>=0)return!1;cr=cr.nextZ}return!0}function Mp(E,C,O){var $=E;do{var he=$.prev,me=$.next.next;!Ic(he,me)&&Yh(he,$,$.next,me)&&lc(he,me)&&lc(me,he)&&(C.push(he.i/O),C.push($.i/O),C.push(me.i/O),uc($),uc($.next),$=E=me),$=$.next}while($!==E);return sf($)}function Sp(E,C,O,$,he,me){var Te=E;do{for(var Ie=Te.next.next;Ie!==Te.prev;){if(Te.i!==Ie.i&&zp(Te,Ie)){var qe=Wh(Te,Ie);Te=sf(Te,Te.next),qe=sf(qe,qe.next),sc(Te,C,O,$,he,me),sc(qe,C,O,$,he,me);return}Ie=Ie.next}Te=Te.next}while(Te!==E)}function kp(E,C,O,$){var he=[],me,Te,Ie,qe,ut;for(me=0,Te=C.length;me<Te;me++)Ie=C[me]*$,qe=me<Te-1?C[me+1]*$:E.length,ut=Gh(E,Ie,qe,$,!1),ut===ut.next&&(ut.steiner=!0),he.push(Ip(ut));for(he.sort(Ep),me=0;me<he.length;me++)Cp(he[me],O),O=sf(O,O.next);return O}function Ep(E,C){return E.x-C.x}function Cp(E,C){if(C=Lp(E,C),C){var O=Wh(C,E);sf(C,C.next),sf(O,O.next)}}function Lp(E,C){var O=C,$=E.x,he=E.y,me=-1/0,Te;do{if(he<=O.y&&he>=O.next.y&&O.next.y!==O.y){var Ie=O.x+(he-O.y)*(O.next.x-O.x)/(O.next.y-O.y);if(Ie<=$&&Ie>me){if(me=Ie,Ie===$){if(he===O.y)return O;if(he===O.next.y)return O.next}Te=O.x<O.next.x?O:O.next}}O=O.next}while(O!==C);if(!Te)return null;if($===me)return Te;var qe=Te,ut=Te.x,pt=Te.y,Pt=1/0,Jt;O=Te;do $>=O.x&&O.x>=ut&&$!==O.x&&Ff(he<pt?$:me,he,ut,pt,he<pt?me:$,he,O.x,O.y)&&(Jt=Math.abs(he-O.y)/($-O.x),lc(O,E)&&(Jt<Pt||Jt===Pt&&(O.x>Te.x||O.x===Te.x&&Pp(Te,O)))&&(Te=O,Pt=Jt)),O=O.next;while(O!==qe);return Te}function Pp(E,C){return Uo(E.prev,E,C.prev)<0&&Uo(C.next,E,E.next)<0}function Dp(E,C,O,$){var he=E;do he.z===null&&(he.z=vh(he.x,he.y,C,O,$)),he.prevZ=he.prev,he.nextZ=he.next,he=he.next;while(he!==E);he.prevZ.nextZ=null,he.prevZ=null,Rp(he)}function Rp(E){var C,O,$,he,me,Te,Ie,qe,ut=1;do{for(O=E,E=null,me=null,Te=0;O;){for(Te++,$=O,Ie=0,C=0;C<ut&&(Ie++,$=$.nextZ,!!$);C++);for(qe=ut;Ie>0||qe>0&&$;)Ie!==0&&(qe===0||!$||O.z<=$.z)?(he=O,O=O.nextZ,Ie--):(he=$,$=$.nextZ,qe--),me?me.nextZ=he:E=he,he.prevZ=me,me=he;O=$}me.nextZ=null,ut*=2}while(Te>1);return E}function vh(E,C,O,$,he){return E=32767*(E-O)*he,C=32767*(C-$)*he,E=(E|E<<8)&16711935,E=(E|E<<4)&252645135,E=(E|E<<2)&858993459,E=(E|E<<1)&1431655765,C=(C|C<<8)&16711935,C=(C|C<<4)&252645135,C=(C|C<<2)&858993459,C=(C|C<<1)&1431655765,E|C<<1}function Ip(E){var C=E,O=E;do(C.x<O.x||C.x===O.x&&C.y<O.y)&&(O=C),C=C.next;while(C!==E);return O}function Ff(E,C,O,$,he,me,Te,Ie){return(he-Te)*(C-Ie)-(E-Te)*(me-Ie)>=0&&(E-Te)*($-Ie)-(O-Te)*(C-Ie)>=0&&(O-Te)*(me-Ie)-(he-Te)*($-Ie)>=0}function zp(E,C){return E.next.i!==C.i&&E.prev.i!==C.i&&!Fp(E,C)&&(lc(E,C)&&lc(C,E)&&Op(E,C)&&(Uo(E.prev,E,C.prev)||Uo(E,C.prev,C))||Ic(E,C)&&Uo(E.prev,E,E.next)>0&&Uo(C.prev,C,C.next)>0)}function Uo(E,C,O){return(C.y-E.y)*(O.x-C.x)-(C.x-E.x)*(O.y-C.y)}function Ic(E,C){return E.x===C.x&&E.y===C.y}function Yh(E,C,O,$){var he=Fc(Uo(E,C,O)),me=Fc(Uo(E,C,$)),Te=Fc(Uo(O,$,E)),Ie=Fc(Uo(O,$,C));return!!(he!==me&&Te!==Ie||he===0&&zc(E,O,C)||me===0&&zc(E,$,C)||Te===0&&zc(O,E,$)||Ie===0&&zc(O,C,$))}function zc(E,C,O){return C.x<=Math.max(E.x,O.x)&&C.x>=Math.min(E.x,O.x)&&C.y<=Math.max(E.y,O.y)&&C.y>=Math.min(E.y,O.y)}function Fc(E){return E>0?1:E<0?-1:0}function Fp(E,C){var O=E;do{if(O.i!==E.i&&O.next.i!==E.i&&O.i!==C.i&&O.next.i!==C.i&&Yh(O,O.next,E,C))return!0;O=O.next}while(O!==E);return!1}function lc(E,C){return Uo(E.prev,E,E.next)<0?Uo(E,C,E.next)>=0&&Uo(E,E.prev,C)>=0:Uo(E,C,E.prev)<0||Uo(E,E.next,C)<0}function Op(E,C){var O=E,$=!1,he=(E.x+C.x)/2,me=(E.y+C.y)/2;do O.y>me!=O.next.y>me&&O.next.y!==O.y&&he<(O.next.x-O.x)*(me-O.y)/(O.next.y-O.y)+O.x&&($=!$),O=O.next;while(O!==E);return $}function Wh(E,C){var O=new ph(E.i,E.x,E.y),$=new ph(C.i,C.x,C.y),he=E.next,me=C.prev;return E.next=C,C.prev=E,O.next=he,he.prev=O,$.next=O,O.prev=$,me.next=$,$.prev=me,$}function Xh(E,C,O,$){var he=new ph(E,C,O);return $?(he.next=$.next,he.prev=$,$.next.prev=he,$.next=he):(he.prev=he,he.next=he),he}function uc(E){E.next.prev=E.prev,E.prev.next=E.next,E.prevZ&&(E.prevZ.nextZ=E.nextZ),E.nextZ&&(E.nextZ.prevZ=E.prevZ)}function ph(E,C,O){this.i=E,this.x=C,this.y=O,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}Rc.deviation=function(E,C,O,$){var he=C&&C.length,me=he?C[0]*O:E.length,Te=Math.abs(dh(E,0,me,O));if(he)for(var Ie=0,qe=C.length;Ie<qe;Ie++){var ut=C[Ie]*O,pt=Ie<qe-1?C[Ie+1]*O:E.length;Te-=Math.abs(dh(E,ut,pt,O))}var Pt=0;for(Ie=0;Ie<$.length;Ie+=3){var Jt=$[Ie]*O,Gt=$[Ie+1]*O,cr=$[Ie+2]*O;Pt+=Math.abs((E[Jt]-E[cr])*(E[Gt+1]-E[Jt+1])-(E[Jt]-E[Gt])*(E[cr+1]-E[Jt+1]))}return Te===0&&Pt===0?0:Math.abs((Pt-Te)/Te)};function dh(E,C,O,$){for(var he=0,me=C,Te=O-$;me<O;me+=$)he+=(E[Te]-E[me])*(E[me+1]+E[Te+1]),Te=me;return he}Rc.flatten=function(E){for(var C=E[0][0].length,O={vertices:[],holes:[],dimensions:C},$=0,he=0;he<E.length;he++){for(var me=0;me<E[he].length;me++)for(var Te=0;Te<C;Te++)O.vertices.push(E[he][me][Te]);he>0&&($+=E[he-1].length,O.holes.push($))}return O},hh.default=wp;function Bp(E,C,O,$,he){Zh(E,C,O||0,$||E.length-1,he||Np)}function Zh(E,C,O,$,he){for(;$>O;){if($-O>600){var me=$-O+1,Te=C-O+1,Ie=Math.log(me),qe=.5*Math.exp(2*Ie/3),ut=.5*Math.sqrt(Ie*qe*(me-qe)/me)*(Te-me/2<0?-1:1),pt=Math.max(O,Math.floor(C-Te*qe/me+ut)),Pt=Math.min($,Math.floor(C+(me-Te)*qe/me+ut));Zh(E,C,pt,Pt,he)}var Jt=E[C],Gt=O,cr=$;for(fc(E,O,C),he(E[$],Jt)>0&&fc(E,O,$);Gt<cr;){for(fc(E,Gt,cr),Gt++,cr--;he(E[Gt],Jt)<0;)Gt++;for(;he(E[cr],Jt)>0;)cr--}he(E[O],Jt)===0?fc(E,O,cr):(cr++,fc(E,cr,$)),cr<=C&&(O=cr+1),C<=cr&&($=cr-1)}}function fc(E,C,O){var $=E[C];E[C]=E[O],E[O]=$}function Np(E,C){return E<C?-1:E>C?1:0}function gh(E,C){var O=E.length;if(O<=1)return[E];for(var $=[],he,me,Te=0;Te<O;Te++){var Ie=V(E[Te]);Ie!==0&&(E[Te].area=Math.abs(Ie),me===void 0&&(me=Ie<0),me===Ie<0?(he&&$.push(he),he=[E[Te]]):he.push(E[Te]))}if(he&&$.push(he),C>1)for(var qe=0;qe<$.length;qe++)$[qe].length<=C||(Bp($[qe],C,1,$[qe].length-1,Up),$[qe]=$[qe].slice(0,C));return $}function Up(E,C){return C.area-E.area}function yh(E,C,O){for(var $=O.patternDependencies,he=!1,me=0,Te=C;me<Te.length;me+=1){var Ie=Te[me],qe=Ie.paint.get(E+"-pattern");qe.isConstant()||(he=!0);var ut=qe.constantOr(null);ut&&(he=!0,$[ut.to]=!0,$[ut.from]=!0)}return he}function mh(E,C,O,$,he){for(var me=he.patternDependencies,Te=0,Ie=C;Te<Ie.length;Te+=1){var qe=Ie[Te],ut=qe.paint.get(E+"-pattern"),pt=ut.value;if(pt.kind!=="constant"){var Pt=pt.evaluate({zoom:$-1},O,{},he.availableImages),Jt=pt.evaluate({zoom:$},O,{},he.availableImages),Gt=pt.evaluate({zoom:$+1},O,{},he.availableImages);Pt=Pt&&Pt.name?Pt.name:Pt,Jt=Jt&&Jt.name?Jt.name:Jt,Gt=Gt&&Gt.name?Gt.name:Gt,me[Pt]=!0,me[Jt]=!0,me[Gt]=!0,O.patterns[qe.id]={min:Pt,mid:Jt,max:Gt}}}return O}var Vp=500,wu=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=C.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new pf,this.indexArray=new bu,this.indexArray2=new yf,this.programConfigurations=new ri(Hh,C.layers,C.zoom),this.segments=new H,this.segments2=new H,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};wu.prototype.populate=function(C,O,$){this.hasPattern=yh("fill",this.layers,O);for(var he=this.layers[0].layout.get("fill-sort-key"),me=[],Te=0,Ie=C;Te<Ie.length;Te+=1){var qe=Ie[Te],ut=qe.feature,pt=qe.id,Pt=qe.index,Jt=qe.sourceLayerIndex,Gt=this.layers[0]._featureFilter.needGeometry,cr={type:ut.type,id:pt,properties:ut.properties,geometry:Gt?Vi(ut):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),cr,$)){Gt||(cr.geometry=Vi(ut));var Dr=he?he.evaluate(cr,{},$,O.availableImages):void 0,en={id:pt,properties:ut.properties,type:ut.type,sourceLayerIndex:Jt,index:Pt,geometry:cr.geometry,patterns:{},sortKey:Dr};me.push(en)}}he&&me.sort(function(wa,Sa){return wa.sortKey-Sa.sortKey});for(var Kr=0,Mn=me;Kr<Mn.length;Kr+=1){var yn=Mn[Kr],Tn=yn,Dn=Tn.geometry,Hn=Tn.index,oa=Tn.sourceLayerIndex;if(this.hasPattern){var na=mh("fill",this.layers,yn,this.zoom,O);this.patternFeatures.push(na)}else this.addFeature(yn,Dn,Hn,$,{});var Ra=C[Hn].feature;O.featureIndex.insert(Ra,Dn,Hn,oa,this.index)}},wu.prototype.update=function(C,O,$){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,O,this.stateDependentLayers,$)},wu.prototype.addFeatures=function(C,O,$){for(var he=0,me=this.patternFeatures;he<me.length;he+=1){var Te=me[he];this.addFeature(Te,Te.geometry,Te.index,O,$)}},wu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},wu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},wu.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,Hh),this.indexBuffer=C.createIndexBuffer(this.indexArray),this.indexBuffer2=C.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(C),this.uploaded=!0},wu.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},wu.prototype.addFeature=function(C,O,$,he,me){for(var Te=0,Ie=gh(O,Vp);Te<Ie.length;Te+=1){for(var qe=Ie[Te],ut=0,pt=0,Pt=qe;pt<Pt.length;pt+=1){var Jt=Pt[pt];ut+=Jt.length}for(var Gt=this.segments.prepareSegment(ut,this.layoutVertexArray,this.indexArray),cr=Gt.vertexLength,Dr=[],en=[],Kr=0,Mn=qe;Kr<Mn.length;Kr+=1){var yn=Mn[Kr];if(yn.length!==0){yn!==qe[0]&&en.push(Dr.length/2);var Tn=this.segments2.prepareSegment(yn.length,this.layoutVertexArray,this.indexArray2),Dn=Tn.vertexLength;this.layoutVertexArray.emplaceBack(yn[0].x,yn[0].y),this.indexArray2.emplaceBack(Dn+yn.length-1,Dn),Dr.push(yn[0].x),Dr.push(yn[0].y);for(var Hn=1;Hn<yn.length;Hn++)this.layoutVertexArray.emplaceBack(yn[Hn].x,yn[Hn].y),this.indexArray2.emplaceBack(Dn+Hn-1,Dn+Hn),Dr.push(yn[Hn].x),Dr.push(yn[Hn].y);Tn.vertexLength+=yn.length,Tn.primitiveLength+=yn.length}}for(var oa=hh(Dr,en),na=0;na<oa.length;na+=3)this.indexArray.emplaceBack(cr+oa[na],cr+oa[na+1],cr+oa[na+2]);Gt.vertexLength+=ut,Gt.primitiveLength+=oa.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,$,me,he)},ze("FillBucket",wu,{omit:["layers","patternFeatures"]});var Hp=new ji({"fill-sort-key":new Za(It.layout_fill["fill-sort-key"])}),Gp=new ji({"fill-antialias":new Ia(It.paint_fill["fill-antialias"]),"fill-opacity":new Za(It.paint_fill["fill-opacity"]),"fill-color":new Za(It.paint_fill["fill-color"]),"fill-outline-color":new Za(It.paint_fill["fill-outline-color"]),"fill-translate":new Ia(It.paint_fill["fill-translate"]),"fill-translate-anchor":new Ia(It.paint_fill["fill-translate-anchor"]),"fill-pattern":new _o(It.paint_fill["fill-pattern"])}),Yp={paint:Gp,layout:Hp},Wp=function(E){function C(O){E.call(this,O,Yp)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.recalculate=function($,he){E.prototype.recalculate.call(this,$,he);var me=this.paint._values["fill-outline-color"];me.value.kind==="constant"&&me.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},C.prototype.createBucket=function($){return new wu($)},C.prototype.queryRadius=function(){return tu(this.paint.get("fill-translate"))},C.prototype.queryIntersectsFeature=function($,he,me,Te,Ie,qe,ut){var pt=Hl($,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),qe.angle,ut);return To(pt,Te)},C.prototype.isTileClipped=function(){return!0},C}(bs),Xp=Io([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),jh=Xp.members,Kh=Of;function Of(E,C,O,$,he){this.properties={},this.extent=O,this.type=0,this._pbf=E,this._geometry=-1,this._keys=$,this._values=he,E.readFields(Zp,this,C)}function Zp(E,C,O){E==1?C.id=O.readVarint():E==2?jp(O,C):E==3?C.type=O.readVarint():E==4&&(C._geometry=O.pos)}function jp(E,C){for(var O=E.readVarint()+E.pos;E.pos<O;){var $=C._keys[E.readVarint()],he=C._values[E.readVarint()];C.properties[$]=he}}Of.types=["Unknown","Point","LineString","Polygon"],Of.prototype.loadGeometry=function(){var E=this._pbf;E.pos=this._geometry;for(var C=E.readVarint()+E.pos,O=1,$=0,he=0,me=0,Te=[],Ie;E.pos<C;){if($<=0){var qe=E.readVarint();O=qe&7,$=qe>>3}if($--,O===1||O===2)he+=E.readSVarint(),me+=E.readSVarint(),O===1&&(Ie&&Te.push(Ie),Ie=[]),Ie.push(new f(he,me));else if(O===7)Ie&&Ie.push(Ie[0].clone());else throw new Error("unknown command "+O)}return Ie&&Te.push(Ie),Te},Of.prototype.bbox=function(){var E=this._pbf;E.pos=this._geometry;for(var C=E.readVarint()+E.pos,O=1,$=0,he=0,me=0,Te=1/0,Ie=-1/0,qe=1/0,ut=-1/0;E.pos<C;){if($<=0){var pt=E.readVarint();O=pt&7,$=pt>>3}if($--,O===1||O===2)he+=E.readSVarint(),me+=E.readSVarint(),he<Te&&(Te=he),he>Ie&&(Ie=he),me<qe&&(qe=me),me>ut&&(ut=me);else if(O!==7)throw new Error("unknown command "+O)}return[Te,qe,Ie,ut]},Of.prototype.toGeoJSON=function(E,C,O){var $=this.extent*Math.pow(2,O),he=this.extent*E,me=this.extent*C,Te=this.loadGeometry(),Ie=Of.types[this.type],qe,ut;function pt(Gt){for(var cr=0;cr<Gt.length;cr++){var Dr=Gt[cr],en=180-(Dr.y+me)*360/$;Gt[cr]=[(Dr.x+he)*360/$-180,360/Math.PI*Math.atan(Math.exp(en*Math.PI/180))-90]}}switch(this.type){case 1:var Pt=[];for(qe=0;qe<Te.length;qe++)Pt[qe]=Te[qe][0];Te=Pt,pt(Te);break;case 2:for(qe=0;qe<Te.length;qe++)pt(Te[qe]);break;case 3:for(Te=Kp(Te),qe=0;qe<Te.length;qe++)for(ut=0;ut<Te[qe].length;ut++)pt(Te[qe][ut]);break}Te.length===1?Te=Te[0]:Ie="Multi"+Ie;var Jt={type:"Feature",geometry:{type:Ie,coordinates:Te},properties:this.properties};return"id"in this&&(Jt.id=this.id),Jt};function Kp(E){var C=E.length;if(C<=1)return[E];for(var O=[],$,he,me=0;me<C;me++){var Te=Jp(E[me]);Te!==0&&(he===void 0&&(he=Te<0),he===Te<0?($&&O.push($),$=[E[me]]):$.push(E[me]))}return $&&O.push($),O}function Jp(E){for(var C=0,O=0,$=E.length,he=$-1,me,Te;O<$;he=O++)me=E[O],Te=E[he],C+=(Te.x-me.x)*(me.y+Te.y);return C}var Jh=Qh;function Qh(E,C){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=E,this._keys=[],this._values=[],this._features=[],E.readFields(Qp,this,C),this.length=this._features.length}function Qp(E,C,O){E===15?C.version=O.readVarint():E===1?C.name=O.readString():E===5?C.extent=O.readVarint():E===2?C._features.push(O.pos):E===3?C._keys.push(O.readString()):E===4&&C._values.push($p(O))}function $p(E){for(var C=null,O=E.readVarint()+E.pos;E.pos<O;){var $=E.readVarint()>>3;C=$===1?E.readString():$===2?E.readFloat():$===3?E.readDouble():$===4?E.readVarint64():$===5?E.readVarint():$===6?E.readSVarint():$===7?E.readBoolean():null}return C}Qh.prototype.feature=function(E){if(E<0||E>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[E];var C=this._pbf.readVarint()+this._pbf.pos;return new Kh(this._pbf,C,this.extent,this._keys,this._values)};var qp=ed;function ed(E,C){this.layers=E.readFields(td,{},C)}function td(E,C,O){if(E===3){var $=new Jh(O,O.readVarint()+O.pos);$.length&&(C[$.name]=$)}}var rd=qp,nd=Kh,ad=Jh,Bf={VectorTile:rd,VectorTileFeature:nd,VectorTileLayer:ad},id=Bf.VectorTileFeature.types,od=500,xh=Math.pow(2,13);function cc(E,C,O,$,he,me,Te,Ie){E.emplaceBack(C,O,Math.floor($*xh)*2+Te,he*xh*2,me*xh*2,Math.round(Ie))}var Tu=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=C.index,this.hasPattern=!1,this.layoutVertexArray=new ef,this.indexArray=new bu,this.programConfigurations=new ri(jh,C.layers,C.zoom),this.segments=new H,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};Tu.prototype.populate=function(C,O,$){this.features=[],this.hasPattern=yh("fill-extrusion",this.layers,O);for(var he=0,me=C;he<me.length;he+=1){var Te=me[he],Ie=Te.feature,qe=Te.id,ut=Te.index,pt=Te.sourceLayerIndex,Pt=this.layers[0]._featureFilter.needGeometry,Jt={type:Ie.type,id:qe,properties:Ie.properties,geometry:Pt?Vi(Ie):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),Jt,$)){var Gt={id:qe,sourceLayerIndex:pt,index:ut,geometry:Pt?Jt.geometry:Vi(Ie),properties:Ie.properties,type:Ie.type,patterns:{}};typeof Ie.id!="undefined"&&(Gt.id=Ie.id),this.hasPattern?this.features.push(mh("fill-extrusion",this.layers,Gt,this.zoom,O)):this.addFeature(Gt,Gt.geometry,ut,$,{}),O.featureIndex.insert(Ie,Gt.geometry,ut,pt,this.index,!0)}}},Tu.prototype.addFeatures=function(C,O,$){for(var he=0,me=this.features;he<me.length;he+=1){var Te=me[he],Ie=Te.geometry;this.addFeature(Te,Ie,Te.index,O,$)}},Tu.prototype.update=function(C,O,$){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,O,this.stateDependentLayers,$)},Tu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Tu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Tu.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,jh),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},Tu.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Tu.prototype.addFeature=function(C,O,$,he,me){for(var Te=0,Ie=gh(O,od);Te<Ie.length;Te+=1){for(var qe=Ie[Te],ut=0,pt=0,Pt=qe;pt<Pt.length;pt+=1){var Jt=Pt[pt];ut+=Jt.length}for(var Gt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),cr=0,Dr=qe;cr<Dr.length;cr+=1){var en=Dr[cr];if(en.length!==0&&!ld(en))for(var Kr=0,Mn=0;Mn<en.length;Mn++){var yn=en[Mn];if(Mn>=1){var Tn=en[Mn-1];if(!sd(yn,Tn)){Gt.vertexLength+4>H.MAX_VERTEX_ARRAY_LENGTH&&(Gt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Dn=yn.sub(Tn)._perp()._unit(),Hn=Tn.dist(yn);Kr+Hn>32768&&(Kr=0),cc(this.layoutVertexArray,yn.x,yn.y,Dn.x,Dn.y,0,0,Kr),cc(this.layoutVertexArray,yn.x,yn.y,Dn.x,Dn.y,0,1,Kr),Kr+=Hn,cc(this.layoutVertexArray,Tn.x,Tn.y,Dn.x,Dn.y,0,0,Kr),cc(this.layoutVertexArray,Tn.x,Tn.y,Dn.x,Dn.y,0,1,Kr);var oa=Gt.vertexLength;this.indexArray.emplaceBack(oa,oa+2,oa+1),this.indexArray.emplaceBack(oa+1,oa+2,oa+3),Gt.vertexLength+=4,Gt.primitiveLength+=2}}}}if(Gt.vertexLength+ut>H.MAX_VERTEX_ARRAY_LENGTH&&(Gt=this.segments.prepareSegment(ut,this.layoutVertexArray,this.indexArray)),id[C.type]==="Polygon"){for(var na=[],Ra=[],wa=Gt.vertexLength,Sa=0,ei=qe;Sa<ei.length;Sa+=1){var La=ei[Sa];if(La.length!==0){La!==qe[0]&&Ra.push(na.length/2);for(var Da=0;Da<La.length;Da++){var fi=La[Da];cc(this.layoutVertexArray,fi.x,fi.y,0,0,1,1,0),na.push(fi.x),na.push(fi.y)}}}for(var $a=hh(na,Ra),Ci=0;Ci<$a.length;Ci+=3)this.indexArray.emplaceBack(wa+$a[Ci],wa+$a[Ci+2],wa+$a[Ci+1]);Gt.primitiveLength+=$a.length/3,Gt.vertexLength+=ut}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,$,me,he)},ze("FillExtrusionBucket",Tu,{omit:["layers","features"]});function sd(E,C){return E.x===C.x&&(E.x<0||E.x>Ba)||E.y===C.y&&(E.y<0||E.y>Ba)}function ld(E){return E.every(function(C){return C.x<0})||E.every(function(C){return C.x>Ba})||E.every(function(C){return C.y<0})||E.every(function(C){return C.y>Ba})}var ud=new ji({"fill-extrusion-opacity":new Ia(It["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Za(It["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ia(It["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ia(It["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new _o(It["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Za(It["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Za(It["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ia(It["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),fd={paint:ud},cd=function(E){function C(O){E.call(this,O,fd)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.createBucket=function($){return new Tu($)},C.prototype.queryRadius=function(){return tu(this.paint.get("fill-extrusion-translate"))},C.prototype.is3D=function(){return!0},C.prototype.queryIntersectsFeature=function($,he,me,Te,Ie,qe,ut,pt){var Pt=Hl($,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),qe.angle,ut),Jt=this.paint.get("fill-extrusion-height").evaluate(he,me),Gt=this.paint.get("fill-extrusion-base").evaluate(he,me),cr=pd(Pt,pt,qe,0),Dr=vd(Te,Gt,Jt,pt),en=Dr[0],Kr=Dr[1];return hd(en,Kr,cr)},C}(bs);function hc(E,C){return E.x*C.x+E.y*C.y}function $h(E,C){if(E.length===1){for(var O=0,$=C[O++],he;!he||$.equals(he);)if(he=C[O++],!he)return 1/0;for(;O<C.length;O++){var me=C[O],Te=E[0],Ie=he.sub($),qe=me.sub($),ut=Te.sub($),pt=hc(Ie,Ie),Pt=hc(Ie,qe),Jt=hc(qe,qe),Gt=hc(ut,Ie),cr=hc(ut,qe),Dr=pt*Jt-Pt*Pt,en=(Jt*Gt-Pt*cr)/Dr,Kr=(pt*cr-Pt*Gt)/Dr,Mn=1-en-Kr,yn=$.z*Mn+he.z*en+me.z*Kr;if(isFinite(yn))return yn}return 1/0}else{for(var Tn=1/0,Dn=0,Hn=C;Dn<Hn.length;Dn+=1){var oa=Hn[Dn];Tn=Math.min(Tn,oa.z)}return Tn}}function hd(E,C,O){var $=1/0;To(O,C)&&($=$h(O,C[0]));for(var he=0;he<C.length;he++)for(var me=C[he],Te=E[he],Ie=0;Ie<me.length-1;Ie++){var qe=me[Ie],ut=me[Ie+1],pt=Te[Ie],Pt=Te[Ie+1],Jt=[qe,ut,Pt,pt,qe];ai(O,Jt)&&($=Math.min($,$h(O,Jt)))}return $===1/0?!1:$}function vd(E,C,O,$){for(var he=[],me=[],Te=$[8]*C,Ie=$[9]*C,qe=$[10]*C,ut=$[11]*C,pt=$[8]*O,Pt=$[9]*O,Jt=$[10]*O,Gt=$[11]*O,cr=0,Dr=E;cr<Dr.length;cr+=1){for(var en=Dr[cr],Kr=[],Mn=[],yn=0,Tn=en;yn<Tn.length;yn+=1){var Dn=Tn[yn],Hn=Dn.x,oa=Dn.y,na=$[0]*Hn+$[4]*oa+$[12],Ra=$[1]*Hn+$[5]*oa+$[13],wa=$[2]*Hn+$[6]*oa+$[14],Sa=$[3]*Hn+$[7]*oa+$[15],ei=na+Te,La=Ra+Ie,Da=wa+qe,fi=Sa+ut,$a=na+pt,Ci=Ra+Pt,Zi=wa+Jt,Li=Sa+Gt,Pi=new f(ei/fi,La/fi);Pi.z=Da/fi,Kr.push(Pi);var Mi=new f($a/Li,Ci/Li);Mi.z=Zi/Li,Mn.push(Mi)}he.push(Kr),me.push(Mn)}return[he,me]}function pd(E,C,O,$){for(var he=[],me=0,Te=E;me<Te.length;me+=1){var Ie=Te[me],qe=[Ie.x,Ie.y,$,1];Dc(qe,qe,C),he.push(new f(qe[0]/qe[3],qe[1]/qe[3]))}return he}var dd=Io([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),qh=dd.members,gd=Bf.VectorTileFeature.types,ev=63,yd=Math.cos(75/2*(Math.PI/180)),md=15,xd=20,bd=15,tv=1/2,rv=Math.pow(2,bd-1)/tv,rl=function(C){this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=C.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new kf,this.indexArray=new bu,this.programConfigurations=new ri(qh,C.layers,C.zoom),this.segments=new H,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};rl.prototype.populate=function(C,O,$){this.hasPattern=yh("line",this.layers,O);for(var he=this.layers[0].layout.get("line-sort-key"),me=[],Te=0,Ie=C;Te<Ie.length;Te+=1){var qe=Ie[Te],ut=qe.feature,pt=qe.id,Pt=qe.index,Jt=qe.sourceLayerIndex,Gt=this.layers[0]._featureFilter.needGeometry,cr={type:ut.type,id:pt,properties:ut.properties,geometry:Gt?Vi(ut):[]};if(!!this.layers[0]._featureFilter.filter(new si(this.zoom),cr,$)){Gt||(cr.geometry=Vi(ut));var Dr=he?he.evaluate(cr,{},$):void 0,en={id:pt,properties:ut.properties,type:ut.type,sourceLayerIndex:Jt,index:Pt,geometry:cr.geometry,patterns:{},sortKey:Dr};me.push(en)}}he&&me.sort(function(wa,Sa){return wa.sortKey-Sa.sortKey});for(var Kr=0,Mn=me;Kr<Mn.length;Kr+=1){var yn=Mn[Kr],Tn=yn,Dn=Tn.geometry,Hn=Tn.index,oa=Tn.sourceLayerIndex;if(this.hasPattern){var na=mh("line",this.layers,yn,this.zoom,O);this.patternFeatures.push(na)}else this.addFeature(yn,Dn,Hn,$,{});var Ra=C[Hn].feature;O.featureIndex.insert(Ra,Dn,Hn,oa,this.index)}},rl.prototype.update=function(C,O,$){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(C,O,this.stateDependentLayers,$)},rl.prototype.addFeatures=function(C,O,$){for(var he=0,me=this.patternFeatures;he<me.length;he+=1){var Te=me[he];this.addFeature(Te,Te.geometry,Te.index,O,$)}},rl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},rl.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},rl.prototype.upload=function(C){this.uploaded||(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,qh),this.indexBuffer=C.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(C),this.uploaded=!0},rl.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},rl.prototype.addFeature=function(C,O,$,he,me){for(var Te=this.layers[0].layout,Ie=Te.get("line-join").evaluate(C,{}),qe=Te.get("line-cap"),ut=Te.get("line-miter-limit"),pt=Te.get("line-round-limit"),Pt=0,Jt=O;Pt<Jt.length;Pt+=1){var Gt=Jt[Pt];this.addLine(Gt,C,Ie,qe,ut,pt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,C,$,me,he)},rl.prototype.addLine=function(C,O,$,he,me,Te){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,!!O.properties&&O.properties.hasOwnProperty("mapbox_clip_start")&&O.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+O.properties.mapbox_clip_start,this.clipEnd=+O.properties.mapbox_clip_end;for(var Ie=0;Ie<C.length-1;Ie++)this.totalDistance+=C[Ie].dist(C[Ie+1]);this.updateScaledDistance()}for(var qe=gd[O.type]==="Polygon",ut=C.length;ut>=2&&C[ut-1].equals(C[ut-2]);)ut--;for(var pt=0;pt<ut-1&&C[pt].equals(C[pt+1]);)pt++;if(!(ut<(qe?3:2))){$==="bevel"&&(me=1.05);var Pt=this.overscaling<=16?md*Ba/(512*this.overscaling):0,Jt=this.segments.prepareSegment(ut*10,this.layoutVertexArray,this.indexArray),Gt,cr=void 0,Dr=void 0,en=void 0,Kr=void 0;this.e1=this.e2=-1,qe&&(Gt=C[ut-2],Kr=C[pt].sub(Gt)._unit()._perp());for(var Mn=pt;Mn<ut;Mn++)if(Dr=Mn===ut-1?qe?C[pt+1]:void 0:C[Mn+1],!(Dr&&C[Mn].equals(Dr))){Kr&&(en=Kr),Gt&&(cr=Gt),Gt=C[Mn],Kr=Dr?Dr.sub(Gt)._unit()._perp():en,en=en||Kr;var yn=en.add(Kr);(yn.x!==0||yn.y!==0)&&yn._unit();var Tn=en.x*Kr.x+en.y*Kr.y,Dn=yn.x*Kr.x+yn.y*Kr.y,Hn=Dn!==0?1/Dn:1/0,oa=2*Math.sqrt(2-2*Dn),na=Dn<yd&&cr&&Dr,Ra=en.x*Kr.y-en.y*Kr.x>0;if(na&&Mn>pt){var wa=Gt.dist(cr);if(wa>2*Pt){var Sa=Gt.sub(Gt.sub(cr)._mult(Pt/wa)._round());this.updateDistance(cr,Sa),this.addCurrentVertex(Sa,en,0,0,Jt),cr=Sa}}var ei=cr&&Dr,La=ei?$:qe?"butt":he;if(ei&&La==="round"&&(Hn<Te?La="miter":Hn<=2&&(La="fakeround")),La==="miter"&&Hn>me&&(La="bevel"),La==="bevel"&&(Hn>2&&(La="flipbevel"),Hn<me&&(La="miter")),cr&&this.updateDistance(cr,Gt),La==="miter")yn._mult(Hn),this.addCurrentVertex(Gt,yn,0,0,Jt);else if(La==="flipbevel"){if(Hn>100)yn=Kr.mult(-1);else{var Da=Hn*en.add(Kr).mag()/en.sub(Kr).mag();yn._perp()._mult(Da*(Ra?-1:1))}this.addCurrentVertex(Gt,yn,0,0,Jt),this.addCurrentVertex(Gt,yn.mult(-1),0,0,Jt)}else if(La==="bevel"||La==="fakeround"){var fi=-Math.sqrt(Hn*Hn-1),$a=Ra?fi:0,Ci=Ra?0:fi;if(cr&&this.addCurrentVertex(Gt,en,$a,Ci,Jt),La==="fakeround")for(var Zi=Math.round(oa*180/Math.PI/xd),Li=1;Li<Zi;Li++){var Pi=Li/Zi;if(Pi!==.5){var Mi=Pi-.5,eo=1.0904+Tn*(-3.2452+Tn*(3.55645-Tn*1.43519)),ao=.848013+Tn*(-1.06021+Tn*.215638);Pi=Pi+Pi*Mi*(Pi-1)*(eo*Mi*Mi+ao)}var Ao=Kr.sub(en)._mult(Pi)._add(en)._unit()._mult(Ra?-1:1);this.addHalfVertex(Gt,Ao.x,Ao.y,!1,Ra,0,Jt)}Dr&&this.addCurrentVertex(Gt,Kr,-$a,-Ci,Jt)}else if(La==="butt")this.addCurrentVertex(Gt,yn,0,0,Jt);else if(La==="square"){var Po=cr?1:-1;this.addCurrentVertex(Gt,yn,Po,Po,Jt)}else La==="round"&&(cr&&(this.addCurrentVertex(Gt,en,0,0,Jt),this.addCurrentVertex(Gt,en,1,1,Jt,!0)),Dr&&(this.addCurrentVertex(Gt,Kr,-1,-1,Jt,!0),this.addCurrentVertex(Gt,Kr,0,0,Jt)));if(na&&Mn<ut-1){var es=Gt.dist(Dr);if(es>2*Pt){var Go=Gt.add(Dr.sub(Gt)._mult(Pt/es)._round());this.updateDistance(Gt,Go),this.addCurrentVertex(Go,Kr,0,0,Jt),Gt=Go}}}}},rl.prototype.addCurrentVertex=function(C,O,$,he,me,Te){Te===void 0&&(Te=!1);var Ie=O.x+O.y*$,qe=O.y-O.x*$,ut=-O.x+O.y*he,pt=-O.y-O.x*he;this.addHalfVertex(C,Ie,qe,Te,!1,$,me),this.addHalfVertex(C,ut,pt,Te,!0,-he,me),this.distance>rv/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(C,O,$,he,me,Te))},rl.prototype.addHalfVertex=function(C,O,$,he,me,Te,Ie){var qe=C.x,ut=C.y,pt=this.scaledDistance*tv;this.layoutVertexArray.emplaceBack((qe<<1)+(he?1:0),(ut<<1)+(me?1:0),Math.round(ev*O)+128,Math.round(ev*$)+128,(Te===0?0:Te<0?-1:1)+1|(pt&63)<<2,pt>>6);var Pt=Ie.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Pt),Ie.primitiveLength++),me?this.e2=Pt:this.e1=Pt},rl.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(rv-1):this.distance},rl.prototype.updateDistance=function(C,O){this.distance+=C.dist(O),this.updateScaledDistance()},ze("LineBucket",rl,{omit:["layers","patternFeatures"]});var _d=new ji({"line-cap":new Ia(It.layout_line["line-cap"]),"line-join":new Za(It.layout_line["line-join"]),"line-miter-limit":new Ia(It.layout_line["line-miter-limit"]),"line-round-limit":new Ia(It.layout_line["line-round-limit"]),"line-sort-key":new Za(It.layout_line["line-sort-key"])}),wd=new ji({"line-opacity":new Za(It.paint_line["line-opacity"]),"line-color":new Za(It.paint_line["line-color"]),"line-translate":new Ia(It.paint_line["line-translate"]),"line-translate-anchor":new Ia(It.paint_line["line-translate-anchor"]),"line-width":new Za(It.paint_line["line-width"]),"line-gap-width":new Za(It.paint_line["line-gap-width"]),"line-offset":new Za(It.paint_line["line-offset"]),"line-blur":new Za(It.paint_line["line-blur"]),"line-dasharray":new ro(It.paint_line["line-dasharray"]),"line-pattern":new _o(It.paint_line["line-pattern"]),"line-gradient":new Ro(It.paint_line["line-gradient"])}),nv={paint:wd,layout:_d},Td=function(E){function C(){E.apply(this,arguments)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.possiblyEvaluate=function($,he){return he=new si(Math.floor(he.zoom),{now:he.now,fadeDuration:he.fadeDuration,zoomHistory:he.zoomHistory,transition:he.transition}),E.prototype.possiblyEvaluate.call(this,$,he)},C.prototype.evaluate=function($,he,me,Te){return he=A({},he,{zoom:Math.floor(he.zoom)}),E.prototype.evaluate.call(this,$,he,me,Te)},C}(Za),av=new Td(nv.paint.properties["line-width"].specification);av.useIntegerZoom=!0;var Ad=function(E){function C(O){E.call(this,O,nv)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype._handleSpecialPaintPropertyUpdate=function($){$==="line-gradient"&&this._updateGradient()},C.prototype._updateGradient=function(){var $=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Vh($,"lineProgress"),this.gradientTexture=null},C.prototype.recalculate=function($,he){E.prototype.recalculate.call(this,$,he),this.paint._values["line-floorwidth"]=av.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,$)},C.prototype.createBucket=function($){return new rl($)},C.prototype.queryRadius=function($){var he=$,me=iv(cl("line-width",this,he),cl("line-gap-width",this,he)),Te=cl("line-offset",this,he);return me/2+Math.abs(Te)+tu(this.paint.get("line-translate"))},C.prototype.queryIntersectsFeature=function($,he,me,Te,Ie,qe,ut){var pt=Hl($,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),qe.angle,ut),Pt=ut/2*iv(this.paint.get("line-width").evaluate(he,me),this.paint.get("line-gap-width").evaluate(he,me)),Jt=this.paint.get("line-offset").evaluate(he,me);return Jt&&(Te=Md(Te,Jt*ut)),No(pt,Te,Pt)},C.prototype.isTileClipped=function(){return!0},C}(bs);function iv(E,C){return C>0?C+2*E:E}function Md(E,C){for(var O=[],$=new f(0,0),he=0;he<E.length;he++){for(var me=E[he],Te=[],Ie=0;Ie<me.length;Ie++){var qe=me[Ie-1],ut=me[Ie],pt=me[Ie+1],Pt=Ie===0?$:ut.sub(qe)._unit()._perp(),Jt=Ie===me.length-1?$:pt.sub(ut)._unit()._perp(),Gt=Pt._add(Jt)._unit(),cr=Gt.x*Jt.x+Gt.y*Jt.y;Gt._mult(1/cr),Te.push(Gt._mult(C)._add(ut))}O.push(Te)}return O}var bh=Io([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Sd=Io([{name:"a_projected_pos",components:3,type:"Float32"}],4);Io([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var kd=Io([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Io([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var ov=Io([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ed=Io([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Io([{name:"triangle",components:3,type:"Uint16"}]),Io([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Io([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Io([{type:"Float32",name:"offsetX"}]),Io([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function Cd(E,C,O){var $=C.layout.get("text-transform").evaluate(O,{});return $==="uppercase"?E=E.toLocaleUpperCase():$==="lowercase"&&(E=E.toLocaleLowerCase()),Xa.applyArabicShaping&&(E=Xa.applyArabicShaping(E)),E}function Ld(E,C,O){return E.sections.forEach(function($){$.text=Cd($.text,C,O)}),E}function Pd(E){var C={},O={},$=[],he=0;function me(Kr){$.push(E[Kr]),he++}function Te(Kr,Mn,yn){var Tn=O[Kr];return delete O[Kr],O[Mn]=Tn,$[Tn].geometry[0].pop(),$[Tn].geometry[0]=$[Tn].geometry[0].concat(yn[0]),Tn}function Ie(Kr,Mn,yn){var Tn=C[Mn];return delete C[Mn],C[Kr]=Tn,$[Tn].geometry[0].shift(),$[Tn].geometry[0]=yn[0].concat($[Tn].geometry[0]),Tn}function qe(Kr,Mn,yn){var Tn=yn?Mn[0][Mn[0].length-1]:Mn[0][0];return Kr+":"+Tn.x+":"+Tn.y}for(var ut=0;ut<E.length;ut++){var pt=E[ut],Pt=pt.geometry,Jt=pt.text?pt.text.toString():null;if(!Jt){me(ut);continue}var Gt=qe(Jt,Pt),cr=qe(Jt,Pt,!0);if(Gt in O&&cr in C&&O[Gt]!==C[cr]){var Dr=Ie(Gt,cr,Pt),en=Te(Gt,cr,$[Dr].geometry);delete C[Gt],delete O[cr],O[qe(Jt,$[en].geometry,!0)]=en,$[Dr].geometry=null}else Gt in O?Te(Gt,cr,Pt):cr in C?Ie(Gt,cr,Pt):(me(ut),C[Gt]=he-1,O[cr]=he-1)}return $.filter(function(Kr){return Kr.geometry})}var vc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function Dd(E){for(var C="",O=0;O<E.length;O++){var $=E.charCodeAt(O+1)||null,he=E.charCodeAt(O-1)||null,me=(!$||!qr($)||vc[E[O+1]])&&(!he||!qr(he)||vc[E[O-1]]);me&&vc[E[O]]?C+=vc[E[O]]:C+=E[O]}return C}var vs=24,Rd=function(E,C,O,$,he){var me,Te,Ie=he*8-$-1,qe=(1<<Ie)-1,ut=qe>>1,pt=-7,Pt=O?he-1:0,Jt=O?-1:1,Gt=E[C+Pt];for(Pt+=Jt,me=Gt&(1<<-pt)-1,Gt>>=-pt,pt+=Ie;pt>0;me=me*256+E[C+Pt],Pt+=Jt,pt-=8);for(Te=me&(1<<-pt)-1,me>>=-pt,pt+=$;pt>0;Te=Te*256+E[C+Pt],Pt+=Jt,pt-=8);if(me===0)me=1-ut;else{if(me===qe)return Te?NaN:(Gt?-1:1)*(1/0);Te=Te+Math.pow(2,$),me=me-ut}return(Gt?-1:1)*Te*Math.pow(2,me-$)},Id=function(E,C,O,$,he,me){var Te,Ie,qe,ut=me*8-he-1,pt=(1<<ut)-1,Pt=pt>>1,Jt=he===23?Math.pow(2,-24)-Math.pow(2,-77):0,Gt=$?0:me-1,cr=$?1:-1,Dr=C<0||C===0&&1/C<0?1:0;for(C=Math.abs(C),isNaN(C)||C===1/0?(Ie=isNaN(C)?1:0,Te=pt):(Te=Math.floor(Math.log(C)/Math.LN2),C*(qe=Math.pow(2,-Te))<1&&(Te--,qe*=2),Te+Pt>=1?C+=Jt/qe:C+=Jt*Math.pow(2,1-Pt),C*qe>=2&&(Te++,qe/=2),Te+Pt>=pt?(Ie=0,Te=pt):Te+Pt>=1?(Ie=(C*qe-1)*Math.pow(2,he),Te=Te+Pt):(Ie=C*Math.pow(2,Pt-1)*Math.pow(2,he),Te=0));he>=8;E[O+Gt]=Ie&255,Gt+=cr,Ie/=256,he-=8);for(Te=Te<<he|Ie,ut+=he;ut>0;E[O+Gt]=Te&255,Gt+=cr,Te/=256,ut-=8);E[O+Gt-cr]|=Dr*128},Oc={read:Rd,write:Id},Bc=no;function no(E){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(E)?E:new Uint8Array(E||0),this.pos=0,this.type=0,this.length=this.buf.length}no.Varint=0,no.Fixed64=1,no.Bytes=2,no.Fixed32=5;var _h=(1<<16)*(1<<16),sv=1/_h,zd=12,lv=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");no.prototype={destroy:function(){this.buf=null},readFields:function(E,C,O){for(O=O||this.length;this.pos<O;){var $=this.readVarint(),he=$>>3,me=this.pos;this.type=$&7,E(he,C,this),this.pos===me&&this.skip($)}return C},readMessage:function(E,C){return this.readFields(E,C,this.readVarint()+this.pos)},readFixed32:function(){var E=Nc(this.buf,this.pos);return this.pos+=4,E},readSFixed32:function(){var E=fv(this.buf,this.pos);return this.pos+=4,E},readFixed64:function(){var E=Nc(this.buf,this.pos)+Nc(this.buf,this.pos+4)*_h;return this.pos+=8,E},readSFixed64:function(){var E=Nc(this.buf,this.pos)+fv(this.buf,this.pos+4)*_h;return this.pos+=8,E},readFloat:function(){var E=Oc.read(this.buf,this.pos,!0,23,4);return this.pos+=4,E},readDouble:function(){var E=Oc.read(this.buf,this.pos,!0,52,8);return this.pos+=8,E},readVarint:function(E){var C=this.buf,O,$;return $=C[this.pos++],O=$&127,$<128||($=C[this.pos++],O|=($&127)<<7,$<128)||($=C[this.pos++],O|=($&127)<<14,$<128)||($=C[this.pos++],O|=($&127)<<21,$<128)?O:($=C[this.pos],O|=($&15)<<28,Fd(O,E,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var E=this.readVarint();return E%2===1?(E+1)/-2:E/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var E=this.readVarint()+this.pos,C=this.pos;return this.pos=E,E-C>=zd&&lv?Jd(this.buf,C,E):Kd(this.buf,C,E)},readBytes:function(){var E=this.readVarint()+this.pos,C=this.buf.subarray(this.pos,E);return this.pos=E,C},readPackedVarint:function(E,C){if(this.type!==no.Bytes)return E.push(this.readVarint(C));var O=ju(this);for(E=E||[];this.pos<O;)E.push(this.readVarint(C));return E},readPackedSVarint:function(E){if(this.type!==no.Bytes)return E.push(this.readSVarint());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSVarint());return E},readPackedBoolean:function(E){if(this.type!==no.Bytes)return E.push(this.readBoolean());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readBoolean());return E},readPackedFloat:function(E){if(this.type!==no.Bytes)return E.push(this.readFloat());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFloat());return E},readPackedDouble:function(E){if(this.type!==no.Bytes)return E.push(this.readDouble());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readDouble());return E},readPackedFixed32:function(E){if(this.type!==no.Bytes)return E.push(this.readFixed32());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFixed32());return E},readPackedSFixed32:function(E){if(this.type!==no.Bytes)return E.push(this.readSFixed32());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSFixed32());return E},readPackedFixed64:function(E){if(this.type!==no.Bytes)return E.push(this.readFixed64());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readFixed64());return E},readPackedSFixed64:function(E){if(this.type!==no.Bytes)return E.push(this.readSFixed64());var C=ju(this);for(E=E||[];this.pos<C;)E.push(this.readSFixed64());return E},skip:function(E){var C=E&7;if(C===no.Varint)for(;this.buf[this.pos++]>127;);else if(C===no.Bytes)this.pos=this.readVarint()+this.pos;else if(C===no.Fixed32)this.pos+=4;else if(C===no.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+C)},writeTag:function(E,C){this.writeVarint(E<<3|C)},realloc:function(E){for(var C=this.length||16;C<this.pos+E;)C*=2;if(C!==this.length){var O=new Uint8Array(C);O.set(this.buf),this.buf=O,this.length=C}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(E){this.realloc(4),Uf(this.buf,E,this.pos),this.pos+=4},writeSFixed32:function(E){this.realloc(4),Uf(this.buf,E,this.pos),this.pos+=4},writeFixed64:function(E){this.realloc(8),Uf(this.buf,E&-1,this.pos),Uf(this.buf,Math.floor(E*sv),this.pos+4),this.pos+=8},writeSFixed64:function(E){this.realloc(8),Uf(this.buf,E&-1,this.pos),Uf(this.buf,Math.floor(E*sv),this.pos+4),this.pos+=8},writeVarint:function(E){if(E=+E||0,E>268435455||E<0){Od(E,this);return}this.realloc(4),this.buf[this.pos++]=E&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=(E>>>=7)&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=(E>>>=7)&127|(E>127?128:0),!(E<=127)&&(this.buf[this.pos++]=E>>>7&127)))},writeSVarint:function(E){this.writeVarint(E<0?-E*2-1:E*2)},writeBoolean:function(E){this.writeVarint(Boolean(E))},writeString:function(E){E=String(E),this.realloc(E.length*4),this.pos++;var C=this.pos;this.pos=Qd(this.buf,E,this.pos);var O=this.pos-C;O>=128&&uv(C,O,this),this.pos=C-1,this.writeVarint(O),this.pos+=O},writeFloat:function(E){this.realloc(4),Oc.write(this.buf,E,this.pos,!0,23,4),this.pos+=4},writeDouble:function(E){this.realloc(8),Oc.write(this.buf,E,this.pos,!0,52,8),this.pos+=8},writeBytes:function(E){var C=E.length;this.writeVarint(C),this.realloc(C);for(var O=0;O<C;O++)this.buf[this.pos++]=E[O]},writeRawMessage:function(E,C){this.pos++;var O=this.pos;E(C,this);var $=this.pos-O;$>=128&&uv(O,$,this),this.pos=O-1,this.writeVarint($),this.pos+=$},writeMessage:function(E,C,O){this.writeTag(E,no.Bytes),this.writeRawMessage(C,O)},writePackedVarint:function(E,C){C.length&&this.writeMessage(E,Ud,C)},writePackedSVarint:function(E,C){C.length&&this.writeMessage(E,Vd,C)},writePackedBoolean:function(E,C){C.length&&this.writeMessage(E,Yd,C)},writePackedFloat:function(E,C){C.length&&this.writeMessage(E,Hd,C)},writePackedDouble:function(E,C){C.length&&this.writeMessage(E,Gd,C)},writePackedFixed32:function(E,C){C.length&&this.writeMessage(E,Wd,C)},writePackedSFixed32:function(E,C){C.length&&this.writeMessage(E,Xd,C)},writePackedFixed64:function(E,C){C.length&&this.writeMessage(E,Zd,C)},writePackedSFixed64:function(E,C){C.length&&this.writeMessage(E,jd,C)},writeBytesField:function(E,C){this.writeTag(E,no.Bytes),this.writeBytes(C)},writeFixed32Field:function(E,C){this.writeTag(E,no.Fixed32),this.writeFixed32(C)},writeSFixed32Field:function(E,C){this.writeTag(E,no.Fixed32),this.writeSFixed32(C)},writeFixed64Field:function(E,C){this.writeTag(E,no.Fixed64),this.writeFixed64(C)},writeSFixed64Field:function(E,C){this.writeTag(E,no.Fixed64),this.writeSFixed64(C)},writeVarintField:function(E,C){this.writeTag(E,no.Varint),this.writeVarint(C)},writeSVarintField:function(E,C){this.writeTag(E,no.Varint),this.writeSVarint(C)},writeStringField:function(E,C){this.writeTag(E,no.Bytes),this.writeString(C)},writeFloatField:function(E,C){this.writeTag(E,no.Fixed32),this.writeFloat(C)},writeDoubleField:function(E,C){this.writeTag(E,no.Fixed64),this.writeDouble(C)},writeBooleanField:function(E,C){this.writeVarintField(E,Boolean(C))}};function Fd(E,C,O){var $=O.buf,he,me;if(me=$[O.pos++],he=(me&112)>>4,me<128||(me=$[O.pos++],he|=(me&127)<<3,me<128)||(me=$[O.pos++],he|=(me&127)<<10,me<128)||(me=$[O.pos++],he|=(me&127)<<17,me<128)||(me=$[O.pos++],he|=(me&127)<<24,me<128)||(me=$[O.pos++],he|=(me&1)<<31,me<128))return Nf(E,he,C);throw new Error("Expected varint not more than 10 bytes")}function ju(E){return E.type===no.Bytes?E.readVarint()+E.pos:E.pos+1}function Nf(E,C,O){return O?C*4294967296+(E>>>0):(C>>>0)*4294967296+(E>>>0)}function Od(E,C){var O,$;if(E>=0?(O=E%4294967296|0,$=E/4294967296|0):(O=~(-E%4294967296),$=~(-E/4294967296),O^4294967295?O=O+1|0:(O=0,$=$+1|0)),E>=18446744073709552e3||E<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");C.realloc(10),Bd(O,$,C),Nd($,C)}function Bd(E,C,O){O.buf[O.pos++]=E&127|128,E>>>=7,O.buf[O.pos++]=E&127|128,E>>>=7,O.buf[O.pos++]=E&127|128,E>>>=7,O.buf[O.pos++]=E&127|128,E>>>=7,O.buf[O.pos]=E&127}function Nd(E,C){var O=(E&7)<<4;C.buf[C.pos++]|=O|((E>>>=3)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127|((E>>>=7)?128:0),E&&(C.buf[C.pos++]=E&127)))))}function uv(E,C,O){var $=C<=16383?1:C<=2097151?2:C<=268435455?3:Math.floor(Math.log(C)/(Math.LN2*7));O.realloc($);for(var he=O.pos-1;he>=E;he--)O.buf[he+$]=O.buf[he]}function Ud(E,C){for(var O=0;O<E.length;O++)C.writeVarint(E[O])}function Vd(E,C){for(var O=0;O<E.length;O++)C.writeSVarint(E[O])}function Hd(E,C){for(var O=0;O<E.length;O++)C.writeFloat(E[O])}function Gd(E,C){for(var O=0;O<E.length;O++)C.writeDouble(E[O])}function Yd(E,C){for(var O=0;O<E.length;O++)C.writeBoolean(E[O])}function Wd(E,C){for(var O=0;O<E.length;O++)C.writeFixed32(E[O])}function Xd(E,C){for(var O=0;O<E.length;O++)C.writeSFixed32(E[O])}function Zd(E,C){for(var O=0;O<E.length;O++)C.writeFixed64(E[O])}function jd(E,C){for(var O=0;O<E.length;O++)C.writeSFixed64(E[O])}function Nc(E,C){return(E[C]|E[C+1]<<8|E[C+2]<<16)+E[C+3]*16777216}function Uf(E,C,O){E[O]=C,E[O+1]=C>>>8,E[O+2]=C>>>16,E[O+3]=C>>>24}function fv(E,C){return(E[C]|E[C+1]<<8|E[C+2]<<16)+(E[C+3]<<24)}function Kd(E,C,O){for(var $="",he=C;he<O;){var me=E[he],Te=null,Ie=me>239?4:me>223?3:me>191?2:1;if(he+Ie>O)break;var qe,ut,pt;Ie===1?me<128&&(Te=me):Ie===2?(qe=E[he+1],(qe&192)===128&&(Te=(me&31)<<6|qe&63,Te<=127&&(Te=null))):Ie===3?(qe=E[he+1],ut=E[he+2],(qe&192)===128&&(ut&192)===128&&(Te=(me&15)<<12|(qe&63)<<6|ut&63,(Te<=2047||Te>=55296&&Te<=57343)&&(Te=null))):Ie===4&&(qe=E[he+1],ut=E[he+2],pt=E[he+3],(qe&192)===128&&(ut&192)===128&&(pt&192)===128&&(Te=(me&15)<<18|(qe&63)<<12|(ut&63)<<6|pt&63,(Te<=65535||Te>=1114112)&&(Te=null))),Te===null?(Te=65533,Ie=1):Te>65535&&(Te-=65536,$+=String.fromCharCode(Te>>>10&1023|55296),Te=56320|Te&1023),$+=String.fromCharCode(Te),he+=Ie}return $}function Jd(E,C,O){return lv.decode(E.subarray(C,O))}function Qd(E,C,O){for(var $=0,he,me;$<C.length;$++){if(he=C.charCodeAt($),he>55295&&he<57344)if(me)if(he<56320){E[O++]=239,E[O++]=191,E[O++]=189,me=he;continue}else he=me-55296<<10|he-56320|65536,me=null;else{he>56319||$+1===C.length?(E[O++]=239,E[O++]=191,E[O++]=189):me=he;continue}else me&&(E[O++]=239,E[O++]=191,E[O++]=189,me=null);he<128?E[O++]=he:(he<2048?E[O++]=he>>6|192:(he<65536?E[O++]=he>>12|224:(E[O++]=he>>18|240,E[O++]=he>>12&63|128),E[O++]=he>>6&63|128),E[O++]=he&63|128)}return O}var wh=3;function $d(E,C,O){E===1&&O.readMessage(qd,C)}function qd(E,C,O){if(E===3){var $=O.readMessage(e0,{}),he=$.id,me=$.bitmap,Te=$.width,Ie=$.height,qe=$.left,ut=$.top,pt=$.advance;C.push({id:he,bitmap:new _f({width:Te+2*wh,height:Ie+2*wh},me),metrics:{width:Te,height:Ie,left:qe,top:ut,advance:pt}})}}function e0(E,C,O){E===1?C.id=O.readVarint():E===2?C.bitmap=O.readBytes():E===3?C.width=O.readVarint():E===4?C.height=O.readVarint():E===5?C.left=O.readSVarint():E===6?C.top=O.readSVarint():E===7&&(C.advance=O.readVarint())}function t0(E){return new Bc(E).readFields($d,[])}var cv=wh;function hv(E){for(var C=0,O=0,$=0,he=E;$<he.length;$+=1){var me=he[$];C+=me.w*me.h,O=Math.max(O,me.w)}E.sort(function(en,Kr){return Kr.h-en.h});for(var Te=Math.max(Math.ceil(Math.sqrt(C/.95)),O),Ie=[{x:0,y:0,w:Te,h:1/0}],qe=0,ut=0,pt=0,Pt=E;pt<Pt.length;pt+=1)for(var Jt=Pt[pt],Gt=Ie.length-1;Gt>=0;Gt--){var cr=Ie[Gt];if(!(Jt.w>cr.w||Jt.h>cr.h)){if(Jt.x=cr.x,Jt.y=cr.y,ut=Math.max(ut,Jt.y+Jt.h),qe=Math.max(qe,Jt.x+Jt.w),Jt.w===cr.w&&Jt.h===cr.h){var Dr=Ie.pop();Gt<Ie.length&&(Ie[Gt]=Dr)}else Jt.h===cr.h?(cr.x+=Jt.w,cr.w-=Jt.w):Jt.w===cr.w?(cr.y+=Jt.h,cr.h-=Jt.h):(Ie.push({x:cr.x+Jt.w,y:cr.y,w:cr.w-Jt.w,h:Jt.h}),cr.y+=Jt.h,cr.h-=Jt.h);break}}return{w:qe,h:ut,fill:C/(qe*ut)||0}}var hl=1,Uc=function(C,O){var $=O.pixelRatio,he=O.version,me=O.stretchX,Te=O.stretchY,Ie=O.content;this.paddedRect=C,this.pixelRatio=$,this.stretchX=me,this.stretchY=Te,this.content=Ie,this.version=he},pc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};pc.tl.get=function(){return[this.paddedRect.x+hl,this.paddedRect.y+hl]},pc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-hl,this.paddedRect.y+this.paddedRect.h-hl]},pc.tlbr.get=function(){return this.tl.concat(this.br)},pc.displaySize.get=function(){return[(this.paddedRect.w-hl*2)/this.pixelRatio,(this.paddedRect.h-hl*2)/this.pixelRatio]},Object.defineProperties(Uc.prototype,pc);var dc=function(C,O){var $={},he={};this.haveRenderCallbacks=[];var me=[];this.addImages(C,$,me),this.addImages(O,he,me);var Te=hv(me),Ie=Te.w,qe=Te.h,ut=new tl({width:Ie||1,height:qe||1});for(var pt in C){var Pt=C[pt],Jt=$[pt].paddedRect;tl.copy(Pt.data,ut,{x:0,y:0},{x:Jt.x+hl,y:Jt.y+hl},Pt.data)}for(var Gt in O){var cr=O[Gt],Dr=he[Gt].paddedRect,en=Dr.x+hl,Kr=Dr.y+hl,Mn=cr.data.width,yn=cr.data.height;tl.copy(cr.data,ut,{x:0,y:0},{x:en,y:Kr},cr.data),tl.copy(cr.data,ut,{x:0,y:yn-1},{x:en,y:Kr-1},{width:Mn,height:1}),tl.copy(cr.data,ut,{x:0,y:0},{x:en,y:Kr+yn},{width:Mn,height:1}),tl.copy(cr.data,ut,{x:Mn-1,y:0},{x:en-1,y:Kr},{width:1,height:yn}),tl.copy(cr.data,ut,{x:0,y:0},{x:en+Mn,y:Kr},{width:1,height:yn})}this.image=ut,this.iconPositions=$,this.patternPositions=he};dc.prototype.addImages=function(C,O,$){for(var he in C){var me=C[he],Te={x:0,y:0,w:me.data.width+2*hl,h:me.data.height+2*hl};$.push(Te),O[he]=new Uc(Te,me),me.hasRenderCallback&&this.haveRenderCallbacks.push(he)}},dc.prototype.patchUpdatedImages=function(C,O){C.dispatchRenderCallbacks(this.haveRenderCallbacks);for(var $ in C.updatedImages)this.patchUpdatedImage(this.iconPositions[$],C.getImage($),O),this.patchUpdatedImage(this.patternPositions[$],C.getImage($),O)},dc.prototype.patchUpdatedImage=function(C,O,$){if(!(!C||!O)&&C.version!==O.version){C.version=O.version;var he=C.tl,me=he[0],Te=he[1];$.update(O.data,void 0,{x:me,y:Te})}},ze("ImagePosition",Uc),ze("ImageAtlas",dc);var El={horizontal:1,vertical:2,horizontalOnly:3},gc=-17;function r0(E){for(var C=0,O=E;C<O.length;C+=1){var $=O[C];if($.positionedGlyphs.length!==0)return!1}return!0}var vv=57344,pv=63743,Vf=function(){this.scale=1,this.fontStack="",this.imageName=null};Vf.forText=function(C,O){var $=new Vf;return $.scale=C||1,$.fontStack=O,$},Vf.forImage=function(C){var O=new Vf;return O.imageName=C,O};var Ls=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};Ls.fromFeature=function(C,O){for(var $=new Ls,he=0;he<C.sections.length;he++){var me=C.sections[he];me.image?$.addImageSection(me):$.addTextSection(me,O)}return $},Ls.prototype.length=function(){return this.text.length},Ls.prototype.getSection=function(C){return this.sections[this.sectionIndex[C]]},Ls.prototype.getSectionIndex=function(C){return this.sectionIndex[C]},Ls.prototype.getCharCode=function(C){return this.text.charCodeAt(C)},Ls.prototype.verticalizePunctuation=function(){this.text=Dd(this.text)},Ls.prototype.trim=function(){for(var C=0,O=0;O<this.text.length&&Gu[this.text.charCodeAt(O)];O++)C++;for(var $=this.text.length,he=this.text.length-1;he>=0&&he>=C&&Gu[this.text.charCodeAt(he)];he--)$--;this.text=this.text.substring(C,$),this.sectionIndex=this.sectionIndex.slice(C,$)},Ls.prototype.substring=function(C,O){var $=new Ls;return $.text=this.text.substring(C,O),$.sectionIndex=this.sectionIndex.slice(C,O),$.sections=this.sections,$},Ls.prototype.toString=function(){return this.text},Ls.prototype.getMaxScale=function(){var C=this;return this.sectionIndex.reduce(function(O,$){return Math.max(O,C.sections[$].scale)},0)},Ls.prototype.addTextSection=function(C,O){this.text+=C.text,this.sections.push(Vf.forText(C.scale,C.fontStack||O));for(var $=this.sections.length-1,he=0;he<C.text.length;++he)this.sectionIndex.push($)},Ls.prototype.addImageSection=function(C){var O=C.image?C.image.name:"";if(O.length===0){B("Can't add FormattedSection with an empty image.");return}var $=this.getNextImageSectionCharCode();if(!$){B("Reached maximum number of images "+(pv-vv+2));return}this.text+=String.fromCharCode($),this.sections.push(Vf.forImage(O)),this.sectionIndex.push(this.sections.length-1)},Ls.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=pv?null:++this.imageSectionID:(this.imageSectionID=vv,this.imageSectionID)};function n0(E,C){for(var O=[],$=E.text,he=0,me=0,Te=C;me<Te.length;me+=1){var Ie=Te[me];O.push(E.substring(he,Ie)),he=Ie}return he<$.length&&O.push(E.substring(he,$.length)),O}function Vc(E,C,O,$,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr,Dr){var en=Ls.fromFeature(E,he);Pt===El.vertical&&en.verticalizePunctuation();var Kr,Mn=Xa.processBidirectionalText,yn=Xa.processStyledBidirectionalText;if(Mn&&en.sections.length===1){Kr=[];for(var Tn=Mn(en.toString(),Th(en,ut,me,C,$,Gt,cr)),Dn=0,Hn=Tn;Dn<Hn.length;Dn+=1){var oa=Hn[Dn],na=new Ls;na.text=oa,na.sections=en.sections;for(var Ra=0;Ra<oa.length;Ra++)na.sectionIndex.push(0);Kr.push(na)}}else if(yn){Kr=[];for(var wa=yn(en.text,en.sectionIndex,Th(en,ut,me,C,$,Gt,cr)),Sa=0,ei=wa;Sa<ei.length;Sa+=1){var La=ei[Sa],Da=new Ls;Da.text=La[0],Da.sectionIndex=La[1],Da.sections=en.sections,Kr.push(Da)}}else Kr=n0(en,Th(en,ut,me,C,$,Gt,cr));var fi=[],$a={positionedLines:fi,text:en.toString(),top:pt[1],bottom:pt[1],left:pt[0],right:pt[0],writingMode:Pt,iconsInText:!1,verticalizable:!1};return o0($a,C,O,$,Kr,Te,Ie,qe,Pt,ut,Jt,Dr),r0(fi)?!1:$a}var Gu={};Gu[9]=!0,Gu[10]=!0,Gu[11]=!0,Gu[12]=!0,Gu[13]=!0,Gu[32]=!0;var vl={};vl[10]=!0,vl[32]=!0,vl[38]=!0,vl[40]=!0,vl[41]=!0,vl[43]=!0,vl[45]=!0,vl[47]=!0,vl[173]=!0,vl[183]=!0,vl[8203]=!0,vl[8208]=!0,vl[8211]=!0,vl[8231]=!0;function dv(E,C,O,$,he,me){if(C.imageName){var qe=$[C.imageName];return qe?qe.displaySize[0]*C.scale*vs/me+he:0}else{var Te=O[C.fontStack],Ie=Te&&Te[E];return Ie?Ie.metrics.advance*C.scale+he:0}}function a0(E,C,O,$,he,me){for(var Te=0,Ie=0;Ie<E.length();Ie++){var qe=E.getSection(Ie);Te+=dv(E.getCharCode(Ie),qe,$,he,C,me)}var ut=Math.max(1,Math.ceil(Te/O));return Te/ut}function gv(E,C,O,$){var he=Math.pow(E-C,2);return $?E<C?he/2:he*2:he+Math.abs(O)*O}function i0(E,C,O){var $=0;return E===10&&($-=1e4),O&&($+=150),(E===40||E===65288)&&($+=50),(C===41||C===65289)&&($+=50),$}function yv(E,C,O,$,he,me){for(var Te=null,Ie=gv(C,O,he,me),qe=0,ut=$;qe<ut.length;qe+=1){var pt=ut[qe],Pt=C-pt.x,Jt=gv(Pt,O,he,me)+pt.badness;Jt<=Ie&&(Te=pt,Ie=Jt)}return{index:E,x:C,priorBreak:Te,badness:Ie}}function mv(E){return E?mv(E.priorBreak).concat(E.index):[]}function Th(E,C,O,$,he,me,Te){if(me!=="point")return[];if(!E)return[];for(var Ie=[],qe=a0(E,C,O,$,he,Te),ut=E.text.indexOf("\u200B")>=0,pt=0,Pt=0;Pt<E.length();Pt++){var Jt=E.getSection(Pt),Gt=E.getCharCode(Pt);if(Gu[Gt]||(pt+=dv(Gt,Jt,$,he,C,Te)),Pt<E.length()-1){var cr=Mr(Gt);(vl[Gt]||cr||Jt.imageName)&&Ie.push(yv(Pt+1,pt,qe,Ie,i0(Gt,E.getCharCode(Pt+1),cr&&ut),!1))}}return mv(yv(E.length(),pt,qe,Ie,0,!0))}function Ah(E){var C=.5,O=.5;switch(E){case"right":case"top-right":case"bottom-right":C=1;break;case"left":case"top-left":case"bottom-left":C=0;break}switch(E){case"bottom":case"bottom-right":case"bottom-left":O=1;break;case"top":case"top-right":case"top-left":O=0;break}return{horizontalAlign:C,verticalAlign:O}}function o0(E,C,O,$,he,me,Te,Ie,qe,ut,pt,Pt){for(var Jt=0,Gt=gc,cr=0,Dr=0,en=Ie==="right"?1:Ie==="left"?0:.5,Kr=0,Mn=0,yn=he;Mn<yn.length;Mn+=1){var Tn=yn[Mn];Tn.trim();var Dn=Tn.getMaxScale(),Hn=(Dn-1)*vs,oa={positionedGlyphs:[],lineOffset:0};E.positionedLines[Kr]=oa;var na=oa.positionedGlyphs,Ra=0;if(!Tn.length()){Gt+=me,++Kr;continue}for(var wa=0;wa<Tn.length();wa++){var Sa=Tn.getSection(wa),ei=Tn.getSectionIndex(wa),La=Tn.getCharCode(wa),Da=0,fi=null,$a=null,Ci=null,Zi=vs,Li=!(qe===El.horizontal||!pt&&!zr(La)||pt&&(Gu[La]||tn(La)));if(Sa.imageName){var Ao=$[Sa.imageName];if(!Ao)continue;Ci=Sa.imageName,E.iconsInText=E.iconsInText||!0,$a=Ao.paddedRect;var Po=Ao.displaySize;Sa.scale=Sa.scale*vs/Pt,fi={width:Po[0],height:Po[1],left:hl,top:-cv,advance:Li?Po[1]:Po[0]};var es=vs-Po[1]*Sa.scale;Da=Hn+es,Zi=fi.advance;var Go=Li?Po[0]*Sa.scale-vs*Dn:Po[1]*Sa.scale-vs*Dn;Go>0&&Go>Ra&&(Ra=Go)}else{var Pi=O[Sa.fontStack],Mi=Pi&&Pi[La];if(Mi&&Mi.rect)$a=Mi.rect,fi=Mi.metrics;else{var eo=C[Sa.fontStack],ao=eo&&eo[La];if(!ao)continue;fi=ao.metrics}Da=(Dn-Sa.scale)*vs}Li?(E.verticalizable=!0,na.push({glyph:La,imageName:Ci,x:Jt,y:Gt+Da,vertical:Li,scale:Sa.scale,fontStack:Sa.fontStack,sectionIndex:ei,metrics:fi,rect:$a}),Jt+=Zi*Sa.scale+ut):(na.push({glyph:La,imageName:Ci,x:Jt,y:Gt+Da,vertical:Li,scale:Sa.scale,fontStack:Sa.fontStack,sectionIndex:ei,metrics:fi,rect:$a}),Jt+=fi.advance*Sa.scale+ut)}if(na.length!==0){var Ps=Jt-ut;cr=Math.max(Ps,cr),s0(na,0,na.length-1,en,Ra)}Jt=0;var Ds=me*Dn+Ra;oa.lineOffset=Math.max(Ra,Hn),Gt+=Ds,Dr=Math.max(Ds,Dr),++Kr}var ts=Gt-gc,Us=Ah(Te),Vs=Us.horizontalAlign,jo=Us.verticalAlign;l0(E.positionedLines,en,Vs,jo,cr,Dr,me,ts,he.length),E.top+=-jo*ts,E.bottom=E.top+ts,E.left+=-Vs*cr,E.right=E.left+cr}function s0(E,C,O,$,he){if(!(!$&&!he))for(var me=E[O],Te=me.metrics.advance*me.scale,Ie=(E[O].x+Te)*$,qe=C;qe<=O;qe++)E[qe].x-=Ie,E[qe].y+=he}function l0(E,C,O,$,he,me,Te,Ie,qe){var ut=(C-O)*he,pt=0;me!==Te?pt=-Ie*$-gc:pt=(-$*qe+.5)*Te;for(var Pt=0,Jt=E;Pt<Jt.length;Pt+=1)for(var Gt=Jt[Pt],cr=0,Dr=Gt.positionedGlyphs;cr<Dr.length;cr+=1){var en=Dr[cr];en.x+=ut,en.y+=pt}}function u0(E,C,O){var $=Ah(O),he=$.horizontalAlign,me=$.verticalAlign,Te=C[0],Ie=C[1],qe=Te-E.displaySize[0]*he,ut=qe+E.displaySize[0],pt=Ie-E.displaySize[1]*me,Pt=pt+E.displaySize[1];return{image:E,top:pt,bottom:Pt,left:qe,right:ut}}function xv(E,C,O,$,he,me){var Te=E.image,Ie;if(Te.content){var qe=Te.content,ut=Te.pixelRatio||1;Ie=[qe[0]/ut,qe[1]/ut,Te.displaySize[0]-qe[2]/ut,Te.displaySize[1]-qe[3]/ut]}var pt=C.left*me,Pt=C.right*me,Jt,Gt,cr,Dr;O==="width"||O==="both"?(Dr=he[0]+pt-$[3],Gt=he[0]+Pt+$[1]):(Dr=he[0]+(pt+Pt-Te.displaySize[0])/2,Gt=Dr+Te.displaySize[0]);var en=C.top*me,Kr=C.bottom*me;return O==="height"||O==="both"?(Jt=he[1]+en-$[0],cr=he[1]+Kr+$[2]):(Jt=he[1]+(en+Kr-Te.displaySize[1])/2,cr=Jt+Te.displaySize[1]),{image:Te,top:Jt,right:Gt,bottom:cr,left:Dr,collisionPadding:Ie}}var Hf=function(E){function C(O,$,he,me){E.call(this,O,$),this.angle=he,me!==void 0&&(this.segment=me)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.clone=function(){return new C(this.x,this.y,this.angle,this.segment)},C}(f);ze("Anchor",Hf);var Au=128;function Mh(E,C){var O=C.expression;if(O.kind==="constant"){var $=O.evaluate(new si(E+1));return{kind:"constant",layoutSize:$}}else{if(O.kind==="source")return{kind:"source"};for(var he=O.zoomStops,me=O.interpolationType,Te=0;Te<he.length&&he[Te]<=E;)Te++;Te=Math.max(0,Te-1);for(var Ie=Te;Ie<he.length&&he[Ie]<E+1;)Ie++;Ie=Math.min(he.length-1,Ie);var qe=he[Te],ut=he[Ie];if(O.kind==="composite")return{kind:"composite",minZoom:qe,maxZoom:ut,interpolationType:me};var pt=O.evaluate(new si(qe)),Pt=O.evaluate(new si(ut));return{kind:"camera",minZoom:qe,maxZoom:ut,minSize:pt,maxSize:Pt,interpolationType:me}}}function bv(E,C,O){var $=C.uSize,he=C.uSizeT,me=O.lowerSize,Te=O.upperSize;return E.kind==="source"?me/Au:E.kind==="composite"?lo(me/Au,Te/Au,he):$}function _v(E,C){var O=0,$=0;if(E.kind==="constant")$=E.layoutSize;else if(E.kind!=="source"){var he=E.interpolationType,me=E.minZoom,Te=E.maxZoom,Ie=he?h(uo.interpolationFactor(he,C,me,Te),0,1):0;E.kind==="camera"?$=lo(E.minSize,E.maxSize,Ie):O=Ie}return{uSizeT:O,uSize:$}}var f0=Object.freeze({__proto__:null,getSizeData:Mh,evaluateSizeForFeature:bv,evaluateSizeForZoom:_v,SIZE_PACK_FACTOR:Au});function wv(E,C,O,$,he){if(C.segment===void 0)return!0;for(var me=C,Te=C.segment+1,Ie=0;Ie>-O/2;){if(Te--,Te<0)return!1;Ie-=E[Te].dist(me),me=E[Te]}Ie+=E[Te].dist(E[Te+1]),Te++;for(var qe=[],ut=0;Ie<O/2;){var pt=E[Te-1],Pt=E[Te],Jt=E[Te+1];if(!Jt)return!1;var Gt=pt.angleTo(Pt)-Pt.angleTo(Jt);for(Gt=Math.abs((Gt+3*Math.PI)%(Math.PI*2)-Math.PI),qe.push({distance:Ie,angleDelta:Gt}),ut+=Gt;Ie-qe[0].distance>$;)ut-=qe.shift().angleDelta;if(ut>he)return!1;Te++,Ie+=Pt.dist(Jt)}return!0}function Tv(E){for(var C=0,O=0;O<E.length-1;O++)C+=E[O].dist(E[O+1]);return C}function Av(E,C,O){return E?3/5*C*O:0}function Mv(E,C){return Math.max(E?E.right-E.left:0,C?C.right-C.left:0)}function c0(E,C,O,$,he,me){for(var Te=Av(O,he,me),Ie=Mv(O,$)*me,qe=0,ut=Tv(E)/2,pt=0;pt<E.length-1;pt++){var Pt=E[pt],Jt=E[pt+1],Gt=Pt.dist(Jt);if(qe+Gt>ut){var cr=(ut-qe)/Gt,Dr=lo(Pt.x,Jt.x,cr),en=lo(Pt.y,Jt.y,cr),Kr=new Hf(Dr,en,Jt.angleTo(Pt),pt);return Kr._round(),!Te||wv(E,Kr,Ie,Te,C)?Kr:void 0}qe+=Gt}}function h0(E,C,O,$,he,me,Te,Ie,qe){var ut=Av($,me,Te),pt=Mv($,he),Pt=pt*Te,Jt=E[0].x===0||E[0].x===qe||E[0].y===0||E[0].y===qe;C-Pt<C/4&&(C=Pt+C/4);var Gt=me*2,cr=Jt?C/2*Ie%C:(pt/2+Gt)*Te*Ie%C;return Sv(E,cr,C,ut,O,Pt,Jt,!1,qe)}function Sv(E,C,O,$,he,me,Te,Ie,qe){for(var ut=me/2,pt=Tv(E),Pt=0,Jt=C-O,Gt=[],cr=0;cr<E.length-1;cr++){for(var Dr=E[cr],en=E[cr+1],Kr=Dr.dist(en),Mn=en.angleTo(Dr);Jt+O<Pt+Kr;){Jt+=O;var yn=(Jt-Pt)/Kr,Tn=lo(Dr.x,en.x,yn),Dn=lo(Dr.y,en.y,yn);if(Tn>=0&&Tn<qe&&Dn>=0&&Dn<qe&&Jt-ut>=0&&Jt+ut<=pt){var Hn=new Hf(Tn,Dn,Mn,cr);Hn._round(),(!$||wv(E,Hn,me,$,he))&&Gt.push(Hn)}}Pt+=Kr}return!Ie&&!Gt.length&&!Te&&(Gt=Sv(E,Pt/2,O,$,he,me,Te,!0,qe)),Gt}function kv(E,C,O,$,he){for(var me=[],Te=0;Te<E.length;Te++)for(var Ie=E[Te],qe=void 0,ut=0;ut<Ie.length-1;ut++){var pt=Ie[ut],Pt=Ie[ut+1];pt.x<C&&Pt.x<C||(pt.x<C?pt=new f(C,pt.y+(Pt.y-pt.y)*((C-pt.x)/(Pt.x-pt.x)))._round():Pt.x<C&&(Pt=new f(C,pt.y+(Pt.y-pt.y)*((C-pt.x)/(Pt.x-pt.x)))._round()),!(pt.y<O&&Pt.y<O)&&(pt.y<O?pt=new f(pt.x+(Pt.x-pt.x)*((O-pt.y)/(Pt.y-pt.y)),O)._round():Pt.y<O&&(Pt=new f(pt.x+(Pt.x-pt.x)*((O-pt.y)/(Pt.y-pt.y)),O)._round()),!(pt.x>=$&&Pt.x>=$)&&(pt.x>=$?pt=new f($,pt.y+(Pt.y-pt.y)*(($-pt.x)/(Pt.x-pt.x)))._round():Pt.x>=$&&(Pt=new f($,pt.y+(Pt.y-pt.y)*(($-pt.x)/(Pt.x-pt.x)))._round()),!(pt.y>=he&&Pt.y>=he)&&(pt.y>=he?pt=new f(pt.x+(Pt.x-pt.x)*((he-pt.y)/(Pt.y-pt.y)),he)._round():Pt.y>=he&&(Pt=new f(pt.x+(Pt.x-pt.x)*((he-pt.y)/(Pt.y-pt.y)),he)._round()),(!qe||!pt.equals(qe[qe.length-1]))&&(qe=[pt],me.push(qe)),qe.push(Pt)))))}return me}var Gf=hl;function Ev(E,C,O,$){var he=[],me=E.image,Te=me.pixelRatio,Ie=me.paddedRect.w-2*Gf,qe=me.paddedRect.h-2*Gf,ut=E.right-E.left,pt=E.bottom-E.top,Pt=me.stretchX||[[0,Ie]],Jt=me.stretchY||[[0,qe]],Gt=function(Pi,Mi){return Pi+Mi[1]-Mi[0]},cr=Pt.reduce(Gt,0),Dr=Jt.reduce(Gt,0),en=Ie-cr,Kr=qe-Dr,Mn=0,yn=cr,Tn=0,Dn=Dr,Hn=0,oa=en,na=0,Ra=Kr;if(me.content&&$){var wa=me.content;Mn=Hc(Pt,0,wa[0]),Tn=Hc(Jt,0,wa[1]),yn=Hc(Pt,wa[0],wa[2]),Dn=Hc(Jt,wa[1],wa[3]),Hn=wa[0]-Mn,na=wa[1]-Tn,oa=wa[2]-wa[0]-yn,Ra=wa[3]-wa[1]-Dn}var Sa=function(Pi,Mi,eo,ao){var Ao=Gc(Pi.stretch-Mn,yn,ut,E.left),Po=Yc(Pi.fixed-Hn,oa,Pi.stretch,cr),es=Gc(Mi.stretch-Tn,Dn,pt,E.top),Go=Yc(Mi.fixed-na,Ra,Mi.stretch,Dr),Ps=Gc(eo.stretch-Mn,yn,ut,E.left),Ds=Yc(eo.fixed-Hn,oa,eo.stretch,cr),ts=Gc(ao.stretch-Tn,Dn,pt,E.top),Us=Yc(ao.fixed-na,Ra,ao.stretch,Dr),Vs=new f(Ao,es),jo=new f(Ps,es),Hs=new f(Ps,ts),Cl=new f(Ao,ts),Qu=new f(Po/Te,Go/Te),ff=new f(Ds/Te,Us/Te),cf=C*Math.PI/180;if(cf){var hf=Math.sin(cf),Qf=Math.cos(cf),nu=[Qf,-hf,hf,Qf];Vs._matMult(nu),jo._matMult(nu),Cl._matMult(nu),Hs._matMult(nu)}var Jc=Pi.stretch+Pi.fixed,Rh=eo.stretch+eo.fixed,Qc=Mi.stretch+Mi.fixed,Ih=ao.stretch+ao.fixed,Gl={x:me.paddedRect.x+Gf+Jc,y:me.paddedRect.y+Gf+Qc,w:Rh-Jc,h:Ih-Qc},$f=oa/Te/ut,$c=Ra/Te/pt;return{tl:Vs,tr:jo,bl:Cl,br:Hs,tex:Gl,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Qu,pixelOffsetBR:ff,minFontScaleX:$f,minFontScaleY:$c,isSDF:O}};if(!$||!me.stretchX&&!me.stretchY)he.push(Sa({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Ie+1},{fixed:0,stretch:qe+1}));else for(var ei=Cv(Pt,en,cr),La=Cv(Jt,Kr,Dr),Da=0;Da<ei.length-1;Da++)for(var fi=ei[Da],$a=ei[Da+1],Ci=0;Ci<La.length-1;Ci++){var Zi=La[Ci],Li=La[Ci+1];he.push(Sa(fi,Zi,$a,Li))}return he}function Hc(E,C,O){for(var $=0,he=0,me=E;he<me.length;he+=1){var Te=me[he];$+=Math.max(C,Math.min(O,Te[1]))-Math.max(C,Math.min(O,Te[0]))}return $}function Cv(E,C,O){for(var $=[{fixed:-Gf,stretch:0}],he=0,me=E;he<me.length;he+=1){var Te=me[he],Ie=Te[0],qe=Te[1],ut=$[$.length-1];$.push({fixed:Ie-ut.stretch,stretch:ut.stretch}),$.push({fixed:Ie-ut.stretch,stretch:ut.stretch+(qe-Ie)})}return $.push({fixed:C+Gf,stretch:O}),$}function Gc(E,C,O,$){return E/C*O+$}function Yc(E,C,O,$){return E-C*O/$}function v0(E,C,O,$,he,me,Te,Ie){for(var qe=$.layout.get("text-rotate").evaluate(me,{})*Math.PI/180,ut=[],pt=0,Pt=C.positionedLines;pt<Pt.length;pt+=1)for(var Jt=Pt[pt],Gt=0,cr=Jt.positionedGlyphs;Gt<cr.length;Gt+=1){var Dr=cr[Gt];if(!!Dr.rect){var en=Dr.rect||{},Kr=1,Mn=cv+Kr,yn=!0,Tn=1,Dn=0,Hn=(he||Ie)&&Dr.vertical,oa=Dr.metrics.advance*Dr.scale/2;if(Ie&&C.verticalizable){var na=(Dr.scale-1)*vs,Ra=(vs-Dr.metrics.width*Dr.scale)/2;Dn=Jt.lineOffset/2-(Dr.imageName?-Ra:na)}if(Dr.imageName){var wa=Te[Dr.imageName];yn=wa.sdf,Tn=wa.pixelRatio,Mn=hl/Tn}var Sa=he?[Dr.x+oa,Dr.y]:[0,0],ei=he?[0,0]:[Dr.x+oa+O[0],Dr.y+O[1]-Dn],La=[0,0];Hn&&(La=ei,ei=[0,0]);var Da=(Dr.metrics.left-Mn)*Dr.scale-oa+ei[0],fi=(-Dr.metrics.top-Mn)*Dr.scale+ei[1],$a=Da+en.w*Dr.scale/Tn,Ci=fi+en.h*Dr.scale/Tn,Zi=new f(Da,fi),Li=new f($a,fi),Pi=new f(Da,Ci),Mi=new f($a,Ci);if(Hn){var eo=new f(-oa,oa-gc),ao=-Math.PI/2,Ao=vs/2-oa,Po=Dr.imageName?Ao:0,es=new f(5-gc-Ao,-Po),Go=new(Function.prototype.bind.apply(f,[null].concat(La)));Zi._rotateAround(ao,eo)._add(es)._add(Go),Li._rotateAround(ao,eo)._add(es)._add(Go),Pi._rotateAround(ao,eo)._add(es)._add(Go),Mi._rotateAround(ao,eo)._add(es)._add(Go)}if(qe){var Ps=Math.sin(qe),Ds=Math.cos(qe),ts=[Ds,-Ps,Ps,Ds];Zi._matMult(ts),Li._matMult(ts),Pi._matMult(ts),Mi._matMult(ts)}var Us=new f(0,0),Vs=new f(0,0),jo=0,Hs=0;ut.push({tl:Zi,tr:Li,bl:Pi,br:Mi,tex:en,writingMode:C.writingMode,glyphOffset:Sa,sectionIndex:Dr.sectionIndex,isSDF:yn,pixelOffsetTL:Us,pixelOffsetBR:Vs,minFontScaleX:jo,minFontScaleY:Hs})}}return ut}var Wc=function(C,O,$,he,me,Te,Ie,qe,ut,pt){if(this.boxStartIndex=C.length,ut){var Pt=Te.top,Jt=Te.bottom,Gt=Te.collisionPadding;Gt&&(Pt-=Gt[1],Jt+=Gt[3]);var cr=Jt-Pt;cr>0&&(cr=Math.max(10,cr),this.circleDiameter=cr)}else{var Dr=Te.top*Ie-qe,en=Te.bottom*Ie+qe,Kr=Te.left*Ie-qe,Mn=Te.right*Ie+qe,yn=Te.collisionPadding;if(yn&&(Kr-=yn[0]*Ie,Dr-=yn[1]*Ie,Mn+=yn[2]*Ie,en+=yn[3]*Ie),pt){var Tn=new f(Kr,Dr),Dn=new f(Mn,Dr),Hn=new f(Kr,en),oa=new f(Mn,en),na=pt*Math.PI/180;Tn._rotate(na),Dn._rotate(na),Hn._rotate(na),oa._rotate(na),Kr=Math.min(Tn.x,Dn.x,Hn.x,oa.x),Mn=Math.max(Tn.x,Dn.x,Hn.x,oa.x),Dr=Math.min(Tn.y,Dn.y,Hn.y,oa.y),en=Math.max(Tn.y,Dn.y,Hn.y,oa.y)}C.emplaceBack(O.x,O.y,Kr,Dr,Mn,en,$,he,me)}this.boxEndIndex=C.length},Yf=function(C,O){if(C===void 0&&(C=[]),O===void 0&&(O=p0),this.data=C,this.length=this.data.length,this.compare=O,this.length>0)for(var $=(this.length>>1)-1;$>=0;$--)this._down($)};Yf.prototype.push=function(C){this.data.push(C),this.length++,this._up(this.length-1)},Yf.prototype.pop=function(){if(this.length!==0){var C=this.data[0],O=this.data.pop();return this.length--,this.length>0&&(this.data[0]=O,this._down(0)),C}},Yf.prototype.peek=function(){return this.data[0]},Yf.prototype._up=function(C){for(var O=this,$=O.data,he=O.compare,me=$[C];C>0;){var Te=C-1>>1,Ie=$[Te];if(he(me,Ie)>=0)break;$[C]=Ie,C=Te}$[C]=me},Yf.prototype._down=function(C){for(var O=this,$=O.data,he=O.compare,me=this.length>>1,Te=$[C];C<me;){var Ie=(C<<1)+1,qe=$[Ie],ut=Ie+1;if(ut<this.length&&he($[ut],qe)<0&&(Ie=ut,qe=$[ut]),he(qe,Te)>=0)break;$[C]=qe,C=Ie}$[C]=Te};function p0(E,C){return E<C?-1:E>C?1:0}function d0(E,C,O){C===void 0&&(C=1),O===void 0&&(O=!1);for(var $=1/0,he=1/0,me=-1/0,Te=-1/0,Ie=E[0],qe=0;qe<Ie.length;qe++){var ut=Ie[qe];(!qe||ut.x<$)&&($=ut.x),(!qe||ut.y<he)&&(he=ut.y),(!qe||ut.x>me)&&(me=ut.x),(!qe||ut.y>Te)&&(Te=ut.y)}var pt=me-$,Pt=Te-he,Jt=Math.min(pt,Pt),Gt=Jt/2,cr=new Yf([],g0);if(Jt===0)return new f($,he);for(var Dr=$;Dr<me;Dr+=Jt)for(var en=he;en<Te;en+=Jt)cr.push(new Wf(Dr+Gt,en+Gt,Gt,E));for(var Kr=m0(E),Mn=cr.length;cr.length;){var yn=cr.pop();(yn.d>Kr.d||!Kr.d)&&(Kr=yn,O&&console.log("found best %d after %d probes",Math.round(1e4*yn.d)/1e4,Mn)),!(yn.max-Kr.d<=C)&&(Gt=yn.h/2,cr.push(new Wf(yn.p.x-Gt,yn.p.y-Gt,Gt,E)),cr.push(new Wf(yn.p.x+Gt,yn.p.y-Gt,Gt,E)),cr.push(new Wf(yn.p.x-Gt,yn.p.y+Gt,Gt,E)),cr.push(new Wf(yn.p.x+Gt,yn.p.y+Gt,Gt,E)),Mn+=4)}return O&&(console.log("num probes: "+Mn),console.log("best distance: "+Kr.d)),Kr.p}function g0(E,C){return C.max-E.max}function Wf(E,C,O,$){this.p=new f(E,C),this.h=O,this.d=y0(this.p,$),this.max=this.d+this.h*Math.SQRT2}function y0(E,C){for(var O=!1,$=1/0,he=0;he<C.length;he++)for(var me=C[he],Te=0,Ie=me.length,qe=Ie-1;Te<Ie;qe=Te++){var ut=me[Te],pt=me[qe];ut.y>E.y!=pt.y>E.y&&E.x<(pt.x-ut.x)*(E.y-ut.y)/(pt.y-ut.y)+ut.x&&(O=!O),$=Math.min($,_u(E,ut,pt))}return(O?1:-1)*Math.sqrt($)}function m0(E){for(var C=0,O=0,$=0,he=E[0],me=0,Te=he.length,Ie=Te-1;me<Te;Ie=me++){var qe=he[me],ut=he[Ie],pt=qe.x*ut.y-ut.x*qe.y;O+=(qe.x+ut.x)*pt,$+=(qe.y+ut.y)*pt,C+=pt*3}return new Wf(O/C,$/C,0,E)}var Xf=7,Sh=Number.POSITIVE_INFINITY;function Lv(E,C){function O(he,me){var Te=0,Ie=0;me<0&&(me=0);var qe=me/Math.sqrt(2);switch(he){case"top-right":case"top-left":Ie=qe-Xf;break;case"bottom-right":case"bottom-left":Ie=-qe+Xf;break;case"bottom":Ie=-me+Xf;break;case"top":Ie=me-Xf;break}switch(he){case"top-right":case"bottom-right":Te=-qe;break;case"top-left":case"bottom-left":Te=qe;break;case"left":Te=me;break;case"right":Te=-me;break}return[Te,Ie]}function $(he,me,Te){var Ie=0,qe=0;switch(me=Math.abs(me),Te=Math.abs(Te),he){case"top-right":case"top-left":case"top":qe=Te-Xf;break;case"bottom-right":case"bottom-left":case"bottom":qe=-Te+Xf;break}switch(he){case"top-right":case"bottom-right":case"right":Ie=-me;break;case"top-left":case"bottom-left":case"left":Ie=me;break}return[Ie,qe]}return C[1]!==Sh?$(E,C[0],C[1]):O(E,C[0])}function x0(E,C,O,$,he,me,Te){E.createArrays();var Ie=512*E.overscaling;E.tilePixelRatio=Ba/Ie,E.compareText={},E.iconsNeedLinear=!1;var qe=E.layers[0].layout,ut=E.layers[0]._unevaluatedLayout._values,pt={};if(E.textSizeData.kind==="composite"){var Pt=E.textSizeData,Jt=Pt.minZoom,Gt=Pt.maxZoom;pt.compositeTextSizes=[ut["text-size"].possiblyEvaluate(new si(Jt),Te),ut["text-size"].possiblyEvaluate(new si(Gt),Te)]}if(E.iconSizeData.kind==="composite"){var cr=E.iconSizeData,Dr=cr.minZoom,en=cr.maxZoom;pt.compositeIconSizes=[ut["icon-size"].possiblyEvaluate(new si(Dr),Te),ut["icon-size"].possiblyEvaluate(new si(en),Te)]}pt.layoutTextSize=ut["text-size"].possiblyEvaluate(new si(E.zoom+1),Te),pt.layoutIconSize=ut["icon-size"].possiblyEvaluate(new si(E.zoom+1),Te),pt.textMaxSize=ut["text-size"].possiblyEvaluate(new si(18));for(var Kr=qe.get("text-line-height")*vs,Mn=qe.get("text-rotation-alignment")==="map"&&qe.get("symbol-placement")!=="point",yn=qe.get("text-keep-upright"),Tn=qe.get("text-size"),Dn=function(){var na=oa[Hn],Ra=qe.get("text-font").evaluate(na,{},Te).join(","),wa=Tn.evaluate(na,{},Te),Sa=pt.layoutTextSize.evaluate(na,{},Te),ei=pt.layoutIconSize.evaluate(na,{},Te),La={horizontal:{},vertical:void 0},Da=na.text,fi=[0,0];if(Da){var $a=Da.toString(),Ci=qe.get("text-letter-spacing").evaluate(na,{},Te)*vs,Zi=Zr($a)?Ci:0,Li=qe.get("text-anchor").evaluate(na,{},Te),Pi=qe.get("text-variable-anchor");if(!Pi){var Mi=qe.get("text-radial-offset").evaluate(na,{},Te);Mi?fi=Lv(Li,[Mi*vs,Sh]):fi=qe.get("text-offset").evaluate(na,{},Te).map(function(Qu){return Qu*vs})}var eo=Mn?"center":qe.get("text-justify").evaluate(na,{},Te),ao=qe.get("symbol-placement"),Ao=ao==="point"?qe.get("text-max-width").evaluate(na,{},Te)*vs:0,Po=function(){E.allowVerticalPlacement&&br($a)&&(La.vertical=Vc(Da,C,O,he,Ra,Ao,Kr,Li,"left",Zi,fi,El.vertical,!0,ao,Sa,wa))};if(!Mn&&Pi){for(var es=eo==="auto"?Pi.map(function(Qu){return kh(Qu)}):[eo],Go=!1,Ps=0;Ps<es.length;Ps++){var Ds=es[Ps];if(!La.horizontal[Ds])if(Go)La.horizontal[Ds]=La.horizontal[0];else{var ts=Vc(Da,C,O,he,Ra,Ao,Kr,"center",Ds,Zi,fi,El.horizontal,!1,ao,Sa,wa);ts&&(La.horizontal[Ds]=ts,Go=ts.positionedLines.length===1)}}Po()}else{eo==="auto"&&(eo=kh(Li));var Us=Vc(Da,C,O,he,Ra,Ao,Kr,Li,eo,Zi,fi,El.horizontal,!1,ao,Sa,wa);Us&&(La.horizontal[eo]=Us),Po(),br($a)&&Mn&&yn&&(La.vertical=Vc(Da,C,O,he,Ra,Ao,Kr,Li,eo,Zi,fi,El.vertical,!1,ao,Sa,wa))}}var Vs=void 0,jo=!1;if(na.icon&&na.icon.name){var Hs=$[na.icon.name];Hs&&(Vs=u0(he[na.icon.name],qe.get("icon-offset").evaluate(na,{},Te),qe.get("icon-anchor").evaluate(na,{},Te)),jo=Hs.sdf,E.sdfIcons===void 0?E.sdfIcons=Hs.sdf:E.sdfIcons!==Hs.sdf&&B("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Hs.pixelRatio!==E.pixelRatio||qe.get("icon-rotate").constantOr(1)!==0)&&(E.iconsNeedLinear=!0))}var Cl=Dv(La.horizontal)||La.vertical;E.iconsInText=Cl?Cl.iconsInText:!1,(Cl||Vs)&&b0(E,na,La,Vs,$,pt,Sa,ei,fi,jo,Te)},Hn=0,oa=E.features;Hn<oa.length;Hn+=1)Dn();me&&E.generateCollisionDebugBuffers()}function kh(E){switch(E){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function b0(E,C,O,$,he,me,Te,Ie,qe,ut,pt){var Pt=me.textMaxSize.evaluate(C,{});Pt===void 0&&(Pt=Te);var Jt=E.layers[0].layout,Gt=Jt.get("icon-offset").evaluate(C,{},pt),cr=Dv(O.horizontal),Dr=24,en=Te/Dr,Kr=E.tilePixelRatio*en,Mn=E.tilePixelRatio*Pt/Dr,yn=E.tilePixelRatio*Ie,Tn=E.tilePixelRatio*Jt.get("symbol-spacing"),Dn=Jt.get("text-padding")*E.tilePixelRatio,Hn=Jt.get("icon-padding")*E.tilePixelRatio,oa=Jt.get("text-max-angle")/180*Math.PI,na=Jt.get("text-rotation-alignment")==="map"&&Jt.get("symbol-placement")!=="point",Ra=Jt.get("icon-rotation-alignment")==="map"&&Jt.get("symbol-placement")!=="point",wa=Jt.get("symbol-placement"),Sa=Tn/2,ei=Jt.get("icon-text-fit"),La;$&&ei!=="none"&&(E.allowVerticalPlacement&&O.vertical&&(La=xv($,O.vertical,ei,Jt.get("icon-text-fit-padding"),Gt,en)),cr&&($=xv($,cr,ei,Jt.get("icon-text-fit-padding"),Gt,en)));var Da=function(Qf,nu){nu.x<0||nu.x>=Ba||nu.y<0||nu.y>=Ba||_0(E,nu,Qf,O,$,he,La,E.layers[0],E.collisionBoxArray,C.index,C.sourceLayerIndex,E.index,Kr,Dn,na,qe,yn,Hn,Ra,Gt,C,me,ut,pt,Te)};if(wa==="line")for(var fi=0,$a=kv(C.geometry,0,0,Ba,Ba);fi<$a.length;fi+=1)for(var Ci=$a[fi],Zi=h0(Ci,Tn,oa,O.vertical||cr,$,Dr,Mn,E.overscaling,Ba),Li=0,Pi=Zi;Li<Pi.length;Li+=1){var Mi=Pi[Li],eo=cr;(!eo||!w0(E,eo.text,Sa,Mi))&&Da(Ci,Mi)}else if(wa==="line-center")for(var ao=0,Ao=C.geometry;ao<Ao.length;ao+=1){var Po=Ao[ao];if(Po.length>1){var es=c0(Po,oa,O.vertical||cr,$,Dr,Mn);es&&Da(Po,es)}}else if(C.type==="Polygon")for(var Go=0,Ps=gh(C.geometry,0);Go<Ps.length;Go+=1){var Ds=Ps[Go],ts=d0(Ds,16);Da(Ds[0],new Hf(ts.x,ts.y,0))}else if(C.type==="LineString")for(var Us=0,Vs=C.geometry;Us<Vs.length;Us+=1){var jo=Vs[Us];Da(jo,new Hf(jo[0].x,jo[0].y,0))}else if(C.type==="Point")for(var Hs=0,Cl=C.geometry;Hs<Cl.length;Hs+=1)for(var Qu=Cl[Hs],ff=0,cf=Qu;ff<cf.length;ff+=1){var hf=cf[ff];Da([hf],new Hf(hf.x,hf.y,0))}}var yc=255,lf=yc*Au;function Pv(E,C,O,$,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr){var Dr=v0(C,O,Ie,he,me,Te,$,E.allowVerticalPlacement),en=E.textSizeData,Kr=null;en.kind==="source"?(Kr=[Au*he.layout.get("text-size").evaluate(Te,{})],Kr[0]>lf&&B(E.layerIds[0]+': Value for "text-size" is >= '+yc+'. Reduce your "text-size".')):en.kind==="composite"&&(Kr=[Au*Gt.compositeTextSizes[0].evaluate(Te,{},cr),Au*Gt.compositeTextSizes[1].evaluate(Te,{},cr)],(Kr[0]>lf||Kr[1]>lf)&&B(E.layerIds[0]+': Value for "text-size" is >= '+yc+'. Reduce your "text-size".')),E.addSymbols(E.text,Dr,Kr,Ie,me,Te,ut,C,qe.lineStartIndex,qe.lineLength,Jt,cr);for(var Mn=0,yn=pt;Mn<yn.length;Mn+=1){var Tn=yn[Mn];Pt[Tn]=E.text.placedSymbolArray.length-1}return Dr.length*4}function Dv(E){for(var C in E)return E[C];return null}function _0(E,C,O,$,he,me,Te,Ie,qe,ut,pt,Pt,Jt,Gt,cr,Dr,en,Kr,Mn,yn,Tn,Dn,Hn,oa,na){var Ra,wa=E.addToLineVertexArray(C,O),Sa,ei,La,Da,fi=0,$a=0,Ci=0,Zi=0,Li=-1,Pi=-1,Mi={},eo=Ce(""),ao=0,Ao=0;if(Ie._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Ra=Ie.layout.get("text-offset").evaluate(Tn,{},oa).map(function(bc){return bc*vs}),ao=Ra[0],Ao=Ra[1]):(ao=Ie.layout.get("text-radial-offset").evaluate(Tn,{},oa)*vs,Ao=Sh),E.allowVerticalPlacement&&$.vertical){var Po=Ie.layout.get("text-rotate").evaluate(Tn,{},oa),es=Po+90,Go=$.vertical;La=new Wc(qe,C,ut,pt,Pt,Go,Jt,Gt,cr,es),Te&&(Da=new Wc(qe,C,ut,pt,Pt,Te,en,Kr,cr,es))}if(he){var Ps=Ie.layout.get("icon-rotate").evaluate(Tn,{}),Ds=Ie.layout.get("icon-text-fit")!=="none",ts=Ev(he,Ps,Hn,Ds),Us=Te?Ev(Te,Ps,Hn,Ds):void 0;ei=new Wc(qe,C,ut,pt,Pt,he,en,Kr,!1,Ps),fi=ts.length*4;var Vs=E.iconSizeData,jo=null;Vs.kind==="source"?(jo=[Au*Ie.layout.get("icon-size").evaluate(Tn,{})],jo[0]>lf&&B(E.layerIds[0]+': Value for "icon-size" is >= '+yc+'. Reduce your "icon-size".')):Vs.kind==="composite"&&(jo=[Au*Dn.compositeIconSizes[0].evaluate(Tn,{},oa),Au*Dn.compositeIconSizes[1].evaluate(Tn,{},oa)],(jo[0]>lf||jo[1]>lf)&&B(E.layerIds[0]+': Value for "icon-size" is >= '+yc+'. Reduce your "icon-size".')),E.addSymbols(E.icon,ts,jo,yn,Mn,Tn,!1,C,wa.lineStartIndex,wa.lineLength,-1,oa),Li=E.icon.placedSymbolArray.length-1,Us&&($a=Us.length*4,E.addSymbols(E.icon,Us,jo,yn,Mn,Tn,El.vertical,C,wa.lineStartIndex,wa.lineLength,-1,oa),Pi=E.icon.placedSymbolArray.length-1)}for(var Hs in $.horizontal){var Cl=$.horizontal[Hs];if(!Sa){eo=Ce(Cl.text);var Qu=Ie.layout.get("text-rotate").evaluate(Tn,{},oa);Sa=new Wc(qe,C,ut,pt,Pt,Cl,Jt,Gt,cr,Qu)}var ff=Cl.positionedLines.length===1;if(Ci+=Pv(E,C,Cl,me,Ie,cr,Tn,Dr,wa,$.vertical?El.horizontal:El.horizontalOnly,ff?Object.keys($.horizontal):[Hs],Mi,Li,Dn,oa),ff)break}$.vertical&&(Zi+=Pv(E,C,$.vertical,me,Ie,cr,Tn,Dr,wa,El.vertical,["vertical"],Mi,Pi,Dn,oa));var cf=Sa?Sa.boxStartIndex:E.collisionBoxArray.length,hf=Sa?Sa.boxEndIndex:E.collisionBoxArray.length,Qf=La?La.boxStartIndex:E.collisionBoxArray.length,nu=La?La.boxEndIndex:E.collisionBoxArray.length,Jc=ei?ei.boxStartIndex:E.collisionBoxArray.length,Rh=ei?ei.boxEndIndex:E.collisionBoxArray.length,Qc=Da?Da.boxStartIndex:E.collisionBoxArray.length,Ih=Da?Da.boxEndIndex:E.collisionBoxArray.length,Gl=-1,$f=function(bc,jv){return bc&&bc.circleDiameter?Math.max(bc.circleDiameter,jv):jv};Gl=$f(Sa,Gl),Gl=$f(La,Gl),Gl=$f(ei,Gl),Gl=$f(Da,Gl);var $c=Gl>-1?1:0;$c&&(Gl*=na/vs),E.glyphOffsetArray.length>=Xi.MAX_GLYPHS&&B("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Tn.sortKey!==void 0&&E.addToSortKeyRanges(E.symbolInstances.length,Tn.sortKey),E.symbolInstances.emplaceBack(C.x,C.y,Mi.right>=0?Mi.right:-1,Mi.center>=0?Mi.center:-1,Mi.left>=0?Mi.left:-1,Mi.vertical||-1,Li,Pi,eo,cf,hf,Qf,nu,Jc,Rh,Qc,Ih,ut,Ci,Zi,fi,$a,$c,0,Jt,ao,Ao,Gl)}function w0(E,C,O,$){var he=E.compareText;if(!(C in he))he[C]=[];else for(var me=he[C],Te=me.length-1;Te>=0;Te--)if($.dist(me[Te])<O)return!0;return he[C].push($),!1}var T0=Bf.VectorTileFeature.types,A0=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Xc(E,C,O,$,he,me,Te,Ie,qe,ut,pt,Pt,Jt){var Gt=Ie?Math.min(lf,Math.round(Ie[0])):0,cr=Ie?Math.min(lf,Math.round(Ie[1])):0;E.emplaceBack(C,O,Math.round($*32),Math.round(he*32),me,Te,(Gt<<1)+(qe?1:0),cr,ut*16,pt*16,Pt*256,Jt*256)}function Eh(E,C,O){E.emplaceBack(C.x,C.y,O),E.emplaceBack(C.x,C.y,O),E.emplaceBack(C.x,C.y,O),E.emplaceBack(C.x,C.y,O)}function M0(E){for(var C=0,O=E.sections;C<O.length;C+=1){var $=O[C];if(ta($.text))return!0}return!1}var Zf=function(C){this.layoutVertexArray=new Bu,this.indexArray=new bu,this.programConfigurations=C,this.segments=new H,this.dynamicLayoutVertexArray=new qf,this.opacityVertexArray=new ec,this.placedSymbolArray=new nf};Zf.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Zf.prototype.upload=function(C,O,$,he){this.isEmpty()||($&&(this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,bh.members),this.indexBuffer=C.createIndexBuffer(this.indexArray,O),this.dynamicLayoutVertexBuffer=C.createVertexBuffer(this.dynamicLayoutVertexArray,Sd.members,!0),this.opacityVertexBuffer=C.createVertexBuffer(this.opacityVertexArray,A0,!0),this.opacityVertexBuffer.itemSize=1),($||he)&&this.programConfigurations.upload(C))},Zf.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},ze("SymbolBuffers",Zf);var mc=function(C,O,$){this.layoutVertexArray=new C,this.layoutAttributes=O,this.indexArray=new $,this.segments=new H,this.collisionVertexArray=new $s};mc.prototype.upload=function(C){this.layoutVertexBuffer=C.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=C.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=C.createVertexBuffer(this.collisionVertexArray,kd.members,!0)},mc.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},ze("CollisionBuffers",mc);var Xi=function(C){this.collisionBoxArray=C.collisionBoxArray,this.zoom=C.zoom,this.overscaling=C.overscaling,this.layers=C.layers,this.layerIds=this.layers.map(function(qe){return qe.id}),this.index=C.index,this.pixelRatio=C.pixelRatio,this.sourceLayerIndex=C.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Rf([]),this.placementViewportMatrix=Rf([]);var O=this.layers[0],$=O._unevaluatedLayout._values;this.textSizeData=Mh(this.zoom,$["text-size"]),this.iconSizeData=Mh(this.zoom,$["icon-size"]);var he=this.layers[0].layout,me=he.get("symbol-sort-key"),Te=he.get("symbol-z-order");this.sortFeaturesByKey=Te!=="viewport-y"&&me.constantOr(1)!==void 0;var Ie=Te==="viewport-y"||Te==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=Ie&&(he.get("text-allow-overlap")||he.get("icon-allow-overlap")||he.get("text-ignore-placement")||he.get("icon-ignore-placement")),he.get("symbol-placement")==="point"&&(this.writingModes=he.get("text-writing-mode").map(function(qe){return El[qe]})),this.stateDependentLayerIds=this.layers.filter(function(qe){return qe.isStateDependent()}).map(function(qe){return qe.id}),this.sourceID=C.sourceID};Xi.prototype.createArrays=function(){this.text=new Zf(new ri(bh.members,this.layers,this.zoom,function(C){return/^text/.test(C)})),this.icon=new Zf(new ri(bh.members,this.layers,this.zoom,function(C){return/^icon/.test(C)})),this.glyphOffsetArray=new Vl,this.lineVertexArray=new Ec,this.symbolInstances=new kc},Xi.prototype.calculateGlyphDependencies=function(C,O,$,he,me){for(var Te=0;Te<C.length;Te++)if(O[C.charCodeAt(Te)]=!0,($||he)&&me){var Ie=vc[C.charAt(Te)];Ie&&(O[Ie.charCodeAt(0)]=!0)}},Xi.prototype.populate=function(C,O,$){var he=this.layers[0],me=he.layout,Te=me.get("text-font"),Ie=me.get("text-field"),qe=me.get("icon-image"),ut=(Ie.value.kind!=="constant"||Ie.value.value instanceof Hi&&!Ie.value.value.isEmpty()||Ie.value.value.toString().length>0)&&(Te.value.kind!=="constant"||Te.value.value.length>0),pt=qe.value.kind!=="constant"||!!qe.value.value||Object.keys(qe.parameters).length>0,Pt=me.get("symbol-sort-key");if(this.features=[],!(!ut&&!pt)){for(var Jt=O.iconDependencies,Gt=O.glyphDependencies,cr=O.availableImages,Dr=new si(this.zoom),en=0,Kr=C;en<Kr.length;en+=1){var Mn=Kr[en],yn=Mn.feature,Tn=Mn.id,Dn=Mn.index,Hn=Mn.sourceLayerIndex,oa=he._featureFilter.needGeometry,na={type:yn.type,id:Tn,properties:yn.properties,geometry:oa?Vi(yn):[]};if(!!he._featureFilter.filter(Dr,na,$)){oa||(na.geometry=Vi(yn));var Ra=void 0;if(ut){var wa=he.getValueAndResolveTokens("text-field",na,$,cr),Sa=Hi.factory(wa);M0(Sa)&&(this.hasRTLText=!0),(!this.hasRTLText||ho()==="unavailable"||this.hasRTLText&&Xa.isParsed())&&(Ra=Ld(Sa,he,na))}var ei=void 0;if(pt){var La=he.getValueAndResolveTokens("icon-image",na,$,cr);La instanceof So?ei=La:ei=So.fromString(La)}if(!(!Ra&&!ei)){var Da=this.sortFeaturesByKey?Pt.evaluate(na,{},$):void 0,fi={id:Tn,text:Ra,icon:ei,index:Dn,sourceLayerIndex:Hn,geometry:Vi(yn),properties:yn.properties,type:T0[yn.type],sortKey:Da};if(this.features.push(fi),ei&&(Jt[ei.name]=!0),Ra){var $a=Te.evaluate(na,{},$).join(","),Ci=me.get("text-rotation-alignment")==="map"&&me.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(El.vertical)>=0;for(var Zi=0,Li=Ra.sections;Zi<Li.length;Zi+=1){var Pi=Li[Zi];if(Pi.image)Jt[Pi.image.name]=!0;else{var Mi=br(Ra.toString()),eo=Pi.fontStack||$a,ao=Gt[eo]=Gt[eo]||{};this.calculateGlyphDependencies(Pi.text,ao,Ci,this.allowVerticalPlacement,Mi)}}}}}}me.get("symbol-placement")==="line"&&(this.features=Pd(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Ao,Po){return Ao.sortKey-Po.sortKey})}},Xi.prototype.update=function(C,O,$){!this.stateDependentLayers.length||(this.text.programConfigurations.updatePaintArrays(C,O,this.layers,$),this.icon.programConfigurations.updatePaintArrays(C,O,this.layers,$))},Xi.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Xi.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Xi.prototype.upload=function(C){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(C),this.iconCollisionBox.upload(C)),this.text.upload(C,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(C,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Xi.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Xi.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Xi.prototype.addToLineVertexArray=function(C,O){var $=this.lineVertexArray.length;if(C.segment!==void 0){for(var he=C.dist(O[C.segment+1]),me=C.dist(O[C.segment]),Te={},Ie=C.segment+1;Ie<O.length;Ie++)Te[Ie]={x:O[Ie].x,y:O[Ie].y,tileUnitDistanceFromAnchor:he},Ie<O.length-1&&(he+=O[Ie+1].dist(O[Ie]));for(var qe=C.segment||0;qe>=0;qe--)Te[qe]={x:O[qe].x,y:O[qe].y,tileUnitDistanceFromAnchor:me},qe>0&&(me+=O[qe-1].dist(O[qe]));for(var ut=0;ut<O.length;ut++){var pt=Te[ut];this.lineVertexArray.emplaceBack(pt.x,pt.y,pt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:$,lineLength:this.lineVertexArray.length-$}},Xi.prototype.addSymbols=function(C,O,$,he,me,Te,Ie,qe,ut,pt,Pt,Jt){for(var Gt=C.indexArray,cr=C.layoutVertexArray,Dr=C.segments.prepareSegment(4*O.length,cr,Gt,Te.sortKey),en=this.glyphOffsetArray.length,Kr=Dr.vertexLength,Mn=this.allowVerticalPlacement&&Ie===El.vertical?Math.PI/2:0,yn=Te.text&&Te.text.sections,Tn=0;Tn<O.length;Tn++){var Dn=O[Tn],Hn=Dn.tl,oa=Dn.tr,na=Dn.bl,Ra=Dn.br,wa=Dn.tex,Sa=Dn.pixelOffsetTL,ei=Dn.pixelOffsetBR,La=Dn.minFontScaleX,Da=Dn.minFontScaleY,fi=Dn.glyphOffset,$a=Dn.isSDF,Ci=Dn.sectionIndex,Zi=Dr.vertexLength,Li=fi[1];Xc(cr,qe.x,qe.y,Hn.x,Li+Hn.y,wa.x,wa.y,$,$a,Sa.x,Sa.y,La,Da),Xc(cr,qe.x,qe.y,oa.x,Li+oa.y,wa.x+wa.w,wa.y,$,$a,ei.x,Sa.y,La,Da),Xc(cr,qe.x,qe.y,na.x,Li+na.y,wa.x,wa.y+wa.h,$,$a,Sa.x,ei.y,La,Da),Xc(cr,qe.x,qe.y,Ra.x,Li+Ra.y,wa.x+wa.w,wa.y+wa.h,$,$a,ei.x,ei.y,La,Da),Eh(C.dynamicLayoutVertexArray,qe,Mn),Gt.emplaceBack(Zi,Zi+1,Zi+2),Gt.emplaceBack(Zi+1,Zi+2,Zi+3),Dr.vertexLength+=4,Dr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(fi[0]),(Tn===O.length-1||Ci!==O[Tn+1].sectionIndex)&&C.programConfigurations.populatePaintArrays(cr.length,Te,Te.index,{},Jt,yn&&yn[Ci])}C.placedSymbolArray.emplaceBack(qe.x,qe.y,en,this.glyphOffsetArray.length-en,Kr,ut,pt,qe.segment,$?$[0]:0,$?$[1]:0,he[0],he[1],Ie,0,!1,0,Pt)},Xi.prototype._addCollisionDebugVertex=function(C,O,$,he,me,Te){return O.emplaceBack(0,0),C.emplaceBack($.x,$.y,he,me,Math.round(Te.x),Math.round(Te.y))},Xi.prototype.addCollisionDebugVertices=function(C,O,$,he,me,Te,Ie){var qe=me.segments.prepareSegment(4,me.layoutVertexArray,me.indexArray),ut=qe.vertexLength,pt=me.layoutVertexArray,Pt=me.collisionVertexArray,Jt=Ie.anchorX,Gt=Ie.anchorY;this._addCollisionDebugVertex(pt,Pt,Te,Jt,Gt,new f(C,O)),this._addCollisionDebugVertex(pt,Pt,Te,Jt,Gt,new f($,O)),this._addCollisionDebugVertex(pt,Pt,Te,Jt,Gt,new f($,he)),this._addCollisionDebugVertex(pt,Pt,Te,Jt,Gt,new f(C,he)),qe.vertexLength+=4;var cr=me.indexArray;cr.emplaceBack(ut,ut+1),cr.emplaceBack(ut+1,ut+2),cr.emplaceBack(ut+2,ut+3),cr.emplaceBack(ut+3,ut),qe.primitiveLength+=4},Xi.prototype.addDebugCollisionBoxes=function(C,O,$,he){for(var me=C;me<O;me++){var Te=this.collisionBoxArray.get(me),Ie=Te.x1,qe=Te.y1,ut=Te.x2,pt=Te.y2;this.addCollisionDebugVertices(Ie,qe,ut,pt,he?this.textCollisionBox:this.iconCollisionBox,Te.anchorPoint,$)}},Xi.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new mc(Ef,ov.members,yf),this.iconCollisionBox=new mc(Ef,ov.members,yf);for(var C=0;C<this.symbolInstances.length;C++){var O=this.symbolInstances.get(C);this.addDebugCollisionBoxes(O.textBoxStartIndex,O.textBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.iconBoxStartIndex,O.iconBoxEndIndex,O,!1),this.addDebugCollisionBoxes(O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,!1)}},Xi.prototype._deserializeCollisionBoxesForSymbol=function(C,O,$,he,me,Te,Ie,qe,ut){for(var pt={},Pt=O;Pt<$;Pt++){var Jt=C.get(Pt);pt.textBox={x1:Jt.x1,y1:Jt.y1,x2:Jt.x2,y2:Jt.y2,anchorPointX:Jt.anchorPointX,anchorPointY:Jt.anchorPointY},pt.textFeatureIndex=Jt.featureIndex;break}for(var Gt=he;Gt<me;Gt++){var cr=C.get(Gt);pt.verticalTextBox={x1:cr.x1,y1:cr.y1,x2:cr.x2,y2:cr.y2,anchorPointX:cr.anchorPointX,anchorPointY:cr.anchorPointY},pt.verticalTextFeatureIndex=cr.featureIndex;break}for(var Dr=Te;Dr<Ie;Dr++){var en=C.get(Dr);pt.iconBox={x1:en.x1,y1:en.y1,x2:en.x2,y2:en.y2,anchorPointX:en.anchorPointX,anchorPointY:en.anchorPointY},pt.iconFeatureIndex=en.featureIndex;break}for(var Kr=qe;Kr<ut;Kr++){var Mn=C.get(Kr);pt.verticalIconBox={x1:Mn.x1,y1:Mn.y1,x2:Mn.x2,y2:Mn.y2,anchorPointX:Mn.anchorPointX,anchorPointY:Mn.anchorPointY},pt.verticalIconFeatureIndex=Mn.featureIndex;break}return pt},Xi.prototype.deserializeCollisionBoxes=function(C){this.collisionArrays=[];for(var O=0;O<this.symbolInstances.length;O++){var $=this.symbolInstances.get(O);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(C,$.textBoxStartIndex,$.textBoxEndIndex,$.verticalTextBoxStartIndex,$.verticalTextBoxEndIndex,$.iconBoxStartIndex,$.iconBoxEndIndex,$.verticalIconBoxStartIndex,$.verticalIconBoxEndIndex))}},Xi.prototype.hasTextData=function(){return this.text.segments.get().length>0},Xi.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Xi.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Xi.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Xi.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Xi.prototype.addIndicesForPlacedSymbol=function(C,O){for(var $=C.placedSymbolArray.get(O),he=$.vertexStartIndex+$.numGlyphs*4,me=$.vertexStartIndex;me<he;me+=4)C.indexArray.emplaceBack(me,me+1,me+2),C.indexArray.emplaceBack(me+1,me+2,me+3)},Xi.prototype.getSortedSymbolIndexes=function(C){if(this.sortedAngle===C&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var O=Math.sin(C),$=Math.cos(C),he=[],me=[],Te=[],Ie=0;Ie<this.symbolInstances.length;++Ie){Te.push(Ie);var qe=this.symbolInstances.get(Ie);he.push(Math.round(O*qe.anchorX+$*qe.anchorY)|0),me.push(qe.featureIndex)}return Te.sort(function(ut,pt){return he[ut]-he[pt]||me[pt]-me[ut]}),Te},Xi.prototype.addToSortKeyRanges=function(C,O){var $=this.sortKeyRanges[this.sortKeyRanges.length-1];$&&$.sortKey===O?$.symbolInstanceEnd=C+1:this.sortKeyRanges.push({sortKey:O,symbolInstanceStart:C,symbolInstanceEnd:C+1})},Xi.prototype.sortFeatures=function(C){var O=this;if(!!this.sortFeaturesByY&&this.sortedAngle!==C&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(C),this.sortedAngle=C,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var $=0,he=this.symbolInstanceIndexes;$<he.length;$+=1){var me=he[$],Te=this.symbolInstances.get(me);this.featureSortOrder.push(Te.featureIndex),[Te.rightJustifiedTextSymbolIndex,Te.centerJustifiedTextSymbolIndex,Te.leftJustifiedTextSymbolIndex].forEach(function(Ie,qe,ut){Ie>=0&&ut.indexOf(Ie)===qe&&O.addIndicesForPlacedSymbol(O.text,Ie)}),Te.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,Te.verticalPlacedTextSymbolIndex),Te.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,Te.placedIconSymbolIndex),Te.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,Te.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},ze("SymbolBucket",Xi,{omit:["layers","collisionBoxArray","features","compareText"]}),Xi.MAX_GLYPHS=65535,Xi.addDynamicAttributes=Eh;function S0(E,C){return C.replace(/{([^{}]+)}/g,function(O,$){return $ in E?String(E[$]):""})}var k0=new ji({"symbol-placement":new Ia(It.layout_symbol["symbol-placement"]),"symbol-spacing":new Ia(It.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ia(It.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Za(It.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ia(It.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ia(It.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ia(It.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ia(It.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ia(It.layout_symbol["icon-rotation-alignment"]),"icon-size":new Za(It.layout_symbol["icon-size"]),"icon-text-fit":new Ia(It.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ia(It.layout_symbol["icon-text-fit-padding"]),"icon-image":new Za(It.layout_symbol["icon-image"]),"icon-rotate":new Za(It.layout_symbol["icon-rotate"]),"icon-padding":new Ia(It.layout_symbol["icon-padding"]),"icon-keep-upright":new Ia(It.layout_symbol["icon-keep-upright"]),"icon-offset":new Za(It.layout_symbol["icon-offset"]),"icon-anchor":new Za(It.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ia(It.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ia(It.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ia(It.layout_symbol["text-rotation-alignment"]),"text-field":new Za(It.layout_symbol["text-field"]),"text-font":new Za(It.layout_symbol["text-font"]),"text-size":new Za(It.layout_symbol["text-size"]),"text-max-width":new Za(It.layout_symbol["text-max-width"]),"text-line-height":new Ia(It.layout_symbol["text-line-height"]),"text-letter-spacing":new Za(It.layout_symbol["text-letter-spacing"]),"text-justify":new Za(It.layout_symbol["text-justify"]),"text-radial-offset":new Za(It.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ia(It.layout_symbol["text-variable-anchor"]),"text-anchor":new Za(It.layout_symbol["text-anchor"]),"text-max-angle":new Ia(It.layout_symbol["text-max-angle"]),"text-writing-mode":new Ia(It.layout_symbol["text-writing-mode"]),"text-rotate":new Za(It.layout_symbol["text-rotate"]),"text-padding":new Ia(It.layout_symbol["text-padding"]),"text-keep-upright":new Ia(It.layout_symbol["text-keep-upright"]),"text-transform":new Za(It.layout_symbol["text-transform"]),"text-offset":new Za(It.layout_symbol["text-offset"]),"text-allow-overlap":new Ia(It.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ia(It.layout_symbol["text-ignore-placement"]),"text-optional":new Ia(It.layout_symbol["text-optional"])}),E0=new ji({"icon-opacity":new Za(It.paint_symbol["icon-opacity"]),"icon-color":new Za(It.paint_symbol["icon-color"]),"icon-halo-color":new Za(It.paint_symbol["icon-halo-color"]),"icon-halo-width":new Za(It.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Za(It.paint_symbol["icon-halo-blur"]),"icon-translate":new Ia(It.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ia(It.paint_symbol["icon-translate-anchor"]),"text-opacity":new Za(It.paint_symbol["text-opacity"]),"text-color":new Za(It.paint_symbol["text-color"],{runtimeType:On,getOverride:function(E){return E.textColor},hasOverride:function(E){return!!E.textColor}}),"text-halo-color":new Za(It.paint_symbol["text-halo-color"]),"text-halo-width":new Za(It.paint_symbol["text-halo-width"]),"text-halo-blur":new Za(It.paint_symbol["text-halo-blur"]),"text-translate":new Ia(It.paint_symbol["text-translate"]),"text-translate-anchor":new Ia(It.paint_symbol["text-translate-anchor"])}),Ch={paint:E0,layout:k0},jf=function(C){this.type=C.property.overrides?C.property.overrides.runtimeType:gr,this.defaultValue=C};jf.prototype.evaluate=function(C){if(C.formattedSection){var O=this.defaultValue.property.overrides;if(O&&O.hasOverride(C.formattedSection))return O.getOverride(C.formattedSection)}return C.feature&&C.featureState?this.defaultValue.evaluate(C.feature,C.featureState):this.defaultValue.property.specification.default},jf.prototype.eachChild=function(C){if(!this.defaultValue.isConstant()){var O=this.defaultValue.value;C(O._styleExpression.expression)}},jf.prototype.outputDefined=function(){return!1},jf.prototype.serialize=function(){return null},ze("FormatSectionOverride",jf,{omit:["defaultValue"]});var C0=function(E){function C(O){E.call(this,O,Ch)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.recalculate=function($,he){if(E.prototype.recalculate.call(this,$,he),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var me=this.layout.get("text-writing-mode");if(me){for(var Te=[],Ie=0,qe=me;Ie<qe.length;Ie+=1){var ut=qe[Ie];Te.indexOf(ut)<0&&Te.push(ut)}this.layout._values["text-writing-mode"]=Te}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},C.prototype.getValueAndResolveTokens=function($,he,me,Te){var Ie=this.layout.get($).evaluate(he,{},me,Te),qe=this._unevaluatedLayout._values[$];return!qe.isDataDriven()&&!bo(qe.value)&&Ie?S0(he.properties,Ie):Ie},C.prototype.createBucket=function($){return new Xi($)},C.prototype.queryRadius=function(){return 0},C.prototype.queryIntersectsFeature=function(){return!1},C.prototype._setPaintOverrides=function(){for(var $=0,he=Ch.paint.overridableProperties;$<he.length;$+=1){var me=he[$];if(!!C.hasPaintOverride(this.layout,me)){var Te=this.paint.get(me),Ie=new jf(Te),qe=new us(Ie,Te.property.specification),ut=null;Te.value.kind==="constant"||Te.value.kind==="source"?ut=new Ql("source",qe):ut=new fs("composite",qe,Te.value.zoomStops,Te.value._interpolationType),this.paint._values[me]=new Wi(Te.property,ut,Te.parameters)}}},C.prototype._handleOverridablePaintPropertyUpdate=function($,he,me){return!this.layout||he.isDataDriven()||me.isDataDriven()?!1:C.hasPaintOverride(this.layout,$)},C.hasPaintOverride=function($,he){var me=$.get("text-field"),Te=Ch.paint.properties[he],Ie=!1,qe=function(Pt){for(var Jt=0,Gt=Pt;Jt<Gt.length;Jt+=1){var cr=Gt[Jt];if(Te.overrides&&Te.overrides.hasOverride(cr)){Ie=!0;return}}};if(me.value.kind==="constant"&&me.value.value instanceof Hi)qe(me.value.value.sections);else if(me.value.kind==="source"){var ut=function(Pt){if(!Ie)if(Pt instanceof Qi&&Ii(Pt.value)===da){var Jt=Pt.value;qe(Jt.sections)}else Pt instanceof rs?qe(Pt.sections):Pt.eachChild(ut)},pt=me.value;pt._styleExpression&&ut(pt._styleExpression.expression)}return Ie},C}(bs),L0=new ji({"background-color":new Ia(It.paint_background["background-color"]),"background-pattern":new ro(It.paint_background["background-pattern"]),"background-opacity":new Ia(It.paint_background["background-opacity"])}),P0={paint:L0},D0=function(E){function C(O){E.call(this,O,P0)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(bs),R0=new ji({"raster-opacity":new Ia(It.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ia(It.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ia(It.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ia(It.paint_raster["raster-brightness-max"]),"raster-saturation":new Ia(It.paint_raster["raster-saturation"]),"raster-contrast":new Ia(It.paint_raster["raster-contrast"]),"raster-resampling":new Ia(It.paint_raster["raster-resampling"]),"raster-fade-duration":new Ia(It.paint_raster["raster-fade-duration"])}),I0={paint:R0},z0=function(E){function C(O){E.call(this,O,I0)}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C}(bs);function F0(E){var C=[],O=E.id;return O===void 0&&C.push({message:"layers."+O+': missing required property "id"'}),E.render===void 0&&C.push({message:"layers."+O+': missing required method "render"'}),E.renderingMode&&E.renderingMode!=="2d"&&E.renderingMode!=="3d"&&C.push({message:"layers."+O+': property "renderingMode" must be either "2d" or "3d"'}),C}var O0=function(E){function C(O){E.call(this,O,{}),this.implementation=O}return E&&(C.__proto__=E),C.prototype=Object.create(E&&E.prototype),C.prototype.constructor=C,C.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},C.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},C.prototype.recalculate=function(){},C.prototype.updateTransitions=function(){},C.prototype.hasTransition=function(){},C.prototype.serialize=function(){},C.prototype.onAdd=function($){this.implementation.onAdd&&this.implementation.onAdd($,$.painter.context.gl)},C.prototype.onRemove=function($){this.implementation.onRemove&&this.implementation.onRemove($,$.painter.context.gl)},C}(bs),B0={circle:vp,heatmap:yp,hillshade:bp,fill:Wp,"fill-extrusion":cd,line:Ad,symbol:C0,background:D0,raster:z0};function N0(E){return E.type==="custom"?new O0(E):new B0[E.type](E)}var Rv=self.HTMLImageElement,Iv=self.HTMLCanvasElement,zv=self.HTMLVideoElement,Fv=self.ImageData,Zc=self.ImageBitmap,wf=function(C,O,$,he){this.context=C,this.format=$,this.texture=C.gl.createTexture(),this.update(O,he)};wf.prototype.update=function(C,O,$){var he=C.width,me=C.height,Te=(!this.size||this.size[0]!==he||this.size[1]!==me)&&!$,Ie=this,qe=Ie.context,ut=qe.gl;if(this.useMipmap=Boolean(O&&O.useMipmap),ut.bindTexture(ut.TEXTURE_2D,this.texture),qe.pixelStoreUnpackFlipY.set(!1),qe.pixelStoreUnpack.set(1),qe.pixelStoreUnpackPremultiplyAlpha.set(this.format===ut.RGBA&&(!O||O.premultiply!==!1)),Te)this.size=[he,me],C instanceof Rv||C instanceof Iv||C instanceof zv||C instanceof Fv||Zc&&C instanceof Zc?ut.texImage2D(ut.TEXTURE_2D,0,this.format,this.format,ut.UNSIGNED_BYTE,C):ut.texImage2D(ut.TEXTURE_2D,0,this.format,he,me,0,this.format,ut.UNSIGNED_BYTE,C.data);else{var pt=$||{x:0,y:0},Pt=pt.x,Jt=pt.y;C instanceof Rv||C instanceof Iv||C instanceof zv||C instanceof Fv||Zc&&C instanceof Zc?ut.texSubImage2D(ut.TEXTURE_2D,0,Pt,Jt,ut.RGBA,ut.UNSIGNED_BYTE,C):ut.texSubImage2D(ut.TEXTURE_2D,0,Pt,Jt,he,me,ut.RGBA,ut.UNSIGNED_BYTE,C.data)}this.useMipmap&&this.isSizePowerOfTwo()&&ut.generateMipmap(ut.TEXTURE_2D)},wf.prototype.bind=function(C,O,$){var he=this,me=he.context,Te=me.gl;Te.bindTexture(Te.TEXTURE_2D,this.texture),$===Te.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&($=Te.LINEAR),C!==this.filter&&(Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MAG_FILTER,C),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_MIN_FILTER,$||C),this.filter=C),O!==this.wrap&&(Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_S,O),Te.texParameteri(Te.TEXTURE_2D,Te.TEXTURE_WRAP_T,O),this.wrap=O)},wf.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0},wf.prototype.destroy=function(){var C=this.context,O=C.gl;O.deleteTexture(this.texture),this.texture=null};var Lh=function(C){var O=this;this._callback=C,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){O._triggered=!1,O._callback()})};Lh.prototype.trigger=function(){var C=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){C._triggered=!1,C._callback()},0))},Lh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Kf=function(C,O,$){this.target=C,this.parent=O,this.mapId=$,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},S(["receive","process"],this),this.invoker=new Lh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=J()?C:self};Kf.prototype.send=function(C,O,$,he,me){var Te=this;me===void 0&&(me=!1);var Ie=Math.round(Math.random()*1e18).toString(36).substring(0,10);$&&(this.callbacks[Ie]=$);var qe=X(this.globalScope)?void 0:[];return this.target.postMessage({id:Ie,type:C,hasCallback:!!$,targetMapId:he,mustQueue:me,sourceMapId:this.mapId,data:St(O,qe)},qe),{cancel:function(){$&&delete Te.callbacks[Ie],Te.target.postMessage({id:Ie,type:"<cancel>",targetMapId:he,sourceMapId:Te.mapId})}}},Kf.prototype.receive=function(C){var O=C.data,$=O.id;if(!!$&&!(O.targetMapId&&this.mapId!==O.targetMapId))if(O.type==="<cancel>"){delete this.tasks[$];var he=this.cancelCallbacks[$];delete this.cancelCallbacks[$],he&&he()}else J()||O.mustQueue?(this.tasks[$]=O,this.taskQueue.push($),this.invoker.trigger()):this.processTask($,O)},Kf.prototype.process=function(){if(!!this.taskQueue.length){var C=this.taskQueue.shift(),O=this.tasks[C];delete this.tasks[C],this.taskQueue.length&&this.invoker.trigger(),O&&this.processTask(C,O)}},Kf.prototype.processTask=function(C,O){var $=this;if(O.type==="<response>"){var he=this.callbacks[C];delete this.callbacks[C],he&&(O.error?he(Nt(O.error)):he(null,Nt(O.data)))}else{var me=!1,Te=X(this.globalScope)?void 0:[],Ie=O.hasCallback?function(Jt,Gt){me=!0,delete $.cancelCallbacks[C],$.target.postMessage({id:C,type:"<response>",sourceMapId:$.mapId,error:Jt?St(Jt):null,data:St(Gt,Te)},Te)}:function(Jt){me=!0},qe=null,ut=Nt(O.data);if(this.parent[O.type])qe=this.parent[O.type](O.sourceMapId,ut,Ie);else if(this.parent.getWorkerSource){var pt=O.type.split("."),Pt=this.parent.getWorkerSource(O.sourceMapId,pt[0],ut.source);qe=Pt[pt[1]](ut,Ie)}else Ie(new Error("Could not find function "+O.type));!me&&qe&&qe.cancel&&(this.cancelCallbacks[C]=qe.cancel)}},Kf.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};function U0(E,C,O){C=Math.pow(2,O)-C-1;var $=Ov(E*256,C*256,O),he=Ov((E+1)*256,(C+1)*256,O);return $[0]+","+$[1]+","+he[0]+","+he[1]}function Ov(E,C,O){var $=2*Math.PI*6378137/256/Math.pow(2,O),he=E*$-2*Math.PI*6378137/2,me=C*$-2*Math.PI*6378137/2;return[he,me]}var Vo=function(C,O){C&&(O?this.setSouthWest(C).setNorthEast(O):C.length===4?this.setSouthWest([C[0],C[1]]).setNorthEast([C[2],C[3]]):this.setSouthWest(C[0]).setNorthEast(C[1]))};Vo.prototype.setNorthEast=function(C){return this._ne=C instanceof vo?new vo(C.lng,C.lat):vo.convert(C),this},Vo.prototype.setSouthWest=function(C){return this._sw=C instanceof vo?new vo(C.lng,C.lat):vo.convert(C),this},Vo.prototype.extend=function(C){var O=this._sw,$=this._ne,he,me;if(C instanceof vo)he=C,me=C;else if(C instanceof Vo){if(he=C._sw,me=C._ne,!he||!me)return this}else{if(Array.isArray(C))if(C.length===4||C.every(Array.isArray)){var Te=C;return this.extend(Vo.convert(Te))}else{var Ie=C;return this.extend(vo.convert(Ie))}return this}return!O&&!$?(this._sw=new vo(he.lng,he.lat),this._ne=new vo(me.lng,me.lat)):(O.lng=Math.min(he.lng,O.lng),O.lat=Math.min(he.lat,O.lat),$.lng=Math.max(me.lng,$.lng),$.lat=Math.max(me.lat,$.lat)),this},Vo.prototype.getCenter=function(){return new vo((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Vo.prototype.getSouthWest=function(){return this._sw},Vo.prototype.getNorthEast=function(){return this._ne},Vo.prototype.getNorthWest=function(){return new vo(this.getWest(),this.getNorth())},Vo.prototype.getSouthEast=function(){return new vo(this.getEast(),this.getSouth())},Vo.prototype.getWest=function(){return this._sw.lng},Vo.prototype.getSouth=function(){return this._sw.lat},Vo.prototype.getEast=function(){return this._ne.lng},Vo.prototype.getNorth=function(){return this._ne.lat},Vo.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Vo.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Vo.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Vo.prototype.contains=function(C){var O=vo.convert(C),$=O.lng,he=O.lat,me=this._sw.lat<=he&&he<=this._ne.lat,Te=this._sw.lng<=$&&$<=this._ne.lng;return this._sw.lng>this._ne.lng&&(Te=this._sw.lng>=$&&$>=this._ne.lng),me&&Te},Vo.convert=function(C){return!C||C instanceof Vo?C:new Vo(C)};var Bv=63710088e-1,vo=function(C,O){if(isNaN(C)||isNaN(O))throw new Error("Invalid LngLat object: ("+C+", "+O+")");if(this.lng=+C,this.lat=+O,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};vo.prototype.wrap=function(){return new vo(m(this.lng,-180,180),this.lat)},vo.prototype.toArray=function(){return[this.lng,this.lat]},vo.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},vo.prototype.distanceTo=function(C){var O=Math.PI/180,$=this.lat*O,he=C.lat*O,me=Math.sin($)*Math.sin(he)+Math.cos($)*Math.cos(he)*Math.cos((C.lng-this.lng)*O),Te=Bv*Math.acos(Math.min(me,1));return Te},vo.prototype.toBounds=function(C){C===void 0&&(C=0);var O=40075017,$=360*C/O,he=$/Math.cos(Math.PI/180*this.lat);return new Vo(new vo(this.lng-he,this.lat-$),new vo(this.lng+he,this.lat+$))},vo.convert=function(C){if(C instanceof vo)return C;if(Array.isArray(C)&&(C.length===2||C.length===3))return new vo(Number(C[0]),Number(C[1]));if(!Array.isArray(C)&&typeof C=="object"&&C!==null)return new vo(Number("lng"in C?C.lng:C.lon),Number(C.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Nv=2*Math.PI*Bv;function Uv(E){return Nv*Math.cos(E*Math.PI/180)}function Vv(E){return(180+E)/360}function Hv(E){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+E*Math.PI/360)))/360}function Gv(E,C){return E/Uv(C)}function V0(E){return E*360-180}function Ph(E){var C=180-E*360;return 360/Math.PI*Math.atan(Math.exp(C*Math.PI/180))-90}function H0(E,C){return E*Uv(Ph(C))}function G0(E){return 1/Math.cos(E*Math.PI/180)}var Tf=function(C,O,$){$===void 0&&($=0),this.x=+C,this.y=+O,this.z=+$};Tf.fromLngLat=function(C,O){O===void 0&&(O=0);var $=vo.convert(C);return new Tf(Vv($.lng),Hv($.lat),Gv(O,$.lat))},Tf.prototype.toLngLat=function(){return new vo(V0(this.x),Ph(this.y))},Tf.prototype.toAltitude=function(){return H0(this.z,this.y)},Tf.prototype.meterInMercatorCoordinateUnits=function(){return 1/Nv*G0(Ph(this.y))};var Af=function(C,O,$){this.z=C,this.x=O,this.y=$,this.key=xc(0,C,C,O,$)};Af.prototype.equals=function(C){return this.z===C.z&&this.x===C.x&&this.y===C.y},Af.prototype.url=function(C,O){var $=U0(this.x,this.y,this.z),he=Y0(this.z,this.x,this.y);return C[(this.x+this.y)%C.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(O==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",he).replace("{bbox-epsg-3857}",$)},Af.prototype.getTilePoint=function(C){var O=Math.pow(2,this.z);return new f((C.x*O-this.x)*Ba,(C.y*O-this.y)*Ba)},Af.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Yv=function(C,O){this.wrap=C,this.canonical=O,this.key=xc(C,O.z,O.z,O.x,O.y)},Ho=function(C,O,$,he,me){this.overscaledZ=C,this.wrap=O,this.canonical=new Af($,+he,+me),this.key=xc(O,C,$,he,me)};Ho.prototype.equals=function(C){return this.overscaledZ===C.overscaledZ&&this.wrap===C.wrap&&this.canonical.equals(C.canonical)},Ho.prototype.scaledTo=function(C){var O=this.canonical.z-C;return C>this.canonical.z?new Ho(C,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ho(C,this.wrap,C,this.canonical.x>>O,this.canonical.y>>O)},Ho.prototype.calculateScaledKey=function(C,O){var $=this.canonical.z-C;return C>this.canonical.z?xc(this.wrap*+O,C,this.canonical.z,this.canonical.x,this.canonical.y):xc(this.wrap*+O,C,C,this.canonical.x>>$,this.canonical.y>>$)},Ho.prototype.isChildOf=function(C){if(C.wrap!==this.wrap)return!1;var O=this.canonical.z-C.canonical.z;return C.overscaledZ===0||C.overscaledZ<this.overscaledZ&&C.canonical.x===this.canonical.x>>O&&C.canonical.y===this.canonical.y>>O},Ho.prototype.children=function(C){if(this.overscaledZ>=C)return[new Ho(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var O=this.canonical.z+1,$=this.canonical.x*2,he=this.canonical.y*2;return[new Ho(O,this.wrap,O,$,he),new Ho(O,this.wrap,O,$+1,he),new Ho(O,this.wrap,O,$,he+1),new Ho(O,this.wrap,O,$+1,he+1)]},Ho.prototype.isLessThan=function(C){return this.wrap<C.wrap?!0:this.wrap>C.wrap?!1:this.overscaledZ<C.overscaledZ?!0:this.overscaledZ>C.overscaledZ?!1:this.canonical.x<C.canonical.x?!0:this.canonical.x>C.canonical.x?!1:this.canonical.y<C.canonical.y},Ho.prototype.wrapped=function(){return new Ho(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Ho.prototype.unwrapTo=function(C){return new Ho(this.overscaledZ,C,this.canonical.z,this.canonical.x,this.canonical.y)},Ho.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Ho.prototype.toUnwrapped=function(){return new Yv(this.wrap,this.canonical)},Ho.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Ho.prototype.getTilePoint=function(C){return this.canonical.getTilePoint(new Tf(C.x-this.wrap,C.y))};function xc(E,C,O,$,he){E*=2,E<0&&(E=E*-1-1);var me=1<<O;return(me*me*E+me*he+$).toString(36)+O.toString(36)+C.toString(36)}function Y0(E,C,O){for(var $="",he,me=E;me>0;me--)he=1<<me-1,$+=(C&he?1:0)+(O&he?2:0);return $}ze("CanonicalTileID",Af),ze("OverscaledTileID",Ho,{omit:["posMatrix"]});var Ku=function(C,O,$){if(this.uid=C,O.height!==O.width)throw new RangeError("DEM tiles must be square");if($&&$!=="mapbox"&&$!=="terrarium")return B('"'+$+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=O.height;var he=this.dim=O.height-2;this.data=new Uint32Array(O.data.buffer),this.encoding=$||"mapbox";for(var me=0;me<he;me++)this.data[this._idx(-1,me)]=this.data[this._idx(0,me)],this.data[this._idx(he,me)]=this.data[this._idx(he-1,me)],this.data[this._idx(me,-1)]=this.data[this._idx(me,0)],this.data[this._idx(me,he)]=this.data[this._idx(me,he-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(he,-1)]=this.data[this._idx(he-1,0)],this.data[this._idx(-1,he)]=this.data[this._idx(0,he-1)],this.data[this._idx(he,he)]=this.data[this._idx(he-1,he-1)]};Ku.prototype.get=function(C,O){var $=new Uint8Array(this.data.buffer),he=this._idx(C,O)*4,me=this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox;return me($[he],$[he+1],$[he+2])},Ku.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Ku.prototype._idx=function(C,O){if(C<-1||C>=this.dim+1||O<-1||O>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(O+1)*this.stride+(C+1)},Ku.prototype._unpackMapbox=function(C,O,$){return(C*256*256+O*256+$)/10-1e4},Ku.prototype._unpackTerrarium=function(C,O,$){return C*256+O+$/256-32768},Ku.prototype.getPixels=function(){return new tl({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Ku.prototype.backfillBorder=function(C,O,$){if(this.dim!==C.dim)throw new Error("dem dimension mismatch");var he=O*this.dim,me=O*this.dim+this.dim,Te=$*this.dim,Ie=$*this.dim+this.dim;switch(O){case-1:he=me-1;break;case 1:me=he+1;break}switch($){case-1:Te=Ie-1;break;case 1:Ie=Te+1;break}for(var qe=-O*this.dim,ut=-$*this.dim,pt=Te;pt<Ie;pt++)for(var Pt=he;Pt<me;Pt++)this.data[this._idx(Pt,pt)]=C.data[this._idx(Pt+qe,pt+ut)]},ze("DEMData",Ku);function W0(E,C){var O={};if(!C)return O;for(var $=function(){var Te=me[he],Ie=Te.layerIds.map(function(Pt){return C.getLayer(Pt)}).filter(Boolean);if(Ie.length!==0){Te.layers=Ie,Te.stateDependentLayerIds&&(Te.stateDependentLayers=Te.stateDependentLayerIds.map(function(Pt){return Ie.filter(function(Jt){return Jt.id===Pt})[0]}));for(var qe=0,ut=Ie;qe<ut.length;qe+=1){var pt=ut[qe];O[pt.id]=Te}}},he=0,me=E;he<me.length;he+=1)$();return O}var jc=function(C){this._stringToNumber={},this._numberToString=[];for(var O=0;O<C.length;O++){var $=C[O];this._stringToNumber[$]=O,this._numberToString[O]=$}};jc.prototype.encode=function(C){return this._stringToNumber[C]},jc.prototype.decode=function(C){return this._numberToString[C]};var Kc=function(C,O,$,he,me){this.type="Feature",this._vectorTileFeature=C,C._z=O,C._x=$,C._y=he,this.properties=C.properties,this.id=me},Dh={geometry:{configurable:!0}};Dh.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Dh.geometry.set=function(E){this._geometry=E},Kc.prototype.toJSON=function(){var C={geometry:this.geometry};for(var O in this)O==="_geometry"||O==="_vectorTileFeature"||(C[O]=this[O]);return C},Object.defineProperties(Kc.prototype,Dh);var Jf=function(){this.state={},this.stateChanges={},this.deletedStates={}};Jf.prototype.updateState=function(C,O,$){var he=String(O);if(this.stateChanges[C]=this.stateChanges[C]||{},this.stateChanges[C][he]=this.stateChanges[C][he]||{},A(this.stateChanges[C][he],$),this.deletedStates[C]===null){this.deletedStates[C]={};for(var me in this.state[C])me!==he&&(this.deletedStates[C][me]=null)}else{var Te=this.deletedStates[C]&&this.deletedStates[C][he]===null;if(Te){this.deletedStates[C][he]={};for(var Ie in this.state[C][he])$[Ie]||(this.deletedStates[C][he][Ie]=null)}else for(var qe in $){var ut=this.deletedStates[C]&&this.deletedStates[C][he]&&this.deletedStates[C][he][qe]===null;ut&&delete this.deletedStates[C][he][qe]}}},Jf.prototype.removeFeatureState=function(C,O,$){var he=this.deletedStates[C]===null;if(!he){var me=String(O);if(this.deletedStates[C]=this.deletedStates[C]||{},$&&O!==void 0)this.deletedStates[C][me]!==null&&(this.deletedStates[C][me]=this.deletedStates[C][me]||{},this.deletedStates[C][me][$]=null);else if(O!==void 0){var Te=this.stateChanges[C]&&this.stateChanges[C][me];if(Te){this.deletedStates[C][me]={};for($ in this.stateChanges[C][me])this.deletedStates[C][me][$]=null}else this.deletedStates[C][me]=null}else this.deletedStates[C]=null}},Jf.prototype.getState=function(C,O){var $=String(O),he=this.state[C]||{},me=this.stateChanges[C]||{},Te=A({},he[$],me[$]);if(this.deletedStates[C]===null)return{};if(this.deletedStates[C]){var Ie=this.deletedStates[C][O];if(Ie===null)return{};for(var qe in Ie)delete Te[qe]}return Te},Jf.prototype.initializeTileState=function(C,O){C.setFeatureState(this.state,O)},Jf.prototype.coalesceChanges=function(C,O){var $={};for(var he in this.stateChanges){this.state[he]=this.state[he]||{};var me={};for(var Te in this.stateChanges[he])this.state[he][Te]||(this.state[he][Te]={}),A(this.state[he][Te],this.stateChanges[he][Te]),me[Te]=this.state[he][Te];$[he]=me}for(var Ie in this.deletedStates){this.state[Ie]=this.state[Ie]||{};var qe={};if(this.deletedStates[Ie]===null)for(var ut in this.state[Ie])qe[ut]={},this.state[Ie][ut]={};else for(var pt in this.deletedStates[Ie]){var Pt=this.deletedStates[Ie][pt]===null;if(Pt)this.state[Ie][pt]={};else for(var Jt=0,Gt=Object.keys(this.deletedStates[Ie][pt]);Jt<Gt.length;Jt+=1){var cr=Gt[Jt];delete this.state[Ie][pt][cr]}qe[pt]=this.state[Ie][pt]}$[Ie]=$[Ie]||{},A($[Ie],qe)}if(this.stateChanges={},this.deletedStates={},Object.keys($).length!==0)for(var Dr in C){var en=C[Dr];en.setFeatureState($,O)}};var Ju=function(C,O){this.tileID=C,this.x=C.canonical.x,this.y=C.canonical.y,this.z=C.canonical.z,this.grid=new Do(Ba,16,0),this.grid3D=new Do(Ba,16,0),this.featureIndexArray=new ac,this.promoteId=O};Ju.prototype.insert=function(C,O,$,he,me,Te){var Ie=this.featureIndexArray.length;this.featureIndexArray.emplaceBack($,he,me);for(var qe=Te?this.grid3D:this.grid,ut=0;ut<O.length;ut++){for(var pt=O[ut],Pt=[1/0,1/0,-1/0,-1/0],Jt=0;Jt<pt.length;Jt++){var Gt=pt[Jt];Pt[0]=Math.min(Pt[0],Gt.x),Pt[1]=Math.min(Pt[1],Gt.y),Pt[2]=Math.max(Pt[2],Gt.x),Pt[3]=Math.max(Pt[3],Gt.y)}Pt[0]<Ba&&Pt[1]<Ba&&Pt[2]>=0&&Pt[3]>=0&&qe.insert(Ie,Pt[0],Pt[1],Pt[2],Pt[3])}},Ju.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Bf.VectorTile(new Bc(this.rawTileData)).layers,this.sourceLayerCoder=new jc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ju.prototype.query=function(C,O,$,he){var me=this;this.loadVTLayers();for(var Te=C.params||{},Ie=Ba/C.tileSize/C.scale,qe=Fu(Te.filter),ut=C.queryGeometry,pt=C.queryPadding*Ie,Pt=Xv(ut),Jt=this.grid.query(Pt.minX-pt,Pt.minY-pt,Pt.maxX+pt,Pt.maxY+pt),Gt=Xv(C.cameraQueryGeometry),cr=this.grid3D.query(Gt.minX-pt,Gt.minY-pt,Gt.maxX+pt,Gt.maxY+pt,function(Hn,oa,na,Ra){return Hu(C.cameraQueryGeometry,Hn-pt,oa-pt,na+pt,Ra+pt)}),Dr=0,en=cr;Dr<en.length;Dr+=1){var Kr=en[Dr];Jt.push(Kr)}Jt.sort(X0);for(var Mn={},yn,Tn=function(Hn){var oa=Jt[Hn];if(oa!==yn){yn=oa;var na=me.featureIndexArray.get(oa),Ra=null;me.loadMatchingFeature(Mn,na.bucketIndex,na.sourceLayerIndex,na.featureIndex,qe,Te.layers,Te.availableImages,O,$,he,function(wa,Sa,ei){return Ra||(Ra=Vi(wa)),Sa.queryIntersectsFeature(ut,wa,ei,Ra,me.z,C.transform,Ie,C.pixelPosMatrix)})}},Dn=0;Dn<Jt.length;Dn++)Tn(Dn);return Mn},Ju.prototype.loadMatchingFeature=function(C,O,$,he,me,Te,Ie,qe,ut,pt,Pt){var Jt=this.bucketLayerIDs[O];if(!(Te&&!D(Te,Jt))){var Gt=this.sourceLayerCoder.decode($),cr=this.vtLayers[Gt],Dr=cr.feature(he);if(!!me.filter(new si(this.tileID.overscaledZ),Dr))for(var en=this.getId(Dr,Gt),Kr=0;Kr<Jt.length;Kr++){var Mn=Jt[Kr];if(!(Te&&Te.indexOf(Mn)<0)){var yn=qe[Mn];if(!!yn){var Tn={};en!==void 0&&pt&&(Tn=pt.getState(yn.sourceLayer||"_geojsonTileLayer",en));var Dn=ut[Mn];Dn.paint=Wv(Dn.paint,yn.paint,Dr,Tn,Ie),Dn.layout=Wv(Dn.layout,yn.layout,Dr,Tn,Ie);var Hn=!Pt||Pt(Dr,yn,Tn);if(!!Hn){var oa=new Kc(Dr,this.z,this.x,this.y,en);oa.layer=Dn;var na=C[Mn];na===void 0&&(na=C[Mn]=[]),na.push({featureIndex:he,feature:oa,intersectionZ:Hn})}}}}}},Ju.prototype.lookupSymbolFeatures=function(C,O,$,he,me,Te,Ie,qe){var ut={};this.loadVTLayers();for(var pt=Fu(me),Pt=0,Jt=C;Pt<Jt.length;Pt+=1){var Gt=Jt[Pt];this.loadMatchingFeature(ut,$,he,Gt,pt,Te,Ie,qe,O)}return ut},Ju.prototype.hasLayer=function(C){for(var O=0,$=this.bucketLayerIDs;O<$.length;O+=1)for(var he=$[O],me=0,Te=he;me<Te.length;me+=1){var Ie=Te[me];if(C===Ie)return!0}return!1},Ju.prototype.getId=function(C,O){var $=C.id;if(this.promoteId){var he=typeof this.promoteId=="string"?this.promoteId:this.promoteId[O];$=C.properties[he],typeof $=="boolean"&&($=Number($))}return $},ze("FeatureIndex",Ju,{omit:["rawTileData","sourceLayerCoder"]});function Wv(E,C,O,$,he){return P(E,function(me,Te){var Ie=C instanceof Ui?C.get(Te):null;return Ie&&Ie.evaluate?Ie.evaluate(O,$,he):Ie})}function Xv(E){for(var C=1/0,O=1/0,$=-1/0,he=-1/0,me=0,Te=E;me<Te.length;me+=1){var Ie=Te[me];C=Math.min(C,Ie.x),O=Math.min(O,Ie.y),$=Math.max($,Ie.x),he=Math.max(he,Ie.y)}return{minX:C,minY:O,maxX:$,maxY:he}}function X0(E,C){return C-E}var Z0=3e4,qo=function(C,O){this.tileID=C,this.uid=b(),this.uses=0,this.tileSize=O,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};qo.prototype.registerFadeDuration=function(C){var O=C+this.timeAdded;O<Z.now()||this.fadeEndTime&&O<this.fadeEndTime||(this.fadeEndTime=O)},qo.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},qo.prototype.loadVectorData=function(C,O,$){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!C){this.collisionBoxArray=new Vu;return}C.featureIndex&&(this.latestFeatureIndex=C.featureIndex,C.rawTileData?(this.latestRawTileData=C.rawTileData,this.latestFeatureIndex.rawTileData=C.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=C.collisionBoxArray,this.buckets=W0(C.buckets,O.style),this.hasSymbolBuckets=!1;for(var he in this.buckets){var me=this.buckets[he];if(me instanceof Xi)if(this.hasSymbolBuckets=!0,$)me.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var Te in this.buckets){var Ie=this.buckets[Te];if(Ie instanceof Xi&&Ie.hasRTLText){this.hasRTLText=!0,Ei();break}}this.queryPadding=0;for(var qe in this.buckets){var ut=this.buckets[qe];this.queryPadding=Math.max(this.queryPadding,O.style.getLayer(qe).queryRadius(ut))}C.imageAtlas&&(this.imageAtlas=C.imageAtlas),C.glyphAtlasImage&&(this.glyphAtlasImage=C.glyphAtlasImage)},qo.prototype.unloadVectorData=function(){for(var C in this.buckets)this.buckets[C].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},qo.prototype.getBucket=function(C){return this.buckets[C.id]},qo.prototype.upload=function(C){for(var O in this.buckets){var $=this.buckets[O];$.uploadPending()&&$.upload(C)}var he=C.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new wf(C,this.imageAtlas.image,he.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new wf(C,this.glyphAtlasImage,he.ALPHA),this.glyphAtlasImage=null)},qo.prototype.prepare=function(C){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(C,this.imageAtlasTexture)},qo.prototype.queryRenderedFeatures=function(C,O,$,he,me,Te,Ie,qe,ut,pt){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:he,cameraQueryGeometry:me,scale:Te,tileSize:this.tileSize,pixelPosMatrix:pt,transform:qe,params:Ie,queryPadding:this.queryPadding*ut},C,O,$)},qo.prototype.querySourceFeatures=function(C,O){var $=this.latestFeatureIndex;if(!(!$||!$.rawTileData)){var he=$.loadVTLayers(),me=O?O.sourceLayer:"",Te=he._geojsonTileLayer||he[me];if(!!Te)for(var Ie=Fu(O&&O.filter),qe=this.tileID.canonical,ut=qe.z,pt=qe.x,Pt=qe.y,Jt={z:ut,x:pt,y:Pt},Gt=0;Gt<Te.length;Gt++){var cr=Te.feature(Gt);if(Ie.filter(new si(this.tileID.overscaledZ),cr)){var Dr=$.getId(cr,me),en=new Kc(cr,ut,pt,Pt,Dr);en.tile=Jt,C.push(en)}}}},qo.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},qo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},qo.prototype.setExpiryData=function(C){var O=this.expirationTime;if(C.cacheControl){var $=j(C.cacheControl);$["max-age"]&&(this.expirationTime=Date.now()+$["max-age"]*1e3)}else C.expires&&(this.expirationTime=new Date(C.expires).getTime());if(this.expirationTime){var he=Date.now(),me=!1;if(this.expirationTime>he)me=!1;else if(!O)me=!0;else if(this.expirationTime<O)me=!0;else{var Te=this.expirationTime-O;Te?this.expirationTime=he+Math.max(Te,Z0):me=!0}me?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},qo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},qo.prototype.setFeatureState=function(C,O){if(!(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(C).length===0)){var $=this.latestFeatureIndex.loadVTLayers();for(var he in this.buckets)if(!!O.style.hasLayer(he)){var me=this.buckets[he],Te=me.layers[0].sourceLayer||"_geojsonTileLayer",Ie=$[Te],qe=C[Te];if(!(!Ie||!qe||Object.keys(qe).length===0)){me.update(qe,Ie,this.imageAtlas&&this.imageAtlas.patternPositions||{});var ut=O&&O.style&&O.style.getLayer(he);ut&&(this.queryPadding=Math.max(this.queryPadding,ut.queryRadius(me)))}}}},qo.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},qo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Z.now()},qo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},qo.prototype.setHoldDuration=function(C){this.symbolFadeHoldUntil=Z.now()+C},qo.prototype.setDependencies=function(C,O){for(var $={},he=0,me=O;he<me.length;he+=1){var Te=me[he];$[Te]=!0}this.dependencies[C]=$},qo.prototype.hasDependency=function(C,O){for(var $=0,he=C;$<he.length;$+=1){var me=he[$],Te=this.dependencies[me];if(Te)for(var Ie=0,qe=O;Ie<qe.length;Ie+=1){var ut=qe[Ie];if(Te[ut])return!0}}return!1};var j0=["type","source","source-layer","minzoom","maxzoom","filter","layout"],uf=self.performance,Zv=function(C){this._marks={start:[C.url,"start"].join("#"),end:[C.url,"end"].join("#"),measure:C.url.toString()},uf.mark(this._marks.start)};Zv.prototype.finish=function(){uf.mark(this._marks.end);var C=uf.getEntriesByName(this._marks.measure);return C.length===0&&(uf.measure(this._marks.measure,this._marks.start,this._marks.end),C=uf.getEntriesByName(this._marks.measure),uf.clearMarks(this._marks.start),uf.clearMarks(this._marks.end),uf.clearMeasures(this._marks.measure)),C},e.Actor=Kf,e.AlphaImage=_f,e.CanonicalTileID=Af,e.CollisionBoxArray=Vu,e.Color=di,e.DEMData=Ku,e.DataConstantProperty=Ia,e.DictionaryCoder=jc,e.EXTENT=Ba,e.ErrorEvent=Rr,e.EvaluationParameters=si,e.Event=an,e.Evented=Vr,e.FeatureIndex=Ju,e.FillBucket=wu,e.FillExtrusionBucket=Tu,e.ImageAtlas=dc,e.ImagePosition=Uc,e.LineBucket=rl,e.LngLat=vo,e.LngLatBounds=Vo,e.MercatorCoordinate=Tf,e.ONE_EM=vs,e.OverscaledTileID=Ho,e.Point=f,e.Point$1=f,e.Properties=ji,e.Protobuf=Bc,e.RGBAImage=tl,e.RequestManager=De,e.RequestPerformance=Zv,e.ResourceType=ot,e.SegmentVector=H,e.SourceFeatureState=Jf,e.StructArrayLayout1ui2=rf,e.StructArrayLayout2f1f2i16=xu,e.StructArrayLayout2i4=pf,e.StructArrayLayout3ui6=bu,e.StructArrayLayout4i8=Ou,e.SymbolBucket=Xi,e.Texture=wf,e.Tile=qo,e.Transitionable=mo,e.Uniform1f=Or,e.Uniform1i=Ur,e.Uniform2f=Xr,e.Uniform3f=sn,e.Uniform4f=Sn,e.UniformColor=Fn,e.UniformMatrix4f=Qn,e.UnwrappedTileID=Yv,e.ValidationError=vr,e.WritingMode=El,e.ZoomHistory=Xt,e.add=zf,e.addDynamicAttributes=Eh,e.asyncAll=u,e.bezier=p,e.bindAll=S,e.browser=Z,e.cacheEntryPossiblyAdded=tr,e.clamp=h,e.clearTileCache=lr,e.clipLine=kv,e.clone=Pc,e.clone$1=I,e.clone$2=sh,e.collisionCircleLayout=Ed,e.config=ee,e.create=Df,e.create$1=xf,e.create$2=mf,e.createCommonjsModule=a,e.createExpression=Bl,e.createLayout=Io,e.createStyleLayer=N0,e.cross=ap,e.deepEqual=i,e.dot=np,e.dot$1=up,e.ease=y,e.emitValidationErrors=yo,e.endsWith=k,e.enforceCacheSizeLimit=qt,e.evaluateSizeForFeature=bv,e.evaluateSizeForZoom=_v,e.evaluateVariableOffset=Lv,e.evented=xi,e.extend=A,e.featureFilter=Fu,e.filterObject=z,e.fromRotation=Pf,e.getAnchorAlignment=Ah,e.getAnchorJustification=kh,e.getArrayBuffer=Ne,e.getImage=Ft,e.getJSON=Me,e.getRTLTextPluginStatus=ho,e.getReferrer=jt,e.getVideo=ir,e.identity=Rf,e.invert=af,e.isChar=Kt,e.isMapboxURL=Be,e.keysDifference=s,e.makeRequest=_e,e.mapObject=P,e.mercatorXfromLng=Vv,e.mercatorYfromLat=Hv,e.mercatorZfromAltitude=Gv,e.mul=oh,e.multiply=of,e.mvt=Bf,e.normalize=oc,e.number=lo,e.offscreenCanvasSupported=Jr,e.ortho=ih,e.parseGlyphPBF=t0,e.pbf=Bc,e.performSymbolLayout=x0,e.perspective=ic,e.pick=x,e.plugin=Xa,e.polygonIntersectsPolygon=ai,e.postMapLoadEvent=Tt,e.postTurnstileEvent=Bt,e.potpack=hv,e.refProperties=j0,e.register=ze,e.registerForPluginStateChange=Fi,e.rotate=Cs,e.rotateX=el,e.rotateZ=If,e.scale=qs,e.scale$1=lp,e.scale$2=uh,e.setCacheLimits=Wr,e.setRTLTextPlugin=fa,e.sphericalToCartesian=G,e.sqrLen=hp,e.styleSpec=It,e.sub=op,e.symbolSize=f0,e.transformMat3=ip,e.transformMat4=Dc,e.translate=Lo,e.triggerPluginCompletionEvent=Pa,e.uniqueId=b,e.validateCustomStyleLayer=F0,e.validateLight=wi,e.validateStyle=wo,e.values=_,e.vectorTile=Bf,e.version=n,e.warnOnce=B,e.webpSupported=te,e.window=self,e.wrap=m}),T(["./shared"],function(e){function a(nt){var _e=typeof nt;if(_e==="number"||_e==="boolean"||_e==="string"||nt===void 0||nt===null)return JSON.stringify(nt);if(Array.isArray(nt)){for(var Me="[",Ne=0,We=nt;Ne<We.length;Ne+=1){var Qe=We[Ne];Me+=a(Qe)+","}return Me+"]"}for(var rt=Object.keys(nt).sort(),$e="{",ht=0;ht<rt.length;ht++)$e+=JSON.stringify(rt[ht])+":"+a(nt[rt[ht]])+",";return $e+"}"}function n(nt){for(var _e="",Me=0,Ne=e.refProperties;Me<Ne.length;Me+=1){var We=Ne[Me];_e+="/"+a(nt[We])}return _e}function r(nt,_e){for(var Me={},Ne=0;Ne<nt.length;Ne++){var We=_e&&_e[nt[Ne].id]||n(nt[Ne]);_e&&(_e[nt[Ne].id]=We);var Qe=Me[We];Qe||(Qe=Me[We]=[]),Qe.push(nt[Ne])}var rt=[];for(var $e in Me)rt.push(Me[$e]);return rt}var t=function(_e){this.keyCache={},_e&&this.replace(_e)};t.prototype.replace=function(_e){this._layerConfigs={},this._layers={},this.update(_e,[])},t.prototype.update=function(_e,Me){for(var Ne=this,We=0,Qe=_e;We<Qe.length;We+=1){var rt=Qe[We];this._layerConfigs[rt.id]=rt;var $e=this._layers[rt.id]=e.createStyleLayer(rt);$e._featureFilter=e.featureFilter($e.filter),this.keyCache[rt.id]&&delete this.keyCache[rt.id]}for(var ht=0,xt=Me;ht<xt.length;ht+=1){var kt=xt[ht];delete this.keyCache[kt],delete this._layerConfigs[kt],delete this._layers[kt]}this.familiesBySource={};for(var Wt=r(e.values(this._layerConfigs),this.keyCache),Ft=0,ir=Wt;Ft<ir.length;Ft+=1){var hr=ir[Ft],_r=hr.map(function(mr){return Ne._layers[mr.id]}),an=_r[0];if(an.visibility!=="none"){var Rr=an.source||"",Vr=this.familiesBySource[Rr];Vr||(Vr=this.familiesBySource[Rr]={});var fn=an.sourceLayer||"_geojsonTileLayer",xr=Vr[fn];xr||(xr=Vr[fn]=[]),xr.push(_r)}}};var f=1,o=function(_e){var Me={},Ne=[];for(var We in _e){var Qe=_e[We],rt=Me[We]={};for(var $e in Qe){var ht=Qe[+$e];if(!(!ht||ht.bitmap.width===0||ht.bitmap.height===0)){var xt={x:0,y:0,w:ht.bitmap.width+2*f,h:ht.bitmap.height+2*f};Ne.push(xt),rt[$e]={rect:xt,metrics:ht.metrics}}}}var kt=e.potpack(Ne),Wt=kt.w,Ft=kt.h,ir=new e.AlphaImage({width:Wt||1,height:Ft||1});for(var hr in _e){var _r=_e[hr];for(var an in _r){var Rr=_r[+an];if(!(!Rr||Rr.bitmap.width===0||Rr.bitmap.height===0)){var Vr=Me[hr][an].rect;e.AlphaImage.copy(Rr.bitmap,ir,{x:0,y:0},{x:Vr.x+f,y:Vr.y+f},Rr.bitmap)}}}this.image=ir,this.positions=Me};e.register("GlyphAtlas",o);var i=function(_e){this.tileID=new e.OverscaledTileID(_e.tileID.overscaledZ,_e.tileID.wrap,_e.tileID.canonical.z,_e.tileID.canonical.x,_e.tileID.canonical.y),this.uid=_e.uid,this.zoom=_e.zoom,this.pixelRatio=_e.pixelRatio,this.tileSize=_e.tileSize,this.source=_e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=_e.showCollisionBoxes,this.collectResourceTiming=!!_e.collectResourceTiming,this.returnDependencies=!!_e.returnDependencies,this.promoteId=_e.promoteId};i.prototype.parse=function(_e,Me,Ne,We,Qe){var rt=this;this.status="parsing",this.data=_e,this.collisionBoxArray=new e.CollisionBoxArray;var $e=new e.DictionaryCoder(Object.keys(_e.layers).sort()),ht=new e.FeatureIndex(this.tileID,this.promoteId);ht.bucketLayerIDs=[];var xt={},kt={featureIndex:ht,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Ne},Wt=Me.familiesBySource[this.source];for(var Ft in Wt){var ir=_e.layers[Ft];if(!!ir){ir.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+Ft+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var hr=$e.encode(Ft),_r=[],an=0;an<ir.length;an++){var Rr=ir.feature(an),Vr=ht.getId(Rr,Ft);_r.push({feature:Rr,id:Vr,index:an,sourceLayerIndex:hr})}for(var fn=0,xr=Wt[Ft];fn<xr.length;fn+=1){var mr=xr[fn],Fr=mr[0];if(!(Fr.minzoom&&this.zoom<Math.floor(Fr.minzoom))&&!(Fr.maxzoom&&this.zoom>=Fr.maxzoom)&&Fr.visibility!=="none"){g(mr,this.zoom,Ne);var Ir=xt[Fr.id]=Fr.createBucket({index:ht.bucketLayerIDs.length,layers:mr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:hr,sourceID:this.source});Ir.populate(_r,kt,this.tileID.canonical),ht.bucketLayerIDs.push(mr.map(function(Tr){return Tr.id}))}}}}var Sr,tt,Ct,Zt,ur=e.mapObject(kt.glyphDependencies,function(Tr){return Object.keys(Tr).map(Number)});Object.keys(ur).length?We.send("getGlyphs",{uid:this.uid,stacks:ur},function(Tr,jr){Sr||(Sr=Tr,tt=jr,Pr.call(rt))}):tt={};var Lr=Object.keys(kt.iconDependencies);Lr.length?We.send("getImages",{icons:Lr,source:this.source,tileID:this.tileID,type:"icons"},function(Tr,jr){Sr||(Sr=Tr,Ct=jr,Pr.call(rt))}):Ct={};var Br=Object.keys(kt.patternDependencies);Br.length?We.send("getImages",{icons:Br,source:this.source,tileID:this.tileID,type:"patterns"},function(Tr,jr){Sr||(Sr=Tr,Zt=jr,Pr.call(rt))}):Zt={},Pr.call(this);function Pr(){if(Sr)return Qe(Sr);if(tt&&Ct&&Zt){var Tr=new o(tt),jr=new e.ImageAtlas(Ct,Zt);for(var Pn in xt){var An=xt[Pn];An instanceof e.SymbolBucket?(g(An.layers,this.zoom,Ne),e.performSymbolLayout(An,tt,Tr.positions,Ct,jr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):An.hasPattern&&(An instanceof e.LineBucket||An instanceof e.FillBucket||An instanceof e.FillExtrusionBucket)&&(g(An.layers,this.zoom,Ne),An.addFeatures(kt,this.tileID.canonical,jr.patternPositions))}this.status="done",Qe(null,{buckets:e.values(xt).filter(function($n){return!$n.isEmpty()}),featureIndex:ht,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Tr.image,imageAtlas:jr,glyphMap:this.returnDependencies?tt:null,iconMap:this.returnDependencies?Ct:null,glyphPositions:this.returnDependencies?Tr.positions:null})}}};function g(nt,_e,Me){for(var Ne=new e.EvaluationParameters(_e),We=0,Qe=nt;We<Qe.length;We+=1){var rt=Qe[We];rt.recalculate(Ne,Me)}}function p(nt,_e){var Me=e.getArrayBuffer(nt.request,function(Ne,We,Qe,rt){Ne?_e(Ne):We&&_e(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(We)),rawData:We,cacheControl:Qe,expires:rt})});return function(){Me.cancel(),_e()}}var y=function(_e,Me,Ne,We){this.actor=_e,this.layerIndex=Me,this.availableImages=Ne,this.loadVectorData=We||p,this.loading={},this.loaded={}};y.prototype.loadTile=function(_e,Me){var Ne=this,We=_e.uid;this.loading||(this.loading={});var Qe=_e&&_e.request&&_e.request.collectResourceTiming?new e.RequestPerformance(_e.request):!1,rt=this.loading[We]=new i(_e);rt.abort=this.loadVectorData(_e,function($e,ht){if(delete Ne.loading[We],$e||!ht)return rt.status="done",Ne.loaded[We]=rt,Me($e);var xt=ht.rawData,kt={};ht.expires&&(kt.expires=ht.expires),ht.cacheControl&&(kt.cacheControl=ht.cacheControl);var Wt={};if(Qe){var Ft=Qe.finish();Ft&&(Wt.resourceTiming=JSON.parse(JSON.stringify(Ft)))}rt.vectorTile=ht.vectorTile,rt.parse(ht.vectorTile,Ne.layerIndex,Ne.availableImages,Ne.actor,function(ir,hr){if(ir||!hr)return Me(ir);Me(null,e.extend({rawTileData:xt.slice(0)},hr,kt,Wt))}),Ne.loaded=Ne.loaded||{},Ne.loaded[We]=rt})},y.prototype.reloadTile=function(_e,Me){var Ne=this,We=this.loaded,Qe=_e.uid,rt=this;if(We&&We[Qe]){var $e=We[Qe];$e.showCollisionBoxes=_e.showCollisionBoxes;var ht=function(xt,kt){var Wt=$e.reloadCallback;Wt&&(delete $e.reloadCallback,$e.parse($e.vectorTile,rt.layerIndex,Ne.availableImages,rt.actor,Wt)),Me(xt,kt)};$e.status==="parsing"?$e.reloadCallback=ht:$e.status==="done"&&($e.vectorTile?$e.parse($e.vectorTile,this.layerIndex,this.availableImages,this.actor,ht):ht())}},y.prototype.abortTile=function(_e,Me){var Ne=this.loading,We=_e.uid;Ne&&Ne[We]&&Ne[We].abort&&(Ne[We].abort(),delete Ne[We]),Me()},y.prototype.removeTile=function(_e,Me){var Ne=this.loaded,We=_e.uid;Ne&&Ne[We]&&delete Ne[We],Me()};var h=e.window.ImageBitmap,m=function(){this.loaded={}};m.prototype.loadTile=function(_e,Me){var Ne=_e.uid,We=_e.encoding,Qe=_e.rawImageData,rt=h&&Qe instanceof h?this.getImageData(Qe):Qe,$e=new e.DEMData(Ne,rt,We);this.loaded=this.loaded||{},this.loaded[Ne]=$e,Me(null,$e)},m.prototype.getImageData=function(_e){(!this.offscreenCanvas||!this.offscreenCanvasContext)&&(this.offscreenCanvas=new OffscreenCanvas(_e.width,_e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=_e.width,this.offscreenCanvas.height=_e.height,this.offscreenCanvasContext.drawImage(_e,0,0,_e.width,_e.height);var Me=this.offscreenCanvasContext.getImageData(-1,-1,_e.width+2,_e.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:Me.width,height:Me.height},Me.data)},m.prototype.removeTile=function(_e){var Me=this.loaded,Ne=_e.uid;Me&&Me[Ne]&&delete Me[Ne]};var u=_;function _(nt,_e){var Me=nt&&nt.type,Ne;if(Me==="FeatureCollection")for(Ne=0;Ne<nt.features.length;Ne++)_(nt.features[Ne],_e);else if(Me==="GeometryCollection")for(Ne=0;Ne<nt.geometries.length;Ne++)_(nt.geometries[Ne],_e);else if(Me==="Feature")_(nt.geometry,_e);else if(Me==="Polygon")s(nt.coordinates,_e);else if(Me==="MultiPolygon")for(Ne=0;Ne<nt.coordinates.length;Ne++)s(nt.coordinates[Ne],_e);return nt}function s(nt,_e){if(nt.length!==0){A(nt[0],_e);for(var Me=1;Me<nt.length;Me++)A(nt[Me],!_e)}}function A(nt,_e){for(var Me=0,Ne=0,We=nt.length,Qe=We-1;Ne<We;Qe=Ne++)Me+=(nt[Ne][0]-nt[Qe][0])*(nt[Qe][1]+nt[Ne][1]);Me>=0!=!!_e&&nt.reverse()}var x=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,v=function(_e){this._feature=_e,this.extent=e.EXTENT,this.type=_e.type,this.properties=_e.tags,"id"in _e&&!isNaN(_e.id)&&(this.id=parseInt(_e.id,10))};v.prototype.loadGeometry=function(){if(this._feature.type===1){for(var _e=[],Me=0,Ne=this._feature.geometry;Me<Ne.length;Me+=1){var We=Ne[Me];_e.push([new e.Point$1(We[0],We[1])])}return _e}else{for(var Qe=[],rt=0,$e=this._feature.geometry;rt<$e.length;rt+=1){for(var ht=$e[rt],xt=[],kt=0,Wt=ht;kt<Wt.length;kt+=1){var Ft=Wt[kt];xt.push(new e.Point$1(Ft[0],Ft[1]))}Qe.push(xt)}return Qe}},v.prototype.toGeoJSON=function(_e,Me,Ne){return x.call(this,_e,Me,Ne)};var b=function(_e){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=_e.length,this._features=_e};b.prototype.feature=function(_e){return new v(this._features[_e])};var l=e.vectorTile.VectorTileFeature,L=S;function S(nt,_e){this.options=_e||{},this.features=nt,this.length=nt.length}S.prototype.feature=function(nt){return new k(this.features[nt],this.options.extent)};function k(nt,_e){this.id=typeof nt.id=="number"?nt.id:void 0,this.type=nt.type,this.rawGeometry=nt.type===1?[nt.geometry]:nt.geometry,this.properties=nt.tags,this.extent=_e||4096}k.prototype.loadGeometry=function(){var nt=this.rawGeometry;this.geometry=[];for(var _e=0;_e<nt.length;_e++){for(var Me=nt[_e],Ne=[],We=0;We<Me.length;We++)Ne.push(new e.Point$1(Me[We][0],Me[We][1]));this.geometry.push(Ne)}return this.geometry},k.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var nt=this.geometry,_e=1/0,Me=-1/0,Ne=1/0,We=-1/0,Qe=0;Qe<nt.length;Qe++)for(var rt=nt[Qe],$e=0;$e<rt.length;$e++){var ht=rt[$e];_e=Math.min(_e,ht.x),Me=Math.max(Me,ht.x),Ne=Math.min(Ne,ht.y),We=Math.max(We,ht.y)}return[_e,Ne,Me,We]},k.prototype.toGeoJSON=l.prototype.toGeoJSON;var P=R,z=R,I=B,D=L;function R(nt){var _e=new e.pbf;return F(nt,_e),_e.finish()}function B(nt,_e){_e=_e||{};var Me={};for(var Ne in nt)Me[Ne]=new L(nt[Ne].features,_e),Me[Ne].name=Ne,Me[Ne].version=_e.version,Me[Ne].extent=_e.extent;return R({layers:Me})}function F(nt,_e){for(var Me in nt.layers)_e.writeMessage(3,V,nt.layers[Me])}function V(nt,_e){_e.writeVarintField(15,nt.version||1),_e.writeStringField(1,nt.name||""),_e.writeVarintField(5,nt.extent||4096);var Me,Ne={keys:[],values:[],keycache:{},valuecache:{}};for(Me=0;Me<nt.length;Me++)Ne.feature=nt.feature(Me),_e.writeMessage(2,G,Ne);var We=Ne.keys;for(Me=0;Me<We.length;Me++)_e.writeStringField(3,We[Me]);var Qe=Ne.values;for(Me=0;Me<Qe.length;Me++)_e.writeMessage(4,oe,Qe[Me])}function G(nt,_e){var Me=nt.feature;Me.id!==void 0&&_e.writeVarintField(1,Me.id),_e.writeMessage(2,J,nt),_e.writeVarintField(3,Me.type),_e.writeMessage(4,X,Me)}function J(nt,_e){var Me=nt.feature,Ne=nt.keys,We=nt.values,Qe=nt.keycache,rt=nt.valuecache;for(var $e in Me.properties){var ht=Qe[$e];typeof ht=="undefined"&&(Ne.push($e),ht=Ne.length-1,Qe[$e]=ht),_e.writeVarint(ht);var xt=Me.properties[$e],kt=typeof xt;kt!=="string"&&kt!=="boolean"&&kt!=="number"&&(xt=JSON.stringify(xt));var Wt=kt+":"+xt,Ft=rt[Wt];typeof Ft=="undefined"&&(We.push(xt),Ft=We.length-1,rt[Wt]=Ft),_e.writeVarint(Ft)}}function j(nt,_e){return(_e<<3)+(nt&7)}function Y(nt){return nt<<1^nt>>31}function X(nt,_e){for(var Me=nt.loadGeometry(),Ne=nt.type,We=0,Qe=0,rt=Me.length,$e=0;$e<rt;$e++){var ht=Me[$e],xt=1;Ne===1&&(xt=ht.length),_e.writeVarint(j(1,xt));for(var kt=Ne===3?ht.length-1:ht.length,Wt=0;Wt<kt;Wt++){Wt===1&&Ne!==1&&_e.writeVarint(j(2,kt-1));var Ft=ht[Wt].x-We,ir=ht[Wt].y-Qe;_e.writeVarint(Y(Ft)),_e.writeVarint(Y(ir)),We+=Ft,Qe+=ir}Ne===3&&_e.writeVarint(j(7,1))}}function oe(nt,_e){var Me=typeof nt;Me==="string"?_e.writeStringField(1,nt):Me==="boolean"?_e.writeBooleanField(7,nt):Me==="number"&&(nt%1!==0?_e.writeDoubleField(3,nt):nt<0?_e.writeSVarintField(6,nt):_e.writeVarintField(5,nt))}P.fromVectorTileJs=z,P.fromGeojsonVt=I,P.GeoJSONWrapper=D;function se(nt,_e,Me,Ne,We,Qe){if(!(We-Ne<=Me)){var rt=Ne+We>>1;ie(nt,_e,rt,Ne,We,Qe%2),se(nt,_e,Me,Ne,rt-1,Qe+1),se(nt,_e,Me,rt+1,We,Qe+1)}}function ie(nt,_e,Me,Ne,We,Qe){for(;We>Ne;){if(We-Ne>600){var rt=We-Ne+1,$e=Me-Ne+1,ht=Math.log(rt),xt=.5*Math.exp(2*ht/3),kt=.5*Math.sqrt(ht*xt*(rt-xt)/rt)*($e-rt/2<0?-1:1),Wt=Math.max(Ne,Math.floor(Me-$e*xt/rt+kt)),Ft=Math.min(We,Math.floor(Me+(rt-$e)*xt/rt+kt));ie(nt,_e,Me,Wt,Ft,Qe)}var ir=_e[2*Me+Qe],hr=Ne,_r=We;for(N(nt,_e,Ne,Me),_e[2*We+Qe]>ir&&N(nt,_e,Ne,We);hr<_r;){for(N(nt,_e,hr,_r),hr++,_r--;_e[2*hr+Qe]<ir;)hr++;for(;_e[2*_r+Qe]>ir;)_r--}_e[2*Ne+Qe]===ir?N(nt,_e,Ne,_r):(_r++,N(nt,_e,_r,We)),_r<=Me&&(Ne=_r+1),Me<=_r&&(We=_r-1)}}function N(nt,_e,Me,Ne){U(nt,Me,Ne),U(_e,2*Me,2*Ne),U(_e,2*Me+1,2*Ne+1)}function U(nt,_e,Me){var Ne=nt[_e];nt[_e]=nt[Me],nt[Me]=Ne}function q(nt,_e,Me,Ne,We,Qe,rt){for(var $e=[0,nt.length-1,0],ht=[],xt,kt;$e.length;){var Wt=$e.pop(),Ft=$e.pop(),ir=$e.pop();if(Ft-ir<=rt){for(var hr=ir;hr<=Ft;hr++)xt=_e[2*hr],kt=_e[2*hr+1],xt>=Me&&xt<=We&&kt>=Ne&&kt<=Qe&&ht.push(nt[hr]);continue}var _r=Math.floor((ir+Ft)/2);xt=_e[2*_r],kt=_e[2*_r+1],xt>=Me&&xt<=We&&kt>=Ne&&kt<=Qe&&ht.push(nt[_r]);var an=(Wt+1)%2;(Wt===0?Me<=xt:Ne<=kt)&&($e.push(ir),$e.push(_r-1),$e.push(an)),(Wt===0?We>=xt:Qe>=kt)&&($e.push(_r+1),$e.push(Ft),$e.push(an))}return ht}function Q(nt,_e,Me,Ne,We,Qe){for(var rt=[0,nt.length-1,0],$e=[],ht=We*We;rt.length;){var xt=rt.pop(),kt=rt.pop(),Wt=rt.pop();if(kt-Wt<=Qe){for(var Ft=Wt;Ft<=kt;Ft++)W(_e[2*Ft],_e[2*Ft+1],Me,Ne)<=ht&&$e.push(nt[Ft]);continue}var ir=Math.floor((Wt+kt)/2),hr=_e[2*ir],_r=_e[2*ir+1];W(hr,_r,Me,Ne)<=ht&&$e.push(nt[ir]);var an=(xt+1)%2;(xt===0?Me-We<=hr:Ne-We<=_r)&&(rt.push(Wt),rt.push(ir-1),rt.push(an)),(xt===0?Me+We>=hr:Ne+We>=_r)&&(rt.push(ir+1),rt.push(kt),rt.push(an))}return $e}function W(nt,_e,Me,Ne){var We=nt-Me,Qe=_e-Ne;return We*We+Qe*Qe}var Z=function(nt){return nt[0]},ee=function(nt){return nt[1]},te=function(_e,Me,Ne,We,Qe){Me===void 0&&(Me=Z),Ne===void 0&&(Ne=ee),We===void 0&&(We=64),Qe===void 0&&(Qe=Float64Array),this.nodeSize=We,this.points=_e;for(var rt=_e.length<65536?Uint16Array:Uint32Array,$e=this.ids=new rt(_e.length),ht=this.coords=new Qe(_e.length*2),xt=0;xt<_e.length;xt++)$e[xt]=xt,ht[2*xt]=Me(_e[xt]),ht[2*xt+1]=Ne(_e[xt]);se($e,ht,We,0,$e.length-1,0)};te.prototype.range=function(_e,Me,Ne,We){return q(this.ids,this.coords,_e,Me,Ne,We,this.nodeSize)},te.prototype.within=function(_e,Me,Ne){return Q(this.ids,this.coords,_e,Me,Ne,this.nodeSize)};var ae={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(nt){return nt}},le=function(_e){this.options=Ve(Object.create(ae),_e),this.trees=new Array(this.options.maxZoom+1)};le.prototype.load=function(_e){var Me=this.options,Ne=Me.log,We=Me.minZoom,Qe=Me.maxZoom,rt=Me.nodeSize;Ne&&console.time("total time");var $e="prepare "+_e.length+" points";Ne&&console.time($e),this.points=_e;for(var ht=[],xt=0;xt<_e.length;xt++)!_e[xt].geometry||ht.push(fe(_e[xt],xt));this.trees[Qe+1]=new te(ht,xe,Le,rt,Float32Array),Ne&&console.timeEnd($e);for(var kt=Qe;kt>=We;kt--){var Wt=+Date.now();ht=this._cluster(ht,kt),this.trees[kt]=new te(ht,xe,Le,rt,Float32Array),Ne&&console.log("z%d: %d clusters in %dms",kt,ht.length,+Date.now()-Wt)}return Ne&&console.timeEnd("total time"),this},le.prototype.getClusters=function(_e,Me){var Ne=((_e[0]+180)%360+360)%360-180,We=Math.max(-90,Math.min(90,_e[1])),Qe=_e[2]===180?180:((_e[2]+180)%360+360)%360-180,rt=Math.max(-90,Math.min(90,_e[3]));if(_e[2]-_e[0]>=360)Ne=-180,Qe=180;else if(Ne>Qe){var $e=this.getClusters([Ne,We,180,rt],Me),ht=this.getClusters([-180,We,Qe,rt],Me);return $e.concat(ht)}for(var xt=this.trees[this._limitZoom(Me)],kt=xt.range(Ae(Ne),we(rt),Ae(Qe),we(We)),Wt=[],Ft=0,ir=kt;Ft<ir.length;Ft+=1){var hr=ir[Ft],_r=xt.points[hr];Wt.push(_r.numPoints?pe(_r):this.points[_r.index])}return Wt},le.prototype.getChildren=function(_e){var Me=this._getOriginId(_e),Ne=this._getOriginZoom(_e),We="No cluster with the specified id.",Qe=this.trees[Ne];if(!Qe)throw new Error(We);var rt=Qe.points[Me];if(!rt)throw new Error(We);for(var $e=this.options.radius/(this.options.extent*Math.pow(2,Ne-1)),ht=Qe.within(rt.x,rt.y,$e),xt=[],kt=0,Wt=ht;kt<Wt.length;kt+=1){var Ft=Wt[kt],ir=Qe.points[Ft];ir.parentId===_e&&xt.push(ir.numPoints?pe(ir):this.points[ir.index])}if(xt.length===0)throw new Error(We);return xt},le.prototype.getLeaves=function(_e,Me,Ne){Me=Me||10,Ne=Ne||0;var We=[];return this._appendLeaves(We,_e,Me,Ne,0),We},le.prototype.getTile=function(_e,Me,Ne){var We=this.trees[this._limitZoom(_e)],Qe=Math.pow(2,_e),rt=this.options,$e=rt.extent,ht=rt.radius,xt=ht/$e,kt=(Ne-xt)/Qe,Wt=(Ne+1+xt)/Qe,Ft={features:[]};return this._addTileFeatures(We.range((Me-xt)/Qe,kt,(Me+1+xt)/Qe,Wt),We.points,Me,Ne,Qe,Ft),Me===0&&this._addTileFeatures(We.range(1-xt/Qe,kt,1,Wt),We.points,Qe,Ne,Qe,Ft),Me===Qe-1&&this._addTileFeatures(We.range(0,kt,xt/Qe,Wt),We.points,-1,Ne,Qe,Ft),Ft.features.length?Ft:null},le.prototype.getClusterExpansionZoom=function(_e){for(var Me=this._getOriginZoom(_e)-1;Me<=this.options.maxZoom;){var Ne=this.getChildren(_e);if(Me++,Ne.length!==1)break;_e=Ne[0].properties.cluster_id}return Me},le.prototype._appendLeaves=function(_e,Me,Ne,We,Qe){for(var rt=this.getChildren(Me),$e=0,ht=rt;$e<ht.length;$e+=1){var xt=ht[$e],kt=xt.properties;if(kt&&kt.cluster?Qe+kt.point_count<=We?Qe+=kt.point_count:Qe=this._appendLeaves(_e,kt.cluster_id,Ne,We,Qe):Qe<We?Qe++:_e.push(xt),_e.length===Ne)break}return Qe},le.prototype._addTileFeatures=function(_e,Me,Ne,We,Qe,rt){for(var $e=0,ht=_e;$e<ht.length;$e+=1){var xt=ht[$e],kt=Me[xt],Wt=kt.numPoints,Ft={type:1,geometry:[[Math.round(this.options.extent*(kt.x*Qe-Ne)),Math.round(this.options.extent*(kt.y*Qe-We))]],tags:Wt?ge(kt):this.points[kt.index].properties},ir=void 0;Wt?ir=kt.id:this.options.generateId?ir=kt.index:this.points[kt.index].id&&(ir=this.points[kt.index].id),ir!==void 0&&(Ft.id=ir),rt.features.push(Ft)}},le.prototype._limitZoom=function(_e){return Math.max(this.options.minZoom,Math.min(_e,this.options.maxZoom+1))},le.prototype._cluster=function(_e,Me){for(var Ne=[],We=this.options,Qe=We.radius,rt=We.extent,$e=We.reduce,ht=Qe/(rt*Math.pow(2,Me)),xt=0;xt<_e.length;xt++){var kt=_e[xt];if(!(kt.zoom<=Me)){kt.zoom=Me;for(var Wt=this.trees[Me+1],Ft=Wt.within(kt.x,kt.y,ht),ir=kt.numPoints||1,hr=kt.x*ir,_r=kt.y*ir,an=$e&&ir>1?this._map(kt,!0):null,Rr=(xt<<5)+(Me+1)+this.points.length,Vr=0,fn=Ft;Vr<fn.length;Vr+=1){var xr=fn[Vr],mr=Wt.points[xr];if(!(mr.zoom<=Me)){mr.zoom=Me;var Fr=mr.numPoints||1;hr+=mr.x*Fr,_r+=mr.y*Fr,ir+=Fr,mr.parentId=Rr,$e&&(an||(an=this._map(kt,!0)),$e(an,this._map(mr)))}}ir===1?Ne.push(kt):(kt.parentId=Rr,Ne.push(ye(hr/ir,_r/ir,Rr,ir,an)))}}return Ne},le.prototype._getOriginId=function(_e){return _e-this.points.length>>5},le.prototype._getOriginZoom=function(_e){return(_e-this.points.length)%32},le.prototype._map=function(_e,Me){if(_e.numPoints)return Me?Ve({},_e.properties):_e.properties;var Ne=this.points[_e.index].properties,We=this.options.map(Ne);return Me&&We===Ne?Ve({},We):We};function ye(nt,_e,Me,Ne,We){return{x:nt,y:_e,zoom:1/0,id:Me,parentId:-1,numPoints:Ne,properties:We}}function fe(nt,_e){var Me=nt.geometry.coordinates,Ne=Me[0],We=Me[1];return{x:Ae(Ne),y:we(We),zoom:1/0,index:_e,parentId:-1}}function pe(nt){return{type:"Feature",id:nt.id,properties:ge(nt),geometry:{type:"Point",coordinates:[De(nt.x),Be(nt.y)]}}}function ge(nt){var _e=nt.numPoints,Me=_e>=1e4?Math.round(_e/1e3)+"k":_e>=1e3?Math.round(_e/100)/10+"k":_e;return Ve(Ve({},nt.properties),{cluster:!0,cluster_id:nt.id,point_count:_e,point_count_abbreviated:Me})}function Ae(nt){return nt/360+.5}function we(nt){var _e=Math.sin(nt*Math.PI/180),Me=.5-.25*Math.log((1+_e)/(1-_e))/Math.PI;return Me<0?0:Me>1?1:Me}function De(nt){return(nt-.5)*360}function Be(nt){var _e=(180-nt*360)*Math.PI/180;return 360*Math.atan(Math.exp(_e))/Math.PI-90}function Ve(nt,_e){for(var Me in _e)nt[Me]=_e[Me];return nt}function xe(nt){return nt.x}function Le(nt){return nt.y}function He(nt,_e,Me,Ne){for(var We=Ne,Qe=Me-_e>>1,rt=Me-_e,$e,ht=nt[_e],xt=nt[_e+1],kt=nt[Me],Wt=nt[Me+1],Ft=_e+3;Ft<Me;Ft+=3){var ir=Je(nt[Ft],nt[Ft+1],ht,xt,kt,Wt);if(ir>We)$e=Ft,We=ir;else if(ir===We){var hr=Math.abs(Ft-Qe);hr<rt&&($e=Ft,rt=hr)}}We>Ne&&($e-_e>3&&He(nt,_e,$e,Ne),nt[$e+2]=We,Me-$e>3&&He(nt,$e,Me,Ne))}function Je(nt,_e,Me,Ne,We,Qe){var rt=We-Me,$e=Qe-Ne;if(rt!==0||$e!==0){var ht=((nt-Me)*rt+(_e-Ne)*$e)/(rt*rt+$e*$e);ht>1?(Me=We,Ne=Qe):ht>0&&(Me+=rt*ht,Ne+=$e*ht)}return rt=nt-Me,$e=_e-Ne,rt*rt+$e*$e}function Oe(nt,_e,Me,Ne){var We={id:typeof nt=="undefined"?null:nt,type:_e,geometry:Me,tags:Ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return Pe(We),We}function Pe(nt){var _e=nt.geometry,Me=nt.type;if(Me==="Point"||Me==="MultiPoint"||Me==="LineString")Ue(nt,_e);else if(Me==="Polygon"||Me==="MultiLineString")for(var Ne=0;Ne<_e.length;Ne++)Ue(nt,_e[Ne]);else if(Me==="MultiPolygon")for(Ne=0;Ne<_e.length;Ne++)for(var We=0;We<_e[Ne].length;We++)Ue(nt,_e[Ne][We])}function Ue(nt,_e){for(var Me=0;Me<_e.length;Me+=3)nt.minX=Math.min(nt.minX,_e[Me]),nt.minY=Math.min(nt.minY,_e[Me+1]),nt.maxX=Math.max(nt.maxX,_e[Me]),nt.maxY=Math.max(nt.maxY,_e[Me+1])}function vt(nt,_e){var Me=[];if(nt.type==="FeatureCollection")for(var Ne=0;Ne<nt.features.length;Ne++)Lt(Me,nt.features[Ne],_e,Ne);else nt.type==="Feature"?Lt(Me,nt,_e):Lt(Me,{geometry:nt},_e);return Me}function Lt(nt,_e,Me,Ne){if(!!_e.geometry){var We=_e.geometry.coordinates,Qe=_e.geometry.type,rt=Math.pow(Me.tolerance/((1<<Me.maxZoom)*Me.extent),2),$e=[],ht=_e.id;if(Me.promoteId?ht=_e.properties[Me.promoteId]:Me.generateId&&(ht=Ne||0),Qe==="Point")Yt(We,$e);else if(Qe==="MultiPoint")for(var xt=0;xt<We.length;xt++)Yt(We[xt],$e);else if(Qe==="LineString")At(We,$e,rt,!1);else if(Qe==="MultiLineString")if(Me.lineMetrics){for(xt=0;xt<We.length;xt++)$e=[],At(We[xt],$e,rt,!1),nt.push(Oe(ht,"LineString",$e,_e.properties));return}else Rt(We,$e,rt,!1);else if(Qe==="Polygon")Rt(We,$e,rt,!0);else if(Qe==="MultiPolygon")for(xt=0;xt<We.length;xt++){var kt=[];Rt(We[xt],kt,rt,!0),$e.push(kt)}else if(Qe==="GeometryCollection"){for(xt=0;xt<_e.geometry.geometries.length;xt++)Lt(nt,{id:ht,geometry:_e.geometry.geometries[xt],properties:_e.properties},Me,Ne);return}else throw new Error("Input data is not a valid GeoJSON object.");nt.push(Oe(ht,Qe,$e,_e.properties))}}function Yt(nt,_e){_e.push(Bt(nt[0])),_e.push(Mt(nt[1])),_e.push(0)}function At(nt,_e,Me,Ne){for(var We,Qe,rt=0,$e=0;$e<nt.length;$e++){var ht=Bt(nt[$e][0]),xt=Mt(nt[$e][1]);_e.push(ht),_e.push(xt),_e.push(0),$e>0&&(Ne?rt+=(We*xt-ht*Qe)/2:rt+=Math.sqrt(Math.pow(ht-We,2)+Math.pow(xt-Qe,2))),We=ht,Qe=xt}var kt=_e.length-3;_e[2]=1,He(_e,0,kt,Me),_e[kt+2]=1,_e.size=Math.abs(rt),_e.start=0,_e.end=_e.size}function Rt(nt,_e,Me,Ne){for(var We=0;We<nt.length;We++){var Qe=[];At(nt[We],Qe,Me,Ne),_e.push(Qe)}}function Bt(nt){return nt/360+.5}function Mt(nt){var _e=Math.sin(nt*Math.PI/180),Me=.5-.25*Math.log((1+_e)/(1-_e))/Math.PI;return Me<0?0:Me>1?1:Me}function Tt(nt,_e,Me,Ne,We,Qe,rt,$e){if(Me/=_e,Ne/=_e,Qe>=Me&&rt<Ne)return nt;if(rt<Me||Qe>=Ne)return null;for(var ht=[],xt=0;xt<nt.length;xt++){var kt=nt[xt],Wt=kt.geometry,Ft=kt.type,ir=We===0?kt.minX:kt.minY,hr=We===0?kt.maxX:kt.maxY;if(ir>=Me&&hr<Ne){ht.push(kt);continue}else if(hr<Me||ir>=Ne)continue;var _r=[];if(Ft==="Point"||Ft==="MultiPoint")at(Wt,_r,Me,Ne,We);else if(Ft==="LineString")ct(Wt,_r,Me,Ne,We,!1,$e.lineMetrics);else if(Ft==="MultiLineString")ke(Wt,_r,Me,Ne,We,!1);else if(Ft==="Polygon")ke(Wt,_r,Me,Ne,We,!0);else if(Ft==="MultiPolygon")for(var an=0;an<Wt.length;an++){var Rr=[];ke(Wt[an],Rr,Me,Ne,We,!0),Rr.length&&_r.push(Rr)}if(_r.length){if($e.lineMetrics&&Ft==="LineString"){for(an=0;an<_r.length;an++)ht.push(Oe(kt.id,Ft,_r[an],kt.tags));continue}(Ft==="LineString"||Ft==="MultiLineString")&&(_r.length===1?(Ft="LineString",_r=_r[0]):Ft="MultiLineString"),(Ft==="Point"||Ft==="MultiPoint")&&(Ft=_r.length===3?"Point":"MultiPoint"),ht.push(Oe(kt.id,Ft,_r,kt.tags))}}return ht.length?ht:null}function at(nt,_e,Me,Ne,We){for(var Qe=0;Qe<nt.length;Qe+=3){var rt=nt[Qe+We];rt>=Me&&rt<=Ne&&(_e.push(nt[Qe]),_e.push(nt[Qe+1]),_e.push(nt[Qe+2]))}}function ct(nt,_e,Me,Ne,We,Qe,rt){for(var $e=je(nt),ht=We===0?Ke:st,xt=nt.start,kt,Wt,Ft=0;Ft<nt.length-3;Ft+=3){var ir=nt[Ft],hr=nt[Ft+1],_r=nt[Ft+2],an=nt[Ft+3],Rr=nt[Ft+4],Vr=We===0?ir:hr,fn=We===0?an:Rr,xr=!1;rt&&(kt=Math.sqrt(Math.pow(ir-an,2)+Math.pow(hr-Rr,2))),Vr<Me?fn>Me&&(Wt=ht($e,ir,hr,an,Rr,Me),rt&&($e.start=xt+kt*Wt)):Vr>Ne?fn<Ne&&(Wt=ht($e,ir,hr,an,Rr,Ne),rt&&($e.start=xt+kt*Wt)):Ye($e,ir,hr,_r),fn<Me&&Vr>=Me&&(Wt=ht($e,ir,hr,an,Rr,Me),xr=!0),fn>Ne&&Vr<=Ne&&(Wt=ht($e,ir,hr,an,Rr,Ne),xr=!0),!Qe&&xr&&(rt&&($e.end=xt+kt*Wt),_e.push($e),$e=je(nt)),rt&&(xt+=kt)}var mr=nt.length-3;ir=nt[mr],hr=nt[mr+1],_r=nt[mr+2],Vr=We===0?ir:hr,Vr>=Me&&Vr<=Ne&&Ye($e,ir,hr,_r),mr=$e.length-3,Qe&&mr>=3&&($e[mr]!==$e[0]||$e[mr+1]!==$e[1])&&Ye($e,$e[0],$e[1],$e[2]),$e.length&&_e.push($e)}function je(nt){var _e=[];return _e.size=nt.size,_e.start=nt.start,_e.end=nt.end,_e}function ke(nt,_e,Me,Ne,We,Qe){for(var rt=0;rt<nt.length;rt++)ct(nt[rt],_e,Me,Ne,We,Qe,!1)}function Ye(nt,_e,Me,Ne){nt.push(_e),nt.push(Me),nt.push(Ne)}function Ke(nt,_e,Me,Ne,We,Qe){var rt=(Qe-_e)/(Ne-_e);return nt.push(Qe),nt.push(Me+(We-Me)*rt),nt.push(1),rt}function st(nt,_e,Me,Ne,We,Qe){var rt=(Qe-Me)/(We-Me);return nt.push(_e+(Ne-_e)*rt),nt.push(Qe),nt.push(1),rt}function Et(nt,_e){var Me=_e.buffer/_e.extent,Ne=nt,We=Tt(nt,1,-1-Me,Me,0,-1,2,_e),Qe=Tt(nt,1,1-Me,2+Me,0,-1,2,_e);return(We||Qe)&&(Ne=Tt(nt,1,-Me,1+Me,0,-1,2,_e)||[],We&&(Ne=bt(We,1).concat(Ne)),Qe&&(Ne=Ne.concat(bt(Qe,-1)))),Ne}function bt(nt,_e){for(var Me=[],Ne=0;Ne<nt.length;Ne++){var We=nt[Ne],Qe=We.type,rt;if(Qe==="Point"||Qe==="MultiPoint"||Qe==="LineString")rt=zt(We.geometry,_e);else if(Qe==="MultiLineString"||Qe==="Polygon"){rt=[];for(var $e=0;$e<We.geometry.length;$e++)rt.push(zt(We.geometry[$e],_e))}else if(Qe==="MultiPolygon")for(rt=[],$e=0;$e<We.geometry.length;$e++){for(var ht=[],xt=0;xt<We.geometry[$e].length;xt++)ht.push(zt(We.geometry[$e][xt],_e));rt.push(ht)}Me.push(Oe(We.id,Qe,rt,We.tags))}return Me}function zt(nt,_e){var Me=[];Me.size=nt.size,nt.start!==void 0&&(Me.start=nt.start,Me.end=nt.end);for(var Ne=0;Ne<nt.length;Ne+=3)Me.push(nt[Ne]+_e,nt[Ne+1],nt[Ne+2]);return Me}function $t(nt,_e){if(nt.transformed)return nt;var Me=1<<nt.z,Ne=nt.x,We=nt.y,Qe,rt,$e;for(Qe=0;Qe<nt.features.length;Qe++){var ht=nt.features[Qe],xt=ht.geometry,kt=ht.type;if(ht.geometry=[],kt===1)for(rt=0;rt<xt.length;rt+=2)ht.geometry.push(Ot(xt[rt],xt[rt+1],_e,Me,Ne,We));else for(rt=0;rt<xt.length;rt++){var Wt=[];for($e=0;$e<xt[rt].length;$e+=2)Wt.push(Ot(xt[rt][$e],xt[rt][$e+1],_e,Me,Ne,We));ht.geometry.push(Wt)}}return nt.transformed=!0,nt}function Ot(nt,_e,Me,Ne,We,Qe){return[Math.round(Me*(nt*Ne-We)),Math.round(Me*(_e*Ne-Qe))]}function Qt(nt,_e,Me,Ne,We){for(var Qe=_e===We.maxZoom?0:We.tolerance/((1<<_e)*We.extent),rt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Me,y:Ne,z:_e,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},$e=0;$e<nt.length;$e++){rt.numFeatures++,tr(rt,nt[$e],Qe,We);var ht=nt[$e].minX,xt=nt[$e].minY,kt=nt[$e].maxX,Wt=nt[$e].maxY;ht<rt.minX&&(rt.minX=ht),xt<rt.minY&&(rt.minY=xt),kt>rt.maxX&&(rt.maxX=kt),Wt>rt.maxY&&(rt.maxY=Wt)}return rt}function tr(nt,_e,Me,Ne){var We=_e.geometry,Qe=_e.type,rt=[];if(Qe==="Point"||Qe==="MultiPoint")for(var $e=0;$e<We.length;$e+=3)rt.push(We[$e]),rt.push(We[$e+1]),nt.numPoints++,nt.numSimplified++;else if(Qe==="LineString")qt(rt,We,nt,Me,!1,!1);else if(Qe==="MultiLineString"||Qe==="Polygon")for($e=0;$e<We.length;$e++)qt(rt,We[$e],nt,Me,Qe==="Polygon",$e===0);else if(Qe==="MultiPolygon")for(var ht=0;ht<We.length;ht++){var xt=We[ht];for($e=0;$e<xt.length;$e++)qt(rt,xt[$e],nt,Me,!0,$e===0)}if(rt.length){var kt=_e.tags||null;if(Qe==="LineString"&&Ne.lineMetrics){kt={};for(var Wt in _e.tags)kt[Wt]=_e.tags[Wt];kt.mapbox_clip_start=We.start/We.size,kt.mapbox_clip_end=We.end/We.size}var Ft={geometry:rt,type:Qe==="Polygon"||Qe==="MultiPolygon"?3:Qe==="LineString"||Qe==="MultiLineString"?2:1,tags:kt};_e.id!==null&&(Ft.id=_e.id),nt.features.push(Ft)}}function qt(nt,_e,Me,Ne,We,Qe){var rt=Ne*Ne;if(Ne>0&&_e.size<(We?rt:Ne)){Me.numPoints+=_e.length/3;return}for(var $e=[],ht=0;ht<_e.length;ht+=3)(Ne===0||_e[ht+2]>rt)&&(Me.numSimplified++,$e.push(_e[ht]),$e.push(_e[ht+1])),Me.numPoints++;We&&lr($e,Qe),nt.push($e)}function lr(nt,_e){for(var Me=0,Ne=0,We=nt.length,Qe=We-2;Ne<We;Qe=Ne,Ne+=2)Me+=(nt[Ne]-nt[Qe])*(nt[Ne+1]+nt[Qe+1]);if(Me>0===_e)for(Ne=0,We=nt.length;Ne<We/2;Ne+=2){var rt=nt[Ne],$e=nt[Ne+1];nt[Ne]=nt[We-2-Ne],nt[Ne+1]=nt[We-1-Ne],nt[We-2-Ne]=rt,nt[We-1-Ne]=$e}}function Wr(nt,_e){return new cn(nt,_e)}function cn(nt,_e){_e=this.options=ot(Object.create(this.options),_e);var Me=_e.debug;if(Me&&console.time("preprocess data"),_e.maxZoom<0||_e.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(_e.promoteId&&_e.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ne=vt(nt,_e);this.tiles={},this.tileCoords=[],Me&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",_e.indexMaxZoom,_e.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ne=Et(Ne,_e),Ne.length&&this.splitTile(Ne,0,0,0),Me&&(Ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}cn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},cn.prototype.splitTile=function(nt,_e,Me,Ne,We,Qe,rt){for(var $e=[nt,_e,Me,Ne],ht=this.options,xt=ht.debug;$e.length;){Ne=$e.pop(),Me=$e.pop(),_e=$e.pop(),nt=$e.pop();var kt=1<<_e,Wt=Jr(_e,Me,Ne),Ft=this.tiles[Wt];if(!Ft&&(xt>1&&console.time("creation"),Ft=this.tiles[Wt]=Qt(nt,_e,Me,Ne,ht),this.tileCoords.push({z:_e,x:Me,y:Ne}),xt)){xt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",_e,Me,Ne,Ft.numFeatures,Ft.numPoints,Ft.numSimplified),console.timeEnd("creation"));var ir="z"+_e;this.stats[ir]=(this.stats[ir]||0)+1,this.total++}if(Ft.source=nt,We){if(_e===ht.maxZoom||_e===We)continue;var hr=1<<We-_e;if(Me!==Math.floor(Qe/hr)||Ne!==Math.floor(rt/hr))continue}else if(_e===ht.indexMaxZoom||Ft.numPoints<=ht.indexMaxPoints)continue;if(Ft.source=null,nt.length!==0){xt>1&&console.time("clipping");var _r=.5*ht.buffer/ht.extent,an=.5-_r,Rr=.5+_r,Vr=1+_r,fn,xr,mr,Fr,Ir,Sr;fn=xr=mr=Fr=null,Ir=Tt(nt,kt,Me-_r,Me+Rr,0,Ft.minX,Ft.maxX,ht),Sr=Tt(nt,kt,Me+an,Me+Vr,0,Ft.minX,Ft.maxX,ht),nt=null,Ir&&(fn=Tt(Ir,kt,Ne-_r,Ne+Rr,1,Ft.minY,Ft.maxY,ht),xr=Tt(Ir,kt,Ne+an,Ne+Vr,1,Ft.minY,Ft.maxY,ht),Ir=null),Sr&&(mr=Tt(Sr,kt,Ne-_r,Ne+Rr,1,Ft.minY,Ft.maxY,ht),Fr=Tt(Sr,kt,Ne+an,Ne+Vr,1,Ft.minY,Ft.maxY,ht),Sr=null),xt>1&&console.timeEnd("clipping"),$e.push(fn||[],_e+1,Me*2,Ne*2),$e.push(xr||[],_e+1,Me*2,Ne*2+1),$e.push(mr||[],_e+1,Me*2+1,Ne*2),$e.push(Fr||[],_e+1,Me*2+1,Ne*2+1)}}},cn.prototype.getTile=function(nt,_e,Me){var Ne=this.options,We=Ne.extent,Qe=Ne.debug;if(nt<0||nt>24)return null;var rt=1<<nt;_e=(_e%rt+rt)%rt;var $e=Jr(nt,_e,Me);if(this.tiles[$e])return $t(this.tiles[$e],We);Qe>1&&console.log("drilling down to z%d-%d-%d",nt,_e,Me);for(var ht=nt,xt=_e,kt=Me,Wt;!Wt&&ht>0;)ht--,xt=Math.floor(xt/2),kt=Math.floor(kt/2),Wt=this.tiles[Jr(ht,xt,kt)];return!Wt||!Wt.source?null:(Qe>1&&console.log("found parent tile z%d-%d-%d",ht,xt,kt),Qe>1&&console.time("drilling down"),this.splitTile(Wt.source,ht,xt,kt,nt,_e,Me),Qe>1&&console.timeEnd("drilling down"),this.tiles[$e]?$t(this.tiles[$e],We):null)};function Jr(nt,_e,Me){return((1<<nt)*Me+_e)*32+nt}function ot(nt,_e){for(var Me in _e)nt[Me]=_e[Me];return nt}function Vt(nt,_e){var Me=nt.tileID.canonical;if(!this._geoJSONIndex)return _e(null,null);var Ne=this._geoJSONIndex.getTile(Me.z,Me.x,Me.y);if(!Ne)return _e(null,null);var We=new b(Ne.features),Qe=P(We);(Qe.byteOffset!==0||Qe.byteLength!==Qe.buffer.byteLength)&&(Qe=new Uint8Array(Qe)),_e(null,{vectorTile:We,rawData:Qe.buffer})}var jt=function(nt){function _e(Me,Ne,We,Qe){nt.call(this,Me,Ne,We,Vt),Qe&&(this.loadGeoJSON=Qe)}return nt&&(_e.__proto__=nt),_e.prototype=Object.create(nt&&nt.prototype),_e.prototype.constructor=_e,_e.prototype.loadData=function(Ne,We){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=We,this._pendingLoadDataParams=Ne,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},_e.prototype._loadData=function(){var Ne=this;if(!(!this._pendingCallback||!this._pendingLoadDataParams)){var We=this._pendingCallback,Qe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var rt=Qe&&Qe.request&&Qe.request.collectResourceTiming?new e.RequestPerformance(Qe.request):!1;this.loadGeoJSON(Qe,function($e,ht){if($e||!ht)return We($e);if(typeof ht!="object")return We(new Error("Input data given to '"+Qe.source+"' is not a valid GeoJSON object."));u(ht,!0);try{Ne._geoJSONIndex=Qe.cluster?new le(Ut(Qe)).load(ht.features):Wr(ht,Qe.geojsonVtOptions)}catch(Wt){return We(Wt)}Ne.loaded={};var xt={};if(rt){var kt=rt.finish();kt&&(xt.resourceTiming={},xt.resourceTiming[Qe.source]=JSON.parse(JSON.stringify(kt)))}We(null,xt)})}},_e.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},_e.prototype.reloadTile=function(Ne,We){var Qe=this.loaded,rt=Ne.uid;return Qe&&Qe[rt]?nt.prototype.reloadTile.call(this,Ne,We):this.loadTile(Ne,We)},_e.prototype.loadGeoJSON=function(Ne,We){if(Ne.request)e.getJSON(Ne.request,We);else if(typeof Ne.data=="string")try{return We(null,JSON.parse(Ne.data))}catch{return We(new Error("Input data given to '"+Ne.source+"' is not a valid GeoJSON object."))}else return We(new Error("Input data given to '"+Ne.source+"' is not a valid GeoJSON object."))},_e.prototype.removeSource=function(Ne,We){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),We()},_e.prototype.getClusterExpansionZoom=function(Ne,We){try{We(null,this._geoJSONIndex.getClusterExpansionZoom(Ne.clusterId))}catch(Qe){We(Qe)}},_e.prototype.getClusterChildren=function(Ne,We){try{We(null,this._geoJSONIndex.getChildren(Ne.clusterId))}catch(Qe){We(Qe)}},_e.prototype.getClusterLeaves=function(Ne,We){try{We(null,this._geoJSONIndex.getLeaves(Ne.clusterId,Ne.limit,Ne.offset))}catch(Qe){We(Qe)}},_e}(y);function Ut(nt){var _e=nt.superclusterOptions,Me=nt.clusterProperties;if(!Me||!_e)return _e;for(var Ne={},We={},Qe={accumulated:null,zoom:0},rt={properties:null},$e=Object.keys(Me),ht=0,xt=$e;ht<xt.length;ht+=1){var kt=xt[ht],Wt=Me[kt],Ft=Wt[0],ir=Wt[1],hr=e.createExpression(ir),_r=e.createExpression(typeof Ft=="string"?[Ft,["accumulated"],["get",kt]]:Ft);Ne[kt]=hr.value,We[kt]=_r.value}return _e.map=function(an){rt.properties=an;for(var Rr={},Vr=0,fn=$e;Vr<fn.length;Vr+=1){var xr=fn[Vr];Rr[xr]=Ne[xr].evaluate(Qe,rt)}return Rr},_e.reduce=function(an,Rr){rt.properties=Rr;for(var Vr=0,fn=$e;Vr<fn.length;Vr+=1){var xr=fn[Vr];Qe.accumulated=an[xr],an[xr]=We[xr].evaluate(Qe,rt)}},_e}var yr=function(_e){var Me=this;this.self=_e,this.actor=new e.Actor(_e,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:y,geojson:jt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Ne,We){if(Me.workerSourceTypes[Ne])throw new Error('Worker source with name "'+Ne+'" already registered.');Me.workerSourceTypes[Ne]=We},this.self.registerRTLTextPlugin=function(Ne){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=Ne.applyArabicShaping,e.plugin.processBidirectionalText=Ne.processBidirectionalText,e.plugin.processStyledBidirectionalText=Ne.processStyledBidirectionalText}};return yr.prototype.setReferrer=function(_e,Me){this.referrer=Me},yr.prototype.setImages=function(_e,Me,Ne){this.availableImages[_e]=Me;for(var We in this.workerSources[_e]){var Qe=this.workerSources[_e][We];for(var rt in Qe)Qe[rt].availableImages=Me}Ne()},yr.prototype.setLayers=function(_e,Me,Ne){this.getLayerIndex(_e).replace(Me),Ne()},yr.prototype.updateLayers=function(_e,Me,Ne){this.getLayerIndex(_e).update(Me.layers,Me.removedIds),Ne()},yr.prototype.loadTile=function(_e,Me,Ne){this.getWorkerSource(_e,Me.type,Me.source).loadTile(Me,Ne)},yr.prototype.loadDEMTile=function(_e,Me,Ne){this.getDEMWorkerSource(_e,Me.source).loadTile(Me,Ne)},yr.prototype.reloadTile=function(_e,Me,Ne){this.getWorkerSource(_e,Me.type,Me.source).reloadTile(Me,Ne)},yr.prototype.abortTile=function(_e,Me,Ne){this.getWorkerSource(_e,Me.type,Me.source).abortTile(Me,Ne)},yr.prototype.removeTile=function(_e,Me,Ne){this.getWorkerSource(_e,Me.type,Me.source).removeTile(Me,Ne)},yr.prototype.removeDEMTile=function(_e,Me){this.getDEMWorkerSource(_e,Me.source).removeTile(Me)},yr.prototype.removeSource=function(_e,Me,Ne){if(!(!this.workerSources[_e]||!this.workerSources[_e][Me.type]||!this.workerSources[_e][Me.type][Me.source])){var We=this.workerSources[_e][Me.type][Me.source];delete this.workerSources[_e][Me.type][Me.source],We.removeSource!==void 0?We.removeSource(Me,Ne):Ne()}},yr.prototype.loadWorkerSource=function(_e,Me,Ne){try{this.self.importScripts(Me.url),Ne()}catch(We){Ne(We.toString())}},yr.prototype.syncRTLPluginState=function(_e,Me,Ne){try{e.plugin.setState(Me);var We=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&We!=null){this.self.importScripts(We);var Qe=e.plugin.isParsed(),rt=Qe?void 0:new Error("RTL Text Plugin failed to import scripts from "+We);Ne(rt,Qe)}}catch($e){Ne($e.toString())}},yr.prototype.getAvailableImages=function(_e){var Me=this.availableImages[_e];return Me||(Me=[]),Me},yr.prototype.getLayerIndex=function(_e){var Me=this.layerIndexes[_e];return Me||(Me=this.layerIndexes[_e]=new t),Me},yr.prototype.getWorkerSource=function(_e,Me,Ne){var We=this;if(this.workerSources[_e]||(this.workerSources[_e]={}),this.workerSources[_e][Me]||(this.workerSources[_e][Me]={}),!this.workerSources[_e][Me][Ne]){var Qe={send:function(rt,$e,ht){We.actor.send(rt,$e,ht,_e)}};this.workerSources[_e][Me][Ne]=new this.workerSourceTypes[Me](Qe,this.getLayerIndex(_e),this.getAvailableImages(_e))}return this.workerSources[_e][Me][Ne]},yr.prototype.getDEMWorkerSource=function(_e,Me){return this.demWorkerSources[_e]||(this.demWorkerSources[_e]={}),this.demWorkerSources[_e][Me]||(this.demWorkerSources[_e][Me]=new m),this.demWorkerSources[_e][Me]},yr.prototype.enforceCacheSizeLimit=function(_e,Me){e.enforceCacheSizeLimit(Me)},typeof WorkerGlobalScope!="undefined"&&typeof e.window!="undefined"&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new yr(e.window)),yr}),T(["./shared"],function(e){var a=e.createCommonjsModule(function(ce){ce.exports?ce.exports=H:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=H,window.mapboxgl.notSupportedReason=ve);function H(Or){return!ve(Or)}function ve(Or){if(!K())return"not a browser";if(!de())return"insufficent Array support";if(!Se())return"insufficient Function support";if(!Ce())return"insufficient Object support";if(!Xe())return"insufficient JSON support";if(!lt())return"insufficient worker support";if(!wt())return"insufficient Uint8ClampedArray support";if(!Ht())return"insufficient ArrayBuffer support";if(!nr())return"insufficient Canvas/getImageData support";if(!Ar(Or&&Or.failIfMajorPerformanceCaveat))return"insufficient WebGL support"}function K(){return typeof window!="undefined"&&typeof document!="undefined"}function de(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function Se(){return Function.prototype&&Function.prototype.bind}function Ce(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function Xe(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function lt(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var Or=new Blob([""],{type:"text/javascript"}),Xr=URL.createObjectURL(Or),sn,Sn;try{Sn=new Worker(Xr),sn=!0}catch{sn=!1}return Sn&&Sn.terminate(),URL.revokeObjectURL(Xr),sn}function wt(){return"Uint8ClampedArray"in window}function Ht(){return ArrayBuffer.isView}function nr(){var Or=document.createElement("canvas");Or.width=Or.height=1;var Xr=Or.getContext("2d");if(!Xr)return!1;var sn=Xr.getImageData(0,0,1,1);return sn&&sn.width===Or.width}var sr={};function Ar(Or){return sr[Or]===void 0&&(sr[Or]=Ur(Or)),sr[Or]}H.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};function Nr(Or){var Xr=document.createElement("canvas"),sn=Object.create(H.webGLContextAttributes);return sn.failIfMajorPerformanceCaveat=Or,Xr.probablySupportsContext?Xr.probablySupportsContext("webgl",sn)||Xr.probablySupportsContext("experimental-webgl",sn):Xr.supportsContext?Xr.supportsContext("webgl",sn)||Xr.supportsContext("experimental-webgl",sn):Xr.getContext("webgl",sn)||Xr.getContext("experimental-webgl",sn)}function Ur(Or){var Xr=Nr(Or);if(!Xr)return!1;var sn=Xr.createShader(Xr.VERTEX_SHADER);return!sn||Xr.isContextLost()?!1:(Xr.shaderSource(sn,"void main() {}"),Xr.compileShader(sn),Xr.getShaderParameter(sn,Xr.COMPILE_STATUS)===!0)}}),n={};n.create=function(ce,H,ve){var K=e.window.document.createElement(ce);return H!==void 0&&(K.className=H),ve&&ve.appendChild(K),K},n.createNS=function(ce,H){var ve=e.window.document.createElementNS(ce,H);return ve};var r=e.window.document.documentElement.style;function t(ce){if(!r)return ce[0];for(var H=0;H<ce.length;H++)if(ce[H]in r)return ce[H];return ce[0]}var f=t(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),o;n.disableDrag=function(){r&&f&&(o=r[f],r[f]="none")},n.enableDrag=function(){r&&f&&(r[f]=o)};var i=t(["transform","WebkitTransform"]);n.setTransform=function(ce,H){ce.style[i]=H};var g=!1;try{var p=Object.defineProperty({},"passive",{get:function(){g=!0}});e.window.addEventListener("test",p,p),e.window.removeEventListener("test",p,p)}catch{g=!1}n.addEventListener=function(ce,H,ve,K){K===void 0&&(K={}),"passive"in K&&g?ce.addEventListener(H,ve,K):ce.addEventListener(H,ve,K.capture)},n.removeEventListener=function(ce,H,ve,K){K===void 0&&(K={}),"passive"in K&&g?ce.removeEventListener(H,ve,K):ce.removeEventListener(H,ve,K.capture)};var y=function(ce){ce.preventDefault(),ce.stopPropagation(),e.window.removeEventListener("click",y,!0)};n.suppressClick=function(){e.window.addEventListener("click",y,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",y,!0)},0)},n.mousePos=function(ce,H){var ve=ce.getBoundingClientRect();return new e.Point(H.clientX-ve.left-ce.clientLeft,H.clientY-ve.top-ce.clientTop)},n.touchPos=function(ce,H){for(var ve=ce.getBoundingClientRect(),K=[],de=0;de<H.length;de++)K.push(new e.Point(H[de].clientX-ve.left-ce.clientLeft,H[de].clientY-ve.top-ce.clientTop));return K},n.mouseButton=function(ce){return typeof e.window.InstallTrigger!="undefined"&&ce.button===2&&ce.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:ce.button},n.remove=function(ce){ce.parentNode&&ce.parentNode.removeChild(ce)};function h(ce,H,ve){var K,de,Se,Ce=e.browser.devicePixelRatio>1?"@2x":"",Xe=e.getJSON(H.transformRequest(H.normalizeSpriteURL(ce,Ce,".json"),e.ResourceType.SpriteJSON),function(Ht,nr){Xe=null,Se||(Se=Ht,K=nr,wt())}),lt=e.getImage(H.transformRequest(H.normalizeSpriteURL(ce,Ce,".png"),e.ResourceType.SpriteImage),function(Ht,nr){lt=null,Se||(Se=Ht,de=nr,wt())});function wt(){if(Se)ve(Se);else if(K&&de){var Ht=e.browser.getImageData(de),nr={};for(var sr in K){var Ar=K[sr],Nr=Ar.width,Ur=Ar.height,Or=Ar.x,Xr=Ar.y,sn=Ar.sdf,Sn=Ar.pixelRatio,Fn=Ar.stretchX,Xn=Ar.stretchY,Qn=Ar.content,jn=new e.RGBAImage({width:Nr,height:Ur});e.RGBAImage.copy(Ht,jn,{x:Or,y:Xr},{x:0,y:0},{width:Nr,height:Ur}),nr[sr]={data:jn,pixelRatio:Sn,sdf:sn,stretchX:Fn,stretchY:Xn,content:Qn}}ve(null,nr)}}return{cancel:function(){Xe&&(Xe.cancel(),Xe=null),lt&&(lt.cancel(),lt=null)}}}function m(ce){var H=ce.userImage;if(H&&H.render){var ve=H.render();if(ve)return ce.data.replace(new Uint8Array(H.data.buffer)),!0}return!1}var u=1,_=function(ce){function H(){ce.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.isLoaded=function(){return this.loaded},H.prototype.setLoaded=function(K){if(this.loaded!==K&&(this.loaded=K,K)){for(var de=0,Se=this.requestors;de<Se.length;de+=1){var Ce=Se[de],Xe=Ce.ids,lt=Ce.callback;this._notify(Xe,lt)}this.requestors=[]}},H.prototype.getImage=function(K){return this.images[K]},H.prototype.addImage=function(K,de){this._validate(K,de)&&(this.images[K]=de)},H.prototype._validate=function(K,de){var Se=!0;return this._validateStretch(de.stretchX,de.data&&de.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+K+'" has invalid "stretchX" value'))),Se=!1),this._validateStretch(de.stretchY,de.data&&de.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+K+'" has invalid "stretchY" value'))),Se=!1),this._validateContent(de.content,de)||(this.fire(new e.ErrorEvent(new Error('Image "'+K+'" has invalid "content" value'))),Se=!1),Se},H.prototype._validateStretch=function(K,de){if(!K)return!0;for(var Se=0,Ce=0,Xe=K;Ce<Xe.length;Ce+=1){var lt=Xe[Ce];if(lt[0]<Se||lt[1]<lt[0]||de<lt[1])return!1;Se=lt[1]}return!0},H.prototype._validateContent=function(K,de){return K?!(K.length!==4||K[0]<0||de.data.width<K[0]||K[1]<0||de.data.height<K[1]||K[2]<0||de.data.width<K[2]||K[3]<0||de.data.height<K[3]||K[2]<K[0]||K[3]<K[1]):!0},H.prototype.updateImage=function(K,de){var Se=this.images[K];de.version=Se.version+1,this.images[K]=de,this.updatedImages[K]=!0},H.prototype.removeImage=function(K){var de=this.images[K];delete this.images[K],delete this.patterns[K],de.userImage&&de.userImage.onRemove&&de.userImage.onRemove()},H.prototype.listImages=function(){return Object.keys(this.images)},H.prototype.getImages=function(K,de){var Se=!0;if(!this.isLoaded())for(var Ce=0,Xe=K;Ce<Xe.length;Ce+=1){var lt=Xe[Ce];this.images[lt]||(Se=!1)}this.isLoaded()||Se?this._notify(K,de):this.requestors.push({ids:K,callback:de})},H.prototype._notify=function(K,de){for(var Se={},Ce=0,Xe=K;Ce<Xe.length;Ce+=1){var lt=Xe[Ce];this.images[lt]||this.fire(new e.Event("styleimagemissing",{id:lt}));var wt=this.images[lt];wt?Se[lt]={data:wt.data.clone(),pixelRatio:wt.pixelRatio,sdf:wt.sdf,version:wt.version,stretchX:wt.stretchX,stretchY:wt.stretchY,content:wt.content,hasRenderCallback:Boolean(wt.userImage&&wt.userImage.render)}:e.warnOnce('Image "'+lt+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}de(null,Se)},H.prototype.getPixelSize=function(){var K=this.atlasImage,de=K.width,Se=K.height;return{width:de,height:Se}},H.prototype.getPattern=function(K){var de=this.patterns[K],Se=this.getImage(K);if(!Se)return null;if(de&&de.position.version===Se.version)return de.position;if(de)de.position.version=Se.version;else{var Ce=Se.data.width+u*2,Xe=Se.data.height+u*2,lt={w:Ce,h:Xe,x:0,y:0},wt=new e.ImagePosition(lt,Se);this.patterns[K]={bin:lt,position:wt}}return this._updatePatternAtlas(),this.patterns[K].position},H.prototype.bind=function(K){var de=K.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(K,this.atlasImage,de.RGBA),this.atlasTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE)},H.prototype._updatePatternAtlas=function(){var K=[];for(var de in this.patterns)K.push(this.patterns[de].bin);var Se=e.potpack(K),Ce=Se.w,Xe=Se.h,lt=this.atlasImage;lt.resize({width:Ce||1,height:Xe||1});for(var wt in this.patterns){var Ht=this.patterns[wt],nr=Ht.bin,sr=nr.x+u,Ar=nr.y+u,Nr=this.images[wt].data,Ur=Nr.width,Or=Nr.height;e.RGBAImage.copy(Nr,lt,{x:0,y:0},{x:sr,y:Ar},{width:Ur,height:Or}),e.RGBAImage.copy(Nr,lt,{x:0,y:Or-1},{x:sr,y:Ar-1},{width:Ur,height:1}),e.RGBAImage.copy(Nr,lt,{x:0,y:0},{x:sr,y:Ar+Or},{width:Ur,height:1}),e.RGBAImage.copy(Nr,lt,{x:Ur-1,y:0},{x:sr-1,y:Ar},{width:1,height:Or}),e.RGBAImage.copy(Nr,lt,{x:0,y:0},{x:sr+Ur,y:Ar},{width:1,height:Or})}this.dirty=!0},H.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},H.prototype.dispatchRenderCallbacks=function(K){for(var de=0,Se=K;de<Se.length;de+=1){var Ce=Se[de];if(!this.callbackDispatchedThisFrame[Ce]){this.callbackDispatchedThisFrame[Ce]=!0;var Xe=this.images[Ce],lt=m(Xe);lt&&this.updateImage(Ce,Xe)}}},H}(e.Evented);function s(ce,H,ve,K,de){var Se=H*256,Ce=Se+255,Xe=K.transformRequest(K.normalizeGlyphsURL(ve).replace("{fontstack}",ce).replace("{range}",Se+"-"+Ce),e.ResourceType.Glyphs);e.getArrayBuffer(Xe,function(lt,wt){if(lt)de(lt);else if(wt){for(var Ht={},nr=0,sr=e.parseGlyphPBF(wt);nr<sr.length;nr+=1){var Ar=sr[nr];Ht[Ar.id]=Ar}de(null,Ht)}})}var A=b,x=b,v=1e20;function b(ce,H,ve,K,de,Se){this.fontSize=ce||24,this.buffer=H===void 0?3:H,this.cutoff=K||.25,this.fontFamily=de||"sans-serif",this.fontWeight=Se||"normal",this.radius=ve||8;var Ce=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Ce,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Ce*Ce),this.gridInner=new Float64Array(Ce*Ce),this.f=new Float64Array(Ce),this.d=new Float64Array(Ce),this.z=new Float64Array(Ce+1),this.v=new Int16Array(Ce),this.middle=Math.round(Ce/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}b.prototype.draw=function(ce){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(ce,this.buffer,this.middle);for(var H=this.ctx.getImageData(0,0,this.size,this.size),ve=new Uint8ClampedArray(this.size*this.size),K=0;K<this.size*this.size;K++){var de=H.data[K*4+3]/255;this.gridOuter[K]=de===1?0:de===0?v:Math.pow(Math.max(0,.5-de),2),this.gridInner[K]=de===1?v:de===0?0:Math.pow(Math.max(0,de-.5),2)}for(l(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),l(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),K=0;K<this.size*this.size;K++){var Se=this.gridOuter[K]-this.gridInner[K];ve[K]=Math.max(0,Math.min(255,Math.round(255-255*(Se/this.radius+this.cutoff))))}return ve};function l(ce,H,ve,K,de,Se,Ce){for(var Xe=0;Xe<H;Xe++){for(var lt=0;lt<ve;lt++)K[lt]=ce[lt*H+Xe];for(L(K,de,Se,Ce,ve),lt=0;lt<ve;lt++)ce[lt*H+Xe]=de[lt]}for(lt=0;lt<ve;lt++){for(Xe=0;Xe<H;Xe++)K[Xe]=ce[lt*H+Xe];for(L(K,de,Se,Ce,H),Xe=0;Xe<H;Xe++)ce[lt*H+Xe]=Math.sqrt(de[Xe])}}function L(ce,H,ve,K,de){ve[0]=0,K[0]=-v,K[1]=+v;for(var Se=1,Ce=0;Se<de;Se++){for(var Xe=(ce[Se]+Se*Se-(ce[ve[Ce]]+ve[Ce]*ve[Ce]))/(2*Se-2*ve[Ce]);Xe<=K[Ce];)Ce--,Xe=(ce[Se]+Se*Se-(ce[ve[Ce]]+ve[Ce]*ve[Ce]))/(2*Se-2*ve[Ce]);Ce++,ve[Ce]=Se,K[Ce]=Xe,K[Ce+1]=+v}for(Se=0,Ce=0;Se<de;Se++){for(;K[Ce+1]<Se;)Ce++;H[Se]=(Se-ve[Ce])*(Se-ve[Ce])+ce[ve[Ce]]}}A.default=x;var S=function(H,ve){this.requestManager=H,this.localIdeographFontFamily=ve,this.entries={}};S.prototype.setURL=function(H){this.url=H},S.prototype.getGlyphs=function(H,ve){var K=this,de=[];for(var Se in H)for(var Ce=0,Xe=H[Se];Ce<Xe.length;Ce+=1){var lt=Xe[Ce];de.push({stack:Se,id:lt})}e.asyncAll(de,function(wt,Ht){var nr=wt.stack,sr=wt.id,Ar=K.entries[nr];Ar||(Ar=K.entries[nr]={glyphs:{},requests:{},ranges:{}});var Nr=Ar.glyphs[sr];if(Nr!==void 0){Ht(null,{stack:nr,id:sr,glyph:Nr});return}if(Nr=K._tinySDF(Ar,nr,sr),Nr){Ar.glyphs[sr]=Nr,Ht(null,{stack:nr,id:sr,glyph:Nr});return}var Ur=Math.floor(sr/256);if(Ur*256>65535){Ht(new Error("glyphs > 65535 not supported"));return}if(Ar.ranges[Ur]){Ht(null,{stack:nr,id:sr,glyph:Nr});return}var Or=Ar.requests[Ur];Or||(Or=Ar.requests[Ur]=[],S.loadGlyphRange(nr,Ur,K.url,K.requestManager,function(Xr,sn){if(sn){for(var Sn in sn)K._doesCharSupportLocalGlyph(+Sn)||(Ar.glyphs[+Sn]=sn[+Sn]);Ar.ranges[Ur]=!0}for(var Fn=0,Xn=Or;Fn<Xn.length;Fn+=1){var Qn=Xn[Fn];Qn(Xr,sn)}delete Ar.requests[Ur]})),Or.push(function(Xr,sn){Xr?Ht(Xr):sn&&Ht(null,{stack:nr,id:sr,glyph:sn[sr]||null})})},function(wt,Ht){if(wt)ve(wt);else if(Ht){for(var nr={},sr=0,Ar=Ht;sr<Ar.length;sr+=1){var Nr=Ar[sr],Ur=Nr.stack,Or=Nr.id,Xr=Nr.glyph;(nr[Ur]||(nr[Ur]={}))[Or]=Xr&&{id:Xr.id,bitmap:Xr.bitmap.clone(),metrics:Xr.metrics}}ve(null,nr)}})},S.prototype._doesCharSupportLocalGlyph=function(H){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](H)||e.isChar["Hangul Syllables"](H)||e.isChar.Hiragana(H)||e.isChar.Katakana(H))},S.prototype._tinySDF=function(H,ve,K){var de=this.localIdeographFontFamily;if(!!de&&!!this._doesCharSupportLocalGlyph(K)){var Se=H.tinySDF;if(!Se){var Ce="400";/bold/i.test(ve)?Ce="900":/medium/i.test(ve)?Ce="500":/light/i.test(ve)&&(Ce="200"),Se=H.tinySDF=new S.TinySDF(24,3,8,.25,de,Ce)}return{id:K,bitmap:new e.AlphaImage({width:30,height:30},Se.draw(String.fromCharCode(K))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},S.loadGlyphRange=s,S.TinySDF=A;var k=function(){this.specification=e.styleSpec.light.position};k.prototype.possiblyEvaluate=function(H,ve){return e.sphericalToCartesian(H.expression.evaluate(ve))},k.prototype.interpolate=function(H,ve,K){return{x:e.number(H.x,ve.x,K),y:e.number(H.y,ve.y,K),z:e.number(H.z,ve.z,K)}};var P=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new k,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),z="-transition",I=function(ce){function H(ve){ce.call(this),this._transitionable=new e.Transitionable(P),this.setLight(ve),this._transitioning=this._transitionable.untransitioned()}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getLight=function(){return this._transitionable.serialize()},H.prototype.setLight=function(K,de){if(de===void 0&&(de={}),!this._validate(e.validateLight,K,de))for(var Se in K){var Ce=K[Se];e.endsWith(Se,z)?this._transitionable.setTransition(Se.slice(0,-z.length),Ce):this._transitionable.setValue(Se,Ce)}},H.prototype.updateTransitions=function(K){this._transitioning=this._transitionable.transitioned(K,this._transitioning)},H.prototype.hasTransition=function(){return this._transitioning.hasTransition()},H.prototype.recalculate=function(K){this.properties=this._transitioning.possiblyEvaluate(K)},H.prototype._validate=function(K,de,Se){return Se&&Se.validate===!1?!1:e.emitValidationErrors(this,K.call(e.validateStyle,e.extend({value:de,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},H}(e.Evented),D=function(H,ve){this.width=H,this.height=ve,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};D.prototype.getDash=function(H,ve){var K=H.join(",")+String(ve);return this.dashEntry[K]||(this.dashEntry[K]=this.addDash(H,ve)),this.dashEntry[K]},D.prototype.getDashRanges=function(H,ve,K){var de=H.length%2===1,Se=[],Ce=de?-H[H.length-1]*K:0,Xe=H[0]*K,lt=!0;Se.push({left:Ce,right:Xe,isDash:lt,zeroLength:H[0]===0});for(var wt=H[0],Ht=1;Ht<H.length;Ht++){lt=!lt;var nr=H[Ht];Ce=wt*K,wt+=nr,Xe=wt*K,Se.push({left:Ce,right:Xe,isDash:lt,zeroLength:nr===0})}return Se},D.prototype.addRoundDash=function(H,ve,K){for(var de=ve/2,Se=-K;Se<=K;Se++)for(var Ce=this.nextRow+K+Se,Xe=this.width*Ce,lt=0,wt=H[lt],Ht=0;Ht<this.width;Ht++){Ht/wt.right>1&&(wt=H[++lt]);var nr=Math.abs(Ht-wt.left),sr=Math.abs(Ht-wt.right),Ar=Math.min(nr,sr),Nr=void 0,Ur=Se/K*(de+1);if(wt.isDash){var Or=de-Math.abs(Ur);Nr=Math.sqrt(Ar*Ar+Or*Or)}else Nr=de-Math.sqrt(Ar*Ar+Ur*Ur);this.data[Xe+Ht]=Math.max(0,Math.min(255,Nr+128))}},D.prototype.addRegularDash=function(H){for(var ve=H.length-1;ve>=0;--ve){var K=H[ve],de=H[ve+1];K.zeroLength?H.splice(ve,1):de&&de.isDash===K.isDash&&(de.left=K.left,H.splice(ve,1))}var Se=H[0],Ce=H[H.length-1];Se.isDash===Ce.isDash&&(Se.left=Ce.left-this.width,Ce.right=Se.right+this.width);for(var Xe=this.width*this.nextRow,lt=0,wt=H[lt],Ht=0;Ht<this.width;Ht++){Ht/wt.right>1&&(wt=H[++lt]);var nr=Math.abs(Ht-wt.left),sr=Math.abs(Ht-wt.right),Ar=Math.min(nr,sr),Nr=wt.isDash?Ar:-Ar;this.data[Xe+Ht]=Math.max(0,Math.min(255,Nr+128))}},D.prototype.addDash=function(H,ve){var K=ve?7:0,de=2*K+1;if(this.nextRow+de>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var Se=0,Ce=0;Ce<H.length;Ce++)Se+=H[Ce];if(Se!==0){var Xe=this.width/Se,lt=this.getDashRanges(H,this.width,Xe);ve?this.addRoundDash(lt,Xe,K):this.addRegularDash(lt)}var wt={y:(this.nextRow+K+.5)/this.height,height:2*K/this.height,width:Se};return this.nextRow+=de,this.dirty=!0,wt},D.prototype.bind=function(H){var ve=H.gl;this.texture?(ve.bindTexture(ve.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,ve.texSubImage2D(ve.TEXTURE_2D,0,0,0,this.width,this.height,ve.ALPHA,ve.UNSIGNED_BYTE,this.data))):(this.texture=ve.createTexture(),ve.bindTexture(ve.TEXTURE_2D,this.texture),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_S,ve.REPEAT),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_T,ve.REPEAT),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MAG_FILTER,ve.LINEAR),ve.texImage2D(ve.TEXTURE_2D,0,ve.ALPHA,this.width,this.height,0,ve.ALPHA,ve.UNSIGNED_BYTE,this.data))};var R=function ce(H,ve){this.workerPool=H,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var K=this.workerPool.acquire(this.id),de=0;de<K.length;de++){var Se=K[de],Ce=new ce.Actor(Se,ve,this.id);Ce.name="Worker "+de,this.actors.push(Ce)}};R.prototype.broadcast=function(H,ve,K){K=K||function(){},e.asyncAll(this.actors,function(de,Se){de.send(H,ve,Se)},K)},R.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},R.prototype.remove=function(){this.actors.forEach(function(H){H.remove()}),this.actors=[],this.workerPool.release(this.id)},R.Actor=e.Actor;function B(ce,H,ve){var K=function(de,Se){if(de)return ve(de);if(Se){var Ce=e.pick(e.extend(Se,ce),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);Se.vector_layers&&(Ce.vectorLayers=Se.vector_layers,Ce.vectorLayerIds=Ce.vectorLayers.map(function(Xe){return Xe.id})),Ce.tiles=H.canonicalizeTileset(Ce,ce.url),ve(null,Ce)}};return ce.url?e.getJSON(H.transformRequest(H.normalizeSourceURL(ce.url),e.ResourceType.Source),K):e.browser.frame(function(){return K(null,ce)})}var F=function(H,ve,K){this.bounds=e.LngLatBounds.convert(this.validateBounds(H)),this.minzoom=ve||0,this.maxzoom=K||24};F.prototype.validateBounds=function(H){return!Array.isArray(H)||H.length!==4?[-180,-90,180,90]:[Math.max(-180,H[0]),Math.max(-90,H[1]),Math.min(180,H[2]),Math.min(90,H[3])]},F.prototype.contains=function(H){var ve=Math.pow(2,H.z),K={minX:Math.floor(e.mercatorXfromLng(this.bounds.getWest())*ve),minY:Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*ve),maxX:Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*ve),maxY:Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*ve)},de=H.x>=K.minX&&H.x<K.maxX&&H.y>=K.minY&&H.y<K.maxY;return de};var V=function(ce){function H(ve,K,de,Se){if(ce.call(this),this.id=ve,this.dispatcher=de,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(K,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},K),this._collectResourceTiming=K.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(Se)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.load=function(){var K=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=B(this._options,this.map._requestManager,function(de,Se){K._tileJSONRequest=null,K._loaded=!0,de?K.fire(new e.ErrorEvent(de)):Se&&(e.extend(K,Se),Se.bounds&&(K.tileBounds=new F(Se.bounds,K.minzoom,K.maxzoom)),e.postTurnstileEvent(Se.tiles,K.map._requestManager._customAccessToken),e.postMapLoadEvent(Se.tiles,K.map._getMapId(),K.map._requestManager._skuToken,K.map._requestManager._customAccessToken),K.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),K.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},H.prototype.loaded=function(){return this._loaded},H.prototype.hasTile=function(K){return!this.tileBounds||this.tileBounds.contains(K.canonical)},H.prototype.onAdd=function(K){this.map=K,this.load()},H.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},H.prototype.serialize=function(){return e.extend({},this._options)},H.prototype.loadTile=function(K,de){var Se=this.map._requestManager.normalizeTileURL(K.tileID.canonical.url(this.tiles,this.scheme)),Ce={request:this.map._requestManager.transformRequest(Se,e.ResourceType.Tile),uid:K.uid,tileID:K.tileID,zoom:K.tileID.overscaledZ,tileSize:this.tileSize*K.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};Ce.request.collectResourceTiming=this._collectResourceTiming,!K.actor||K.state==="expired"?(K.actor=this.dispatcher.getActor(),K.request=K.actor.send("loadTile",Ce,Xe.bind(this))):K.state==="loading"?K.reloadCallback=de:K.request=K.actor.send("reloadTile",Ce,Xe.bind(this));function Xe(lt,wt){if(delete K.request,K.aborted)return de(null);if(lt&&lt.status!==404)return de(lt);wt&&wt.resourceTiming&&(K.resourceTiming=wt.resourceTiming),this.map._refreshExpiredTiles&&wt&&K.setExpiryData(wt),K.loadVectorData(wt,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),de(null),K.reloadCallback&&(this.loadTile(K,K.reloadCallback),K.reloadCallback=null)}},H.prototype.abortTile=function(K){K.request&&(K.request.cancel(),delete K.request),K.actor&&K.actor.send("abortTile",{uid:K.uid,type:this.type,source:this.id},void 0)},H.prototype.unloadTile=function(K){K.unloadVectorData(),K.actor&&K.actor.send("removeTile",{uid:K.uid,type:this.type,source:this.id},void 0)},H.prototype.hasTransition=function(){return!1},H}(e.Evented),G=function(ce){function H(ve,K,de,Se){ce.call(this),this.id=ve,this.dispatcher=de,this.setEventedParent(Se),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},K),e.extend(this,e.pick(K,["url","scheme","tileSize"]))}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.load=function(){var K=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=B(this._options,this.map._requestManager,function(de,Se){K._tileJSONRequest=null,K._loaded=!0,de?K.fire(new e.ErrorEvent(de)):Se&&(e.extend(K,Se),Se.bounds&&(K.tileBounds=new F(Se.bounds,K.minzoom,K.maxzoom)),e.postTurnstileEvent(Se.tiles),e.postMapLoadEvent(Se.tiles,K.map._getMapId(),K.map._requestManager._skuToken),K.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),K.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},H.prototype.loaded=function(){return this._loaded},H.prototype.onAdd=function(K){this.map=K,this.load()},H.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},H.prototype.serialize=function(){return e.extend({},this._options)},H.prototype.hasTile=function(K){return!this.tileBounds||this.tileBounds.contains(K.canonical)},H.prototype.loadTile=function(K,de){var Se=this,Ce=this.map._requestManager.normalizeTileURL(K.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);K.request=e.getImage(this.map._requestManager.transformRequest(Ce,e.ResourceType.Tile),function(Xe,lt){if(delete K.request,K.aborted)K.state="unloaded",de(null);else if(Xe)K.state="errored",de(Xe);else if(lt){Se.map._refreshExpiredTiles&&K.setExpiryData(lt),delete lt.cacheControl,delete lt.expires;var wt=Se.map.painter.context,Ht=wt.gl;K.texture=Se.map.painter.getTileTexture(lt.width),K.texture?K.texture.update(lt,{useMipmap:!0}):(K.texture=new e.Texture(wt,lt,Ht.RGBA,{useMipmap:!0}),K.texture.bind(Ht.LINEAR,Ht.CLAMP_TO_EDGE,Ht.LINEAR_MIPMAP_NEAREST),wt.extTextureFilterAnisotropic&&Ht.texParameterf(Ht.TEXTURE_2D,wt.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,wt.extTextureFilterAnisotropicMax)),K.state="loaded",e.cacheEntryPossiblyAdded(Se.dispatcher),de(null)}})},H.prototype.abortTile=function(K,de){K.request&&(K.request.cancel(),delete K.request),de()},H.prototype.unloadTile=function(K,de){K.texture&&this.map.painter.saveTileTexture(K.texture),de()},H.prototype.hasTransition=function(){return!1},H}(e.Evented),J=function(ce){function H(ve,K,de,Se){ce.call(this,ve,K,de,Se),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},K),this.encoding=K.encoding||"mapbox"}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},H.prototype.loadTile=function(K,de){var Se=this.map._requestManager.normalizeTileURL(K.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);K.request=e.getImage(this.map._requestManager.transformRequest(Se,e.ResourceType.Tile),Ce.bind(this)),K.neighboringTiles=this._getNeighboringTiles(K.tileID);function Ce(lt,wt){if(delete K.request,K.aborted)K.state="unloaded",de(null);else if(lt)K.state="errored",de(lt);else if(wt){this.map._refreshExpiredTiles&&K.setExpiryData(wt),delete wt.cacheControl,delete wt.expires;var Ht=e.window.ImageBitmap&&wt instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported(),nr=Ht?wt:e.browser.getImageData(wt,1),sr={uid:K.uid,coord:K.tileID,source:this.id,rawImageData:nr,encoding:this.encoding};(!K.actor||K.state==="expired")&&(K.actor=this.dispatcher.getActor(),K.actor.send("loadDEMTile",sr,Xe.bind(this)))}}function Xe(lt,wt){lt&&(K.state="errored",de(lt)),wt&&(K.dem=wt,K.needsHillshadePrepare=!0,K.state="loaded",de(null))}},H.prototype._getNeighboringTiles=function(K){var de=K.canonical,Se=Math.pow(2,de.z),Ce=(de.x-1+Se)%Se,Xe=de.x===0?K.wrap-1:K.wrap,lt=(de.x+1+Se)%Se,wt=de.x+1===Se?K.wrap+1:K.wrap,Ht={};return Ht[new e.OverscaledTileID(K.overscaledZ,Xe,de.z,Ce,de.y).key]={backfilled:!1},Ht[new e.OverscaledTileID(K.overscaledZ,wt,de.z,lt,de.y).key]={backfilled:!1},de.y>0&&(Ht[new e.OverscaledTileID(K.overscaledZ,Xe,de.z,Ce,de.y-1).key]={backfilled:!1},Ht[new e.OverscaledTileID(K.overscaledZ,K.wrap,de.z,de.x,de.y-1).key]={backfilled:!1},Ht[new e.OverscaledTileID(K.overscaledZ,wt,de.z,lt,de.y-1).key]={backfilled:!1}),de.y+1<Se&&(Ht[new e.OverscaledTileID(K.overscaledZ,Xe,de.z,Ce,de.y+1).key]={backfilled:!1},Ht[new e.OverscaledTileID(K.overscaledZ,K.wrap,de.z,de.x,de.y+1).key]={backfilled:!1},Ht[new e.OverscaledTileID(K.overscaledZ,wt,de.z,lt,de.y+1).key]={backfilled:!1}),Ht},H.prototype.unloadTile=function(K){K.demTexture&&this.map.painter.saveTileTexture(K.demTexture),K.fbo&&(K.fbo.destroy(),delete K.fbo),K.dem&&delete K.dem,delete K.neighboringTiles,K.state="unloaded",K.actor&&K.actor.send("removeDEMTile",{uid:K.uid,source:this.id})},H}(G),j=function(ce){function H(ve,K,de,Se){ce.call(this),this.id=ve,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=de.getActor(),this.setEventedParent(Se),this._data=K.data,this._options=e.extend({},K),this._collectResourceTiming=K.collectResourceTiming,this._resourceTiming=[],K.maxzoom!==void 0&&(this.maxzoom=K.maxzoom),K.type&&(this.type=K.type),K.attribution&&(this.attribution=K.attribution),this.promoteId=K.promoteId;var Ce=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:K.cluster||!1,geojsonVtOptions:{buffer:(K.buffer!==void 0?K.buffer:128)*Ce,tolerance:(K.tolerance!==void 0?K.tolerance:.375)*Ce,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:K.lineMetrics||!1,generateId:K.generateId||!1},superclusterOptions:{maxZoom:K.clusterMaxZoom!==void 0?Math.min(K.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(K.clusterRadius||50)*Ce,log:!1,generateId:K.generateId||!1},clusterProperties:K.clusterProperties},K.workerOptions)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.load=function(){var K=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(de){if(de){K.fire(new e.ErrorEvent(de));return}var Se={dataType:"source",sourceDataType:"metadata"};K._collectResourceTiming&&K._resourceTiming&&K._resourceTiming.length>0&&(Se.resourceTiming=K._resourceTiming,K._resourceTiming=[]),K.fire(new e.Event("data",Se))})},H.prototype.onAdd=function(K){this.map=K,this.load()},H.prototype.setData=function(K){var de=this;return this._data=K,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(Se){if(Se){de.fire(new e.ErrorEvent(Se));return}var Ce={dataType:"source",sourceDataType:"content"};de._collectResourceTiming&&de._resourceTiming&&de._resourceTiming.length>0&&(Ce.resourceTiming=de._resourceTiming,de._resourceTiming=[]),de.fire(new e.Event("data",Ce))}),this},H.prototype.getClusterExpansionZoom=function(K,de){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:K,source:this.id},de),this},H.prototype.getClusterChildren=function(K,de){return this.actor.send("geojson.getClusterChildren",{clusterId:K,source:this.id},de),this},H.prototype.getClusterLeaves=function(K,de,Se,Ce){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:K,limit:de,offset:Se},Ce),this},H.prototype._updateWorkerData=function(K){var de=this;this._loaded=!1;var Se=e.extend({},this.workerOptions),Ce=this._data;typeof Ce=="string"?(Se.request=this.map._requestManager.transformRequest(e.browser.resolveURL(Ce),e.ResourceType.Source),Se.request.collectResourceTiming=this._collectResourceTiming):Se.data=JSON.stringify(Ce),this.actor.send(this.type+".loadData",Se,function(Xe,lt){de._removed||lt&&lt.abandoned||(de._loaded=!0,lt&&lt.resourceTiming&&lt.resourceTiming[de.id]&&(de._resourceTiming=lt.resourceTiming[de.id].slice(0)),de.actor.send(de.type+".coalesce",{source:Se.source},null),K(Xe))})},H.prototype.loaded=function(){return this._loaded},H.prototype.loadTile=function(K,de){var Se=this,Ce=K.actor?"reloadTile":"loadTile";K.actor=this.actor;var Xe={type:this.type,uid:K.uid,tileID:K.tileID,zoom:K.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};K.request=this.actor.send(Ce,Xe,function(lt,wt){return delete K.request,K.unloadVectorData(),K.aborted?de(null):lt?de(lt):(K.loadVectorData(wt,Se.map.painter,Ce==="reloadTile"),de(null))})},H.prototype.abortTile=function(K){K.request&&(K.request.cancel(),delete K.request),K.aborted=!0},H.prototype.unloadTile=function(K){K.unloadVectorData(),this.actor.send("removeTile",{uid:K.uid,type:this.type,source:this.id})},H.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},H.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},H.prototype.hasTransition=function(){return!1},H}(e.Evented),Y=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),X=function(ce){function H(ve,K,de,Se){ce.call(this),this.id=ve,this.dispatcher=de,this.coordinates=K.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(Se),this.options=K}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.load=function(K,de){var Se=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(Ce,Xe){Se._loaded=!0,Ce?Se.fire(new e.ErrorEvent(Ce)):Xe&&(Se.image=Xe,K&&(Se.coordinates=K),de&&de(),Se._finishLoading())})},H.prototype.loaded=function(){return this._loaded},H.prototype.updateImage=function(K){var de=this;return!this.image||!K.url?this:(this.options.url=K.url,this.load(K.coordinates,function(){de.texture=null}),this)},H.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},H.prototype.onAdd=function(K){this.map=K,this.load()},H.prototype.setCoordinates=function(K){var de=this;this.coordinates=K;var Se=K.map(e.MercatorCoordinate.fromLngLat);this.tileID=oe(Se),this.minzoom=this.maxzoom=this.tileID.z;var Ce=Se.map(function(Xe){return de.tileID.getTilePoint(Xe)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(Ce[0].x,Ce[0].y,0,0),this._boundsArray.emplaceBack(Ce[1].x,Ce[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(Ce[3].x,Ce[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(Ce[2].x,Ce[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},H.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||!this.image)){var K=this.map.painter.context,de=K.gl;this.boundsBuffer||(this.boundsBuffer=K.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(K,this.image,de.RGBA),this.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE));for(var Se in this.tiles){var Ce=this.tiles[Se];Ce.state!=="loaded"&&(Ce.state="loaded",Ce.texture=this.texture)}}},H.prototype.loadTile=function(K,de){this.tileID&&this.tileID.equals(K.tileID.canonical)?(this.tiles[String(K.tileID.wrap)]=K,K.buckets={},de(null)):(K.state="errored",de(null))},H.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},H.prototype.hasTransition=function(){return!1},H}(e.Evented);function oe(ce){for(var H=1/0,ve=1/0,K=-1/0,de=-1/0,Se=0,Ce=ce;Se<Ce.length;Se+=1){var Xe=Ce[Se];H=Math.min(H,Xe.x),ve=Math.min(ve,Xe.y),K=Math.max(K,Xe.x),de=Math.max(de,Xe.y)}var lt=K-H,wt=de-ve,Ht=Math.max(lt,wt),nr=Math.max(0,Math.floor(-Math.log(Ht)/Math.LN2)),sr=Math.pow(2,nr);return new e.CanonicalTileID(nr,Math.floor((H+K)/2*sr),Math.floor((ve+de)/2*sr))}var se=function(ce){function H(ve,K,de,Se){ce.call(this,ve,K,de,Se),this.roundZoom=!0,this.type="video",this.options=K}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.load=function(){var K=this;this._loaded=!1;var de=this.options;this.urls=[];for(var Se=0,Ce=de.urls;Se<Ce.length;Se+=1){var Xe=Ce[Se];this.urls.push(this.map._requestManager.transformRequest(Xe,e.ResourceType.Source).url)}e.getVideo(this.urls,function(lt,wt){K._loaded=!0,lt?K.fire(new e.ErrorEvent(lt)):wt&&(K.video=wt,K.video.loop=!0,K.video.addEventListener("playing",function(){K.map.triggerRepaint()}),K.map&&K.video.play(),K._finishLoading())})},H.prototype.pause=function(){this.video&&this.video.pause()},H.prototype.play=function(){this.video&&this.video.play()},H.prototype.seek=function(K){if(this.video){var de=this.video.seekable;K<de.start(0)||K>de.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+de.start(0)+" and "+de.end(0)+"-second mark."))):this.video.currentTime=K}},H.prototype.getVideo=function(){return this.video},H.prototype.onAdd=function(K){this.map||(this.map=K,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},H.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var K=this.map.painter.context,de=K.gl;this.boundsBuffer||(this.boundsBuffer=K.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE),de.texSubImage2D(de.TEXTURE_2D,0,0,0,de.RGBA,de.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(K,this.video,de.RGBA),this.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE));for(var Se in this.tiles){var Ce=this.tiles[Se];Ce.state!=="loaded"&&(Ce.state="loaded",Ce.texture=this.texture)}}},H.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},H.prototype.hasTransition=function(){return this.video&&!this.video.paused},H}(X),ie=function(ce){function H(ve,K,de,Se){ce.call(this,ve,K,de,Se),K.coordinates?(!Array.isArray(K.coordinates)||K.coordinates.length!==4||K.coordinates.some(function(Ce){return!Array.isArray(Ce)||Ce.length!==2||Ce.some(function(Xe){return typeof Xe!="number"})}))&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'missing required property "coordinates"'))),K.animate&&typeof K.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'optional "animate" property must be a boolean value'))),K.canvas?typeof K.canvas!="string"&&!(K.canvas instanceof e.window.HTMLCanvasElement)&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+ve,null,'missing required property "canvas"'))),this.options=K,this.animate=K.animate!==void 0?K.animate:!0}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.load=function(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()},H.prototype.getCanvas=function(){return this.canvas},H.prototype.onAdd=function(K){this.map=K,this.load(),this.canvas&&this.animate&&this.play()},H.prototype.onRemove=function(){this.pause()},H.prototype.prepare=function(){var K=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,K=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,K=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var de=this.map.painter.context,Se=de.gl;this.boundsBuffer||(this.boundsBuffer=de.createVertexBuffer(this._boundsArray,Y.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(K||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(de,this.canvas,Se.RGBA,{premultiply:!0});for(var Ce in this.tiles){var Xe=this.tiles[Ce];Xe.state!=="loaded"&&(Xe.state="loaded",Xe.texture=this.texture)}}},H.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},H.prototype.hasTransition=function(){return this._playing},H.prototype._hasInvalidDimensions=function(){for(var K=0,de=[this.canvas.width,this.canvas.height];K<de.length;K+=1){var Se=de[K];if(isNaN(Se)||Se<=0)return!0}return!1},H}(X),N={vector:V,raster:G,"raster-dem":J,geojson:j,video:se,image:X,canvas:ie},U=function(ce,H,ve,K){var de=new N[H.type](ce,H,ve,K);if(de.id!==ce)throw new Error("Expected Source id to be "+ce+" instead of "+de.id);return e.bindAll(["load","abort","unload","serialize","prepare"],de),de},q=function(ce){return N[ce]},Q=function(ce,H){N[ce]=H};function W(ce,H){var ve=e.identity([]);return e.translate(ve,ve,[1,1,0]),e.scale(ve,ve,[ce.width*.5,ce.height*.5,1]),e.multiply(ve,ve,ce.calculatePosMatrix(H.toUnwrapped()))}function Z(ce,H,ve){if(ce)for(var K=0,de=ce;K<de.length;K+=1){var Se=de[K],Ce=H[Se];if(Ce&&Ce.source===ve&&Ce.type==="fill-extrusion")return!0}else for(var Xe in H){var lt=H[Xe];if(lt.source===ve&&lt.type==="fill-extrusion")return!0}return!1}function ee(ce,H,ve,K,de,Se){var Ce=Z(de&&de.layers,H,ce.id),Xe=Se.maxPitchScaleFactor(),lt=ce.tilesIn(K,Xe,Ce);lt.sort(le);for(var wt=[],Ht=0,nr=lt;Ht<nr.length;Ht+=1){var sr=nr[Ht];wt.push({wrappedTileID:sr.tileID.wrapped().key,queryResults:sr.tile.queryRenderedFeatures(H,ve,ce._state,sr.queryGeometry,sr.cameraQueryGeometry,sr.scale,de,Se,Xe,W(ce.transform,sr.tileID))})}var Ar=ye(wt);for(var Nr in Ar)Ar[Nr].forEach(function(Ur){var Or=Ur.feature,Xr=ce.getFeatureState(Or.layer["source-layer"],Or.id);Or.source=Or.layer.source,Or.layer["source-layer"]&&(Or.sourceLayer=Or.layer["source-layer"]),Or.state=Xr});return Ar}function te(ce,H,ve,K,de,Se,Ce){for(var Xe={},lt=Se.queryRenderedSymbols(K),wt=[],Ht=0,nr=Object.keys(lt).map(Number);Ht<nr.length;Ht+=1){var sr=nr[Ht];wt.push(Ce[sr])}wt.sort(le);for(var Ar=function(){var sn=Ur[Nr],Sn=sn.featureIndex.lookupSymbolFeatures(lt[sn.bucketInstanceId],H,sn.bucketIndex,sn.sourceLayerIndex,de.filter,de.layers,de.availableImages,ce);for(var Fn in Sn){var Xn=Xe[Fn]=Xe[Fn]||[],Qn=Sn[Fn];Qn.sort(function(ya,Ta){var Ca=sn.featureSortOrder;if(Ca){var Ha=Ca.indexOf(ya.featureIndex),ri=Ca.indexOf(Ta.featureIndex);return ri-Ha}else return Ta.featureIndex-ya.featureIndex});for(var jn=0,ca=Qn;jn<ca.length;jn+=1){var ba=ca[jn];Xn.push(ba)}}},Nr=0,Ur=wt;Nr<Ur.length;Nr+=1)Ar();var Or=function(sn){Xe[sn].forEach(function(Sn){var Fn=Sn.feature,Xn=ce[sn],Qn=ve[Xn.source],jn=Qn.getFeatureState(Fn.layer["source-layer"],Fn.id);Fn.source=Fn.layer.source,Fn.layer["source-layer"]&&(Fn.sourceLayer=Fn.layer["source-layer"]),Fn.state=jn})};for(var Xr in Xe)Or(Xr);return Xe}function ae(ce,H){for(var ve=ce.getRenderableIds().map(function(lt){return ce.getTileByID(lt)}),K=[],de={},Se=0;Se<ve.length;Se++){var Ce=ve[Se],Xe=Ce.tileID.canonical.key;de[Xe]||(de[Xe]=!0,Ce.querySourceFeatures(K,H))}return K}function le(ce,H){var ve=ce.tileID,K=H.tileID;return ve.overscaledZ-K.overscaledZ||ve.canonical.y-K.canonical.y||ve.wrap-K.wrap||ve.canonical.x-K.canonical.x}function ye(ce){for(var H={},ve={},K=0,de=ce;K<de.length;K+=1){var Se=de[K],Ce=Se.queryResults,Xe=Se.wrappedTileID,lt=ve[Xe]=ve[Xe]||{};for(var wt in Ce)for(var Ht=Ce[wt],nr=lt[wt]=lt[wt]||{},sr=H[wt]=H[wt]||[],Ar=0,Nr=Ht;Ar<Nr.length;Ar+=1){var Ur=Nr[Ar];nr[Ur.featureIndex]||(nr[Ur.featureIndex]=!0,sr.push(Ur))}}return H}var fe=function(H,ve){this.max=H,this.onRemove=ve,this.reset()};fe.prototype.reset=function(){for(var H in this.data)for(var ve=0,K=this.data[H];ve<K.length;ve+=1){var de=K[ve];de.timeout&&clearTimeout(de.timeout),this.onRemove(de.value)}return this.data={},this.order=[],this},fe.prototype.add=function(H,ve,K){var de=this,Se=H.wrapped().key;this.data[Se]===void 0&&(this.data[Se]=[]);var Ce={value:ve,timeout:void 0};if(K!==void 0&&(Ce.timeout=setTimeout(function(){de.remove(H,Ce)},K)),this.data[Se].push(Ce),this.order.push(Se),this.order.length>this.max){var Xe=this._getAndRemoveByKey(this.order[0]);Xe&&this.onRemove(Xe)}return this},fe.prototype.has=function(H){return H.wrapped().key in this.data},fe.prototype.getAndRemove=function(H){return this.has(H)?this._getAndRemoveByKey(H.wrapped().key):null},fe.prototype._getAndRemoveByKey=function(H){var ve=this.data[H].shift();return ve.timeout&&clearTimeout(ve.timeout),this.data[H].length===0&&delete this.data[H],this.order.splice(this.order.indexOf(H),1),ve.value},fe.prototype.getByKey=function(H){var ve=this.data[H];return ve?ve[0].value:null},fe.prototype.get=function(H){if(!this.has(H))return null;var ve=this.data[H.wrapped().key][0];return ve.value},fe.prototype.remove=function(H,ve){if(!this.has(H))return this;var K=H.wrapped().key,de=ve===void 0?0:this.data[K].indexOf(ve),Se=this.data[K][de];return this.data[K].splice(de,1),Se.timeout&&clearTimeout(Se.timeout),this.data[K].length===0&&delete this.data[K],this.onRemove(Se.value),this.order.splice(this.order.indexOf(K),1),this},fe.prototype.setMaxSize=function(H){for(this.max=H;this.order.length>this.max;){var ve=this._getAndRemoveByKey(this.order[0]);ve&&this.onRemove(ve)}return this},fe.prototype.filter=function(H){var ve=[];for(var K in this.data)for(var de=0,Se=this.data[K];de<Se.length;de+=1){var Ce=Se[de];H(Ce.value)||ve.push(Ce)}for(var Xe=0,lt=ve;Xe<lt.length;Xe+=1){var wt=lt[Xe];this.remove(wt.value.tileID,wt)}};var pe=function(H,ve,K){this.context=H;var de=H.gl;this.buffer=de.createBuffer(),this.dynamicDraw=Boolean(K),this.context.unbindVAO(),H.bindElementBuffer.set(this.buffer),de.bufferData(de.ELEMENT_ARRAY_BUFFER,ve.arrayBuffer,this.dynamicDraw?de.DYNAMIC_DRAW:de.STATIC_DRAW),this.dynamicDraw||delete ve.arrayBuffer};pe.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},pe.prototype.updateData=function(H){var ve=this.context.gl;this.context.unbindVAO(),this.bind(),ve.bufferSubData(ve.ELEMENT_ARRAY_BUFFER,0,H.arrayBuffer)},pe.prototype.destroy=function(){var H=this.context.gl;this.buffer&&(H.deleteBuffer(this.buffer),delete this.buffer)};var ge={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Ae=function(H,ve,K,de){this.length=ve.length,this.attributes=K,this.itemSize=ve.bytesPerElement,this.dynamicDraw=de,this.context=H;var Se=H.gl;this.buffer=Se.createBuffer(),H.bindVertexBuffer.set(this.buffer),Se.bufferData(Se.ARRAY_BUFFER,ve.arrayBuffer,this.dynamicDraw?Se.DYNAMIC_DRAW:Se.STATIC_DRAW),this.dynamicDraw||delete ve.arrayBuffer};Ae.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Ae.prototype.updateData=function(H){var ve=this.context.gl;this.bind(),ve.bufferSubData(ve.ARRAY_BUFFER,0,H.arrayBuffer)},Ae.prototype.enableAttributes=function(H,ve){for(var K=0;K<this.attributes.length;K++){var de=this.attributes[K],Se=ve.attributes[de.name];Se!==void 0&&H.enableVertexAttribArray(Se)}},Ae.prototype.setVertexAttribPointers=function(H,ve,K){for(var de=0;de<this.attributes.length;de++){var Se=this.attributes[de],Ce=ve.attributes[Se.name];Ce!==void 0&&H.vertexAttribPointer(Ce,Se.components,H[ge[Se.type]],!1,this.itemSize,Se.offset+this.itemSize*(K||0))}},Ae.prototype.destroy=function(){var H=this.context.gl;this.buffer&&(H.deleteBuffer(this.buffer),delete this.buffer)};var we=function(H){this.gl=H.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};we.prototype.get=function(){return this.current},we.prototype.set=function(H){},we.prototype.getDefault=function(){return this.default},we.prototype.setDefault=function(){this.set(this.default)};var De=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return e.Color.transparent},H.prototype.set=function(K){var de=this.current;K.r===de.r&&K.g===de.g&&K.b===de.b&&K.a===de.a&&!this.dirty||(this.gl.clearColor(K.r,K.g,K.b,K.a),this.current=K,this.dirty=!1)},H}(we),Be=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return 1},H.prototype.set=function(K){K===this.current&&!this.dirty||(this.gl.clearDepth(K),this.current=K,this.dirty=!1)},H}(we),Ve=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return 0},H.prototype.set=function(K){K===this.current&&!this.dirty||(this.gl.clearStencil(K),this.current=K,this.dirty=!1)},H}(we),xe=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return[!0,!0,!0,!0]},H.prototype.set=function(K){var de=this.current;K[0]===de[0]&&K[1]===de[1]&&K[2]===de[2]&&K[3]===de[3]&&!this.dirty||(this.gl.colorMask(K[0],K[1],K[2],K[3]),this.current=K,this.dirty=!1)},H}(we),Le=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!0},H.prototype.set=function(K){K===this.current&&!this.dirty||(this.gl.depthMask(K),this.current=K,this.dirty=!1)},H}(we),He=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return 255},H.prototype.set=function(K){K===this.current&&!this.dirty||(this.gl.stencilMask(K),this.current=K,this.dirty=!1)},H}(we),Je=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},H.prototype.set=function(K){var de=this.current;K.func===de.func&&K.ref===de.ref&&K.mask===de.mask&&!this.dirty||(this.gl.stencilFunc(K.func,K.ref,K.mask),this.current=K,this.dirty=!1)},H}(we),Oe=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){var K=this.gl;return[K.KEEP,K.KEEP,K.KEEP]},H.prototype.set=function(K){var de=this.current;K[0]===de[0]&&K[1]===de[1]&&K[2]===de[2]&&!this.dirty||(this.gl.stencilOp(K[0],K[1],K[2]),this.current=K,this.dirty=!1)},H}(we),Pe=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){var de=this.gl;K?de.enable(de.STENCIL_TEST):de.disable(de.STENCIL_TEST),this.current=K,this.dirty=!1}},H}(we),Ue=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return[0,1]},H.prototype.set=function(K){var de=this.current;K[0]===de[0]&&K[1]===de[1]&&!this.dirty||(this.gl.depthRange(K[0],K[1]),this.current=K,this.dirty=!1)},H}(we),vt=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){var de=this.gl;K?de.enable(de.DEPTH_TEST):de.disable(de.DEPTH_TEST),this.current=K,this.dirty=!1}},H}(we),Lt=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return this.gl.LESS},H.prototype.set=function(K){K===this.current&&!this.dirty||(this.gl.depthFunc(K),this.current=K,this.dirty=!1)},H}(we),Yt=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){var de=this.gl;K?de.enable(de.BLEND):de.disable(de.BLEND),this.current=K,this.dirty=!1}},H}(we),At=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){var K=this.gl;return[K.ONE,K.ZERO]},H.prototype.set=function(K){var de=this.current;K[0]===de[0]&&K[1]===de[1]&&!this.dirty||(this.gl.blendFunc(K[0],K[1]),this.current=K,this.dirty=!1)},H}(we),Rt=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return e.Color.transparent},H.prototype.set=function(K){var de=this.current;K.r===de.r&&K.g===de.g&&K.b===de.b&&K.a===de.a&&!this.dirty||(this.gl.blendColor(K.r,K.g,K.b,K.a),this.current=K,this.dirty=!1)},H}(we),Bt=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return this.gl.FUNC_ADD},H.prototype.set=function(K){K===this.current&&!this.dirty||(this.gl.blendEquation(K),this.current=K,this.dirty=!1)},H}(we),Mt=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){var de=this.gl;K?de.enable(de.CULL_FACE):de.disable(de.CULL_FACE),this.current=K,this.dirty=!1}},H}(we),Tt=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return this.gl.BACK},H.prototype.set=function(K){K===this.current&&!this.dirty||(this.gl.cullFace(K),this.current=K,this.dirty=!1)},H}(we),at=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return this.gl.CCW},H.prototype.set=function(K){K===this.current&&!this.dirty||(this.gl.frontFace(K),this.current=K,this.dirty=!1)},H}(we),ct=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(K){K===this.current&&!this.dirty||(this.gl.useProgram(K),this.current=K,this.dirty=!1)},H}(we),je=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return this.gl.TEXTURE0},H.prototype.set=function(K){K===this.current&&!this.dirty||(this.gl.activeTexture(K),this.current=K,this.dirty=!1)},H}(we),ke=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){var K=this.gl;return[0,0,K.drawingBufferWidth,K.drawingBufferHeight]},H.prototype.set=function(K){var de=this.current;K[0]===de[0]&&K[1]===de[1]&&K[2]===de[2]&&K[3]===de[3]&&!this.dirty||(this.gl.viewport(K[0],K[1],K[2],K[3]),this.current=K,this.dirty=!1)},H}(we),Ye=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){var de=this.gl;de.bindFramebuffer(de.FRAMEBUFFER,K),this.current=K,this.dirty=!1}},H}(we),Ke=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){var de=this.gl;de.bindRenderbuffer(de.RENDERBUFFER,K),this.current=K,this.dirty=!1}},H}(we),st=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){var de=this.gl;de.bindTexture(de.TEXTURE_2D,K),this.current=K,this.dirty=!1}},H}(we),Et=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){var de=this.gl;de.bindBuffer(de.ARRAY_BUFFER,K),this.current=K,this.dirty=!1}},H}(we),bt=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(K){var de=this.gl;de.bindBuffer(de.ELEMENT_ARRAY_BUFFER,K),this.current=K,this.dirty=!1},H}(we),zt=function(ce){function H(ve){ce.call(this,ve),this.vao=ve.extVertexArrayObject}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H.prototype.set=function(K){!this.vao||K===this.current&&!this.dirty||(this.vao.bindVertexArrayOES(K),this.current=K,this.dirty=!1)},H}(we),$t=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return 4},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){var de=this.gl;de.pixelStorei(de.UNPACK_ALIGNMENT,K),this.current=K,this.dirty=!1}},H}(we),Ot=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){var de=this.gl;de.pixelStorei(de.UNPACK_PREMULTIPLY_ALPHA_WEBGL,K),this.current=K,this.dirty=!1}},H}(we),Qt=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return!1},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){var de=this.gl;de.pixelStorei(de.UNPACK_FLIP_Y_WEBGL,K),this.current=K,this.dirty=!1}},H}(we),tr=function(ce){function H(ve,K){ce.call(this,ve),this.context=ve,this.parent=K}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getDefault=function(){return null},H}(we),qt=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.setDirty=function(){this.dirty=!0},H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var de=this.gl;de.framebufferTexture2D(de.FRAMEBUFFER,de.COLOR_ATTACHMENT0,de.TEXTURE_2D,K,0),this.current=K,this.dirty=!1}},H}(tr),lr=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.set=function(K){if(!(K===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var de=this.gl;de.framebufferRenderbuffer(de.FRAMEBUFFER,de.DEPTH_ATTACHMENT,de.RENDERBUFFER,K),this.current=K,this.dirty=!1}},H}(tr),Wr=function(H,ve,K,de){this.context=H,this.width=ve,this.height=K;var Se=H.gl,Ce=this.framebuffer=Se.createFramebuffer();this.colorAttachment=new qt(H,Ce),de&&(this.depthAttachment=new lr(H,Ce))};Wr.prototype.destroy=function(){var H=this.context.gl,ve=this.colorAttachment.get();if(ve&&H.deleteTexture(ve),this.depthAttachment){var K=this.depthAttachment.get();K&&H.deleteRenderbuffer(K)}H.deleteFramebuffer(this.framebuffer)};var cn=519,Jr=function(H,ve,K){this.func=H,this.mask=ve,this.range=K};Jr.ReadOnly=!1,Jr.ReadWrite=!0,Jr.disabled=new Jr(cn,Jr.ReadOnly,[0,1]);var ot=519,Vt=7680,jt=function(H,ve,K,de,Se,Ce){this.test=H,this.ref=ve,this.mask=K,this.fail=de,this.depthFail=Se,this.pass=Ce};jt.disabled=new jt({func:ot,mask:0},0,0,Vt,Vt,Vt);var Ut=0,yr=1,nt=771,_e=function(H,ve,K){this.blendFunction=H,this.blendColor=ve,this.mask=K};_e.Replace=[yr,Ut],_e.disabled=new _e(_e.Replace,e.Color.transparent,[!1,!1,!1,!1]),_e.unblended=new _e(_e.Replace,e.Color.transparent,[!0,!0,!0,!0]),_e.alphaBlended=new _e([yr,nt],e.Color.transparent,[!0,!0,!0,!0]);var Me=1029,Ne=2305,We=function(H,ve,K){this.enable=H,this.mode=ve,this.frontFace=K};We.disabled=new We(!1,Me,Ne),We.backCCW=new We(!0,Me,Ne);var Qe=function(H){this.gl=H,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new De(this),this.clearDepth=new Be(this),this.clearStencil=new Ve(this),this.colorMask=new xe(this),this.depthMask=new Le(this),this.stencilMask=new He(this),this.stencilFunc=new Je(this),this.stencilOp=new Oe(this),this.stencilTest=new Pe(this),this.depthRange=new Ue(this),this.depthTest=new vt(this),this.depthFunc=new Lt(this),this.blend=new Yt(this),this.blendFunc=new At(this),this.blendColor=new Rt(this),this.blendEquation=new Bt(this),this.cullFace=new Mt(this),this.cullFaceSide=new Tt(this),this.frontFace=new at(this),this.program=new ct(this),this.activeTexture=new je(this),this.viewport=new ke(this),this.bindFramebuffer=new Ye(this),this.bindRenderbuffer=new Ke(this),this.bindTexture=new st(this),this.bindVertexBuffer=new Et(this),this.bindElementBuffer=new bt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new zt(this),this.pixelStoreUnpack=new $t(this),this.pixelStoreUnpackPremultiplyAlpha=new Ot(this),this.pixelStoreUnpackFlipY=new Qt(this),this.extTextureFilterAnisotropic=H.getExtension("EXT_texture_filter_anisotropic")||H.getExtension("MOZ_EXT_texture_filter_anisotropic")||H.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=H.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=H.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(H.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=H.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=H.getExtension("EXT_disjoint_timer_query")};Qe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Qe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Qe.prototype.createIndexBuffer=function(H,ve){return new pe(this,H,ve)},Qe.prototype.createVertexBuffer=function(H,ve,K){return new Ae(this,H,ve,K)},Qe.prototype.createRenderbuffer=function(H,ve,K){var de=this.gl,Se=de.createRenderbuffer();return this.bindRenderbuffer.set(Se),de.renderbufferStorage(de.RENDERBUFFER,H,ve,K),this.bindRenderbuffer.set(null),Se},Qe.prototype.createFramebuffer=function(H,ve,K){return new Wr(this,H,ve,K)},Qe.prototype.clear=function(H){var ve=H.color,K=H.depth,de=this.gl,Se=0;ve&&(Se|=de.COLOR_BUFFER_BIT,this.clearColor.set(ve),this.colorMask.set([!0,!0,!0,!0])),typeof K!="undefined"&&(Se|=de.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(K),this.depthMask.set(!0)),de.clear(Se)},Qe.prototype.setCullFace=function(H){H.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(H.mode),this.frontFace.set(H.frontFace))},Qe.prototype.setDepthMode=function(H){H.func===this.gl.ALWAYS&&!H.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(H.func),this.depthMask.set(H.mask),this.depthRange.set(H.range))},Qe.prototype.setStencilMode=function(H){H.test.func===this.gl.ALWAYS&&!H.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(H.mask),this.stencilOp.set([H.fail,H.depthFail,H.pass]),this.stencilFunc.set({func:H.test.func,ref:H.ref,mask:H.test.mask}))},Qe.prototype.setColorMode=function(H){e.deepEqual(H.blendFunction,_e.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(H.blendFunction),this.blendColor.set(H.blendColor)),this.colorMask.set(H.mask)},Qe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var rt=function(ce){function H(ve,K,de){var Se=this;ce.call(this),this.id=ve,this.dispatcher=de,this.on("data",function(Ce){Ce.dataType==="source"&&Ce.sourceDataType==="metadata"&&(Se._sourceLoaded=!0),Se._sourceLoaded&&!Se._paused&&Ce.dataType==="source"&&Ce.sourceDataType==="content"&&(Se.reload(),Se.transform&&Se.update(Se.transform))}),this.on("error",function(){Se._sourceErrored=!0}),this._source=U(ve,K,de,this),this._tiles={},this._cache=new fe(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.onAdd=function(K){this.map=K,this._maxTileCacheSize=K?K._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(K)},H.prototype.onRemove=function(K){this._source&&this._source.onRemove&&this._source.onRemove(K)},H.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var K in this._tiles){var de=this._tiles[K];if(de.state!=="loaded"&&de.state!=="errored")return!1}return!0},H.prototype.getSource=function(){return this._source},H.prototype.pause=function(){this._paused=!0},H.prototype.resume=function(){if(!!this._paused){var K=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,K&&this.reload(),this.transform&&this.update(this.transform)}},H.prototype._loadTile=function(K,de){return this._source.loadTile(K,de)},H.prototype._unloadTile=function(K){if(this._source.unloadTile)return this._source.unloadTile(K,function(){})},H.prototype._abortTile=function(K){if(this._source.abortTile)return this._source.abortTile(K,function(){})},H.prototype.serialize=function(){return this._source.serialize()},H.prototype.prepare=function(K){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(var de in this._tiles){var Se=this._tiles[de];Se.upload(K),Se.prepare(this.map.style.imageManager)}},H.prototype.getIds=function(){return e.values(this._tiles).map(function(K){return K.tileID}).sort($e).map(function(K){return K.key})},H.prototype.getRenderableIds=function(K){var de=this,Se=[];for(var Ce in this._tiles)this._isIdRenderable(Ce,K)&&Se.push(this._tiles[Ce]);return K?Se.sort(function(Xe,lt){var wt=Xe.tileID,Ht=lt.tileID,nr=new e.Point(wt.canonical.x,wt.canonical.y)._rotate(de.transform.angle),sr=new e.Point(Ht.canonical.x,Ht.canonical.y)._rotate(de.transform.angle);return wt.overscaledZ-Ht.overscaledZ||sr.y-nr.y||sr.x-nr.x}).map(function(Xe){return Xe.tileID.key}):Se.map(function(Xe){return Xe.tileID}).sort($e).map(function(Xe){return Xe.key})},H.prototype.hasRenderableParent=function(K){var de=this.findLoadedParent(K,0);return de?this._isIdRenderable(de.tileID.key):!1},H.prototype._isIdRenderable=function(K,de){return this._tiles[K]&&this._tiles[K].hasData()&&!this._coveredTiles[K]&&(de||!this._tiles[K].holdingForFade())},H.prototype.reload=function(){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(var K in this._tiles)this._tiles[K].state!=="errored"&&this._reloadTile(K,"reloading")},H.prototype._reloadTile=function(K,de){var Se=this._tiles[K];!Se||(Se.state!=="loading"&&(Se.state=de),this._loadTile(Se,this._tileLoaded.bind(this,Se,K,de)))},H.prototype._tileLoaded=function(K,de,Se,Ce){if(Ce){K.state="errored",Ce.status!==404?this._source.fire(new e.ErrorEvent(Ce,{tile:K})):this.update(this.transform);return}K.timeAdded=e.browser.now(),Se==="expired"&&(K.refreshedUponExpiration=!0),this._setTileReloadTimer(de,K),this.getSource().type==="raster-dem"&&K.dem&&this._backfillDEM(K),this._state.initializeTileState(K,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:K,coord:K.tileID}))},H.prototype._backfillDEM=function(K){for(var de=this.getRenderableIds(),Se=0;Se<de.length;Se++){var Ce=de[Se];if(K.neighboringTiles&&K.neighboringTiles[Ce]){var Xe=this.getTileByID(Ce);lt(K,Xe),lt(Xe,K)}}function lt(wt,Ht){wt.needsHillshadePrepare=!0;var nr=Ht.tileID.canonical.x-wt.tileID.canonical.x,sr=Ht.tileID.canonical.y-wt.tileID.canonical.y,Ar=Math.pow(2,wt.tileID.canonical.z),Nr=Ht.tileID.key;nr===0&&sr===0||Math.abs(sr)>1||(Math.abs(nr)>1&&(Math.abs(nr+Ar)===1?nr+=Ar:Math.abs(nr-Ar)===1&&(nr-=Ar)),!(!Ht.dem||!wt.dem)&&(wt.dem.backfillBorder(Ht.dem,nr,sr),wt.neighboringTiles&&wt.neighboringTiles[Nr]&&(wt.neighboringTiles[Nr].backfilled=!0)))}},H.prototype.getTile=function(K){return this.getTileByID(K.key)},H.prototype.getTileByID=function(K){return this._tiles[K]},H.prototype._retainLoadedChildren=function(K,de,Se,Ce){for(var Xe in this._tiles){var lt=this._tiles[Xe];if(!(Ce[Xe]||!lt.hasData()||lt.tileID.overscaledZ<=de||lt.tileID.overscaledZ>Se)){for(var wt=lt.tileID;lt&&lt.tileID.overscaledZ>de+1;){var Ht=lt.tileID.scaledTo(lt.tileID.overscaledZ-1);lt=this._tiles[Ht.key],lt&&lt.hasData()&&(wt=Ht)}for(var nr=wt;nr.overscaledZ>de;)if(nr=nr.scaledTo(nr.overscaledZ-1),K[nr.key]){Ce[wt.key]=wt;break}}}},H.prototype.findLoadedParent=function(K,de){if(K.key in this._loadedParentTiles){var Se=this._loadedParentTiles[K.key];return Se&&Se.tileID.overscaledZ>=de?Se:null}for(var Ce=K.overscaledZ-1;Ce>=de;Ce--){var Xe=K.scaledTo(Ce),lt=this._getLoadedTile(Xe);if(lt)return lt}},H.prototype._getLoadedTile=function(K){var de=this._tiles[K.key];if(de&&de.hasData())return de;var Se=this._cache.getByKey(K.wrapped().key);return Se},H.prototype.updateCacheSize=function(K){var de=Math.ceil(K.width/this._source.tileSize)+1,Se=Math.ceil(K.height/this._source.tileSize)+1,Ce=de*Se,Xe=5,lt=Math.floor(Ce*Xe),wt=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,lt):lt;this._cache.setMaxSize(wt)},H.prototype.handleWrapJump=function(K){var de=this._prevLng===void 0?K:this._prevLng,Se=K-de,Ce=Se/360,Xe=Math.round(Ce);if(this._prevLng=K,Xe){var lt={};for(var wt in this._tiles){var Ht=this._tiles[wt];Ht.tileID=Ht.tileID.unwrapTo(Ht.tileID.wrap+Xe),lt[Ht.tileID.key]=Ht}this._tiles=lt;for(var nr in this._timers)clearTimeout(this._timers[nr]),delete this._timers[nr];for(var sr in this._tiles){var Ar=this._tiles[sr];this._setTileReloadTimer(sr,Ar)}}},H.prototype.update=function(K){var de=this;if(this.transform=K,!(!this._sourceLoaded||this._paused)){this.updateCacheSize(K),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};var Se;this.used?this._source.tileID?Se=K.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(ya){return new e.OverscaledTileID(ya.canonical.z,ya.wrap,ya.canonical.z,ya.canonical.x,ya.canonical.y)}):(Se=K.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(Se=Se.filter(function(ya){return de._source.hasTile(ya)}))):Se=[];var Ce=K.coveringZoomLevel(this._source),Xe=Math.max(Ce-H.maxOverzooming,this._source.minzoom),lt=Math.max(Ce+H.maxUnderzooming,this._source.minzoom),wt=this._updateRetainedTiles(Se,Ce);if(ht(this._source.type)){for(var Ht={},nr={},sr=Object.keys(wt),Ar=0,Nr=sr;Ar<Nr.length;Ar+=1){var Ur=Nr[Ar],Or=wt[Ur],Xr=this._tiles[Ur];if(!(!Xr||Xr.fadeEndTime&&Xr.fadeEndTime<=e.browser.now())){var sn=this.findLoadedParent(Or,Xe);sn&&(this._addTile(sn.tileID),Ht[sn.tileID.key]=sn.tileID),nr[Ur]=Or}}this._retainLoadedChildren(nr,Ce,lt,wt);for(var Sn in Ht)wt[Sn]||(this._coveredTiles[Sn]=!0,wt[Sn]=Ht[Sn])}for(var Fn in wt)this._tiles[Fn].clearFadeHold();for(var Xn=e.keysDifference(this._tiles,wt),Qn=0,jn=Xn;Qn<jn.length;Qn+=1){var ca=jn[Qn],ba=this._tiles[ca];ba.hasSymbolBuckets&&!ba.holdingForFade()?ba.setHoldDuration(this.map._fadeDuration):(!ba.hasSymbolBuckets||ba.symbolFadeFinished())&&this._removeTile(ca)}this._updateLoadedParentTileCache()}},H.prototype.releaseSymbolFadeTiles=function(){for(var K in this._tiles)this._tiles[K].holdingForFade()&&this._removeTile(K)},H.prototype._updateRetainedTiles=function(K,de){for(var Se={},Ce={},Xe=Math.max(de-H.maxOverzooming,this._source.minzoom),lt=Math.max(de+H.maxUnderzooming,this._source.minzoom),wt={},Ht=0,nr=K;Ht<nr.length;Ht+=1){var sr=nr[Ht],Ar=this._addTile(sr);Se[sr.key]=sr,!Ar.hasData()&&de<this._source.maxzoom&&(wt[sr.key]=sr)}this._retainLoadedChildren(wt,de,lt,Se);for(var Nr=0,Ur=K;Nr<Ur.length;Nr+=1){var Or=Ur[Nr],Xr=this._tiles[Or.key];if(!Xr.hasData()){if(de+1>this._source.maxzoom){var sn=Or.children(this._source.maxzoom)[0],Sn=this.getTile(sn);if(!!Sn&&Sn.hasData()){Se[sn.key]=sn;continue}}else{var Fn=Or.children(this._source.maxzoom);if(Se[Fn[0].key]&&Se[Fn[1].key]&&Se[Fn[2].key]&&Se[Fn[3].key])continue}for(var Xn=Xr.wasRequested(),Qn=Or.overscaledZ-1;Qn>=Xe;--Qn){var jn=Or.scaledTo(Qn);if(Ce[jn.key]||(Ce[jn.key]=!0,Xr=this.getTile(jn),!Xr&&Xn&&(Xr=this._addTile(jn)),Xr&&(Se[jn.key]=jn,Xn=Xr.wasRequested(),Xr.hasData())))break}}}return Se},H.prototype._updateLoadedParentTileCache=function(){this._loadedParentTiles={};for(var K in this._tiles){for(var de=[],Se=void 0,Ce=this._tiles[K].tileID;Ce.overscaledZ>0;){if(Ce.key in this._loadedParentTiles){Se=this._loadedParentTiles[Ce.key];break}de.push(Ce.key);var Xe=Ce.scaledTo(Ce.overscaledZ-1);if(Se=this._getLoadedTile(Xe),Se)break;Ce=Xe}for(var lt=0,wt=de;lt<wt.length;lt+=1){var Ht=wt[lt];this._loadedParentTiles[Ht]=Se}}},H.prototype._addTile=function(K){var de=this._tiles[K.key];if(de)return de;de=this._cache.getAndRemove(K),de&&(this._setTileReloadTimer(K.key,de),de.tileID=K,this._state.initializeTileState(de,this.map?this.map.painter:null),this._cacheTimers[K.key]&&(clearTimeout(this._cacheTimers[K.key]),delete this._cacheTimers[K.key],this._setTileReloadTimer(K.key,de)));var Se=Boolean(de);return Se||(de=new e.Tile(K,this._source.tileSize*K.overscaleFactor()),this._loadTile(de,this._tileLoaded.bind(this,de,K.key,de.state))),de?(de.uses++,this._tiles[K.key]=de,Se||this._source.fire(new e.Event("dataloading",{tile:de,coord:de.tileID,dataType:"source"})),de):null},H.prototype._setTileReloadTimer=function(K,de){var Se=this;K in this._timers&&(clearTimeout(this._timers[K]),delete this._timers[K]);var Ce=de.getExpiryTimeout();Ce&&(this._timers[K]=setTimeout(function(){Se._reloadTile(K,"expired"),delete Se._timers[K]},Ce))},H.prototype._removeTile=function(K){var de=this._tiles[K];!de||(de.uses--,delete this._tiles[K],this._timers[K]&&(clearTimeout(this._timers[K]),delete this._timers[K]),!(de.uses>0)&&(de.hasData()&&de.state!=="reloading"?this._cache.add(de.tileID,de,de.getExpiryTimeout()):(de.aborted=!0,this._abortTile(de),this._unloadTile(de))))},H.prototype.clearTiles=function(){this._shouldReloadOnResume=!1,this._paused=!1;for(var K in this._tiles)this._removeTile(K);this._cache.reset()},H.prototype.tilesIn=function(K,de,Se){var Ce=this,Xe=[],lt=this.transform;if(!lt)return Xe;for(var wt=Se?lt.getCameraQueryGeometry(K):K,Ht=K.map(function(Qn){return lt.pointCoordinate(Qn)}),nr=wt.map(function(Qn){return lt.pointCoordinate(Qn)}),sr=this.getIds(),Ar=1/0,Nr=1/0,Ur=-1/0,Or=-1/0,Xr=0,sn=nr;Xr<sn.length;Xr+=1){var Sn=sn[Xr];Ar=Math.min(Ar,Sn.x),Nr=Math.min(Nr,Sn.y),Ur=Math.max(Ur,Sn.x),Or=Math.max(Or,Sn.y)}for(var Fn=function(Qn){var jn=Ce._tiles[sr[Qn]];if(!jn.holdingForFade()){var ca=jn.tileID,ba=Math.pow(2,lt.zoom-jn.tileID.overscaledZ),ya=de*jn.queryPadding*e.EXTENT/jn.tileSize/ba,Ta=[ca.getTilePoint(new e.MercatorCoordinate(Ar,Nr)),ca.getTilePoint(new e.MercatorCoordinate(Ur,Or))];if(Ta[0].x-ya<e.EXTENT&&Ta[0].y-ya<e.EXTENT&&Ta[1].x+ya>=0&&Ta[1].y+ya>=0){var Ca=Ht.map(function(ri){return ca.getTilePoint(ri)}),Ha=nr.map(function(ri){return ca.getTilePoint(ri)});Xe.push({tile:jn,tileID:ca,queryGeometry:Ca,cameraQueryGeometry:Ha,scale:ba})}}},Xn=0;Xn<sr.length;Xn++)Fn(Xn);return Xe},H.prototype.getVisibleCoordinates=function(K){for(var de=this,Se=this.getRenderableIds(K).map(function(wt){return de._tiles[wt].tileID}),Ce=0,Xe=Se;Ce<Xe.length;Ce+=1){var lt=Xe[Ce];lt.posMatrix=this.transform.calculatePosMatrix(lt.toUnwrapped())}return Se},H.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(ht(this._source.type))for(var K in this._tiles){var de=this._tiles[K];if(de.fadeEndTime!==void 0&&de.fadeEndTime>=e.browser.now())return!0}return!1},H.prototype.setFeatureState=function(K,de,Se){K=K||"_geojsonTileLayer",this._state.updateState(K,de,Se)},H.prototype.removeFeatureState=function(K,de,Se){K=K||"_geojsonTileLayer",this._state.removeFeatureState(K,de,Se)},H.prototype.getFeatureState=function(K,de){return K=K||"_geojsonTileLayer",this._state.getState(K,de)},H.prototype.setDependencies=function(K,de,Se){var Ce=this._tiles[K];Ce&&Ce.setDependencies(de,Se)},H.prototype.reloadTilesForDependencies=function(K,de){for(var Se in this._tiles){var Ce=this._tiles[Se];Ce.hasDependency(K,de)&&this._reloadTile(Se,"reloading")}this._cache.filter(function(Xe){return!Xe.hasDependency(K,de)})},H}(e.Evented);rt.maxOverzooming=10,rt.maxUnderzooming=3;function $e(ce,H){var ve=Math.abs(ce.wrap*2)-+(ce.wrap<0),K=Math.abs(H.wrap*2)-+(H.wrap<0);return ce.overscaledZ-H.overscaledZ||K-ve||H.canonical.y-ce.canonical.y||H.canonical.x-ce.canonical.x}function ht(ce){return ce==="raster"||ce==="image"||ce==="video"}function xt(){return new e.window.Worker(Lc.workerUrl)}var kt="mapboxgl_preloaded_worker_pool",Wt=function(){this.active={}};Wt.prototype.acquire=function(H){if(!this.workers)for(this.workers=[];this.workers.length<Wt.workerCount;)this.workers.push(new xt);return this.active[H]=!0,this.workers.slice()},Wt.prototype.release=function(H){delete this.active[H],this.numActive()===0&&(this.workers.forEach(function(ve){ve.terminate()}),this.workers=null)},Wt.prototype.isPreloaded=function(){return!!this.active[kt]},Wt.prototype.numActive=function(){return Object.keys(this.active).length};var Ft=Math.floor(e.browser.hardwareConcurrency/2);Wt.workerCount=Math.max(Math.min(Ft,6),1);var ir;function hr(){return ir||(ir=new Wt),ir}function _r(){var ce=hr();ce.acquire(kt)}function an(){var ce=ir;ce&&(ce.isPreloaded()&&ce.numActive()===1?(ce.release(kt),ir=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))}function Rr(ce,H){var ve={};for(var K in ce)K!=="ref"&&(ve[K]=ce[K]);return e.refProperties.forEach(function(de){de in H&&(ve[de]=H[de])}),ve}function Vr(ce){ce=ce.slice();for(var H=Object.create(null),ve=0;ve<ce.length;ve++)H[ce[ve].id]=ce[ve];for(var K=0;K<ce.length;K++)"ref"in ce[K]&&(ce[K]=Rr(ce[K],H[ce[K].ref]));return ce}function fn(){var ce={},H=e.styleSpec.$version;for(var ve in e.styleSpec.$root){var K=e.styleSpec.$root[ve];if(K.required){var de=null;ve==="version"?de=H:K.type==="array"?de=[]:de={},de!=null&&(ce[ve]=de)}}return ce}var xr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function mr(ce,H,ve){ve.push({command:xr.addSource,args:[ce,H[ce]]})}function Fr(ce,H,ve){H.push({command:xr.removeSource,args:[ce]}),ve[ce]=!0}function Ir(ce,H,ve,K){Fr(ce,ve,K),mr(ce,H,ve)}function Sr(ce,H,ve){var K;for(K in ce[ve])if(!!ce[ve].hasOwnProperty(K)&&K!=="data"&&!e.deepEqual(ce[ve][K],H[ve][K]))return!1;for(K in H[ve])if(!!H[ve].hasOwnProperty(K)&&K!=="data"&&!e.deepEqual(ce[ve][K],H[ve][K]))return!1;return!0}function tt(ce,H,ve,K){ce=ce||{},H=H||{};var de;for(de in ce)!ce.hasOwnProperty(de)||H.hasOwnProperty(de)||Fr(de,ve,K);for(de in H)!H.hasOwnProperty(de)||(ce.hasOwnProperty(de)?e.deepEqual(ce[de],H[de])||(ce[de].type==="geojson"&&H[de].type==="geojson"&&Sr(ce,H,de)?ve.push({command:xr.setGeoJSONSourceData,args:[de,H[de].data]}):Ir(de,H,ve,K)):mr(de,H,ve))}function Ct(ce,H,ve,K,de,Se){ce=ce||{},H=H||{};var Ce;for(Ce in ce)!ce.hasOwnProperty(Ce)||e.deepEqual(ce[Ce],H[Ce])||ve.push({command:Se,args:[K,Ce,H[Ce],de]});for(Ce in H)!H.hasOwnProperty(Ce)||ce.hasOwnProperty(Ce)||e.deepEqual(ce[Ce],H[Ce])||ve.push({command:Se,args:[K,Ce,H[Ce],de]})}function Zt(ce){return ce.id}function ur(ce,H){return ce[H.id]=H,ce}function Lr(ce,H,ve){ce=ce||[],H=H||[];var K=ce.map(Zt),de=H.map(Zt),Se=ce.reduce(ur,{}),Ce=H.reduce(ur,{}),Xe=K.slice(),lt=Object.create(null),wt,Ht,nr,sr,Ar,Nr,Ur;for(wt=0,Ht=0;wt<K.length;wt++)nr=K[wt],Ce.hasOwnProperty(nr)?Ht++:(ve.push({command:xr.removeLayer,args:[nr]}),Xe.splice(Xe.indexOf(nr,Ht),1));for(wt=0,Ht=0;wt<de.length;wt++)nr=de[de.length-1-wt],Xe[Xe.length-1-wt]!==nr&&(Se.hasOwnProperty(nr)?(ve.push({command:xr.removeLayer,args:[nr]}),Xe.splice(Xe.lastIndexOf(nr,Xe.length-Ht),1)):Ht++,Nr=Xe[Xe.length-wt],ve.push({command:xr.addLayer,args:[Ce[nr],Nr]}),Xe.splice(Xe.length-wt,0,nr),lt[nr]=!0);for(wt=0;wt<de.length;wt++)if(nr=de[wt],sr=Se[nr],Ar=Ce[nr],!(lt[nr]||e.deepEqual(sr,Ar))){if(!e.deepEqual(sr.source,Ar.source)||!e.deepEqual(sr["source-layer"],Ar["source-layer"])||!e.deepEqual(sr.type,Ar.type)){ve.push({command:xr.removeLayer,args:[nr]}),Nr=Xe[Xe.lastIndexOf(nr)+1],ve.push({command:xr.addLayer,args:[Ar,Nr]});continue}Ct(sr.layout,Ar.layout,ve,nr,null,xr.setLayoutProperty),Ct(sr.paint,Ar.paint,ve,nr,null,xr.setPaintProperty),e.deepEqual(sr.filter,Ar.filter)||ve.push({command:xr.setFilter,args:[nr,Ar.filter]}),(!e.deepEqual(sr.minzoom,Ar.minzoom)||!e.deepEqual(sr.maxzoom,Ar.maxzoom))&&ve.push({command:xr.setLayerZoomRange,args:[nr,Ar.minzoom,Ar.maxzoom]});for(Ur in sr)!sr.hasOwnProperty(Ur)||Ur==="layout"||Ur==="paint"||Ur==="filter"||Ur==="metadata"||Ur==="minzoom"||Ur==="maxzoom"||(Ur.indexOf("paint.")===0?Ct(sr[Ur],Ar[Ur],ve,nr,Ur.slice(6),xr.setPaintProperty):e.deepEqual(sr[Ur],Ar[Ur])||ve.push({command:xr.setLayerProperty,args:[nr,Ur,Ar[Ur]]}));for(Ur in Ar)!Ar.hasOwnProperty(Ur)||sr.hasOwnProperty(Ur)||Ur==="layout"||Ur==="paint"||Ur==="filter"||Ur==="metadata"||Ur==="minzoom"||Ur==="maxzoom"||(Ur.indexOf("paint.")===0?Ct(sr[Ur],Ar[Ur],ve,nr,Ur.slice(6),xr.setPaintProperty):e.deepEqual(sr[Ur],Ar[Ur])||ve.push({command:xr.setLayerProperty,args:[nr,Ur,Ar[Ur]]}))}}function Br(ce,H){if(!ce)return[{command:xr.setStyle,args:[H]}];var ve=[];try{if(!e.deepEqual(ce.version,H.version))return[{command:xr.setStyle,args:[H]}];e.deepEqual(ce.center,H.center)||ve.push({command:xr.setCenter,args:[H.center]}),e.deepEqual(ce.zoom,H.zoom)||ve.push({command:xr.setZoom,args:[H.zoom]}),e.deepEqual(ce.bearing,H.bearing)||ve.push({command:xr.setBearing,args:[H.bearing]}),e.deepEqual(ce.pitch,H.pitch)||ve.push({command:xr.setPitch,args:[H.pitch]}),e.deepEqual(ce.sprite,H.sprite)||ve.push({command:xr.setSprite,args:[H.sprite]}),e.deepEqual(ce.glyphs,H.glyphs)||ve.push({command:xr.setGlyphs,args:[H.glyphs]}),e.deepEqual(ce.transition,H.transition)||ve.push({command:xr.setTransition,args:[H.transition]}),e.deepEqual(ce.light,H.light)||ve.push({command:xr.setLight,args:[H.light]});var K={},de=[];tt(ce.sources,H.sources,de,K);var Se=[];ce.layers&&ce.layers.forEach(function(Ce){K[Ce.source]?ve.push({command:xr.removeLayer,args:[Ce.id]}):Se.push(Ce)}),ve=ve.concat(de),Lr(Se,H.layers,ve)}catch(Ce){console.warn("Unable to compute style diff:",Ce),ve=[{command:xr.setStyle,args:[H]}]}return ve}var Pr=function(H,ve){this.reset(H,ve)};Pr.prototype.reset=function(H,ve){this.points=H||[],this._distances=[0];for(var K=1;K<this.points.length;K++)this._distances[K]=this._distances[K-1]+this.points[K].dist(this.points[K-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(ve||0,this.length*.5),this.paddedLength=this.length-this.padding*2},Pr.prototype.lerp=function(H){if(this.points.length===1)return this.points[0];H=e.clamp(H,0,1);for(var ve=1,K=this._distances[ve],de=H*this.paddedLength+this.padding;K<de&&ve<this._distances.length;)K=this._distances[++ve];var Se=ve-1,Ce=this._distances[Se],Xe=K-Ce,lt=Xe>0?(de-Ce)/Xe:0;return this.points[Se].mult(1-lt).add(this.points[ve].mult(lt))};var Tr=function(H,ve,K){var de=this.boxCells=[],Se=this.circleCells=[];this.xCellCount=Math.ceil(H/K),this.yCellCount=Math.ceil(ve/K);for(var Ce=0;Ce<this.xCellCount*this.yCellCount;Ce++)de.push([]),Se.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=H,this.height=ve,this.xScale=this.xCellCount/H,this.yScale=this.yCellCount/ve,this.boxUid=0,this.circleUid=0};Tr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Tr.prototype.insert=function(H,ve,K,de,Se){this._forEachCell(ve,K,de,Se,this._insertBoxCell,this.boxUid++),this.boxKeys.push(H),this.bboxes.push(ve),this.bboxes.push(K),this.bboxes.push(de),this.bboxes.push(Se)},Tr.prototype.insertCircle=function(H,ve,K,de){this._forEachCell(ve-de,K-de,ve+de,K+de,this._insertCircleCell,this.circleUid++),this.circleKeys.push(H),this.circles.push(ve),this.circles.push(K),this.circles.push(de)},Tr.prototype._insertBoxCell=function(H,ve,K,de,Se,Ce){this.boxCells[Se].push(Ce)},Tr.prototype._insertCircleCell=function(H,ve,K,de,Se,Ce){this.circleCells[Se].push(Ce)},Tr.prototype._query=function(H,ve,K,de,Se,Ce){if(K<0||H>this.width||de<0||ve>this.height)return Se?!1:[];var Xe=[];if(H<=0&&ve<=0&&this.width<=K&&this.height<=de){if(Se)return!0;for(var lt=0;lt<this.boxKeys.length;lt++)Xe.push({key:this.boxKeys[lt],x1:this.bboxes[lt*4],y1:this.bboxes[lt*4+1],x2:this.bboxes[lt*4+2],y2:this.bboxes[lt*4+3]});for(var wt=0;wt<this.circleKeys.length;wt++){var Ht=this.circles[wt*3],nr=this.circles[wt*3+1],sr=this.circles[wt*3+2];Xe.push({key:this.circleKeys[wt],x1:Ht-sr,y1:nr-sr,x2:Ht+sr,y2:nr+sr})}return Ce?Xe.filter(Ce):Xe}else{var Ar={hitTest:Se,seenUids:{box:{},circle:{}}};return this._forEachCell(H,ve,K,de,this._queryCell,Xe,Ar,Ce),Se?Xe.length>0:Xe}},Tr.prototype._queryCircle=function(H,ve,K,de,Se){var Ce=H-K,Xe=H+K,lt=ve-K,wt=ve+K;if(Xe<0||Ce>this.width||wt<0||lt>this.height)return de?!1:[];var Ht=[],nr={hitTest:de,circle:{x:H,y:ve,radius:K},seenUids:{box:{},circle:{}}};return this._forEachCell(Ce,lt,Xe,wt,this._queryCellCircle,Ht,nr,Se),de?Ht.length>0:Ht},Tr.prototype.query=function(H,ve,K,de,Se){return this._query(H,ve,K,de,!1,Se)},Tr.prototype.hitTest=function(H,ve,K,de,Se){return this._query(H,ve,K,de,!0,Se)},Tr.prototype.hitTestCircle=function(H,ve,K,de){return this._queryCircle(H,ve,K,!0,de)},Tr.prototype._queryCell=function(H,ve,K,de,Se,Ce,Xe,lt){var wt=Xe.seenUids,Ht=this.boxCells[Se];if(Ht!==null)for(var nr=this.bboxes,sr=0,Ar=Ht;sr<Ar.length;sr+=1){var Nr=Ar[sr];if(!wt.box[Nr]){wt.box[Nr]=!0;var Ur=Nr*4;if(H<=nr[Ur+2]&&ve<=nr[Ur+3]&&K>=nr[Ur+0]&&de>=nr[Ur+1]&&(!lt||lt(this.boxKeys[Nr]))){if(Xe.hitTest)return Ce.push(!0),!0;Ce.push({key:this.boxKeys[Nr],x1:nr[Ur],y1:nr[Ur+1],x2:nr[Ur+2],y2:nr[Ur+3]})}}}var Or=this.circleCells[Se];if(Or!==null)for(var Xr=this.circles,sn=0,Sn=Or;sn<Sn.length;sn+=1){var Fn=Sn[sn];if(!wt.circle[Fn]){wt.circle[Fn]=!0;var Xn=Fn*3;if(this._circleAndRectCollide(Xr[Xn],Xr[Xn+1],Xr[Xn+2],H,ve,K,de)&&(!lt||lt(this.circleKeys[Fn]))){if(Xe.hitTest)return Ce.push(!0),!0;var Qn=Xr[Xn],jn=Xr[Xn+1],ca=Xr[Xn+2];Ce.push({key:this.circleKeys[Fn],x1:Qn-ca,y1:jn-ca,x2:Qn+ca,y2:jn+ca})}}}},Tr.prototype._queryCellCircle=function(H,ve,K,de,Se,Ce,Xe,lt){var wt=Xe.circle,Ht=Xe.seenUids,nr=this.boxCells[Se];if(nr!==null)for(var sr=this.bboxes,Ar=0,Nr=nr;Ar<Nr.length;Ar+=1){var Ur=Nr[Ar];if(!Ht.box[Ur]){Ht.box[Ur]=!0;var Or=Ur*4;if(this._circleAndRectCollide(wt.x,wt.y,wt.radius,sr[Or+0],sr[Or+1],sr[Or+2],sr[Or+3])&&(!lt||lt(this.boxKeys[Ur])))return Ce.push(!0),!0}}var Xr=this.circleCells[Se];if(Xr!==null)for(var sn=this.circles,Sn=0,Fn=Xr;Sn<Fn.length;Sn+=1){var Xn=Fn[Sn];if(!Ht.circle[Xn]){Ht.circle[Xn]=!0;var Qn=Xn*3;if(this._circlesCollide(sn[Qn],sn[Qn+1],sn[Qn+2],wt.x,wt.y,wt.radius)&&(!lt||lt(this.circleKeys[Xn])))return Ce.push(!0),!0}}},Tr.prototype._forEachCell=function(H,ve,K,de,Se,Ce,Xe,lt){for(var wt=this._convertToXCellCoord(H),Ht=this._convertToYCellCoord(ve),nr=this._convertToXCellCoord(K),sr=this._convertToYCellCoord(de),Ar=wt;Ar<=nr;Ar++)for(var Nr=Ht;Nr<=sr;Nr++){var Ur=this.xCellCount*Nr+Ar;if(Se.call(this,H,ve,K,de,Ur,Ce,Xe,lt))return}},Tr.prototype._convertToXCellCoord=function(H){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(H*this.xScale)))},Tr.prototype._convertToYCellCoord=function(H){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(H*this.yScale)))},Tr.prototype._circlesCollide=function(H,ve,K,de,Se,Ce){var Xe=de-H,lt=Se-ve,wt=K+Ce;return wt*wt>Xe*Xe+lt*lt},Tr.prototype._circleAndRectCollide=function(H,ve,K,de,Se,Ce,Xe){var lt=(Ce-de)/2,wt=Math.abs(H-(de+lt));if(wt>lt+K)return!1;var Ht=(Xe-Se)/2,nr=Math.abs(ve-(Se+Ht));if(nr>Ht+K)return!1;if(wt<=lt||nr<=Ht)return!0;var sr=wt-lt,Ar=nr-Ht;return sr*sr+Ar*Ar<=K*K};function jr(ce,H,ve,K,de){var Se=e.create();return H?(e.scale(Se,Se,[1/de,1/de,1]),ve||e.rotateZ(Se,Se,K.angle)):e.multiply(Se,K.labelPlaneMatrix,ce),Se}function Pn(ce,H,ve,K,de){if(H){var Se=e.clone(ce);return e.scale(Se,Se,[de,de,1]),ve||e.rotateZ(Se,Se,-K.angle),Se}else return K.glCoordMatrix}function An(ce,H){var ve=[ce.x,ce.y,0,1];wr(ve,ve,H);var K=ve[3];return{point:new e.Point(ve[0]/K,ve[1]/K),signedDistanceFromCamera:K}}function $n(ce,H){return .5+.5*(ce/H)}function zn(ce,H){var ve=ce[0]/ce[3],K=ce[1]/ce[3],de=ve>=-H[0]&&ve<=H[0]&&K>=-H[1]&&K<=H[1];return de}function Yn(ce,H,ve,K,de,Se,Ce,Xe){var lt=K?ce.textSizeData:ce.iconSizeData,wt=e.evaluateSizeForZoom(lt,ve.transform.zoom),Ht=[256/ve.width*2+1,256/ve.height*2+1],nr=K?ce.text.dynamicLayoutVertexArray:ce.icon.dynamicLayoutVertexArray;nr.clear();for(var sr=ce.lineVertexArray,Ar=K?ce.text.placedSymbolArray:ce.icon.placedSymbolArray,Nr=ve.transform.width/ve.transform.height,Ur=!1,Or=0;Or<Ar.length;Or++){var Xr=Ar.get(Or);if(Xr.hidden||Xr.writingMode===e.WritingMode.vertical&&!Ur){Ga(Xr.numGlyphs,nr);continue}Ur=!1;var sn=[Xr.anchorX,Xr.anchorY,0,1];if(e.transformMat4(sn,sn,H),!zn(sn,Ht)){Ga(Xr.numGlyphs,nr);continue}var Sn=sn[3],Fn=$n(ve.transform.cameraToCenterDistance,Sn),Xn=e.evaluateSizeForFeature(lt,wt,Xr),Qn=Ce?Xn/Fn:Xn*Fn,jn=new e.Point(Xr.anchorX,Xr.anchorY),ca=An(jn,de).point,ba={},ya=Ua(Xr,Qn,!1,Xe,H,de,Se,ce.glyphOffsetArray,sr,nr,ca,jn,ba,Nr);Ur=ya.useVertical,(ya.notEnoughRoom||Ur||ya.needsFlipping&&Ua(Xr,Qn,!0,Xe,H,de,Se,ce.glyphOffsetArray,sr,nr,ca,jn,ba,Nr).notEnoughRoom)&&Ga(Xr.numGlyphs,nr)}K?ce.text.dynamicLayoutVertexBuffer.updateData(nr):ce.icon.dynamicLayoutVertexBuffer.updateData(nr)}function Kn(ce,H,ve,K,de,Se,Ce,Xe,lt,wt,Ht){var nr=Xe.glyphStartIndex+Xe.numGlyphs,sr=Xe.lineStartIndex,Ar=Xe.lineStartIndex+Xe.lineLength,Nr=H.getoffsetX(Xe.glyphStartIndex),Ur=H.getoffsetX(nr-1),Or=ci(ce*Nr,ve,K,de,Se,Ce,Xe.segment,sr,Ar,lt,wt,Ht);if(!Or)return null;var Xr=ci(ce*Ur,ve,K,de,Se,Ce,Xe.segment,sr,Ar,lt,wt,Ht);return Xr?{first:Or,last:Xr}:null}function Aa(ce,H,ve,K){if(ce===e.WritingMode.horizontal){var de=Math.abs(ve.y-H.y),Se=Math.abs(ve.x-H.x)*K;if(de>Se)return{useVertical:!0}}return(ce===e.WritingMode.vertical?H.y<ve.y:H.x>ve.x)?{needsFlipping:!0}:null}function Ua(ce,H,ve,K,de,Se,Ce,Xe,lt,wt,Ht,nr,sr,Ar){var Nr=H/24,Ur=ce.lineOffsetX*Nr,Or=ce.lineOffsetY*Nr,Xr;if(ce.numGlyphs>1){var sn=ce.glyphStartIndex+ce.numGlyphs,Sn=ce.lineStartIndex,Fn=ce.lineStartIndex+ce.lineLength,Xn=Kn(Nr,Xe,Ur,Or,ve,Ht,nr,ce,lt,Se,sr);if(!Xn)return{notEnoughRoom:!0};var Qn=An(Xn.first.point,Ce).point,jn=An(Xn.last.point,Ce).point;if(K&&!ve){var ca=Aa(ce.writingMode,Qn,jn,Ar);if(ca)return ca}Xr=[Xn.first];for(var ba=ce.glyphStartIndex+1;ba<sn-1;ba++)Xr.push(ci(Nr*Xe.getoffsetX(ba),Ur,Or,ve,Ht,nr,ce.segment,Sn,Fn,lt,Se,sr));Xr.push(Xn.last)}else{if(K&&!ve){var ya=An(nr,de).point,Ta=ce.lineStartIndex+ce.segment+1,Ca=new e.Point(lt.getx(Ta),lt.gety(Ta)),Ha=An(Ca,de),ri=Ha.signedDistanceFromCamera>0?Ha.point:vi(nr,Ca,ya,1,de),Di=Aa(ce.writingMode,ya,ri,Ar);if(Di)return Di}var li=ci(Nr*Xe.getoffsetX(ce.glyphStartIndex),Ur,Or,ve,Ht,nr,ce.segment,ce.lineStartIndex,ce.lineStartIndex+ce.lineLength,lt,Se,sr);if(!li)return{notEnoughRoom:!0};Xr=[li]}for(var gi=0,Ba=Xr;gi<Ba.length;gi+=1){var Ri=Ba[gi];e.addDynamicAttributes(wt,Ri.point,Ri.angle)}return{}}function vi(ce,H,ve,K,de){var Se=An(ce.add(ce.sub(H)._unit()),de).point,Ce=ve.sub(Se);return ve.add(Ce._mult(K/Ce.mag()))}function ci(ce,H,ve,K,de,Se,Ce,Xe,lt,wt,Ht,nr){var sr=K?ce-H:ce+H,Ar=sr>0?1:-1,Nr=0;K&&(Ar*=-1,Nr=Math.PI),Ar<0&&(Nr+=Math.PI);for(var Ur=Ar>0?Xe+Ce:Xe+Ce+1,Or=de,Xr=de,sn=0,Sn=0,Fn=Math.abs(sr),Xn=[];sn+Sn<=Fn;){if(Ur+=Ar,Ur<Xe||Ur>=lt)return null;if(Xr=Or,Xn.push(Or),Or=nr[Ur],Or===void 0){var Qn=new e.Point(wt.getx(Ur),wt.gety(Ur)),jn=An(Qn,Ht);if(jn.signedDistanceFromCamera>0)Or=nr[Ur]=jn.point;else{var ca=Ur-Ar,ba=sn===0?Se:new e.Point(wt.getx(ca),wt.gety(ca));Or=vi(ba,Qn,Xr,Fn-sn+1,Ht)}}sn+=Sn,Sn=Xr.dist(Or)}var ya=(Fn-sn)/Sn,Ta=Or.sub(Xr),Ca=Ta.mult(ya)._add(Xr);Ca._add(Ta._unit()._perp()._mult(ve*Ar));var Ha=Nr+Math.atan2(Or.y-Xr.y,Or.x-Xr.x);return Xn.push(Ca),{point:Ca,angle:Ha,path:Xn}}var ui=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ga(ce,H){for(var ve=0;ve<ce;ve++){var K=H.length;H.resize(K+4),H.float32.set(ui,K*3)}}function wr(ce,H,ve){var K=H[0],de=H[1];return ce[0]=ve[0]*K+ve[4]*de+ve[12],ce[1]=ve[1]*K+ve[5]*de+ve[13],ce[3]=ve[3]*K+ve[7]*de+ve[15],ce}var vn=100,on=function(H,ve,K){ve===void 0&&(ve=new Tr(H.width+2*vn,H.height+2*vn,25)),K===void 0&&(K=new Tr(H.width+2*vn,H.height+2*vn,25)),this.transform=H,this.grid=ve,this.ignoredGrid=K,this.pitchfactor=Math.cos(H._pitch)*H.cameraToCenterDistance,this.screenRightBoundary=H.width+vn,this.screenBottomBoundary=H.height+vn,this.gridRightBoundary=H.width+2*vn,this.gridBottomBoundary=H.height+2*vn};on.prototype.placeCollisionBox=function(H,ve,K,de,Se){var Ce=this.projectAndGetPerspectiveRatio(de,H.anchorPointX,H.anchorPointY),Xe=K*Ce.perspectiveRatio,lt=H.x1*Xe+Ce.point.x,wt=H.y1*Xe+Ce.point.y,Ht=H.x2*Xe+Ce.point.x,nr=H.y2*Xe+Ce.point.y;return!this.isInsideGrid(lt,wt,Ht,nr)||!ve&&this.grid.hitTest(lt,wt,Ht,nr,Se)?{box:[],offscreen:!1}:{box:[lt,wt,Ht,nr],offscreen:this.isOffscreen(lt,wt,Ht,nr)}},on.prototype.placeCollisionCircles=function(H,ve,K,de,Se,Ce,Xe,lt,wt,Ht,nr,sr,Ar){var Nr=[],Ur=new e.Point(ve.anchorX,ve.anchorY),Or=An(Ur,Ce),Xr=$n(this.transform.cameraToCenterDistance,Or.signedDistanceFromCamera),sn=Ht?Se/Xr:Se*Xr,Sn=sn/e.ONE_EM,Fn=An(Ur,Xe).point,Xn={},Qn=ve.lineOffsetX*Sn,jn=ve.lineOffsetY*Sn,ca=Kn(Sn,de,Qn,jn,!1,Fn,Ur,ve,K,Xe,Xn),ba=!1,ya=!1,Ta=!0;if(ca){for(var Ca=sr*.5*Xr+Ar,Ha=new e.Point(-vn,-vn),ri=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),Di=new Pr,li=ca.first,gi=ca.last,Ba=[],Ri=li.path.length-1;Ri>=1;Ri--)Ba.push(li.path[Ri]);for(var Oi=1;Oi<gi.path.length;Oi++)Ba.push(gi.path[Oi]);var Vi=Ca*2.5;if(lt){var Ti=Ba.map(function(ru){return An(ru,lt)});Ti.some(function(ru){return ru.signedDistanceFromCamera<=0})?Ba=[]:Ba=Ti.map(function(ru){return ru.point})}var Ji=[];if(Ba.length>0){for(var ai=Ba[0].clone(),Ai=Ba[0].clone(),To=1;To<Ba.length;To++)ai.x=Math.min(ai.x,Ba[To].x),ai.y=Math.min(ai.y,Ba[To].y),Ai.x=Math.max(Ai.x,Ba[To].x),Ai.y=Math.max(Ai.y,Ba[To].y);ai.x>=Ha.x&&Ai.x<=ri.x&&ai.y>=Ha.y&&Ai.y<=ri.y?Ji=[Ba]:Ai.x<Ha.x||ai.x>ri.x||Ai.y<Ha.y||ai.y>ri.y?Ji=[]:Ji=e.clipLine([Ba],Ha.x,Ha.y,ri.x,ri.y)}for(var No=0,Sl=Ji;No<Sl.length;No+=1){var kl=Sl[No];Di.reset(kl,Ca*.25);var $l=0;Di.length<=.5*Ca?$l=1:$l=Math.ceil(Di.paddedLength/Vi)+1;for(var ql=0;ql<$l;ql++){var _u=ql/Math.max($l-1,1),eu=Di.lerp(_u),Ns=eu.x+vn,Hu=eu.y+vn;Nr.push(Ns,Hu,Ca,0);var _s=Ns-Ca,cl=Hu-Ca,tu=Ns+Ca,Hl=Hu+Ca;if(Ta=Ta&&this.isOffscreen(_s,cl,tu,Hl),ya=ya||this.isInsideGrid(_s,cl,tu,Hl),!H&&this.grid.hitTestCircle(Ns,Hu,Ca,nr)&&(ba=!0,!wt))return{circles:[],offscreen:!1,collisionDetected:ba}}}}return{circles:!wt&&ba||!ya?[]:Nr,offscreen:Ta,collisionDetected:ba}},on.prototype.queryRenderedSymbols=function(H){if(H.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var ve=[],K=1/0,de=1/0,Se=-1/0,Ce=-1/0,Xe=0,lt=H;Xe<lt.length;Xe+=1){var wt=lt[Xe],Ht=new e.Point(wt.x+vn,wt.y+vn);K=Math.min(K,Ht.x),de=Math.min(de,Ht.y),Se=Math.max(Se,Ht.x),Ce=Math.max(Ce,Ht.y),ve.push(Ht)}for(var nr=this.grid.query(K,de,Se,Ce).concat(this.ignoredGrid.query(K,de,Se,Ce)),sr={},Ar={},Nr=0,Ur=nr;Nr<Ur.length;Nr+=1){var Or=Ur[Nr],Xr=Or.key;if(sr[Xr.bucketInstanceId]===void 0&&(sr[Xr.bucketInstanceId]={}),!sr[Xr.bucketInstanceId][Xr.featureIndex]){var sn=[new e.Point(Or.x1,Or.y1),new e.Point(Or.x2,Or.y1),new e.Point(Or.x2,Or.y2),new e.Point(Or.x1,Or.y2)];!e.polygonIntersectsPolygon(ve,sn)||(sr[Xr.bucketInstanceId][Xr.featureIndex]=!0,Ar[Xr.bucketInstanceId]===void 0&&(Ar[Xr.bucketInstanceId]=[]),Ar[Xr.bucketInstanceId].push(Xr.featureIndex))}}return Ar},on.prototype.insertCollisionBox=function(H,ve,K,de,Se){var Ce=ve?this.ignoredGrid:this.grid,Xe={bucketInstanceId:K,featureIndex:de,collisionGroupID:Se};Ce.insert(Xe,H[0],H[1],H[2],H[3])},on.prototype.insertCollisionCircles=function(H,ve,K,de,Se){for(var Ce=ve?this.ignoredGrid:this.grid,Xe={bucketInstanceId:K,featureIndex:de,collisionGroupID:Se},lt=0;lt<H.length;lt+=4)Ce.insertCircle(Xe,H[lt],H[lt+1],H[lt+2])},on.prototype.projectAndGetPerspectiveRatio=function(H,ve,K){var de=[ve,K,0,1];wr(de,de,H);var Se=new e.Point((de[0]/de[3]+1)/2*this.transform.width+vn,(-de[1]/de[3]+1)/2*this.transform.height+vn);return{point:Se,perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/de[3])}},on.prototype.isOffscreen=function(H,ve,K,de){return K<vn||H>=this.screenRightBoundary||de<vn||ve>this.screenBottomBoundary},on.prototype.isInsideGrid=function(H,ve,K,de){return K>=0&&H<this.gridRightBoundary&&de>=0&&ve<this.gridBottomBoundary},on.prototype.getViewportMatrix=function(){var H=e.identity([]);return e.translate(H,H,[-vn,-vn,0]),H};function _n(ce,H,ve){return H*(e.EXTENT/(ce.tileSize*Math.pow(2,ve-ce.tileID.overscaledZ)))}var Bn=function(H,ve,K,de){H?this.opacity=Math.max(0,Math.min(1,H.opacity+(H.placed?ve:-ve))):this.opacity=de&&K?1:0,this.placed=K};Bn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var sa=function(H,ve,K,de,Se){this.text=new Bn(H?H.text:null,ve,K,Se),this.icon=new Bn(H?H.icon:null,ve,de,Se)};sa.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var ra=function(H,ve,K){this.text=H,this.icon=ve,this.skipFade=K},In=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},ea=function(H,ve,K,de,Se){this.bucketInstanceId=H,this.featureIndex=ve,this.sourceLayerIndex=K,this.bucketIndex=de,this.tileID=Se},Va=function(H){this.crossSourceCollisions=H,this.maxGroupID=0,this.collisionGroups={}};Va.prototype.get=function(H){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[H]){var ve=++this.maxGroupID;this.collisionGroups[H]={ID:ve,predicate:function(K){return K.collisionGroupID===ve}}}return this.collisionGroups[H]};function hi(ce,H,ve,K,de){var Se=e.getAnchorAlignment(ce),Ce=Se.horizontalAlign,Xe=Se.verticalAlign,lt=-(Ce-.5)*H,wt=-(Xe-.5)*ve,Ht=e.evaluateVariableOffset(ce,K);return new e.Point(lt+Ht[0]*de,wt+Ht[1]*de)}function It(ce,H,ve,K,de,Se){var Ce=ce.x1,Xe=ce.x2,lt=ce.y1,wt=ce.y2,Ht=ce.anchorPointX,nr=ce.anchorPointY,sr=new e.Point(H,ve);return K&&sr._rotate(de?Se:-Se),{x1:Ce+sr.x,y1:lt+sr.y,x2:Xe+sr.x,y2:wt+sr.y,anchorPointX:Ht,anchorPointY:nr}}var vr=function(H,ve,K,de){this.transform=H.clone(),this.collisionIndex=new on(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=ve,this.retainedQueryData={},this.collisionGroups=new Va(K),this.collisionCircleArrays={},this.prevPlacement=de,de&&(de.prevPlacement=void 0),this.placedOrientations={}};vr.prototype.getBucketParts=function(H,ve,K,de){var Se=K.getBucket(ve),Ce=K.latestFeatureIndex;if(!(!Se||!Ce||ve.id!==Se.layerIds[0])){var Xe=K.collisionBoxArray,lt=Se.layers[0].layout,wt=Math.pow(2,this.transform.zoom-K.tileID.overscaledZ),Ht=K.tileSize/e.EXTENT,nr=this.transform.calculatePosMatrix(K.tileID.toUnwrapped()),sr=lt.get("text-pitch-alignment")==="map",Ar=lt.get("text-rotation-alignment")==="map",Nr=_n(K,1,this.transform.zoom),Ur=jr(nr,sr,Ar,this.transform,Nr),Or=null;if(sr){var Xr=Pn(nr,sr,Ar,this.transform,Nr);Or=e.multiply([],this.transform.labelPlaneMatrix,Xr)}this.retainedQueryData[Se.bucketInstanceId]=new ea(Se.bucketInstanceId,Ce,Se.sourceLayerIndex,Se.index,K.tileID);var sn={bucket:Se,layout:lt,posMatrix:nr,textLabelPlaneMatrix:Ur,labelToScreenMatrix:Or,scale:wt,textPixelRatio:Ht,holdingForFade:K.holdingForFade(),collisionBoxArray:Xe,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(Se.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(Se.sourceID)};if(de)for(var Sn=0,Fn=Se.sortKeyRanges;Sn<Fn.length;Sn+=1){var Xn=Fn[Sn],Qn=Xn.sortKey,jn=Xn.symbolInstanceStart,ca=Xn.symbolInstanceEnd;H.push({sortKey:Qn,symbolInstanceStart:jn,symbolInstanceEnd:ca,parameters:sn})}else H.push({symbolInstanceStart:0,symbolInstanceEnd:Se.symbolInstances.length,parameters:sn})}},vr.prototype.attemptAnchorPlacement=function(H,ve,K,de,Se,Ce,Xe,lt,wt,Ht,nr,sr,Ar,Nr,Ur){var Or=[sr.textOffset0,sr.textOffset1],Xr=hi(H,K,de,Or,Se),sn=this.collisionIndex.placeCollisionBox(It(ve,Xr.x,Xr.y,Ce,Xe,this.transform.angle),nr,lt,wt,Ht.predicate);if(Ur){var Sn=this.collisionIndex.placeCollisionBox(It(Ur,Xr.x,Xr.y,Ce,Xe,this.transform.angle),nr,lt,wt,Ht.predicate);if(Sn.box.length===0)return}if(sn.box.length>0){var Fn;return this.prevPlacement&&this.prevPlacement.variableOffsets[sr.crossTileID]&&this.prevPlacement.placements[sr.crossTileID]&&this.prevPlacement.placements[sr.crossTileID].text&&(Fn=this.prevPlacement.variableOffsets[sr.crossTileID].anchor),this.variableOffsets[sr.crossTileID]={textOffset:Or,width:K,height:de,anchor:H,textBoxScale:Se,prevAnchor:Fn},this.markUsedJustification(Ar,H,sr,Nr),Ar.allowVerticalPlacement&&(this.markUsedOrientation(Ar,Nr,sr),this.placedOrientations[sr.crossTileID]=Nr),{shift:Xr,placedGlyphBoxes:sn}}},vr.prototype.placeLayerBucketPart=function(H,ve,K){var de=this,Se=H.parameters,Ce=Se.bucket,Xe=Se.layout,lt=Se.posMatrix,wt=Se.textLabelPlaneMatrix,Ht=Se.labelToScreenMatrix,nr=Se.textPixelRatio,sr=Se.holdingForFade,Ar=Se.collisionBoxArray,Nr=Se.partiallyEvaluatedTextSize,Ur=Se.collisionGroup,Or=Xe.get("text-optional"),Xr=Xe.get("icon-optional"),sn=Xe.get("text-allow-overlap"),Sn=Xe.get("icon-allow-overlap"),Fn=Xe.get("text-rotation-alignment")==="map",Xn=Xe.get("text-pitch-alignment")==="map",Qn=Xe.get("icon-text-fit")!=="none",jn=Xe.get("symbol-z-order")==="viewport-y",ca=sn&&(Sn||!Ce.hasIconData()||Xr),ba=Sn&&(sn||!Ce.hasTextData()||Or);!Ce.collisionArrays&&Ar&&Ce.deserializeCollisionBoxes(Ar);var ya=function(li,gi){if(!ve[li.crossTileID]){if(sr){de.placements[li.crossTileID]=new ra(!1,!1,!1);return}var Ba=!1,Ri=!1,Oi=!0,Vi=null,Ti={box:null,offscreen:null},Ji={box:null,offscreen:null},ai=null,Ai=null,To=null,No=0,Sl=0,kl=0;gi.textFeatureIndex?No=gi.textFeatureIndex:li.useRuntimeCollisionCircles&&(No=li.featureIndex),gi.verticalTextFeatureIndex&&(Sl=gi.verticalTextFeatureIndex);var $l=gi.textBox;if($l){var ql=function(Lo){var qs=e.WritingMode.horizontal;if(Ce.allowVerticalPlacement&&!Lo&&de.prevPlacement){var el=de.prevPlacement.placedOrientations[li.crossTileID];el&&(de.placedOrientations[li.crossTileID]=el,qs=el,de.markUsedOrientation(Ce,qs,li))}return qs},_u=function(Lo,qs){if(Ce.allowVerticalPlacement&&li.numVerticalGlyphVertices>0&&gi.verticalTextBox)for(var el=0,If=Ce.writingModes;el<If.length;el+=1){var ic=If[el];if(ic===e.WritingMode.vertical?(Ti=qs(),Ji=Ti):Ti=Lo(),Ti&&Ti.box&&Ti.box.length)break}else Ti=Lo()};if(Xe.get("text-variable-anchor")){var _s=Xe.get("text-variable-anchor");if(de.prevPlacement&&de.prevPlacement.variableOffsets[li.crossTileID]){var cl=de.prevPlacement.variableOffsets[li.crossTileID];_s.indexOf(cl.anchor)>0&&(_s=_s.filter(function(Lo){return Lo!==cl.anchor}),_s.unshift(cl.anchor))}var tu=function(Lo,qs,el){for(var If=Lo.x2-Lo.x1,ic=Lo.y2-Lo.y1,ih=li.textBoxScale,oh=Qn&&!Sn?qs:null,bf={box:[],offscreen:!1},sh=sn?_s.length*2:_s.length,zf=0;zf<sh;++zf){var lh=_s[zf%_s.length],uh=zf>=_s.length,oc=de.attemptAnchorPlacement(lh,Lo,If,ic,ih,Fn,Xn,nr,lt,Ur,uh,li,Ce,el,oh);if(oc&&(bf=oc.placedGlyphBoxes,bf&&bf.box&&bf.box.length)){Ba=!0,Vi=oc.shift;break}}return bf},Hl=function(){return tu($l,gi.iconBox,e.WritingMode.horizontal)},ru=function(){var Lo=gi.verticalTextBox,qs=Ti&&Ti.box&&Ti.box.length;return Ce.allowVerticalPlacement&&!qs&&li.numVerticalGlyphVertices>0&&Lo?tu(Lo,gi.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}};_u(Hl,ru),Ti&&(Ba=Ti.box,Oi=Ti.offscreen);var Lf=ql(Ti&&Ti.box);if(!Ba&&de.prevPlacement){var Zu=de.prevPlacement.variableOffsets[li.crossTileID];Zu&&(de.variableOffsets[li.crossTileID]=Zu,de.markUsedJustification(Ce,Zu.anchor,li,Lf))}}else{var eu=function(Lo,qs){var el=de.collisionIndex.placeCollisionBox(Lo,sn,nr,lt,Ur.predicate);return el&&el.box&&el.box.length&&(de.markUsedOrientation(Ce,qs,li),de.placedOrientations[li.crossTileID]=qs),el},Ns=function(){return eu($l,e.WritingMode.horizontal)},Hu=function(){var Lo=gi.verticalTextBox;return Ce.allowVerticalPlacement&&li.numVerticalGlyphVertices>0&&Lo?eu(Lo,e.WritingMode.vertical):{box:null,offscreen:null}};_u(Ns,Hu),ql(Ti&&Ti.box&&Ti.box.length)}}if(ai=Ti,Ba=ai&&ai.box&&ai.box.length>0,Oi=ai&&ai.offscreen,li.useRuntimeCollisionCircles){var hs=Ce.text.placedSymbolArray.get(li.centerJustifiedTextSymbolIndex),mf=e.evaluateSizeForFeature(Ce.textSizeData,Nr,hs),Cs=Xe.get("text-padding"),xf=li.collisionCircleDiameter;Ai=de.collisionIndex.placeCollisionCircles(sn,hs,Ce.lineVertexArray,Ce.glyphOffsetArray,mf,lt,wt,Ht,K,Xn,Ur.predicate,xf,Cs),Ba=sn||Ai.circles.length>0&&!Ai.collisionDetected,Oi=Oi&&Ai.offscreen}if(gi.iconFeatureIndex&&(kl=gi.iconFeatureIndex),gi.iconBox){var Pf=function(Lo){var qs=Qn&&Vi?It(Lo,Vi.x,Vi.y,Fn,Xn,de.transform.angle):Lo;return de.collisionIndex.placeCollisionBox(qs,Sn,nr,lt,Ur.predicate)};Ji&&Ji.box&&Ji.box.length&&gi.verticalIconBox?(To=Pf(gi.verticalIconBox),Ri=To.box.length>0):(To=Pf(gi.iconBox),Ri=To.box.length>0),Oi=Oi&&To.offscreen}var Df=Or||li.numHorizontalGlyphVertices===0&&li.numVerticalGlyphVertices===0,Pc=Xr||li.numIconVertices===0;if(!Df&&!Pc?Ri=Ba=Ri&&Ba:Pc?Df||(Ri=Ri&&Ba):Ba=Ri&&Ba,Ba&&ai&&ai.box&&(Ji&&Ji.box&&Sl?de.collisionIndex.insertCollisionBox(ai.box,Xe.get("text-ignore-placement"),Ce.bucketInstanceId,Sl,Ur.ID):de.collisionIndex.insertCollisionBox(ai.box,Xe.get("text-ignore-placement"),Ce.bucketInstanceId,No,Ur.ID)),Ri&&To&&de.collisionIndex.insertCollisionBox(To.box,Xe.get("icon-ignore-placement"),Ce.bucketInstanceId,kl,Ur.ID),Ai&&(Ba&&de.collisionIndex.insertCollisionCircles(Ai.circles,Xe.get("text-ignore-placement"),Ce.bucketInstanceId,No,Ur.ID),K)){var Rf=Ce.bucketInstanceId,af=de.collisionCircleArrays[Rf];af===void 0&&(af=de.collisionCircleArrays[Rf]=new In);for(var of=0;of<Ai.circles.length;of+=4)af.circles.push(Ai.circles[of+0]),af.circles.push(Ai.circles[of+1]),af.circles.push(Ai.circles[of+2]),af.circles.push(Ai.collisionDetected?1:0)}de.placements[li.crossTileID]=new ra(Ba||ca,Ri||ba,Oi||Ce.justReloaded),ve[li.crossTileID]=!0}};if(jn)for(var Ta=Ce.getSortedSymbolIndexes(this.transform.angle),Ca=Ta.length-1;Ca>=0;--Ca){var Ha=Ta[Ca];ya(Ce.symbolInstances.get(Ha),Ce.collisionArrays[Ha])}else for(var ri=H.symbolInstanceStart;ri<H.symbolInstanceEnd;ri++)ya(Ce.symbolInstances.get(ri),Ce.collisionArrays[ri]);if(K&&Ce.bucketInstanceId in this.collisionCircleArrays){var Di=this.collisionCircleArrays[Ce.bucketInstanceId];e.invert(Di.invProjMatrix,lt),Di.viewportMatrix=this.collisionIndex.getViewportMatrix()}Ce.justReloaded=!1},vr.prototype.markUsedJustification=function(H,ve,K,de){var Se={left:K.leftJustifiedTextSymbolIndex,center:K.centerJustifiedTextSymbolIndex,right:K.rightJustifiedTextSymbolIndex},Ce;de===e.WritingMode.vertical?Ce=K.verticalPlacedTextSymbolIndex:Ce=Se[e.getAnchorJustification(ve)];for(var Xe=[K.leftJustifiedTextSymbolIndex,K.centerJustifiedTextSymbolIndex,K.rightJustifiedTextSymbolIndex,K.verticalPlacedTextSymbolIndex],lt=0,wt=Xe;lt<wt.length;lt+=1){var Ht=wt[lt];Ht>=0&&(Ce>=0&&Ht!==Ce?H.text.placedSymbolArray.get(Ht).crossTileID=0:H.text.placedSymbolArray.get(Ht).crossTileID=K.crossTileID)}},vr.prototype.markUsedOrientation=function(H,ve,K){for(var de=ve===e.WritingMode.horizontal||ve===e.WritingMode.horizontalOnly?ve:0,Se=ve===e.WritingMode.vertical?ve:0,Ce=[K.leftJustifiedTextSymbolIndex,K.centerJustifiedTextSymbolIndex,K.rightJustifiedTextSymbolIndex],Xe=0,lt=Ce;Xe<lt.length;Xe+=1){var wt=lt[Xe];H.text.placedSymbolArray.get(wt).placedOrientation=de}K.verticalPlacedTextSymbolIndex&&(H.text.placedSymbolArray.get(K.verticalPlacedTextSymbolIndex).placedOrientation=Se)},vr.prototype.commit=function(H){this.commitTime=H,this.zoomAtLastRecencyCheck=this.transform.zoom;var ve=this.prevPlacement,K=!1;this.prevZoomAdjustment=ve?ve.zoomAdjustment(this.transform.zoom):0;var de=ve?ve.symbolFadeChange(H):1,Se=ve?ve.opacities:{},Ce=ve?ve.variableOffsets:{},Xe=ve?ve.placedOrientations:{};for(var lt in this.placements){var wt=this.placements[lt],Ht=Se[lt];Ht?(this.opacities[lt]=new sa(Ht,de,wt.text,wt.icon),K=K||wt.text!==Ht.text.placed||wt.icon!==Ht.icon.placed):(this.opacities[lt]=new sa(null,de,wt.text,wt.icon,wt.skipFade),K=K||wt.text||wt.icon)}for(var nr in Se){var sr=Se[nr];if(!this.opacities[nr]){var Ar=new sa(sr,de,!1,!1);Ar.isHidden()||(this.opacities[nr]=Ar,K=K||sr.text.placed||sr.icon.placed)}}for(var Nr in Ce)!this.variableOffsets[Nr]&&this.opacities[Nr]&&!this.opacities[Nr].isHidden()&&(this.variableOffsets[Nr]=Ce[Nr]);for(var Ur in Xe)!this.placedOrientations[Ur]&&this.opacities[Ur]&&!this.opacities[Ur].isHidden()&&(this.placedOrientations[Ur]=Xe[Ur]);K?this.lastPlacementChangeTime=H:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=ve?ve.lastPlacementChangeTime:H)},vr.prototype.updateLayerOpacities=function(H,ve){for(var K={},de=0,Se=ve;de<Se.length;de+=1){var Ce=Se[de],Xe=Ce.getBucket(H);Xe&&Ce.latestFeatureIndex&&H.id===Xe.layerIds[0]&&this.updateBucketOpacities(Xe,K,Ce.collisionBoxArray)}},vr.prototype.updateBucketOpacities=function(H,ve,K){var de=this;H.hasTextData()&&H.text.opacityVertexArray.clear(),H.hasIconData()&&H.icon.opacityVertexArray.clear(),H.hasIconCollisionBoxData()&&H.iconCollisionBox.collisionVertexArray.clear(),H.hasTextCollisionBoxData()&&H.textCollisionBox.collisionVertexArray.clear();var Se=H.layers[0].layout,Ce=new sa(null,0,!1,!1,!0),Xe=Se.get("text-allow-overlap"),lt=Se.get("icon-allow-overlap"),wt=Se.get("text-variable-anchor"),Ht=Se.get("text-rotation-alignment")==="map",nr=Se.get("text-pitch-alignment")==="map",sr=Se.get("icon-text-fit")!=="none",Ar=new sa(null,0,Xe&&(lt||!H.hasIconData()||Se.get("icon-optional")),lt&&(Xe||!H.hasTextData()||Se.get("text-optional")),!0);!H.collisionArrays&&K&&(H.hasIconCollisionBoxData()||H.hasTextCollisionBoxData())&&H.deserializeCollisionBoxes(K);for(var Nr=function(sn,Sn,Fn){for(var Xn=0;Xn<Sn/4;Xn++)sn.opacityVertexArray.emplaceBack(Fn)},Ur=function(sn){var Sn=H.symbolInstances.get(sn),Fn=Sn.numHorizontalGlyphVertices,Xn=Sn.numVerticalGlyphVertices,Qn=Sn.crossTileID,jn=ve[Qn],ca=de.opacities[Qn];jn?ca=Ce:ca||(ca=Ar,de.opacities[Qn]=ca),ve[Qn]=!0;var ba=Fn>0||Xn>0,ya=Sn.numIconVertices>0,Ta=de.placedOrientations[Sn.crossTileID],Ca=Ta===e.WritingMode.vertical,Ha=Ta===e.WritingMode.horizontal||Ta===e.WritingMode.horizontalOnly;if(ba){var ri=Cr(ca.text),Di=Ca?dn:ri;Nr(H.text,Fn,Di);var li=Ha?dn:ri;Nr(H.text,Xn,li);var gi=ca.text.isHidden();[Sn.rightJustifiedTextSymbolIndex,Sn.centerJustifiedTextSymbolIndex,Sn.leftJustifiedTextSymbolIndex].forEach(function(kl){kl>=0&&(H.text.placedSymbolArray.get(kl).hidden=gi||Ca?1:0)}),Sn.verticalPlacedTextSymbolIndex>=0&&(H.text.placedSymbolArray.get(Sn.verticalPlacedTextSymbolIndex).hidden=gi||Ha?1:0);var Ba=de.variableOffsets[Sn.crossTileID];Ba&&de.markUsedJustification(H,Ba.anchor,Sn,Ta);var Ri=de.placedOrientations[Sn.crossTileID];Ri&&(de.markUsedJustification(H,"left",Sn,Ri),de.markUsedOrientation(H,Ri,Sn))}if(ya){var Oi=Cr(ca.icon),Vi=!(sr&&Sn.verticalPlacedIconSymbolIndex&&Ca);if(Sn.placedIconSymbolIndex>=0){var Ti=Vi?Oi:dn;Nr(H.icon,Sn.numIconVertices,Ti),H.icon.placedSymbolArray.get(Sn.placedIconSymbolIndex).hidden=ca.icon.isHidden()}if(Sn.verticalPlacedIconSymbolIndex>=0){var Ji=Vi?dn:Oi;Nr(H.icon,Sn.numVerticalIconVertices,Ji),H.icon.placedSymbolArray.get(Sn.verticalPlacedIconSymbolIndex).hidden=ca.icon.isHidden()}}if(H.hasIconCollisionBoxData()||H.hasTextCollisionBoxData()){var ai=H.collisionArrays[sn];if(ai){var Ai=new e.Point(0,0);if(ai.textBox||ai.verticalTextBox){var To=!0;if(wt){var No=de.variableOffsets[Qn];No?(Ai=hi(No.anchor,No.width,No.height,No.textOffset,No.textBoxScale),Ht&&Ai._rotate(nr?de.transform.angle:-de.transform.angle)):To=!1}ai.textBox&&rn(H.textCollisionBox.collisionVertexArray,ca.text.placed,!To||Ca,Ai.x,Ai.y),ai.verticalTextBox&&rn(H.textCollisionBox.collisionVertexArray,ca.text.placed,!To||Ha,Ai.x,Ai.y)}var Sl=Boolean(!Ha&&ai.verticalIconBox);ai.iconBox&&rn(H.iconCollisionBox.collisionVertexArray,ca.icon.placed,Sl,sr?Ai.x:0,sr?Ai.y:0),ai.verticalIconBox&&rn(H.iconCollisionBox.collisionVertexArray,ca.icon.placed,!Sl,sr?Ai.x:0,sr?Ai.y:0)}}},Or=0;Or<H.symbolInstances.length;Or++)Ur(Or);if(H.sortFeatures(this.transform.angle),this.retainedQueryData[H.bucketInstanceId]&&(this.retainedQueryData[H.bucketInstanceId].featureSortOrder=H.featureSortOrder),H.hasTextData()&&H.text.opacityVertexBuffer&&H.text.opacityVertexBuffer.updateData(H.text.opacityVertexArray),H.hasIconData()&&H.icon.opacityVertexBuffer&&H.icon.opacityVertexBuffer.updateData(H.icon.opacityVertexArray),H.hasIconCollisionBoxData()&&H.iconCollisionBox.collisionVertexBuffer&&H.iconCollisionBox.collisionVertexBuffer.updateData(H.iconCollisionBox.collisionVertexArray),H.hasTextCollisionBoxData()&&H.textCollisionBox.collisionVertexBuffer&&H.textCollisionBox.collisionVertexBuffer.updateData(H.textCollisionBox.collisionVertexArray),H.bucketInstanceId in this.collisionCircleArrays){var Xr=this.collisionCircleArrays[H.bucketInstanceId];H.placementInvProjMatrix=Xr.invProjMatrix,H.placementViewportMatrix=Xr.viewportMatrix,H.collisionCircleArray=Xr.circles,delete this.collisionCircleArrays[H.bucketInstanceId]}},vr.prototype.symbolFadeChange=function(H){return this.fadeDuration===0?1:(H-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},vr.prototype.zoomAdjustment=function(H){return Math.max(0,(this.transform.zoom-H)/1.5)},vr.prototype.hasTransitions=function(H){return this.stale||H-this.lastPlacementChangeTime<this.fadeDuration},vr.prototype.stillRecent=function(H,ve){var K=this.zoomAtLastRecencyCheck===ve?1-this.zoomAdjustment(ve):1;return this.zoomAtLastRecencyCheck=ve,this.commitTime+this.fadeDuration*K>H},vr.prototype.setStale=function(){this.stale=!0};function rn(ce,H,ve,K,de){ce.emplaceBack(H?1:0,ve?1:0,K||0,de||0),ce.emplaceBack(H?1:0,ve?1:0,K||0,de||0),ce.emplaceBack(H?1:0,ve?1:0,K||0,de||0),ce.emplaceBack(H?1:0,ve?1:0,K||0,de||0)}var hn=Math.pow(2,25),un=Math.pow(2,24),kn=Math.pow(2,17),bn=Math.pow(2,16),ln=Math.pow(2,9),gr=Math.pow(2,8),dr=Math.pow(2,1);function Cr(ce){if(ce.opacity===0&&!ce.placed)return 0;if(ce.opacity===1&&ce.placed)return 4294967295;var H=ce.placed?1:0,ve=Math.floor(ce.opacity*127);return ve*hn+H*un+ve*kn+H*bn+ve*ln+H*gr+ve*dr+H}var dn=0,On=function(H){this._sortAcrossTiles=H.layout.get("symbol-z-order")!=="viewport-y"&&H.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};On.prototype.continuePlacement=function(H,ve,K,de,Se){for(var Ce=this._bucketParts;this._currentTileIndex<H.length;){var Xe=H[this._currentTileIndex];if(ve.getBucketParts(Ce,de,Xe,this._sortAcrossTiles),this._currentTileIndex++,Se())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,Ce.sort(function(wt,Ht){return wt.sortKey-Ht.sortKey}));this._currentPartIndex<Ce.length;){var lt=Ce[this._currentPartIndex];if(ve.placeLayerBucketPart(lt,this._seenCrossTileIDs,K),this._currentPartIndex++,Se())return!0}return!1};var qn=function(H,ve,K,de,Se,Ce,Xe){this.placement=new vr(H,Se,Ce,Xe),this._currentPlacementIndex=ve.length-1,this._forceFullPlacement=K,this._showCollisionBoxes=de,this._done=!1};qn.prototype.isDone=function(){return this._done},qn.prototype.continuePlacement=function(H,ve,K){for(var de=this,Se=e.browser.now(),Ce=function(){var nr=e.browser.now()-Se;return de._forceFullPlacement?!1:nr>2};this._currentPlacementIndex>=0;){var Xe=H[this._currentPlacementIndex],lt=ve[Xe],wt=this.placement.collisionIndex.transform.zoom;if(lt.type==="symbol"&&(!lt.minzoom||lt.minzoom<=wt)&&(!lt.maxzoom||lt.maxzoom>wt)){this._inProgressLayer||(this._inProgressLayer=new On(lt));var Ht=this._inProgressLayer.continuePlacement(K[lt.source],this.placement,this._showCollisionBoxes,lt,Ce);if(Ht)return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},qn.prototype.commit=function(H){return this.placement.commit(H),this.placement};var xn=512/e.EXTENT/2,Wn=function(H,ve,K){this.tileID=H,this.indexedSymbolInstances={},this.bucketInstanceId=K;for(var de=0;de<ve.length;de++){var Se=ve.get(de),Ce=Se.key;this.indexedSymbolInstances[Ce]||(this.indexedSymbolInstances[Ce]=[]),this.indexedSymbolInstances[Ce].push({crossTileID:Se.crossTileID,coord:this.getScaledCoordinates(Se,H)})}};Wn.prototype.getScaledCoordinates=function(H,ve){var K=ve.canonical.z-this.tileID.canonical.z,de=xn/Math.pow(2,K);return{x:Math.floor((ve.canonical.x*e.EXTENT+H.anchorX)*de),y:Math.floor((ve.canonical.y*e.EXTENT+H.anchorY)*de)}},Wn.prototype.findMatches=function(H,ve,K){for(var de=this.tileID.canonical.z<ve.canonical.z?1:Math.pow(2,this.tileID.canonical.z-ve.canonical.z),Se=0;Se<H.length;Se++){var Ce=H.get(Se);if(!Ce.crossTileID){var Xe=this.indexedSymbolInstances[Ce.key];if(!!Xe)for(var lt=this.getScaledCoordinates(Ce,ve),wt=0,Ht=Xe;wt<Ht.length;wt+=1){var nr=Ht[wt];if(Math.abs(nr.coord.x-lt.x)<=de&&Math.abs(nr.coord.y-lt.y)<=de&&!K[nr.crossTileID]){K[nr.crossTileID]=!0,Ce.crossTileID=nr.crossTileID;break}}}}};var aa=function(){this.maxCrossTileID=0};aa.prototype.generate=function(){return++this.maxCrossTileID};var da=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};da.prototype.handleWrapJump=function(H){var ve=Math.round((H-this.lng)/360);if(ve!==0)for(var K in this.indexes){var de=this.indexes[K],Se={};for(var Ce in de){var Xe=de[Ce];Xe.tileID=Xe.tileID.unwrapTo(Xe.tileID.wrap+ve),Se[Xe.tileID.key]=Xe}this.indexes[K]=Se}this.lng=H},da.prototype.addBucket=function(H,ve,K){if(this.indexes[H.overscaledZ]&&this.indexes[H.overscaledZ][H.key]){if(this.indexes[H.overscaledZ][H.key].bucketInstanceId===ve.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(H.overscaledZ,this.indexes[H.overscaledZ][H.key])}for(var de=0;de<ve.symbolInstances.length;de++){var Se=ve.symbolInstances.get(de);Se.crossTileID=0}this.usedCrossTileIDs[H.overscaledZ]||(this.usedCrossTileIDs[H.overscaledZ]={});var Ce=this.usedCrossTileIDs[H.overscaledZ];for(var Xe in this.indexes){var lt=this.indexes[Xe];if(Number(Xe)>H.overscaledZ)for(var wt in lt){var Ht=lt[wt];Ht.tileID.isChildOf(H)&&Ht.findMatches(ve.symbolInstances,H,Ce)}else{var nr=H.scaledTo(Number(Xe)),sr=lt[nr.key];sr&&sr.findMatches(ve.symbolInstances,H,Ce)}}for(var Ar=0;Ar<ve.symbolInstances.length;Ar++){var Nr=ve.symbolInstances.get(Ar);Nr.crossTileID||(Nr.crossTileID=K.generate(),Ce[Nr.crossTileID]=!0)}return this.indexes[H.overscaledZ]===void 0&&(this.indexes[H.overscaledZ]={}),this.indexes[H.overscaledZ][H.key]=new Wn(H,ve.symbolInstances,ve.bucketInstanceId),!0},da.prototype.removeBucketCrossTileIDs=function(H,ve){for(var K in ve.indexedSymbolInstances)for(var de=0,Se=ve.indexedSymbolInstances[K];de<Se.length;de+=1){var Ce=Se[de];delete this.usedCrossTileIDs[H][Ce.crossTileID]}},da.prototype.removeStaleBuckets=function(H){var ve=!1;for(var K in this.indexes){var de=this.indexes[K];for(var Se in de)H[de[Se].bucketInstanceId]||(this.removeBucketCrossTileIDs(K,de[Se]),delete de[Se],ve=!0)}return ve};var ma=function(){this.layerIndexes={},this.crossTileIDs=new aa,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};ma.prototype.addLayer=function(H,ve,K){var de=this.layerIndexes[H.id];de===void 0&&(de=this.layerIndexes[H.id]=new da);var Se=!1,Ce={};de.handleWrapJump(K);for(var Xe=0,lt=ve;Xe<lt.length;Xe+=1){var wt=lt[Xe],Ht=wt.getBucket(H);!Ht||H.id!==Ht.layerIds[0]||(Ht.bucketInstanceId||(Ht.bucketInstanceId=++this.maxBucketInstanceId),de.addBucket(wt.tileID,Ht,this.crossTileIDs)&&(Se=!0),Ce[Ht.bucketInstanceId]=!0)}return de.removeStaleBuckets(Ce)&&(Se=!0),Se},ma.prototype.pruneUnusedLayers=function(H){var ve={};H.forEach(function(de){ve[de]=!0});for(var K in this.layerIndexes)ve[K]||delete this.layerIndexes[K]};var la=function(ce,H){return e.emitValidationErrors(ce,H&&H.filter(function(ve){return ve.identifier!=="source.canvas"}))},Ma=e.pick(xr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),po=e.pick(xr,["setCenter","setZoom","setBearing","setPitch"]),zo=fn(),Ko=function(ce){function H(ve,K){var de=this;K===void 0&&(K={}),ce.call(this),this.map=ve,this.dispatcher=new R(hr(),this),this.imageManager=new _,this.imageManager.setEventedParent(this),this.glyphManager=new S(ve._requestManager,K.localIdeographFontFamily),this.lineAtlas=new D(256,512),this.crossTileSymbolIndex=new ma,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var Se=this;this._rtlTextPluginCallback=H.registerForPluginStateChange(function(Ce){var Xe={pluginStatus:Ce.pluginStatus,pluginURL:Ce.pluginURL};Se.dispatcher.broadcast("syncRTLPluginState",Xe,function(lt,wt){if(e.triggerPluginCompletionEvent(lt),wt){var Ht=wt.every(function(sr){return sr});if(Ht)for(var nr in Se.sourceCaches)Se.sourceCaches[nr].reload()}})}),this.on("data",function(Ce){if(!(Ce.dataType!=="source"||Ce.sourceDataType!=="metadata")){var Xe=de.sourceCaches[Ce.sourceId];if(!!Xe){var lt=Xe.getSource();if(!(!lt||!lt.vectorLayerIds))for(var wt in de._layers){var Ht=de._layers[wt];Ht.source===lt.id&&de._validateLayer(Ht)}}}})}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.loadURL=function(K,de){var Se=this;de===void 0&&(de={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var Ce=typeof de.validate=="boolean"?de.validate:!e.isMapboxURL(K);K=this.map._requestManager.normalizeStyleURL(K,de.accessToken);var Xe=this.map._requestManager.transformRequest(K,e.ResourceType.Style);this._request=e.getJSON(Xe,function(lt,wt){Se._request=null,lt?Se.fire(new e.ErrorEvent(lt)):wt&&Se._load(wt,Ce)})},H.prototype.loadJSON=function(K,de){var Se=this;de===void 0&&(de={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){Se._request=null,Se._load(K,de.validate!==!1)})},H.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(zo,!1)},H.prototype._load=function(K,de){if(!(de&&la(this,e.validateStyle(K)))){this._loaded=!0,this.stylesheet=K;for(var Se in K.sources)this.addSource(Se,K.sources[Se],{validate:!1});K.sprite?this._loadSprite(K.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(K.glyphs);var Ce=Vr(this.stylesheet.layers);this._order=Ce.map(function(Ht){return Ht.id}),this._layers={},this._serializedLayers={};for(var Xe=0,lt=Ce;Xe<lt.length;Xe+=1){var wt=lt[Xe];wt=e.createStyleLayer(wt),wt.setEventedParent(this,{layer:{id:wt.id}}),this._layers[wt.id]=wt,this._serializedLayers[wt.id]=wt.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new I(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},H.prototype._loadSprite=function(K){var de=this;this._spriteRequest=h(K,this.map._requestManager,function(Se,Ce){if(de._spriteRequest=null,Se)de.fire(new e.ErrorEvent(Se));else if(Ce)for(var Xe in Ce)de.imageManager.addImage(Xe,Ce[Xe]);de.imageManager.setLoaded(!0),de._availableImages=de.imageManager.listImages(),de.dispatcher.broadcast("setImages",de._availableImages),de.fire(new e.Event("data",{dataType:"style"}))})},H.prototype._validateLayer=function(K){var de=this.sourceCaches[K.source];if(!!de){var Se=K.sourceLayer;if(!!Se){var Ce=de.getSource();(Ce.type==="geojson"||Ce.vectorLayerIds&&Ce.vectorLayerIds.indexOf(Se)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+Se+'" does not exist on source "'+Ce.id+'" as specified by style layer "'+K.id+'"')))}}},H.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var K in this.sourceCaches)if(!this.sourceCaches[K].loaded())return!1;return!!this.imageManager.isLoaded()},H.prototype._serializeLayers=function(K){for(var de=[],Se=0,Ce=K;Se<Ce.length;Se+=1){var Xe=Ce[Se],lt=this._layers[Xe];lt.type!=="custom"&&de.push(lt.serialize())}return de},H.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var K in this.sourceCaches)if(this.sourceCaches[K].hasTransition())return!0;for(var de in this._layers)if(this._layers[de].hasTransition())return!0;return!1},H.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},H.prototype.update=function(K){if(!!this._loaded){var de=this._changed;if(this._changed){var Se=Object.keys(this._updatedLayers),Ce=Object.keys(this._removedLayers);(Se.length||Ce.length)&&this._updateWorkerLayers(Se,Ce);for(var Xe in this._updatedSources){var lt=this._updatedSources[Xe];lt==="reload"?this._reloadSource(Xe):lt==="clear"&&this._clearSource(Xe)}this._updateTilesForChangedImages();for(var wt in this._updatedPaintProps)this._layers[wt].updateTransitions(K);this.light.updateTransitions(K),this._resetUpdates()}for(var Ht in this.sourceCaches)this.sourceCaches[Ht].used=!1;for(var nr=0,sr=this._order;nr<sr.length;nr+=1){var Ar=sr[nr],Nr=this._layers[Ar];Nr.recalculate(K,this._availableImages),!Nr.isHidden(K.zoom)&&Nr.source&&(this.sourceCaches[Nr.source].used=!0)}this.light.recalculate(K),this.z=K.zoom,de&&this.fire(new e.Event("data",{dataType:"style"}))}},H.prototype._updateTilesForChangedImages=function(){var K=Object.keys(this._changedImages);if(K.length){for(var de in this.sourceCaches)this.sourceCaches[de].reloadTilesForDependencies(["icons","patterns"],K);this._changedImages={}}},H.prototype._updateWorkerLayers=function(K,de){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(K),removedIds:de})},H.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},H.prototype.setState=function(K){var de=this;if(this._checkLoaded(),la(this,e.validateStyle(K)))return!1;K=e.clone$1(K),K.layers=Vr(K.layers);var Se=Br(this.serialize(),K).filter(function(Xe){return!(Xe.command in po)});if(Se.length===0)return!1;var Ce=Se.filter(function(Xe){return!(Xe.command in Ma)});if(Ce.length>0)throw new Error("Unimplemented: "+Ce.map(function(Xe){return Xe.command}).join(", ")+".");return Se.forEach(function(Xe){Xe.command!=="setTransition"&&de[Xe.command].apply(de,Xe.args)}),this.stylesheet=K,!0},H.prototype.addImage=function(K,de){if(this.getImage(K))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(K,de),this._availableImages=this.imageManager.listImages(),this._changedImages[K]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},H.prototype.updateImage=function(K,de){this.imageManager.updateImage(K,de)},H.prototype.getImage=function(K){return this.imageManager.getImage(K)},H.prototype.removeImage=function(K){if(!this.getImage(K))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(K),this._availableImages=this.imageManager.listImages(),this._changedImages[K]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},H.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},H.prototype.addSource=function(K,de,Se){var Ce=this;if(Se===void 0&&(Se={}),this._checkLoaded(),this.sourceCaches[K]!==void 0)throw new Error("There is already a source with this ID");if(!de.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(de).join(", ")+".");var Xe=["vector","raster","geojson","video","image"],lt=Xe.indexOf(de.type)>=0;if(!(lt&&this._validate(e.validateStyle.source,"sources."+K,de,null,Se))){this.map&&this.map._collectResourceTiming&&(de.collectResourceTiming=!0);var wt=this.sourceCaches[K]=new rt(K,de,this.dispatcher);wt.style=this,wt.setEventedParent(this,function(){return{isSourceLoaded:Ce.loaded(),source:wt.serialize(),sourceId:K}}),wt.onAdd(this.map),this._changed=!0}},H.prototype.removeSource=function(K){if(this._checkLoaded(),this.sourceCaches[K]===void 0)throw new Error("There is no source with this ID");for(var de in this._layers)if(this._layers[de].source===K)return this.fire(new e.ErrorEvent(new Error('Source "'+K+'" cannot be removed while layer "'+de+'" is using it.')));var Se=this.sourceCaches[K];delete this.sourceCaches[K],delete this._updatedSources[K],Se.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:K})),Se.setEventedParent(null),Se.clearTiles(),Se.onRemove&&Se.onRemove(this.map),this._changed=!0},H.prototype.setGeoJSONSourceData=function(K,de){this._checkLoaded();var Se=this.sourceCaches[K].getSource();Se.setData(de),this._changed=!0},H.prototype.getSource=function(K){return this.sourceCaches[K]&&this.sourceCaches[K].getSource()},H.prototype.addLayer=function(K,de,Se){Se===void 0&&(Se={}),this._checkLoaded();var Ce=K.id;if(this.getLayer(Ce)){this.fire(new e.ErrorEvent(new Error('Layer with id "'+Ce+'" already exists on this map')));return}var Xe;if(K.type==="custom"){if(la(this,e.validateCustomStyleLayer(K)))return;Xe=e.createStyleLayer(K)}else{if(typeof K.source=="object"&&(this.addSource(Ce,K.source),K=e.clone$1(K),K=e.extend(K,{source:Ce})),this._validate(e.validateStyle.layer,"layers."+Ce,K,{arrayIndex:-1},Se))return;Xe=e.createStyleLayer(K),this._validateLayer(Xe),Xe.setEventedParent(this,{layer:{id:Ce}}),this._serializedLayers[Xe.id]=Xe.serialize()}var lt=de?this._order.indexOf(de):this._order.length;if(de&&lt===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+de+'" does not exist on this map.')));return}if(this._order.splice(lt,0,Ce),this._layerOrderChanged=!0,this._layers[Ce]=Xe,this._removedLayers[Ce]&&Xe.source&&Xe.type!=="custom"){var wt=this._removedLayers[Ce];delete this._removedLayers[Ce],wt.type!==Xe.type?this._updatedSources[Xe.source]="clear":(this._updatedSources[Xe.source]="reload",this.sourceCaches[Xe.source].pause())}this._updateLayer(Xe),Xe.onAdd&&Xe.onAdd(this.map)},H.prototype.moveLayer=function(K,de){this._checkLoaded(),this._changed=!0;var Se=this._layers[K];if(!Se){this.fire(new e.ErrorEvent(new Error("The layer '"+K+"' does not exist in the map's style and cannot be moved.")));return}if(K!==de){var Ce=this._order.indexOf(K);this._order.splice(Ce,1);var Xe=de?this._order.indexOf(de):this._order.length;if(de&&Xe===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+de+'" does not exist on this map.')));return}this._order.splice(Xe,0,K),this._layerOrderChanged=!0}},H.prototype.removeLayer=function(K){this._checkLoaded();var de=this._layers[K];if(!de){this.fire(new e.ErrorEvent(new Error("The layer '"+K+"' does not exist in the map's style and cannot be removed.")));return}de.setEventedParent(null);var Se=this._order.indexOf(K);this._order.splice(Se,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[K]=de,delete this._layers[K],delete this._serializedLayers[K],delete this._updatedLayers[K],delete this._updatedPaintProps[K],de.onRemove&&de.onRemove(this.map)},H.prototype.getLayer=function(K){return this._layers[K]},H.prototype.hasLayer=function(K){return K in this._layers},H.prototype.setLayerZoomRange=function(K,de,Se){this._checkLoaded();var Ce=this.getLayer(K);if(!Ce){this.fire(new e.ErrorEvent(new Error("The layer '"+K+"' does not exist in the map's style and cannot have zoom extent.")));return}Ce.minzoom===de&&Ce.maxzoom===Se||(de!=null&&(Ce.minzoom=de),Se!=null&&(Ce.maxzoom=Se),this._updateLayer(Ce))},H.prototype.setFilter=function(K,de,Se){Se===void 0&&(Se={}),this._checkLoaded();var Ce=this.getLayer(K);if(!Ce){this.fire(new e.ErrorEvent(new Error("The layer '"+K+"' does not exist in the map's style and cannot be filtered.")));return}if(!e.deepEqual(Ce.filter,de)){if(de==null){Ce.filter=void 0,this._updateLayer(Ce);return}this._validate(e.validateStyle.filter,"layers."+Ce.id+".filter",de,null,Se)||(Ce.filter=e.clone$1(de),this._updateLayer(Ce))}},H.prototype.getFilter=function(K){return e.clone$1(this.getLayer(K).filter)},H.prototype.setLayoutProperty=function(K,de,Se,Ce){Ce===void 0&&(Ce={}),this._checkLoaded();var Xe=this.getLayer(K);if(!Xe){this.fire(new e.ErrorEvent(new Error("The layer '"+K+"' does not exist in the map's style and cannot be styled.")));return}e.deepEqual(Xe.getLayoutProperty(de),Se)||(Xe.setLayoutProperty(de,Se,Ce),this._updateLayer(Xe))},H.prototype.getLayoutProperty=function(K,de){var Se=this.getLayer(K);if(!Se){this.fire(new e.ErrorEvent(new Error("The layer '"+K+"' does not exist in the map's style.")));return}return Se.getLayoutProperty(de)},H.prototype.setPaintProperty=function(K,de,Se,Ce){Ce===void 0&&(Ce={}),this._checkLoaded();var Xe=this.getLayer(K);if(!Xe){this.fire(new e.ErrorEvent(new Error("The layer '"+K+"' does not exist in the map's style and cannot be styled.")));return}if(!e.deepEqual(Xe.getPaintProperty(de),Se)){var lt=Xe.setPaintProperty(de,Se,Ce);lt&&this._updateLayer(Xe),this._changed=!0,this._updatedPaintProps[K]=!0}},H.prototype.getPaintProperty=function(K,de){return this.getLayer(K).getPaintProperty(de)},H.prototype.setFeatureState=function(K,de){this._checkLoaded();var Se=K.source,Ce=K.sourceLayer,Xe=this.sourceCaches[Se];if(Xe===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Se+"' does not exist in the map's style.")));return}var lt=Xe.getSource().type;if(lt==="geojson"&&Ce){this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(lt==="vector"&&!Ce){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}K.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),Xe.setFeatureState(Ce,K.id,de)},H.prototype.removeFeatureState=function(K,de){this._checkLoaded();var Se=K.source,Ce=this.sourceCaches[Se];if(Ce===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Se+"' does not exist in the map's style.")));return}var Xe=Ce.getSource().type,lt=Xe==="vector"?K.sourceLayer:void 0;if(Xe==="vector"&&!lt){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(de&&typeof K.id!="string"&&typeof K.id!="number"){this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property.")));return}Ce.removeFeatureState(lt,K.id,de)},H.prototype.getFeatureState=function(K){this._checkLoaded();var de=K.source,Se=K.sourceLayer,Ce=this.sourceCaches[de];if(Ce===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+de+"' does not exist in the map's style.")));return}var Xe=Ce.getSource().type;if(Xe==="vector"&&!Se){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return K.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),Ce.getFeatureState(Se,K.id)},H.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},H.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(K){return K.serialize()}),layers:this._serializeLayers(this._order)},function(K){return K!==void 0})},H.prototype._updateLayer=function(K){this._updatedLayers[K.id]=!0,K.source&&!this._updatedSources[K.source]&&this.sourceCaches[K.source].getSource().type!=="raster"&&(this._updatedSources[K.source]="reload",this.sourceCaches[K.source].pause()),this._changed=!0},H.prototype._flattenAndSortRenderedFeatures=function(K){for(var de=this,Se=function(Ha){return de._layers[Ha].type==="fill-extrusion"},Ce={},Xe=[],lt=this._order.length-1;lt>=0;lt--){var wt=this._order[lt];if(Se(wt)){Ce[wt]=lt;for(var Ht=0,nr=K;Ht<nr.length;Ht+=1){var sr=nr[Ht],Ar=sr[wt];if(Ar)for(var Nr=0,Ur=Ar;Nr<Ur.length;Nr+=1){var Or=Ur[Nr];Xe.push(Or)}}}}Xe.sort(function(Ha,ri){return ri.intersectionZ-Ha.intersectionZ});for(var Xr=[],sn=this._order.length-1;sn>=0;sn--){var Sn=this._order[sn];if(Se(Sn))for(var Fn=Xe.length-1;Fn>=0;Fn--){var Xn=Xe[Fn].feature;if(Ce[Xn.layer.id]<sn)break;Xr.push(Xn),Xe.pop()}else for(var Qn=0,jn=K;Qn<jn.length;Qn+=1){var ca=jn[Qn],ba=ca[Sn];if(ba)for(var ya=0,Ta=ba;ya<Ta.length;ya+=1){var Ca=Ta[ya];Xr.push(Ca.feature)}}}return Xr},H.prototype.queryRenderedFeatures=function(K,de,Se){de&&de.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",de.filter,null,de);var Ce={};if(de&&de.layers){if(!Array.isArray(de.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var Xe=0,lt=de.layers;Xe<lt.length;Xe+=1){var wt=lt[Xe],Ht=this._layers[wt];if(!Ht)return this.fire(new e.ErrorEvent(new Error("The layer '"+wt+"' does not exist in the map's style and cannot be queried for features."))),[];Ce[Ht.source]=!0}}var nr=[];de.availableImages=this._availableImages;for(var sr in this.sourceCaches)de.layers&&!Ce[sr]||nr.push(ee(this.sourceCaches[sr],this._layers,this._serializedLayers,K,de,Se));return this.placement&&nr.push(te(this._layers,this._serializedLayers,this.sourceCaches,K,de,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(nr)},H.prototype.querySourceFeatures=function(K,de){de&&de.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",de.filter,null,de);var Se=this.sourceCaches[K];return Se?ae(Se,de):[]},H.prototype.addSourceType=function(K,de,Se){if(H.getSourceType(K))return Se(new Error('A source type called "'+K+'" already exists.'));if(H.setSourceType(K,de),!de.workerSourceURL)return Se(null,null);this.dispatcher.broadcast("loadWorkerSource",{name:K,url:de.workerSourceURL},Se)},H.prototype.getLight=function(){return this.light.getLight()},H.prototype.setLight=function(K,de){de===void 0&&(de={}),this._checkLoaded();var Se=this.light.getLight(),Ce=!1;for(var Xe in K)if(!e.deepEqual(K[Xe],Se[Xe])){Ce=!0;break}if(!!Ce){var lt={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(K,de),this.light.updateTransitions(lt)}},H.prototype._validate=function(K,de,Se,Ce,Xe){return Xe===void 0&&(Xe={}),Xe&&Xe.validate===!1?!1:la(this,K.call(e.validateStyle,e.extend({key:de,style:this.serialize(),value:Se,styleSpec:e.styleSpec},Ce)))},H.prototype._remove=function(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(var K in this._layers){var de=this._layers[K];de.setEventedParent(null)}for(var Se in this.sourceCaches)this.sourceCaches[Se].clearTiles(),this.sourceCaches[Se].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},H.prototype._clearSource=function(K){this.sourceCaches[K].clearTiles()},H.prototype._reloadSource=function(K){this.sourceCaches[K].resume(),this.sourceCaches[K].reload()},H.prototype._updateSources=function(K){for(var de in this.sourceCaches)this.sourceCaches[de].update(K)},H.prototype._generateCollisionBoxes=function(){for(var K in this.sourceCaches)this._reloadSource(K)},H.prototype._updatePlacement=function(K,de,Se,Ce,Xe){Xe===void 0&&(Xe=!1);for(var lt=!1,wt=!1,Ht={},nr=0,sr=this._order;nr<sr.length;nr+=1){var Ar=sr[nr],Nr=this._layers[Ar];if(Nr.type==="symbol"){if(!Ht[Nr.source]){var Ur=this.sourceCaches[Nr.source];Ht[Nr.source]=Ur.getRenderableIds(!0).map(function(Qn){return Ur.getTileByID(Qn)}).sort(function(Qn,jn){return jn.tileID.overscaledZ-Qn.tileID.overscaledZ||(Qn.tileID.isLessThan(jn.tileID)?-1:1)})}var Or=this.crossTileSymbolIndex.addLayer(Nr,Ht[Nr.source],K.center.lng);lt=lt||Or}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),Xe=Xe||this._layerOrderChanged||Se===0,(Xe||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),K.zoom))&&(this.pauseablePlacement=new qn(K,this._order,Xe,de,Se,Ce,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ht),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),wt=!0),lt&&this.pauseablePlacement.placement.setStale()),wt||lt)for(var Xr=0,sn=this._order;Xr<sn.length;Xr+=1){var Sn=sn[Xr],Fn=this._layers[Sn];Fn.type==="symbol"&&this.placement.updateLayerOpacities(Fn,Ht[Fn.source])}var Xn=!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now());return Xn},H.prototype._releaseSymbolFadeTiles=function(){for(var K in this.sourceCaches)this.sourceCaches[K].releaseSymbolFadeTiles()},H.prototype.getImages=function(K,de,Se){this.imageManager.getImages(de.icons,Se),this._updateTilesForChangedImages();var Ce=this.sourceCaches[de.source];Ce&&Ce.setDependencies(de.tileID.key,de.type,de.icons)},H.prototype.getGlyphs=function(K,de,Se){this.glyphManager.getGlyphs(de.stacks,Se)},H.prototype.getResource=function(K,de,Se){return e.makeRequest(de,Se)},H}(e.Evented);Ko.getSourceType=q,Ko.setSourceType=Q,Ko.registerForPluginStateChange=e.registerForPluginStateChange;var nl=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),pl=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,Yl=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`,di=`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Gs="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",Rs=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Hi="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}",So=`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,dl=`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`,ps="void main() {gl_FragColor=vec4(1.0);}",Ii="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",al=`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Qi=`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`,Bi=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,io="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}",$i="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}",rs="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}",Ys="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",au="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}",Jo="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",iu="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}",Is=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ko=`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`,Mu=`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,zs=`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,ws=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ll=`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,Su=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ku=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`,Ws=`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Pl=`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`,Ts=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Wl=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`,il=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Xl="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}",ou=`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Dl="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}",Eu=`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Xs=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,Zl=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Rl=`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,ds=`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,yl=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`,jl=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,su=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`,lu=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Il="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}",Cu=`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,uu=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`,Qo=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ol=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`,sl=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Kl=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`,gs=zi(pl,Yl),Eo=zi(di,Gs),zl=zi(Rs,Hi),As=zi(So,dl),Ms=zi(ps,Ii),lo=zi(al,Qi),ml=zi(Bi,io),xl=zi($i,rs),Zs=zi(Ys,au),ys=zi(Jo,iu),bl=zi(Is,ko),ll=zi(Mu,zs),Fl=zi(ws,Ll),_l=zi(Su,ku),js=zi(Ws,Pl),Lu=zi(Ts,Wl),ns=zi(il,Xl),Yu=zi(ou,Dl),Jl=zi(Eu,Xs),ul=zi(Zl,Rl),wl=zi(ds,yl),Ks=zi(jl,su),Tl=zi(lu,Il),fu=zi(Cu,uu),cu=zi(Qo,ol),Wu=zi(sl,Kl);function zi(ce,H){var ve=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,K={};return ce=ce.replace(ve,function(de,Se,Ce,Xe,lt){return K[lt]=!0,Se==="define"?`
#ifndef HAS_UNIFORM_u_`+lt+`
varying `+Ce+" "+Xe+" "+lt+`;
#else
uniform `+Ce+" "+Xe+" u_"+lt+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+lt+`
    `+Ce+" "+Xe+" "+lt+" = u_"+lt+`;
#endif
`}),H=H.replace(ve,function(de,Se,Ce,Xe,lt){var wt=Xe==="float"?"vec2":"vec4",Ht=lt.match(/color/)?"color":wt;return K[lt]?Se==="define"?`
#ifndef HAS_UNIFORM_u_`+lt+`
uniform lowp float u_`+lt+`_t;
attribute `+Ce+" "+wt+" a_"+lt+`;
varying `+Ce+" "+Xe+" "+lt+`;
#else
uniform `+Ce+" "+Xe+" u_"+lt+`;
#endif
`:Ht==="vec4"?`
#ifndef HAS_UNIFORM_u_`+lt+`
    `+lt+" = a_"+lt+`;
#else
    `+Ce+" "+Xe+" "+lt+" = u_"+lt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+lt+`
    `+lt+" = unpack_mix_"+Ht+"(a_"+lt+", u_"+lt+`_t);
#else
    `+Ce+" "+Xe+" "+lt+" = u_"+lt+`;
#endif
`:Se==="define"?`
#ifndef HAS_UNIFORM_u_`+lt+`
uniform lowp float u_`+lt+`_t;
attribute `+Ce+" "+wt+" a_"+lt+`;
#else
uniform `+Ce+" "+Xe+" u_"+lt+`;
#endif
`:Ht==="vec4"?`
#ifndef HAS_UNIFORM_u_`+lt+`
    `+Ce+" "+Xe+" "+lt+" = a_"+lt+`;
#else
    `+Ce+" "+Xe+" "+lt+" = u_"+lt+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+lt+`
    `+Ce+" "+Xe+" "+lt+" = unpack_mix_"+Ht+"(a_"+lt+", u_"+lt+`_t);
#else
    `+Ce+" "+Xe+" "+lt+" = u_"+lt+`;
#endif
`}),{fragmentSource:ce,vertexSource:H}}var fl=Object.freeze({__proto__:null,prelude:gs,background:Eo,backgroundPattern:zl,circle:As,clippingMask:Ms,heatmap:lo,heatmapTexture:ml,collisionBox:xl,collisionCircle:Zs,debug:ys,fill:bl,fillOutline:ll,fillOutlinePattern:Fl,fillPattern:_l,fillExtrusion:js,fillExtrusionPattern:Lu,hillshadePrepare:ns,hillshade:Yu,line:Jl,lineGradient:ul,linePattern:wl,lineSDF:Ks,raster:Tl,symbolIcon:fu,symbolSDF:cu,symbolTextAndIcon:Wu}),Js=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Js.prototype.bind=function(H,ve,K,de,Se,Ce,Xe,lt){this.context=H;for(var wt=this.boundPaintVertexBuffers.length!==de.length,Ht=0;!wt&&Ht<de.length;Ht++)this.boundPaintVertexBuffers[Ht]!==de[Ht]&&(wt=!0);var nr=!this.vao||this.boundProgram!==ve||this.boundLayoutVertexBuffer!==K||wt||this.boundIndexBuffer!==Se||this.boundVertexOffset!==Ce||this.boundDynamicVertexBuffer!==Xe||this.boundDynamicVertexBuffer2!==lt;!H.extVertexArrayObject||nr?this.freshBind(ve,K,de,Se,Ce,Xe,lt):(H.bindVertexArrayOES.set(this.vao),Xe&&Xe.bind(),Se&&Se.dynamicDraw&&Se.bind(),lt&&lt.bind())},Js.prototype.freshBind=function(H,ve,K,de,Se,Ce,Xe){var lt,wt=H.numAttributes,Ht=this.context,nr=Ht.gl;if(Ht.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ht.extVertexArrayObject.createVertexArrayOES(),Ht.bindVertexArrayOES.set(this.vao),lt=0,this.boundProgram=H,this.boundLayoutVertexBuffer=ve,this.boundPaintVertexBuffers=K,this.boundIndexBuffer=de,this.boundVertexOffset=Se,this.boundDynamicVertexBuffer=Ce,this.boundDynamicVertexBuffer2=Xe;else{lt=Ht.currentNumAttributes||0;for(var sr=wt;sr<lt;sr++)nr.disableVertexAttribArray(sr)}ve.enableAttributes(nr,H);for(var Ar=0,Nr=K;Ar<Nr.length;Ar+=1){var Ur=Nr[Ar];Ur.enableAttributes(nr,H)}Ce&&Ce.enableAttributes(nr,H),Xe&&Xe.enableAttributes(nr,H),ve.bind(),ve.setVertexAttribPointers(nr,H,Se);for(var Or=0,Xr=K;Or<Xr.length;Or+=1){var sn=Xr[Or];sn.bind(),sn.setVertexAttribPointers(nr,H,Se)}Ce&&(Ce.bind(),Ce.setVertexAttribPointers(nr,H,Se)),de&&de.bind(),Xe&&(Xe.bind(),Xe.setVertexAttribPointers(nr,H,Se)),Ht.currentNumAttributes=wt},Js.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var $o=function(H,ve,K,de,Se){var Ce=H.gl;this.program=Ce.createProgram();var Xe=K?K.defines():[];Se&&Xe.push("#define OVERDRAW_INSPECTOR;");var lt=Xe.concat(gs.fragmentSource,ve.fragmentSource).join(`
`),wt=Xe.concat(gs.vertexSource,ve.vertexSource).join(`
`),Ht=Ce.createShader(Ce.FRAGMENT_SHADER);if(Ce.isContextLost()){this.failedToCreate=!0;return}Ce.shaderSource(Ht,lt),Ce.compileShader(Ht),Ce.attachShader(this.program,Ht);var nr=Ce.createShader(Ce.VERTEX_SHADER);if(Ce.isContextLost()){this.failedToCreate=!0;return}Ce.shaderSource(nr,wt),Ce.compileShader(nr),Ce.attachShader(this.program,nr);for(var sr=K?K.layoutAttributes:[],Ar=0;Ar<sr.length;Ar++)Ce.bindAttribLocation(this.program,Ar,sr[Ar].name);Ce.linkProgram(this.program),Ce.deleteShader(nr),Ce.deleteShader(Ht),this.numAttributes=Ce.getProgramParameter(this.program,Ce.ACTIVE_ATTRIBUTES),this.attributes={};for(var Nr={},Ur=0;Ur<this.numAttributes;Ur++){var Or=Ce.getActiveAttrib(this.program,Ur);Or&&(this.attributes[Or.name]=Ce.getAttribLocation(this.program,Or.name))}for(var Xr=Ce.getProgramParameter(this.program,Ce.ACTIVE_UNIFORMS),sn=0;sn<Xr;sn++){var Sn=Ce.getActiveUniform(this.program,sn);Sn&&(Nr[Sn.name]=Ce.getUniformLocation(this.program,Sn.name))}this.fixedUniforms=de(H,Nr),this.binderUniforms=K?K.getUniforms(H,Nr):[]};$o.prototype.draw=function(H,ve,K,de,Se,Ce,Xe,lt,wt,Ht,nr,sr,Ar,Nr,Ur,Or){var Xr,sn=H.gl;if(!this.failedToCreate){H.program.set(this.program),H.setDepthMode(K),H.setStencilMode(de),H.setColorMode(Se),H.setCullFace(Ce);for(var Sn in this.fixedUniforms)this.fixedUniforms[Sn].set(Xe[Sn]);Nr&&Nr.setUniforms(H,this.binderUniforms,sr,{zoom:Ar});for(var Fn=(Xr={},Xr[sn.LINES]=2,Xr[sn.TRIANGLES]=3,Xr[sn.LINE_STRIP]=1,Xr)[ve],Xn=0,Qn=nr.get();Xn<Qn.length;Xn+=1){var jn=Qn[Xn],ca=jn.vaos||(jn.vaos={}),ba=ca[lt]||(ca[lt]=new Js);ba.bind(H,this,wt,Nr?Nr.getPaintVertexBuffers():[],Ht,jn.vertexOffset,Ur,Or),sn.drawElements(ve,jn.primitiveLength*Fn,sn.UNSIGNED_SHORT,jn.primitiveOffset*Fn*2)}}};function as(ce,H,ve){var K=1/_n(ve,1,H.transform.tileZoom),de=Math.pow(2,ve.tileID.overscaledZ),Se=ve.tileSize*Math.pow(2,H.transform.tileZoom)/de,Ce=Se*(ve.tileID.canonical.x+ve.tileID.wrap*de),Xe=Se*ve.tileID.canonical.y;return{u_image:0,u_texsize:ve.imageAtlasTexture.size,u_scale:[K,ce.fromScale,ce.toScale],u_fade:ce.t,u_pixel_coord_upper:[Ce>>16,Xe>>16],u_pixel_coord_lower:[Ce&65535,Xe&65535]}}function Al(ce,H,ve,K){var de=ve.imageManager.getPattern(ce.from.toString()),Se=ve.imageManager.getPattern(ce.to.toString()),Ce=ve.imageManager.getPixelSize(),Xe=Ce.width,lt=Ce.height,wt=Math.pow(2,K.tileID.overscaledZ),Ht=K.tileSize*Math.pow(2,ve.transform.tileZoom)/wt,nr=Ht*(K.tileID.canonical.x+K.tileID.wrap*wt),sr=Ht*K.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:de.tl,u_pattern_br_a:de.br,u_pattern_tl_b:Se.tl,u_pattern_br_b:Se.br,u_texsize:[Xe,lt],u_mix:H.t,u_pattern_size_a:de.displaySize,u_pattern_size_b:Se.displaySize,u_scale_a:H.fromScale,u_scale_b:H.toScale,u_tile_units_to_pixels:1/_n(K,1,ve.transform.tileZoom),u_pixel_coord_upper:[nr>>16,sr>>16],u_pixel_coord_lower:[nr&65535,sr&65535]}}var uo=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_lightpos:new e.Uniform3f(ce,H.u_lightpos),u_lightintensity:new e.Uniform1f(ce,H.u_lightintensity),u_lightcolor:new e.Uniform3f(ce,H.u_lightcolor),u_vertical_gradient:new e.Uniform1f(ce,H.u_vertical_gradient),u_opacity:new e.Uniform1f(ce,H.u_opacity)}},hu=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_lightpos:new e.Uniform3f(ce,H.u_lightpos),u_lightintensity:new e.Uniform1f(ce,H.u_lightintensity),u_lightcolor:new e.Uniform3f(ce,H.u_lightcolor),u_vertical_gradient:new e.Uniform1f(ce,H.u_vertical_gradient),u_height_factor:new e.Uniform1f(ce,H.u_height_factor),u_image:new e.Uniform1i(ce,H.u_image),u_texsize:new e.Uniform2f(ce,H.u_texsize),u_pixel_coord_upper:new e.Uniform2f(ce,H.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,H.u_pixel_coord_lower),u_scale:new e.Uniform3f(ce,H.u_scale),u_fade:new e.Uniform1f(ce,H.u_fade),u_opacity:new e.Uniform1f(ce,H.u_opacity)}},is=function(ce,H,ve,K){var de=H.style.light,Se=de.properties.get("position"),Ce=[Se.x,Se.y,Se.z],Xe=e.create$1();de.properties.get("anchor")==="viewport"&&e.fromRotation(Xe,-H.transform.angle),e.transformMat3(Ce,Ce,Xe);var lt=de.properties.get("color");return{u_matrix:ce,u_lightpos:Ce,u_lightintensity:de.properties.get("intensity"),u_lightcolor:[lt.r,lt.g,lt.b],u_vertical_gradient:+ve,u_opacity:K}},Fs=function(ce,H,ve,K,de,Se,Ce){return e.extend(is(ce,H,ve,K),as(Se,H,Ce),{u_height_factor:-Math.pow(2,de.overscaledZ)/Ce.tileSize/8})},Os=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix)}},Ss=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_image:new e.Uniform1i(ce,H.u_image),u_texsize:new e.Uniform2f(ce,H.u_texsize),u_pixel_coord_upper:new e.Uniform2f(ce,H.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,H.u_pixel_coord_lower),u_scale:new e.Uniform3f(ce,H.u_scale),u_fade:new e.Uniform1f(ce,H.u_fade)}},os=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_world:new e.Uniform2f(ce,H.u_world)}},Gi=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_world:new e.Uniform2f(ce,H.u_world),u_image:new e.Uniform1i(ce,H.u_image),u_texsize:new e.Uniform2f(ce,H.u_texsize),u_pixel_coord_upper:new e.Uniform2f(ce,H.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,H.u_pixel_coord_lower),u_scale:new e.Uniform3f(ce,H.u_scale),u_fade:new e.Uniform1f(ce,H.u_fade)}},Co=function(ce){return{u_matrix:ce}},ss=function(ce,H,ve,K){return e.extend(Co(ce),as(ve,H,K))},vu=function(ce,H){return{u_matrix:ce,u_world:H}},Ol=function(ce,H,ve,K,de){return e.extend(ss(ce,H,ve,K),{u_world:de})},pu=function(ce,H){return{u_camera_to_center_distance:new e.Uniform1f(ce,H.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(ce,H.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(ce,H.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(ce,H.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(ce,H.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(ce,H.u_matrix)}},dt=function(ce,H,ve,K){var de=ce.transform,Se,Ce;if(K.paint.get("circle-pitch-alignment")==="map"){var Xe=_n(ve,1,de.zoom);Se=!0,Ce=[Xe,Xe]}else Se=!1,Ce=de.pixelsToGLUnits;return{u_camera_to_center_distance:de.cameraToCenterDistance,u_scale_with_map:+(K.paint.get("circle-pitch-scale")==="map"),u_matrix:ce.translatePosMatrix(H.posMatrix,ve,K.paint.get("circle-translate"),K.paint.get("circle-translate-anchor")),u_pitch_with_map:+Se,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:Ce}},Dt=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_camera_to_center_distance:new e.Uniform1f(ce,H.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(ce,H.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(ce,H.u_extrude_scale),u_overscale_factor:new e.Uniform1f(ce,H.u_overscale_factor)}},or=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_inv_matrix:new e.UniformMatrix4f(ce,H.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(ce,H.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(ce,H.u_viewport_size)}},er=function(ce,H,ve){var K=_n(ve,1,H.zoom),de=Math.pow(2,H.zoom-ve.tileID.overscaledZ),Se=ve.tileID.overscaleFactor();return{u_matrix:ce,u_camera_to_center_distance:H.cameraToCenterDistance,u_pixels_to_tile_units:K,u_extrude_scale:[H.pixelsToGLUnits[0]/(K*de),H.pixelsToGLUnits[1]/(K*de)],u_overscale_factor:Se}},Er=function(ce,H,ve){return{u_matrix:ce,u_inv_matrix:H,u_camera_to_center_distance:ve.cameraToCenterDistance,u_viewport_size:[ve.width,ve.height]}},$r=function(ce,H){return{u_color:new e.UniformColor(ce,H.u_color),u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_overlay:new e.Uniform1i(ce,H.u_overlay),u_overlay_scale:new e.Uniform1f(ce,H.u_overlay_scale)}},pn=function(ce,H,ve){return ve===void 0&&(ve=1),{u_matrix:ce,u_color:H,u_overlay:0,u_overlay_scale:ve}},wn=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix)}},En=function(ce){return{u_matrix:ce}},Nn=function(ce,H){return{u_extrude_scale:new e.Uniform1f(ce,H.u_extrude_scale),u_intensity:new e.Uniform1f(ce,H.u_intensity),u_matrix:new e.UniformMatrix4f(ce,H.u_matrix)}},gn=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_world:new e.Uniform2f(ce,H.u_world),u_image:new e.Uniform1i(ce,H.u_image),u_color_ramp:new e.Uniform1i(ce,H.u_color_ramp),u_opacity:new e.Uniform1f(ce,H.u_opacity)}},Rn=function(ce,H,ve,K){return{u_matrix:ce,u_extrude_scale:_n(H,1,ve),u_intensity:K}},Cn=function(ce,H,ve,K){var de=e.create();e.ortho(de,0,ce.width,ce.height,0,0,1);var Se=ce.context.gl;return{u_matrix:de,u_world:[Se.drawingBufferWidth,Se.drawingBufferHeight],u_image:ve,u_color_ramp:K,u_opacity:H.paint.get("heatmap-opacity")}},Vn=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_image:new e.Uniform1i(ce,H.u_image),u_latrange:new e.Uniform2f(ce,H.u_latrange),u_light:new e.Uniform2f(ce,H.u_light),u_shadow:new e.UniformColor(ce,H.u_shadow),u_highlight:new e.UniformColor(ce,H.u_highlight),u_accent:new e.UniformColor(ce,H.u_accent)}},Jn=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_image:new e.Uniform1i(ce,H.u_image),u_dimension:new e.Uniform2f(ce,H.u_dimension),u_zoom:new e.Uniform1f(ce,H.u_zoom),u_maxzoom:new e.Uniform1f(ce,H.u_maxzoom),u_unpack:new e.Uniform4f(ce,H.u_unpack)}},za=function(ce,H,ve){var K=ve.paint.get("hillshade-shadow-color"),de=ve.paint.get("hillshade-highlight-color"),Se=ve.paint.get("hillshade-accent-color"),Ce=ve.paint.get("hillshade-illumination-direction")*(Math.PI/180);ve.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ce-=ce.transform.angle);var Xe=!ce.options.moving;return{u_matrix:ce.transform.calculatePosMatrix(H.tileID.toUnwrapped(),Xe),u_image:0,u_latrange:Fa(ce,H.tileID),u_light:[ve.paint.get("hillshade-exaggeration"),Ce],u_shadow:K,u_highlight:de,u_accent:Se}},Ea=function(ce,H,ve){var K=H.stride,de=e.create();return e.ortho(de,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(de,de,[0,-e.EXTENT,0]),{u_matrix:de,u_image:1,u_dimension:[K,K],u_zoom:ce.overscaledZ,u_maxzoom:ve,u_unpack:H.getUnpackVector()}};function Fa(ce,H){var ve=Math.pow(2,H.canonical.z),K=H.canonical.y;return[new e.MercatorCoordinate(0,K/ve).toLngLat().lat,new e.MercatorCoordinate(0,(K+1)/ve).toLngLat().lat]}var Oa=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_ratio:new e.Uniform1f(ce,H.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,H.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(ce,H.u_units_to_pixels)}},Zn=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_ratio:new e.Uniform1f(ce,H.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,H.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(ce,H.u_units_to_pixels),u_image:new e.Uniform1i(ce,H.u_image)}},ha=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_texsize:new e.Uniform2f(ce,H.u_texsize),u_ratio:new e.Uniform1f(ce,H.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,H.u_device_pixel_ratio),u_image:new e.Uniform1i(ce,H.u_image),u_units_to_pixels:new e.Uniform2f(ce,H.u_units_to_pixels),u_scale:new e.Uniform3f(ce,H.u_scale),u_fade:new e.Uniform1f(ce,H.u_fade)}},Ya=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_ratio:new e.Uniform1f(ce,H.u_ratio),u_device_pixel_ratio:new e.Uniform1f(ce,H.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(ce,H.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(ce,H.u_patternscale_a),u_patternscale_b:new e.Uniform2f(ce,H.u_patternscale_b),u_sdfgamma:new e.Uniform1f(ce,H.u_sdfgamma),u_image:new e.Uniform1i(ce,H.u_image),u_tex_y_a:new e.Uniform1f(ce,H.u_tex_y_a),u_tex_y_b:new e.Uniform1f(ce,H.u_tex_y_b),u_mix:new e.Uniform1f(ce,H.u_mix)}},Ja=function(ce,H,ve){var K=ce.transform;return{u_matrix:oi(ce,H,ve),u_ratio:1/_n(H,1,K.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/K.pixelsToGLUnits[0],1/K.pixelsToGLUnits[1]]}},yi=function(ce,H,ve){return e.extend(Ja(ce,H,ve),{u_image:0})},mi=function(ce,H,ve,K){var de=ce.transform,Se=Si(H,de);return{u_matrix:oi(ce,H,ve),u_texsize:H.imageAtlasTexture.size,u_ratio:1/_n(H,1,de.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[Se,K.fromScale,K.toScale],u_fade:K.t,u_units_to_pixels:[1/de.pixelsToGLUnits[0],1/de.pixelsToGLUnits[1]]}},bi=function(ce,H,ve,K,de){var Se=ce.transform,Ce=ce.lineAtlas,Xe=Si(H,Se),lt=ve.layout.get("line-cap")==="round",wt=Ce.getDash(K.from,lt),Ht=Ce.getDash(K.to,lt),nr=wt.width*de.fromScale,sr=Ht.width*de.toScale;return e.extend(Ja(ce,H,ve),{u_patternscale_a:[Xe/nr,-wt.height/2],u_patternscale_b:[Xe/sr,-Ht.height/2],u_sdfgamma:Ce.width/(Math.min(nr,sr)*256*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:wt.y,u_tex_y_b:Ht.y,u_mix:de.t})};function Si(ce,H){return 1/_n(ce,1,H.tileZoom)}function oi(ce,H,ve){return ce.translatePosMatrix(H.tileID.posMatrix,H,ve.paint.get("line-translate"),ve.paint.get("line-translate-anchor"))}var xo=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_tl_parent:new e.Uniform2f(ce,H.u_tl_parent),u_scale_parent:new e.Uniform1f(ce,H.u_scale_parent),u_buffer_scale:new e.Uniform1f(ce,H.u_buffer_scale),u_fade_t:new e.Uniform1f(ce,H.u_fade_t),u_opacity:new e.Uniform1f(ce,H.u_opacity),u_image0:new e.Uniform1i(ce,H.u_image0),u_image1:new e.Uniform1i(ce,H.u_image1),u_brightness_low:new e.Uniform1f(ce,H.u_brightness_low),u_brightness_high:new e.Uniform1f(ce,H.u_brightness_high),u_saturation_factor:new e.Uniform1f(ce,H.u_saturation_factor),u_contrast_factor:new e.Uniform1f(ce,H.u_contrast_factor),u_spin_weights:new e.Uniform3f(ce,H.u_spin_weights)}},to=function(ce,H,ve,K,de){return{u_matrix:ce,u_tl_parent:H,u_scale_parent:ve,u_buffer_scale:1,u_fade_t:K.mix,u_opacity:K.opacity*de.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:de.paint.get("raster-brightness-min"),u_brightness_high:de.paint.get("raster-brightness-max"),u_saturation_factor:_i(de.paint.get("raster-saturation")),u_contrast_factor:pa(de.paint.get("raster-contrast")),u_spin_weights:Ka(de.paint.get("raster-hue-rotate"))}};function Ka(ce){ce*=Math.PI/180;var H=Math.sin(ce),ve=Math.cos(ce);return[(2*ve+1)/3,(-Math.sqrt(3)*H-ve+1)/3,(Math.sqrt(3)*H-ve+1)/3]}function pa(ce){return ce>0?1/(1-ce):1+ce}function _i(ce){return ce>0?1-1/(1.001-ce):-ce}var fo=function(ce,H){return{u_is_size_zoom_constant:new e.Uniform1i(ce,H.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(ce,H.u_is_size_feature_constant),u_size_t:new e.Uniform1f(ce,H.u_size_t),u_size:new e.Uniform1f(ce,H.u_size),u_camera_to_center_distance:new e.Uniform1f(ce,H.u_camera_to_center_distance),u_pitch:new e.Uniform1f(ce,H.u_pitch),u_rotate_symbol:new e.Uniform1i(ce,H.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(ce,H.u_aspect_ratio),u_fade_change:new e.Uniform1f(ce,H.u_fade_change),u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(ce,H.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(ce,H.u_coord_matrix),u_is_text:new e.Uniform1i(ce,H.u_is_text),u_pitch_with_map:new e.Uniform1i(ce,H.u_pitch_with_map),u_texsize:new e.Uniform2f(ce,H.u_texsize),u_texture:new e.Uniform1i(ce,H.u_texture)}},go=function(ce,H){return{u_is_size_zoom_constant:new e.Uniform1i(ce,H.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(ce,H.u_is_size_feature_constant),u_size_t:new e.Uniform1f(ce,H.u_size_t),u_size:new e.Uniform1f(ce,H.u_size),u_camera_to_center_distance:new e.Uniform1f(ce,H.u_camera_to_center_distance),u_pitch:new e.Uniform1f(ce,H.u_pitch),u_rotate_symbol:new e.Uniform1i(ce,H.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(ce,H.u_aspect_ratio),u_fade_change:new e.Uniform1f(ce,H.u_fade_change),u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(ce,H.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(ce,H.u_coord_matrix),u_is_text:new e.Uniform1i(ce,H.u_is_text),u_pitch_with_map:new e.Uniform1i(ce,H.u_pitch_with_map),u_texsize:new e.Uniform2f(ce,H.u_texsize),u_texture:new e.Uniform1i(ce,H.u_texture),u_gamma_scale:new e.Uniform1f(ce,H.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(ce,H.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(ce,H.u_is_halo)}},ls=function(ce,H){return{u_is_size_zoom_constant:new e.Uniform1i(ce,H.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(ce,H.u_is_size_feature_constant),u_size_t:new e.Uniform1f(ce,H.u_size_t),u_size:new e.Uniform1f(ce,H.u_size),u_camera_to_center_distance:new e.Uniform1f(ce,H.u_camera_to_center_distance),u_pitch:new e.Uniform1f(ce,H.u_pitch),u_rotate_symbol:new e.Uniform1i(ce,H.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(ce,H.u_aspect_ratio),u_fade_change:new e.Uniform1f(ce,H.u_fade_change),u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(ce,H.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(ce,H.u_coord_matrix),u_is_text:new e.Uniform1i(ce,H.u_is_text),u_pitch_with_map:new e.Uniform1i(ce,H.u_pitch_with_map),u_texsize:new e.Uniform2f(ce,H.u_texsize),u_texsize_icon:new e.Uniform2f(ce,H.u_texsize_icon),u_texture:new e.Uniform1i(ce,H.u_texture),u_texture_icon:new e.Uniform1i(ce,H.u_texture_icon),u_gamma_scale:new e.Uniform1f(ce,H.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(ce,H.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(ce,H.u_is_halo)}},ks=function(ce,H,ve,K,de,Se,Ce,Xe,lt,wt){var Ht=de.transform;return{u_is_size_zoom_constant:+(ce==="constant"||ce==="source"),u_is_size_feature_constant:+(ce==="constant"||ce==="camera"),u_size_t:H?H.uSizeT:0,u_size:H?H.uSize:0,u_camera_to_center_distance:Ht.cameraToCenterDistance,u_pitch:Ht.pitch/360*2*Math.PI,u_rotate_symbol:+ve,u_aspect_ratio:Ht.width/Ht.height,u_fade_change:de.options.fadeDuration?de.symbolFadeChange:1,u_matrix:Se,u_label_plane_matrix:Ce,u_coord_matrix:Xe,u_is_text:+lt,u_pitch_with_map:+K,u_texsize:wt,u_texture:0}},Fo=function(ce,H,ve,K,de,Se,Ce,Xe,lt,wt,Ht){var nr=de.transform;return e.extend(ks(ce,H,ve,K,de,Se,Ce,Xe,lt,wt),{u_gamma_scale:K?Math.cos(nr._pitch)*nr.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+Ht})},Qs=function(ce,H,ve,K,de,Se,Ce,Xe,lt,wt){return e.extend(Fo(ce,H,ve,K,de,Se,Ce,Xe,!0,lt,!0),{u_texsize_icon:wt,u_texture_icon:1})},ms=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_opacity:new e.Uniform1f(ce,H.u_opacity),u_color:new e.UniformColor(ce,H.u_color)}},us=function(ce,H){return{u_matrix:new e.UniformMatrix4f(ce,H.u_matrix),u_opacity:new e.Uniform1f(ce,H.u_opacity),u_image:new e.Uniform1i(ce,H.u_image),u_pattern_tl_a:new e.Uniform2f(ce,H.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(ce,H.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(ce,H.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(ce,H.u_pattern_br_b),u_texsize:new e.Uniform2f(ce,H.u_texsize),u_mix:new e.Uniform1f(ce,H.u_mix),u_pattern_size_a:new e.Uniform2f(ce,H.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(ce,H.u_pattern_size_b),u_scale_a:new e.Uniform1f(ce,H.u_scale_a),u_scale_b:new e.Uniform1f(ce,H.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(ce,H.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(ce,H.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(ce,H.u_tile_units_to_pixels)}},bo=function(ce,H,ve){return{u_matrix:ce,u_opacity:H,u_color:ve}},Bl=function(ce,H,ve,K,de,Se){return e.extend(Al(K,Se,ve,de),{u_matrix:ce,u_opacity:H})},Ql={fillExtrusion:uo,fillExtrusionPattern:hu,fill:Os,fillPattern:Ss,fillOutline:os,fillOutlinePattern:Gi,circle:pu,collisionBox:Dt,collisionCircle:or,debug:$r,clippingMask:wn,heatmap:Nn,heatmapTexture:gn,hillshade:Vn,hillshadePrepare:Jn,line:Oa,lineGradient:Zn,linePattern:ha,lineSDF:Ya,raster:xo,symbolIcon:fo,symbolSDF:go,symbolTextAndIcon:ls,background:ms,backgroundPattern:us},fs;function du(ce,H,ve,K,de,Se,Ce){for(var Xe=ce.context,lt=Xe.gl,wt=ce.useProgram("collisionBox"),Ht=[],nr=0,sr=0,Ar=0;Ar<K.length;Ar++){var Nr=K[Ar],Ur=H.getTile(Nr),Or=Ur.getBucket(ve);if(!!Or){var Xr=Nr.posMatrix;(de[0]!==0||de[1]!==0)&&(Xr=ce.translatePosMatrix(Nr.posMatrix,Ur,de,Se));var sn=Ce?Or.textCollisionBox:Or.iconCollisionBox,Sn=Or.collisionCircleArray;if(Sn.length>0){var Fn=e.create(),Xn=Xr;e.mul(Fn,Or.placementInvProjMatrix,ce.transform.glCoordMatrix),e.mul(Fn,Fn,Or.placementViewportMatrix),Ht.push({circleArray:Sn,circleOffset:sr,transform:Xn,invTransform:Fn}),nr+=Sn.length/4,sr=nr}!sn||wt.draw(Xe,lt.LINES,Jr.disabled,jt.disabled,ce.colorModeForRenderPass(),We.disabled,er(Xr,ce.transform,Ur),ve.id,sn.layoutVertexBuffer,sn.indexBuffer,sn.segments,null,ce.transform.zoom,null,null,sn.collisionVertexBuffer)}}if(!(!Ce||!Ht.length)){var Qn=ce.useProgram("collisionCircle"),jn=new e.StructArrayLayout2f1f2i16;jn.resize(nr*4),jn._trim();for(var ca=0,ba=0,ya=Ht;ba<ya.length;ba+=1)for(var Ta=ya[ba],Ca=0;Ca<Ta.circleArray.length/4;Ca++){var Ha=Ca*4,ri=Ta.circleArray[Ha+0],Di=Ta.circleArray[Ha+1],li=Ta.circleArray[Ha+2],gi=Ta.circleArray[Ha+3];jn.emplace(ca++,ri,Di,li,gi,0),jn.emplace(ca++,ri,Di,li,gi,1),jn.emplace(ca++,ri,Di,li,gi,2),jn.emplace(ca++,ri,Di,li,gi,3)}(!fs||fs.length<nr*2)&&(fs=Nl(nr));for(var Ba=Xe.createIndexBuffer(fs,!0),Ri=Xe.createVertexBuffer(jn,e.collisionCircleLayout.members,!0),Oi=0,Vi=Ht;Oi<Vi.length;Oi+=1){var Ti=Vi[Oi],Ji=Er(Ti.transform,Ti.invTransform,ce.transform);Qn.draw(Xe,lt.TRIANGLES,Jr.disabled,jt.disabled,ce.colorModeForRenderPass(),We.disabled,Ji,ve.id,Ri,Ba,e.SegmentVector.simpleSegment(0,Ti.circleOffset*2,Ti.circleArray.length,Ti.circleArray.length/2),null,ce.transform.zoom,null,null,null)}Ri.destroy(),Ba.destroy()}}function Nl(ce){var H=ce*2,ve=new e.StructArrayLayout3ui6;ve.resize(H),ve._trim();for(var K=0;K<H;K++){var de=K*6;ve.uint16[de+0]=K*4+0,ve.uint16[de+1]=K*4+1,ve.uint16[de+2]=K*4+2,ve.uint16[de+3]=K*4+2,ve.uint16[de+4]=K*4+3,ve.uint16[de+5]=K*4+0}return ve}var vf=e.identity(new Float32Array(16));function Pu(ce,H,ve,K,de){if(ce.renderPass==="translucent"){var Se=jt.disabled,Ce=ce.colorModeForRenderPass(),Xe=ve.layout.get("text-variable-anchor");Xe&&Du(K,ce,ve,H,ve.layout.get("text-rotation-alignment"),ve.layout.get("text-pitch-alignment"),de),ve.paint.get("icon-opacity").constantOr(1)!==0&&Ru(ce,H,ve,K,!1,ve.paint.get("icon-translate"),ve.paint.get("icon-translate-anchor"),ve.layout.get("icon-rotation-alignment"),ve.layout.get("icon-pitch-alignment"),ve.layout.get("icon-keep-upright"),Se,Ce),ve.paint.get("text-opacity").constantOr(1)!==0&&Ru(ce,H,ve,K,!0,ve.paint.get("text-translate"),ve.paint.get("text-translate-anchor"),ve.layout.get("text-rotation-alignment"),ve.layout.get("text-pitch-alignment"),ve.layout.get("text-keep-upright"),Se,Ce),H.map.showCollisionBoxes&&(du(ce,H,ve,K,ve.paint.get("text-translate"),ve.paint.get("text-translate-anchor"),!0),du(ce,H,ve,K,ve.paint.get("icon-translate"),ve.paint.get("icon-translate-anchor"),!1))}}function gu(ce,H,ve,K,de,Se){var Ce=e.getAnchorAlignment(ce),Xe=Ce.horizontalAlign,lt=Ce.verticalAlign,wt=-(Xe-.5)*H,Ht=-(lt-.5)*ve,nr=e.evaluateVariableOffset(ce,K);return new e.Point((wt/de+nr[0])*Se,(Ht/de+nr[1])*Se)}function Du(ce,H,ve,K,de,Se,Ce){for(var Xe=H.transform,lt=de==="map",wt=Se==="map",Ht=0,nr=ce;Ht<nr.length;Ht+=1){var sr=nr[Ht],Ar=K.getTile(sr),Nr=Ar.getBucket(ve);if(!(!Nr||!Nr.text||!Nr.text.segments.get().length)){var Ur=Nr.textSizeData,Or=e.evaluateSizeForZoom(Ur,Xe.zoom),Xr=_n(Ar,1,H.transform.zoom),sn=jr(sr.posMatrix,wt,lt,H.transform,Xr),Sn=ve.layout.get("icon-text-fit")!=="none"&&Nr.hasIconData();if(Or){var Fn=Math.pow(2,Xe.zoom-Ar.tileID.overscaledZ);Es(Nr,lt,wt,Ce,e.symbolSize,Xe,sn,sr.posMatrix,Fn,Or,Sn)}}}}function Es(ce,H,ve,K,de,Se,Ce,Xe,lt,wt,Ht){var nr=ce.text.placedSymbolArray,sr=ce.text.dynamicLayoutVertexArray,Ar=ce.icon.dynamicLayoutVertexArray,Nr={};sr.clear();for(var Ur=0;Ur<nr.length;Ur++){var Or=nr.get(Ur),Xr=ce.allowVerticalPlacement&&!Or.placedOrientation,sn=!Or.hidden&&Or.crossTileID&&!Xr?K[Or.crossTileID]:null;if(!sn)Ga(Or.numGlyphs,sr);else{var Sn=new e.Point(Or.anchorX,Or.anchorY),Fn=An(Sn,ve?Xe:Ce),Xn=$n(Se.cameraToCenterDistance,Fn.signedDistanceFromCamera),Qn=de.evaluateSizeForFeature(ce.textSizeData,wt,Or)*Xn/e.ONE_EM;ve&&(Qn*=ce.tilePixelRatio/lt);for(var jn=sn.width,ca=sn.height,ba=sn.anchor,ya=sn.textOffset,Ta=sn.textBoxScale,Ca=gu(ba,jn,ca,ya,Ta,Qn),Ha=ve?An(Sn.add(Ca),Ce).point:Fn.point.add(H?Ca.rotate(-Se.angle):Ca),ri=ce.allowVerticalPlacement&&Or.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Di=0;Di<Or.numGlyphs;Di++)e.addDynamicAttributes(sr,Ha,ri);Ht&&Or.associatedIconIndex>=0&&(Nr[Or.associatedIconIndex]={shiftedAnchor:Ha,angle:ri})}}if(Ht){Ar.clear();for(var li=ce.icon.placedSymbolArray,gi=0;gi<li.length;gi++){var Ba=li.get(gi);if(Ba.hidden)Ga(Ba.numGlyphs,Ar);else{var Ri=Nr[gi];if(!Ri)Ga(Ba.numGlyphs,Ar);else for(var Oi=0;Oi<Ba.numGlyphs;Oi++)e.addDynamicAttributes(Ar,Ri.shiftedAnchor,Ri.angle)}}ce.icon.dynamicLayoutVertexBuffer.updateData(Ar)}ce.text.dynamicLayoutVertexBuffer.updateData(sr)}function Xu(ce,H,ve){return ve.iconsInText&&H?"symbolTextAndIcon":ce?"symbolSDF":"symbolIcon"}function Ru(ce,H,ve,K,de,Se,Ce,Xe,lt,wt,Ht,nr){for(var sr=ce.context,Ar=sr.gl,Nr=ce.transform,Ur=Xe==="map",Or=lt==="map",Xr=Ur&&ve.layout.get("symbol-placement")!=="point",sn=Ur&&!Or&&!Xr,Sn=ve.layout.get("symbol-sort-key").constantOr(1)!==void 0,Fn=ce.depthModeForSublayer(0,Jr.ReadOnly),Xn=ve.layout.get("text-variable-anchor"),Qn=[],jn=0,ca=K;jn<ca.length;jn+=1){var ba=ca[jn],ya=H.getTile(ba),Ta=ya.getBucket(ve);if(!!Ta){var Ca=de?Ta.text:Ta.icon;if(!(!Ca||!Ca.segments.get().length)){var Ha=Ca.programConfigurations.get(ve.id),ri=de||Ta.sdfIcons,Di=de?Ta.textSizeData:Ta.iconSizeData,li=Or||Nr.pitch!==0,gi=ce.useProgram(Xu(ri,de,Ta),Ha),Ba=e.evaluateSizeForZoom(Di,Nr.zoom),Ri=void 0,Oi=[0,0],Vi=void 0,Ti=void 0,Ji=null,ai=void 0;if(de){if(Vi=ya.glyphAtlasTexture,Ti=Ar.LINEAR,Ri=ya.glyphAtlasTexture.size,Ta.iconsInText){Oi=ya.imageAtlasTexture.size,Ji=ya.imageAtlasTexture;var Ai=Di.kind==="composite"||Di.kind==="camera";ai=li||ce.options.rotating||ce.options.zooming||Ai?Ar.LINEAR:Ar.NEAREST}}else{var To=ve.layout.get("icon-size").constantOr(0)!==1||Ta.iconsNeedLinear;Vi=ya.imageAtlasTexture,Ti=ri||ce.options.rotating||ce.options.zooming||To||li?Ar.LINEAR:Ar.NEAREST,Ri=ya.imageAtlasTexture.size}var No=_n(ya,1,ce.transform.zoom),Sl=jr(ba.posMatrix,Or,Ur,ce.transform,No),kl=Pn(ba.posMatrix,Or,Ur,ce.transform,No),$l=Xn&&Ta.hasTextData(),ql=ve.layout.get("icon-text-fit")!=="none"&&$l&&Ta.hasIconData();Xr&&Yn(Ta,ba.posMatrix,ce,de,Sl,kl,Or,wt);var _u=ce.translatePosMatrix(ba.posMatrix,ya,Se,Ce),eu=Xr||de&&Xn||ql?vf:Sl,Ns=ce.translatePosMatrix(kl,ya,Se,Ce,!0),Hu=ri&&ve.paint.get(de?"text-halo-width":"icon-halo-width").constantOr(1)!==0,_s=void 0;ri?Ta.iconsInText?_s=Qs(Di.kind,Ba,sn,Or,ce,_u,eu,Ns,Ri,Oi):_s=Fo(Di.kind,Ba,sn,Or,ce,_u,eu,Ns,de,Ri,!0):_s=ks(Di.kind,Ba,sn,Or,ce,_u,eu,Ns,de,Ri);var cl={program:gi,buffers:Ca,uniformValues:_s,atlasTexture:Vi,atlasTextureIcon:Ji,atlasInterpolation:Ti,atlasInterpolationIcon:ai,isSDF:ri,hasHalo:Hu};if(Sn)for(var tu=Ca.segments.get(),Hl=0,ru=tu;Hl<ru.length;Hl+=1){var Lf=ru[Hl];Qn.push({segments:new e.SegmentVector([Lf]),sortKey:Lf.sortKey,state:cl})}else Qn.push({segments:Ca.segments,sortKey:0,state:cl})}}}Sn&&Qn.sort(function(Pf,Df){return Pf.sortKey-Df.sortKey});for(var Zu=0,hs=Qn;Zu<hs.length;Zu+=1){var mf=hs[Zu],Cs=mf.state;if(sr.activeTexture.set(Ar.TEXTURE0),Cs.atlasTexture.bind(Cs.atlasInterpolation,Ar.CLAMP_TO_EDGE),Cs.atlasTextureIcon&&(sr.activeTexture.set(Ar.TEXTURE1),Cs.atlasTextureIcon&&Cs.atlasTextureIcon.bind(Cs.atlasInterpolationIcon,Ar.CLAMP_TO_EDGE)),Cs.isSDF){var xf=Cs.uniformValues;Cs.hasHalo&&(xf.u_is_halo=1,Iu(Cs.buffers,mf.segments,ve,ce,Cs.program,Fn,Ht,nr,xf)),xf.u_is_halo=0}Iu(Cs.buffers,mf.segments,ve,ce,Cs.program,Fn,Ht,nr,Cs.uniformValues)}}function Iu(ce,H,ve,K,de,Se,Ce,Xe,lt){var wt=K.context,Ht=wt.gl;de.draw(wt,Ht.TRIANGLES,Se,Ce,Xe,We.disabled,lt,ve.id,ce.layoutVertexBuffer,ce.indexBuffer,H,ve.paint,K.transform.zoom,ce.programConfigurations.get(ve.id),ce.dynamicLayoutVertexBuffer,ce.opacityVertexBuffer)}function Oo(ce,H,ve,K){if(ce.renderPass==="translucent"){var de=ve.paint.get("circle-opacity"),Se=ve.paint.get("circle-stroke-width"),Ce=ve.paint.get("circle-stroke-opacity"),Xe=ve.layout.get("circle-sort-key").constantOr(1)!==void 0;if(!(de.constantOr(1)===0&&(Se.constantOr(1)===0||Ce.constantOr(1)===0))){for(var lt=ce.context,wt=lt.gl,Ht=ce.depthModeForSublayer(0,Jr.ReadOnly),nr=jt.disabled,sr=ce.colorModeForRenderPass(),Ar=[],Nr=0;Nr<K.length;Nr++){var Ur=K[Nr],Or=H.getTile(Ur),Xr=Or.getBucket(ve);if(!!Xr){var sn=Xr.programConfigurations.get(ve.id),Sn=ce.useProgram("circle",sn),Fn=Xr.layoutVertexBuffer,Xn=Xr.indexBuffer,Qn=dt(ce,Ur,Or,ve),jn={programConfiguration:sn,program:Sn,layoutVertexBuffer:Fn,indexBuffer:Xn,uniformValues:Qn};if(Xe)for(var ca=Xr.segments.get(),ba=0,ya=ca;ba<ya.length;ba+=1){var Ta=ya[ba];Ar.push({segments:new e.SegmentVector([Ta]),sortKey:Ta.sortKey,state:jn})}else Ar.push({segments:Xr.segments,sortKey:0,state:jn})}}Xe&&Ar.sort(function(Ti,Ji){return Ti.sortKey-Ji.sortKey});for(var Ca=0,Ha=Ar;Ca<Ha.length;Ca+=1){var ri=Ha[Ca],Di=ri.state,li=Di.programConfiguration,gi=Di.program,Ba=Di.layoutVertexBuffer,Ri=Di.indexBuffer,Oi=Di.uniformValues,Vi=ri.segments;gi.draw(lt,wt.TRIANGLES,Ht,nr,sr,We.disabled,Oi,ve.id,Ba,Ri,Vi,ve.paint,ce.transform.zoom,li)}}}}function zu(ce,H,ve,K){if(ve.paint.get("heatmap-opacity")!==0)if(ce.renderPass==="offscreen"){var de=ce.context,Se=de.gl,Ce=jt.disabled,Xe=new _e([Se.ONE,Se.ONE],e.Color.transparent,[!0,!0,!0,!0]);$u(de,ce,ve),de.clear({color:e.Color.transparent});for(var lt=0;lt<K.length;lt++){var wt=K[lt];if(!H.hasRenderableParent(wt)){var Ht=H.getTile(wt),nr=Ht.getBucket(ve);if(!!nr){var sr=nr.programConfigurations.get(ve.id),Ar=ce.useProgram("heatmap",sr),Nr=ce.transform,Ur=Nr.zoom;Ar.draw(de,Se.TRIANGLES,Jr.disabled,Ce,Xe,We.disabled,Rn(wt.posMatrix,Ht,Ur,ve.paint.get("heatmap-intensity")),ve.id,nr.layoutVertexBuffer,nr.indexBuffer,nr.segments,ve.paint,ce.transform.zoom,sr)}}}de.viewport.set([0,0,ce.width,ce.height])}else ce.renderPass==="translucent"&&(ce.context.setColorMode(ce.colorModeForRenderPass()),yu(ce,ve))}function $u(ce,H,ve){var K=ce.gl;ce.activeTexture.set(K.TEXTURE1),ce.viewport.set([0,0,H.width/4,H.height/4]);var de=ve.heatmapFbo;if(de)K.bindTexture(K.TEXTURE_2D,de.colorAttachment.get()),ce.bindFramebuffer.set(de.framebuffer);else{var Se=K.createTexture();K.bindTexture(K.TEXTURE_2D,Se),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_S,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_WRAP_T,K.CLAMP_TO_EDGE),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MIN_FILTER,K.LINEAR),K.texParameteri(K.TEXTURE_2D,K.TEXTURE_MAG_FILTER,K.LINEAR),de=ve.heatmapFbo=ce.createFramebuffer(H.width/4,H.height/4,!1),xs(ce,H,Se,de)}}function xs(ce,H,ve,K){var de=ce.gl,Se=ce.extRenderToTextureHalfFloat?ce.extTextureHalfFloat.HALF_FLOAT_OES:de.UNSIGNED_BYTE;de.texImage2D(de.TEXTURE_2D,0,de.RGBA,H.width/4,H.height/4,0,de.RGBA,Se,null),K.colorAttachment.set(ve)}function yu(ce,H){var ve=ce.context,K=ve.gl,de=H.heatmapFbo;if(!!de){ve.activeTexture.set(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,de.colorAttachment.get()),ve.activeTexture.set(K.TEXTURE1);var Se=H.colorRampTexture;Se||(Se=H.colorRampTexture=new e.Texture(ve,H.colorRamp,K.RGBA)),Se.bind(K.LINEAR,K.CLAMP_TO_EDGE),ce.useProgram("heatmapTexture").draw(ve,K.TRIANGLES,Jr.disabled,jt.disabled,ce.colorModeForRenderPass(),We.disabled,Cn(ce,H,0,1),H.id,ce.viewportBuffer,ce.quadTriangleIndexBuffer,ce.viewportSegments,H.paint,ce.transform.zoom)}}function mu(ce,H,ve,K){if(ce.renderPass==="translucent"){var de=ve.paint.get("line-opacity"),Se=ve.paint.get("line-width");if(!(de.constantOr(1)===0||Se.constantOr(1)===0)){var Ce=ce.depthModeForSublayer(0,Jr.ReadOnly),Xe=ce.colorModeForRenderPass(),lt=ve.paint.get("line-dasharray"),wt=ve.paint.get("line-pattern"),Ht=wt.constantOr(1),nr=ve.paint.get("line-gradient"),sr=ve.getCrossfadeParameters(),Ar=Ht?"linePattern":lt?"lineSDF":nr?"lineGradient":"line",Nr=ce.context,Ur=Nr.gl,Or=!0;if(nr){Nr.activeTexture.set(Ur.TEXTURE0);var Xr=ve.gradientTexture;if(!ve.gradient)return;Xr||(Xr=ve.gradientTexture=new e.Texture(Nr,ve.gradient,Ur.RGBA)),Xr.bind(Ur.LINEAR,Ur.CLAMP_TO_EDGE)}for(var sn=0,Sn=K;sn<Sn.length;sn+=1){var Fn=Sn[sn],Xn=H.getTile(Fn);if(!(Ht&&!Xn.patternsLoaded())){var Qn=Xn.getBucket(ve);if(!!Qn){var jn=Qn.programConfigurations.get(ve.id),ca=ce.context.program.get(),ba=ce.useProgram(Ar,jn),ya=Or||ba.program!==ca,Ta=wt.constantOr(null);if(Ta&&Xn.imageAtlas){var Ca=Xn.imageAtlas,Ha=Ca.patternPositions[Ta.to.toString()],ri=Ca.patternPositions[Ta.from.toString()];Ha&&ri&&jn.setConstantPatternPositions(Ha,ri)}var Di=Ht?mi(ce,Xn,ve,sr):lt?bi(ce,Xn,ve,lt,sr):nr?yi(ce,Xn,ve):Ja(ce,Xn,ve);Ht?(Nr.activeTexture.set(Ur.TEXTURE0),Xn.imageAtlasTexture.bind(Ur.LINEAR,Ur.CLAMP_TO_EDGE),jn.updatePaintBuffers(sr)):lt&&(ya||ce.lineAtlas.dirty)&&(Nr.activeTexture.set(Ur.TEXTURE0),ce.lineAtlas.bind(Nr)),ba.draw(Nr,Ur.TRIANGLES,Ce,ce.stencilModeForClipping(Fn),Xe,We.disabled,Di,ve.id,Qn.layoutVertexBuffer,Qn.indexBuffer,Qn.segments,ve.paint,ce.transform.zoom,jn),Or=!1}}}}}}function Fu(ce,H,ve,K){var de=ve.paint.get("fill-color"),Se=ve.paint.get("fill-opacity");if(Se.constantOr(1)!==0){var Ce=ce.colorModeForRenderPass(),Xe=ve.paint.get("fill-pattern"),lt=ce.opaquePassEnabledForLayer()&&!Xe.constantOr(1)&&de.constantOr(e.Color.transparent).a===1&&Se.constantOr(0)===1?"opaque":"translucent";if(ce.renderPass===lt){var wt=ce.depthModeForSublayer(1,ce.renderPass==="opaque"?Jr.ReadWrite:Jr.ReadOnly);Re(ce,H,ve,K,wt,Ce,!1)}if(ce.renderPass==="translucent"&&ve.paint.get("fill-antialias")){var Ht=ce.depthModeForSublayer(ve.getPaintProperty("fill-outline-color")?2:0,Jr.ReadOnly);Re(ce,H,ve,K,Ht,Ce,!0)}}}function Re(ce,H,ve,K,de,Se,Ce){var Xe=ce.context.gl,lt=ve.paint.get("fill-pattern"),wt=lt&&lt.constantOr(1),Ht=ve.getCrossfadeParameters(),nr,sr,Ar,Nr,Ur;Ce?(sr=wt&&!ve.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",nr=Xe.LINES):(sr=wt?"fillPattern":"fill",nr=Xe.TRIANGLES);for(var Or=0,Xr=K;Or<Xr.length;Or+=1){var sn=Xr[Or],Sn=H.getTile(sn);if(!(wt&&!Sn.patternsLoaded())){var Fn=Sn.getBucket(ve);if(!!Fn){var Xn=Fn.programConfigurations.get(ve.id),Qn=ce.useProgram(sr,Xn);wt&&(ce.context.activeTexture.set(Xe.TEXTURE0),Sn.imageAtlasTexture.bind(Xe.LINEAR,Xe.CLAMP_TO_EDGE),Xn.updatePaintBuffers(Ht));var jn=lt.constantOr(null);if(jn&&Sn.imageAtlas){var ca=Sn.imageAtlas,ba=ca.patternPositions[jn.to.toString()],ya=ca.patternPositions[jn.from.toString()];ba&&ya&&Xn.setConstantPatternPositions(ba,ya)}var Ta=ce.translatePosMatrix(sn.posMatrix,Sn,ve.paint.get("fill-translate"),ve.paint.get("fill-translate-anchor"));if(!Ce)Nr=Fn.indexBuffer,Ur=Fn.segments,Ar=wt?ss(Ta,ce,Ht,Sn):Co(Ta);else{Nr=Fn.indexBuffer2,Ur=Fn.segments2;var Ca=[Xe.drawingBufferWidth,Xe.drawingBufferHeight];Ar=sr==="fillOutlinePattern"&&wt?Ol(Ta,ce,Ht,Sn,Ca):vu(Ta,Ca)}Qn.draw(ce.context,nr,de,ce.stencilModeForClipping(sn),Se,We.disabled,Ar,ve.id,Fn.layoutVertexBuffer,Nr,Ur,ve.paint,ce.transform.zoom,Xn)}}}}function Ge(ce,H,ve,K){var de=ve.paint.get("fill-extrusion-opacity");if(de!==0&&ce.renderPass==="translucent"){var Se=new Jr(ce.context.gl.LEQUAL,Jr.ReadWrite,ce.depthRangeFor3D);if(de===1&&!ve.paint.get("fill-extrusion-pattern").constantOr(1)){var Ce=ce.colorModeForRenderPass();et(ce,H,ve,K,Se,jt.disabled,Ce)}else et(ce,H,ve,K,Se,jt.disabled,_e.disabled),et(ce,H,ve,K,Se,ce.stencilModeFor3D(),ce.colorModeForRenderPass())}}function et(ce,H,ve,K,de,Se,Ce){for(var Xe=ce.context,lt=Xe.gl,wt=ve.paint.get("fill-extrusion-pattern"),Ht=wt.constantOr(1),nr=ve.getCrossfadeParameters(),sr=ve.paint.get("fill-extrusion-opacity"),Ar=0,Nr=K;Ar<Nr.length;Ar+=1){var Ur=Nr[Ar],Or=H.getTile(Ur),Xr=Or.getBucket(ve);if(!!Xr){var sn=Xr.programConfigurations.get(ve.id),Sn=ce.useProgram(Ht?"fillExtrusionPattern":"fillExtrusion",sn);Ht&&(ce.context.activeTexture.set(lt.TEXTURE0),Or.imageAtlasTexture.bind(lt.LINEAR,lt.CLAMP_TO_EDGE),sn.updatePaintBuffers(nr));var Fn=wt.constantOr(null);if(Fn&&Or.imageAtlas){var Xn=Or.imageAtlas,Qn=Xn.patternPositions[Fn.to.toString()],jn=Xn.patternPositions[Fn.from.toString()];Qn&&jn&&sn.setConstantPatternPositions(Qn,jn)}var ca=ce.translatePosMatrix(Ur.posMatrix,Or,ve.paint.get("fill-extrusion-translate"),ve.paint.get("fill-extrusion-translate-anchor")),ba=ve.paint.get("fill-extrusion-vertical-gradient"),ya=Ht?Fs(ca,ce,ba,sr,Ur,nr,Or):is(ca,ce,ba,sr);Sn.draw(Xe,Xe.gl.TRIANGLES,de,Se,Ce,We.backCCW,ya,ve.id,Xr.layoutVertexBuffer,Xr.indexBuffer,Xr.segments,ve.paint,ce.transform.zoom,sn)}}}function it(ce,H,ve,K){if(!(ce.renderPass!=="offscreen"&&ce.renderPass!=="translucent")){for(var de=ce.context,Se=H.getSource().maxzoom,Ce=ce.depthModeForSublayer(0,Jr.ReadOnly),Xe=ce.colorModeForRenderPass(),lt=ce.renderPass==="translucent"?ce.stencilConfigForOverlap(K):[{},K],wt=lt[0],Ht=lt[1],nr=0,sr=Ht;nr<sr.length;nr+=1){var Ar=sr[nr],Nr=H.getTile(Ar);Nr.needsHillshadePrepare&&ce.renderPass==="offscreen"?gt(ce,Nr,ve,Se,Ce,jt.disabled,Xe):ce.renderPass==="translucent"&&mt(ce,Nr,ve,Ce,wt[Ar.overscaledZ],Xe)}de.viewport.set([0,0,ce.width,ce.height])}}function mt(ce,H,ve,K,de,Se){var Ce=ce.context,Xe=Ce.gl,lt=H.fbo;if(!!lt){var wt=ce.useProgram("hillshade");Ce.activeTexture.set(Xe.TEXTURE0),Xe.bindTexture(Xe.TEXTURE_2D,lt.colorAttachment.get());var Ht=za(ce,H,ve);wt.draw(Ce,Xe.TRIANGLES,K,de,Se,We.disabled,Ht,ve.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments)}}function gt(ce,H,ve,K,de,Se,Ce){var Xe=ce.context,lt=Xe.gl,wt=H.dem;if(wt&&wt.data){var Ht=wt.dim,nr=wt.stride,sr=wt.getPixels();if(Xe.activeTexture.set(lt.TEXTURE1),Xe.pixelStoreUnpackPremultiplyAlpha.set(!1),H.demTexture=H.demTexture||ce.getTileTexture(nr),H.demTexture){var Ar=H.demTexture;Ar.update(sr,{premultiply:!1}),Ar.bind(lt.NEAREST,lt.CLAMP_TO_EDGE)}else H.demTexture=new e.Texture(Xe,sr,lt.RGBA,{premultiply:!1}),H.demTexture.bind(lt.NEAREST,lt.CLAMP_TO_EDGE);Xe.activeTexture.set(lt.TEXTURE0);var Nr=H.fbo;if(!Nr){var Ur=new e.Texture(Xe,{width:Ht,height:Ht,data:null},lt.RGBA);Ur.bind(lt.LINEAR,lt.CLAMP_TO_EDGE),Nr=H.fbo=Xe.createFramebuffer(Ht,Ht,!0),Nr.colorAttachment.set(Ur.texture)}Xe.bindFramebuffer.set(Nr.framebuffer),Xe.viewport.set([0,0,Ht,Ht]),ce.useProgram("hillshadePrepare").draw(Xe,lt.TRIANGLES,de,Se,Ce,We.disabled,Ea(H.tileID,wt,K),ve.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments),H.needsHillshadePrepare=!1}}function _t(ce,H,ve,K){if(ce.renderPass==="translucent"&&ve.paint.get("raster-opacity")!==0&&!!K.length)for(var de=ce.context,Se=de.gl,Ce=H.getSource(),Xe=ce.useProgram("raster"),lt=ce.colorModeForRenderPass(),wt=Ce instanceof X?[{},K]:ce.stencilConfigForOverlap(K),Ht=wt[0],nr=wt[1],sr=nr[nr.length-1].overscaledZ,Ar=!ce.options.moving,Nr=0,Ur=nr;Nr<Ur.length;Nr+=1){var Or=Ur[Nr],Xr=ce.depthModeForSublayer(Or.overscaledZ-sr,ve.paint.get("raster-opacity")===1?Jr.ReadWrite:Jr.ReadOnly,Se.LESS),sn=H.getTile(Or),Sn=ce.transform.calculatePosMatrix(Or.toUnwrapped(),Ar);sn.registerFadeDuration(ve.paint.get("raster-fade-duration"));var Fn=H.findLoadedParent(Or,0),Xn=ar(sn,Fn,H,ve,ce.transform),Qn=void 0,jn=void 0,ca=ve.paint.get("raster-resampling")==="nearest"?Se.NEAREST:Se.LINEAR;de.activeTexture.set(Se.TEXTURE0),sn.texture.bind(ca,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST),de.activeTexture.set(Se.TEXTURE1),Fn?(Fn.texture.bind(ca,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST),Qn=Math.pow(2,Fn.tileID.overscaledZ-sn.tileID.overscaledZ),jn=[sn.tileID.canonical.x*Qn%1,sn.tileID.canonical.y*Qn%1]):sn.texture.bind(ca,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST);var ba=to(Sn,jn||[0,0],Qn||1,Xn,ve);Ce instanceof X?Xe.draw(de,Se.TRIANGLES,Xr,jt.disabled,lt,We.disabled,ba,ve.id,Ce.boundsBuffer,ce.quadTriangleIndexBuffer,Ce.boundsSegments):Xe.draw(de,Se.TRIANGLES,Xr,Ht[Or.overscaledZ],lt,We.disabled,ba,ve.id,ce.rasterBoundsBuffer,ce.quadTriangleIndexBuffer,ce.rasterBoundsSegments)}}function ar(ce,H,ve,K,de){var Se=K.paint.get("raster-fade-duration");if(Se>0){var Ce=e.browser.now(),Xe=(Ce-ce.timeAdded)/Se,lt=H?(Ce-H.timeAdded)/Se:-1,wt=ve.getSource(),Ht=de.coveringZoomLevel({tileSize:wt.tileSize,roundZoom:wt.roundZoom}),nr=!H||Math.abs(H.tileID.overscaledZ-Ht)>Math.abs(ce.tileID.overscaledZ-Ht),sr=nr&&ce.refreshedUponExpiration?1:e.clamp(nr?Xe:1-lt,0,1);return ce.refreshedUponExpiration&&Xe>=1&&(ce.refreshedUponExpiration=!1),H?{opacity:1,mix:1-sr}:{opacity:sr,mix:0}}else return{opacity:1,mix:0}}function fr(ce,H,ve){var K=ve.paint.get("background-color"),de=ve.paint.get("background-opacity");if(de!==0){var Se=ce.context,Ce=Se.gl,Xe=ce.transform,lt=Xe.tileSize,wt=ve.paint.get("background-pattern");if(!ce.isPatternMissing(wt)){var Ht=!wt&&K.a===1&&de===1&&ce.opaquePassEnabledForLayer()?"opaque":"translucent";if(ce.renderPass===Ht){var nr=jt.disabled,sr=ce.depthModeForSublayer(0,Ht==="opaque"?Jr.ReadWrite:Jr.ReadOnly),Ar=ce.colorModeForRenderPass(),Nr=ce.useProgram(wt?"backgroundPattern":"background"),Ur=Xe.coveringTiles({tileSize:lt});wt&&(Se.activeTexture.set(Ce.TEXTURE0),ce.imageManager.bind(ce.context));for(var Or=ve.getCrossfadeParameters(),Xr=0,sn=Ur;Xr<sn.length;Xr+=1){var Sn=sn[Xr],Fn=ce.transform.calculatePosMatrix(Sn.toUnwrapped()),Xn=wt?Bl(Fn,de,ce,wt,{tileID:Sn,tileSize:lt},Or):bo(Fn,de,K);Nr.draw(Se,Ce.TRIANGLES,sr,nr,Ar,We.disabled,Xn,ve.id,ce.tileExtentBuffer,ce.quadTriangleIndexBuffer,ce.tileExtentSegments)}}}}}var rr=new e.Color(1,0,0,1),pr=new e.Color(0,1,0,1),kr=new e.Color(0,0,1,1),Hr=new e.Color(1,0,1,1),Qr=new e.Color(0,1,1,1);function mn(ce){var H=ce.transform.padding,ve=3;Gn(ce,ce.transform.height-(H.top||0),ve,rr),Gn(ce,H.bottom||0,ve,pr),ga(ce,H.left||0,ve,kr),ga(ce,ce.transform.width-(H.right||0),ve,Hr);var K=ce.transform.centerPoint;Ln(ce,K.x,ce.transform.height-K.y,Qr)}function Ln(ce,H,ve,K){var de=20,Se=2;xa(ce,H-Se/2,ve-de/2,Se,de,K),xa(ce,H-de/2,ve-Se/2,de,Se,K)}function Gn(ce,H,ve,K){xa(ce,0,H+ve/2,ce.transform.width,ve,K)}function ga(ce,H,ve,K){xa(ce,H-ve/2,0,ve,ce.transform.height,K)}function xa(ce,H,ve,K,de,Se){var Ce=ce.context,Xe=Ce.gl;Xe.enable(Xe.SCISSOR_TEST),Xe.scissor(H*e.browser.devicePixelRatio,ve*e.browser.devicePixelRatio,K*e.browser.devicePixelRatio,de*e.browser.devicePixelRatio),Ce.clear({color:Se}),Xe.disable(Xe.SCISSOR_TEST)}function ja(ce,H,ve){for(var K=0;K<ve.length;K++)Wa(ce,H,ve[K])}function Wa(ce,H,ve){var K=ce.context,de=K.gl,Se=ve.posMatrix,Ce=ce.useProgram("debug"),Xe=Jr.disabled,lt=jt.disabled,wt=ce.colorModeForRenderPass(),Ht="$debug";K.activeTexture.set(de.TEXTURE0),ce.emptyTexture.bind(de.LINEAR,de.CLAMP_TO_EDGE),Ce.draw(K,de.LINE_STRIP,Xe,lt,wt,We.disabled,pn(Se,e.Color.red),Ht,ce.debugBuffer,ce.tileBorderIndexBuffer,ce.debugSegments);var nr=H.getTileByID(ve.key).latestRawTileData,sr=nr&&nr.byteLength||0,Ar=Math.floor(sr/1024),Nr=H.getTile(ve).tileSize,Ur=512/Math.min(Nr,512)*(ve.overscaledZ/ce.transform.zoom)*.5,Or=ve.canonical.toString();ve.overscaledZ!==ve.canonical.z&&(Or+=" => "+ve.overscaledZ);var Xr=Or+" "+Ar+"kb";qa(ce,Xr),Ce.draw(K,de.TRIANGLES,Xe,lt,_e.alphaBlended,We.disabled,pn(Se,e.Color.transparent,Ur),Ht,ce.debugBuffer,ce.quadTriangleIndexBuffer,ce.debugSegments)}function qa(ce,H){ce.initDebugOverlayCanvas();var ve=ce.debugOverlayCanvas,K=ce.context.gl,de=ce.debugOverlayCanvas.getContext("2d");de.clearRect(0,0,ve.width,ve.height),de.shadowColor="white",de.shadowBlur=2,de.lineWidth=1.5,de.strokeStyle="white",de.textBaseline="top",de.font="bold "+36+"px Open Sans, sans-serif",de.fillText(H,5,5),de.strokeText(H,5,5),ce.debugOverlayTexture.update(ve),ce.debugOverlayTexture.bind(K.LINEAR,K.CLAMP_TO_EDGE)}function pi(ce,H,ve){var K=ce.context,de=ve.implementation;if(ce.renderPass==="offscreen"){var Se=de.prerender;Se&&(ce.setCustomLayerDefaults(),K.setColorMode(ce.colorModeForRenderPass()),Se.call(de,K.gl,ce.transform.customLayerMatrix()),K.setDirty(),ce.setBaseState())}else if(ce.renderPass==="translucent"){ce.setCustomLayerDefaults(),K.setColorMode(ce.colorModeForRenderPass()),K.setStencilMode(jt.disabled);var Ce=de.renderingMode==="3d"?new Jr(ce.context.gl.LEQUAL,Jr.ReadWrite,ce.depthRangeFor3D):ce.depthModeForSublayer(0,Jr.ReadOnly);K.setDepthMode(Ce),de.render(K.gl,ce.transform.customLayerMatrix()),K.setDirty(),ce.setBaseState(),K.bindFramebuffer.set(null)}}var oo={symbol:Pu,circle:Oo,heatmap:zu,line:mu,fill:Fu,"fill-extrusion":Ge,hillshade:it,raster:_t,background:fr,debug:ja,custom:pi},ti=function(H,ve){this.context=new Qe(H),this.transform=ve,this._tileTextures={},this.setup(),this.numSublayers=rt.maxUnderzooming+rt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ma,this.gpuTimers={}};ti.prototype.resize=function(H,ve){if(this.width=H*e.browser.devicePixelRatio,this.height=ve*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var K=0,de=this.style._order;K<de.length;K+=1){var Se=de[K];this.style._layers[Se].resize()}},ti.prototype.setup=function(){var H=this.context,ve=new e.StructArrayLayout2i4;ve.emplaceBack(0,0),ve.emplaceBack(e.EXTENT,0),ve.emplaceBack(0,e.EXTENT),ve.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=H.createVertexBuffer(ve,nl.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var K=new e.StructArrayLayout2i4;K.emplaceBack(0,0),K.emplaceBack(e.EXTENT,0),K.emplaceBack(0,e.EXTENT),K.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=H.createVertexBuffer(K,nl.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var de=new e.StructArrayLayout4i8;de.emplaceBack(0,0,0,0),de.emplaceBack(e.EXTENT,0,e.EXTENT,0),de.emplaceBack(0,e.EXTENT,0,e.EXTENT),de.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=H.createVertexBuffer(de,Y.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Se=new e.StructArrayLayout2i4;Se.emplaceBack(0,0),Se.emplaceBack(1,0),Se.emplaceBack(0,1),Se.emplaceBack(1,1),this.viewportBuffer=H.createVertexBuffer(Se,nl.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Ce=new e.StructArrayLayout1ui2;Ce.emplaceBack(0),Ce.emplaceBack(1),Ce.emplaceBack(3),Ce.emplaceBack(2),Ce.emplaceBack(0),this.tileBorderIndexBuffer=H.createIndexBuffer(Ce);var Xe=new e.StructArrayLayout3ui6;Xe.emplaceBack(0,1,2),Xe.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=H.createIndexBuffer(Xe),this.emptyTexture=new e.Texture(H,{width:1,height:1,data:new Uint8Array([0,0,0,0])},H.gl.RGBA);var lt=this.context.gl;this.stencilClearMode=new jt({func:lt.ALWAYS,mask:0},0,255,lt.ZERO,lt.ZERO,lt.ZERO)},ti.prototype.clearStencil=function(){var H=this.context,ve=H.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var K=e.create();e.ortho(K,0,this.width,this.height,0,0,1),e.scale(K,K,[ve.drawingBufferWidth,ve.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(H,ve.TRIANGLES,Jr.disabled,this.stencilClearMode,_e.disabled,We.disabled,En(K),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},ti.prototype._renderTileClippingMasks=function(H,ve){if(!(this.currentStencilSource===H.source||!H.isTileClipped()||!ve||!ve.length)){this.currentStencilSource=H.source;var K=this.context,de=K.gl;this.nextStencilID+ve.length>256&&this.clearStencil(),K.setColorMode(_e.disabled),K.setDepthMode(Jr.disabled);var Se=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var Ce=0,Xe=ve;Ce<Xe.length;Ce+=1){var lt=Xe[Ce],wt=this._tileClippingMaskIDs[lt.key]=this.nextStencilID++;Se.draw(K,de.TRIANGLES,Jr.disabled,new jt({func:de.ALWAYS,mask:0},wt,255,de.KEEP,de.KEEP,de.REPLACE),_e.disabled,We.disabled,En(lt.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},ti.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var H=this.nextStencilID++,ve=this.context.gl;return new jt({func:ve.NOTEQUAL,mask:255},H,255,ve.KEEP,ve.KEEP,ve.REPLACE)},ti.prototype.stencilModeForClipping=function(H){var ve=this.context.gl;return new jt({func:ve.EQUAL,mask:255},this._tileClippingMaskIDs[H.key],0,ve.KEEP,ve.KEEP,ve.REPLACE)},ti.prototype.stencilConfigForOverlap=function(H){var ve,K=this.context.gl,de=H.sort(function(wt,Ht){return Ht.overscaledZ-wt.overscaledZ}),Se=de[de.length-1].overscaledZ,Ce=de[0].overscaledZ-Se+1;if(Ce>1){this.currentStencilSource=void 0,this.nextStencilID+Ce>256&&this.clearStencil();for(var Xe={},lt=0;lt<Ce;lt++)Xe[lt+Se]=new jt({func:K.GEQUAL,mask:255},lt+this.nextStencilID,255,K.KEEP,K.KEEP,K.REPLACE);return this.nextStencilID+=Ce,[Xe,de]}return[(ve={},ve[Se]=jt.disabled,ve),de]},ti.prototype.colorModeForRenderPass=function(){var H=this.context.gl;if(this._showOverdrawInspector){var ve=8,K=1/ve;return new _e([H.CONSTANT_COLOR,H.ONE],new e.Color(K,K,K,0),[!0,!0,!0,!0])}else return this.renderPass==="opaque"?_e.unblended:_e.alphaBlended},ti.prototype.depthModeForSublayer=function(H,ve,K){if(!this.opaquePassEnabledForLayer())return Jr.disabled;var de=1-((1+this.currentLayer)*this.numSublayers+H)*this.depthEpsilon;return new Jr(K||this.context.gl.LEQUAL,ve,[de,de])},ti.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},ti.prototype.render=function(H,ve){var K=this;this.style=H,this.options=ve,this.lineAtlas=H.lineAtlas,this.imageManager=H.imageManager,this.glyphManager=H.glyphManager,this.symbolFadeChange=H.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var de=this.style._order,Se=this.style.sourceCaches;for(var Ce in Se){var Xe=Se[Ce];Xe.used&&Xe.prepare(this.context)}var lt={},wt={},Ht={};for(var nr in Se){var sr=Se[nr];lt[nr]=sr.getVisibleCoordinates(),wt[nr]=lt[nr].slice().reverse(),Ht[nr]=sr.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Ar=0;Ar<de.length;Ar++){var Nr=de[Ar];if(this.style._layers[Nr].is3D()){this.opaquePassCutoff=Ar;break}}this.renderPass="offscreen";for(var Ur=0,Or=de;Ur<Or.length;Ur+=1){var Xr=Or[Ur],sn=this.style._layers[Xr];if(!(!sn.hasOffscreenPass()||sn.isHidden(this.transform.zoom))){var Sn=wt[sn.source];sn.type!=="custom"&&!Sn.length||this.renderLayer(this,Se[sn.source],sn,Sn)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:ve.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=ve.showOverdrawInspector,this.depthRangeFor3D=[0,1-(H._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=de.length-1;this.currentLayer>=0;this.currentLayer--){var Fn=this.style._layers[de[this.currentLayer]],Xn=Se[Fn.source],Qn=lt[Fn.source];this._renderTileClippingMasks(Fn,Qn),this.renderLayer(this,Xn,Fn,Qn)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<de.length;this.currentLayer++){var jn=this.style._layers[de[this.currentLayer]],ca=Se[jn.source],ba=(jn.type==="symbol"?Ht:wt)[jn.source];this._renderTileClippingMasks(jn,lt[jn.source]),this.renderLayer(this,ca,jn,ba)}if(this.options.showTileBoundaries){var ya,Ta,Ca=e.values(this.style._layers);Ca.forEach(function(Ha){Ha.source&&!Ha.isHidden(K.transform.zoom)&&(Ha.source!==(Ta&&Ta.id)&&(Ta=K.style.sourceCaches[Ha.source]),(!ya||ya.getSource().maxzoom<Ta.getSource().maxzoom)&&(ya=Ta))}),ya&&oo.debug(this,ya,ya.getVisibleCoordinates())}this.options.showPadding&&mn(this),this.context.setDefault()},ti.prototype.renderLayer=function(H,ve,K,de){K.isHidden(this.transform.zoom)||K.type!=="background"&&K.type!=="custom"&&!de.length||(this.id=K.id,this.gpuTimingStart(K),oo[K.type](H,ve,K,de,this.style.placement.variableOffsets),this.gpuTimingEnd())},ti.prototype.gpuTimingStart=function(H){if(!!this.options.gpuTiming){var ve=this.context.extTimerQuery,K=this.gpuTimers[H.id];K||(K=this.gpuTimers[H.id]={calls:0,cpuTime:0,query:ve.createQueryEXT()}),K.calls++,ve.beginQueryEXT(ve.TIME_ELAPSED_EXT,K.query)}},ti.prototype.gpuTimingEnd=function(){if(!!this.options.gpuTiming){var H=this.context.extTimerQuery;H.endQueryEXT(H.TIME_ELAPSED_EXT)}},ti.prototype.collectGpuTimers=function(){var H=this.gpuTimers;return this.gpuTimers={},H},ti.prototype.queryGpuTimers=function(H){var ve={};for(var K in H){var de=H[K],Se=this.context.extTimerQuery,Ce=Se.getQueryObjectEXT(de.query,Se.QUERY_RESULT_EXT)/(1e3*1e3);Se.deleteQueryEXT(de.query),ve[K]=Ce}return ve},ti.prototype.translatePosMatrix=function(H,ve,K,de,Se){if(!K[0]&&!K[1])return H;var Ce=Se?de==="map"?this.transform.angle:0:de==="viewport"?-this.transform.angle:0;if(Ce){var Xe=Math.sin(Ce),lt=Math.cos(Ce);K=[K[0]*lt-K[1]*Xe,K[0]*Xe+K[1]*lt]}var wt=[Se?K[0]:_n(ve,K[0],this.transform.zoom),Se?K[1]:_n(ve,K[1],this.transform.zoom),0],Ht=new Float32Array(16);return e.translate(Ht,H,wt),Ht},ti.prototype.saveTileTexture=function(H){var ve=this._tileTextures[H.size[0]];ve?ve.push(H):this._tileTextures[H.size[0]]=[H]},ti.prototype.getTileTexture=function(H){var ve=this._tileTextures[H];return ve&&ve.length>0?ve.pop():null},ti.prototype.isPatternMissing=function(H){if(!H)return!1;if(!H.from||!H.to)return!0;var ve=this.imageManager.getPattern(H.from.toString()),K=this.imageManager.getPattern(H.to.toString());return!ve||!K},ti.prototype.useProgram=function(H,ve){this.cache=this.cache||{};var K=""+H+(ve?ve.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[K]||(this.cache[K]=new $o(this.context,fl[H],ve,Ql[H],this._showOverdrawInspector)),this.cache[K]},ti.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},ti.prototype.setBaseState=function(){var H=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(H.FUNC_ADD)},ti.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var H=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,H.RGBA)}},ti.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var Yi=function(H,ve){this.points=H,this.planes=ve};Yi.fromInvProjectionMatrix=function(H,ve,K){var de=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],Se=Math.pow(2,K),Ce=de.map(function(wt){return e.transformMat4([],wt,H)}).map(function(wt){return e.scale$1([],wt,1/wt[3]/ve*Se)}),Xe=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],lt=Xe.map(function(wt){var Ht=e.sub([],Ce[wt[0]],Ce[wt[1]]),nr=e.sub([],Ce[wt[2]],Ce[wt[1]]),sr=e.normalize([],e.cross([],Ht,nr)),Ar=-e.dot(sr,Ce[wt[1]]);return sr.concat(Ar)});return new Yi(Ce,lt)};var co=function(H,ve){this.min=H,this.max=ve,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};co.prototype.quadrant=function(H){for(var ve=[H%2===0,H<2],K=e.clone$2(this.min),de=e.clone$2(this.max),Se=0;Se<ve.length;Se++)K[Se]=ve[Se]?this.min[Se]:this.center[Se],de[Se]=ve[Se]?this.center[Se]:this.max[Se];return de[2]=this.max[2],new co(K,de)},co.prototype.distanceX=function(H){var ve=Math.max(Math.min(this.max[0],H[0]),this.min[0]);return ve-H[0]},co.prototype.distanceY=function(H){var ve=Math.max(Math.min(this.max[1],H[1]),this.min[1]);return ve-H[1]},co.prototype.intersects=function(H){for(var ve=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],K=!0,de=0;de<H.planes.length;de++){for(var Se=H.planes[de],Ce=0,Xe=0;Xe<ve.length;Xe++)Ce+=e.dot$1(Se,ve[Xe])>=0;if(Ce===0)return 0;Ce!==ve.length&&(K=!1)}if(K)return 2;for(var lt=0;lt<3;lt++){for(var wt=Number.MAX_VALUE,Ht=-Number.MAX_VALUE,nr=0;nr<H.points.length;nr++){var sr=H.points[nr][lt]-this.min[lt];wt=Math.min(wt,sr),Ht=Math.max(Ht,sr)}if(Ht<0||wt>this.max[lt]-this.min[lt])return 0}return 1};var wo=function(H,ve,K,de){if(H===void 0&&(H=0),ve===void 0&&(ve=0),K===void 0&&(K=0),de===void 0&&(de=0),isNaN(H)||H<0||isNaN(ve)||ve<0||isNaN(K)||K<0||isNaN(de)||de<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=H,this.bottom=ve,this.left=K,this.right=de};wo.prototype.interpolate=function(H,ve,K){return ve.top!=null&&H.top!=null&&(this.top=e.number(H.top,ve.top,K)),ve.bottom!=null&&H.bottom!=null&&(this.bottom=e.number(H.bottom,ve.bottom,K)),ve.left!=null&&H.left!=null&&(this.left=e.number(H.left,ve.left,K)),ve.right!=null&&H.right!=null&&(this.right=e.number(H.right,ve.right,K)),this},wo.prototype.getCenter=function(H,ve){var K=e.clamp((this.left+H-this.right)/2,0,H),de=e.clamp((this.top+ve-this.bottom)/2,0,ve);return new e.Point(K,de)},wo.prototype.equals=function(H){return this.top===H.top&&this.bottom===H.bottom&&this.left===H.left&&this.right===H.right},wo.prototype.clone=function(){return new wo(this.top,this.bottom,this.left,this.right)},wo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var wi=function(H,ve,K,de,Se){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=Se===void 0?!0:Se,this._minZoom=H||0,this._maxZoom=ve||22,this._minPitch=K==null?0:K,this._maxPitch=de==null?60:de,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new wo,this._posMatrixCache={},this._alignedPosMatrixCache={}},ki={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};wi.prototype.clone=function(){var H=new wi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return H.tileSize=this.tileSize,H.latRange=this.latRange,H.width=this.width,H.height=this.height,H._center=this._center,H.zoom=this.zoom,H.angle=this.angle,H._fov=this._fov,H._pitch=this._pitch,H._unmodified=this._unmodified,H._edgeInsets=this._edgeInsets.clone(),H._calcMatrices(),H},ki.minZoom.get=function(){return this._minZoom},ki.minZoom.set=function(ce){this._minZoom!==ce&&(this._minZoom=ce,this.zoom=Math.max(this.zoom,ce))},ki.maxZoom.get=function(){return this._maxZoom},ki.maxZoom.set=function(ce){this._maxZoom!==ce&&(this._maxZoom=ce,this.zoom=Math.min(this.zoom,ce))},ki.minPitch.get=function(){return this._minPitch},ki.minPitch.set=function(ce){this._minPitch!==ce&&(this._minPitch=ce,this.pitch=Math.max(this.pitch,ce))},ki.maxPitch.get=function(){return this._maxPitch},ki.maxPitch.set=function(ce){this._maxPitch!==ce&&(this._maxPitch=ce,this.pitch=Math.min(this.pitch,ce))},ki.renderWorldCopies.get=function(){return this._renderWorldCopies},ki.renderWorldCopies.set=function(ce){ce===void 0?ce=!0:ce===null&&(ce=!1),this._renderWorldCopies=ce},ki.worldSize.get=function(){return this.tileSize*this.scale},ki.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},ki.size.get=function(){return new e.Point(this.width,this.height)},ki.bearing.get=function(){return-this.angle/Math.PI*180},ki.bearing.set=function(ce){var H=-e.wrap(ce,-180,180)*Math.PI/180;this.angle!==H&&(this._unmodified=!1,this.angle=H,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},ki.pitch.get=function(){return this._pitch/Math.PI*180},ki.pitch.set=function(ce){var H=e.clamp(ce,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==H&&(this._unmodified=!1,this._pitch=H,this._calcMatrices())},ki.fov.get=function(){return this._fov/Math.PI*180},ki.fov.set=function(ce){ce=Math.max(.01,Math.min(60,ce)),this._fov!==ce&&(this._unmodified=!1,this._fov=ce/180*Math.PI,this._calcMatrices())},ki.zoom.get=function(){return this._zoom},ki.zoom.set=function(ce){var H=Math.min(Math.max(ce,this.minZoom),this.maxZoom);this._zoom!==H&&(this._unmodified=!1,this._zoom=H,this.scale=this.zoomScale(H),this.tileZoom=Math.floor(H),this.zoomFraction=H-this.tileZoom,this._constrain(),this._calcMatrices())},ki.center.get=function(){return this._center},ki.center.set=function(ce){ce.lat===this._center.lat&&ce.lng===this._center.lng||(this._unmodified=!1,this._center=ce,this._constrain(),this._calcMatrices())},ki.padding.get=function(){return this._edgeInsets.toJSON()},ki.padding.set=function(ce){this._edgeInsets.equals(ce)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,ce,1),this._calcMatrices())},ki.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},wi.prototype.isPaddingEqual=function(H){return this._edgeInsets.equals(H)},wi.prototype.interpolatePadding=function(H,ve,K){this._unmodified=!1,this._edgeInsets.interpolate(H,ve,K),this._constrain(),this._calcMatrices()},wi.prototype.coveringZoomLevel=function(H){var ve=(H.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/H.tileSize));return Math.max(0,ve)},wi.prototype.getVisibleUnwrappedCoordinates=function(H){var ve=[new e.UnwrappedTileID(0,H)];if(this._renderWorldCopies)for(var K=this.pointCoordinate(new e.Point(0,0)),de=this.pointCoordinate(new e.Point(this.width,0)),Se=this.pointCoordinate(new e.Point(this.width,this.height)),Ce=this.pointCoordinate(new e.Point(0,this.height)),Xe=Math.floor(Math.min(K.x,de.x,Se.x,Ce.x)),lt=Math.floor(Math.max(K.x,de.x,Se.x,Ce.x)),wt=1,Ht=Xe-wt;Ht<=lt+wt;Ht++)Ht!==0&&ve.push(new e.UnwrappedTileID(Ht,H));return ve},wi.prototype.coveringTiles=function(H){var ve=this.coveringZoomLevel(H),K=ve;if(H.minzoom!==void 0&&ve<H.minzoom)return[];H.maxzoom!==void 0&&ve>H.maxzoom&&(ve=H.maxzoom);var de=e.MercatorCoordinate.fromLngLat(this.center),Se=Math.pow(2,ve),Ce=[Se*de.x,Se*de.y,0],Xe=Yi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,ve),lt=H.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(lt=ve);var wt=3,Ht=function(Ca){return{aabb:new co([Ca*Se,0,0],[(Ca+1)*Se,Se,0]),zoom:0,x:0,y:0,wrap:Ca,fullyVisible:!1}},nr=[],sr=[],Ar=ve,Nr=H.reparseOverscaled?K:ve;if(this._renderWorldCopies)for(var Ur=1;Ur<=3;Ur++)nr.push(Ht(-Ur)),nr.push(Ht(Ur));for(nr.push(Ht(0));nr.length>0;){var Or=nr.pop(),Xr=Or.x,sn=Or.y,Sn=Or.fullyVisible;if(!Sn){var Fn=Or.aabb.intersects(Xe);if(Fn===0)continue;Sn=Fn===2}var Xn=Or.aabb.distanceX(Ce),Qn=Or.aabb.distanceY(Ce),jn=Math.max(Math.abs(Xn),Math.abs(Qn)),ca=wt+(1<<Ar-Or.zoom)-2;if(Or.zoom===Ar||jn>ca&&Or.zoom>=lt){sr.push({tileID:new e.OverscaledTileID(Or.zoom===Ar?Nr:Or.zoom,Or.wrap,Or.zoom,Xr,sn),distanceSq:e.sqrLen([Ce[0]-.5-Xr,Ce[1]-.5-sn])});continue}for(var ba=0;ba<4;ba++){var ya=(Xr<<1)+ba%2,Ta=(sn<<1)+(ba>>1);nr.push({aabb:Or.aabb.quadrant(ba),zoom:Or.zoom+1,x:ya,y:Ta,wrap:Or.wrap,fullyVisible:Sn})}}return sr.sort(function(Ca,Ha){return Ca.distanceSq-Ha.distanceSq}).map(function(Ca){return Ca.tileID})},wi.prototype.resize=function(H,ve){this.width=H,this.height=ve,this.pixelsToGLUnits=[2/H,-2/ve],this._constrain(),this._calcMatrices()},ki.unmodified.get=function(){return this._unmodified},wi.prototype.zoomScale=function(H){return Math.pow(2,H)},wi.prototype.scaleZoom=function(H){return Math.log(H)/Math.LN2},wi.prototype.project=function(H){var ve=e.clamp(H.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(H.lng)*this.worldSize,e.mercatorYfromLat(ve)*this.worldSize)},wi.prototype.unproject=function(H){return new e.MercatorCoordinate(H.x/this.worldSize,H.y/this.worldSize).toLngLat()},ki.point.get=function(){return this.project(this.center)},wi.prototype.setLocationAtPoint=function(H,ve){var K=this.pointCoordinate(ve),de=this.pointCoordinate(this.centerPoint),Se=this.locationCoordinate(H),Ce=new e.MercatorCoordinate(Se.x-(K.x-de.x),Se.y-(K.y-de.y));this.center=this.coordinateLocation(Ce),this._renderWorldCopies&&(this.center=this.center.wrap())},wi.prototype.locationPoint=function(H){return this.coordinatePoint(this.locationCoordinate(H))},wi.prototype.pointLocation=function(H){return this.coordinateLocation(this.pointCoordinate(H))},wi.prototype.locationCoordinate=function(H){return e.MercatorCoordinate.fromLngLat(H)},wi.prototype.coordinateLocation=function(H){return H.toLngLat()},wi.prototype.pointCoordinate=function(H){var ve=0,K=[H.x,H.y,0,1],de=[H.x,H.y,1,1];e.transformMat4(K,K,this.pixelMatrixInverse),e.transformMat4(de,de,this.pixelMatrixInverse);var Se=K[3],Ce=de[3],Xe=K[0]/Se,lt=de[0]/Ce,wt=K[1]/Se,Ht=de[1]/Ce,nr=K[2]/Se,sr=de[2]/Ce,Ar=nr===sr?0:(ve-nr)/(sr-nr);return new e.MercatorCoordinate(e.number(Xe,lt,Ar)/this.worldSize,e.number(wt,Ht,Ar)/this.worldSize)},wi.prototype.coordinatePoint=function(H){var ve=[H.x*this.worldSize,H.y*this.worldSize,0,1];return e.transformMat4(ve,ve,this.pixelMatrix),new e.Point(ve[0]/ve[3],ve[1]/ve[3])},wi.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},wi.prototype.getMaxBounds=function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])},wi.prototype.setMaxBounds=function(H){H?(this.lngRange=[H.getWest(),H.getEast()],this.latRange=[H.getSouth(),H.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},wi.prototype.calculatePosMatrix=function(H,ve){ve===void 0&&(ve=!1);var K=H.key,de=ve?this._alignedPosMatrixCache:this._posMatrixCache;if(de[K])return de[K];var Se=H.canonical,Ce=this.worldSize/this.zoomScale(Se.z),Xe=Se.x+Math.pow(2,Se.z)*H.wrap,lt=e.identity(new Float64Array(16));return e.translate(lt,lt,[Xe*Ce,Se.y*Ce,0]),e.scale(lt,lt,[Ce/e.EXTENT,Ce/e.EXTENT,1]),e.multiply(lt,ve?this.alignedProjMatrix:this.projMatrix,lt),de[K]=new Float32Array(lt),de[K]},wi.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},wi.prototype._constrain=function(){if(!(!this.center||!this.width||!this.height||this._constraining)){this._constraining=!0;var H=-90,ve=90,K=-180,de=180,Se,Ce,Xe,lt,wt=this.size,Ht=this._unmodified;if(this.latRange){var nr=this.latRange;H=e.mercatorYfromLat(nr[1])*this.worldSize,ve=e.mercatorYfromLat(nr[0])*this.worldSize,Se=ve-H<wt.y?wt.y/(ve-H):0}if(this.lngRange){var sr=this.lngRange;K=e.mercatorXfromLng(sr[0])*this.worldSize,de=e.mercatorXfromLng(sr[1])*this.worldSize,Ce=de-K<wt.x?wt.x/(de-K):0}var Ar=this.point,Nr=Math.max(Ce||0,Se||0);if(Nr){this.center=this.unproject(new e.Point(Ce?(de+K)/2:Ar.x,Se?(ve+H)/2:Ar.y)),this.zoom+=this.scaleZoom(Nr),this._unmodified=Ht,this._constraining=!1;return}if(this.latRange){var Ur=Ar.y,Or=wt.y/2;Ur-Or<H&&(lt=H+Or),Ur+Or>ve&&(lt=ve-Or)}if(this.lngRange){var Xr=Ar.x,sn=wt.x/2;Xr-sn<K&&(Xe=K+sn),Xr+sn>de&&(Xe=de-sn)}(Xe!==void 0||lt!==void 0)&&(this.center=this.unproject(new e.Point(Xe!==void 0?Xe:Ar.x,lt!==void 0?lt:Ar.y))),this._unmodified=Ht,this._constraining=!1}},wi.prototype._calcMatrices=function(){if(!!this.height){var H=this._fov/2,ve=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(H)*this.height;var K=Math.PI/2+this._pitch,de=this._fov*(.5+ve.y/this.height),Se=Math.sin(de)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-K-de,.01,Math.PI-.01)),Ce=this.point,Xe=Ce.x,lt=Ce.y,wt=Math.cos(Math.PI/2-this._pitch)*Se+this.cameraToCenterDistance,Ht=wt*1.01,nr=this.height/50,sr=new Float64Array(16);e.perspective(sr,this._fov,this.width/this.height,nr,Ht),sr[8]=-ve.x*2/this.width,sr[9]=ve.y*2/this.height,e.scale(sr,sr,[1,-1,1]),e.translate(sr,sr,[0,0,-this.cameraToCenterDistance]),e.rotateX(sr,sr,this._pitch),e.rotateZ(sr,sr,this.angle),e.translate(sr,sr,[-Xe,-lt,0]),this.mercatorMatrix=e.scale([],sr,[this.worldSize,this.worldSize,this.worldSize]),e.scale(sr,sr,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=sr,this.invProjMatrix=e.invert([],this.projMatrix);var Ar=this.width%2/2,Nr=this.height%2/2,Ur=Math.cos(this.angle),Or=Math.sin(this.angle),Xr=Xe-Math.round(Xe)+Ur*Ar+Or*Nr,sn=lt-Math.round(lt)+Ur*Nr+Or*Ar,Sn=new Float64Array(sr);if(e.translate(Sn,Sn,[Xr>.5?Xr-1:Xr,sn>.5?sn-1:sn,0]),this.alignedProjMatrix=Sn,sr=e.create(),e.scale(sr,sr,[this.width/2,-this.height/2,1]),e.translate(sr,sr,[1,-1,0]),this.labelPlaneMatrix=sr,sr=e.create(),e.scale(sr,sr,[1,-1,1]),e.translate(sr,sr,[-1,-1,0]),e.scale(sr,sr,[2/this.width,2/this.height,1]),this.glCoordMatrix=sr,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),sr=e.invert(new Float64Array(16),this.pixelMatrix),!sr)throw new Error("failed to invert matrix");this.pixelMatrixInverse=sr,this._posMatrixCache={},this._alignedPosMatrixCache={}}},wi.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var H=this.pointCoordinate(new e.Point(0,0)),ve=[H.x*this.worldSize,H.y*this.worldSize,0,1],K=e.transformMat4(ve,ve,this.pixelMatrix);return K[3]/this.cameraToCenterDistance},wi.prototype.getCameraPoint=function(){var H=this._pitch,ve=Math.tan(H)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,ve))},wi.prototype.getCameraQueryGeometry=function(H){var ve=this.getCameraPoint();if(H.length===1)return[H[0],ve];for(var K=ve.x,de=ve.y,Se=ve.x,Ce=ve.y,Xe=0,lt=H;Xe<lt.length;Xe+=1){var wt=lt[Xe];K=Math.min(K,wt.x),de=Math.min(de,wt.y),Se=Math.max(Se,wt.x),Ce=Math.max(Ce,wt.y)}return[new e.Point(K,de),new e.Point(Se,de),new e.Point(Se,Ce),new e.Point(K,Ce),new e.Point(K,de)]},Object.defineProperties(wi.prototype,ki);function cs(ce,H){var ve=!1,K=null,de=function(){K=null,ve&&(ce(),K=setTimeout(de,H),ve=!1)};return function(){return ve=!0,K||de(),K}}var yo=function(H){this._hashName=H&&encodeURIComponent(H),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=cs(this._updateHashUnthrottled.bind(this),30*1e3/100)};yo.prototype.addTo=function(H){return this._map=H,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},yo.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},yo.prototype.getHashString=function(H){var ve=this._map.getCenter(),K=Math.round(this._map.getZoom()*100)/100,de=Math.ceil((K*Math.LN2+Math.log(512/360/.5))/Math.LN10),Se=Math.pow(10,de),Ce=Math.round(ve.lng*Se)/Se,Xe=Math.round(ve.lat*Se)/Se,lt=this._map.getBearing(),wt=this._map.getPitch(),Ht="";if(H?Ht+="/"+Ce+"/"+Xe+"/"+K:Ht+=K+"/"+Xe+"/"+Ce,(lt||wt)&&(Ht+="/"+Math.round(lt*10)/10),wt&&(Ht+="/"+Math.round(wt)),this._hashName){var nr=this._hashName,sr=!1,Ar=e.window.location.hash.slice(1).split("&").map(function(Nr){var Ur=Nr.split("=")[0];return Ur===nr?(sr=!0,Ur+"="+Ht):Nr}).filter(function(Nr){return Nr});return sr||Ar.push(nr+"="+Ht),"#"+Ar.join("&")}return"#"+Ht},yo.prototype._getCurrentHash=function(){var H=this,ve=e.window.location.hash.replace("#","");if(this._hashName){var K;return ve.split("&").map(function(de){return de.split("=")}).forEach(function(de){de[0]===H._hashName&&(K=de)}),(K&&K[1]||"").split("/")}return ve.split("/")},yo.prototype._onHashChange=function(){var H=this._getCurrentHash();if(H.length>=3&&!H.some(function(K){return isNaN(K)})){var ve=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(H[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+H[2],+H[1]],zoom:+H[0],bearing:ve,pitch:+(H[4]||0)}),!0}return!1},yo.prototype._updateHashUnthrottled=function(){var H=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",H)}catch{}};var Do={linearity:.3,easing:e.bezier(0,0,.3,1)},Yo=e.extend({deceleration:2500,maxSpeed:1400},Do),ue=e.extend({deceleration:20,maxSpeed:1400},Do),be=e.extend({deceleration:1e3,maxSpeed:360},Do),Ee=e.extend({deceleration:1e3,maxSpeed:90},Do),Fe=function(H){this._map=H,this.clear()};Fe.prototype.clear=function(){this._inertiaBuffer=[]},Fe.prototype.record=function(H){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:H})},Fe.prototype._drainInertiaBuffer=function(){for(var H=this._inertiaBuffer,ve=e.browser.now(),K=160;H.length>0&&ve-H[0].time>K;)H.shift()},Fe.prototype._onMoveEnd=function(H){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var ve={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},K=0,de=this._inertiaBuffer;K<de.length;K+=1){var Se=de[K],Ce=Se.settings;ve.zoom+=Ce.zoomDelta||0,ve.bearing+=Ce.bearingDelta||0,ve.pitch+=Ce.pitchDelta||0,Ce.panDelta&&ve.pan._add(Ce.panDelta),Ce.around&&(ve.around=Ce.around),Ce.pinchAround&&(ve.pinchAround=Ce.pinchAround)}var Xe=this._inertiaBuffer[this._inertiaBuffer.length-1],lt=Xe.time-this._inertiaBuffer[0].time,wt={};if(ve.pan.mag()){var Ht=Ze(ve.pan.mag(),lt,e.extend({},Yo,H||{}));wt.offset=ve.pan.mult(Ht.amount/ve.pan.mag()),wt.center=this._map.transform.center,ze(wt,Ht)}if(ve.zoom){var nr=Ze(ve.zoom,lt,ue);wt.zoom=this._map.transform.zoom+nr.amount,ze(wt,nr)}if(ve.bearing){var sr=Ze(ve.bearing,lt,be);wt.bearing=this._map.transform.bearing+e.clamp(sr.amount,-179,179),ze(wt,sr)}if(ve.pitch){var Ar=Ze(ve.pitch,lt,Ee);wt.pitch=this._map.transform.pitch+Ar.amount,ze(wt,Ar)}if(wt.zoom||wt.bearing){var Nr=ve.pinchAround===void 0?ve.around:ve.pinchAround;wt.around=Nr?this._map.unproject(Nr):this._map.getCenter()}return this.clear(),e.extend(wt,{noMoveStart:!0})}};function ze(ce,H){(!ce.duration||ce.duration<H.duration)&&(ce.duration=H.duration,ce.easing=H.easing)}function Ze(ce,H,ve){var K=ve.maxSpeed,de=ve.linearity,Se=ve.deceleration,Ce=e.clamp(ce*de/(H/1e3),-K,K),Xe=Math.abs(Ce)/(Se*de);return{easing:ve.easing,duration:Xe*1e3,amount:Ce*(Xe/2)}}var yt=function(ce){function H(K,de,Se,Ce){Ce===void 0&&(Ce={});var Xe=n.mousePos(de.getCanvasContainer(),Se),lt=de.unproject(Xe);ce.call(this,K,e.extend({point:Xe,lngLat:lt,originalEvent:Se},Ce)),this._defaultPrevented=!1,this.target=de}ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H;var ve={defaultPrevented:{configurable:!0}};return H.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(H.prototype,ve),H}(e.Event),ft=function(ce){function H(K,de,Se){var Ce=K==="touchend"?Se.changedTouches:Se.touches,Xe=n.touchPos(de.getCanvasContainer(),Ce),lt=Xe.map(function(nr){return de.unproject(nr)}),wt=Xe.reduce(function(nr,sr,Ar,Nr){return nr.add(sr.div(Nr.length))},new e.Point(0,0)),Ht=de.unproject(wt);ce.call(this,K,{points:Xe,point:wt,lngLats:lt,lngLat:Ht,originalEvent:Se}),this._defaultPrevented=!1}ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H;var ve={defaultPrevented:{configurable:!0}};return H.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(H.prototype,ve),H}(e.Event),St=function(ce){function H(K,de,Se){ce.call(this,K,{originalEvent:Se}),this._defaultPrevented=!1}ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H;var ve={defaultPrevented:{configurable:!0}};return H.prototype.preventDefault=function(){this._defaultPrevented=!0},ve.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(H.prototype,ve),H}(e.Event),Nt=function(H,ve){this._map=H,this._clickTolerance=ve.clickTolerance};Nt.prototype.reset=function(){delete this._mousedownPos},Nt.prototype.wheel=function(H){return this._firePreventable(new St(H.type,this._map,H))},Nt.prototype.mousedown=function(H,ve){return this._mousedownPos=ve,this._firePreventable(new yt(H.type,this._map,H))},Nt.prototype.mouseup=function(H){this._map.fire(new yt(H.type,this._map,H))},Nt.prototype.click=function(H,ve){this._mousedownPos&&this._mousedownPos.dist(ve)>=this._clickTolerance||this._map.fire(new yt(H.type,this._map,H))},Nt.prototype.dblclick=function(H){return this._firePreventable(new yt(H.type,this._map,H))},Nt.prototype.mouseover=function(H){this._map.fire(new yt(H.type,this._map,H))},Nt.prototype.mouseout=function(H){this._map.fire(new yt(H.type,this._map,H))},Nt.prototype.touchstart=function(H){return this._firePreventable(new ft(H.type,this._map,H))},Nt.prototype.touchmove=function(H){this._map.fire(new ft(H.type,this._map,H))},Nt.prototype.touchend=function(H){this._map.fire(new ft(H.type,this._map,H))},Nt.prototype.touchcancel=function(H){this._map.fire(new ft(H.type,this._map,H))},Nt.prototype._firePreventable=function(H){if(this._map.fire(H),H.defaultPrevented)return{}},Nt.prototype.isEnabled=function(){return!0},Nt.prototype.isActive=function(){return!1},Nt.prototype.enable=function(){},Nt.prototype.disable=function(){};var Xt=function(H){this._map=H};Xt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Xt.prototype.mousemove=function(H){this._map.fire(new yt(H.type,this._map,H))},Xt.prototype.mousedown=function(){this._delayContextMenu=!0},Xt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new yt("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Xt.prototype.contextmenu=function(H){this._delayContextMenu?this._contextMenuEvent=H:this._map.fire(new yt(H.type,this._map,H)),this._map.listens("contextmenu")&&H.preventDefault()},Xt.prototype.isEnabled=function(){return!0},Xt.prototype.isActive=function(){return!1},Xt.prototype.enable=function(){},Xt.prototype.disable=function(){};var Kt=function(H,ve){this._map=H,this._el=H.getCanvasContainer(),this._container=H.getContainer(),this._clickTolerance=ve.clickTolerance||1};Kt.prototype.isEnabled=function(){return!!this._enabled},Kt.prototype.isActive=function(){return!!this._active},Kt.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Kt.prototype.disable=function(){!this.isEnabled()||(this._enabled=!1)},Kt.prototype.mousedown=function(H,ve){!this.isEnabled()||!(H.shiftKey&&H.button===0)||(n.disableDrag(),this._startPos=this._lastPos=ve,this._active=!0)},Kt.prototype.mousemoveWindow=function(H,ve){if(!!this._active){var K=ve;if(!(this._lastPos.equals(K)||!this._box&&K.dist(this._startPos)<this._clickTolerance)){var de=this._startPos;this._lastPos=K,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",H));var Se=Math.min(de.x,K.x),Ce=Math.max(de.x,K.x),Xe=Math.min(de.y,K.y),lt=Math.max(de.y,K.y);n.setTransform(this._box,"translate("+Se+"px,"+Xe+"px)"),this._box.style.width=Ce-Se+"px",this._box.style.height=lt-Xe+"px"}}},Kt.prototype.mouseupWindow=function(H,ve){var K=this;if(!!this._active&&H.button===0){var de=this._startPos,Se=ve;if(this.reset(),n.suppressClick(),de.x===Se.x&&de.y===Se.y)this._fireEvent("boxzoomcancel",H);else return this._map.fire(new e.Event("boxzoomend",{originalEvent:H})),{cameraAnimation:function(Ce){return Ce.fitScreenCoordinates(de,Se,K._map.getBearing(),{linear:!0})}}}},Kt.prototype.keydown=function(H){!this._active||H.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",H))},Kt.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},Kt.prototype._fireEvent=function(H,ve){return this._map.fire(new e.Event(H,{originalEvent:ve}))};function br(ce,H){for(var ve={},K=0;K<ce.length;K++)ve[ce[K].identifier]=H[K];return ve}function Zr(ce){for(var H=new e.Point(0,0),ve=0,K=ce;ve<K.length;ve+=1){var de=K[ve];H._add(de)}return H.div(ce.length)}var nn=500,Mr=500,zr=30,Gr=function(H){this.reset(),this.numTouches=H.numTouches};Gr.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Gr.prototype.touchstart=function(H,ve,K){(this.centroid||K.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=H.timeStamp),K.length===this.numTouches&&(this.centroid=Zr(ve),this.touches=br(K,ve)))},Gr.prototype.touchmove=function(H,ve,K){if(!(this.aborted||!this.centroid)){var de=br(K,ve);for(var Se in this.touches){var Ce=this.touches[Se],Xe=de[Se];(!Xe||Xe.dist(Ce)>zr)&&(this.aborted=!0)}}},Gr.prototype.touchend=function(H,ve,K){if((!this.centroid||H.timeStamp-this.startTime>Mr)&&(this.aborted=!0),K.length===0){var de=!this.aborted&&this.centroid;if(this.reset(),de)return de}};var qr=function(H){this.singleTap=new Gr(H),this.numTaps=H.numTaps,this.reset()};qr.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},qr.prototype.touchstart=function(H,ve,K){this.singleTap.touchstart(H,ve,K)},qr.prototype.touchmove=function(H,ve,K){this.singleTap.touchmove(H,ve,K)},qr.prototype.touchend=function(H,ve,K){var de=this.singleTap.touchend(H,ve,K);if(de){var Se=H.timeStamp-this.lastTime<nn,Ce=!this.lastTap||this.lastTap.dist(de)<zr;if((!Se||!Ce)&&this.reset(),this.count++,this.lastTime=H.timeStamp,this.lastTap=de,this.count===this.numTaps)return this.reset(),de}};var tn=function(){this._zoomIn=new qr({numTouches:1,numTaps:2}),this._zoomOut=new qr({numTouches:2,numTaps:1}),this.reset()};tn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},tn.prototype.touchstart=function(H,ve,K){this._zoomIn.touchstart(H,ve,K),this._zoomOut.touchstart(H,ve,K)},tn.prototype.touchmove=function(H,ve,K){this._zoomIn.touchmove(H,ve,K),this._zoomOut.touchmove(H,ve,K)},tn.prototype.touchend=function(H,ve,K){var de=this,Se=this._zoomIn.touchend(H,ve,K),Ce=this._zoomOut.touchend(H,ve,K);if(Se)return this._active=!0,H.preventDefault(),setTimeout(function(){return de.reset()},0),{cameraAnimation:function(Xe){return Xe.easeTo({duration:300,zoom:Xe.getZoom()+1,around:Xe.unproject(Se)},{originalEvent:H})}};if(Ce)return this._active=!0,H.preventDefault(),setTimeout(function(){return de.reset()},0),{cameraAnimation:function(Xe){return Xe.easeTo({duration:300,zoom:Xe.getZoom()-1,around:Xe.unproject(Ce)},{originalEvent:H})}}},tn.prototype.touchcancel=function(){this.reset()},tn.prototype.enable=function(){this._enabled=!0},tn.prototype.disable=function(){this._enabled=!1,this.reset()},tn.prototype.isEnabled=function(){return this._enabled},tn.prototype.isActive=function(){return this._active};var Yr=0,Un=2,ta=function(H){this.reset(),this._clickTolerance=H.clickTolerance||1};ta.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},ta.prototype._correctButton=function(H,ve){return!1},ta.prototype._move=function(H,ve){return{}},ta.prototype.mousedown=function(H,ve){if(!this._lastPoint){var K=n.mouseButton(H);!this._correctButton(H,K)||(this._lastPoint=ve,this._eventButton=K)}},ta.prototype.mousemoveWindow=function(H,ve){var K=this._lastPoint;if(!!K&&(H.preventDefault(),!(!this._moved&&ve.dist(K)<this._clickTolerance)))return this._moved=!0,this._lastPoint=ve,this._move(K,ve)},ta.prototype.mouseupWindow=function(H){var ve=n.mouseButton(H);ve===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},ta.prototype.enable=function(){this._enabled=!0},ta.prototype.disable=function(){this._enabled=!1,this.reset()},ta.prototype.isEnabled=function(){return this._enabled},ta.prototype.isActive=function(){return this._active};var _a=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.mousedown=function(K,de){ce.prototype.mousedown.call(this,K,de),this._lastPoint&&(this._active=!0)},H.prototype._correctButton=function(K,de){return de===Yr&&!K.ctrlKey},H.prototype._move=function(K,de){return{around:de,panDelta:de.sub(K)}},H}(ta),ia=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype._correctButton=function(K,de){return de===Yr&&K.ctrlKey||de===Un},H.prototype._move=function(K,de){var Se=.8,Ce=(de.x-K.x)*Se;if(Ce)return this._active=!0,{bearingDelta:Ce}},H.prototype.contextmenu=function(K){K.preventDefault()},H}(ta),ka=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype._correctButton=function(K,de){return de===Yr&&K.ctrlKey||de===Un},H.prototype._move=function(K,de){var Se=-.5,Ce=(de.y-K.y)*Se;if(Ce)return this._active=!0,{pitchDelta:Ce}},H.prototype.contextmenu=function(K){K.preventDefault()},H}(ta),ua=function(H){this._minTouches=1,this._clickTolerance=H.clickTolerance||1,this.reset()};ua.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},ua.prototype.touchstart=function(H,ve,K){return this._calculateTransform(H,ve,K)},ua.prototype.touchmove=function(H,ve,K){if(!!this._active)return H.preventDefault(),this._calculateTransform(H,ve,K)},ua.prototype.touchend=function(H,ve,K){this._calculateTransform(H,ve,K),this._active&&K.length<this._minTouches&&this.reset()},ua.prototype.touchcancel=function(){this.reset()},ua.prototype._calculateTransform=function(H,ve,K){K.length>0&&(this._active=!0);var de=br(K,ve),Se=new e.Point(0,0),Ce=new e.Point(0,0),Xe=0;for(var lt in de){var wt=de[lt],Ht=this._touches[lt];Ht&&(Se._add(wt),Ce._add(wt.sub(Ht)),Xe++,de[lt]=wt)}if(this._touches=de,!(Xe<this._minTouches||!Ce.mag())){var nr=Ce.div(Xe);if(this._sum._add(nr),!(this._sum.mag()<this._clickTolerance)){var sr=Se.div(Xe);return{around:sr,panDelta:nr}}}},ua.prototype.enable=function(){this._enabled=!0},ua.prototype.disable=function(){this._enabled=!1,this.reset()},ua.prototype.isEnabled=function(){return this._enabled},ua.prototype.isActive=function(){return this._active};var Na=function(){this.reset()};Na.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Na.prototype._start=function(H){},Na.prototype._move=function(H,ve,K){return{}},Na.prototype.touchstart=function(H,ve,K){this._firstTwoTouches||K.length<2||(this._firstTwoTouches=[K[0].identifier,K[1].identifier],this._start([ve[0],ve[1]]))},Na.prototype.touchmove=function(H,ve,K){if(!!this._firstTwoTouches){H.preventDefault();var de=this._firstTwoTouches,Se=de[0],Ce=de[1],Xe=Pa(K,ve,Se),lt=Pa(K,ve,Ce);if(!(!Xe||!lt)){var wt=this._aroundCenter?null:Xe.add(lt).div(2);return this._move([Xe,lt],wt,H)}}},Na.prototype.touchend=function(H,ve,K){if(!!this._firstTwoTouches){var de=this._firstTwoTouches,Se=de[0],Ce=de[1],Xe=Pa(K,ve,Se),lt=Pa(K,ve,Ce);Xe&&lt||(this._active&&n.suppressClick(),this.reset())}},Na.prototype.touchcancel=function(){this.reset()},Na.prototype.enable=function(H){this._enabled=!0,this._aroundCenter=!!H&&H.around==="center"},Na.prototype.disable=function(){this._enabled=!1,this.reset()},Na.prototype.isEnabled=function(){return this._enabled},Na.prototype.isActive=function(){return this._active};function Pa(ce,H,ve){for(var K=0;K<ce.length;K++)if(ce[K].identifier===ve)return H[K]}var Qa=.1;function xi(ce,H){return Math.log(ce/H)/Math.LN2}var ho=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.reset=function(){ce.prototype.reset.call(this),delete this._distance,delete this._startDistance},H.prototype._start=function(K){this._startDistance=this._distance=K[0].dist(K[1])},H.prototype._move=function(K,de){var Se=this._distance;if(this._distance=K[0].dist(K[1]),!(!this._active&&Math.abs(xi(this._distance,this._startDistance))<Qa))return this._active=!0,{zoomDelta:xi(this._distance,Se),pinchAround:de}},H}(Na),Fi=25;function fa(ce,H){return ce.angleWith(H)*180/Math.PI}var ni=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.reset=function(){ce.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},H.prototype._start=function(K){this._startVector=this._vector=K[0].sub(K[1]),this._minDiameter=K[0].dist(K[1])},H.prototype._move=function(K,de){var Se=this._vector;if(this._vector=K[0].sub(K[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:fa(this._vector,Se),pinchAround:de}},H.prototype._isBelowThreshold=function(K){this._minDiameter=Math.min(this._minDiameter,K.mag());var de=Math.PI*this._minDiameter,Se=Fi/de*360,Ce=fa(K,this._startVector);return Math.abs(Ce)<Se},H}(Na);function Xa(ce){return Math.abs(ce.y)>Math.abs(ce.x)}var Ei=100,si=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.reset=function(){ce.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},H.prototype._start=function(K){this._lastPoints=K,Xa(K[0].sub(K[1]))&&(this._valid=!1)},H.prototype._move=function(K,de,Se){var Ce=K[0].sub(this._lastPoints[0]),Xe=K[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(Ce,Xe,Se.timeStamp),!!this._valid){this._lastPoints=K,this._active=!0;var lt=(Ce.y+Xe.y)/2,wt=-.5;return{pitchDelta:lt*wt}}},H.prototype.gestureBeginsVertically=function(K,de,Se){if(this._valid!==void 0)return this._valid;var Ce=2,Xe=K.mag()>=Ce,lt=de.mag()>=Ce;if(!(!Xe&&!lt)){if(!Xe||!lt)return this._firstMove===void 0&&(this._firstMove=Se),Se-this._firstMove<Ei?void 0:!1;var wt=K.y>0==de.y>0;return Xa(K)&&Xa(de)&&wt}},H}(Na),so={panStep:100,bearingStep:15,pitchStep:10},qi=function(){var H=so;this._panStep=H.panStep,this._bearingStep=H.bearingStep,this._pitchStep=H.pitchStep};qi.prototype.reset=function(){this._active=!1},qi.prototype.keydown=function(H){var ve=this;if(!(H.altKey||H.ctrlKey||H.metaKey)){var K=0,de=0,Se=0,Ce=0,Xe=0;switch(H.keyCode){case 61:case 107:case 171:case 187:K=1;break;case 189:case 109:case 173:K=-1;break;case 37:H.shiftKey?de=-1:(H.preventDefault(),Ce=-1);break;case 39:H.shiftKey?de=1:(H.preventDefault(),Ce=1);break;case 38:H.shiftKey?Se=1:(H.preventDefault(),Xe=-1);break;case 40:H.shiftKey?Se=-1:(H.preventDefault(),Xe=1);break;default:return}return{cameraAnimation:function(lt){var wt=lt.getZoom();lt.easeTo({duration:300,easeId:"keyboardHandler",easing:mo,zoom:K?Math.round(wt)+K*(H.shiftKey?2:1):wt,bearing:lt.getBearing()+de*ve._bearingStep,pitch:lt.getPitch()+Se*ve._pitchStep,offset:[-Ce*ve._panStep,-Xe*ve._panStep],center:lt.getCenter()},{originalEvent:H})}}}},qi.prototype.enable=function(){this._enabled=!0},qi.prototype.disable=function(){this._enabled=!1,this.reset()},qi.prototype.isEnabled=function(){return this._enabled},qi.prototype.isActive=function(){return this._active};function mo(ce){return ce*(2-ce)}var Wo=4.000244140625,Bo=1/100,Xo=1/450,Wi=2,Ui=function(H,ve){this._map=H,this._el=H.getCanvasContainer(),this._handler=ve,this._delta=0,this._defaultZoomRate=Bo,this._wheelZoomRate=Xo,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Ui.prototype.setZoomRate=function(H){this._defaultZoomRate=H},Ui.prototype.setWheelZoomRate=function(H){this._wheelZoomRate=H},Ui.prototype.isEnabled=function(){return!!this._enabled},Ui.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ui.prototype.isZooming=function(){return!!this._zooming},Ui.prototype.enable=function(H){this.isEnabled()||(this._enabled=!0,this._aroundCenter=H&&H.around==="center")},Ui.prototype.disable=function(){!this.isEnabled()||(this._enabled=!1)},Ui.prototype.wheel=function(H){if(!!this.isEnabled()){var ve=H.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?H.deltaY*40:H.deltaY,K=e.browser.now(),de=K-(this._lastWheelEventTime||0);this._lastWheelEventTime=K,ve!==0&&ve%Wo===0?this._type="wheel":ve!==0&&Math.abs(ve)<4?this._type="trackpad":de>400?(this._type=null,this._lastValue=ve,this._timeout=setTimeout(this._onTimeout,40,H)):this._type||(this._type=Math.abs(de*ve)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,ve+=this._lastValue)),H.shiftKey&&ve&&(ve=ve/4),this._type&&(this._lastWheelEvent=H,this._delta-=ve,this._active||this._start(H)),H.preventDefault()}},Ui.prototype._onTimeout=function(H){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(H)},Ui.prototype._start=function(H){if(!!this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var ve=n.mousePos(this._el,H);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(ve)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ui.prototype.renderFrame=function(){return this._onScrollFrame()},Ui.prototype._onScrollFrame=function(){var H=this;if(!!this._frameId&&(this._frameId=null,!!this.isActive())){var ve=this._map.transform;if(this._delta!==0){var K=this._type==="wheel"&&Math.abs(this._delta)>Wo?this._wheelZoomRate:this._defaultZoomRate,de=Wi/(1+Math.exp(-Math.abs(this._delta*K)));this._delta<0&&de!==0&&(de=1/de);var Se=typeof this._targetZoom=="number"?ve.zoomScale(this._targetZoom):ve.scale;this._targetZoom=Math.min(ve.maxZoom,Math.max(ve.minZoom,ve.scaleZoom(Se*de))),this._type==="wheel"&&(this._startZoom=ve.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var Ce=typeof this._targetZoom=="number"?this._targetZoom:ve.zoom,Xe=this._startZoom,lt=this._easing,wt=!1,Ht;if(this._type==="wheel"&&Xe&&lt){var nr=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),sr=lt(nr);Ht=e.number(Xe,Ce,sr),nr<1?this._frameId||(this._frameId=!0):wt=!0}else Ht=Ce,wt=!0;return this._active=!0,wt&&(this._active=!1,this._finishTimeout=setTimeout(function(){H._zooming=!1,H._handler._triggerRenderFrame(),delete H._targetZoom,delete H._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!wt,zoomDelta:Ht-ve.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ui.prototype._smoothOutEasing=function(H){var ve=e.ease;if(this._prevEase){var K=this._prevEase,de=(e.browser.now()-K.start)/K.duration,Se=K.easing(de+.01)-K.easing(de),Ce=.27/Math.sqrt(Se*Se+1e-4)*.01,Xe=Math.sqrt(.27*.27-Ce*Ce);ve=e.bezier(Ce,Xe,.25,1)}return this._prevEase={start:e.browser.now(),duration:H,easing:ve},ve},Ui.prototype.reset=function(){this._active=!1};var Ia=function(H,ve){this._clickZoom=H,this._tapZoom=ve};Ia.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ia.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ia.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ia.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Za=function(){this.reset()};Za.prototype.reset=function(){this._active=!1},Za.prototype.dblclick=function(H,ve){return H.preventDefault(),{cameraAnimation:function(K){K.easeTo({duration:300,zoom:K.getZoom()+(H.shiftKey?-1:1),around:K.unproject(ve)},{originalEvent:H})}}},Za.prototype.enable=function(){this._enabled=!0},Za.prototype.disable=function(){this._enabled=!1,this.reset()},Za.prototype.isEnabled=function(){return this._enabled},Za.prototype.isActive=function(){return this._active};var _o=function(){this._tap=new qr({numTouches:1,numTaps:1}),this.reset()};_o.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},_o.prototype.touchstart=function(H,ve,K){this._swipePoint||(this._tapTime&&H.timeStamp-this._tapTime>nn&&this.reset(),this._tapTime?K.length>0&&(this._swipePoint=ve[0],this._swipeTouch=K[0].identifier):this._tap.touchstart(H,ve,K))},_o.prototype.touchmove=function(H,ve,K){if(!this._tapTime)this._tap.touchmove(H,ve,K);else if(this._swipePoint){if(K[0].identifier!==this._swipeTouch)return;var de=ve[0],Se=de.y-this._swipePoint.y;return this._swipePoint=de,H.preventDefault(),this._active=!0,{zoomDelta:Se/128}}},_o.prototype.touchend=function(H,ve,K){if(this._tapTime)this._swipePoint&&K.length===0&&this.reset();else{var de=this._tap.touchend(H,ve,K);de&&(this._tapTime=H.timeStamp)}},_o.prototype.touchcancel=function(){this.reset()},_o.prototype.enable=function(){this._enabled=!0},_o.prototype.disable=function(){this._enabled=!1,this.reset()},_o.prototype.isEnabled=function(){return this._enabled},_o.prototype.isActive=function(){return this._active};var ro=function(H,ve,K){this._el=H,this._mousePan=ve,this._touchPan=K};ro.prototype.enable=function(H){this._inertiaOptions=H||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},ro.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},ro.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},ro.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ro=function(H,ve,K){this._pitchWithRotate=H.pitchWithRotate,this._mouseRotate=ve,this._mousePitch=K};Ro.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ro.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ro.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ro.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var ji=function(H,ve,K,de){this._el=H,this._touchZoom=ve,this._touchRotate=K,this._tapDragZoom=de,this._rotationDisabled=!1,this._enabled=!0};ji.prototype.enable=function(H){this._touchZoom.enable(H),this._rotationDisabled||this._touchRotate.enable(H),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},ji.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},ji.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},ji.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},ji.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},ji.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Zo=function(ce){return ce.zoom||ce.drag||ce.pitch||ce.rotate},bs=function(ce){function H(){ce.apply(this,arguments)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H}(e.Event);function Ul(ce){return ce.panDelta&&ce.panDelta.mag()||ce.zoomDelta||ce.bearingDelta||ce.pitchDelta}var Ki=function(H,ve){this._map=H,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Fe(H),this._bearingSnap=ve.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(ve),e.bindAll(["handleEvent","handleWindowEvent"],this);var K=this._el;this._listeners=[[K,"touchstart",{passive:!1}],[K,"touchmove",{passive:!1}],[K,"touchend",void 0],[K,"touchcancel",void 0],[K,"mousedown",void 0],[K,"mousemove",void 0],[K,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[K,"mouseover",void 0],[K,"mouseout",void 0],[K,"dblclick",void 0],[K,"click",void 0],[K,"keydown",{capture:!1}],[K,"keyup",void 0],[K,"wheel",{passive:!1}],[K,"contextmenu",void 0],[e.window,"blur",void 0]];for(var de=0,Se=this._listeners;de<Se.length;de+=1){var Ce=Se[de],Xe=Ce[0],lt=Ce[1],wt=Ce[2];n.addEventListener(Xe,lt,Xe===e.window.document?this.handleWindowEvent:this.handleEvent,wt)}};Ki.prototype.destroy=function(){for(var H=0,ve=this._listeners;H<ve.length;H+=1){var K=ve[H],de=K[0],Se=K[1],Ce=K[2];n.removeEventListener(de,Se,de===e.window.document?this.handleWindowEvent:this.handleEvent,Ce)}},Ki.prototype._addDefaultHandlers=function(H){var ve=this._map,K=ve.getCanvasContainer();this._add("mapEvent",new Nt(ve,H));var de=ve.boxZoom=new Kt(ve,H);this._add("boxZoom",de);var Se=new tn,Ce=new Za;ve.doubleClickZoom=new Ia(Ce,Se),this._add("tapZoom",Se),this._add("clickZoom",Ce);var Xe=new _o;this._add("tapDragZoom",Xe);var lt=ve.touchPitch=new si;this._add("touchPitch",lt);var wt=new ia(H),Ht=new ka(H);ve.dragRotate=new Ro(H,wt,Ht),this._add("mouseRotate",wt,["mousePitch"]),this._add("mousePitch",Ht,["mouseRotate"]);var nr=new _a(H),sr=new ua(H);ve.dragPan=new ro(K,nr,sr),this._add("mousePan",nr),this._add("touchPan",sr,["touchZoom","touchRotate"]);var Ar=new ni,Nr=new ho;ve.touchZoomRotate=new ji(K,Nr,Ar,Xe),this._add("touchRotate",Ar,["touchPan","touchZoom"]),this._add("touchZoom",Nr,["touchPan","touchRotate"]);var Ur=ve.scrollZoom=new Ui(ve,this);this._add("scrollZoom",Ur,["mousePan"]);var Or=ve.keyboard=new qi;this._add("keyboard",Or),this._add("blockableMapEvent",new Xt(ve));for(var Xr=0,sn=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Xr<sn.length;Xr+=1){var Sn=sn[Xr];H.interactive&&H[Sn]&&ve[Sn].enable(H[Sn])}},Ki.prototype._add=function(H,ve,K){this._handlers.push({handlerName:H,handler:ve,allowed:K}),this._handlersById[H]=ve},Ki.prototype.stop=function(){if(!this._updatingCamera){for(var H=0,ve=this._handlers;H<ve.length;H+=1){var K=ve[H],de=K.handler;de.reset()}this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Ki.prototype.isActive=function(){for(var H=0,ve=this._handlers;H<ve.length;H+=1){var K=ve[H],de=K.handler;if(de.isActive())return!0}return!1},Ki.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Ki.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Ki.prototype.isMoving=function(){return Boolean(Zo(this._eventsInProgress))||this.isZooming()},Ki.prototype._blockedByActive=function(H,ve,K){for(var de in H)if(de!==K&&(!ve||ve.indexOf(de)<0))return!0;return!1},Ki.prototype.handleWindowEvent=function(H){this.handleEvent(H,H.type+"Window")},Ki.prototype._getMapTouches=function(H){for(var ve=[],K=0,de=H;K<de.length;K+=1){var Se=de[K],Ce=Se.target;this._el.contains(Ce)&&ve.push(Se)}return ve},Ki.prototype.handleEvent=function(H,ve){if(H.type==="blur"){this.stop();return}this._updatingCamera=!0;for(var K=H.type==="renderFrame"?void 0:H,de={needsRenderFrame:!1},Se={},Ce={},Xe=H.touches?this._getMapTouches(H.touches):void 0,lt=Xe?n.touchPos(this._el,Xe):n.mousePos(this._el,H),wt=0,Ht=this._handlers;wt<Ht.length;wt+=1){var nr=Ht[wt],sr=nr.handlerName,Ar=nr.handler,Nr=nr.allowed;if(!!Ar.isEnabled()){var Ur=void 0;this._blockedByActive(Ce,Nr,sr)?Ar.reset():Ar[ve||H.type]&&(Ur=Ar[ve||H.type](H,lt,Xe),this.mergeHandlerResult(de,Se,Ur,sr,K),Ur&&Ur.needsRenderFrame&&this._triggerRenderFrame()),(Ur||Ar.isActive())&&(Ce[sr]=Ar)}}var Or={};for(var Xr in this._previousActiveHandlers)Ce[Xr]||(Or[Xr]=K);this._previousActiveHandlers=Ce,(Object.keys(Or).length||Ul(de))&&(this._changes.push([de,Se,Or]),this._triggerRenderFrame()),(Object.keys(Ce).length||Ul(de))&&this._map._stop(!0),this._updatingCamera=!1;var sn=de.cameraAnimation;sn&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],sn(this._map))},Ki.prototype.mergeHandlerResult=function(H,ve,K,de,Se){if(!!K){e.extend(H,K);var Ce={handlerName:de,originalEvent:K.originalEvent||Se};K.zoomDelta!==void 0&&(ve.zoom=Ce),K.panDelta!==void 0&&(ve.drag=Ce),K.pitchDelta!==void 0&&(ve.pitch=Ce),K.bearingDelta!==void 0&&(ve.rotate=Ce)}},Ki.prototype._applyChanges=function(){for(var H={},ve={},K={},de=0,Se=this._changes;de<Se.length;de+=1){var Ce=Se[de],Xe=Ce[0],lt=Ce[1],wt=Ce[2];Xe.panDelta&&(H.panDelta=(H.panDelta||new e.Point(0,0))._add(Xe.panDelta)),Xe.zoomDelta&&(H.zoomDelta=(H.zoomDelta||0)+Xe.zoomDelta),Xe.bearingDelta&&(H.bearingDelta=(H.bearingDelta||0)+Xe.bearingDelta),Xe.pitchDelta&&(H.pitchDelta=(H.pitchDelta||0)+Xe.pitchDelta),Xe.around!==void 0&&(H.around=Xe.around),Xe.pinchAround!==void 0&&(H.pinchAround=Xe.pinchAround),Xe.noInertia&&(H.noInertia=Xe.noInertia),e.extend(ve,lt),e.extend(K,wt)}this._updateMapTransform(H,ve,K),this._changes=[]},Ki.prototype._updateMapTransform=function(H,ve,K){var de=this._map,Se=de.transform;if(!Ul(H))return this._fireEvents(ve,K);var Ce=H.panDelta,Xe=H.zoomDelta,lt=H.bearingDelta,wt=H.pitchDelta,Ht=H.around,nr=H.pinchAround;nr!==void 0&&(Ht=nr),de._stop(!0),Ht=Ht||de.transform.centerPoint;var sr=Se.pointLocation(Ce?Ht.sub(Ce):Ht);lt&&(Se.bearing+=lt),wt&&(Se.pitch+=wt),Xe&&(Se.zoom+=Xe),Se.setLocationAtPoint(sr,Ht),this._map._update(),H.noInertia||this._inertia.record(H),this._fireEvents(ve,K)},Ki.prototype._fireEvents=function(H,ve){var K=this,de=Zo(this._eventsInProgress),Se=Zo(H),Ce={};for(var Xe in H){var lt=H[Xe],wt=lt.originalEvent;this._eventsInProgress[Xe]||(Ce[Xe+"start"]=wt),this._eventsInProgress[Xe]=H[Xe]}!de&&Se&&this._fireEvent("movestart",Se.originalEvent);for(var Ht in Ce)this._fireEvent(Ht,Ce[Ht]);H.rotate&&(this._bearingChanged=!0),Se&&this._fireEvent("move",Se.originalEvent);for(var nr in H){var sr=H[nr],Ar=sr.originalEvent;this._fireEvent(nr,Ar)}var Nr={},Ur;for(var Or in this._eventsInProgress){var Xr=this._eventsInProgress[Or],sn=Xr.handlerName,Sn=Xr.originalEvent;this._handlersById[sn].isActive()||(delete this._eventsInProgress[Or],Ur=ve[sn]||Sn,Nr[Or+"end"]=Ur)}for(var Fn in Nr)this._fireEvent(Fn,Nr[Fn]);var Xn=Zo(this._eventsInProgress);if((de||Se)&&!Xn){this._updatingCamera=!0;var Qn=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),jn=function(ca){return ca!==0&&-K._bearingSnap<ca&&ca<K._bearingSnap};Qn?(jn(Qn.bearing||this._map.getBearing())&&(Qn.bearing=0),this._map.easeTo(Qn,{originalEvent:Ur})):(this._map.fire(new e.Event("moveend",{originalEvent:Ur})),jn(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Ki.prototype._fireEvent=function(H,ve){this._map.fire(new e.Event(H,ve?{originalEvent:ve}:{}))},Ki.prototype._triggerRenderFrame=function(){var H=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(ve){delete H._frameId,H.handleEvent(new bs("renderFrame",{timeStamp:ve})),H._applyChanges()}))};var qu=function(ce){function H(ve,K){ce.call(this),this._moving=!1,this._zooming=!1,this.transform=ve,this._bearingSnap=K.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},H.prototype.setCenter=function(K,de){return this.jumpTo({center:K},de)},H.prototype.panBy=function(K,de,Se){return K=e.Point.convert(K).mult(-1),this.panTo(this.transform.center,e.extend({offset:K},de),Se)},H.prototype.panTo=function(K,de,Se){return this.easeTo(e.extend({center:K},de),Se)},H.prototype.getZoom=function(){return this.transform.zoom},H.prototype.setZoom=function(K,de){return this.jumpTo({zoom:K},de),this},H.prototype.zoomTo=function(K,de,Se){return this.easeTo(e.extend({zoom:K},de),Se)},H.prototype.zoomIn=function(K,de){return this.zoomTo(this.getZoom()+1,K,de),this},H.prototype.zoomOut=function(K,de){return this.zoomTo(this.getZoom()-1,K,de),this},H.prototype.getBearing=function(){return this.transform.bearing},H.prototype.setBearing=function(K,de){return this.jumpTo({bearing:K},de),this},H.prototype.getPadding=function(){return this.transform.padding},H.prototype.setPadding=function(K,de){return this.jumpTo({padding:K},de),this},H.prototype.rotateTo=function(K,de,Se){return this.easeTo(e.extend({bearing:K},de),Se)},H.prototype.resetNorth=function(K,de){return this.rotateTo(0,e.extend({duration:1e3},K),de),this},H.prototype.resetNorthPitch=function(K,de){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},K),de),this},H.prototype.snapToNorth=function(K,de){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(K,de):this},H.prototype.getPitch=function(){return this.transform.pitch},H.prototype.setPitch=function(K,de){return this.jumpTo({pitch:K},de),this},H.prototype.cameraForBounds=function(K,de){return K=e.LngLatBounds.convert(K),this._cameraForBoxAndBearing(K.getNorthWest(),K.getSouthEast(),0,de)},H.prototype._cameraForBoxAndBearing=function(K,de,Se,Ce){var Xe={top:0,bottom:0,right:0,left:0};if(Ce=e.extend({padding:Xe,offset:[0,0],maxZoom:this.transform.maxZoom},Ce),typeof Ce.padding=="number"){var lt=Ce.padding;Ce.padding={top:lt,bottom:lt,right:lt,left:lt}}Ce.padding=e.extend(Xe,Ce.padding);var wt=this.transform,Ht=wt.padding,nr=wt.project(e.LngLat.convert(K)),sr=wt.project(e.LngLat.convert(de)),Ar=nr.rotate(-Se*Math.PI/180),Nr=sr.rotate(-Se*Math.PI/180),Ur=new e.Point(Math.max(Ar.x,Nr.x),Math.max(Ar.y,Nr.y)),Or=new e.Point(Math.min(Ar.x,Nr.x),Math.min(Ar.y,Nr.y)),Xr=Ur.sub(Or),sn=(wt.width-(Ht.left+Ht.right+Ce.padding.left+Ce.padding.right))/Xr.x,Sn=(wt.height-(Ht.top+Ht.bottom+Ce.padding.top+Ce.padding.bottom))/Xr.y;if(Sn<0||sn<0){e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}var Fn=Math.min(wt.scaleZoom(wt.scale*Math.min(sn,Sn)),Ce.maxZoom),Xn=e.Point.convert(Ce.offset),Qn=(Ce.padding.left-Ce.padding.right)/2,jn=(Ce.padding.top-Ce.padding.bottom)/2,ca=new e.Point(Xn.x+Qn,Xn.y+jn),ba=ca.mult(wt.scale/wt.zoomScale(Fn)),ya=wt.unproject(nr.add(sr).div(2).sub(ba));return{center:ya,zoom:Fn,bearing:Se}},H.prototype.fitBounds=function(K,de,Se){return this._fitInternal(this.cameraForBounds(K,de),de,Se)},H.prototype.fitScreenCoordinates=function(K,de,Se,Ce,Xe){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(K)),this.transform.pointLocation(e.Point.convert(de)),Se,Ce),Ce,Xe)},H.prototype._fitInternal=function(K,de,Se){return K?(de=e.extend(K,de),delete de.padding,de.linear?this.easeTo(de,Se):this.flyTo(de,Se)):this},H.prototype.jumpTo=function(K,de){this.stop();var Se=this.transform,Ce=!1,Xe=!1,lt=!1;return"zoom"in K&&Se.zoom!==+K.zoom&&(Ce=!0,Se.zoom=+K.zoom),K.center!==void 0&&(Se.center=e.LngLat.convert(K.center)),"bearing"in K&&Se.bearing!==+K.bearing&&(Xe=!0,Se.bearing=+K.bearing),"pitch"in K&&Se.pitch!==+K.pitch&&(lt=!0,Se.pitch=+K.pitch),K.padding!=null&&!Se.isPaddingEqual(K.padding)&&(Se.padding=K.padding),this.fire(new e.Event("movestart",de)).fire(new e.Event("move",de)),Ce&&this.fire(new e.Event("zoomstart",de)).fire(new e.Event("zoom",de)).fire(new e.Event("zoomend",de)),Xe&&this.fire(new e.Event("rotatestart",de)).fire(new e.Event("rotate",de)).fire(new e.Event("rotateend",de)),lt&&this.fire(new e.Event("pitchstart",de)).fire(new e.Event("pitch",de)).fire(new e.Event("pitchend",de)),this.fire(new e.Event("moveend",de))},H.prototype.easeTo=function(K,de){var Se=this;this._stop(!1,K.easeId),K=e.extend({offset:[0,0],duration:500,easing:e.ease},K),(K.animate===!1||!K.essential&&e.browser.prefersReducedMotion)&&(K.duration=0);var Ce=this.transform,Xe=this.getZoom(),lt=this.getBearing(),wt=this.getPitch(),Ht=this.getPadding(),nr="zoom"in K?+K.zoom:Xe,sr="bearing"in K?this._normalizeBearing(K.bearing,lt):lt,Ar="pitch"in K?+K.pitch:wt,Nr="padding"in K?K.padding:Ce.padding,Ur=e.Point.convert(K.offset),Or=Ce.centerPoint.add(Ur),Xr=Ce.pointLocation(Or),sn=e.LngLat.convert(K.center||Xr);this._normalizeCenter(sn);var Sn=Ce.project(Xr),Fn=Ce.project(sn).sub(Sn),Xn=Ce.zoomScale(nr-Xe),Qn,jn;K.around&&(Qn=e.LngLat.convert(K.around),jn=Ce.locationPoint(Qn));var ca={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||nr!==Xe,this._rotating=this._rotating||lt!==sr,this._pitching=this._pitching||Ar!==wt,this._padding=!Ce.isPaddingEqual(Nr),this._easeId=K.easeId,this._prepareEase(de,K.noMoveStart,ca),clearTimeout(this._easeEndTimeoutID),this._ease(function(ba){if(Se._zooming&&(Ce.zoom=e.number(Xe,nr,ba)),Se._rotating&&(Ce.bearing=e.number(lt,sr,ba)),Se._pitching&&(Ce.pitch=e.number(wt,Ar,ba)),Se._padding&&(Ce.interpolatePadding(Ht,Nr,ba),Or=Ce.centerPoint.add(Ur)),Qn)Ce.setLocationAtPoint(Qn,jn);else{var ya=Ce.zoomScale(Ce.zoom-Xe),Ta=nr>Xe?Math.min(2,Xn):Math.max(.5,Xn),Ca=Math.pow(Ta,1-ba),Ha=Ce.unproject(Sn.add(Fn.mult(ba*Ca)).mult(ya));Ce.setLocationAtPoint(Ce.renderWorldCopies?Ha.wrap():Ha,Or)}Se._fireMoveEvents(de)},function(ba){Se._afterEase(de,ba)},K),this},H.prototype._prepareEase=function(K,de,Se){Se===void 0&&(Se={}),this._moving=!0,!de&&!Se.moving&&this.fire(new e.Event("movestart",K)),this._zooming&&!Se.zooming&&this.fire(new e.Event("zoomstart",K)),this._rotating&&!Se.rotating&&this.fire(new e.Event("rotatestart",K)),this._pitching&&!Se.pitching&&this.fire(new e.Event("pitchstart",K))},H.prototype._fireMoveEvents=function(K){this.fire(new e.Event("move",K)),this._zooming&&this.fire(new e.Event("zoom",K)),this._rotating&&this.fire(new e.Event("rotate",K)),this._pitching&&this.fire(new e.Event("pitch",K))},H.prototype._afterEase=function(K,de){if(!(this._easeId&&de&&this._easeId===de)){delete this._easeId;var Se=this._zooming,Ce=this._rotating,Xe=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,Se&&this.fire(new e.Event("zoomend",K)),Ce&&this.fire(new e.Event("rotateend",K)),Xe&&this.fire(new e.Event("pitchend",K)),this.fire(new e.Event("moveend",K))}},H.prototype.flyTo=function(K,de){var Se=this;if(!K.essential&&e.browser.prefersReducedMotion){var Ce=e.pick(K,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ce,de)}this.stop(),K=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},K);var Xe=this.transform,lt=this.getZoom(),wt=this.getBearing(),Ht=this.getPitch(),nr=this.getPadding(),sr="zoom"in K?e.clamp(+K.zoom,Xe.minZoom,Xe.maxZoom):lt,Ar="bearing"in K?this._normalizeBearing(K.bearing,wt):wt,Nr="pitch"in K?+K.pitch:Ht,Ur="padding"in K?K.padding:Xe.padding,Or=Xe.zoomScale(sr-lt),Xr=e.Point.convert(K.offset),sn=Xe.centerPoint.add(Xr),Sn=Xe.pointLocation(sn),Fn=e.LngLat.convert(K.center||Sn);this._normalizeCenter(Fn);var Xn=Xe.project(Sn),Qn=Xe.project(Fn).sub(Xn),jn=K.curve,ca=Math.max(Xe.width,Xe.height),ba=ca/Or,ya=Qn.mag();if("minZoom"in K){var Ta=e.clamp(Math.min(K.minZoom,lt,sr),Xe.minZoom,Xe.maxZoom),Ca=ca/Xe.zoomScale(Ta-lt);jn=Math.sqrt(Ca/ya*2)}var Ha=jn*jn;function ri(ai){var Ai=(ba*ba-ca*ca+(ai?-1:1)*Ha*Ha*ya*ya)/(2*(ai?ba:ca)*Ha*ya);return Math.log(Math.sqrt(Ai*Ai+1)-Ai)}function Di(ai){return(Math.exp(ai)-Math.exp(-ai))/2}function li(ai){return(Math.exp(ai)+Math.exp(-ai))/2}function gi(ai){return Di(ai)/li(ai)}var Ba=ri(0),Ri=function(ai){return li(Ba)/li(Ba+jn*ai)},Oi=function(ai){return ca*((li(Ba)*gi(Ba+jn*ai)-Di(Ba))/Ha)/ya},Vi=(ri(1)-Ba)/jn;if(Math.abs(ya)<1e-6||!isFinite(Vi)){if(Math.abs(ca-ba)<1e-6)return this.easeTo(K,de);var Ti=ba<ca?-1:1;Vi=Math.abs(Math.log(ba/ca))/jn,Oi=function(){return 0},Ri=function(ai){return Math.exp(Ti*jn*ai)}}if("duration"in K)K.duration=+K.duration;else{var Ji="screenSpeed"in K?+K.screenSpeed/jn:+K.speed;K.duration=1e3*Vi/Ji}return K.maxDuration&&K.duration>K.maxDuration&&(K.duration=0),this._zooming=!0,this._rotating=wt!==Ar,this._pitching=Nr!==Ht,this._padding=!Xe.isPaddingEqual(Ur),this._prepareEase(de,!1),this._ease(function(ai){var Ai=ai*Vi,To=1/Ri(Ai);Xe.zoom=ai===1?sr:lt+Xe.scaleZoom(To),Se._rotating&&(Xe.bearing=e.number(wt,Ar,ai)),Se._pitching&&(Xe.pitch=e.number(Ht,Nr,ai)),Se._padding&&(Xe.interpolatePadding(nr,Ur,ai),sn=Xe.centerPoint.add(Xr));var No=ai===1?Fn:Xe.unproject(Xn.add(Qn.mult(Oi(Ai))).mult(To));Xe.setLocationAtPoint(Xe.renderWorldCopies?No.wrap():No,sn),Se._fireMoveEvents(de)},function(){return Se._afterEase(de)},K),this},H.prototype.isEasing=function(){return!!this._easeFrameId},H.prototype.stop=function(){return this._stop()},H.prototype._stop=function(K,de){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var Se=this._onEaseEnd;delete this._onEaseEnd,Se.call(this,de)}if(!K){var Ce=this.handlers;Ce&&Ce.stop()}return this},H.prototype._ease=function(K,de,Se){Se.animate===!1||Se.duration===0?(K(1),de()):(this._easeStart=e.browser.now(),this._easeOptions=Se,this._onEaseFrame=K,this._onEaseEnd=de,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},H.prototype._renderFrameCallback=function(){var K=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(K)),K<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},H.prototype._normalizeBearing=function(K,de){K=e.wrap(K,-180,180);var Se=Math.abs(K-de);return Math.abs(K-360-de)<Se&&(K-=360),Math.abs(K+360-de)<Se&&(K+=360),K},H.prototype._normalizeCenter=function(K){var de=this.transform;if(!(!de.renderWorldCopies||de.lngRange)){var Se=K.lng-de.center.lng;K.lng+=Se>180?-360:Se<-180?360:0}},H}(e.Evented),Ml=function(H){H===void 0&&(H={}),this.options=H,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Ml.prototype.getDefaultPosition=function(){return"bottom-right"},Ml.prototype.onAdd=function(H){var ve=this.options&&this.options.compact;return this._map=H,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),ve&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),ve===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Ml.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Ml.prototype._updateEditLink=function(){var H=this._editLink;H||(H=this._editLink=this._container.querySelector(".mapbox-improve-map"));var ve=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(H){var K=ve.reduce(function(de,Se,Ce){return Se.value&&(de+=Se.key+"="+Se.value+(Ce<ve.length-1?"&":"")),de},"?");H.href=e.config.FEEDBACK_URL+"/"+K+(this._map._hash?this._map._hash.getHashString(!0):""),H.rel="noopener nofollow"}},Ml.prototype._updateData=function(H){H&&(H.sourceDataType==="metadata"||H.dataType==="style")&&(this._updateAttributions(),this._updateEditLink())},Ml.prototype._updateAttributions=function(){if(!!this._map.style){var H=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?H=H.concat(this.options.customAttribution.map(function(lt){return typeof lt!="string"?"":lt})):typeof this.options.customAttribution=="string"&&H.push(this.options.customAttribution)),this._map.style.stylesheet){var ve=this._map.style.stylesheet;this.styleOwner=ve.owner,this.styleId=ve.id}var K=this._map.style.sourceCaches;for(var de in K){var Se=K[de];if(Se.used){var Ce=Se.getSource();Ce.attribution&&H.indexOf(Ce.attribution)<0&&H.push(Ce.attribution)}}H.sort(function(lt,wt){return lt.length-wt.length}),H=H.filter(function(lt,wt){for(var Ht=wt+1;Ht<H.length;Ht++)if(H[Ht].indexOf(lt)>=0)return!1;return!0});var Xe=H.join(" | ");Xe!==this._attribHTML&&(this._attribHTML=Xe,H.length?(this._innerContainer.innerHTML=Xe,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Ml.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var Ni=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};Ni.prototype.onAdd=function(H){this._map=H,this._container=n.create("div","mapboxgl-ctrl");var ve=n.create("a","mapboxgl-ctrl-logo");return ve.target="_blank",ve.rel="noopener nofollow",ve.href="https://www.mapbox.com/",ve.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),ve.setAttribute("rel","noopener nofollow"),this._container.appendChild(ve),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},Ni.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},Ni.prototype.getDefaultPosition=function(){return"bottom-left"},Ni.prototype._updateLogo=function(H){(!H||H.sourceDataType==="metadata")&&(this._container.style.display=this._logoRequired()?"block":"none")},Ni.prototype._logoRequired=function(){if(!!this._map.style){var H=this._map.style.sourceCaches;for(var ve in H){var K=H[ve].getSource();if(K.mapbox_logo)return!0}return!1}},Ni.prototype._updateCompact=function(){var H=this._container.children;if(H.length){var ve=H[0];this._map.getCanvasContainer().offsetWidth<250?ve.classList.add("mapboxgl-compact"):ve.classList.remove("mapboxgl-compact")}};var Io=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Io.prototype.add=function(H){var ve=++this._id,K=this._queue;return K.push({callback:H,id:ve,cancelled:!1}),ve},Io.prototype.remove=function(H){for(var ve=this._currentlyRunning,K=ve?this._queue.concat(ve):this._queue,de=0,Se=K;de<Se.length;de+=1){var Ce=Se[de];if(Ce.id===H){Ce.cancelled=!0;return}}},Io.prototype.run=function(H){H===void 0&&(H=0);var ve=this._currentlyRunning=this._queue;this._queue=[];for(var K=0,de=ve;K<de.length;K+=1){var Se=de[K];if(!Se.cancelled&&(Se.callback(H),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Io.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ah={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Sf=e.window.HTMLImageElement,pf=e.window.HTMLElement,Ou=e.window.ImageBitmap,ef=-2,kf=22,Bs=0,Bu=60,qf={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:ef,maxZoom:kf,minPitch:Bs,maxPitch:Bu,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ec=function(ce){function H(K){var de=this;if(K=e.extend({},qf,K),K.minZoom!=null&&K.maxZoom!=null&&K.minZoom>K.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(K.minPitch!=null&&K.maxPitch!=null&&K.minPitch>K.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(K.minPitch!=null&&K.minPitch<Bs)throw new Error("minPitch must be greater than or equal to "+Bs);if(K.maxPitch!=null&&K.maxPitch>Bu)throw new Error("maxPitch must be less than or equal to "+Bu);var Se=new wi(K.minZoom,K.maxZoom,K.minPitch,K.maxPitch,K.renderWorldCopies);if(ce.call(this,Se,K),this._interactive=K.interactive,this._maxTileCacheSize=K.maxTileCacheSize,this._failIfMajorPerformanceCaveat=K.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=K.preserveDrawingBuffer,this._antialias=K.antialias,this._trackResize=K.trackResize,this._bearingSnap=K.bearingSnap,this._refreshExpiredTiles=K.refreshExpiredTiles,this._fadeDuration=K.fadeDuration,this._crossSourceCollisions=K.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=K.collectResourceTiming,this._renderTaskQueue=new Io,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},ah,K.locale),this._requestManager=new e.RequestManager(K.transformRequest,K.accessToken),typeof K.container=="string"){if(this._container=e.window.document.getElementById(K.container),!this._container)throw new Error("Container '"+K.container+"' not found.")}else if(K.container instanceof pf)this._container=K.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(K.maxBounds&&this.setMaxBounds(K.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return de._update(!1)}),this.on("moveend",function(){return de._update(!1)}),this.on("zoom",function(){return de._update(!0)}),typeof e.window!="undefined"&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Ki(this,K);var Ce=typeof K.hash=="string"&&K.hash||void 0;this._hash=K.hash&&new yo(Ce).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:K.center,zoom:K.zoom,bearing:K.bearing,pitch:K.pitch}),K.bounds&&(this.resize(),this.fitBounds(K.bounds,e.extend({},K.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=K.localIdeographFontFamily,K.style&&this.setStyle(K.style,{localIdeographFontFamily:K.localIdeographFontFamily}),K.attributionControl&&this.addControl(new Ml({customAttribution:K.customAttribution})),this.addControl(new Ni,K.logoPosition),this.on("style.load",function(){de.transform.unmodified&&de.jumpTo(de.style.stylesheet)}),this.on("data",function(Xe){de._update(Xe.dataType==="style"),de.fire(new e.Event(Xe.dataType+"data",Xe))}),this.on("dataloading",function(Xe){de.fire(new e.Event(Xe.dataType+"dataloading",Xe))})}ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H;var ve={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return H.prototype._getMapId=function(){return this._mapId},H.prototype.addControl=function(de,Se){if(Se===void 0&&de.getDefaultPosition&&(Se=de.getDefaultPosition()),Se===void 0&&(Se="top-right"),!de||!de.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var Ce=de.onAdd(this);this._controls.push(de);var Xe=this._controlPositions[Se];return Se.indexOf("bottom")!==-1?Xe.insertBefore(Ce,Xe.firstChild):Xe.appendChild(Ce),this},H.prototype.removeControl=function(de){if(!de||!de.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var Se=this._controls.indexOf(de);return Se>-1&&this._controls.splice(Se,1),de.onRemove(this),this},H.prototype.resize=function(de){var Se=this._containerDimensions(),Ce=Se[0],Xe=Se[1];this._resizeCanvas(Ce,Xe),this.transform.resize(Ce,Xe),this.painter.resize(Ce,Xe);var lt=!this._moving;return lt&&(this.stop(),this.fire(new e.Event("movestart",de)).fire(new e.Event("move",de))),this.fire(new e.Event("resize",de)),lt&&this.fire(new e.Event("moveend",de)),this},H.prototype.getBounds=function(){return this.transform.getBounds()},H.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},H.prototype.setMaxBounds=function(de){return this.transform.setMaxBounds(e.LngLatBounds.convert(de)),this._update()},H.prototype.setMinZoom=function(de){if(de=de==null?ef:de,de>=ef&&de<=this.transform.maxZoom)return this.transform.minZoom=de,this._update(),this.getZoom()<de&&this.setZoom(de),this;throw new Error("minZoom must be between "+ef+" and the current maxZoom, inclusive")},H.prototype.getMinZoom=function(){return this.transform.minZoom},H.prototype.setMaxZoom=function(de){if(de=de==null?kf:de,de>=this.transform.minZoom)return this.transform.maxZoom=de,this._update(),this.getZoom()>de&&this.setZoom(de),this;throw new Error("maxZoom must be greater than the current minZoom")},H.prototype.getMaxZoom=function(){return this.transform.maxZoom},H.prototype.setMinPitch=function(de){if(de=de==null?Bs:de,de<Bs)throw new Error("minPitch must be greater than or equal to "+Bs);if(de>=Bs&&de<=this.transform.maxPitch)return this.transform.minPitch=de,this._update(),this.getPitch()<de&&this.setPitch(de),this;throw new Error("minPitch must be between "+Bs+" and the current maxPitch, inclusive")},H.prototype.getMinPitch=function(){return this.transform.minPitch},H.prototype.setMaxPitch=function(de){if(de=de==null?Bu:de,de>Bu)throw new Error("maxPitch must be less than or equal to "+Bu);if(de>=this.transform.minPitch)return this.transform.maxPitch=de,this._update(),this.getPitch()>de&&this.setPitch(de),this;throw new Error("maxPitch must be greater than the current minPitch")},H.prototype.getMaxPitch=function(){return this.transform.maxPitch},H.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},H.prototype.setRenderWorldCopies=function(de){return this.transform.renderWorldCopies=de,this._update()},H.prototype.project=function(de){return this.transform.locationPoint(e.LngLat.convert(de))},H.prototype.unproject=function(de){return this.transform.pointLocation(e.Point.convert(de))},H.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},H.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},H.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},H.prototype._createDelegatedListener=function(de,Se,Ce){var Xe=this,lt;if(de==="mouseenter"||de==="mouseover"){var wt=!1,Ht=function(Or){var Xr=Xe.getLayer(Se)?Xe.queryRenderedFeatures(Or.point,{layers:[Se]}):[];Xr.length?wt||(wt=!0,Ce.call(Xe,new yt(de,Xe,Or.originalEvent,{features:Xr}))):wt=!1},nr=function(){wt=!1};return{layer:Se,listener:Ce,delegates:{mousemove:Ht,mouseout:nr}}}else if(de==="mouseleave"||de==="mouseout"){var sr=!1,Ar=function(Or){var Xr=Xe.getLayer(Se)?Xe.queryRenderedFeatures(Or.point,{layers:[Se]}):[];Xr.length?sr=!0:sr&&(sr=!1,Ce.call(Xe,new yt(de,Xe,Or.originalEvent)))},Nr=function(Or){sr&&(sr=!1,Ce.call(Xe,new yt(de,Xe,Or.originalEvent)))};return{layer:Se,listener:Ce,delegates:{mousemove:Ar,mouseout:Nr}}}else{var Ur=function(Or){var Xr=Xe.getLayer(Se)?Xe.queryRenderedFeatures(Or.point,{layers:[Se]}):[];Xr.length&&(Or.features=Xr,Ce.call(Xe,Or),delete Or.features)};return{layer:Se,listener:Ce,delegates:(lt={},lt[de]=Ur,lt)}}},H.prototype.on=function(de,Se,Ce){if(Ce===void 0)return ce.prototype.on.call(this,de,Se);var Xe=this._createDelegatedListener(de,Se,Ce);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[de]=this._delegatedListeners[de]||[],this._delegatedListeners[de].push(Xe);for(var lt in Xe.delegates)this.on(lt,Xe.delegates[lt]);return this},H.prototype.once=function(de,Se,Ce){if(Ce===void 0)return ce.prototype.once.call(this,de,Se);var Xe=this._createDelegatedListener(de,Se,Ce);for(var lt in Xe.delegates)this.once(lt,Xe.delegates[lt]);return this},H.prototype.off=function(de,Se,Ce){var Xe=this;if(Ce===void 0)return ce.prototype.off.call(this,de,Se);var lt=function(wt){for(var Ht=wt[de],nr=0;nr<Ht.length;nr++){var sr=Ht[nr];if(sr.layer===Se&&sr.listener===Ce){for(var Ar in sr.delegates)Xe.off(Ar,sr.delegates[Ar]);return Ht.splice(nr,1),Xe}}};return this._delegatedListeners&&this._delegatedListeners[de]&&lt(this._delegatedListeners),this},H.prototype.queryRenderedFeatures=function(de,Se){if(!this.style)return[];Se===void 0&&de!==void 0&&!(de instanceof e.Point)&&!Array.isArray(de)&&(Se=de,de=void 0),Se=Se||{},de=de||[[0,0],[this.transform.width,this.transform.height]];var Ce;if(de instanceof e.Point||typeof de[0]=="number")Ce=[e.Point.convert(de)];else{var Xe=e.Point.convert(de[0]),lt=e.Point.convert(de[1]);Ce=[Xe,new e.Point(lt.x,Xe.y),lt,new e.Point(Xe.x,lt.y),Xe]}return this.style.queryRenderedFeatures(Ce,Se,this.transform)},H.prototype.querySourceFeatures=function(de,Se){return this.style.querySourceFeatures(de,Se)},H.prototype.setStyle=function(de,Se){return Se=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},Se),Se.diff!==!1&&Se.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&de?(this._diffStyle(de,Se),this):(this._localIdeographFontFamily=Se.localIdeographFontFamily,this._updateStyle(de,Se))},H.prototype._getUIString=function(de){var Se=this._locale[de];if(Se==null)throw new Error("Missing UI string '"+de+"'");return Se},H.prototype._updateStyle=function(de,Se){if(this.style&&(this.style.setEventedParent(null),this.style._remove()),de)this.style=new Ko(this,Se||{});else return delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof de=="string"?this.style.loadURL(de):this.style.loadJSON(de),this},H.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Ko(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},H.prototype._diffStyle=function(de,Se){var Ce=this;if(typeof de=="string"){var Xe=this._requestManager.normalizeStyleURL(de),lt=this._requestManager.transformRequest(Xe,e.ResourceType.Style);e.getJSON(lt,function(wt,Ht){wt?Ce.fire(new e.ErrorEvent(wt)):Ht&&Ce._updateDiff(Ht,Se)})}else typeof de=="object"&&this._updateDiff(de,Se)},H.prototype._updateDiff=function(de,Se){try{this.style.setState(de)&&this._update(!0)}catch(Ce){e.warnOnce("Unable to perform style diff: "+(Ce.message||Ce.error||Ce)+".  Rebuilding the style from scratch."),this._updateStyle(de,Se)}},H.prototype.getStyle=function(){if(this.style)return this.style.serialize()},H.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},H.prototype.addSource=function(de,Se){return this._lazyInitEmptyStyle(),this.style.addSource(de,Se),this._update(!0)},H.prototype.isSourceLoaded=function(de){var Se=this.style&&this.style.sourceCaches[de];if(Se===void 0){this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+de+"'")));return}return Se.loaded()},H.prototype.areTilesLoaded=function(){var de=this.style&&this.style.sourceCaches;for(var Se in de){var Ce=de[Se],Xe=Ce._tiles;for(var lt in Xe){var wt=Xe[lt];if(!(wt.state==="loaded"||wt.state==="errored"))return!1}}return!0},H.prototype.addSourceType=function(de,Se,Ce){return this._lazyInitEmptyStyle(),this.style.addSourceType(de,Se,Ce)},H.prototype.removeSource=function(de){return this.style.removeSource(de),this._update(!0)},H.prototype.getSource=function(de){return this.style.getSource(de)},H.prototype.addImage=function(de,Se,Ce){Ce===void 0&&(Ce={});var Xe=Ce.pixelRatio;Xe===void 0&&(Xe=1);var lt=Ce.sdf;lt===void 0&&(lt=!1);var wt=Ce.stretchX,Ht=Ce.stretchY,nr=Ce.content;this._lazyInitEmptyStyle();var sr=0;if(Se instanceof Sf||Ou&&Se instanceof Ou){var Ar=e.browser.getImageData(Se),Nr=Ar.width,Ur=Ar.height,Or=Ar.data;this.style.addImage(de,{data:new e.RGBAImage({width:Nr,height:Ur},Or),pixelRatio:Xe,stretchX:wt,stretchY:Ht,content:nr,sdf:lt,version:sr})}else{if(Se.width===void 0||Se.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Xr=Se.width,sn=Se.height,Sn=Se.data,Fn=Se;this.style.addImage(de,{data:new e.RGBAImage({width:Xr,height:sn},new Uint8Array(Sn)),pixelRatio:Xe,stretchX:wt,stretchY:Ht,content:nr,sdf:lt,version:sr,userImage:Fn}),Fn.onAdd&&Fn.onAdd(this,de)}},H.prototype.updateImage=function(de,Se){var Ce=this.style.getImage(de);if(!Ce)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var Xe=Se instanceof Sf||Ou&&Se instanceof Ou?e.browser.getImageData(Se):Se,lt=Xe.width,wt=Xe.height,Ht=Xe.data;if(lt===void 0||wt===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(lt!==Ce.data.width||wt!==Ce.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var nr=!(Se instanceof Sf||Ou&&Se instanceof Ou);Ce.data.replace(Ht,nr),this.style.updateImage(de,Ce)},H.prototype.hasImage=function(de){return de?!!this.style.getImage(de):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},H.prototype.removeImage=function(de){this.style.removeImage(de)},H.prototype.loadImage=function(de,Se){e.getImage(this._requestManager.transformRequest(de,e.ResourceType.Image),Se)},H.prototype.listImages=function(){return this.style.listImages()},H.prototype.addLayer=function(de,Se){return this._lazyInitEmptyStyle(),this.style.addLayer(de,Se),this._update(!0)},H.prototype.moveLayer=function(de,Se){return this.style.moveLayer(de,Se),this._update(!0)},H.prototype.removeLayer=function(de){return this.style.removeLayer(de),this._update(!0)},H.prototype.getLayer=function(de){return this.style.getLayer(de)},H.prototype.setLayerZoomRange=function(de,Se,Ce){return this.style.setLayerZoomRange(de,Se,Ce),this._update(!0)},H.prototype.setFilter=function(de,Se,Ce){return Ce===void 0&&(Ce={}),this.style.setFilter(de,Se,Ce),this._update(!0)},H.prototype.getFilter=function(de){return this.style.getFilter(de)},H.prototype.setPaintProperty=function(de,Se,Ce,Xe){return Xe===void 0&&(Xe={}),this.style.setPaintProperty(de,Se,Ce,Xe),this._update(!0)},H.prototype.getPaintProperty=function(de,Se){return this.style.getPaintProperty(de,Se)},H.prototype.setLayoutProperty=function(de,Se,Ce,Xe){return Xe===void 0&&(Xe={}),this.style.setLayoutProperty(de,Se,Ce,Xe),this._update(!0)},H.prototype.getLayoutProperty=function(de,Se){return this.style.getLayoutProperty(de,Se)},H.prototype.setLight=function(de,Se){return Se===void 0&&(Se={}),this._lazyInitEmptyStyle(),this.style.setLight(de,Se),this._update(!0)},H.prototype.getLight=function(){return this.style.getLight()},H.prototype.setFeatureState=function(de,Se){return this.style.setFeatureState(de,Se),this._update()},H.prototype.removeFeatureState=function(de,Se){return this.style.removeFeatureState(de,Se),this._update()},H.prototype.getFeatureState=function(de){return this.style.getFeatureState(de)},H.prototype.getContainer=function(){return this._container},H.prototype.getCanvasContainer=function(){return this._canvasContainer},H.prototype.getCanvas=function(){return this._canvas},H.prototype._containerDimensions=function(){var de=0,Se=0;return this._container&&(de=this._container.clientWidth||400,Se=this._container.clientHeight||300),[de,Se]},H.prototype._detectMissingCSS=function(){var de=e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color");de!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},H.prototype._setupContainer=function(){var de=this._container;de.classList.add("mapboxgl-map");var Se=this._missingCSSCanary=n.create("div","mapboxgl-canary",de);Se.style.visibility="hidden",this._detectMissingCSS();var Ce=this._canvasContainer=n.create("div","mapboxgl-canvas-container",de);this._interactive&&Ce.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",Ce),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var Xe=this._containerDimensions();this._resizeCanvas(Xe[0],Xe[1]);var lt=this._controlContainer=n.create("div","mapboxgl-control-container",de),wt=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Ht){wt[Ht]=n.create("div","mapboxgl-ctrl-"+Ht,lt)})},H.prototype._resizeCanvas=function(de,Se){var Ce=e.browser.devicePixelRatio||1;this._canvas.width=Ce*de,this._canvas.height=Ce*Se,this._canvas.style.width=de+"px",this._canvas.style.height=Se+"px"},H.prototype._setupPainter=function(){var de=e.extend({},a.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),Se=this._canvas.getContext("webgl",de)||this._canvas.getContext("experimental-webgl",de);if(!Se){this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")));return}this.painter=new ti(Se,this.transform),e.webpSupported.testSupport(Se)},H.prototype._contextLost=function(de){de.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:de}))},H.prototype._contextRestored=function(de){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:de}))},H.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},H.prototype._update=function(de){return this.style?(this._styleDirty=this._styleDirty||de,this._sourcesDirty=!0,this.triggerRepaint(),this):this},H.prototype._requestRenderFrame=function(de){return this._update(),this._renderTaskQueue.add(de)},H.prototype._cancelRenderFrame=function(de){this._renderTaskQueue.remove(de)},H.prototype._render=function(de){var Se=this,Ce,Xe=0,lt=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(Ce=lt.createQueryEXT(),lt.beginQueryEXT(lt.TIME_ELAPSED_EXT,Ce),Xe=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(de),!this._removed){var wt=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ht=this.transform.zoom,nr=e.browser.now();this.style.zoomHistory.update(Ht,nr);var sr=new e.EvaluationParameters(Ht,{now:nr,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Ar=sr.crossFadingFactor();(Ar!==1||Ar!==this._crossFadingFactor)&&(wt=!0,this._crossFadingFactor=Ar),this.style.update(sr)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||wt)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Nr=e.browser.now()-Xe;lt.endQueryEXT(lt.TIME_ELAPSED_EXT,Ce),setTimeout(function(){var Xr=lt.getQueryObjectEXT(Ce,lt.QUERY_RESULT_EXT)/1e6;lt.deleteQueryEXT(Ce),Se.fire(new e.Event("gpu-timing-frame",{cpuTime:Nr,gpuTime:Xr}))},50)}if(this.listens("gpu-timing-layer")){var Ur=this.painter.collectGpuTimers();setTimeout(function(){var Xr=Se.painter.queryGpuTimers(Ur);Se.fire(new e.Event("gpu-timing-layer",{layerTimes:Xr}))},50)}var Or=this._sourcesDirty||this._styleDirty||this._placementDirty;return Or||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},H.prototype.remove=function(){this._hash&&this._hash.remove();for(var de=0,Se=this._controls;de<Se.length;de+=1){var Ce=Se[de];Ce.onRemove(this)}this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof e.window!="undefined"&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var Xe=this.painter.context.gl.getExtension("WEBGL_lose_context");Xe&&Xe.loseContext(),df(this._canvasContainer),df(this._controlContainer),df(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},H.prototype.triggerRepaint=function(){var de=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(Se){de._frame=null,de._render(Se)}))},H.prototype._onWindowOnline=function(){this._update()},H.prototype._onWindowResize=function(de){this._trackResize&&this.resize({originalEvent:de})._update()},ve.showTileBoundaries.get=function(){return!!this._showTileBoundaries},ve.showTileBoundaries.set=function(K){this._showTileBoundaries!==K&&(this._showTileBoundaries=K,this._update())},ve.showPadding.get=function(){return!!this._showPadding},ve.showPadding.set=function(K){this._showPadding!==K&&(this._showPadding=K,this._update())},ve.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},ve.showCollisionBoxes.set=function(K){this._showCollisionBoxes!==K&&(this._showCollisionBoxes=K,K?this.style._generateCollisionBoxes():this._update())},ve.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},ve.showOverdrawInspector.set=function(K){this._showOverdrawInspector!==K&&(this._showOverdrawInspector=K,this._update())},ve.repaint.get=function(){return!!this._repaint},ve.repaint.set=function(K){this._repaint!==K&&(this._repaint=K,this.triggerRepaint())},ve.vertices.get=function(){return!!this._vertices},ve.vertices.set=function(K){this._vertices=K,this._update()},H.prototype._setCacheLimits=function(de,Se){e.setCacheLimits(de,Se)},ve.version.get=function(){return e.version},Object.defineProperties(H.prototype,ve),H}(qu);function df(ce){ce.parentNode&&ce.parentNode.removeChild(ce)}var Ef={showCompass:!0,showZoom:!0,visualizePitch:!1},xu=function(H){var ve=this;this.options=e.extend({},Ef,H),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(K){return K.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(K){return ve._map.zoomIn({},{originalEvent:K})}),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(K){return ve._map.zoomOut({},{originalEvent:K})}),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(K){ve.options.visualizePitch?ve._map.resetNorthPitch({},{originalEvent:K}):ve._map.resetNorth({},{originalEvent:K})}),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};xu.prototype._updateZoomButtons=function(){var H=this._map.getZoom();this._zoomInButton.disabled=H===this._map.getMaxZoom(),this._zoomOutButton.disabled=H===this._map.getMinZoom()},xu.prototype._rotateCompassArrow=function(){var H=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=H},xu.prototype.onAdd=function(H){return this._map=H,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new $s(this._map,this._compass,this.options.visualizePitch)),this._container},xu.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},xu.prototype._createButton=function(H,ve){var K=n.create("button",H,this._container);return K.type="button",K.addEventListener("click",ve),K},xu.prototype._setButtonTitle=function(H,ve){var K=this._map._getUIString("NavigationControl."+ve);H.title=K,H.setAttribute("aria-label",K)};var $s=function(H,ve,K){K===void 0&&(K=!1),this._clickTolerance=10,this.element=ve,this.mouseRotate=new ia({clickTolerance:H.dragRotate._mouseRotate._clickTolerance}),this.map=H,K&&(this.mousePitch=new ka({clickTolerance:H.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(ve,"mousedown",this.mousedown),n.addEventListener(ve,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(ve,"touchmove",this.touchmove),n.addEventListener(ve,"touchend",this.touchend),n.addEventListener(ve,"touchcancel",this.reset)};$s.prototype.down=function(H,ve){this.mouseRotate.mousedown(H,ve),this.mousePitch&&this.mousePitch.mousedown(H,ve),n.disableDrag()},$s.prototype.move=function(H,ve){var K=this.map,de=this.mouseRotate.mousemoveWindow(H,ve);if(de&&de.bearingDelta&&K.setBearing(K.getBearing()+de.bearingDelta),this.mousePitch){var Se=this.mousePitch.mousemoveWindow(H,ve);Se&&Se.pitchDelta&&K.setPitch(K.getPitch()+Se.pitchDelta)}},$s.prototype.off=function(){var H=this.element;n.removeEventListener(H,"mousedown",this.mousedown),n.removeEventListener(H,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(H,"touchmove",this.touchmove),n.removeEventListener(H,"touchend",this.touchend),n.removeEventListener(H,"touchcancel",this.reset),this.offTemp()},$s.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(e.window,"mousemove",this.mousemove),n.removeEventListener(e.window,"mouseup",this.mouseup)},$s.prototype.mousedown=function(H){this.down(e.extend({},H,{ctrlKey:!0,preventDefault:function(){return H.preventDefault()}}),n.mousePos(this.element,H)),n.addEventListener(e.window,"mousemove",this.mousemove),n.addEventListener(e.window,"mouseup",this.mouseup)},$s.prototype.mousemove=function(H){this.move(H,n.mousePos(this.element,H))},$s.prototype.mouseup=function(H){this.mouseRotate.mouseupWindow(H),this.mousePitch&&this.mousePitch.mouseupWindow(H),this.offTemp()},$s.prototype.touchstart=function(H){H.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,H.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return H.preventDefault()}},this._startPos))},$s.prototype.touchmove=function(H){H.targetTouches.length!==1?this.reset():(this._lastPos=n.touchPos(this.element,H.targetTouches)[0],this.move({preventDefault:function(){return H.preventDefault()}},this._lastPos))},$s.prototype.touchend=function(H){H.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},$s.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};function bu(ce,H,ve){if(ce=new e.LngLat(ce.lng,ce.lat),H){var K=new e.LngLat(ce.lng-360,ce.lat),de=new e.LngLat(ce.lng+360,ce.lat),Se=ve.locationPoint(ce).distSqr(H);ve.locationPoint(K).distSqr(H)<Se?ce=K:ve.locationPoint(de).distSqr(H)<Se&&(ce=de)}for(;Math.abs(ce.lng-ve.center.lng)>180;){var Ce=ve.locationPoint(ce);if(Ce.x>=0&&Ce.y>=0&&Ce.x<=ve.width&&Ce.y<=ve.height)break;ce.lng>ve.center.lng?ce.lng-=360:ce.lng+=360}return ce}var gf={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Cf(ce,H,ve){var K=ce.classList;for(var de in gf)K.remove("mapboxgl-"+ve+"-anchor-"+de);K.add("mapboxgl-"+ve+"-anchor-"+H)}var tf=function(ce){function H(ve,K){var de=this;if(ce.call(this),(ve instanceof e.window.HTMLElement||K)&&(ve=e.extend({element:ve},K)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=ve&&ve.anchor||"center",this._color=ve&&ve.color||"#3FB1CE",this._draggable=ve&&ve.draggable||!1,this._state="inactive",this._rotation=ve&&ve.rotation||0,this._rotationAlignment=ve&&ve.rotationAlignment||"auto",this._pitchAlignment=ve&&ve.pitchAlignment&&ve.pitchAlignment!=="auto"?ve.pitchAlignment:this._rotationAlignment,!ve||!ve.element){this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var Se=n.createNS("http://www.w3.org/2000/svg","svg");Se.setAttributeNS(null,"display","block"),Se.setAttributeNS(null,"height","41px"),Se.setAttributeNS(null,"width","27px"),Se.setAttributeNS(null,"viewBox","0 0 27 41");var Ce=n.createNS("http://www.w3.org/2000/svg","g");Ce.setAttributeNS(null,"stroke","none"),Ce.setAttributeNS(null,"stroke-width","1"),Ce.setAttributeNS(null,"fill","none"),Ce.setAttributeNS(null,"fill-rule","evenodd");var Xe=n.createNS("http://www.w3.org/2000/svg","g");Xe.setAttributeNS(null,"fill-rule","nonzero");var lt=n.createNS("http://www.w3.org/2000/svg","g");lt.setAttributeNS(null,"transform","translate(3.0, 29.0)"),lt.setAttributeNS(null,"fill","#000000");for(var wt=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}],Ht=0,nr=wt;Ht<nr.length;Ht+=1){var sr=nr[Ht],Ar=n.createNS("http://www.w3.org/2000/svg","ellipse");Ar.setAttributeNS(null,"opacity","0.04"),Ar.setAttributeNS(null,"cx","10.5"),Ar.setAttributeNS(null,"cy","5.80029008"),Ar.setAttributeNS(null,"rx",sr.rx),Ar.setAttributeNS(null,"ry",sr.ry),lt.appendChild(Ar)}var Nr=n.createNS("http://www.w3.org/2000/svg","g");Nr.setAttributeNS(null,"fill",this._color);var Ur=n.createNS("http://www.w3.org/2000/svg","path");Ur.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Nr.appendChild(Ur);var Or=n.createNS("http://www.w3.org/2000/svg","g");Or.setAttributeNS(null,"opacity","0.25"),Or.setAttributeNS(null,"fill","#000000");var Xr=n.createNS("http://www.w3.org/2000/svg","path");Xr.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Or.appendChild(Xr);var sn=n.createNS("http://www.w3.org/2000/svg","g");sn.setAttributeNS(null,"transform","translate(6.0, 7.0)"),sn.setAttributeNS(null,"fill","#FFFFFF");var Sn=n.createNS("http://www.w3.org/2000/svg","g");Sn.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Fn=n.createNS("http://www.w3.org/2000/svg","circle");Fn.setAttributeNS(null,"fill","#000000"),Fn.setAttributeNS(null,"opacity","0.25"),Fn.setAttributeNS(null,"cx","5.5"),Fn.setAttributeNS(null,"cy","5.5"),Fn.setAttributeNS(null,"r","5.4999962");var Xn=n.createNS("http://www.w3.org/2000/svg","circle");Xn.setAttributeNS(null,"fill","#FFFFFF"),Xn.setAttributeNS(null,"cx","5.5"),Xn.setAttributeNS(null,"cy","5.5"),Xn.setAttributeNS(null,"r","5.4999962"),Sn.appendChild(Fn),Sn.appendChild(Xn),Xe.appendChild(lt),Xe.appendChild(Nr),Xe.appendChild(Or),Xe.appendChild(sn),Xe.appendChild(Sn),Se.appendChild(Xe),this._element.appendChild(Se),this._offset=e.Point.convert(ve&&ve.offset||[0,-14])}else this._element=ve.element,this._offset=e.Point.convert(ve&&ve.offset||[0,0]);this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Qn){Qn.preventDefault()}),this._element.addEventListener("mousedown",function(Qn){Qn.preventDefault()}),this._element.addEventListener("focus",function(){var Qn=de._map.getContainer();Qn.scrollTop=0,Qn.scrollLeft=0}),Cf(this._element,this._anchor,"marker"),this._popup=null}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.addTo=function(K){return this.remove(),this._map=K,K.getCanvasContainer().appendChild(this._element),K.on("move",this._update),K.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},H.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},H.prototype.getLngLat=function(){return this._lngLat},H.prototype.setLngLat=function(K){return this._lngLat=e.LngLat.convert(K),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},H.prototype.getElement=function(){return this._element},H.prototype.setPopup=function(K){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),K){if(!("offset"in K.options)){var de=38.1,Se=13.5,Ce=Math.sqrt(Math.pow(Se,2)/2);K.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-de],"bottom-left":[Ce,(de-Se+Ce)*-1],"bottom-right":[-Ce,(de-Se+Ce)*-1],left:[Se,(de-Se)*-1],right:[-Se,(de-Se)*-1]}:this._offset}this._popup=K,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},H.prototype._onKeyPress=function(K){var de=K.code,Se=K.charCode||K.keyCode;(de==="Space"||de==="Enter"||Se===32||Se===13)&&this.togglePopup()},H.prototype._onMapClick=function(K){var de=K.originalEvent.target,Se=this._element;this._popup&&(de===Se||Se.contains(de))&&this.togglePopup()},H.prototype.getPopup=function(){return this._popup},H.prototype.togglePopup=function(){var K=this._popup;if(K)K.isOpen()?K.remove():K.addTo(this._map);else return this;return this},H.prototype._update=function(K){if(!!this._map){this._map.transform.renderWorldCopies&&(this._lngLat=bu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var de="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?de="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(de="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var Se="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?Se="rotateX(0deg)":this._pitchAlignment==="map"&&(Se="rotateX("+this._map.getPitch()+"deg)"),(!K||K.type==="moveend")&&(this._pos=this._pos.round()),n.setTransform(this._element,gf[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+Se+" "+de)}},H.prototype.getOffset=function(){return this._offset},H.prototype.setOffset=function(K){return this._offset=e.Point.convert(K),this._update(),this},H.prototype._onMove=function(K){this._pos=K.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},H.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},H.prototype._addDragHandler=function(K){this._element.contains(K.originalEvent.target)&&(K.preventDefault(),this._positionDelta=K.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},H.prototype.setDraggable=function(K){return this._draggable=!!K,this._map&&(K?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},H.prototype.isDraggable=function(){return this._draggable},H.prototype.setRotation=function(K){return this._rotation=K||0,this._update(),this},H.prototype.getRotation=function(){return this._rotation},H.prototype.setRotationAlignment=function(K){return this._rotationAlignment=K||"auto",this._update(),this},H.prototype.getRotationAlignment=function(){return this._rotationAlignment},H.prototype.setPitchAlignment=function(K){return this._pitchAlignment=K&&K!=="auto"?K:this._rotationAlignment,this._update(),this},H.prototype.getPitchAlignment=function(){return this._pitchAlignment},H}(e.Evented),tc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Nu;function yf(ce){Nu!==void 0?ce(Nu):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(H){Nu=H.state!=="denied",ce(Nu)}):(Nu=!!e.window.navigator.geolocation,ce(Nu))}var rf=0,Uu=!1,rc=function(ce){function H(ve){ce.call(this),this.options=e.extend({},tc,ve),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.onAdd=function(K){return this._map=K,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),yf(this._setupUI),this._container},H.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,rf=0,Uu=!1},H.prototype._isOutOfMapMaxBounds=function(K){var de=this._map.getMaxBounds(),Se=K.coords;return de&&(Se.longitude<de.getWest()||Se.longitude>de.getEast()||Se.latitude<de.getSouth()||Se.latitude>de.getNorth())},H.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break}},H.prototype._onSuccess=function(K){if(!!this._map){if(this._isOutOfMapMaxBounds(K)){this._setErrorState(),this.fire(new e.Event("outofmaxbounds",K)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=K,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(K),(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera(K),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",K)),this._finish()}},H.prototype._updateCamera=function(K){var de=new e.LngLat(K.coords.longitude,K.coords.latitude),Se=K.coords.accuracy,Ce=this._map.getBearing(),Xe=e.extend({bearing:Ce},this.options.fitBoundsOptions);this._map.fitBounds(de.toBounds(Se),Xe,{geolocateSource:!0})},H.prototype._updateMarker=function(K){if(K){var de=new e.LngLat(K.coords.longitude,K.coords.latitude);this._accuracyCircleMarker.setLngLat(de).addTo(this._map),this._userLocationDotMarker.setLngLat(de).addTo(this._map),this._accuracy=K.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},H.prototype._updateCircleRadius=function(){var K=this._map._container.clientHeight/2,de=this._map.unproject([0,K]),Se=this._map.unproject([1,K]),Ce=de.distanceTo(Se),Xe=Math.ceil(2*this._accuracy/Ce);this._circleElement.style.width=Xe+"px",this._circleElement.style.height=Xe+"px"},H.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},H.prototype._onError=function(K){if(!!this._map){if(this.options.trackUserLocation)if(K.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var de=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=de,this._geolocateButton.setAttribute("aria-label",de),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(K.code===3&&Uu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",K)),this._finish()}},H.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},H.prototype._setupUI=function(K){var de=this;if(this._container.addEventListener("contextmenu",function(Xe){return Xe.preventDefault()}),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",K===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var Se=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=Se,this._geolocateButton.setAttribute("aria-label",Se)}else{var Ce=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=Ce,this._geolocateButton.setAttribute("aria-label",Ce)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new tf(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new tf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(Xe){var lt=Xe.originalEvent&&Xe.originalEvent.type==="resize";!Xe.geolocateSource&&de._watchState==="ACTIVE_LOCK"&&!lt&&(de._watchState="BACKGROUND",de._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),de._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),de.fire(new e.Event("trackuserlocationend")))})},H.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":rf--,Uu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"));break}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");break}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),rf++;var K;rf>1?(K={maximumAge:6e5,timeout:0},Uu=!0):(K=this.options.positionOptions,Uu=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,K)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},H.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},H}(e.Evented),Mc={maxWidth:100,unit:"metric"},Vu=function(H){this.options=e.extend({},Mc,H),e.bindAll(["_onMove","setUnit"],this)};Vu.prototype.getDefaultPosition=function(){return"bottom-left"},Vu.prototype._onMove=function(){nc(this._map,this._container,this.options)},Vu.prototype.onAdd=function(H){return this._map=H,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",H.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Vu.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Vu.prototype.setUnit=function(H){this.options.unit=H,nc(this._map,this._container,this.options)};function nc(ce,H,ve){var K=ve&&ve.maxWidth||100,de=ce._container.clientHeight/2,Se=ce.unproject([0,de]),Ce=ce.unproject([K,de]),Xe=Se.distanceTo(Ce);if(ve&&ve.unit==="imperial"){var lt=3.2808*Xe;if(lt>5280){var wt=lt/5280;nf(H,K,wt,ce._getUIString("ScaleControl.Miles"))}else nf(H,K,lt,ce._getUIString("ScaleControl.Feet"))}else if(ve&&ve.unit==="nautical"){var Ht=Xe/1852;nf(H,K,Ht,ce._getUIString("ScaleControl.NauticalMiles"))}else Xe>=1e3?nf(H,K,Xe/1e3,ce._getUIString("ScaleControl.Kilometers")):nf(H,K,Xe,ce._getUIString("ScaleControl.Meters"))}function nf(ce,H,ve,K){var de=kc(ve),Se=de/ve;ce.style.width=H*Se+"px",ce.innerHTML=de+"&nbsp;"+K}function Sc(ce){var H=Math.pow(10,Math.ceil(-Math.log(ce)/Math.LN10));return Math.round(ce*H)/H}function kc(ce){var H=Math.pow(10,(""+Math.floor(ce)).length-1),ve=ce/H;return ve=ve>=10?10:ve>=5?5:ve>=3?3:ve>=2?2:ve>=1?1:Sc(ve),H*ve}var Vl=function(H){this._fullscreen=!1,H&&H.container&&(H.container instanceof e.window.HTMLElement?this._container=H.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};Vl.prototype.onAdd=function(H){return this._map=H,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Vl.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Vl.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},Vl.prototype._setupUI=function(){var H=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",H).setAttribute("aria-hidden",!0),H.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Vl.prototype._updateTitle=function(){var H=this._getTitle();this._fullscreenButton.setAttribute("aria-label",H),this._fullscreenButton.title=H},Vl.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Vl.prototype._isFullscreen=function(){return this._fullscreen},Vl.prototype._changeIcon=function(){var H=e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement;H===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Vl.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Ec={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Cc=function(ce){function H(ve){ce.call(this),this.options=e.extend(Object.create(Ec),ve),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return ce&&(H.__proto__=ce),H.prototype=Object.create(ce&&ce.prototype),H.prototype.constructor=H,H.prototype.addTo=function(K){return this._map&&this.remove(),this._map=K,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},H.prototype.isOpen=function(){return!!this._map},H.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},H.prototype.getLngLat=function(){return this._lngLat},H.prototype.setLngLat=function(K){return this._lngLat=e.LngLat.convert(K),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},H.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},H.prototype.getElement=function(){return this._container},H.prototype.setText=function(K){return this.setDOMContent(e.window.document.createTextNode(K))},H.prototype.setHTML=function(K){var de=e.window.document.createDocumentFragment(),Se=e.window.document.createElement("body"),Ce;for(Se.innerHTML=K;Ce=Se.firstChild,!!Ce;)de.appendChild(Ce);return this.setDOMContent(de)},H.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},H.prototype.setMaxWidth=function(K){return this.options.maxWidth=K,this._update(),this},H.prototype.setDOMContent=function(K){return this._createContent(),this._content.appendChild(K),this._update(),this},H.prototype.addClassName=function(K){this._container&&this._container.classList.add(K)},H.prototype.removeClassName=function(K){this._container&&this._container.classList.remove(K)},H.prototype.toggleClassName=function(K){if(this._container)return this._container.classList.toggle(K)},H.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},H.prototype._onMouseUp=function(K){this._update(K.point)},H.prototype._onMouseMove=function(K){this._update(K.point)},H.prototype._onDrag=function(K){this._update(K.point)},H.prototype._update=function(K){var de=this,Se=this._lngLat||this._trackPointer;if(!(!this._map||!Se||!this._content)&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Ar){return de._container.classList.add(Ar)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=bu(this._lngLat,this._pos,this._map.transform)),!(this._trackPointer&&!K))){var Ce=this._pos=this._trackPointer&&K?K:this._map.project(this._lngLat),Xe=this.options.anchor,lt=ac(this.options.offset);if(!Xe){var wt=this._container.offsetWidth,Ht=this._container.offsetHeight,nr;Ce.y+lt.bottom.y<Ht?nr=["top"]:Ce.y>this._map.transform.height-Ht?nr=["bottom"]:nr=[],Ce.x<wt/2?nr.push("left"):Ce.x>this._map.transform.width-wt/2&&nr.push("right"),nr.length===0?Xe="bottom":Xe=nr.join("-")}var sr=Ce.add(lt[Xe]).round();n.setTransform(this._container,gf[Xe]+" translate("+sr.x+"px,"+sr.y+"px)"),Cf(this._container,Xe,"popup")}},H.prototype._onClose=function(){this.remove()},H}(e.Evented);function ac(ce){if(ce)if(typeof ce=="number"){var H=Math.round(Math.sqrt(.5*Math.pow(ce,2)));return{center:new e.Point(0,0),top:new e.Point(0,ce),"top-left":new e.Point(H,H),"top-right":new e.Point(-H,H),bottom:new e.Point(0,-ce),"bottom-left":new e.Point(H,-H),"bottom-right":new e.Point(-H,-H),left:new e.Point(ce,0),right:new e.Point(-ce,0)}}else if(ce instanceof e.Point||Array.isArray(ce)){var ve=e.Point.convert(ce);return{center:ve,top:ve,"top-left":ve,"top-right":ve,bottom:ve,"bottom-left":ve,"bottom-right":ve,left:ve,right:ve}}else return{center:e.Point.convert(ce.center||[0,0]),top:e.Point.convert(ce.top||[0,0]),"top-left":e.Point.convert(ce["top-left"]||[0,0]),"top-right":e.Point.convert(ce["top-right"]||[0,0]),bottom:e.Point.convert(ce.bottom||[0,0]),"bottom-left":e.Point.convert(ce["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(ce["bottom-right"]||[0,0]),left:e.Point.convert(ce.left||[0,0]),right:e.Point.convert(ce.right||[0,0])};else return ac(new e.Point(0,0))}var Lc={version:e.version,supported:a,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:ec,NavigationControl:xu,GeolocateControl:rc,AttributionControl:Ml,ScaleControl:Vu,FullscreenControl:Vl,Popup:Cc,Marker:tf,Style:Ko,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:_r,clearPrewarmedResources:an,get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(ce){e.config.ACCESS_TOKEN=ce},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(ce){e.config.API_URL=ce},get workerCount(){return Wt.workerCount},set workerCount(ce){Wt.workerCount=ce},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(ce){e.config.MAX_PARALLEL_IMAGE_REQUESTS=ce},clearStorage:function(H){e.clearTileCache(H)},workerUrl:""};return Lc}),M})},{}],240:[function(d,re,ne){re.exports=Math.log2||function(w){return Math.log(w)*Math.LOG2E}},{}],241:[function(d,re,ne){re.exports=c;var w=d("mouse-event");function c(M,T){T||(T=M,M=window);var e=0,a=0,n=0,r={shift:!1,alt:!1,control:!1,meta:!1},t=!1;function f(A){var x=!1;return"altKey"in A&&(x=x||A.altKey!==r.alt,r.alt=!!A.altKey),"shiftKey"in A&&(x=x||A.shiftKey!==r.shift,r.shift=!!A.shiftKey),"ctrlKey"in A&&(x=x||A.ctrlKey!==r.control,r.control=!!A.ctrlKey),"metaKey"in A&&(x=x||A.metaKey!==r.meta,r.meta=!!A.metaKey),x}function o(A,x){var v=w.x(x),b=w.y(x);"buttons"in x&&(A=x.buttons|0),(A!==e||v!==a||b!==n||f(x))&&(e=A|0,a=v||0,n=b||0,T&&T(e,a,n,r))}function i(A){o(0,A)}function g(){(e||a||n||r.shift||r.alt||r.meta||r.control)&&(a=n=0,e=0,r.shift=r.alt=r.control=r.meta=!1,T&&T(0,0,0,r))}function p(A){f(A)&&T&&T(e,a,n,r)}function y(A){w.buttons(A)===0?o(0,A):o(e,A)}function h(A){o(e|w.buttons(A),A)}function m(A){o(e&~w.buttons(A),A)}function u(){t||(t=!0,M.addEventListener("mousemove",y),M.addEventListener("mousedown",h),M.addEventListener("mouseup",m),M.addEventListener("mouseleave",i),M.addEventListener("mouseenter",i),M.addEventListener("mouseout",i),M.addEventListener("mouseover",i),M.addEventListener("blur",g),M.addEventListener("keyup",p),M.addEventListener("keydown",p),M.addEventListener("keypress",p),M!==window&&(window.addEventListener("blur",g),window.addEventListener("keyup",p),window.addEventListener("keydown",p),window.addEventListener("keypress",p)))}function _(){!t||(t=!1,M.removeEventListener("mousemove",y),M.removeEventListener("mousedown",h),M.removeEventListener("mouseup",m),M.removeEventListener("mouseleave",i),M.removeEventListener("mouseenter",i),M.removeEventListener("mouseout",i),M.removeEventListener("mouseover",i),M.removeEventListener("blur",g),M.removeEventListener("keyup",p),M.removeEventListener("keydown",p),M.removeEventListener("keypress",p),M!==window&&(window.removeEventListener("blur",g),window.removeEventListener("keyup",p),window.removeEventListener("keydown",p),window.removeEventListener("keypress",p)))}u();var s={element:M};return Object.defineProperties(s,{enabled:{get:function(){return t},set:function(A){A?u():_()},enumerable:!0},buttons:{get:function(){return e},enumerable:!0},x:{get:function(){return a},enumerable:!0},y:{get:function(){return n},enumerable:!0},mods:{get:function(){return r},enumerable:!0}}),s}},{"mouse-event":243}],242:[function(d,re,ne){var w={left:0,top:0};re.exports=c;function c(T,e,a){e=e||T.currentTarget||T.srcElement,Array.isArray(a)||(a=[0,0]);var n=T.clientX||0,r=T.clientY||0,t=M(e);return a[0]=n-t.left,a[1]=r-t.top,a}function M(T){return T===window||T===document||T===document.body?w:T.getBoundingClientRect()}},{}],243:[function(d,re,ne){function w(e){if(typeof e=="object"){if("buttons"in e)return e.buttons;if("which"in e){var a=e.which;if(a===2)return 4;if(a===3)return 2;if(a>0)return 1<<a-1}else if("button"in e){var a=e.button;if(a===1)return 4;if(a===2)return 2;if(a>=0)return 1<<a}}return 0}ne.buttons=w;function c(e){return e.target||e.srcElement||window}ne.element=c;function M(e){if(typeof e=="object"){if("offsetX"in e)return e.offsetX;var a=c(e),n=a.getBoundingClientRect();return e.clientX-n.left}return 0}ne.x=M;function T(e){if(typeof e=="object"){if("offsetY"in e)return e.offsetY;var a=c(e),n=a.getBoundingClientRect();return e.clientY-n.top}return 0}ne.y=T},{}],244:[function(d,re,ne){var w=d("to-px");re.exports=c;function c(M,T,e){typeof M=="function"&&(e=!!T,T=M,M=window);var a=w("ex",M),n=function(r){e&&r.preventDefault();var t=r.deltaX||0,f=r.deltaY||0,o=r.deltaZ||0,i=r.deltaMode,g=1;switch(i){case 1:g=a;break;case 2:g=window.innerHeight;break}if(t*=g,f*=g,o*=g,t||f||o)return T(t,f,o,r)};return M.addEventListener("wheel",n),n}},{"to-px":314}],245:[function(d,re,ne){(function(w,c){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(T,e,a){e[T]=e[T]||a(),typeof re!="undefined"&&re.exports&&(re.exports=e[T])})("Promise",typeof w!="undefined"?w:this,function(){var T,e,a,n=Object.prototype.toString,r=typeof c!="undefined"?function(A){return c(A)}:setTimeout;try{Object.defineProperty({},"x",{}),T=function(A,x,v,b){return Object.defineProperty(A,x,{value:v,writable:!0,configurable:b!==!1})}}catch{T=function(x,v,b){return x[v]=b,x}}a=function(){var A,x,v;function b(l,L){this.fn=l,this.self=L,this.next=void 0}return{add:function(L,S){v=new b(L,S),x?x.next=v:A=v,x=v,v=void 0},drain:function(){var L=A;for(A=x=e=void 0;L;)L.fn.call(L.self),L=L.next}}}();function t(s,A){a.add(s,A),e||(e=r(a.drain))}function f(s){var A,x=typeof s;return s!=null&&(x=="object"||x=="function")&&(A=s.then),typeof A=="function"?A:!1}function o(){for(var s=0;s<this.chain.length;s++)i(this,this.state===1?this.chain[s].success:this.chain[s].failure,this.chain[s]);this.chain.length=0}function i(s,A,x){var v,b;try{A===!1?x.reject(s.msg):(A===!0?v=s.msg:v=A.call(void 0,s.msg),v===x.promise?x.reject(TypeError("Promise-chain cycle")):(b=f(v))?b.call(v,x.resolve,x.reject):x.resolve(v))}catch(l){x.reject(l)}}function g(s){var A,x=this;if(!x.triggered){x.triggered=!0,x.def&&(x=x.def);try{(A=f(s))?t(function(){var v=new h(x);try{A.call(s,function(){g.apply(v,arguments)},function(){p.apply(v,arguments)})}catch(b){p.call(v,b)}}):(x.msg=s,x.state=1,x.chain.length>0&&t(o,x))}catch(v){p.call(new h(x),v)}}}function p(s){var A=this;A.triggered||(A.triggered=!0,A.def&&(A=A.def),A.msg=s,A.state=2,A.chain.length>0&&t(o,A))}function y(s,A,x,v){for(var b=0;b<A.length;b++)(function(L){s.resolve(A[L]).then(function(k){x(L,k)},v)})(b)}function h(s){this.def=s,this.triggered=!1}function m(s){this.promise=s,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function u(s){if(typeof s!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var A=new m(this);this.then=function(v,b){var l={success:typeof v=="function"?v:!0,failure:typeof b=="function"?b:!1};return l.promise=new this.constructor(function(S,k){if(typeof S!="function"||typeof k!="function")throw TypeError("Not a function");l.resolve=S,l.reject=k}),A.chain.push(l),A.state!==0&&t(o,A),l.promise},this.catch=function(v){return this.then(void 0,v)};try{s.call(void 0,function(v){g.call(A,v)},function(v){p.call(A,v)})}catch(x){p.call(A,x)}}var _=T({},"constructor",u,!1);return u.prototype=_,T(_,"__NPO__",0,!1),T(u,"resolve",function(A){var x=this;return A&&typeof A=="object"&&A.__NPO__===1?A:new x(function(b,l){if(typeof b!="function"||typeof l!="function")throw TypeError("Not a function");b(A)})}),T(u,"reject",function(A){return new this(function(v,b){if(typeof v!="function"||typeof b!="function")throw TypeError("Not a function");b(A)})}),T(u,"all",function(A){var x=this;return n.call(A)!="[object Array]"?x.reject(TypeError("Not an array")):A.length===0?x.resolve([]):new x(function(b,l){if(typeof b!="function"||typeof l!="function")throw TypeError("Not a function");var L=A.length,S=Array(L),k=0;y(x,A,function(z,I){S[z]=I,++k===L&&b(S)},l)})}),T(u,"race",function(A){var x=this;return n.call(A)!="[object Array]"?x.reject(TypeError("Not an array")):new x(function(b,l){if(typeof b!="function"||typeof l!="function")throw TypeError("Not a function");y(x,A,function(S,k){b(k)},l)})}),u})}).call(this)}).call(this,typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{},d("timers").setImmediate)},{timers:311}],246:[function(d,re,ne){var w=Math.PI,c=r(120);re.exports=M;function M(t){for(var f,o=[],i=0,g=0,p=0,y=0,h=null,m=null,u=0,_=0,s=0,A=t.length;s<A;s++){var x=t[s],v=x[0];switch(v){case"M":p=x[1],y=x[2];break;case"A":x=a(u,_,x[1],x[2],r(x[3]),x[4],x[5],x[6],x[7]),x.unshift("C"),x.length>7&&(o.push(x.splice(0,7)),x.unshift("C"));break;case"S":var b=u,l=_;(f=="C"||f=="S")&&(b+=b-i,l+=l-g),x=["C",b,l,x[1],x[2],x[3],x[4]];break;case"T":f=="Q"||f=="T"?(h=u*2-h,m=_*2-m):(h=u,m=_),x=e(u,_,h,m,x[1],x[2]);break;case"Q":h=x[1],m=x[2],x=e(u,_,x[1],x[2],x[3],x[4]);break;case"L":x=T(u,_,x[1],x[2]);break;case"H":x=T(u,_,x[1],_);break;case"V":x=T(u,_,u,x[1]);break;case"Z":x=T(u,_,p,y);break}f=v,u=x[x.length-2],_=x[x.length-1],x.length>4?(i=x[x.length-4],g=x[x.length-3]):(i=u,g=_),o.push(x)}return o}function T(t,f,o,i){return["C",t,f,o,i,o,i]}function e(t,f,o,i,g,p){return["C",t/3+2/3*o,f/3+2/3*i,g/3+2/3*o,p/3+2/3*i,g,p]}function a(t,f,o,i,g,p,y,h,m,u){if(u)k=u[0],P=u[1],L=u[2],S=u[3];else{var _=n(t,f,-g);t=_.x,f=_.y,_=n(h,m,-g),h=_.x,m=_.y;var s=(t-h)/2,A=(f-m)/2,x=s*s/(o*o)+A*A/(i*i);x>1&&(x=Math.sqrt(x),o=x*o,i=x*i);var v=o*o,b=i*i,l=(p==y?-1:1)*Math.sqrt(Math.abs((v*b-v*A*A-b*s*s)/(v*A*A+b*s*s)));l==1/0&&(l=1);var L=l*o*A/i+(t+h)/2,S=l*-i*s/o+(f+m)/2,k=Math.asin(((f-S)/i).toFixed(9)),P=Math.asin(((m-S)/i).toFixed(9));k=t<L?w-k:k,P=h<L?w-P:P,k<0&&(k=w*2+k),P<0&&(P=w*2+P),y&&k>P&&(k=k-w*2),!y&&P>k&&(P=P-w*2)}if(Math.abs(P-k)>c){var z=P,I=h,D=m;P=k+c*(y&&P>k?1:-1),h=L+o*Math.cos(P),m=S+i*Math.sin(P);var R=a(h,m,o,i,g,0,y,I,D,[P,z,L,S])}var B=Math.tan((P-k)/4),F=4/3*o*B,V=4/3*i*B,G=[2*t-(t+F*Math.sin(k)),2*f-(f-V*Math.cos(k)),h+F*Math.sin(P),m-V*Math.cos(P),h,m];if(u)return G;R&&(G=G.concat(R));for(var J=0;J<G.length;){var j=n(G[J],G[J+1],g);G[J++]=j.x,G[J++]=j.y}return G}function n(t,f,o){return{x:t*Math.cos(o)-f*Math.sin(o),y:t*Math.sin(o)+f*Math.cos(o)}}function r(t){return t*(w/180)}},{}],247:[function(d,re,ne){var w=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;function T(a){if(a==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}function e(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de",Object.getOwnPropertyNames(a)[0]==="5")return!1;for(var n={},r=0;r<10;r++)n["_"+String.fromCharCode(r)]=r;var t=Object.getOwnPropertyNames(n).map(function(o){return n[o]});if(t.join("")!=="0123456789")return!1;var f={};return"abcdefghijklmnopqrst".split("").forEach(function(o){f[o]=o}),Object.keys(Object.assign({},f)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}re.exports=e()?Object.assign:function(a,n){for(var r,t=T(a),f,o=1;o<arguments.length;o++){r=Object(arguments[o]);for(var i in r)c.call(r,i)&&(t[i]=r[i]);if(w){f=w(r);for(var g=0;g<f.length;g++)M.call(r,f[g])&&(t[f[g]]=r[f[g]])}}return t}},{}],248:[function(d,re,ne){function w(T,e){if(typeof T!="string")return[T];var a=[T];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var n=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],r=e.escape||"___",t=!!e.flat;n.forEach(function(i){var g=new RegExp(["\\",i[0],"[^\\",i[0],"\\",i[1],"]*\\",i[1]].join("")),p=[];function y(h,m,u){var _=a.push(h.slice(i[0].length,-i[1].length))-1;return p.push(_),r+_+r}a.forEach(function(h,m){for(var u,_=0;h!=u;)if(u=h,h=h.replace(g,y),_++>1e4)throw Error("References have circular dependency. Please, check them.");a[m]=h}),p=p.reverse(),a=a.map(function(h){return p.forEach(function(m){h=h.replace(new RegExp("(\\"+r+m+"\\"+r+")","g"),i[0]+"$1"+i[1])}),h})});var f=new RegExp("\\"+r+"([0-9]+)\\"+r);function o(i,g,p){for(var y=[],h,m=0;h=f.exec(i);){if(m++>1e4)throw Error("Circular references in parenthesis");y.push(i.slice(0,h.index)),y.push(o(g[h[1]],g)),i=i.slice(h.index+h[0].length)}return y.push(i),y}return t?a:o(a[0],a)}function c(T,e){if(e&&e.flat){var a=e&&e.escape||"___",n=T[0],r;if(!n)return"";for(var t=new RegExp("\\"+a+"([0-9]+)\\"+a),f=0;n!=r;){if(f++>1e4)throw Error("Circular references in "+T);r=n,n=n.replace(t,o)}return n}return T.reduce(function i(g,p){return Array.isArray(p)&&(p=p.reduce(i,"")),g+p},"");function o(i,g){if(T[g]==null)throw Error("Reference "+g+"is undefined");return T[g]}}function M(T,e){return Array.isArray(T)?c(T,e):w(T,e)}M.parse=w,M.stringify=c,re.exports=M},{}],249:[function(d,re,ne){var w=d("pick-by-alias");re.exports=c;function c(M){var T;return arguments.length>1&&(M=arguments),typeof M=="string"?M=M.split(/\s/).map(parseFloat):typeof M=="number"&&(M=[M]),M.length&&typeof M[0]=="number"?M.length===1?T={width:M[0],height:M[0],x:0,y:0}:M.length===2?T={width:M[0],height:M[1],x:0,y:0}:T={x:M[0],y:M[1],width:M[2]-M[0]||0,height:M[3]-M[1]||0}:M&&(M=w(M,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),T={x:M.left||0,y:M.top||0},M.width==null?M.right?T.width=M.right-T.x:T.width=0:T.width=M.width,M.height==null?M.bottom?T.height=M.bottom-T.y:T.height=0:T.height=M.height),T}},{"pick-by-alias":253}],250:[function(d,re,ne){re.exports=M;var w={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},c=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function M(a){var n=[];return a.replace(c,function(r,t,f){var o=t.toLowerCase();for(f=e(f),o=="m"&&f.length>2&&(n.push([t].concat(f.splice(0,2))),o="l",t=t=="m"?"l":"L");;){if(f.length==w[o])return f.unshift(t),n.push(f);if(f.length<w[o])throw new Error("malformed path data");n.push([t].concat(f.splice(0,w[o])))}}),n}var T=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function e(a){var n=a.match(T);return n?n.map(Number):[]}},{}],251:[function(d,re,ne){re.exports=function(c,M){M||(M=[0,""]),c=String(c);var T=parseFloat(c,10);return M[0]=T,M[1]=c.match(/[\d.\-\+]*\s*(.*)/)[1]||"",M}},{}],252:[function(d,re,ne){(function(w){(function(){(function(){var c,M,T,e,a,n;typeof performance!="undefined"&&performance!==null&&performance.now?re.exports=function(){return performance.now()}:typeof w!="undefined"&&w!==null&&w.hrtime?(re.exports=function(){return(c()-a)/1e6},M=w.hrtime,c=function(){var r;return r=M(),r[0]*1e9+r[1]},e=c(),n=w.uptime()*1e9,a=e-n):Date.now?(re.exports=function(){return Date.now()-T},T=Date.now()):(re.exports=function(){return new Date().getTime()-T},T=new Date().getTime())}).call(this)}).call(this)}).call(this,d("_process"))},{_process:277}],253:[function(d,re,ne){re.exports=function(T,e,a){var n={},r,t;if(typeof e=="string"&&(e=c(e)),Array.isArray(e)){var f={};for(t=0;t<e.length;t++)f[e[t]]=!0;e=f}for(r in e)e[r]=c(e[r]);var o={};for(r in e){var i=e[r];if(Array.isArray(i))for(t=0;t<i.length;t++){var g=i[t];if(a&&(o[g]=!0),g in T){if(n[r]=T[g],a)for(var p=t;p<i.length;p++)o[i[p]]=!0;break}}else r in T&&(e[r]&&(n[r]=T[r]),a&&(o[r]=!0))}if(a)for(r in T)o[r]||(n[r]=T[r]);return n};var w={};function c(M){return w[M]?w[M]:(typeof M=="string"&&(M=w[M]=M.split(/\s*,\s*|\s+/)),M)}},{}],254:[function(d,re,ne){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var w=d("./lib/build-log"),c=d("./lib/epsilon"),M=d("./lib/intersecter"),T=d("./lib/segment-chainer"),e=d("./lib/segment-selector"),a=d("./lib/geojson"),n=!1,r=c(),t;t={buildLog:function(o){return o===!0?n=w():o===!1&&(n=!1),n===!1?!1:n.list},epsilon:function(o){return r.epsilon(o)},segments:function(o){var i=M(!0,r,n);return o.regions.forEach(i.addRegion),{segments:i.calculate(o.inverted),inverted:o.inverted}},combine:function(o,i){var g=M(!1,r,n);return{combined:g.calculate(o.segments,o.inverted,i.segments,i.inverted),inverted1:o.inverted,inverted2:i.inverted}},selectUnion:function(o){return{segments:e.union(o.combined,n),inverted:o.inverted1||o.inverted2}},selectIntersect:function(o){return{segments:e.intersect(o.combined,n),inverted:o.inverted1&&o.inverted2}},selectDifference:function(o){return{segments:e.difference(o.combined,n),inverted:o.inverted1&&!o.inverted2}},selectDifferenceRev:function(o){return{segments:e.differenceRev(o.combined,n),inverted:!o.inverted1&&o.inverted2}},selectXor:function(o){return{segments:e.xor(o.combined,n),inverted:o.inverted1!==o.inverted2}},polygon:function(o){return{regions:T(o.segments,r,n),inverted:o.inverted}},polygonFromGeoJSON:function(o){return a.toPolygon(t,o)},polygonToGeoJSON:function(o){return a.fromPolygon(t,r,o)},union:function(o,i){return f(o,i,t.selectUnion)},intersect:function(o,i){return f(o,i,t.selectIntersect)},difference:function(o,i){return f(o,i,t.selectDifference)},differenceRev:function(o,i){return f(o,i,t.selectDifferenceRev)},xor:function(o,i){return f(o,i,t.selectXor)}};function f(o,i,g){var p=t.segments(o),y=t.segments(i),h=t.combine(p,y),m=g(h);return t.polygon(m)}typeof window=="object"&&(window.PolyBool=t),re.exports=t},{"./lib/build-log":255,"./lib/epsilon":256,"./lib/geojson":257,"./lib/intersecter":258,"./lib/segment-chainer":260,"./lib/segment-selector":261}],255:[function(d,re,ne){function w(){var c,M=0,T=!1;function e(a,n){return c.list.push({type:a,data:n?JSON.parse(JSON.stringify(n)):void 0}),c}return c={list:[],segmentId:function(){return M++},checkIntersection:function(a,n){return e("check",{seg1:a,seg2:n})},segmentChop:function(a,n){return e("div_seg",{seg:a,pt:n}),e("chop",{seg:a,pt:n})},statusRemove:function(a){return e("pop_seg",{seg:a})},segmentUpdate:function(a){return e("seg_update",{seg:a})},segmentNew:function(a,n){return e("new_seg",{seg:a,primary:n})},segmentRemove:function(a){return e("rem_seg",{seg:a})},tempStatus:function(a,n,r){return e("temp_status",{seg:a,above:n,below:r})},rewind:function(a){return e("rewind",{seg:a})},status:function(a,n,r){return e("status",{seg:a,above:n,below:r})},vert:function(a){return a===T?c:(T=a,e("vert",{x:a}))},log:function(a){return typeof a!="string"&&(a=JSON.stringify(a,!1,"  ")),e("log",{txt:a})},reset:function(){return e("reset")},selected:function(a){return e("selected",{segs:a})},chainStart:function(a){return e("chain_start",{seg:a})},chainRemoveHead:function(a,n){return e("chain_rem_head",{index:a,pt:n})},chainRemoveTail:function(a,n){return e("chain_rem_tail",{index:a,pt:n})},chainNew:function(a,n){return e("chain_new",{pt1:a,pt2:n})},chainMatch:function(a){return e("chain_match",{index:a})},chainClose:function(a){return e("chain_close",{index:a})},chainAddHead:function(a,n){return e("chain_add_head",{index:a,pt:n})},chainAddTail:function(a,n){return e("chain_add_tail",{index:a,pt:n})},chainConnect:function(a,n){return e("chain_con",{index1:a,index2:n})},chainReverse:function(a){return e("chain_rev",{index:a})},chainJoin:function(a,n){return e("chain_join",{index1:a,index2:n})},done:function(){return e("done")}},c}re.exports=w},{}],256:[function(d,re,ne){function w(c){typeof c!="number"&&(c=1e-10);var M={epsilon:function(T){return typeof T=="number"&&(c=T),c},pointAboveOrOnLine:function(T,e,a){var n=e[0],r=e[1],t=a[0],f=a[1],o=T[0],i=T[1];return(t-n)*(i-r)-(f-r)*(o-n)>=-c},pointBetween:function(T,e,a){var n=T[1]-e[1],r=a[0]-e[0],t=T[0]-e[0],f=a[1]-e[1],o=t*r+n*f;if(o<c)return!1;var i=r*r+f*f;return!(o-i>-c)},pointsSameX:function(T,e){return Math.abs(T[0]-e[0])<c},pointsSameY:function(T,e){return Math.abs(T[1]-e[1])<c},pointsSame:function(T,e){return M.pointsSameX(T,e)&&M.pointsSameY(T,e)},pointsCompare:function(T,e){return M.pointsSameX(T,e)?M.pointsSameY(T,e)?0:T[1]<e[1]?-1:1:T[0]<e[0]?-1:1},pointsCollinear:function(T,e,a){var n=T[0]-e[0],r=T[1]-e[1],t=e[0]-a[0],f=e[1]-a[1];return Math.abs(n*f-t*r)<c},linesIntersect:function(T,e,a,n){var r=e[0]-T[0],t=e[1]-T[1],f=n[0]-a[0],o=n[1]-a[1],i=r*o-t*f;if(Math.abs(i)<c)return!1;var g=T[0]-a[0],p=T[1]-a[1],y=(f*p-o*g)/i,h=(r*p-t*g)/i,m={alongA:0,alongB:0,pt:[T[0]+y*r,T[1]+y*t]};return y<=-c?m.alongA=-2:y<c?m.alongA=-1:y-1<=-c?m.alongA=0:y-1<c?m.alongA=1:m.alongA=2,h<=-c?m.alongB=-2:h<c?m.alongB=-1:h-1<=-c?m.alongB=0:h-1<c?m.alongB=1:m.alongB=2,m},pointInsideRegion:function(T,e){for(var a=T[0],n=T[1],r=e[e.length-1][0],t=e[e.length-1][1],f=!1,o=0;o<e.length;o++){var i=e[o][0],g=e[o][1];g-n>c!=t-n>c&&(r-i)*(n-g)/(t-g)+i-a>c&&(f=!f),r=i,t=g}return f}};return M}re.exports=w},{}],257:[function(d,re,ne){var w={toPolygon:function(c,M){function T(n){if(n.length<=0)return c.segments({inverted:!1,regions:[]});function r(o){var i=o.slice(0,o.length-1);return c.segments({inverted:!1,regions:[i]})}for(var t=r(n[0]),f=1;f<n.length;f++)t=c.selectDifference(c.combine(t,r(n[f])));return t}if(M.type==="Polygon")return c.polygon(T(M.coordinates));if(M.type==="MultiPolygon"){for(var e=c.segments({inverted:!1,regions:[]}),a=0;a<M.coordinates.length;a++)e=c.selectUnion(c.combine(e,T(M.coordinates[a])));return c.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(c,M,T){T=c.polygon(c.segments(T));function e(y,h){return M.pointInsideRegion([(y[0][0]+y[1][0])*.5,(y[0][1]+y[1][1])*.5],h)}function a(y){return{region:y,children:[]}}var n=a(null);function r(y,h){for(var m=0;m<y.children.length;m++){var u=y.children[m];if(e(h,u.region)){r(u,h);return}}for(var _=a(h),m=0;m<y.children.length;m++){var u=y.children[m];e(u.region,h)&&(_.children.push(u),y.children.splice(m,1),m--)}y.children.push(_)}for(var t=0;t<T.regions.length;t++){var f=T.regions[t];f.length<3||r(n,f)}function o(y,h){for(var m=0,u=y[y.length-1][0],_=y[y.length-1][1],s=[],A=0;A<y.length;A++){var x=y[A][0],v=y[A][1];s.push([x,v]),m+=v*u-x*_,u=x,_=v}var b=m<0;return b!==h&&s.reverse(),s.push([s[0][0],s[0][1]]),s}var i=[];function g(y){var h=[o(y.region,!1)];i.push(h);for(var m=0;m<y.children.length;m++)h.push(p(y.children[m]))}function p(y){for(var h=0;h<y.children.length;h++)g(y.children[h]);return o(y.region,!0)}for(var t=0;t<n.children.length;t++)g(n.children[t]);return i.length<=0?{type:"Polygon",coordinates:[]}:i.length==1?{type:"Polygon",coordinates:i[0]}:{type:"MultiPolygon",coordinates:i}}};re.exports=w},{}],258:[function(d,re,ne){var w=d("./linked-list");function c(M,T,e){function a(m,u){return{id:e?e.segmentId():-1,start:m,end:u,myFill:{above:null,below:null},otherFill:null}}function n(m,u,_){return{id:e?e.segmentId():-1,start:m,end:u,myFill:{above:_.myFill.above,below:_.myFill.below},otherFill:null}}var r=w.create();function t(m,u,_,s,A,x){var v=T.pointsCompare(u,A);return v!==0?v:T.pointsSame(_,x)?0:m!==s?m?1:-1:T.pointAboveOrOnLine(_,s?A:x,s?x:A)?1:-1}function f(m,u){r.insertBefore(m,function(_){var s=t(m.isStart,m.pt,u,_.isStart,_.pt,_.other.pt);return s<0})}function o(m,u){var _=w.node({isStart:!0,pt:m.start,seg:m,primary:u,other:null,status:null});return f(_,m.end),_}function i(m,u,_){var s=w.node({isStart:!1,pt:u.end,seg:u,primary:_,other:m,status:null});m.other=s,f(s,m.pt)}function g(m,u){var _=o(m,u);return i(_,m,u),_}function p(m,u){e&&e.segmentChop(m.seg,u),m.other.remove(),m.seg.end=u,m.other.pt=u,f(m.other,m.pt)}function y(m,u){var _=n(u,m.seg.end,m.seg);return p(m,u),g(_,m.primary)}function h(m,u){var _=w.create();function s(R,B){var F=R.seg.start,V=R.seg.end,G=B.seg.start,J=B.seg.end;return T.pointsCollinear(F,G,J)?T.pointsCollinear(V,G,J)||T.pointAboveOrOnLine(V,G,J)?1:-1:T.pointAboveOrOnLine(F,G,J)?1:-1}function A(R){return _.findTransition(function(B){var F=s(R,B.ev);return F>0})}function x(R,B){var F=R.seg,V=B.seg,G=F.start,J=F.end,j=V.start,Y=V.end;e&&e.checkIntersection(F,V);var X=T.linesIntersect(G,J,j,Y);if(X===!1){if(!T.pointsCollinear(G,J,j)||T.pointsSame(G,Y)||T.pointsSame(J,j))return!1;var oe=T.pointsSame(G,j),se=T.pointsSame(J,Y);if(oe&&se)return B;var ie=!oe&&T.pointBetween(G,j,Y),N=!se&&T.pointBetween(J,j,Y);if(oe)return N?y(B,J):y(R,Y),B;ie&&(se||(N?y(B,J):y(R,Y)),y(B,G))}else X.alongA===0&&(X.alongB===-1?y(R,j):X.alongB===0?y(R,X.pt):X.alongB===1&&y(R,Y)),X.alongB===0&&(X.alongA===-1?y(B,G):X.alongA===0?y(B,X.pt):X.alongA===1&&y(B,J));return!1}for(var v=[];!r.isEmpty();){var b=r.getHead();if(e&&e.vert(b.pt[0]),b.isStart){let R=function(){if(L){var B=x(b,L);if(B)return B}return S?x(b,S):!1};e&&e.segmentNew(b.seg,b.primary);var l=A(b),L=l.before?l.before.ev:null,S=l.after?l.after.ev:null;e&&e.tempStatus(b.seg,L?L.seg:!1,S?S.seg:!1);var k=R();if(k){if(M){var P;b.seg.myFill.below===null?P=!0:P=b.seg.myFill.above!==b.seg.myFill.below,P&&(k.seg.myFill.above=!k.seg.myFill.above)}else k.seg.otherFill=b.seg.myFill;e&&e.segmentUpdate(k.seg),b.other.remove(),b.remove()}if(r.getHead()!==b){e&&e.rewind(b.seg);continue}if(M){var P;b.seg.myFill.below===null?P=!0:P=b.seg.myFill.above!==b.seg.myFill.below,S?b.seg.myFill.below=S.seg.myFill.above:b.seg.myFill.below=m,P?b.seg.myFill.above=!b.seg.myFill.below:b.seg.myFill.above=b.seg.myFill.below}else if(b.seg.otherFill===null){var z;S?b.primary===S.primary?z=S.seg.otherFill.above:z=S.seg.myFill.above:z=b.primary?u:m,b.seg.otherFill={above:z,below:z}}e&&e.status(b.seg,L?L.seg:!1,S?S.seg:!1),b.other.status=l.insert(w.node({ev:b}))}else{var I=b.status;if(I===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(_.exists(I.prev)&&_.exists(I.next)&&x(I.prev.ev,I.next.ev),e&&e.statusRemove(I.ev.seg),I.remove(),!b.primary){var D=b.seg.myFill;b.seg.myFill=b.seg.otherFill,b.seg.otherFill=D}v.push(b.seg)}r.getHead().remove()}return e&&e.done(),v}return M?{addRegion:function(m){for(var u,_=m[m.length-1],s=0;s<m.length;s++){u=_,_=m[s];var A=T.pointsCompare(u,_);A!==0&&g(a(A<0?u:_,A<0?_:u),!0)}},calculate:function(m){return h(m,!1)}}:{calculate:function(m,u,_,s){return m.forEach(function(A){g(n(A.start,A.end,A),!0)}),_.forEach(function(A){g(n(A.start,A.end,A),!1)}),h(u,s)}}}re.exports=c},{"./linked-list":259}],259:[function(d,re,ne){var w={create:function(){var c={root:{root:!0,next:null},exists:function(M){return!(M===null||M===c.root)},isEmpty:function(){return c.root.next===null},getHead:function(){return c.root.next},insertBefore:function(M,T){for(var e=c.root,a=c.root.next;a!==null;){if(T(a)){M.prev=a.prev,M.next=a,a.prev.next=M,a.prev=M;return}e=a,a=a.next}e.next=M,M.prev=e,M.next=null},findTransition:function(M){for(var T=c.root,e=c.root.next;e!==null&&!M(e);)T=e,e=e.next;return{before:T===c.root?null:T,after:e,insert:function(a){return a.prev=T,a.next=e,T.next=a,e!==null&&(e.prev=a),a}}}};return c},node:function(c){return c.prev=null,c.next=null,c.remove=function(){c.prev.next=c.next,c.next&&(c.next.prev=c.prev),c.prev=null,c.next=null},c}};re.exports=w},{}],260:[function(d,re,ne){function w(c,M,T){var e=[],a=[];return c.forEach(function(n){var r=n.start,t=n.end;if(M.pointsSame(r,t)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");return}T&&T.chainStart(n);var f={index:0,matches_head:!1,matches_pt1:!1},o={index:0,matches_head:!1,matches_pt1:!1},i=f;function g(z,I,D){return i.index=z,i.matches_head=I,i.matches_pt1=D,i===f?(i=o,!1):(i=null,!0)}for(var p=0;p<e.length;p++){var y=e[p],h=y[0];y[1];var m=y[y.length-1];if(y[y.length-2],M.pointsSame(h,r)){if(g(p,!0,!0))break}else if(M.pointsSame(h,t)){if(g(p,!0,!1))break}else if(M.pointsSame(m,r)){if(g(p,!1,!0))break}else if(M.pointsSame(m,t)&&g(p,!1,!1))break}if(i===f){e.push([r,t]),T&&T.chainNew(r,t);return}if(i===o){T&&T.chainMatch(f.index);var u=f.index,_=f.matches_pt1?t:r,s=f.matches_head,y=e[u],A=s?y[0]:y[y.length-1],x=s?y[1]:y[y.length-2],v=s?y[y.length-1]:y[0],b=s?y[y.length-2]:y[1];if(M.pointsCollinear(x,A,_)&&(s?(T&&T.chainRemoveHead(f.index,_),y.shift()):(T&&T.chainRemoveTail(f.index,_),y.pop()),A=x),M.pointsSame(v,_)){e.splice(u,1),M.pointsCollinear(b,v,A)&&(s?(T&&T.chainRemoveTail(f.index,A),y.pop()):(T&&T.chainRemoveHead(f.index,A),y.shift())),T&&T.chainClose(f.index),a.push(y);return}s?(T&&T.chainAddHead(f.index,_),y.unshift(_)):(T&&T.chainAddTail(f.index,_),y.push(_));return}function l(z){T&&T.chainReverse(z),e[z].reverse()}function L(z,I){var D=e[z],R=e[I],B=D[D.length-1],F=D[D.length-2],V=R[0],G=R[1];M.pointsCollinear(F,B,V)&&(T&&T.chainRemoveTail(z,B),D.pop(),B=F),M.pointsCollinear(B,V,G)&&(T&&T.chainRemoveHead(I,V),R.shift()),T&&T.chainJoin(z,I),e[z]=D.concat(R),e.splice(I,1)}var S=f.index,k=o.index;T&&T.chainConnect(S,k);var P=e[S].length<e[k].length;f.matches_head?o.matches_head?P?(l(S),L(S,k)):(l(k),L(k,S)):L(k,S):o.matches_head?L(S,k):P?(l(S),L(k,S)):(l(k),L(S,k))}),a}re.exports=w},{}],261:[function(d,re,ne){function w(M,T,e){var a=[];return M.forEach(function(n){var r=(n.myFill.above?8:0)+(n.myFill.below?4:0)+(n.otherFill&&n.otherFill.above?2:0)+(n.otherFill&&n.otherFill.below?1:0);T[r]!==0&&a.push({id:e?e.segmentId():-1,start:n.start,end:n.end,myFill:{above:T[r]===1,below:T[r]===2},otherFill:null})}),e&&e.selected(a),a}var c={union:function(M,T){return w(M,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],T)},intersect:function(M,T){return w(M,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],T)},difference:function(M,T){return w(M,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],T)},differenceRev:function(M,T){return w(M,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],T)},xor:function(M,T){return w(M,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],T)}};re.exports=c},{}],262:[function(d,re,ne){var w=d("stream").Transform,c=d("stream-parser");function M(){w.call(this,{readableObjectMode:!0})}M.prototype=Object.create(w.prototype),M.prototype.constructor=M,c(M.prototype),ne.ParserStream=M,ne.sliceEq=function(e,a,n){for(var r=a,t=0;t<n.length;)if(e[r++]!==n[t++])return!1;return!0},ne.str2arr=function(e,a){var n=[],r=0;if(a&&a==="hex")for(;r<e.length;)n.push(parseInt(e.slice(r,r+2),16)),r+=2;else for(;r<e.length;r++)n.push(e.charCodeAt(r)&255);return n},ne.readUInt16LE=function(e,a){return e[a]|e[a+1]<<8},ne.readUInt16BE=function(e,a){return e[a+1]|e[a]<<8},ne.readUInt32LE=function(e,a){return e[a]|e[a+1]<<8|e[a+2]<<16|e[a+3]*16777216},ne.readUInt32BE=function(e,a){return e[a+3]|e[a+2]<<8|e[a+1]<<16|e[a]*16777216};function T(e,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||"",this.name=this.constructor.name,this.message=e,a&&(this.code=a),n&&(this.statusCode=n)}T.prototype=Object.create(Error.prototype),T.prototype.constructor=T,ne.ProbeError=T},{stream:285,"stream-parser":301}],263:[function(d,re,ne){function w(T,e){var a=new Error(T);return a.code=e,a}function c(T){try{return decodeURIComponent(escape(T))}catch{return T}}function M(T,e,a){this.input=T.subarray(e,a),this.start=e;var n=String.fromCharCode.apply(null,this.input.subarray(0,4));if(n!=="II*\0"&&n!=="MM\0*")throw w("invalid TIFF signature","EBADDATA");this.big_endian=n[0]==="M"}M.prototype.each=function(T){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var a=this.ifds_to_read.shift();!a.offset||this.scan_ifd(a.id,a.offset,T)}},M.prototype.read_uint16=function(T){var e=this.input;if(T+2>e.length)throw w("unexpected EOF","EBADDATA");return this.big_endian?e[T]*256+e[T+1]:e[T]+e[T+1]*256},M.prototype.read_uint32=function(T){var e=this.input;if(T+4>e.length)throw w("unexpected EOF","EBADDATA");return this.big_endian?e[T]*16777216+e[T+1]*65536+e[T+2]*256+e[T+3]:e[T]+e[T+1]*256+e[T+2]*65536+e[T+3]*16777216},M.prototype.is_subifd_link=function(T,e){return T===0&&e===34665||T===0&&e===34853||T===34665&&e===40965},M.prototype.exif_format_length=function(T){switch(T){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},M.prototype.exif_format_read=function(T,e){var a;switch(T){case 1:case 2:return a=this.input[e],a;case 6:return a=this.input[e],a|(a&128)*33554430;case 3:return a=this.read_uint16(e),a;case 8:return a=this.read_uint16(e),a|(a&32768)*131070;case 4:return a=this.read_uint32(e),a;case 9:return a=this.read_uint32(e),a|0;case 5:case 10:case 11:case 12:return null;case 7:return null;default:return null}},M.prototype.scan_ifd=function(T,e,a){var n=this.read_uint16(e);e+=2;for(var r=0;r<n;r++){var t=this.read_uint16(e),f=this.read_uint16(e+2),o=this.read_uint32(e+4),i=this.exif_format_length(f),g=o*i,p=g<=4?e+8:this.read_uint32(e+8),y=!1;if(p+g>this.input.length)throw w("unexpected EOF","EBADDATA");for(var h=[],m=p,u=0;u<o;u++,m+=i){var _=this.exif_format_read(f,m);if(_===null){h=null;break}h.push(_)}Array.isArray(h)&&f===2&&(h=c(String.fromCharCode.apply(null,h)),h&&h[h.length-1]==="\0"&&(h=h.slice(0,-1))),this.is_subifd_link(T,t)&&Array.isArray(h)&&Number.isInteger(h[0])&&h[0]>0&&(this.ifds_to_read.push({id:t,offset:h[0]}),y=!0);var s={is_big_endian:this.big_endian,ifd:T,tag:t,format:f,count:o,entry_offset:e+this.start,data_length:g,data_offset:p+this.start,value:h,is_subifd_link:y};if(a(s)===!1){this.aborted=!0;return}e+=12}T===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},re.exports.ExifParser=M,re.exports.get_orientation=function(T){var e=0;try{return new M(T,0,T.length).each(function(a){if(a.ifd===0&&a.tag===274&&Array.isArray(a.value))return e=a.value[0],!1}),e}catch{return-1}}},{}],264:[function(d,re,ne){var w=d("./common").readUInt16BE,c=d("./common").readUInt32BE;function M(o,i){if(o.length<4+i)return null;var g=c(o,i);return o.length<g+i||g<8?null:{boxtype:String.fromCharCode.apply(null,o.slice(i+4,i+8)),data:o.slice(i+8,i+g),end:i+g}}re.exports.unbox=M;function T(o,i){for(var g=0;;){var p=M(o,g);if(!p)break;switch(p.boxtype){case"ispe":i.sizes.push({width:c(p.data,4),height:c(p.data,8)});break;case"irot":i.transforms.push({type:"irot",value:p.data[0]&3});break;case"imir":i.transforms.push({type:"imir",value:p.data[0]&1});break}g=p.end}}function e(o,i,g){for(var p=0,y=0;y<g;y++)p=p*256+(o[i+y]||0);return p}function a(o,i){for(var g=o[4]>>4&15,p=o[4]&15,y=o[5]>>4&15,h=w(o,6),m=8,u=0;u<h;u++){var _=w(o,m);m+=2;var s=w(o,m);m+=2;var A=e(o,m,y);m+=y;var x=w(o,m);if(m+=2,s===0&&x===1){var v=e(o,m,g),b=e(o,m+g,p);i.item_loc[_]={length:b,offset:v+A}}m+=x*(g+p)}}function n(o,i){for(var g=w(o,4),p=6,y=0;y<g;y++){var h=M(o,p);if(!h)break;if(h.boxtype==="infe"){for(var m=w(h.data,4),u="",_=8;_<h.data.length&&h.data[_];_++)u+=String.fromCharCode(h.data[_]);i.item_inf[u]=m}p=h.end}}function r(o,i){for(var g=0;;){var p=M(o,g);if(!p)break;p.boxtype==="ipco"&&T(p.data,i),g=p.end}}function t(o,i){for(var g=4;;){var p=M(o,g);if(!p)break;p.boxtype==="iprp"&&r(p.data,i),p.boxtype==="iloc"&&a(p.data,i),p.boxtype==="iinf"&&n(p.data,i),g=p.end}}function f(o){var i=o.reduce(function(y,h){return y.width>h.width||y.width===h.width&&y.height>h.height?y:h}),g=o.reduce(function(y,h){return y.height>h.height||y.height===h.height&&y.width>h.width?y:h}),p;return i.width>g.height||i.width===g.height&&i.height>g.width?p=i:p=g,p}re.exports.readSizeFromMeta=function(o){var i={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(t(o,i),!!i.sizes.length){var g=f(i.sizes),p=1;i.transforms.forEach(function(h){var m={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},u={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(h.type==="imir"&&(h.value===0?p=u[p]:(p=u[p],p=m[p],p=m[p])),h.type==="irot")for(var _=0;_<h.value;_++)p=m[p]});var y=null;return i.item_inf.Exif&&(y=i.item_loc[i.item_inf.Exif]),{width:g.width,height:g.height,orientation:i.transforms.length?p:null,variants:i.sizes,exif_location:y}}},re.exports.getMimeType=function(o){var i=String.fromCharCode.apply(null,o.slice(0,4)),g={};g[i]=!0;for(var p=8;p<o.length;p+=4)g[String.fromCharCode.apply(null,o.slice(p,p+4))]=!0;if(!(!g.mif1&&!g.msf1&&!g.miaf))return i==="avif"||i==="avis"||i==="avio"?{type:"avif",mime:"image/avif"}:i==="heic"||i==="heix"?{type:"heic",mime:"image/heic"}:i==="hevc"||i==="hevx"?{type:"heic",mime:"image/heic-sequence"}:g.avif||g.avis?{type:"avif",mime:"image/avif"}:g.heic||g.heix||g.hevc||g.hevx||g.heis?g.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":262}],265:[function(d,re,ne){var w=d("../common").str2arr,c=d("../common").sliceEq,M=d("../common").readUInt32BE,T=d("../miaf_utils"),e=d("../exif_utils"),a=w("ftyp");re.exports=function(n){if(!!c(n,4,a)){var r=T.unbox(n,0);if(!!r){var t=T.getMimeType(r.data);if(!!t){for(var f,o=r.end;;){var i=T.unbox(n,o);if(!i)break;if(o=i.end,i.boxtype==="mdat")return;if(i.boxtype==="meta"){f=i.data;break}}if(!!f){var g=T.readSizeFromMeta(f);if(!!g){var p={width:g.width,height:g.height,type:t.type,mime:t.mime,wUnits:"px",hUnits:"px"};if(g.variants.length>1&&(p.variants=g.variants),g.orientation&&(p.orientation=g.orientation),g.exif_location&&g.exif_location.offset+g.exif_location.length<=n.length){var y=M(n,g.exif_location.offset),h=n.slice(g.exif_location.offset+y+4,g.exif_location.offset+g.exif_location.length),m=e.get_orientation(h);m>0&&(p.orientation=m)}return p}}}}}}},{"../common":262,"../exif_utils":263,"../miaf_utils":264}],266:[function(d,re,ne){var w=d("../common").str2arr,c=d("../common").sliceEq,M=d("../common").readUInt16LE,T=w("BM");re.exports=function(e){if(!(e.length<26)&&!!c(e,0,T))return{width:M(e,18),height:M(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":262}],267:[function(d,re,ne){var w=d("../common").str2arr,c=d("../common").sliceEq,M=d("../common").readUInt16LE,T=w("GIF87a"),e=w("GIF89a");re.exports=function(a){if(!(a.length<10)&&!(!c(a,0,T)&&!c(a,0,e)))return{width:M(a,6),height:M(a,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":262}],268:[function(d,re,ne){var w=d("../common").readUInt16LE,c=0,M=1,T=16;re.exports=function(e){var a=w(e,0),n=w(e,2),r=w(e,4);if(!(a!==c||n!==M||!r)){for(var t=[],f={width:0,height:0},o=0;o<r;o++){var i=e[6+T*o]||256,g=e[6+T*o+1]||256,p={width:i,height:g};t.push(p),(i>f.width||g>f.height)&&(f=p)}return{width:f.width,height:f.height,variants:t,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":262}],269:[function(d,re,ne){var w=d("../common").readUInt16BE,c=d("../common").str2arr,M=d("../common").sliceEq,T=d("../exif_utils"),e=c("Exif\0\0");re.exports=function(a){if(!(a.length<2)&&!(a[0]!==255||a[1]!==216||a[2]!==255))for(var n=2;;){for(;;){if(a.length-n<2)return;if(a[n++]===255)break}for(var r=a[n++],t;r===255;)r=a[n++];if(208<=r&&r<=217||r===1)t=0;else if(192<=r&&r<=254){if(a.length-n<2)return;t=w(a,n)-2,n+=2}else return;if(r===217||r===218)return;var f;if(r===225&&t>=10&&M(a,n,e)&&(f=T.get_orientation(a.slice(n+6,n+t))),t>=5&&192<=r&&r<=207&&r!==196&&r!==200&&r!==204){if(a.length-n<t)return;var o={width:w(a,n+3),height:w(a,n+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return f>0&&(o.orientation=f),o}n+=t}}},{"../common":262,"../exif_utils":263}],270:[function(d,re,ne){var w=d("../common").str2arr,c=d("../common").sliceEq,M=d("../common").readUInt32BE,T=w(`\x89PNG\r

`),e=w("IHDR");re.exports=function(a){if(!(a.length<24)&&!!c(a,0,T)&&!!c(a,12,e))return{width:M(a,16),height:M(a,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":262}],271:[function(d,re,ne){var w=d("../common").str2arr,c=d("../common").sliceEq,M=d("../common").readUInt32BE,T=w("8BPS\0");re.exports=function(e){if(!(e.length<6+16)&&!!c(e,0,T))return{width:M(e,6+12),height:M(e,6+8),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":262}],272:[function(d,re,ne){function w(i){return i===32||i===9||i===13||i===10}function c(i){return typeof i=="number"&&isFinite(i)&&i>0}function M(i){var g=0,p=i.length;for(i[0]===239&&i[1]===187&&i[2]===191&&(g=3);g<p&&w(i[g]);)g++;return g===p?!1:i[g]===60}var T=/<[-_.:a-zA-Z0-9][^>]*>/,e=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,a=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,n=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,r=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,t=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function f(i){var g=i.match(a),p=i.match(n),y=i.match(r);return{width:g&&(g[1]||g[2]),height:p&&(p[1]||p[2]),viewbox:y&&(y[1]||y[2])}}function o(i){return t.test(i)?i.match(t)[0]:"px"}re.exports=function(i){if(!!M(i)){for(var g="",p=0;p<i.length;p++)g+=String.fromCharCode(i[p]);var y=(g.match(T)||[""])[0];if(!!e.test(y)){var h=f(y),m=parseFloat(h.width),u=parseFloat(h.height);if(h.width&&h.height)return!c(m)||!c(u)?void 0:{width:m,height:u,type:"svg",mime:"image/svg+xml",wUnits:o(h.width),hUnits:o(h.height)};var _=(h.viewbox||"").split(" "),s={width:_[2],height:_[3]},A=parseFloat(s.width),x=parseFloat(s.height);if(!(!c(A)||!c(x))&&o(s.width)===o(s.height)){var v=A/x;return h.width?c(m)?{width:m,height:m/v,type:"svg",mime:"image/svg+xml",wUnits:o(h.width),hUnits:o(h.width)}:void 0:h.height?c(u)?{width:u*v,height:u,type:"svg",mime:"image/svg+xml",wUnits:o(h.height),hUnits:o(h.height)}:void 0:{width:A,height:x,type:"svg",mime:"image/svg+xml",wUnits:o(s.width),hUnits:o(s.height)}}}}}},{}],273:[function(d,re,ne){var w=d("../common").str2arr,c=d("../common").sliceEq,M=d("../common").readUInt16LE,T=d("../common").readUInt16BE,e=d("../common").readUInt32LE,a=d("../common").readUInt32BE,n=w("II*\0"),r=w("MM\0*");function t(i,g,p){return p?T(i,g):M(i,g)}function f(i,g,p){return p?a(i,g):e(i,g)}function o(i,g,p){var y=t(i,g+2,p),h=f(i,g+4,p);return h!==1||y!==3&&y!==4?null:y===3?t(i,g+8,p):f(i,g+8,p)}re.exports=function(i){if(!(i.length<8)&&!(!c(i,0,n)&&!c(i,0,r))){var g=i[0]===77,p=f(i,4,g)-8;if(!(p<0)){var y=p+8;if(!(i.length-y<2)){var h=t(i,y+0,g)*12;if(!(h<=0)&&(y+=2,!(i.length-y<h))){var m,u,_,s;for(m=0;m<h;m+=12)s=t(i,y+m,g),s===256?u=o(i,y+m,g):s===257&&(_=o(i,y+m,g));if(u&&_)return{width:u,height:_,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}}}}}}},{"../common":262}],274:[function(d,re,ne){var w=d("../common").str2arr,c=d("../common").sliceEq,M=d("../common").readUInt16LE,T=d("../common").readUInt32LE,e=d("../exif_utils"),a=w("RIFF"),n=w("WEBP");function r(o,i){if(!(o[i+3]!==157||o[i+4]!==1||o[i+5]!==42))return{width:M(o,i+6)&16383,height:M(o,i+8)&16383,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function t(o,i){if(o[i]===47){var g=T(o,i+1);return{width:(g&16383)+1,height:(g>>14&16383)+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function f(o,i){return{width:(o[i+6]<<16|o[i+5]<<8|o[i+4])+1,height:(o[i+9]<<i|o[i+8]<<8|o[i+7])+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}re.exports=function(o){if(!(o.length<16)&&!(!c(o,0,a)&&!c(o,8,n))){var i=12,g=null,p=0,y=T(o,4)+8;if(!(y>o.length)){for(;i+8<y;){if(o[i]===0){i++;continue}var h=String.fromCharCode.apply(null,o.slice(i,i+4)),m=T(o,i+4);h==="VP8 "&&m>=10?g=g||r(o,i+8):h==="VP8L"&&m>=9?g=g||t(o,i+8):h==="VP8X"&&m>=10?g=g||f(o,i+8):h==="EXIF"&&(p=e.get_orientation(o.slice(i+8,i+8+m)),i=1/0),i+=8+m}if(!!g)return p>0&&(g.orientation=p),g}}}},{"../common":262,"../exif_utils":263}],275:[function(d,re,ne){re.exports={avif:d("./parse_sync/avif"),bmp:d("./parse_sync/bmp"),gif:d("./parse_sync/gif"),ico:d("./parse_sync/ico"),jpeg:d("./parse_sync/jpeg"),png:d("./parse_sync/png"),psd:d("./parse_sync/psd"),svg:d("./parse_sync/svg"),tiff:d("./parse_sync/tiff"),webp:d("./parse_sync/webp")}},{"./parse_sync/avif":265,"./parse_sync/bmp":266,"./parse_sync/gif":267,"./parse_sync/ico":268,"./parse_sync/jpeg":269,"./parse_sync/png":270,"./parse_sync/psd":271,"./parse_sync/svg":272,"./parse_sync/tiff":273,"./parse_sync/webp":274}],276:[function(d,re,ne){var w=d("./lib/parsers_sync");function c(M){for(var T=Object.keys(w),e=0;e<T.length;e++){var a=w[T[e]](M);if(a)return a}return null}re.exports=function(T){return c(T)},re.exports.parsers=w},{"./lib/parsers_sync":275}],277:[function(d,re,ne){var w=re.exports={},c,M;function T(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?c=setTimeout:c=T}catch{c=T}try{typeof clearTimeout=="function"?M=clearTimeout:M=e}catch{M=e}})();function a(h){if(c===setTimeout)return setTimeout(h,0);if((c===T||!c)&&setTimeout)return c=setTimeout,setTimeout(h,0);try{return c(h,0)}catch{try{return c.call(null,h,0)}catch{return c.call(this,h,0)}}}function n(h){if(M===clearTimeout)return clearTimeout(h);if((M===e||!M)&&clearTimeout)return M=clearTimeout,clearTimeout(h);try{return M(h)}catch{try{return M.call(null,h)}catch{return M.call(this,h)}}}var r=[],t=!1,f,o=-1;function i(){!t||!f||(t=!1,f.length?r=f.concat(r):o=-1,r.length&&g())}function g(){if(!t){var h=a(i);t=!0;for(var m=r.length;m;){for(f=r,r=[];++o<m;)f&&f[o].run();o=-1,m=r.length}f=null,t=!1,n(h)}}w.nextTick=function(h){var m=new Array(arguments.length-1);if(arguments.length>1)for(var u=1;u<arguments.length;u++)m[u-1]=arguments[u];r.push(new p(h,m)),r.length===1&&!t&&a(g)};function p(h,m){this.fun=h,this.array=m}p.prototype.run=function(){this.fun.apply(null,this.array)},w.title="browser",w.browser=!0,w.env={},w.argv=[],w.version="",w.versions={};function y(){}w.on=y,w.addListener=y,w.once=y,w.off=y,w.removeListener=y,w.removeAllListeners=y,w.emit=y,w.prependListener=y,w.prependOnceListener=y,w.listeners=function(h){return[]},w.binding=function(h){throw new Error("process.binding is not supported")},w.cwd=function(){return"/"},w.chdir=function(h){throw new Error("process.chdir is not supported")},w.umask=function(){return 0}},{}],278:[function(d,re,ne){(function(w){(function(){for(var c=d("performance-now"),M=typeof window=="undefined"?w:window,T=["moz","webkit"],e="AnimationFrame",a=M["request"+e],n=M["cancel"+e]||M["cancelRequest"+e],r=0;!a&&r<T.length;r++)a=M[T[r]+"Request"+e],n=M[T[r]+"Cancel"+e]||M[T[r]+"CancelRequest"+e];if(!a||!n){var t=0,f=0,o=[],i=1e3/60;a=function(g){if(o.length===0){var p=c(),y=Math.max(0,i-(p-t));t=y+p,setTimeout(function(){var h=o.slice(0);o.length=0;for(var m=0;m<h.length;m++)if(!h[m].cancelled)try{h[m].callback(t)}catch(u){setTimeout(function(){throw u},0)}},Math.round(y))}return o.push({handle:++f,callback:g,cancelled:!1}),f},n=function(g){for(var p=0;p<o.length;p++)o[p].handle===g&&(o[p].cancelled=!0)}}re.exports=function(g){return a.call(M,g)},re.exports.cancel=function(){n.apply(M,arguments)},re.exports.polyfill=function(g){g||(g=M),g.requestAnimationFrame=a,g.cancelAnimationFrame=n}}).call(this)}).call(this,typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"performance-now":252}],279:[function(d,re,ne){var w=d("array-bounds"),c=d("color-normalize"),M=d("update-diff"),T=d("pick-by-alias"),e=d("object-assign"),a=d("flatten-vertex-data"),n=d("to-float32"),r=n.float32,t=n.fract32;re.exports=o;var f=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];function o(i,g){if(typeof i=="function"?(g||(g={}),g.regl=i):g=i,g.length&&(g.positions=g),i=g.regl,!i.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var p=i._gl,y,h,m,u,_,s,A={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},x=[];return u=i.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),h=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),m=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),_=i.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),s=i.buffer({usage:"static",type:"float",data:f}),L(g),y=i({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:i.prop("range"),lineWidth:i.prop("lineWidth"),capSize:i.prop("capSize"),opacity:i.prop("opacity"),scale:i.prop("scale"),translate:i.prop("translate"),scaleFract:i.prop("scaleFract"),translateFract:i.prop("translateFract"),viewport:function(k,P){return[P.viewport.x,P.viewport.y,k.viewportWidth,k.viewportHeight]}},attributes:{color:{buffer:u,offset:function(k,P){return P.offset*4},divisor:1},position:{buffer:h,offset:function(k,P){return P.offset*8},divisor:1},positionFract:{buffer:m,offset:function(k,P){return P.offset*8},divisor:1},error:{buffer:_,offset:function(k,P){return P.offset*16},divisor:1},direction:{buffer:s,stride:24,offset:0},lineOffset:{buffer:s,stride:24,offset:8},capOffset:{buffer:s,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:i.prop("viewport")},viewport:i.prop("viewport"),stencil:!1,instances:i.prop("count"),count:f.length}),e(v,{update:L,draw:b,destroy:S,regl:i,gl:p,canvas:p.canvas,groups:x}),v;function v(k){k?L(k):k===null&&S(),b()}function b(k){if(typeof k=="number")return l(k);k&&!Array.isArray(k)&&(k=[k]),i._refresh(),x.forEach(function(P,z){if(!!P){if(k&&(k[z]?P.draw=!0:P.draw=!1),!P.draw){P.draw=!0;return}l(z)}})}function l(k){typeof k=="number"&&(k=x[k]),k!=null&&(!(k&&k.count&&k.color&&k.opacity&&k.positions&&k.positions.length>1)||(k.scaleRatio=[k.scale[0]*k.viewport.width,k.scale[1]*k.viewport.height],y(k),k.after&&k.after(k)))}function L(k){if(!!k){k.length!=null?typeof k[0]=="number"&&(k=[{positions:k}]):Array.isArray(k)||(k=[k]);var P=0,z=0;if(v.groups=x=k.map(function(G,J){var j=x[J];if(G)typeof G=="function"?G={after:G}:typeof G[0]=="number"&&(G={positions:G});else return j;return G=T(G,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),j||(x[J]=j={id:J,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},G=e({},A,G)),M(j,G,[{lineWidth:function(Y){return+Y*.5},capSize:function(Y){return+Y*.5},opacity:parseFloat,errors:function(Y){return Y=a(Y),z+=Y.length,Y},positions:function(Y,X){return Y=a(Y,"float64"),X.count=Math.floor(Y.length/2),X.bounds=w(Y,2),X.offset=P,P+=X.count,Y}},{color:function(Y,X){var oe=X.count;if(Y||(Y="transparent"),!Array.isArray(Y)||typeof Y[0]=="number"){var se=Y;Y=Array(oe);for(var ie=0;ie<oe;ie++)Y[ie]=se}if(Y.length<oe)throw Error("Not enough colors");for(var N=new Uint8Array(oe*4),U=0;U<oe;U++){var q=c(Y[U],"uint8");N.set(q,U*4)}return N},range:function(Y,X,oe){var se=X.bounds;return Y||(Y=se),X.scale=[1/(Y[2]-Y[0]),1/(Y[3]-Y[1])],X.translate=[-Y[0],-Y[1]],X.scaleFract=t(X.scale),X.translateFract=t(X.translate),Y},viewport:function(Y){var X;return Array.isArray(Y)?X={x:Y[0],y:Y[1],width:Y[2]-Y[0],height:Y[3]-Y[1]}:Y?(X={x:Y.x||Y.left||0,y:Y.y||Y.top||0},Y.right?X.width=Y.right-X.x:X.width=Y.w||Y.width||0,Y.bottom?X.height=Y.bottom-X.y:X.height=Y.h||Y.height||0):X={x:0,y:0,width:p.drawingBufferWidth,height:p.drawingBufferHeight},X}}]),j}),P||z){var I=x.reduce(function(G,J,j){return G+(J?J.count:0)},0),D=new Float64Array(I*2),R=new Uint8Array(I*4),B=new Float32Array(I*4);x.forEach(function(G,J){if(!!G){var j=G.positions,Y=G.count,X=G.offset,oe=G.color,se=G.errors;!Y||(R.set(oe,X*4),B.set(se,X*4),D.set(j,X*2))}});var F=r(D);h(F);var V=t(D,F);m(V),u(R),_(B)}}}function S(){h.destroy(),m.destroy(),u.destroy(),_.destroy(),s.destroy()}}},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":313,"update-diff":329}],280:[function(d,re,ne){var w=d("color-normalize"),c=d("array-bounds"),M=d("object-assign"),T=d("glslify"),e=d("pick-by-alias"),a=d("flatten-vertex-data"),n=d("earcut"),r=d("array-normalize"),t=d("to-float32"),f=t.float32,o=t.fract32,i=d("es6-weak-map"),g=d("parse-rect"),p=d("array-find-index");re.exports=y;function y(h,m){if(!(this instanceof y))return new y(h,m);if(typeof h=="function"?(m||(m={}),m.regl=h):m=h,m.length&&(m.positions=m),h=m.regl,!h.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=h._gl,this.regl=h,this.passes=[],this.shaders=y.shaders.has(h)?y.shaders.get(h):y.shaders.set(h,y.createShaders(h)).get(h),this.update(m)}y.dashMult=2,y.maxPatternLength=256,y.precisionThreshold=3e6,y.maxPoints=1e4,y.maxLines=2048,y.shaders=new i,y.createShaders=function(h){var m=h.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),u={primitive:"triangle strip",instances:h.prop("count"),count:4,offset:0,uniforms:{miterMode:function(x,v){return v.join==="round"?2:1},miterLimit:h.prop("miterLimit"),scale:h.prop("scale"),scaleFract:h.prop("scaleFract"),translateFract:h.prop("translateFract"),translate:h.prop("translate"),thickness:h.prop("thickness"),dashTexture:h.prop("dashTexture"),opacity:h.prop("opacity"),pixelRatio:h.context("pixelRatio"),id:h.prop("id"),dashLength:h.prop("dashLength"),viewport:function(x,v){return[v.viewport.x,v.viewport.y,x.viewportWidth,x.viewportHeight]},depth:h.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(x,v){return!v.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:h.prop("viewport")},viewport:h.prop("viewport")},_=h(M({vert:T([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:T([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:m,divisor:0,stride:8,offset:0},lineTop:{buffer:m,divisor:0,stride:8,offset:4},aCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:h.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},u)),s;try{s=h(M({cull:{enable:!0,face:"back"},vert:T([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:T([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:m,divisor:0,stride:8,offset:0},lineTop:{buffer:m,divisor:0,stride:8,offset:4},aColor:{buffer:h.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:h.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:h.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},u))}catch{s=_}var A=h({primitive:"triangle",elements:function(x,v){return v.triangles},offset:0,vert:T([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:T([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:h.prop("scale"),color:h.prop("fill"),scaleFract:h.prop("scaleFract"),translateFract:h.prop("translateFract"),translate:h.prop("translate"),opacity:h.prop("opacity"),pixelRatio:h.context("pixelRatio"),id:h.prop("id"),viewport:function(x,v){return[v.viewport.x,v.viewport.y,x.viewportWidth,x.viewportHeight]}},attributes:{position:{buffer:h.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:h.prop("positionFractBuffer"),stride:8,offset:8}},blend:u.blend,depth:{enable:!1},scissor:u.scissor,stencil:u.stencil,viewport:u.viewport});return{fill:A,rect:_,miter:s}},y.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},y.prototype.render=function(){for(var h,m=[],u=arguments.length;u--;)m[u]=arguments[u];m.length&&(h=this).update.apply(h,m),this.draw()},y.prototype.draw=function(){for(var h=this,m=[],u=arguments.length;u--;)m[u]=arguments[u];return(m.length?m:this.passes).forEach(function(_,s){var A;if(_&&Array.isArray(_))return(A=h).draw.apply(A,_);typeof _=="number"&&(_=h.passes[_]),_&&_.count>1&&_.opacity&&(h.regl._refresh(),_.fill&&_.triangles&&_.triangles.length>2&&h.shaders.fill(_),_.thickness&&(_.scale[0]*_.viewport.width>y.precisionThreshold||_.scale[1]*_.viewport.height>y.precisionThreshold||_.join==="rect"||!_.join&&(_.thickness<=2||_.count>=y.maxPoints)?h.shaders.rect(_):h.shaders.miter(_)))}),this},y.prototype.update=function(h){var m=this;if(!!h){h.length!=null?typeof h[0]=="number"&&(h=[{positions:h}]):Array.isArray(h)||(h=[h]);var u=this,_=u.regl,s=u.gl;if(h.forEach(function(l,L){var S=m.passes[L];if(l!==void 0){if(l===null){m.passes[L]=null;return}if(typeof l[0]=="number"&&(l={positions:l}),l=e(l,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),S||(m.passes[L]=S={id:L,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:_.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:_.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:_.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:_.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},l=M({},y.defaults,l)),l.thickness!=null&&(S.thickness=parseFloat(l.thickness)),l.opacity!=null&&(S.opacity=parseFloat(l.opacity)),l.miterLimit!=null&&(S.miterLimit=parseFloat(l.miterLimit)),l.overlay!=null&&(S.overlay=!!l.overlay,L<y.maxLines&&(S.depth=2*(y.maxLines-1-L%y.maxLines)/y.maxLines-1)),l.join!=null&&(S.join=l.join),l.hole!=null&&(S.hole=l.hole),l.fill!=null&&(S.fill=l.fill?w(l.fill,"uint8"):null),l.viewport!=null&&(S.viewport=g(l.viewport)),S.viewport||(S.viewport=g([s.drawingBufferWidth,s.drawingBufferHeight])),l.close!=null&&(S.close=l.close),l.positions===null&&(l.positions=[]),l.positions){var k,P;if(l.positions.x&&l.positions.y){var z=l.positions.x,I=l.positions.y;P=S.count=Math.max(z.length,I.length),k=new Float64Array(P*2);for(var D=0;D<P;D++)k[D*2]=z[D],k[D*2+1]=I[D]}else k=a(l.positions,"float64"),P=S.count=Math.floor(k.length/2);var R=S.bounds=c(k,2);if(S.fill){for(var B=[],F={},V=0,G=0,J=0,j=S.count;G<j;G++){var Y=k[G*2],X=k[G*2+1];isNaN(Y)||isNaN(X)||Y==null||X==null?(Y=k[V*2],X=k[V*2+1],F[G]=V):V=G,B[J++]=Y,B[J++]=X}if(l.splitNull){S.count-1 in F||(F[S.count]=S.count-1);var oe=Object.keys(F).map(Number).sort(function(at,ct){return at-ct}),se=[],ie=0,N=S.hole!=null?S.hole[0]:null;if(N!=null){var U=p(oe,function(at){return at>=N});oe=oe.slice(0,U),oe.push(N)}for(var q=function(at){var ct=B.slice(ie*2,oe[at]*2).concat(N?B.slice(N*2):[]),je=(S.hole||[]).map(function(Ye){return Ye-N+(oe[at]-ie)}),ke=n(ct,je);ke=ke.map(function(Ye){return Ye+ie+(Ye+ie<oe[at]?0:N-oe[at])}),se.push.apply(se,ke),ie=oe[at]+1},Q=0;Q<oe.length;Q++)q(Q);for(var W=0,Z=se.length;W<Z;W++)F[se[W]]!=null&&(se[W]=F[se[W]]);S.triangles=se}else{for(var ee=n(B,S.hole||[]),te=0,ae=ee.length;te<ae;te++)F[ee[te]]!=null&&(ee[te]=F[ee[te]]);S.triangles=ee}}var le=new Float64Array(k);r(le,2,R);var ye=new Float64Array(P*2+6);S.close?k[0]===k[P*2-2]&&k[1]===k[P*2-1]?(ye[0]=le[P*2-4],ye[1]=le[P*2-3]):(ye[0]=le[P*2-2],ye[1]=le[P*2-1]):(ye[0]=le[0],ye[1]=le[1]),ye.set(le,2),S.close?k[0]===k[P*2-2]&&k[1]===k[P*2-1]?(ye[P*2+2]=le[2],ye[P*2+3]=le[3],S.count-=1):(ye[P*2+2]=le[0],ye[P*2+3]=le[1],ye[P*2+4]=le[2],ye[P*2+5]=le[3]):(ye[P*2+2]=le[P*2-2],ye[P*2+3]=le[P*2-1],ye[P*2+4]=le[P*2-2],ye[P*2+5]=le[P*2-1]);var fe=f(ye);S.positionBuffer(fe);var pe=o(ye,fe);S.positionFractBuffer(pe)}if(l.range?S.range=l.range:S.range||(S.range=S.bounds),(l.range||l.positions)&&S.count){var ge=S.bounds,Ae=ge[2]-ge[0],we=ge[3]-ge[1],De=S.range[2]-S.range[0],Be=S.range[3]-S.range[1];S.scale=[Ae/De,we/Be],S.translate=[-S.range[0]/De+ge[0]/De||0,-S.range[1]/Be+ge[1]/Be||0],S.scaleFract=o(S.scale),S.translateFract=o(S.translate)}if(l.dashes){var Ve=0,xe;if(!l.dashes||l.dashes.length<2)Ve=1,xe=new Uint8Array([255,255,255,255,255,255,255,255]);else{Ve=0;for(var Le=0;Le<l.dashes.length;++Le)Ve+=l.dashes[Le];xe=new Uint8Array(Ve*y.dashMult);for(var He=0,Je=255,Oe=0;Oe<2;Oe++)for(var Pe=0;Pe<l.dashes.length;++Pe){for(var Ue=0,vt=l.dashes[Pe]*y.dashMult*.5;Ue<vt;++Ue)xe[He++]=Je;Je^=255}}S.dashLength=Ve,S.dashTexture({channels:1,data:xe,width:xe.length,height:1,mag:"linear",min:"linear"},0,0)}if(l.color){var Lt=S.count,Yt=l.color;Yt||(Yt="transparent");var At=new Uint8Array(Lt*4+4);if(!Array.isArray(Yt)||typeof Yt[0]=="number")for(var Rt=w(Yt,"uint8"),Bt=0;Bt<Lt+1;Bt++)At.set(Rt,Bt*4);else{for(var Mt=0;Mt<Lt;Mt++){var Tt=w(Yt[Mt],"uint8");At.set(Tt,Mt*4)}At.set(w(Yt[0],"uint8"),Lt*4)}S.colorBuffer({usage:"dynamic",type:"uint8",data:At})}}}),h.length<this.passes.length){for(var A=h.length;A<this.passes.length;A++){var x=this.passes[A];!x||(x.colorBuffer.destroy(),x.positionBuffer.destroy(),x.dashTexture.destroy())}this.passes.length=h.length}for(var v=[],b=0;b<this.passes.length;b++)this.passes[b]!==null&&v.push(this.passes[b]);return this.passes=v,this}},y.prototype.destroy=function(){return this.passes.forEach(function(h){h.colorBuffer.destroy(),h.positionBuffer.destroy(),h.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":313}],281:[function(d,re,ne){function w(S,k){return T(S)||a(S,k)||n(S,k)||f()}function c(S){return M(S)||e(S)||n(S)||t()}function M(S){if(Array.isArray(S))return r(S)}function T(S){if(Array.isArray(S))return S}function e(S){if(typeof Symbol!="undefined"&&S[Symbol.iterator]!=null||S["@@iterator"]!=null)return Array.from(S)}function a(S,k){var P=S==null?null:typeof Symbol!="undefined"&&S[Symbol.iterator]||S["@@iterator"];if(P!=null){var z=[],I=!0,D=!1,R,B;try{for(P=P.call(S);!(I=(R=P.next()).done)&&(z.push(R.value),!(k&&z.length===k));I=!0);}catch(F){D=!0,B=F}finally{try{!I&&P.return!=null&&P.return()}finally{if(D)throw B}}return z}}function n(S,k){if(!!S){if(typeof S=="string")return r(S,k);var P=Object.prototype.toString.call(S).slice(8,-1);if(P==="Object"&&S.constructor&&(P=S.constructor.name),P==="Map"||P==="Set")return Array.from(S);if(P==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(P))return r(S,k)}}function r(S,k){(k==null||k>S.length)&&(k=S.length);for(var P=0,z=new Array(k);P<k;P++)z[P]=S[P];return z}function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function f(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=d("color-normalize"),i=d("array-bounds"),g=d("color-id"),p=d("@plotly/point-cluster"),y=d("object-assign"),h=d("glslify"),m=d("pick-by-alias"),u=d("update-diff"),_=d("flatten-vertex-data"),s=d("is-iexplorer"),A=d("to-float32"),x=d("parse-rect"),v=b;function b(S,k){var P=this;if(!(this instanceof b))return new b(S,k);typeof S=="function"?(k||(k={}),k.regl=S):(k=S,S=null),k&&k.length&&(k.positions=k),S=k.regl;var z=S._gl,I,D=[],R={},B=[],F=[null],V=[null],G=255,J=100;this.tooManyColors=s,I=S.texture({data:new Uint8Array(G*4),width:G,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),y(this,{regl:S,gl:z,groups:B,markerCache:V,markerTextures:F,palette:D,paletteIds:R,paletteTexture:I,maxColors:G,maxSize:J,canvas:z.canvas}),this.update(k);var j={uniforms:{constPointSize:!!k.constPointSize,opacity:S.prop("opacity"),paletteSize:function(se,ie){return[P.tooManyColors?0:G,I.height]},pixelRatio:S.context("pixelRatio"),scale:S.prop("scale"),scaleFract:S.prop("scaleFract"),translate:S.prop("translate"),translateFract:S.prop("translateFract"),markerTexture:S.prop("markerTexture"),paletteTexture:I},attributes:{x:function(se,ie){return ie.xAttr||{buffer:ie.positionBuffer,stride:8,offset:0}},y:function(se,ie){return ie.yAttr||{buffer:ie.positionBuffer,stride:8,offset:4}},xFract:function(se,ie){return ie.xAttr?{constant:[0,0]}:{buffer:ie.positionFractBuffer,stride:8,offset:0}},yFract:function(se,ie){return ie.yAttr?{constant:[0,0]}:{buffer:ie.positionFractBuffer,stride:8,offset:4}},size:function(se,ie){return ie.size.length?{buffer:ie.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(ie.size*255/P.maxSize)]}},borderSize:function(se,ie){return ie.borderSize.length?{buffer:ie.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(ie.borderSize*255/P.maxSize)]}},colorId:function(se,ie){return ie.color.length?{buffer:ie.colorBuffer,stride:P.tooManyColors?8:4,offset:0}:{constant:P.tooManyColors?D.slice(ie.color*4,ie.color*4+4):[ie.color]}},borderColorId:function(se,ie){return ie.borderColor.length?{buffer:ie.colorBuffer,stride:P.tooManyColors?8:4,offset:P.tooManyColors?4:2}:{constant:P.tooManyColors?D.slice(ie.borderColor*4,ie.borderColor*4+4):[ie.borderColor]}},isActive:function(se,ie){return ie.activation===!0?{constant:[1]}:ie.activation?ie.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:S.prop("viewport")},viewport:S.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:S.prop("elements"),count:S.prop("count"),offset:S.prop("offset"),primitive:"points"},Y=y({},j);Y.frag=h([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),Y.vert=h([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=S(Y);var X=y({},j);X.frag=h([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),X.vert=h([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),s&&(X.frag=X.frag.replace("smoothstep","smoothStep"),Y.frag=Y.frag.replace("smoothstep","smoothStep")),this.drawCircle=S(X)}b.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},b.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},b.prototype.draw=function(){for(var S=this,k=arguments.length,P=new Array(k),z=0;z<k;z++)P[z]=arguments[z];var I=this.groups;if(P.length===1&&Array.isArray(P[0])&&(P[0][0]===null||Array.isArray(P[0][0]))&&(P=P[0]),this.regl._refresh(),P.length)for(var D=0;D<P.length;D++)this.drawItem(D,P[D]);else I.forEach(function(R,B){S.drawItem(B)});return this},b.prototype.drawItem=function(S,k){var P=this.groups,z=P[S];if(typeof k=="number"&&(S=k,z=P[k],k=null),!!(z&&z.count&&z.opacity)){z.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,z,k));for(var I=[],D=1;D<z.activation.length;D++)!z.activation[D]||z.activation[D]!==!0&&!z.activation[D].data.length||I.push.apply(I,c(this.getMarkerDrawOptions(D,z,k)));I.length&&this.drawMarker(I)}},b.prototype.getMarkerDrawOptions=function(S,k,P){var z=k.range,I=k.tree,D=k.viewport,R=k.activation,B=k.selectionBuffer,F=k.count;if(this.regl,!I)return P?[y({},k,{markerTexture:this.markerTextures[S],activation:R[S],count:P.length,elements:P,offset:0})]:[y({},k,{markerTexture:this.markerTextures[S],activation:R[S],offset:0})];var V=[],G=I.range(z,{lod:!0,px:[(z[2]-z[0])/D.width,(z[3]-z[1])/D.height]});if(P){for(var J=R[S],j=J.data,Y=new Uint8Array(F),X=0;X<P.length;X++){var oe=P[X];Y[oe]=j?j[oe]:1}B.subdata(Y)}for(var se=G.length;se--;){var ie=w(G[se],2),N=ie[0],U=ie[1];V.push(y({},k,{markerTexture:this.markerTextures[S],activation:P?B:R[S],offset:N,count:U-N}))}return V},b.prototype.update=function(){for(var S=this,k=arguments.length,P=new Array(k),z=0;z<k;z++)P[z]=arguments[z];if(!!P.length){P.length===1&&Array.isArray(P[0])&&(P=P[0]);var I=this.groups,D=this.gl,R=this.regl,B=this.maxSize,F=this.maxColors,V=this.palette;this.groups=I=P.map(function(G,J){var j=I[J];if(G===void 0)return j;G===null?G={positions:null}:typeof G=="function"?G={ondraw:G}:typeof G[0]=="number"&&(G={positions:G}),G=m(G,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"}),G.positions===null&&(G.positions=[]),G.tooManyColors!=null&&(S.tooManyColors=G.tooManyColors),j||(I[J]=j={id:J,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:R.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:R.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},G=y({},b.defaults,G)),G.positions&&!("marker"in G)&&(G.marker=j.marker,delete j.marker),G.marker&&!("positions"in G)&&(G.positions=j.positions,delete j.positions);var Y=0,X=0;if(u(j,G,[{snap:!0,size:function(we,De){return we==null&&(we=b.defaults.size),Y+=we&&we.length?1:0,we},borderSize:function(we,De){return we==null&&(we=b.defaults.borderSize),Y+=we&&we.length?1:0,we},opacity:parseFloat,color:function(we,De){return we==null&&(we=b.defaults.color),we=S.updateColor(we),X++,we},borderColor:function(we,De){return we==null&&(we=b.defaults.borderColor),we=S.updateColor(we),X++,we},bounds:function(we,De,Be){return"range"in Be||(Be.range=null),we},positions:function(we,De,Be){var Ve=De.snap,xe=De.positionBuffer,Le=De.positionFractBuffer,He=De.selectionBuffer;if(we.x||we.y)return we.x.length?De.xAttr={buffer:R.buffer(we.x),offset:0,stride:4,count:we.x.length}:De.xAttr={buffer:we.x.buffer,offset:we.x.offset*4||0,stride:(we.x.stride||1)*4,count:we.x.count},we.y.length?De.yAttr={buffer:R.buffer(we.y),offset:0,stride:4,count:we.y.length}:De.yAttr={buffer:we.y.buffer,offset:we.y.offset*4||0,stride:(we.y.stride||1)*4,count:we.y.count},De.count=Math.max(De.xAttr.count,De.yAttr.count),we;we=_(we,"float64");var Je=De.count=Math.floor(we.length/2),Oe=De.bounds=Je?i(we,2):null;if(!Be.range&&!De.range&&(delete De.range,Be.range=Oe),!Be.marker&&!De.marker&&(delete De.marker,Be.marker=null),Ve&&(Ve===!0||Je>Ve)?De.tree=p(we,{bounds:Oe}):Ve&&Ve.length&&(De.tree=Ve),De.tree){var Pe={primitive:"points",usage:"static",data:De.tree,type:"uint32"};De.elements?De.elements(Pe):De.elements=R.elements(Pe)}var Ue=A.float32(we);xe({data:Ue,usage:"dynamic"});var vt=A.fract32(we,Ue);return Le({data:vt,usage:"dynamic"}),He({data:new Uint8Array(Je),type:"uint8",usage:"stream"}),we}},{marker:function(we,De,Be){var Ve=De.activation;if(Ve.forEach(function(vt){return vt&&vt.destroy&&vt.destroy()}),Ve.length=0,!we||typeof we[0]=="number"){var xe=S.addMarker(we);Ve[xe]=!0}else{for(var Le=[],He=0,Je=Math.min(we.length,De.count);He<Je;He++){var Oe=S.addMarker(we[He]);Le[Oe]||(Le[Oe]=new Uint8Array(De.count)),Le[Oe][He]=1}for(var Pe=0;Pe<Le.length;Pe++)if(!!Le[Pe]){var Ue={data:Le[Pe],type:"uint8",usage:"static"};Ve[Pe]?Ve[Pe](Ue):Ve[Pe]=R.buffer(Ue),Ve[Pe].data=Le[Pe]}}return we},range:function(we,De,Be){var Ve=De.bounds;if(!!Ve)return we||(we=Ve),De.scale=[1/(we[2]-we[0]),1/(we[3]-we[1])],De.translate=[-we[0],-we[1]],De.scaleFract=A.fract(De.scale),De.translateFract=A.fract(De.translate),we},viewport:function(we){var De=x(we||[D.drawingBufferWidth,D.drawingBufferHeight]);return De}}]),Y){var oe=j,se=oe.count,ie=oe.size,N=oe.borderSize,U=oe.sizeBuffer,q=new Uint8Array(se*2);if(ie.length||N.length)for(var Q=0;Q<se;Q++)q[Q*2]=Math.round((ie[Q]==null?ie:ie[Q])*255/B),q[Q*2+1]=Math.round((N[Q]==null?N:N[Q])*255/B);U({data:q,usage:"dynamic"})}if(X){var W=j,Z=W.count,ee=W.color,te=W.borderColor,ae=W.colorBuffer,le;if(S.tooManyColors){if(ee.length||te.length){le=new Uint8Array(Z*8);for(var ye=0;ye<Z;ye++){var fe=ee[ye];le[ye*8]=V[fe*4],le[ye*8+1]=V[fe*4+1],le[ye*8+2]=V[fe*4+2],le[ye*8+3]=V[fe*4+3];var pe=te[ye];le[ye*8+4]=V[pe*4],le[ye*8+5]=V[pe*4+1],le[ye*8+6]=V[pe*4+2],le[ye*8+7]=V[pe*4+3]}}}else if(ee.length||te.length){le=new Uint8Array(Z*4+2);for(var ge=0;ge<Z;ge++)ee[ge]!=null&&(le[ge*4]=ee[ge]%F,le[ge*4+1]=Math.floor(ee[ge]/F)),te[ge]!=null&&(le[ge*4+2]=te[ge]%F,le[ge*4+3]=Math.floor(te[ge]/F))}ae({data:le||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return j})}},b.prototype.addMarker=function(S){var k=this.markerTextures,P=this.regl,z=this.markerCache,I=S==null?0:z.indexOf(S);if(I>=0)return I;var D;if(S instanceof Uint8Array||S instanceof Uint8ClampedArray)D=S;else{D=new Uint8Array(S.length);for(var R=0,B=S.length;R<B;R++)D[R]=S[R]*255}var F=Math.floor(Math.sqrt(D.length));return I=k.length,z.push(S),k.push(P.texture({channels:1,data:D,radius:F,mag:"linear",min:"linear"})),I},b.prototype.updateColor=function(S){var k=this.paletteIds,P=this.palette,z=this.maxColors;Array.isArray(S)||(S=[S]);var I=[];if(typeof S[0]=="number"){var D=[];if(Array.isArray(S))for(var R=0;R<S.length;R+=4)D.push(S.slice(R,R+4));else for(var B=0;B<S.length;B+=4)D.push(S.subarray(B,B+4));S=D}for(var F=0;F<S.length;F++){var V=S[F];V=o(V,"uint8");var G=g(V,!1);if(k[G]==null){var J=P.length;k[G]=Math.floor(J/4),P[J]=V[0],P[J+1]=V[1],P[J+2]=V[2],P[J+3]=V[3]}I[F]=k[G]}return!this.tooManyColors&&P.length>z*4&&(this.tooManyColors=!0),this.updatePalette(P),I.length===1?I[0]:I},b.prototype.updatePalette=function(S){if(!this.tooManyColors){var k=this.maxColors,P=this.paletteTexture,z=Math.ceil(S.length*.25/k);if(z>1){S=S.slice();for(var I=S.length*.25%k;I<z*k;I++)S.push(0,0,0,0)}P.height<z&&P.resize(k,z),P.subimage({width:Math.min(S.length*.25,k),height:z,data:S},0,0)}},b.prototype.destroy=function(){return this.groups.forEach(function(S){S.sizeBuffer.destroy(),S.positionBuffer.destroy(),S.positionFractBuffer.destroy(),S.colorBuffer.destroy(),S.activation.forEach(function(k){return k&&k.destroy&&k.destroy()}),S.selectionBuffer.destroy(),S.elements&&S.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(S){return S&&S.destroy&&S.destroy()}),this};var l=d("object-assign"),L=function(k,P){var z=new v(k,P),I=z.render.bind(z);return l(I,{render:I,update:z.update.bind(z),draw:z.draw.bind(z),destroy:z.destroy.bind(z),regl:z.regl,gl:z.gl,canvas:z.gl.canvas,groups:z.groups,markers:z.markerCache,palette:z.palette}),I};re.exports=L},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":313,"update-diff":329}],282:[function(d,re,ne){var w=d("regl-scatter2d"),c=d("pick-by-alias"),M=d("array-bounds"),T=d("raf"),e=d("array-range"),a=d("parse-rect"),n=d("flatten-vertex-data");re.exports=r;function r(i,g){if(!(this instanceof r))return new r(i,g);this.traces=[],this.passes={},this.regl=i,this.scatter=w(i),this.canvas=this.scatter.canvas}r.prototype.render=function(){for(var i=this,g,p=[],y=arguments.length;y--;)p[y]=arguments[y];return p.length&&(g=this).update.apply(g,p),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=T(function(){i.draw(),i.dirty=!0,i.planned=null})):(this.draw(),this.dirty=!0,T(function(){i.dirty=!1})),this)},r.prototype.update=function(){for(var i,g=[],p=arguments.length;p--;)g[p]=arguments[p];if(!!g.length){for(var y=0;y<g.length;y++)this.updateItem(y,g[y]);this.traces=this.traces.filter(Boolean);for(var h=[],m=0,u=0;u<this.traces.length;u++){for(var _=this.traces[u],s=this.traces[u].passes,A=0;A<s.length;A++)h.push(this.passes[s[A]]);_.passOffset=m,m+=_.passes.length}return(i=this.scatter).update.apply(i,h),this}},r.prototype.updateItem=function(i,g){var p=this,y=p.regl;if(g===null)return this.traces[i]=null,this;if(!g)return this;var h=c(g,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),m=this.traces[i]||(this.traces[i]={id:i,buffer:y.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:a([y._gl.drawingBufferWidth,y._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(h.color!=null&&(m.color=h.color),h.size!=null&&(m.size=h.size),h.marker!=null&&(m.marker=h.marker),h.borderColor!=null&&(m.borderColor=h.borderColor),h.borderSize!=null&&(m.borderSize=h.borderSize),h.opacity!=null&&(m.opacity=h.opacity),h.viewport&&(m.viewport=a(h.viewport)),h.diagonal!=null&&(m.diagonal=h.diagonal),h.upper!=null&&(m.upper=h.upper),h.lower!=null&&(m.lower=h.lower),h.data){m.buffer(n(h.data)),m.columns=h.data.length,m.count=h.data[0].length,m.bounds=[];for(var u=0;u<m.columns;u++)m.bounds[u]=M(h.data[u],1)}var _;h.range&&(m.range=h.range,_=m.range&&typeof m.range[0]!="number"),h.domain&&(m.domain=h.domain);var s=!1;h.padding!=null&&(Array.isArray(h.padding)&&h.padding.length===m.columns&&typeof h.padding[h.padding.length-1]=="number"?(m.padding=h.padding.map(o),s=!0):m.padding=o(h.padding));var A=m.columns,x=m.count,v=m.viewport.width,b=m.viewport.height,l=m.viewport.x,L=m.viewport.y,S=v/A,k=b/A;m.passes=[];for(var P=0;P<A;P++)for(var z=0;z<A;z++)if(!(!m.diagonal&&z===P)&&!(!m.upper&&P>z)&&!(!m.lower&&P<z)){var I=t(m.id,P,z),D=this.passes[I]||(this.passes[I]={});if(h.data&&(h.transpose?D.positions={x:{buffer:m.buffer,offset:z,count:x,stride:A},y:{buffer:m.buffer,offset:P,count:x,stride:A}}:D.positions={x:{buffer:m.buffer,offset:z*x,count:x},y:{buffer:m.buffer,offset:P*x,count:x}},D.bounds=f(m.bounds,P,z)),h.domain||h.viewport||h.data){var R=s?f(m.padding,P,z):m.padding;if(m.domain){var B=f(m.domain,P,z),F=B[0],V=B[1],G=B[2],J=B[3];D.viewport=[l+F*v+R[0],L+V*b+R[1],l+G*v-R[2],L+J*b-R[3]]}else D.viewport=[l+z*S+S*R[0],L+P*k+k*R[1],l+(z+1)*S-S*R[2],L+(P+1)*k-k*R[3]]}h.color&&(D.color=m.color),h.size&&(D.size=m.size),h.marker&&(D.marker=m.marker),h.borderSize&&(D.borderSize=m.borderSize),h.borderColor&&(D.borderColor=m.borderColor),h.opacity&&(D.opacity=m.opacity),h.range&&(D.range=_?f(m.range,P,z):m.range||D.bounds),m.passes.push(I)}return this},r.prototype.draw=function(){for(var i,g=[],p=arguments.length;p--;)g[p]=arguments[p];if(!g.length)this.scatter.draw();else{for(var y=[],h=0;h<g.length;h++)if(typeof g[h]=="number"){var m=this.traces[g[h]],u=m.passes,_=m.passOffset;y.push.apply(y,e(_,_+u.length))}else if(g[h].length){var s=g[h],A=this.traces[h],x=A.passes,v=A.passOffset;x=x.map(function(b,l){y[v+l]=s})}(i=this.scatter).draw.apply(i,y)}return this},r.prototype.destroy=function(){return this.traces.forEach(function(i){i.buffer&&i.buffer.destroy&&i.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this};function t(i,g,p){var y=i.id!=null?i.id:i,h=g,m=p,u=y<<16|(h&255)<<8|m&255;return u}function f(i,g,p){var y,h,m,u,_=i[g],s=i[p];return _.length>2?(y=_[1],h=_[3]):_.length?(y=_[0],h=_[1]):(y=_.y,_.x+_.width,h=_.y+_.height),s.length>2?(m=s[0],u=s[2]):s.length?(m=s[0],u=s[1]):(m=s.x,u=s.x+s.width,s.y+s.height),[m,y,u,h]}function o(i){if(typeof i=="number")return[i,i,i,i];if(i.length===2)return[i[0],i[1],i[0],i[1]];var g=a(i);return[g.x,g.y,g.x+g.width,g.y+g.height]}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:278,"regl-scatter2d":281}],283:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?re.exports=c():w.createREGL=c()})(this,function(){function w(ot,Vt){this.id=ye++,this.type=ot,this.data=Vt}function c(ot){if(ot.length===0)return[];var Vt=ot.charAt(0),jt=ot.charAt(ot.length-1);if(1<ot.length&&Vt===jt&&(Vt==='"'||Vt==="'"))return['"'+ot.substr(1,ot.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(Vt=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(ot))return c(ot.substr(0,Vt.index)).concat(c(Vt[1])).concat(c(ot.substr(Vt.index+Vt[0].length)));if(Vt=ot.split("."),Vt.length===1)return['"'+ot.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(ot=[],jt=0;jt<Vt.length;++jt)ot=ot.concat(c(Vt[jt]));return ot}function M(ot){return"["+c(ot).join("][")+"]"}function T(ot,Vt){if(typeof ot=="function")return new w(0,ot);if(typeof ot=="number"||typeof ot=="boolean")return new w(5,ot);if(Array.isArray(ot))return new w(6,ot.map(function(jt,Ut){return T(jt)}));if(ot instanceof w)return ot}function e(){var ot={"":0},Vt=[""];return{id:function(jt){var Ut=ot[jt];return Ut||(Ut=ot[jt]=Vt.length,Vt.push(jt),Ut)},str:function(jt){return Vt[jt]}}}function a(ot,Vt,jt){function Ut(){var _e=window.innerWidth,Me=window.innerHeight;ot!==document.body&&(Me=yr.getBoundingClientRect(),_e=Me.right-Me.left,Me=Me.bottom-Me.top),yr.width=jt*_e,yr.height=jt*Me}var yr=document.createElement("canvas");le(yr.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),ot.appendChild(yr),ot===document.body&&(yr.style.position="absolute",le(ot.style,{margin:0,padding:0}));var nt;return ot!==document.body&&typeof ResizeObserver=="function"?(nt=new ResizeObserver(function(){setTimeout(Ut)}),nt.observe(ot)):window.addEventListener("resize",Ut,!1),Ut(),{canvas:yr,onDestroy:function(){nt?nt.disconnect():window.removeEventListener("resize",Ut),ot.removeChild(yr)}}}function n(ot,Vt){function jt(Ut){try{return ot.getContext(Ut,Vt)}catch{return null}}return jt("webgl")||jt("experimental-webgl")||jt("webgl-experimental")}function r(ot){return typeof ot=="string"?ot.split():ot}function t(ot){return typeof ot=="string"?document.querySelector(ot):ot}function f(ot){var Vt=ot||{},jt,Ut,yr,nt;ot={};var _e=[],Me=[],Ne=typeof window=="undefined"?1:window.devicePixelRatio,We=!1,Qe={},rt=function(ht){},$e=function(){};if(typeof Vt=="string"?jt=document.querySelector(Vt):typeof Vt=="object"&&(typeof Vt.nodeName=="string"&&typeof Vt.appendChild=="function"&&typeof Vt.getBoundingClientRect=="function"?jt=Vt:typeof Vt.drawArrays=="function"||typeof Vt.drawElements=="function"?(nt=Vt,yr=nt.canvas):("gl"in Vt?nt=Vt.gl:"canvas"in Vt?yr=t(Vt.canvas):"container"in Vt&&(Ut=t(Vt.container)),"attributes"in Vt&&(ot=Vt.attributes),"extensions"in Vt&&(_e=r(Vt.extensions)),"optionalExtensions"in Vt&&(Me=r(Vt.optionalExtensions)),"onDone"in Vt&&(rt=Vt.onDone),"profile"in Vt&&(We=!!Vt.profile),"pixelRatio"in Vt&&(Ne=+Vt.pixelRatio),"cachedCode"in Vt&&(Qe=Vt.cachedCode))),jt&&(jt.nodeName.toLowerCase()==="canvas"?yr=jt:Ut=jt),!nt){if(!yr){if(jt=a(Ut||document.body,rt,Ne),!jt)return null;yr=jt.canvas,$e=jt.onDestroy}ot.premultipliedAlpha===void 0&&(ot.premultipliedAlpha=!0),nt=n(yr,ot)}return nt?{gl:nt,canvas:yr,container:Ut,extensions:_e,optionalExtensions:Me,pixelRatio:Ne,profile:We,cachedCode:Qe,onDone:rt,onDestroy:$e}:($e(),rt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function o(ot,Vt){function jt(_e){_e=_e.toLowerCase();var Me;try{Me=Ut[_e]=ot.getExtension(_e)}catch{}return!!Me}for(var Ut={},yr=0;yr<Vt.extensions.length;++yr){var nt=Vt.extensions[yr];if(!jt(nt))return Vt.onDestroy(),Vt.onDone('"'+nt+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Vt.optionalExtensions.forEach(jt),{extensions:Ut,restore:function(){Object.keys(Ut).forEach(function(_e){if(Ut[_e]&&!jt(_e))throw Error("(regl): error restoring extension "+_e)})}}}function i(ot,Vt){for(var jt=Array(ot),Ut=0;Ut<ot;++Ut)jt[Ut]=Vt(Ut);return jt}function g(ot){var Vt,jt;return Vt=(65535<ot)<<4,ot>>>=Vt,jt=(255<ot)<<3,ot>>>=jt,Vt|=jt,jt=(15<ot)<<2,ot>>>=jt,Vt|=jt,jt=(3<ot)<<1,Vt|jt|ot>>>jt>>1}function p(){function ot(Ut){e:{for(var yr=16;268435456>=yr;yr*=16)if(Ut<=yr){Ut=yr;break e}Ut=0}return yr=jt[g(Ut)>>2],0<yr.length?yr.pop():new ArrayBuffer(Ut)}function Vt(Ut){jt[g(Ut.byteLength)>>2].push(Ut)}var jt=i(8,function(){return[]});return{alloc:ot,free:Vt,allocType:function(Ut,yr){var nt=null;switch(Ut){case 5120:nt=new Int8Array(ot(yr),0,yr);break;case 5121:nt=new Uint8Array(ot(yr),0,yr);break;case 5122:nt=new Int16Array(ot(2*yr),0,yr);break;case 5123:nt=new Uint16Array(ot(2*yr),0,yr);break;case 5124:nt=new Int32Array(ot(4*yr),0,yr);break;case 5125:nt=new Uint32Array(ot(4*yr),0,yr);break;case 5126:nt=new Float32Array(ot(4*yr),0,yr);break;default:return null}return nt.length!==yr?nt.subarray(0,yr):nt},freeType:function(Ut){Vt(Ut.buffer)}}}function y(ot){return!!ot&&typeof ot=="object"&&Array.isArray(ot.shape)&&Array.isArray(ot.stride)&&typeof ot.offset=="number"&&ot.shape.length===ot.stride.length&&(Array.isArray(ot.data)||De(ot.data))}function h(ot,Vt,jt,Ut,yr,nt){for(var _e=0;_e<Vt;++_e)for(var Me=ot[_e],Ne=0;Ne<jt;++Ne)for(var We=Me[Ne],Qe=0;Qe<Ut;++Qe)yr[nt++]=We[Qe]}function m(ot,Vt,jt,Ut,yr){for(var nt=1,_e=jt+1;_e<Vt.length;++_e)nt*=Vt[_e];var Me=Vt[jt];if(Vt.length-jt===4){var Ne=Vt[jt+1],We=Vt[jt+2];for(Vt=Vt[jt+3],_e=0;_e<Me;++_e)h(ot[_e],Ne,We,Vt,Ut,yr),yr+=nt}else for(_e=0;_e<Me;++_e)m(ot[_e],Vt,jt+1,Ut,yr),yr+=nt}function u(ot){return xe[Object.prototype.toString.call(ot)]|0}function _(ot,Vt){for(var jt=0;jt<Vt.length;++jt)ot[jt]=Vt[jt]}function s(ot,Vt,jt,Ut,yr,nt,_e){for(var Me=0,Ne=0;Ne<jt;++Ne)for(var We=0;We<Ut;++We)ot[Me++]=Vt[yr*Ne+nt*We+_e]}function A(ot,Vt,jt,Ut){function yr(rt){this.id=Ne++,this.buffer=ot.createBuffer(),this.type=rt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,jt.profile&&(this.stats={size:0})}function nt(rt,$e,ht){rt.byteLength=$e.byteLength,ot.bufferData(rt.type,$e,ht)}function _e(rt,$e,ht,xt,kt,Wt){if(rt.usage=ht,Array.isArray($e)){if(rt.dtype=xt||5126,0<$e.length)if(Array.isArray($e[0])){kt=Oe($e);for(var Ft=xt=1;Ft<kt.length;++Ft)xt*=kt[Ft];rt.dimension=xt,$e=Je($e,kt,rt.dtype),nt(rt,$e,ht),Wt?rt.persistentData=$e:Ae.freeType($e)}else typeof $e[0]=="number"?(rt.dimension=kt,kt=Ae.allocType(rt.dtype,$e.length),_(kt,$e),nt(rt,kt,ht),Wt?rt.persistentData=kt:Ae.freeType(kt)):De($e[0])&&(rt.dimension=$e[0].length,rt.dtype=xt||u($e[0])||5126,$e=Je($e,[$e.length,$e[0].length],rt.dtype),nt(rt,$e,ht),Wt?rt.persistentData=$e:Ae.freeType($e))}else if(De($e))rt.dtype=xt||u($e),rt.dimension=kt,nt(rt,$e,ht),Wt&&(rt.persistentData=new Uint8Array(new Uint8Array($e.buffer)));else if(y($e)){kt=$e.shape;var ir=$e.stride,Ft=$e.offset,hr=0,_r=0,an=0,Rr=0;kt.length===1?(hr=kt[0],_r=1,an=ir[0],Rr=0):kt.length===2&&(hr=kt[0],_r=kt[1],an=ir[0],Rr=ir[1]),rt.dtype=xt||u($e.data)||5126,rt.dimension=_r,kt=Ae.allocType(rt.dtype,hr*_r),s(kt,$e.data,hr,_r,an,Rr,Ft),nt(rt,kt,ht),Wt?rt.persistentData=kt:Ae.freeType(kt)}else $e instanceof ArrayBuffer&&(rt.dtype=5121,rt.dimension=kt,nt(rt,$e,ht),Wt&&(rt.persistentData=new Uint8Array(new Uint8Array($e))))}function Me(rt){Vt.bufferCount--,Ut(rt),ot.deleteBuffer(rt.buffer),rt.buffer=null,delete We[rt.id]}var Ne=0,We={};yr.prototype.bind=function(){ot.bindBuffer(this.type,this.buffer)},yr.prototype.destroy=function(){Me(this)};var Qe=[];return jt.profile&&(Vt.getTotalBufferSize=function(){var rt=0;return Object.keys(We).forEach(function($e){rt+=We[$e].stats.size}),rt}),{create:function(rt,$e,ht,xt){function kt(Ft){var ir=35044,hr=null,_r=0,an=0,Rr=1;return Array.isArray(Ft)||De(Ft)||y(Ft)||Ft instanceof ArrayBuffer?hr=Ft:typeof Ft=="number"?_r=Ft|0:Ft&&("data"in Ft&&(hr=Ft.data),"usage"in Ft&&(ir=He[Ft.usage]),"type"in Ft&&(an=Le[Ft.type]),"dimension"in Ft&&(Rr=Ft.dimension|0),"length"in Ft&&(_r=Ft.length|0)),Wt.bind(),hr?_e(Wt,hr,ir,an,Rr,xt):(_r&&ot.bufferData(Wt.type,_r,ir),Wt.dtype=an||5121,Wt.usage=ir,Wt.dimension=Rr,Wt.byteLength=_r),jt.profile&&(Wt.stats.size=Wt.byteLength*Pe[Wt.dtype]),kt}Vt.bufferCount++;var Wt=new yr($e);return We[Wt.id]=Wt,ht||kt(rt),kt._reglType="buffer",kt._buffer=Wt,kt.subdata=function(Ft,ir){var hr=(ir||0)|0,_r;if(Wt.bind(),De(Ft)||Ft instanceof ArrayBuffer)ot.bufferSubData(Wt.type,hr,Ft);else if(Array.isArray(Ft)){if(0<Ft.length)if(typeof Ft[0]=="number"){var an=Ae.allocType(Wt.dtype,Ft.length);_(an,Ft),ot.bufferSubData(Wt.type,hr,an),Ae.freeType(an)}else(Array.isArray(Ft[0])||De(Ft[0]))&&(_r=Oe(Ft),an=Je(Ft,_r,Wt.dtype),ot.bufferSubData(Wt.type,hr,an),Ae.freeType(an))}else if(y(Ft)){_r=Ft.shape;var Rr=Ft.stride,Vr=an=0,fn=0,xr=0;_r.length===1?(an=_r[0],Vr=1,fn=Rr[0],xr=0):_r.length===2&&(an=_r[0],Vr=_r[1],fn=Rr[0],xr=Rr[1]),_r=Array.isArray(Ft.data)?Wt.dtype:u(Ft.data),_r=Ae.allocType(_r,an*Vr),s(_r,Ft.data,an,Vr,fn,xr,Ft.offset),ot.bufferSubData(Wt.type,hr,_r),Ae.freeType(_r)}return kt},jt.profile&&(kt.stats=Wt.stats),kt.destroy=function(){Me(Wt)},kt},createStream:function(rt,$e){var ht=Qe.pop();return ht||(ht=new yr(rt)),ht.bind(),_e(ht,$e,35040,0,1,!1),ht},destroyStream:function(rt){Qe.push(rt)},clear:function(){Be(We).forEach(Me),Qe.forEach(Me)},getBuffer:function(rt){return rt&&rt._buffer instanceof yr?rt._buffer:null},restore:function(){Be(We).forEach(function(rt){rt.buffer=ot.createBuffer(),ot.bindBuffer(rt.type,rt.buffer),ot.bufferData(rt.type,rt.persistentData||rt.byteLength,rt.usage)})},_initBuffer:_e}}function x(ot,Vt,jt,Ut){function yr(rt){this.id=Ne++,Me[this.id]=this,this.buffer=rt,this.primType=4,this.type=this.vertCount=0}function nt(rt,$e,ht,xt,kt,Wt,Ft){rt.buffer.bind();var ir;if($e?((ir=Ft)||De($e)&&(!y($e)||De($e.data))||(ir=Vt.oes_element_index_uint?5125:5123),jt._initBuffer(rt.buffer,$e,ht,ir,3)):(ot.bufferData(34963,Wt,ht),rt.buffer.dtype=ir||5121,rt.buffer.usage=ht,rt.buffer.dimension=3,rt.buffer.byteLength=Wt),ir=Ft,!Ft){switch(rt.buffer.dtype){case 5121:case 5120:ir=5121;break;case 5123:case 5122:ir=5123;break;case 5125:case 5124:ir=5125}rt.buffer.dtype=ir}rt.type=ir,$e=kt,0>$e&&($e=rt.buffer.byteLength,ir===5123?$e>>=1:ir===5125&&($e>>=2)),rt.vertCount=$e,$e=xt,0>xt&&($e=4,xt=rt.buffer.dimension,xt===1&&($e=0),xt===2&&($e=1),xt===3&&($e=4)),rt.primType=$e}function _e(rt){Ut.elementsCount--,delete Me[rt.id],rt.buffer.destroy(),rt.buffer=null}var Me={},Ne=0,We={uint8:5121,uint16:5123};Vt.oes_element_index_uint&&(We.uint32=5125),yr.prototype.bind=function(){this.buffer.bind()};var Qe=[];return{create:function(rt,$e){function ht(Wt){if(Wt)if(typeof Wt=="number")xt(Wt),kt.primType=4,kt.vertCount=Wt|0,kt.type=5121;else{var Ft=null,ir=35044,hr=-1,_r=-1,an=0,Rr=0;Array.isArray(Wt)||De(Wt)||y(Wt)?Ft=Wt:("data"in Wt&&(Ft=Wt.data),"usage"in Wt&&(ir=He[Wt.usage]),"primitive"in Wt&&(hr=Ue[Wt.primitive]),"count"in Wt&&(_r=Wt.count|0),"type"in Wt&&(Rr=We[Wt.type]),"length"in Wt?an=Wt.length|0:(an=_r,Rr===5123||Rr===5122?an*=2:(Rr===5125||Rr===5124)&&(an*=4))),nt(kt,Ft,ir,hr,_r,an,Rr)}else xt(),kt.primType=4,kt.vertCount=0,kt.type=5121;return ht}var xt=jt.create(null,34963,!0),kt=new yr(xt._buffer);return Ut.elementsCount++,ht(rt),ht._reglType="elements",ht._elements=kt,ht.subdata=function(Wt,Ft){return xt.subdata(Wt,Ft),ht},ht.destroy=function(){_e(kt)},ht},createStream:function(rt){var $e=Qe.pop();return $e||($e=new yr(jt.create(null,34963,!0,!1)._buffer)),nt($e,rt,35040,-1,-1,0,0),$e},destroyStream:function(rt){Qe.push(rt)},getElements:function(rt){return typeof rt=="function"&&rt._elements instanceof yr?rt._elements:null},clear:function(){Be(Me).forEach(_e)}}}function v(ot){for(var Vt=Ae.allocType(5123,ot.length),jt=0;jt<ot.length;++jt)if(isNaN(ot[jt]))Vt[jt]=65535;else if(ot[jt]===1/0)Vt[jt]=31744;else if(ot[jt]===-1/0)Vt[jt]=64512;else{vt[0]=ot[jt];var nt=Lt[0],Ut=nt>>>31<<15,yr=(nt<<1>>>24)-127,nt=nt>>13&1023;Vt[jt]=-24>yr?Ut:-14>yr?Ut+(nt+1024>>-14-yr):15<yr?Ut+31744:Ut+(yr+15<<10)+nt}return Vt}function b(ot){return Array.isArray(ot)||De(ot)}function l(ot){return"[object "+ot+"]"}function L(ot){return Array.isArray(ot)&&(ot.length===0||typeof ot[0]=="number")}function S(ot){return!!(Array.isArray(ot)&&ot.length!==0&&b(ot[0]))}function k(ot){return Object.prototype.toString.call(ot)}function P(ot){if(!ot)return!1;var Vt=k(ot);return 0<=ke.indexOf(Vt)?!0:L(ot)||S(ot)||y(ot)}function z(ot,Vt){ot.type===36193?(ot.data=v(Vt),Ae.freeType(Vt)):ot.data=Vt}function I(ot,Vt,jt,Ut,yr,nt){if(ot=typeof Ke[ot]!="undefined"?Ke[ot]:Rt[ot]*Ye[Vt],nt&&(ot*=6),yr){for(Ut=0;1<=jt;)Ut+=ot*jt*jt,jt/=2;return Ut}return ot*jt*Ut}function D(ot,Vt,jt,Ut,yr,nt,_e){function Me(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function Ne(wr,vn){wr.internalformat=vn.internalformat,wr.format=vn.format,wr.type=vn.type,wr.compressed=vn.compressed,wr.premultiplyAlpha=vn.premultiplyAlpha,wr.flipY=vn.flipY,wr.unpackAlignment=vn.unpackAlignment,wr.colorSpace=vn.colorSpace,wr.width=vn.width,wr.height=vn.height,wr.channels=vn.channels}function We(wr,vn){if(typeof vn=="object"&&vn){"premultiplyAlpha"in vn&&(wr.premultiplyAlpha=vn.premultiplyAlpha),"flipY"in vn&&(wr.flipY=vn.flipY),"alignment"in vn&&(wr.unpackAlignment=vn.alignment),"colorSpace"in vn&&(wr.colorSpace=ur[vn.colorSpace]),"type"in vn&&(wr.type=Lr[vn.type]);var on=wr.width,_n=wr.height,Bn=wr.channels,sa=!1;"shape"in vn?(on=vn.shape[0],_n=vn.shape[1],vn.shape.length===3&&(Bn=vn.shape[2],sa=!0)):("radius"in vn&&(on=_n=vn.radius),"width"in vn&&(on=vn.width),"height"in vn&&(_n=vn.height),"channels"in vn&&(Bn=vn.channels,sa=!0)),wr.width=on|0,wr.height=_n|0,wr.channels=Bn|0,on=!1,"format"in vn&&(on=vn.format,_n=wr.internalformat=Br[on],wr.format=Kn[_n],on in Lr&&!("type"in vn)&&(wr.type=Lr[on]),on in Pr&&(wr.compressed=!0),on=!0),!sa&&on?wr.channels=Rt[wr.format]:sa&&!on&&wr.channels!==At[wr.format]&&(wr.format=wr.internalformat=At[wr.channels])}}function Qe(wr){ot.pixelStorei(37440,wr.flipY),ot.pixelStorei(37441,wr.premultiplyAlpha),ot.pixelStorei(37443,wr.colorSpace),ot.pixelStorei(3317,wr.unpackAlignment)}function rt(){Me.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function $e(wr,vn){var on=null;if(P(vn)?on=vn:vn&&(We(wr,vn),"x"in vn&&(wr.xOffset=vn.x|0),"y"in vn&&(wr.yOffset=vn.y|0),P(vn.data)&&(on=vn.data)),vn.copy){var _n=yr.viewportWidth,Bn=yr.viewportHeight;wr.width=wr.width||_n-wr.xOffset,wr.height=wr.height||Bn-wr.yOffset,wr.needsCopy=!0}else if(!on)wr.width=wr.width||1,wr.height=wr.height||1,wr.channels=wr.channels||4;else if(De(on))wr.channels=wr.channels||4,wr.data=on,"type"in vn||wr.type!==5121||(wr.type=xe[Object.prototype.toString.call(on)]|0);else if(L(on)){switch(wr.channels=wr.channels||4,_n=on,Bn=_n.length,wr.type){case 5121:case 5123:case 5125:case 5126:Bn=Ae.allocType(wr.type,Bn),Bn.set(_n),wr.data=Bn;break;case 36193:wr.data=v(_n)}wr.alignment=1,wr.needsFree=!0}else if(y(on)){_n=on.data,Array.isArray(_n)||wr.type!==5121||(wr.type=xe[Object.prototype.toString.call(_n)]|0);var Bn=on.shape,sa=on.stride,ra,In,ea,Va;Bn.length===3?(ea=Bn[2],Va=sa[2]):Va=ea=1,ra=Bn[0],In=Bn[1],Bn=sa[0],sa=sa[1],wr.alignment=1,wr.width=ra,wr.height=In,wr.channels=ea,wr.format=wr.internalformat=At[ea],wr.needsFree=!0,ra=Va,on=on.offset,ea=wr.width,Va=wr.height,In=wr.channels;for(var hi=Ae.allocType(wr.type===36193?5126:wr.type,ea*Va*In),It=0,vr=0;vr<Va;++vr)for(var rn=0;rn<ea;++rn)for(var hn=0;hn<In;++hn)hi[It++]=_n[Bn*rn+sa*vr+ra*hn+on];z(wr,hi)}else if(k(on)===Bt||k(on)===Mt||k(on)===Tt)k(on)===Bt||k(on)===Mt?wr.element=on:wr.element=on.canvas,wr.width=wr.element.width,wr.height=wr.element.height,wr.channels=4;else if(k(on)===at)wr.element=on,wr.width=on.width,wr.height=on.height,wr.channels=4;else if(k(on)===ct)wr.element=on,wr.width=on.naturalWidth,wr.height=on.naturalHeight,wr.channels=4;else if(k(on)===je)wr.element=on,wr.width=on.videoWidth,wr.height=on.videoHeight,wr.channels=4;else if(S(on)){for(_n=wr.width||on[0].length,Bn=wr.height||on.length,sa=wr.channels,sa=b(on[0][0])?sa||on[0][0].length:sa||1,ra=Ve.shape(on),ea=1,Va=0;Va<ra.length;++Va)ea*=ra[Va];ea=Ae.allocType(wr.type===36193?5126:wr.type,ea),Ve.flatten(on,ra,"",ea),z(wr,ea),wr.alignment=1,wr.width=_n,wr.height=Bn,wr.channels=sa,wr.format=wr.internalformat=At[sa],wr.needsFree=!0}}function ht(wr,vn,on,_n,Bn){var sa=wr.element,ra=wr.data,In=wr.internalformat,ea=wr.format,Va=wr.type,hi=wr.width,It=wr.height;Qe(wr),sa?ot.texSubImage2D(vn,Bn,on,_n,ea,Va,sa):wr.compressed?ot.compressedTexSubImage2D(vn,Bn,on,_n,In,hi,It,ra):wr.needsCopy?(Ut(),ot.copyTexSubImage2D(vn,Bn,on,_n,wr.xOffset,wr.yOffset,hi,It)):ot.texSubImage2D(vn,Bn,on,_n,hi,It,ea,Va,ra)}function xt(){return Aa.pop()||new rt}function kt(wr){wr.needsFree&&Ae.freeType(wr.data),rt.call(wr),Aa.push(wr)}function Wt(){Me.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function Ft(wr,vn,on){var _n=wr.images[0]=xt();wr.mipmask=1,_n.width=wr.width=vn,_n.height=wr.height=on,_n.channels=wr.channels=4}function ir(wr,vn){var on=null;if(P(vn))on=wr.images[0]=xt(),Ne(on,wr),$e(on,vn),wr.mipmask=1;else if(We(wr,vn),Array.isArray(vn.mipmap))for(var _n=vn.mipmap,Bn=0;Bn<_n.length;++Bn)on=wr.images[Bn]=xt(),Ne(on,wr),on.width>>=Bn,on.height>>=Bn,$e(on,_n[Bn]),wr.mipmask|=1<<Bn;else on=wr.images[0]=xt(),Ne(on,wr),$e(on,vn),wr.mipmask=1;Ne(wr,wr.images[0])}function hr(wr,vn){for(var on=wr.images,_n=0;_n<on.length&&on[_n];++_n){var Bn=on[_n],sa=vn,ra=_n,In=Bn.element,ea=Bn.data,Va=Bn.internalformat,hi=Bn.format,It=Bn.type,vr=Bn.width,rn=Bn.height;Qe(Bn),In?ot.texImage2D(sa,ra,hi,hi,It,In):Bn.compressed?ot.compressedTexImage2D(sa,ra,Va,vr,rn,0,ea):Bn.needsCopy?(Ut(),ot.copyTexImage2D(sa,ra,hi,Bn.xOffset,Bn.yOffset,vr,rn,0)):ot.texImage2D(sa,ra,hi,vr,rn,0,hi,It,ea||null)}}function _r(){var wr=Ua.pop()||new Wt;Me.call(wr);for(var vn=wr.mipmask=0;16>vn;++vn)wr.images[vn]=null;return wr}function an(wr){for(var vn=wr.images,on=0;on<vn.length;++on)vn[on]&&kt(vn[on]),vn[on]=null;Ua.push(wr)}function Rr(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function Vr(wr,vn){"min"in vn&&(wr.minFilter=Zt[vn.min],0<=Yt.indexOf(wr.minFilter)&&!("faces"in vn)&&(wr.genMipmaps=!0)),"mag"in vn&&(wr.magFilter=Ct[vn.mag]);var on=wr.wrapS,_n=wr.wrapT;if("wrap"in vn){var Bn=vn.wrap;typeof Bn=="string"?on=_n=tt[Bn]:Array.isArray(Bn)&&(on=tt[Bn[0]],_n=tt[Bn[1]])}else"wrapS"in vn&&(on=tt[vn.wrapS]),"wrapT"in vn&&(_n=tt[vn.wrapT]);if(wr.wrapS=on,wr.wrapT=_n,"anisotropic"in vn&&(wr.anisotropic=vn.anisotropic),"mipmap"in vn){switch(on=!1,typeof vn.mipmap){case"string":wr.mipmapHint=Sr[vn.mipmap],on=wr.genMipmaps=!0;break;case"boolean":on=wr.genMipmaps=vn.mipmap;break;case"object":wr.genMipmaps=!1,on=!0}!on||"min"in vn||(wr.minFilter=9984)}}function fn(wr,vn){ot.texParameteri(vn,10241,wr.minFilter),ot.texParameteri(vn,10240,wr.magFilter),ot.texParameteri(vn,10242,wr.wrapS),ot.texParameteri(vn,10243,wr.wrapT),Vt.ext_texture_filter_anisotropic&&ot.texParameteri(vn,34046,wr.anisotropic),wr.genMipmaps&&(ot.hint(33170,wr.mipmapHint),ot.generateMipmap(vn))}function xr(wr){Me.call(this),this.mipmask=0,this.internalformat=6408,this.id=vi++,this.refCount=1,this.target=wr,this.texture=ot.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Rr,_e.profile&&(this.stats={size:0})}function mr(wr){ot.activeTexture(33984),ot.bindTexture(wr.target,wr.texture)}function Fr(){var wr=Ga[0];wr?ot.bindTexture(wr.target,wr.texture):ot.bindTexture(3553,null)}function Ir(wr){var vn=wr.texture,on=wr.unit,_n=wr.target;0<=on&&(ot.activeTexture(33984+on),ot.bindTexture(_n,null),Ga[on]=null),ot.deleteTexture(vn),wr.texture=null,wr.params=null,wr.pixels=null,wr.refCount=0,delete ci[wr.id],nt.textureCount--}var Sr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},tt={repeat:10497,clamp:33071,mirror:33648},Ct={nearest:9728,linear:9729},Zt=le({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Ct),ur={none:0,browser:37444},Lr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Br={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Pr={};Vt.ext_srgb&&(Br.srgb=35904,Br.srgba=35906),Vt.oes_texture_float&&(Lr.float32=Lr.float=5126),Vt.oes_texture_half_float&&(Lr.float16=Lr["half float"]=36193),Vt.webgl_depth_texture&&(le(Br,{depth:6402,"depth stencil":34041}),le(Lr,{uint16:5123,uint32:5125,"depth stencil":34042})),Vt.webgl_compressed_texture_s3tc&&le(Pr,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),Vt.webgl_compressed_texture_atc&&le(Pr,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),Vt.webgl_compressed_texture_pvrtc&&le(Pr,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),Vt.webgl_compressed_texture_etc1&&(Pr["rgb etc1"]=36196);var Tr=Array.prototype.slice.call(ot.getParameter(34467));Object.keys(Pr).forEach(function(wr){var vn=Pr[wr];0<=Tr.indexOf(vn)&&(Br[wr]=vn)});var jr=Object.keys(Br);jt.textureFormats=jr;var Pn=[];Object.keys(Br).forEach(function(wr){Pn[Br[wr]]=wr});var An=[];Object.keys(Lr).forEach(function(wr){An[Lr[wr]]=wr});var $n=[];Object.keys(Ct).forEach(function(wr){$n[Ct[wr]]=wr});var zn=[];Object.keys(Zt).forEach(function(wr){zn[Zt[wr]]=wr});var Yn=[];Object.keys(tt).forEach(function(wr){Yn[tt[wr]]=wr});var Kn=jr.reduce(function(wr,vn){var on=Br[vn];return on===6409||on===6406||on===6409||on===6410||on===6402||on===34041||Vt.ext_srgb&&(on===35904||on===35906)?wr[on]=on:on===32855||0<=vn.indexOf("rgba")?wr[on]=6408:wr[on]=6407,wr},{}),Aa=[],Ua=[],vi=0,ci={},ui=jt.maxTextureUnits,Ga=Array(ui).map(function(){return null});return le(xr.prototype,{bind:function(){this.bindCount+=1;var wr=this.unit;if(0>wr){for(var vn=0;vn<ui;++vn){var on=Ga[vn];if(on){if(0<on.bindCount)continue;on.unit=-1}Ga[vn]=this,wr=vn;break}_e.profile&&nt.maxTextureUnits<wr+1&&(nt.maxTextureUnits=wr+1),this.unit=wr,ot.activeTexture(33984+wr),ot.bindTexture(this.target,this.texture)}return wr},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&Ir(this)}}),_e.profile&&(nt.getTotalTextureSize=function(){var wr=0;return Object.keys(ci).forEach(function(vn){wr+=ci[vn].stats.size}),wr}),{create2D:function(wr,vn){function on(Bn,sa){var ra=_n.texInfo;Rr.call(ra);var In=_r();return typeof Bn=="number"?typeof sa=="number"?Ft(In,Bn|0,sa|0):Ft(In,Bn|0,Bn|0):Bn?(Vr(ra,Bn),ir(In,Bn)):Ft(In,1,1),ra.genMipmaps&&(In.mipmask=(In.width<<1)-1),_n.mipmask=In.mipmask,Ne(_n,In),_n.internalformat=In.internalformat,on.width=In.width,on.height=In.height,mr(_n),hr(In,3553),fn(ra,3553),Fr(),an(In),_e.profile&&(_n.stats.size=I(_n.internalformat,_n.type,In.width,In.height,ra.genMipmaps,!1)),on.format=Pn[_n.internalformat],on.type=An[_n.type],on.mag=$n[ra.magFilter],on.min=zn[ra.minFilter],on.wrapS=Yn[ra.wrapS],on.wrapT=Yn[ra.wrapT],on}var _n=new xr(3553);return ci[_n.id]=_n,nt.textureCount++,on(wr,vn),on.subimage=function(Bn,sa,ra,In){sa|=0,ra|=0,In|=0;var ea=xt();return Ne(ea,_n),ea.width=0,ea.height=0,$e(ea,Bn),ea.width=ea.width||(_n.width>>In)-sa,ea.height=ea.height||(_n.height>>In)-ra,mr(_n),ht(ea,3553,sa,ra,In),Fr(),kt(ea),on},on.resize=function(Bn,sa){var ra=Bn|0,In=sa|0||ra;if(ra===_n.width&&In===_n.height)return on;on.width=_n.width=ra,on.height=_n.height=In,mr(_n);for(var ea=0;_n.mipmask>>ea;++ea){var Va=ra>>ea,hi=In>>ea;if(!Va||!hi)break;ot.texImage2D(3553,ea,_n.format,Va,hi,0,_n.format,_n.type,null)}return Fr(),_e.profile&&(_n.stats.size=I(_n.internalformat,_n.type,ra,In,!1,!1)),on},on._reglType="texture2d",on._texture=_n,_e.profile&&(on.stats=_n.stats),on.destroy=function(){_n.decRef()},on},createCube:function(wr,vn,on,_n,Bn,sa){function ra(Va,hi,It,vr,rn,hn){var un,kn=In.texInfo;for(Rr.call(kn),un=0;6>un;++un)ea[un]=_r();if(typeof Va=="number"||!Va)for(Va=Va|0||1,un=0;6>un;++un)Ft(ea[un],Va,Va);else if(typeof Va=="object")if(hi)ir(ea[0],Va),ir(ea[1],hi),ir(ea[2],It),ir(ea[3],vr),ir(ea[4],rn),ir(ea[5],hn);else if(Vr(kn,Va),We(In,Va),"faces"in Va)for(Va=Va.faces,un=0;6>un;++un)Ne(ea[un],In),ir(ea[un],Va[un]);else for(un=0;6>un;++un)ir(ea[un],Va);for(Ne(In,ea[0]),In.mipmask=kn.genMipmaps?(ea[0].width<<1)-1:ea[0].mipmask,In.internalformat=ea[0].internalformat,ra.width=ea[0].width,ra.height=ea[0].height,mr(In),un=0;6>un;++un)hr(ea[un],34069+un);for(fn(kn,34067),Fr(),_e.profile&&(In.stats.size=I(In.internalformat,In.type,ra.width,ra.height,kn.genMipmaps,!0)),ra.format=Pn[In.internalformat],ra.type=An[In.type],ra.mag=$n[kn.magFilter],ra.min=zn[kn.minFilter],ra.wrapS=Yn[kn.wrapS],ra.wrapT=Yn[kn.wrapT],un=0;6>un;++un)an(ea[un]);return ra}var In=new xr(34067);ci[In.id]=In,nt.cubeCount++;var ea=Array(6);return ra(wr,vn,on,_n,Bn,sa),ra.subimage=function(Va,hi,It,vr,rn){It|=0,vr|=0,rn|=0;var hn=xt();return Ne(hn,In),hn.width=0,hn.height=0,$e(hn,hi),hn.width=hn.width||(In.width>>rn)-It,hn.height=hn.height||(In.height>>rn)-vr,mr(In),ht(hn,34069+Va,It,vr,rn),Fr(),kt(hn),ra},ra.resize=function(Va){if(Va|=0,Va!==In.width){ra.width=In.width=Va,ra.height=In.height=Va,mr(In);for(var hi=0;6>hi;++hi)for(var It=0;In.mipmask>>It;++It)ot.texImage2D(34069+hi,It,In.format,Va>>It,Va>>It,0,In.format,In.type,null);return Fr(),_e.profile&&(In.stats.size=I(In.internalformat,In.type,ra.width,ra.height,!1,!0)),ra}},ra._reglType="textureCube",ra._texture=In,_e.profile&&(ra.stats=In.stats),ra.destroy=function(){In.decRef()},ra},clear:function(){for(var wr=0;wr<ui;++wr)ot.activeTexture(33984+wr),ot.bindTexture(3553,null),Ga[wr]=null;Be(ci).forEach(Ir),nt.cubeCount=0,nt.textureCount=0},getTexture:function(wr){return null},restore:function(){for(var wr=0;wr<ui;++wr){var vn=Ga[wr];vn&&(vn.bindCount=0,vn.unit=-1,Ga[wr]=null)}Be(ci).forEach(function(on){on.texture=ot.createTexture(),ot.bindTexture(on.target,on.texture);for(var _n=0;32>_n;++_n)if((on.mipmask&1<<_n)!==0)if(on.target===3553)ot.texImage2D(3553,_n,on.internalformat,on.width>>_n,on.height>>_n,0,on.internalformat,on.type,null);else for(var Bn=0;6>Bn;++Bn)ot.texImage2D(34069+Bn,_n,on.internalformat,on.width>>_n,on.height>>_n,0,on.internalformat,on.type,null);fn(on.texInfo,on.target)})},refresh:function(){for(var wr=0;wr<ui;++wr){var vn=Ga[wr];vn&&(vn.bindCount=0,vn.unit=-1,Ga[wr]=null),ot.activeTexture(33984+wr),ot.bindTexture(3553,null),ot.bindTexture(34067,null)}}}}function R(ot,Vt,jt,Ut,yr,nt){function _e(xr,mr,Fr){this.target=xr,this.texture=mr,this.renderbuffer=Fr;var Ir=xr=0;mr?(xr=mr.width,Ir=mr.height):Fr&&(xr=Fr.width,Ir=Fr.height),this.width=xr,this.height=Ir}function Me(xr){xr&&(xr.texture&&xr.texture._texture.decRef(),xr.renderbuffer&&xr.renderbuffer._renderbuffer.decRef())}function Ne(xr,mr,Fr){xr&&(xr.texture?xr.texture._texture.refCount+=1:xr.renderbuffer._renderbuffer.refCount+=1)}function We(xr,mr){mr&&(mr.texture?ot.framebufferTexture2D(36160,xr,mr.target,mr.texture._texture.texture,0):ot.framebufferRenderbuffer(36160,xr,36161,mr.renderbuffer._renderbuffer.renderbuffer))}function Qe(xr){var mr=3553,Fr=null,Ir=null,Sr=xr;return typeof xr=="object"&&(Sr=xr.data,"target"in xr&&(mr=xr.target|0)),xr=Sr._reglType,xr==="texture2d"||xr==="textureCube"?Fr=Sr:xr==="renderbuffer"&&(Ir=Sr,mr=36161),new _e(mr,Fr,Ir)}function rt(xr,mr,Fr,Ir,Sr){return Fr?(xr=Ut.create2D({width:xr,height:mr,format:Ir,type:Sr}),xr._texture.refCount=0,new _e(3553,xr,null)):(xr=yr.create({width:xr,height:mr,format:Ir}),xr._renderbuffer.refCount=0,new _e(36161,null,xr))}function $e(xr){return xr&&(xr.texture||xr.renderbuffer)}function ht(xr,mr,Fr){xr&&(xr.texture?xr.texture.resize(mr,Fr):xr.renderbuffer&&xr.renderbuffer.resize(mr,Fr),xr.width=mr,xr.height=Fr)}function xt(){this.id=Vr++,fn[this.id]=this,this.framebuffer=ot.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function kt(xr){xr.colorAttachments.forEach(Me),Me(xr.depthAttachment),Me(xr.stencilAttachment),Me(xr.depthStencilAttachment)}function Wt(xr){ot.deleteFramebuffer(xr.framebuffer),xr.framebuffer=null,nt.framebufferCount--,delete fn[xr.id]}function Ft(xr){var mr;ot.bindFramebuffer(36160,xr.framebuffer);var Fr=xr.colorAttachments;for(mr=0;mr<Fr.length;++mr)We(36064+mr,Fr[mr]);for(mr=Fr.length;mr<jt.maxColorAttachments;++mr)ot.framebufferTexture2D(36160,36064+mr,3553,null,0);ot.framebufferTexture2D(36160,33306,3553,null,0),ot.framebufferTexture2D(36160,36096,3553,null,0),ot.framebufferTexture2D(36160,36128,3553,null,0),We(36096,xr.depthAttachment),We(36128,xr.stencilAttachment),We(33306,xr.depthStencilAttachment),ot.checkFramebufferStatus(36160),ot.isContextLost(),ot.bindFramebuffer(36160,hr.next?hr.next.framebuffer:null),hr.cur=hr.next,ot.getError()}function ir(xr,mr){function Fr(Sr,tt){var Ct,Zt=0,ur=0,Lr=!0,Br=!0;Ct=null;var Pr=!0,Tr="rgba",jr="uint8",Pn=1,An=null,$n=null,zn=null,Yn=!1;typeof Sr=="number"?(Zt=Sr|0,ur=tt|0||Zt):Sr?("shape"in Sr?(ur=Sr.shape,Zt=ur[0],ur=ur[1]):("radius"in Sr&&(Zt=ur=Sr.radius),"width"in Sr&&(Zt=Sr.width),"height"in Sr&&(ur=Sr.height)),("color"in Sr||"colors"in Sr)&&(Ct=Sr.color||Sr.colors),Ct||("colorCount"in Sr&&(Pn=Sr.colorCount|0),"colorTexture"in Sr&&(Pr=!!Sr.colorTexture,Tr="rgba4"),"colorType"in Sr&&(jr=Sr.colorType,!Pr)&&(jr==="half float"||jr==="float16"?Tr="rgba16f":(jr==="float"||jr==="float32")&&(Tr="rgba32f")),"colorFormat"in Sr&&(Tr=Sr.colorFormat,0<=_r.indexOf(Tr)?Pr=!0:0<=an.indexOf(Tr)&&(Pr=!1))),("depthTexture"in Sr||"depthStencilTexture"in Sr)&&(Yn=!(!Sr.depthTexture&&!Sr.depthStencilTexture)),"depth"in Sr&&(typeof Sr.depth=="boolean"?Lr=Sr.depth:(An=Sr.depth,Br=!1)),"stencil"in Sr&&(typeof Sr.stencil=="boolean"?Br=Sr.stencil:($n=Sr.stencil,Lr=!1)),"depthStencil"in Sr&&(typeof Sr.depthStencil=="boolean"?Lr=Br=Sr.depthStencil:(zn=Sr.depthStencil,Br=Lr=!1))):Zt=ur=1;var Kn=null,Aa=null,Ua=null,vi=null;if(Array.isArray(Ct))Kn=Ct.map(Qe);else if(Ct)Kn=[Qe(Ct)];else for(Kn=Array(Pn),Ct=0;Ct<Pn;++Ct)Kn[Ct]=rt(Zt,ur,Pr,Tr,jr);for(Zt=Zt||Kn[0].width,ur=ur||Kn[0].height,An?Aa=Qe(An):Lr&&!Br&&(Aa=rt(Zt,ur,Yn,"depth","uint32")),$n?Ua=Qe($n):Br&&!Lr&&(Ua=rt(Zt,ur,!1,"stencil","uint8")),zn?vi=Qe(zn):!An&&!$n&&Br&&Lr&&(vi=rt(Zt,ur,Yn,"depth stencil","depth stencil")),Lr=null,Ct=0;Ct<Kn.length;++Ct)Ne(Kn[Ct]),Kn[Ct]&&Kn[Ct].texture&&(Br=bt[Kn[Ct].texture._texture.format]*zt[Kn[Ct].texture._texture.type],Lr===null&&(Lr=Br));return Ne(Aa),Ne(Ua),Ne(vi),kt(Ir),Ir.width=Zt,Ir.height=ur,Ir.colorAttachments=Kn,Ir.depthAttachment=Aa,Ir.stencilAttachment=Ua,Ir.depthStencilAttachment=vi,Fr.color=Kn.map($e),Fr.depth=$e(Aa),Fr.stencil=$e(Ua),Fr.depthStencil=$e(vi),Fr.width=Ir.width,Fr.height=Ir.height,Ft(Ir),Fr}var Ir=new xt;return nt.framebufferCount++,Fr(xr,mr),le(Fr,{resize:function(Sr,tt){var Ct=Math.max(Sr|0,1),Zt=Math.max(tt|0||Ct,1);if(Ct===Ir.width&&Zt===Ir.height)return Fr;for(var ur=Ir.colorAttachments,Lr=0;Lr<ur.length;++Lr)ht(ur[Lr],Ct,Zt);return ht(Ir.depthAttachment,Ct,Zt),ht(Ir.stencilAttachment,Ct,Zt),ht(Ir.depthStencilAttachment,Ct,Zt),Ir.width=Fr.width=Ct,Ir.height=Fr.height=Zt,Ft(Ir),Fr},_reglType:"framebuffer",_framebuffer:Ir,destroy:function(){Wt(Ir),kt(Ir)},use:function(Sr){hr.setFBO({framebuffer:Fr},Sr)}})}var hr={cur:null,next:null,dirty:!1,setFBO:null},_r=["rgba"],an=["rgba4","rgb565","rgb5 a1"];Vt.ext_srgb&&an.push("srgba"),Vt.ext_color_buffer_half_float&&an.push("rgba16f","rgb16f"),Vt.webgl_color_buffer_float&&an.push("rgba32f");var Rr=["uint8"];Vt.oes_texture_half_float&&Rr.push("half float","float16"),Vt.oes_texture_float&&Rr.push("float","float32");var Vr=0,fn={};return le(hr,{getFramebuffer:function(xr){return typeof xr=="function"&&xr._reglType==="framebuffer"&&(xr=xr._framebuffer,xr instanceof xt)?xr:null},create:ir,createCube:function(xr){function mr(Ir){var Sr,tt={color:null},Ct=0,Zt=null;Sr="rgba";var ur="uint8",Lr=1;if(typeof Ir=="number"?Ct=Ir|0:Ir?("shape"in Ir?Ct=Ir.shape[0]:("radius"in Ir&&(Ct=Ir.radius|0),"width"in Ir?Ct=Ir.width|0:"height"in Ir&&(Ct=Ir.height|0)),("color"in Ir||"colors"in Ir)&&(Zt=Ir.color||Ir.colors),Zt||("colorCount"in Ir&&(Lr=Ir.colorCount|0),"colorType"in Ir&&(ur=Ir.colorType),"colorFormat"in Ir&&(Sr=Ir.colorFormat)),"depth"in Ir&&(tt.depth=Ir.depth),"stencil"in Ir&&(tt.stencil=Ir.stencil),"depthStencil"in Ir&&(tt.depthStencil=Ir.depthStencil)):Ct=1,Zt)if(Array.isArray(Zt))for(Ir=[],Sr=0;Sr<Zt.length;++Sr)Ir[Sr]=Zt[Sr];else Ir=[Zt];else for(Ir=Array(Lr),Zt={radius:Ct,format:Sr,type:ur},Sr=0;Sr<Lr;++Sr)Ir[Sr]=Ut.createCube(Zt);for(tt.color=Array(Ir.length),Sr=0;Sr<Ir.length;++Sr)Lr=Ir[Sr],Ct=Ct||Lr.width,tt.color[Sr]={target:34069,data:Ir[Sr]};for(Sr=0;6>Sr;++Sr){for(Lr=0;Lr<Ir.length;++Lr)tt.color[Lr].target=34069+Sr;0<Sr&&(tt.depth=Fr[0].depth,tt.stencil=Fr[0].stencil,tt.depthStencil=Fr[0].depthStencil),Fr[Sr]?Fr[Sr](tt):Fr[Sr]=ir(tt)}return le(mr,{width:Ct,height:Ct,color:Ir})}var Fr=Array(6);return mr(xr),le(mr,{faces:Fr,resize:function(Ir){var Sr=Ir|0;if(Sr===mr.width)return mr;var tt=mr.color;for(Ir=0;Ir<tt.length;++Ir)tt[Ir].resize(Sr);for(Ir=0;6>Ir;++Ir)Fr[Ir].resize(Sr);return mr.width=mr.height=Sr,mr},_reglType:"framebufferCube",destroy:function(){Fr.forEach(function(Ir){Ir.destroy()})}})},clear:function(){Be(fn).forEach(Wt)},restore:function(){hr.cur=null,hr.next=null,hr.dirty=!0,Be(fn).forEach(function(xr){xr.framebuffer=ot.createFramebuffer(),Ft(xr)})}})}function B(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function F(ot,Vt,jt,Ut,yr,nt,_e){function Me(Ft){if(Ft!==Wt.currentVAO){var ir=Vt.oes_vertex_array_object;Ft?ir.bindVertexArrayOES(Ft.vao):ir.bindVertexArrayOES(null),Wt.currentVAO=Ft}}function Ne(Ft){if(Ft!==Wt.currentVAO){if(Ft)Ft.bindAttrs();else{for(var ir=Vt.angle_instanced_arrays,hr=0;hr<ht.length;++hr){var _r=ht[hr];_r.buffer?(ot.enableVertexAttribArray(hr),_r.buffer.bind(),ot.vertexAttribPointer(hr,_r.size,_r.type,_r.normalized,_r.stride,_r.offfset),ir&&_r.divisor&&ir.vertexAttribDivisorANGLE(hr,_r.divisor)):(ot.disableVertexAttribArray(hr),ot.vertexAttrib4f(hr,_r.x,_r.y,_r.z,_r.w))}_e.elements?ot.bindBuffer(34963,_e.elements.buffer.buffer):ot.bindBuffer(34963,null)}Wt.currentVAO=Ft}}function We(){Be(kt).forEach(function(Ft){Ft.destroy()})}function Qe(){this.id=++xt,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var Ft=Vt.oes_vertex_array_object;this.vao=Ft?Ft.createVertexArrayOES():null,kt[this.id]=this,this.buffers=[]}function rt(){Vt.oes_vertex_array_object&&Be(kt).forEach(function(Ft){Ft.refresh()})}var $e=jt.maxAttributes,ht=Array($e);for(jt=0;jt<$e;++jt)ht[jt]=new B;var xt=0,kt={},Wt={Record:B,scope:{},state:ht,currentVAO:null,targetVAO:null,restore:Vt.oes_vertex_array_object?rt:function(){},createVAO:function(Ft){function ir(_r){var an;Array.isArray(_r)?(an=_r,hr.elements&&hr.ownsElements&&hr.elements.destroy(),hr.elements=null,hr.ownsElements=!1,hr.offset=0,hr.count=0,hr.instances=-1,hr.primitive=4):(_r.elements?(an=_r.elements,hr.ownsElements?(typeof an=="function"&&an._reglType==="elements"?hr.elements.destroy():hr.elements(an),hr.ownsElements=!1):nt.getElements(_r.elements)?(hr.elements=_r.elements,hr.ownsElements=!1):(hr.elements=nt.create(_r.elements),hr.ownsElements=!0)):(hr.elements=null,hr.ownsElements=!1),an=_r.attributes,hr.offset=0,hr.count=-1,hr.instances=-1,hr.primitive=4,hr.elements&&(hr.count=hr.elements._elements.vertCount,hr.primitive=hr.elements._elements.primType),"offset"in _r&&(hr.offset=_r.offset|0),"count"in _r&&(hr.count=_r.count|0),"instances"in _r&&(hr.instances=_r.instances|0),"primitive"in _r&&(hr.primitive=Ue[_r.primitive])),_r={};var Rr=hr.attributes;Rr.length=an.length;for(var Vr=0;Vr<an.length;++Vr){var fn=an[Vr],xr=Rr[Vr]=new B,mr=fn.data||fn;if(Array.isArray(mr)||De(mr)||y(mr)){var Fr;hr.buffers[Vr]&&(Fr=hr.buffers[Vr],De(mr)&&Fr._buffer.byteLength>=mr.byteLength?Fr.subdata(mr):(Fr.destroy(),hr.buffers[Vr]=null)),hr.buffers[Vr]||(Fr=hr.buffers[Vr]=yr.create(fn,34962,!1,!0)),xr.buffer=yr.getBuffer(Fr),xr.size=xr.buffer.dimension|0,xr.normalized=!1,xr.type=xr.buffer.dtype,xr.offset=0,xr.stride=0,xr.divisor=0,xr.state=1,_r[Vr]=1}else yr.getBuffer(fn)?(xr.buffer=yr.getBuffer(fn),xr.size=xr.buffer.dimension|0,xr.normalized=!1,xr.type=xr.buffer.dtype,xr.offset=0,xr.stride=0,xr.divisor=0,xr.state=1):yr.getBuffer(fn.buffer)?(xr.buffer=yr.getBuffer(fn.buffer),xr.size=(+fn.size||xr.buffer.dimension)|0,xr.normalized=!!fn.normalized||!1,xr.type="type"in fn?Le[fn.type]:xr.buffer.dtype,xr.offset=(fn.offset||0)|0,xr.stride=(fn.stride||0)|0,xr.divisor=(fn.divisor||0)|0,xr.state=1):"x"in fn&&(xr.x=+fn.x||0,xr.y=+fn.y||0,xr.z=+fn.z||0,xr.w=+fn.w||0,xr.state=2)}for(Fr=0;Fr<hr.buffers.length;++Fr)!_r[Fr]&&hr.buffers[Fr]&&(hr.buffers[Fr].destroy(),hr.buffers[Fr]=null);return hr.refresh(),ir}var hr=new Qe;return Ut.vaoCount+=1,ir.destroy=function(){for(var _r=0;_r<hr.buffers.length;++_r)hr.buffers[_r]&&hr.buffers[_r].destroy();hr.buffers.length=0,hr.ownsElements&&(hr.elements.destroy(),hr.elements=null,hr.ownsElements=!1),hr.destroy()},ir._vao=hr,ir._reglType="vao",ir(Ft)},getVAO:function(Ft){return typeof Ft=="function"&&Ft._vao?Ft._vao:null},destroyBuffer:function(Ft){for(var ir=0;ir<ht.length;++ir){var hr=ht[ir];hr.buffer===Ft&&(ot.disableVertexAttribArray(ir),hr.buffer=null)}},setVAO:Vt.oes_vertex_array_object?Me:Ne,clear:Vt.oes_vertex_array_object?We:function(){}};return Qe.prototype.bindAttrs=function(){for(var Ft=Vt.angle_instanced_arrays,ir=this.attributes,hr=0;hr<ir.length;++hr){var _r=ir[hr];_r.buffer?(ot.enableVertexAttribArray(hr),ot.bindBuffer(34962,_r.buffer.buffer),ot.vertexAttribPointer(hr,_r.size,_r.type,_r.normalized,_r.stride,_r.offset),Ft&&_r.divisor&&Ft.vertexAttribDivisorANGLE(hr,_r.divisor)):(ot.disableVertexAttribArray(hr),ot.vertexAttrib4f(hr,_r.x,_r.y,_r.z,_r.w))}for(Ft=ir.length;Ft<$e;++Ft)ot.disableVertexAttribArray(Ft);(Ft=nt.getElements(this.elements))?ot.bindBuffer(34963,Ft.buffer.buffer):ot.bindBuffer(34963,null)},Qe.prototype.refresh=function(){var Ft=Vt.oes_vertex_array_object;Ft&&(Ft.bindVertexArrayOES(this.vao),this.bindAttrs(),Wt.currentVAO=null,Ft.bindVertexArrayOES(null))},Qe.prototype.destroy=function(){if(this.vao){var Ft=Vt.oes_vertex_array_object;this===Wt.currentVAO&&(Wt.currentVAO=null,Ft.bindVertexArrayOES(null)),Ft.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),kt[this.id]&&(delete kt[this.id],--Ut.vaoCount)},Wt}function V(ot,Vt,jt,Ut){function yr(xt,kt,Wt,Ft){this.name=xt,this.id=kt,this.location=Wt,this.info=Ft}function nt(xt,kt){for(var Wt=0;Wt<xt.length;++Wt)if(xt[Wt].id===kt.id){xt[Wt].location=kt.location;return}xt.push(kt)}function _e(xt,kt,Wt){Wt=xt===35632?We:Qe;var Ft=Wt[kt];if(!Ft){var ir=Vt.str(kt),Ft=ot.createShader(xt);ot.shaderSource(Ft,ir),ot.compileShader(Ft),Wt[kt]=Ft}return Ft}function Me(xt,kt){this.id=ht++,this.fragId=xt,this.vertId=kt,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Ut.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Ne(xt,kt,Wt){var Ft;Ft=_e(35632,xt.fragId);var ir=_e(35633,xt.vertId);if(kt=xt.program=ot.createProgram(),ot.attachShader(kt,Ft),ot.attachShader(kt,ir),Wt)for(Ft=0;Ft<Wt.length;++Ft)ir=Wt[Ft],ot.bindAttribLocation(kt,ir[0],ir[1]);ot.linkProgram(kt),ir=ot.getProgramParameter(kt,35718),Ut.profile&&(xt.stats.uniformsCount=ir);var hr=xt.uniforms;for(Ft=0;Ft<ir;++Ft)if(Wt=ot.getActiveUniform(kt,Ft))if(1<Wt.size)for(var _r=0;_r<Wt.size;++_r){var an=Wt.name.replace("[0]","["+_r+"]");nt(hr,new yr(an,Vt.id(an),ot.getUniformLocation(kt,an),Wt))}else nt(hr,new yr(Wt.name,Vt.id(Wt.name),ot.getUniformLocation(kt,Wt.name),Wt));for(ir=ot.getProgramParameter(kt,35721),Ut.profile&&(xt.stats.attributesCount=ir),xt=xt.attributes,Ft=0;Ft<ir;++Ft)(Wt=ot.getActiveAttrib(kt,Ft))&&nt(xt,new yr(Wt.name,Vt.id(Wt.name),ot.getAttribLocation(kt,Wt.name),Wt))}var We={},Qe={},rt={},$e=[],ht=0;return Ut.profile&&(jt.getMaxUniformsCount=function(){var xt=0;return $e.forEach(function(kt){kt.stats.uniformsCount>xt&&(xt=kt.stats.uniformsCount)}),xt},jt.getMaxAttributesCount=function(){var xt=0;return $e.forEach(function(kt){kt.stats.attributesCount>xt&&(xt=kt.stats.attributesCount)}),xt}),{clear:function(){var xt=ot.deleteShader.bind(ot);Be(We).forEach(xt),We={},Be(Qe).forEach(xt),Qe={},$e.forEach(function(kt){ot.deleteProgram(kt.program)}),$e.length=0,rt={},jt.shaderCount=0},program:function(xt,kt,Wt,Ft){var ir=rt[kt];ir||(ir=rt[kt]={});var hr=ir[xt];if(hr&&(hr.refCount++,!Ft))return hr;var _r=new Me(kt,xt);return jt.shaderCount++,Ne(_r,Wt,Ft),hr||(ir[xt]=_r),$e.push(_r),le(_r,{destroy:function(){if(_r.refCount--,0>=_r.refCount){ot.deleteProgram(_r.program);var an=$e.indexOf(_r);$e.splice(an,1),jt.shaderCount--}0>=ir[_r.vertId].refCount&&(ot.deleteShader(Qe[_r.vertId]),delete Qe[_r.vertId],delete rt[_r.fragId][_r.vertId]),Object.keys(rt[_r.fragId]).length||(ot.deleteShader(We[_r.fragId]),delete We[_r.fragId],delete rt[_r.fragId])}})},restore:function(){We={},Qe={};for(var xt=0;xt<$e.length;++xt)Ne($e[xt],null,$e[xt].attributes.map(function(kt){return[kt.location,kt.name]}))},shader:_e,frag:-1,vert:-1}}function G(ot,Vt,jt,Ut,yr,nt,_e){function Me(We){var Qe;Qe=Vt.next===null?5121:Vt.next.colorAttachments[0].texture._texture.type;var rt=0,$e=0,ht=Ut.framebufferWidth,xt=Ut.framebufferHeight,kt=null;return De(We)?kt=We:We&&(rt=We.x|0,$e=We.y|0,ht=(We.width||Ut.framebufferWidth-rt)|0,xt=(We.height||Ut.framebufferHeight-$e)|0,kt=We.data||null),jt(),We=ht*xt*4,kt||(Qe===5121?kt=new Uint8Array(We):Qe===5126&&(kt=kt||new Float32Array(We))),ot.pixelStorei(3333,4),ot.readPixels(rt,$e,ht,xt,6408,Qe,kt),kt}function Ne(We){var Qe;return Vt.setFBO({framebuffer:We.framebuffer},function(){Qe=Me(We)}),Qe}return function(We){return We&&"framebuffer"in We?Ne(We):Me(We)}}function J(ot){for(var Vt=Array(ot.length>>2),Ut=0;Ut<Vt.length;Ut++)Vt[Ut]=0;for(Ut=0;Ut<8*ot.length;Ut+=8)Vt[Ut>>5]|=(ot.charCodeAt(Ut/8)&255)<<24-Ut%32;var jt=8*ot.length;ot=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225];var Ut=Array(64),yr,nt,_e,Me,Ne,We,Qe,rt,$e,ht,xt;for(Vt[jt>>5]|=128<<24-jt%32,Vt[(jt+64>>9<<4)+15]=jt,rt=0;rt<Vt.length;rt+=16){for(jt=ot[0],yr=ot[1],nt=ot[2],_e=ot[3],Me=ot[4],Ne=ot[5],We=ot[6],Qe=ot[7],$e=0;64>$e;$e++){if(16>$e)Ut[$e]=Vt[$e+rt];else{ht=$e,xt=Ut[$e-2],xt=X(xt,17)^X(xt,19)^xt>>>10,xt=oe(xt,Ut[$e-7]);var kt;kt=Ut[$e-15],kt=X(kt,7)^X(kt,18)^kt>>>3,Ut[ht]=oe(oe(xt,kt),Ut[$e-16])}ht=Me,ht=X(ht,6)^X(ht,11)^X(ht,25),ht=oe(oe(oe(oe(Qe,ht),Me&Ne^~Me&We),$t[$e]),Ut[$e]),Qe=jt,Qe=X(Qe,2)^X(Qe,13)^X(Qe,22),xt=oe(Qe,jt&yr^jt&nt^yr&nt),Qe=We,We=Ne,Ne=Me,Me=oe(_e,ht),_e=nt,nt=yr,yr=jt,jt=oe(ht,xt)}ot[0]=oe(jt,ot[0]),ot[1]=oe(yr,ot[1]),ot[2]=oe(nt,ot[2]),ot[3]=oe(_e,ot[3]),ot[4]=oe(Me,ot[4]),ot[5]=oe(Ne,ot[5]),ot[6]=oe(We,ot[6]),ot[7]=oe(Qe,ot[7])}for(Vt="",Ut=0;Ut<32*ot.length;Ut+=8)Vt+=String.fromCharCode(ot[Ut>>5]>>>24-Ut%32&255);return Vt}function j(ot){for(var Vt="",jt,Ut=0;Ut<ot.length;Ut++)jt=ot.charCodeAt(Ut),Vt+="0123456789abcdef".charAt(jt>>>4&15)+"0123456789abcdef".charAt(jt&15);return Vt}function Y(ot){for(var Vt="",jt=-1,Ut,yr;++jt<ot.length;)Ut=ot.charCodeAt(jt),yr=jt+1<ot.length?ot.charCodeAt(jt+1):0,55296<=Ut&&56319>=Ut&&56320<=yr&&57343>=yr&&(Ut=65536+((Ut&1023)<<10)+(yr&1023),jt++),127>=Ut?Vt+=String.fromCharCode(Ut):2047>=Ut?Vt+=String.fromCharCode(192|Ut>>>6&31,128|Ut&63):65535>=Ut?Vt+=String.fromCharCode(224|Ut>>>12&15,128|Ut>>>6&63,128|Ut&63):2097151>=Ut&&(Vt+=String.fromCharCode(240|Ut>>>18&7,128|Ut>>>12&63,128|Ut>>>6&63,128|Ut&63));return Vt}function X(ot,Vt){return ot>>>Vt|ot<<32-Vt}function oe(ot,Vt){var jt=(ot&65535)+(Vt&65535);return(ot>>16)+(Vt>>16)+(jt>>16)<<16|jt&65535}function se(ot){return Array.prototype.slice.call(ot)}function ie(ot){return se(ot).join("")}function N(ot){function Vt(){var Qe=[],rt=[];return le(function(){Qe.push.apply(Qe,se(arguments))},{def:function(){var $e="v"+yr++;return rt.push($e),0<arguments.length&&(Qe.push($e,"="),Qe.push.apply(Qe,se(arguments)),Qe.push(";")),$e},toString:function(){return ie([0<rt.length?"var "+rt.join(",")+";":"",ie(Qe)])}})}function jt(){function Qe(kt,Wt){$e(kt,Wt,"=",rt.def(kt,Wt),";")}var rt=Vt(),$e=Vt(),ht=rt.toString,xt=$e.toString;return le(function(){rt.apply(rt,se(arguments))},{def:rt.def,entry:rt,exit:$e,save:Qe,set:function(kt,Wt,Ft){Qe(kt,Wt),rt(kt,Wt,"=",Ft,";")},toString:function(){return ht()+xt()}})}var Ut=ot&&ot.cache,yr=0,nt=[],_e=[],Me=[],Ne=Vt(),We={};return{global:Ne,link:function(Qe,rt){var $e=rt&&rt.stable;if(!$e){for(var ht=0;ht<_e.length;++ht)if(_e[ht]===Qe&&!Me[ht])return nt[ht]}return ht="g"+yr++,nt.push(ht),_e.push(Qe),Me.push($e),ht},block:Vt,proc:function(Qe,rt){function $e(){var Wt="a"+ht.length;return ht.push(Wt),Wt}var ht=[];rt=rt||0;for(var xt=0;xt<rt;++xt)$e();var xt=jt(),kt=xt.toString;return We[Qe]=le(xt,{arg:$e,toString:function(){return ie(["function(",ht.join(),"){",kt(),"}"])}})},scope:jt,cond:function(){var Qe=ie(arguments),rt=jt(),$e=jt(),ht=rt.toString,xt=$e.toString;return le(rt,{then:function(){return rt.apply(rt,se(arguments)),this},else:function(){return $e.apply($e,se(arguments)),this},toString:function(){var kt=xt();return kt&&(kt="else{"+kt+"}"),ie(["if(",Qe,"){",ht(),"}",kt])}})},compile:function(){var Qe=['"use strict";',Ne,"return {"];Object.keys(We).forEach(function(ht){Qe.push('"',ht,'":',We[ht].toString(),",")}),Qe.push("}");var rt=ie(Qe).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),$e;return Ut&&($e=j(J(Y(rt))),Ut[$e])?Ut[$e].apply(null,_e):(rt=Function.apply(null,nt.concat(rt)),Ut&&(Ut[$e]=rt),rt.apply(null,_e))}}}function U(ot){return Array.isArray(ot)||De(ot)||y(ot)}function q(ot){return ot.sort(function(Vt,jt){return Vt==="viewport"?-1:jt==="viewport"?1:Vt<jt?-1:1})}function Q(ot,Vt,jt,Ut){this.thisDep=ot,this.contextDep=Vt,this.propDep=jt,this.append=Ut}function W(ot){return ot&&!(ot.thisDep||ot.contextDep||ot.propDep)}function Z(ot){return new Q(!1,!1,!1,ot)}function ee(ot,Vt){var jt=ot.type;if(jt===0)return jt=ot.data.length,new Q(!0,1<=jt,2<=jt,Vt);if(jt===4)return jt=ot.data,new Q(jt.thisDep,jt.contextDep,jt.propDep,Vt);if(jt===5)return new Q(!1,!1,!1,Vt);if(jt===6){for(var Ut=jt=!1,yr=!1,nt=0;nt<ot.data.length;++nt){var _e=ot.data[nt];_e.type===1?yr=!0:_e.type===2?Ut=!0:_e.type===3?jt=!0:_e.type===0?(jt=!0,_e=_e.data,1<=_e&&(Ut=!0),2<=_e&&(yr=!0)):_e.type===4&&(jt=jt||_e.data.thisDep,Ut=Ut||_e.data.contextDep,yr=yr||_e.data.propDep)}return new Q(jt,Ut,yr,Vt)}return new Q(jt===3,jt===2,jt===1,Vt)}function te(ot,Vt,jt,Ut,yr,nt,_e,Me,Ne,We,Qe,rt,$e,ht,xt,kt){function Wt(It){return It.replace(".","_")}function Ft(It,vr,rn){var hn=Wt(It);sa.push(It),Bn[hn]=_n[hn]=!!rn,ra[hn]=vr}function ir(It,vr,rn){var hn=Wt(It);sa.push(It),Array.isArray(rn)?(_n[hn]=rn.slice(),Bn[hn]=rn.slice()):_n[hn]=Bn[hn]=rn,In[hn]=vr}function hr(){var It=N({cache:xt}),vr=It.link,rn=It.global;It.id=hi++,It.batchId="0";var hn=vr(ea),un=It.shared={props:"a0"};Object.keys(ea).forEach(function(dr){un[dr]=rn.def(hn,".",dr)});var kn=It.next={},bn=It.current={};Object.keys(In).forEach(function(dr){Array.isArray(_n[dr])&&(kn[dr]=rn.def(un.next,".",dr),bn[dr]=rn.def(un.current,".",dr))});var ln=It.constants={};Object.keys(Va).forEach(function(dr){ln[dr]=rn.def(JSON.stringify(Va[dr]))}),It.invoke=function(dr,Cr){switch(Cr.type){case 0:var dn=["this",un.context,un.props,It.batchId];return dr.def(vr(Cr.data),".call(",dn.slice(0,Math.max(Cr.data.length+1,4)),")");case 1:return dr.def(un.props,Cr.data);case 2:return dr.def(un.context,Cr.data);case 3:return dr.def("this",Cr.data);case 4:return Cr.data.append(It,dr),Cr.data.ref;case 5:return Cr.data.toString();case 6:return Cr.data.map(function(On){return It.invoke(dr,On)})}},It.attribCache={};var gr={};return It.scopeAttrib=function(dr){if(dr=Vt.id(dr),dr in gr)return gr[dr];var Cr=We.scope[dr];return Cr||(Cr=We.scope[dr]=new ui),gr[dr]=vr(Cr)},It}function _r(It){var vr=It.static;It=It.dynamic;var rn;if("profile"in vr){var hn=!!vr.profile;rn=Z(function(kn,bn){return hn}),rn.enable=hn}else if("profile"in It){var un=It.profile;rn=ee(un,function(kn,bn){return kn.invoke(bn,un)})}return rn}function an(It,vr){var rn=It.static,hn=It.dynamic;if("framebuffer"in rn){var un=rn.framebuffer;return un?(un=Me.getFramebuffer(un),Z(function(bn,ln){var gr=bn.link(un),dr=bn.shared;return ln.set(dr.framebuffer,".next",gr),dr=dr.context,ln.set(dr,".framebufferWidth",gr+".width"),ln.set(dr,".framebufferHeight",gr+".height"),gr})):Z(function(bn,ln){var gr=bn.shared;return ln.set(gr.framebuffer,".next","null"),gr=gr.context,ln.set(gr,".framebufferWidth",gr+".drawingBufferWidth"),ln.set(gr,".framebufferHeight",gr+".drawingBufferHeight"),"null"})}if("framebuffer"in hn){var kn=hn.framebuffer;return ee(kn,function(bn,ln){var Cr=bn.invoke(ln,kn),gr=bn.shared,dr=gr.framebuffer,Cr=ln.def(dr,".getFramebuffer(",Cr,")");return ln.set(dr,".next",Cr),gr=gr.context,ln.set(gr,".framebufferWidth",Cr+"?"+Cr+".width:"+gr+".drawingBufferWidth"),ln.set(gr,".framebufferHeight",Cr+"?"+Cr+".height:"+gr+".drawingBufferHeight"),Cr})}return null}function Rr(It,vr,rn){function hn(ln){if(ln in un){var gr=un[ln];ln=!0;var dr=gr.x|0,Cr=gr.y|0,dn,On;return"width"in gr?dn=gr.width|0:ln=!1,"height"in gr?On=gr.height|0:ln=!1,new Q(!ln&&vr&&vr.thisDep,!ln&&vr&&vr.contextDep,!ln&&vr&&vr.propDep,function(xn,Wn){var aa=xn.shared.context,da=dn;"width"in gr||(da=Wn.def(aa,".","framebufferWidth","-",dr));var ma=On;return"height"in gr||(ma=Wn.def(aa,".","framebufferHeight","-",Cr)),[dr,Cr,da,ma]})}if(ln in kn){var qn=kn[ln];return ln=ee(qn,function(xn,Wn){var Ma=xn.invoke(Wn,qn),aa=xn.shared.context,da=Wn.def(Ma,".x|0"),ma=Wn.def(Ma,".y|0"),la=Wn.def('"width" in ',Ma,"?",Ma,".width|0:","(",aa,".","framebufferWidth","-",da,")"),Ma=Wn.def('"height" in ',Ma,"?",Ma,".height|0:","(",aa,".","framebufferHeight","-",ma,")");return[da,ma,la,Ma]}),vr&&(ln.thisDep=ln.thisDep||vr.thisDep,ln.contextDep=ln.contextDep||vr.contextDep,ln.propDep=ln.propDep||vr.propDep),ln}return vr?new Q(vr.thisDep,vr.contextDep,vr.propDep,function(xn,Wn){var aa=xn.shared.context;return[0,0,Wn.def(aa,".","framebufferWidth"),Wn.def(aa,".","framebufferHeight")]}):null}var un=It.static,kn=It.dynamic;if(It=hn("viewport")){var bn=It;It=new Q(It.thisDep,It.contextDep,It.propDep,function(ln,gr){var dr=bn.append(ln,gr),Cr=ln.shared.context;return gr.set(Cr,".viewportWidth",dr[2]),gr.set(Cr,".viewportHeight",dr[3]),dr})}return{viewport:It,scissor_box:hn("scissor.box")}}function Vr(It,vr){var rn=It.static;if(typeof rn.frag=="string"&&typeof rn.vert=="string"){if(0<Object.keys(vr.dynamic).length)return null;var rn=vr.static,hn=Object.keys(rn);if(0<hn.length&&typeof rn[hn[0]]=="number"){for(var un=[],kn=0;kn<hn.length;++kn)un.push([rn[hn[kn]]|0,hn[kn]]);return un}}return null}function fn(It,vr,rn){function hn(dr){if(dr in un){var Cr=Vt.id(un[dr]);return dr=Z(function(){return Cr}),dr.id=Cr,dr}if(dr in kn){var dn=kn[dr];return ee(dn,function(On,qn){var xn=On.invoke(qn,dn);return qn.def(On.shared.strings,".id(",xn,")")})}return null}var un=It.static,kn=It.dynamic,bn=hn("frag"),ln=hn("vert"),gr=null;return W(bn)&&W(ln)?(gr=Qe.program(ln.id,bn.id,null,rn),It=Z(function(dr,Cr){return dr.link(gr)})):It=new Q(bn&&bn.thisDep||ln&&ln.thisDep,bn&&bn.contextDep||ln&&ln.contextDep,bn&&bn.propDep||ln&&ln.propDep,function(dr,Cr){var dn=dr.shared.shader,On;On=bn?bn.append(dr,Cr):Cr.def(dn,".","frag");var qn;return qn=ln?ln.append(dr,Cr):Cr.def(dn,".","vert"),Cr.def(dn+".program("+qn+","+On+")")}),{frag:bn,vert:ln,progVar:It,program:gr}}function xr(It,vr){function rn(xn,Wn){if(xn in hn){var aa=hn[xn]|0;return Wn?kn.offset=aa:kn.instances=aa,Z(function(ma,la){return Wn&&(ma.OFFSET=aa),aa})}if(xn in un){var da=un[xn];return ee(da,function(ma,la){var Ma=ma.invoke(la,da);return Wn&&(ma.OFFSET=Ma),Ma})}if(Wn){if(gr)return Z(function(ma,la){return ma.OFFSET=0});if(bn)return new Q(ln.thisDep,ln.contextDep,ln.propDep,function(ma,la){return la.def(ma.shared.vao+".currentVAO?"+ma.shared.vao+".currentVAO.offset:0")})}else if(bn)return new Q(ln.thisDep,ln.contextDep,ln.propDep,function(ma,la){return la.def(ma.shared.vao+".currentVAO?"+ma.shared.vao+".currentVAO.instances:-1")});return null}var hn=It.static,un=It.dynamic,kn={},bn=!1,ln=function(){if("vao"in hn){var xn=hn.vao;return xn!==null&&We.getVAO(xn)===null&&(xn=We.createVAO(xn)),bn=!0,kn.vao=xn,Z(function(aa){var da=We.getVAO(xn);return da?aa.link(da):"null"})}if("vao"in un){bn=!0;var Wn=un.vao;return ee(Wn,function(aa,da){var ma=aa.invoke(da,Wn);return da.def(aa.shared.vao+".getVAO("+ma+")")})}return null}(),gr=!1,dr=function(){if("elements"in hn){var xn=hn.elements;if(kn.elements=xn,U(xn)){var Wn=kn.elements=nt.create(xn,!0),xn=nt.getElements(Wn);gr=!0}else xn&&(xn=nt.getElements(xn),gr=!0);return Wn=Z(function(da,ma){if(xn){var la=da.link(xn);return da.ELEMENTS=la}return da.ELEMENTS=null}),Wn.value=xn,Wn}if("elements"in un){gr=!0;var aa=un.elements;return ee(aa,function(da,ma){var la=da.shared,po=la.isBufferArgs,la=la.elements,zo=da.invoke(ma,aa),Ma=ma.def("null"),po=ma.def(po,"(",zo,")"),zo=da.cond(po).then(Ma,"=",la,".createStream(",zo,");").else(Ma,"=",la,".getElements(",zo,");");return ma.entry(zo),ma.exit(da.cond(po).then(la,".destroyStream(",Ma,");")),da.ELEMENTS=Ma})}return bn?new Q(ln.thisDep,ln.contextDep,ln.propDep,function(da,ma){return ma.def(da.shared.vao+".currentVAO?"+da.shared.elements+".getElements("+da.shared.vao+".currentVAO.elements):null")}):null}(),Cr=rn("offset",!0),dn=function(){if("primitive"in hn){var xn=hn.primitive;return kn.primitive=xn,Z(function(aa,da){return Ue[xn]})}if("primitive"in un){var Wn=un.primitive;return ee(Wn,function(aa,da){var ma=aa.constants.primTypes,la=aa.invoke(da,Wn);return da.def(ma,"[",la,"]")})}return gr?W(dr)?dr.value?Z(function(aa,da){return da.def(aa.ELEMENTS,".primType")}):Z(function(){return 4}):new Q(dr.thisDep,dr.contextDep,dr.propDep,function(aa,da){var ma=aa.ELEMENTS;return da.def(ma,"?",ma,".primType:",4)}):bn?new Q(ln.thisDep,ln.contextDep,ln.propDep,function(aa,da){return da.def(aa.shared.vao+".currentVAO?"+aa.shared.vao+".currentVAO.primitive:4")}):null}(),On=function(){if("count"in hn){var xn=hn.count|0;return kn.count=xn,Z(function(){return xn})}if("count"in un){var Wn=un.count;return ee(Wn,function(aa,da){return aa.invoke(da,Wn)})}return gr?W(dr)?dr?Cr?new Q(Cr.thisDep,Cr.contextDep,Cr.propDep,function(aa,da){return da.def(aa.ELEMENTS,".vertCount-",aa.OFFSET)}):Z(function(aa,da){return da.def(aa.ELEMENTS,".vertCount")}):Z(function(){return-1}):new Q(dr.thisDep||Cr.thisDep,dr.contextDep||Cr.contextDep,dr.propDep||Cr.propDep,function(aa,da){var ma=aa.ELEMENTS;return aa.OFFSET?da.def(ma,"?",ma,".vertCount-",aa.OFFSET,":-1"):da.def(ma,"?",ma,".vertCount:-1")}):bn?new Q(ln.thisDep,ln.contextDep,ln.propDep,function(aa,da){return da.def(aa.shared.vao,".currentVAO?",aa.shared.vao,".currentVAO.count:-1")}):null}(),qn=rn("instances",!1);return{elements:dr,primitive:dn,count:On,instances:qn,offset:Cr,vao:ln,vaoActive:bn,elementsActive:gr,static:kn}}function mr(It,vr){var rn=It.static,hn=It.dynamic,un={};return sa.forEach(function(kn){function bn(gr,dr){if(kn in rn){var Cr=gr(rn[kn]);un[ln]=Z(function(){return Cr})}else if(kn in hn){var dn=hn[kn];un[ln]=ee(dn,function(On,qn){return dr(On,qn,On.invoke(qn,dn))})}}var ln=Wt(kn);switch(kn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return bn(function(gr){return gr},function(gr,dr,Cr){return Cr});case"depth.func":return bn(function(gr){return qt[gr]},function(gr,dr,Cr){return dr.def(gr.constants.compareFuncs,"[",Cr,"]")});case"depth.range":return bn(function(gr){return gr},function(gr,dr,Cr){return gr=dr.def("+",Cr,"[0]"),dr=dr.def("+",Cr,"[1]"),[gr,dr]});case"blend.func":return bn(function(gr){return[tr["srcRGB"in gr?gr.srcRGB:gr.src],tr["dstRGB"in gr?gr.dstRGB:gr.dst],tr["srcAlpha"in gr?gr.srcAlpha:gr.src],tr["dstAlpha"in gr?gr.dstAlpha:gr.dst]]},function(gr,dr,Cr){function dn(Wn,aa){return dr.def('"',Wn,aa,'" in ',Cr,"?",Cr,".",Wn,aa,":",Cr,".",Wn)}gr=gr.constants.blendFuncs;var On=dn("src","RGB"),xn=dn("dst","RGB"),On=dr.def(gr,"[",On,"]"),qn=dr.def(gr,"[",dn("src","Alpha"),"]"),xn=dr.def(gr,"[",xn,"]");return gr=dr.def(gr,"[",dn("dst","Alpha"),"]"),[On,xn,qn,gr]});case"blend.equation":return bn(function(gr){if(typeof gr=="string")return[Ga[gr],Ga[gr]];if(typeof gr=="object")return[Ga[gr.rgb],Ga[gr.alpha]]},function(gr,dr,Cr){var dn=gr.constants.blendEquations,On=dr.def(),qn=dr.def();return gr=gr.cond("typeof ",Cr,'==="string"'),gr.then(On,"=",qn,"=",dn,"[",Cr,"];"),gr.else(On,"=",dn,"[",Cr,".rgb];",qn,"=",dn,"[",Cr,".alpha];"),dr(gr),[On,qn]});case"blend.color":return bn(function(gr){return i(4,function(dr){return+gr[dr]})},function(gr,dr,Cr){return i(4,function(dn){return dr.def("+",Cr,"[",dn,"]")})});case"stencil.mask":return bn(function(gr){return gr|0},function(gr,dr,Cr){return dr.def(Cr,"|0")});case"stencil.func":return bn(function(gr){return[qt[gr.cmp||"keep"],gr.ref||0,"mask"in gr?gr.mask:-1]},function(gr,dr,Cr){gr=dr.def('"cmp" in ',Cr,"?",gr.constants.compareFuncs,"[",Cr,".cmp]",":",7680);var dn=dr.def(Cr,".ref|0");return dr=dr.def('"mask" in ',Cr,"?",Cr,".mask|0:-1"),[gr,dn,dr]});case"stencil.opFront":case"stencil.opBack":return bn(function(gr){return[kn==="stencil.opBack"?1029:1028,lr[gr.fail||"keep"],lr[gr.zfail||"keep"],lr[gr.zpass||"keep"]]},function(gr,dr,Cr){function dn(qn){return dr.def('"',qn,'" in ',Cr,"?",On,"[",Cr,".",qn,"]:",7680)}var On=gr.constants.stencilOps;return[kn==="stencil.opBack"?1029:1028,dn("fail"),dn("zfail"),dn("zpass")]});case"polygonOffset.offset":return bn(function(gr){return[gr.factor|0,gr.units|0]},function(gr,dr,Cr){return gr=dr.def(Cr,".factor|0"),dr=dr.def(Cr,".units|0"),[gr,dr]});case"cull.face":return bn(function(gr){var dr=0;return gr==="front"?dr=1028:gr==="back"&&(dr=1029),dr},function(gr,dr,Cr){return dr.def(Cr,'==="front"?',1028,":",1029)});case"lineWidth":return bn(function(gr){return gr},function(gr,dr,Cr){return Cr});case"frontFace":return bn(function(gr){return Wr[gr]},function(gr,dr,Cr){return dr.def(Cr+'==="cw"?2304:2305')});case"colorMask":return bn(function(gr){return gr.map(function(dr){return!!dr})},function(gr,dr,Cr){return i(4,function(dn){return"!!"+Cr+"["+dn+"]"})});case"sample.coverage":return bn(function(gr){return["value"in gr?gr.value:1,!!gr.invert]},function(gr,dr,Cr){return gr=dr.def('"value" in ',Cr,"?+",Cr,".value:1"),dr=dr.def("!!",Cr,".invert"),[gr,dr]})}}),un}function Fr(It,vr){var rn=It.static,hn=It.dynamic,un={};return Object.keys(rn).forEach(function(kn){var bn=rn[kn],ln;if(typeof bn=="number"||typeof bn=="boolean")ln=Z(function(){return bn});else if(typeof bn=="function"){var gr=bn._reglType;gr==="texture2d"||gr==="textureCube"?ln=Z(function(dr){return dr.link(bn)}):(gr==="framebuffer"||gr==="framebufferCube")&&(ln=Z(function(dr){return dr.link(bn.color[0])}))}else b(bn)&&(ln=Z(function(dr){return dr.global.def("[",i(bn.length,function(Cr){return bn[Cr]}),"]")}));ln.value=bn,un[kn]=ln}),Object.keys(hn).forEach(function(kn){var bn=hn[kn];un[kn]=ee(bn,function(ln,gr){return ln.invoke(gr,bn)})}),un}function Ir(It,vr){var rn=It.static,hn=It.dynamic,un={};return Object.keys(rn).forEach(function(kn){var bn=rn[kn],ln=Vt.id(kn),gr=new ui;if(U(bn))gr.state=1,gr.buffer=yr.getBuffer(yr.create(bn,34962,!1,!0)),gr.type=0;else{var dr=yr.getBuffer(bn);if(dr)gr.state=1,gr.buffer=dr,gr.type=0;else if("constant"in bn){var Cr=bn.constant;gr.buffer="null",gr.state=2,typeof Cr=="number"?gr.x=Cr:Ot.forEach(function(aa,da){da<Cr.length&&(gr[aa]=Cr[da])})}else{var dr=U(bn.buffer)?yr.getBuffer(yr.create(bn.buffer,34962,!1,!0)):yr.getBuffer(bn.buffer),dn=bn.offset|0,On=bn.stride|0,qn=bn.size|0,xn=!!bn.normalized,Wn=0;"type"in bn&&(Wn=Le[bn.type]),bn=bn.divisor|0,gr.buffer=dr,gr.state=1,gr.size=qn,gr.normalized=xn,gr.type=Wn||dr.dtype,gr.offset=dn,gr.stride=On,gr.divisor=bn}}un[kn]=Z(function(aa,da){var ma=aa.attribCache;if(ln in ma)return ma[ln];var la={isStream:!1};return Object.keys(gr).forEach(function(Ma){la[Ma]=gr[Ma]}),gr.buffer&&(la.buffer=aa.link(gr.buffer),la.type=la.type||la.buffer+".dtype"),ma[ln]=la})}),Object.keys(hn).forEach(function(kn){var bn=hn[kn];un[kn]=ee(bn,function(ln,gr){function dr(ma){gr(xn[ma],"=",Cr,".",ma,"|0;")}var Cr=ln.invoke(gr,bn),qn=ln.shared,dn=ln.constants,On=qn.isBufferArgs,qn=qn.buffer,xn={isStream:gr.def(!1)},Wn=new ui;Wn.state=1,Object.keys(Wn).forEach(function(ma){xn[ma]=gr.def(""+Wn[ma])});var aa=xn.buffer,da=xn.type;return gr("if(",On,"(",Cr,")){",xn.isStream,"=true;",aa,"=",qn,".createStream(",34962,",",Cr,");",da,"=",aa,".dtype;","}else{",aa,"=",qn,".getBuffer(",Cr,");","if(",aa,"){",da,"=",aa,".dtype;",'}else if("constant" in ',Cr,"){",xn.state,"=",2,";","if(typeof "+Cr+'.constant === "number"){',xn[Ot[0]],"=",Cr,".constant;",Ot.slice(1).map(function(ma){return xn[ma]}).join("="),"=0;","}else{",Ot.map(function(ma,la){return xn[ma]+"="+Cr+".constant.length>"+la+"?"+Cr+".constant["+la+"]:0;"}).join(""),"}}else{","if(",On,"(",Cr,".buffer)){",aa,"=",qn,".createStream(",34962,",",Cr,".buffer);","}else{",aa,"=",qn,".getBuffer(",Cr,".buffer);","}",da,'="type" in ',Cr,"?",dn.glTypes,"[",Cr,".type]:",aa,".dtype;",xn.normalized,"=!!",Cr,".normalized;"),dr("size"),dr("offset"),dr("stride"),dr("divisor"),gr("}}"),gr.exit("if(",xn.isStream,"){",qn,".destroyStream(",aa,");","}"),xn})}),un}function Sr(It){var vr=It.static,rn=It.dynamic,hn={};return Object.keys(vr).forEach(function(un){var kn=vr[un];hn[un]=Z(function(bn,ln){return typeof kn=="number"||typeof kn=="boolean"?""+kn:bn.link(kn)})}),Object.keys(rn).forEach(function(un){var kn=rn[un];hn[un]=ee(kn,function(bn,ln){return bn.invoke(ln,kn)})}),hn}function tt(It,vr,rn,hn,un){function kn(Wn){var aa=ln[Wn];aa&&(dr[Wn]=aa)}var bn=Vr(It,vr),On=an(It),ln=Rr(It,On),gr=xr(It),dr=mr(It),Cr=fn(It,un,bn);kn("viewport"),kn(Wt("scissor.box"));var dn=0<Object.keys(dr).length,On={framebuffer:On,draw:gr,shader:Cr,state:dr,dirty:dn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(On.profile=_r(It),On.uniforms=Fr(rn),On.drawVAO=On.scopeVAO=gr.vao,!On.drawVAO&&Cr.program&&!bn&&jt.angle_instanced_arrays&&gr.static.elements){var qn=!0;if(It=Cr.program.attributes.map(function(Wn){return Wn=vr.static[Wn],qn=qn&&!!Wn,Wn}),qn&&0<It.length){var xn=We.getVAO(We.createVAO({attributes:It,elements:gr.static.elements}));On.drawVAO=new Q(null,null,null,function(Wn,aa){return Wn.link(xn)}),On.useVAO=!0}}return bn?On.useVAO=!0:On.attributes=Ir(vr),On.context=Sr(hn),On}function Ct(It,vr,rn){var hn=It.shared.context,un=It.scope();Object.keys(rn).forEach(function(kn){vr.save(hn,"."+kn);var bn=rn[kn].append(It,vr);Array.isArray(bn)?un(hn,".",kn,"=[",bn.join(),"];"):un(hn,".",kn,"=",bn,";")}),vr(un)}function Zt(It,vr,rn,hn){var ln=It.shared,un=ln.gl,kn=ln.framebuffer,bn;vn&&(bn=vr.def(ln.extensions,".webgl_draw_buffers"));var gr=It.constants,ln=gr.drawBuffer,gr=gr.backBuffer;It=rn?rn.append(It,vr):vr.def(kn,".next"),hn||vr("if(",It,"!==",kn,".cur){"),vr("if(",It,"){",un,".bindFramebuffer(",36160,",",It,".framebuffer);"),vn&&vr(bn,".drawBuffersWEBGL(",ln,"[",It,".colorAttachments.length]);"),vr("}else{",un,".bindFramebuffer(",36160,",null);"),vn&&vr(bn,".drawBuffersWEBGL(",gr,");"),vr("}",kn,".cur=",It,";"),hn||vr("}")}function ur(It,vr,rn){var hn=It.shared,un=hn.gl,kn=It.current,bn=It.next,ln=hn.current,gr=hn.next,dr=It.cond(ln,".dirty");sa.forEach(function(Cr){if(Cr=Wt(Cr),!(Cr in rn.state)){var dn,On;if(Cr in bn){dn=bn[Cr],On=kn[Cr];var qn=i(_n[Cr].length,function(xn){return dr.def(dn,"[",xn,"]")});dr(It.cond(qn.map(function(xn,Wn){return xn+"!=="+On+"["+Wn+"]"}).join("||")).then(un,".",In[Cr],"(",qn,");",qn.map(function(xn,Wn){return On+"["+Wn+"]="+xn}).join(";"),";"))}else dn=dr.def(gr,".",Cr),qn=It.cond(dn,"!==",ln,".",Cr),dr(qn),Cr in ra?qn(It.cond(dn).then(un,".enable(",ra[Cr],");").else(un,".disable(",ra[Cr],");"),ln,".",Cr,"=",dn,";"):qn(un,".",In[Cr],"(",dn,");",ln,".",Cr,"=",dn,";")}}),Object.keys(rn.state).length===0&&dr(ln,".dirty=false;"),vr(dr)}function Lr(It,vr,rn,hn){var un=It.shared,kn=It.current,bn=un.current,ln=un.gl,gr;q(Object.keys(rn)).forEach(function(dr){var Cr=rn[dr];if(!hn||hn(Cr)){var dn=Cr.append(It,vr);if(ra[dr]){var On=ra[dr];W(Cr)?(gr=It.link(dn,{stable:!0}),vr(It.cond(gr).then(ln,".enable(",On,");").else(ln,".disable(",On,");")),vr(bn,".",dr,"=",gr,";")):(vr(It.cond(dn).then(ln,".enable(",On,");").else(ln,".disable(",On,");")),vr(bn,".",dr,"=",dn,";"))}else if(b(dn)){var qn=kn[dr];vr(ln,".",In[dr],"(",dn,");",dn.map(function(xn,Wn){return qn+"["+Wn+"]="+xn}).join(";"),";")}else W(Cr)?(gr=It.link(dn,{stable:!0}),vr(ln,".",In[dr],"(",gr,");",bn,".",dr,"=",gr,";")):vr(ln,".",In[dr],"(",dn,");",bn,".",dr,"=",dn,";")}})}function Br(It,vr){wr&&(It.instancing=vr.def(It.shared.extensions,".angle_instanced_arrays"))}function Pr(It,vr,rn,hn,un){function kn(){return typeof performance=="undefined"?"Date.now()":"performance.now()"}function bn(Wn){qn=vr.def(),Wn(qn,"=",kn(),";"),typeof un=="string"?Wn(Cr,".count+=",un,";"):Wn(Cr,".count++;"),ht&&(hn?(xn=vr.def(),Wn(xn,"=",On,".getNumPendingQueries();")):Wn(On,".beginQuery(",Cr,");"))}function ln(Wn){Wn(Cr,".cpuTime+=",kn(),"-",qn,";"),ht&&(hn?Wn(On,".pushScopeStats(",xn,",",On,".getNumPendingQueries(),",Cr,");"):Wn(On,".endQuery();"))}function gr(Wn){var aa=vr.def(dn,".profile");vr(dn,".profile=",Wn,";"),vr.exit(dn,".profile=",aa,";")}var dr=It.shared,Cr=It.stats,dn=dr.current,On=dr.timer;rn=rn.profile;var qn,xn;if(rn){if(W(rn)){rn.enable?(bn(vr),ln(vr.exit),gr("true")):gr("false");return}rn=rn.append(It,vr),gr(rn)}else rn=vr.def(dn,".profile");dr=It.block(),bn(dr),vr("if(",rn,"){",dr,"}"),It=It.block(),ln(It),vr.exit("if(",rn,"){",It,"}")}function Tr(It,vr,rn,hn,un){function kn(gr){switch(gr){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function bn(gr,dr,Cr){function dn(){vr("if(!",Wn,".buffer){",qn,".enableVertexAttribArray(",xn,");}");var la=Cr.type,Ma;Ma=Cr.size?vr.def(Cr.size,"||",dr):dr,vr("if(",Wn,".type!==",la,"||",Wn,".size!==",Ma,"||",ma.map(function(po){return Wn+"."+po+"!=="+Cr[po]}).join("||"),"){",qn,".bindBuffer(",34962,",",aa,".buffer);",qn,".vertexAttribPointer(",[xn,Ma,la,Cr.normalized,Cr.stride,Cr.offset],");",Wn,".type=",la,";",Wn,".size=",Ma,";",ma.map(function(po){return Wn+"."+po+"="+Cr[po]+";"}).join(""),"}"),wr&&(la=Cr.divisor,vr("if(",Wn,".divisor!==",la,"){",It.instancing,".vertexAttribDivisorANGLE(",[xn,la],");",Wn,".divisor=",la,";}"))}function On(){vr("if(",Wn,".buffer){",qn,".disableVertexAttribArray(",xn,");",Wn,".buffer=null;","}if(",Ot.map(function(la,Ma){return Wn+"."+la+"!=="+da[Ma]}).join("||"),"){",qn,".vertexAttrib4f(",xn,",",da,");",Ot.map(function(la,Ma){return Wn+"."+la+"="+da[Ma]+";"}).join(""),"}")}var qn=ln.gl,xn=vr.def(gr,".location"),Wn=vr.def(ln.attributes,"[",xn,"]");gr=Cr.state;var aa=Cr.buffer,da=[Cr.x,Cr.y,Cr.z,Cr.w],ma=["buffer","normalized","offset","stride"];gr===1?dn():gr===2?On():(vr("if(",gr,"===",1,"){"),dn(),vr("}else{"),On(),vr("}"))}var ln=It.shared;hn.forEach(function(gr){var dr=gr.name,Cr=rn.attributes[dr],dn;if(Cr){if(!un(Cr))return;dn=Cr.append(It,vr)}else{if(!un(cn))return;var On=It.scopeAttrib(dr);dn={},Object.keys(new ui).forEach(function(qn){dn[qn]=vr.def(On,".",qn)})}bn(It.link(gr),kn(gr.info.type),dn)})}function jr(It,vr,rn,hn,un,kn){for(var bn=It.shared,ln=bn.gl,gr,dr=0;dr<hn.length;++dr){var qn=hn[dr],Cr=qn.name,dn=qn.info.type,On=rn.uniforms[Cr],qn=It.link(qn)+".location",xn;if(On){if(!un(On))continue;if(W(On)){if(Cr=On.value,dn===35678||dn===35680)dn=It.link(Cr._texture||Cr.color[0]._texture),vr(ln,".uniform1i(",qn,",",dn+".bind());"),vr.exit(dn,".unbind();");else if(dn===35674||dn===35675||dn===35676)Cr=It.global.def("new Float32Array(["+Array.prototype.slice.call(Cr)+"])"),On=2,dn===35675?On=3:dn===35676&&(On=4),vr(ln,".uniformMatrix",On,"fv(",qn,",false,",Cr,");");else{switch(dn){case 5126:gr="1f";break;case 35664:gr="2f";break;case 35665:gr="3f";break;case 35666:gr="4f";break;case 35670:gr="1i";break;case 5124:gr="1i";break;case 35671:gr="2i";break;case 35667:gr="2i";break;case 35672:gr="3i";break;case 35668:gr="3i";break;case 35673:gr="4i";break;case 35669:gr="4i"}vr(ln,".uniform",gr,"(",qn,",",b(Cr)?Array.prototype.slice.call(Cr):Cr,");")}continue}else xn=On.append(It,vr)}else{if(!un(cn))continue;xn=vr.def(bn.uniforms,"[",Vt.id(Cr),"]")}switch(dn===35678?vr("if(",xn,"&&",xn,'._reglType==="framebuffer"){',xn,"=",xn,".color[0];","}"):dn===35680&&vr("if(",xn,"&&",xn,'._reglType==="framebufferCube"){',xn,"=",xn,".color[0];","}"),Cr=1,dn){case 35678:case 35680:dn=vr.def(xn,"._texture"),vr(ln,".uniform1i(",qn,",",dn,".bind());"),vr.exit(dn,".unbind();");continue;case 5124:case 35670:gr="1i";break;case 35667:case 35671:gr="2i",Cr=2;break;case 35668:case 35672:gr="3i",Cr=3;break;case 35669:case 35673:gr="4i",Cr=4;break;case 5126:gr="1f";break;case 35664:gr="2f",Cr=2;break;case 35665:gr="3f",Cr=3;break;case 35666:gr="4f",Cr=4;break;case 35674:gr="Matrix2fv";break;case 35675:gr="Matrix3fv";break;case 35676:gr="Matrix4fv"}if(gr.charAt(0)==="M"){vr(ln,".uniform",gr,"(",qn,",");var qn=Math.pow(dn-35674+2,2),Wn=It.global.def("new Float32Array(",qn,")");Array.isArray(xn)?vr("false,(",i(qn,function(ma){return Wn+"["+ma+"]="+xn[ma]}),",",Wn,")"):vr("false,(Array.isArray(",xn,")||",xn," instanceof Float32Array)?",xn,":(",i(qn,function(ma){return Wn+"["+ma+"]="+xn+"["+ma+"]"}),",",Wn,")"),vr(");")}else{if(1<Cr){for(var dn=[],aa=[],On=0;On<Cr;++On)Array.isArray(xn)?aa.push(xn[On]):aa.push(vr.def(xn+"["+On+"]")),kn&&dn.push(vr.def());kn&&vr("if(!",It.batchId,"||",dn.map(function(da,ma){return da+"!=="+aa[ma]}).join("||"),"){",dn.map(function(da,ma){return da+"="+aa[ma]+";"}).join("")),vr(ln,".uniform",gr,"(",qn,",",aa.join(","),");")}else kn&&(dn=vr.def(),vr("if(!",It.batchId,"||",dn,"!==",xn,"){",dn,"=",xn,";")),vr(ln,".uniform",gr,"(",qn,",",xn,");");kn&&vr("}")}}}function Pn(It,vr,rn,hn){function un(la){var Ma=Cr[la];return Ma?Ma.contextDep&&hn.contextDynamic||Ma.propDep?Ma.append(It,rn):Ma.append(It,vr):vr.def(dr,".",la)}function kn(){function la(){rn(aa,".drawElementsInstancedANGLE(",[On,xn,da,qn+"<<(("+da+"-5121)>>1)",Wn],");")}function Ma(){rn(aa,".drawArraysInstancedANGLE(",[On,qn,xn,Wn],");")}dn&&dn!=="null"?ma?la():(rn("if(",dn,"){"),la(),rn("}else{"),Ma(),rn("}")):Ma()}function bn(){function la(){rn(gr+".drawElements("+[On,xn,da,qn+"<<(("+da+"-5121)>>1)"]+");")}function Ma(){rn(gr+".drawArrays("+[On,qn,xn]+");")}dn&&dn!=="null"?ma?la():(rn("if(",dn,"){"),la(),rn("}else{"),Ma(),rn("}")):Ma()}var ln=It.shared,gr=ln.gl,dr=ln.draw,Cr=hn.draw,dn=function(){var la=Cr.elements,Ma=vr;return la?((la.contextDep&&hn.contextDynamic||la.propDep)&&(Ma=rn),la=la.append(It,Ma),Cr.elementsActive&&Ma("if("+la+")"+gr+".bindBuffer(34963,"+la+".buffer.buffer);")):(la=Ma.def(),Ma(la,"=",dr,".","elements",";","if(",la,"){",gr,".bindBuffer(",34963,",",la,".buffer.buffer);}","else if(",ln.vao,".currentVAO){",la,"=",It.shared.elements+".getElements("+ln.vao,".currentVAO.elements);",on?"":"if("+la+")"+gr+".bindBuffer(34963,"+la+".buffer.buffer);","}")),la}(),On=un("primitive"),qn=un("offset"),xn=function(){var la=Cr.count,Ma=vr;return la?((la.contextDep&&hn.contextDynamic||la.propDep)&&(Ma=rn),la=la.append(It,Ma)):la=Ma.def(dr,".","count"),la}();if(typeof xn=="number"){if(xn===0)return}else rn("if(",xn,"){"),rn.exit("}");var Wn,aa;wr&&(Wn=un("instances"),aa=It.instancing);var da=dn+".type",ma=Cr.elements&&W(Cr.elements)&&!Cr.vaoActive;wr&&(typeof Wn!="number"||0<=Wn)?typeof Wn=="string"?(rn("if(",Wn,">0){"),kn(),rn("}else if(",Wn,"<0){"),bn(),rn("}")):kn():bn()}function An(It,vr,rn,hn,un){return vr=hr(),un=vr.proc("body",un),wr&&(vr.instancing=un.def(vr.shared.extensions,".angle_instanced_arrays")),It(vr,un,rn,hn),vr.compile().body}function $n(It,vr,rn,hn){Br(It,vr),rn.useVAO?rn.drawVAO?vr(It.shared.vao,".setVAO(",rn.drawVAO.append(It,vr),");"):vr(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(vr(It.shared.vao,".setVAO(null);"),Tr(It,vr,rn,hn.attributes,function(){return!0})),jr(It,vr,rn,hn.uniforms,function(){return!0},!1),Pn(It,vr,vr,rn)}function zn(It,vr){var rn=It.proc("draw",1);Br(It,rn),Ct(It,rn,vr.context),Zt(It,rn,vr.framebuffer),ur(It,rn,vr),Lr(It,rn,vr.state),Pr(It,rn,vr,!1,!0);var hn=vr.shader.progVar.append(It,rn);if(rn(It.shared.gl,".useProgram(",hn,".program);"),vr.shader.program)$n(It,rn,vr,vr.shader.program);else{rn(It.shared.vao,".setVAO(null);");var un=It.global.def("{}"),kn=rn.def(hn,".id"),bn=rn.def(un,"[",kn,"]");rn(It.cond(bn).then(bn,".call(this,a0);").else(bn,"=",un,"[",kn,"]=",It.link(function(ln){return An($n,It,vr,ln,1)}),"(",hn,");",bn,".call(this,a0);"))}0<Object.keys(vr.state).length&&rn(It.shared.current,".dirty=true;"),It.shared.vao&&rn(It.shared.vao,".setVAO(null);")}function Yn(It,vr,rn,hn){function un(){return!0}It.batchId="a1",Br(It,vr),Tr(It,vr,rn,hn.attributes,un),jr(It,vr,rn,hn.uniforms,un,!1),Pn(It,vr,vr,rn)}function Kn(It,vr,rn,hn){function un(dn){return dn.contextDep&&bn||dn.propDep}function kn(dn){return!un(dn)}Br(It,vr);var bn=rn.contextDep,ln=vr.def(),gr=vr.def();It.shared.props=gr,It.batchId=ln;var dr=It.scope(),Cr=It.scope();vr(dr.entry,"for(",ln,"=0;",ln,"<","a1",";++",ln,"){",gr,"=","a0","[",ln,"];",Cr,"}",dr.exit),rn.needsContext&&Ct(It,Cr,rn.context),rn.needsFramebuffer&&Zt(It,Cr,rn.framebuffer),Lr(It,Cr,rn.state,un),rn.profile&&un(rn.profile)&&Pr(It,Cr,rn,!1,!0),hn?(rn.useVAO?rn.drawVAO?un(rn.drawVAO)?Cr(It.shared.vao,".setVAO(",rn.drawVAO.append(It,Cr),");"):dr(It.shared.vao,".setVAO(",rn.drawVAO.append(It,dr),");"):dr(It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"):(dr(It.shared.vao,".setVAO(null);"),Tr(It,dr,rn,hn.attributes,kn),Tr(It,Cr,rn,hn.attributes,un)),jr(It,dr,rn,hn.uniforms,kn,!1),jr(It,Cr,rn,hn.uniforms,un,!0),Pn(It,dr,Cr,rn)):(vr=It.global.def("{}"),hn=rn.shader.progVar.append(It,Cr),gr=Cr.def(hn,".id"),dr=Cr.def(vr,"[",gr,"]"),Cr(It.shared.gl,".useProgram(",hn,".program);","if(!",dr,"){",dr,"=",vr,"[",gr,"]=",It.link(function(dn){return An(Yn,It,rn,dn,2)}),"(",hn,");}",dr,".call(this,a0[",ln,"],",ln,");"))}function Aa(It,vr){function rn(dr){return dr.contextDep&&un||dr.propDep}var hn=It.proc("batch",2);It.batchId="0",Br(It,hn);var un=!1,kn=!0;Object.keys(vr.context).forEach(function(dr){un=un||vr.context[dr].propDep}),un||(Ct(It,hn,vr.context),kn=!1);var bn=vr.framebuffer,ln=!1;if(bn?(bn.propDep?un=ln=!0:bn.contextDep&&un&&(ln=!0),ln||Zt(It,hn,bn)):Zt(It,hn,null),vr.state.viewport&&vr.state.viewport.propDep&&(un=!0),ur(It,hn,vr),Lr(It,hn,vr.state,function(dr){return!rn(dr)}),vr.profile&&rn(vr.profile)||Pr(It,hn,vr,!1,"a1"),vr.contextDep=un,vr.needsContext=kn,vr.needsFramebuffer=ln,kn=vr.shader.progVar,kn.contextDep&&un||kn.propDep)Kn(It,hn,vr,null);else if(kn=kn.append(It,hn),hn(It.shared.gl,".useProgram(",kn,".program);"),vr.shader.program)Kn(It,hn,vr,vr.shader.program);else{hn(It.shared.vao,".setVAO(null);");var bn=It.global.def("{}"),ln=hn.def(kn,".id"),gr=hn.def(bn,"[",ln,"]");hn(It.cond(gr).then(gr,".call(this,a0,a1);").else(gr,"=",bn,"[",ln,"]=",It.link(function(dn){return An(Kn,It,vr,dn,2)}),"(",kn,");",gr,".call(this,a0,a1);"))}0<Object.keys(vr.state).length&&hn(It.shared.current,".dirty=true;"),It.shared.vao&&hn(It.shared.vao,".setVAO(null);")}function Ua(It,vr){function rn(ln){var gr=vr.shader[ln];gr&&(gr=gr.append(It,hn),isNaN(gr)?hn.set(un.shader,"."+ln,gr):hn.set(un.shader,"."+ln,It.link(gr,{stable:!0})))}var hn=It.proc("scope",3);It.batchId="a2";var un=It.shared,kn=un.current;if(Ct(It,hn,vr.context),vr.framebuffer&&vr.framebuffer.append(It,hn),q(Object.keys(vr.state)).forEach(function(ln){var gr=vr.state[ln],dr=gr.append(It,hn);b(dr)?dr.forEach(function(Cr,dn){isNaN(Cr)?hn.set(It.next[ln],"["+dn+"]",Cr):hn.set(It.next[ln],"["+dn+"]",It.link(Cr,{stable:!0}))}):W(gr)?hn.set(un.next,"."+ln,It.link(dr,{stable:!0})):hn.set(un.next,"."+ln,dr)}),Pr(It,hn,vr,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(ln){var gr=vr.draw[ln];gr&&(gr=gr.append(It,hn),isNaN(gr)?hn.set(un.draw,"."+ln,gr):hn.set(un.draw,"."+ln,It.link(gr),{stable:!0}))}),Object.keys(vr.uniforms).forEach(function(ln){var gr=vr.uniforms[ln].append(It,hn);Array.isArray(gr)&&(gr="["+gr.map(function(dr){return isNaN(dr)?dr:It.link(dr,{stable:!0})})+"]"),hn.set(un.uniforms,"["+It.link(Vt.id(ln),{stable:!0})+"]",gr)}),Object.keys(vr.attributes).forEach(function(ln){var gr=vr.attributes[ln].append(It,hn),dr=It.scopeAttrib(ln);Object.keys(new ui).forEach(function(Cr){hn.set(dr,"."+Cr,gr[Cr])})}),vr.scopeVAO){var bn=vr.scopeVAO.append(It,hn);isNaN(bn)?hn.set(un.vao,".targetVAO",bn):hn.set(un.vao,".targetVAO",It.link(bn,{stable:!0}))}rn("vert"),rn("frag"),0<Object.keys(vr.state).length&&(hn(kn,".dirty=true;"),hn.exit(kn,".dirty=true;")),hn("a1(",It.shared.context,",a0,",It.batchId,");")}function vi(It){if(typeof It=="object"&&!b(It)){for(var vr=Object.keys(It),rn=0;rn<vr.length;++rn)if(fe.isDynamic(It[vr[rn]]))return!0;return!1}}function ci(It,vr,rn){function hn(dn,On){bn.forEach(function(qn){var xn=un[qn];fe.isDynamic(xn)&&(xn=dn.invoke(On,xn),On(Cr,".",qn,"=",xn,";"))})}var un=vr.static[rn];if(un&&vi(un)){var kn=It.global,bn=Object.keys(un),ln=!1,gr=!1,dr=!1,Cr=It.global.def("{}");bn.forEach(function(dn){var On=un[dn];if(fe.isDynamic(On))typeof On=="function"&&(On=un[dn]=fe.unbox(On)),dn=ee(On,null),ln=ln||dn.thisDep,dr=dr||dn.propDep,gr=gr||dn.contextDep;else{switch(kn(Cr,".",dn,"="),typeof On){case"number":kn(On);break;case"string":kn('"',On,'"');break;case"object":Array.isArray(On)&&kn("[",On.join(),"]");break;default:kn(It.link(On))}kn(";")}}),vr.dynamic[rn]=new fe.DynamicVariable(4,{thisDep:ln,contextDep:gr,propDep:dr,ref:Cr,append:hn}),delete vr.static[rn]}}var ui=We.Record,Ga={add:32774,subtract:32778,"reverse subtract":32779};jt.ext_blend_minmax&&(Ga.min=32775,Ga.max=32776);var wr=jt.angle_instanced_arrays,vn=jt.webgl_draw_buffers,on=jt.oes_vertex_array_object,_n={dirty:!0,profile:kt.profile},Bn={},sa=[],ra={},In={};Ft("dither",3024),Ft("blend.enable",3042),ir("blend.color","blendColor",[0,0,0,0]),ir("blend.equation","blendEquationSeparate",[32774,32774]),ir("blend.func","blendFuncSeparate",[1,0,1,0]),Ft("depth.enable",2929,!0),ir("depth.func","depthFunc",513),ir("depth.range","depthRange",[0,1]),ir("depth.mask","depthMask",!0),ir("colorMask","colorMask",[!0,!0,!0,!0]),Ft("cull.enable",2884),ir("cull.face","cullFace",1029),ir("frontFace","frontFace",2305),ir("lineWidth","lineWidth",1),Ft("polygonOffset.enable",32823),ir("polygonOffset.offset","polygonOffset",[0,0]),Ft("sample.alpha",32926),Ft("sample.enable",32928),ir("sample.coverage","sampleCoverage",[1,!1]),Ft("stencil.enable",2960),ir("stencil.mask","stencilMask",-1),ir("stencil.func","stencilFunc",[519,0,-1]),ir("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),ir("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),Ft("scissor.enable",3089),ir("scissor.box","scissor",[0,0,ot.drawingBufferWidth,ot.drawingBufferHeight]),ir("viewport","viewport",[0,0,ot.drawingBufferWidth,ot.drawingBufferHeight]);var ea={gl:ot,context:$e,strings:Vt,next:Bn,current:_n,draw:rt,elements:nt,buffer:yr,shader:Qe,attributes:We.state,vao:We,uniforms:Ne,framebuffer:Me,extensions:jt,timer:ht,isBufferArgs:U},Va={primTypes:Ue,compareFuncs:qt,blendFuncs:tr,blendEquations:Ga,stencilOps:lr,glTypes:Le,orientationType:Wr};vn&&(Va.backBuffer=[1029],Va.drawBuffer=i(Ut.maxDrawbuffers,function(It){return It===0?[0]:i(It,function(vr){return 36064+vr})}));var hi=0;return{next:Bn,current:_n,procs:function(){var It=hr(),vr=It.proc("poll"),rn=It.proc("refresh"),hn=It.block();vr(hn),rn(hn);var gr=It.shared,un=gr.gl,kn=gr.next,bn=gr.current;hn(bn,".dirty=false;"),Zt(It,vr),Zt(It,rn,null,!0);var ln;wr&&(ln=It.link(wr)),jt.oes_vertex_array_object&&rn(It.link(jt.oes_vertex_array_object),".bindVertexArrayOES(null);");var gr=rn.def(gr.attributes),dr=rn.def(0),Cr=It.cond(dr,".buffer");Cr.then(un,".enableVertexAttribArray(i);",un,".bindBuffer(",34962,",",dr,".buffer.buffer);",un,".vertexAttribPointer(i,",dr,".size,",dr,".type,",dr,".normalized,",dr,".stride,",dr,".offset);").else(un,".disableVertexAttribArray(i);",un,".vertexAttrib4f(i,",dr,".x,",dr,".y,",dr,".z,",dr,".w);",dr,".buffer=null;");var dn=It.link(Ut.maxAttributes,{stable:!0});return rn("for(var i=0;i<",dn,";++i){",dr,"=",gr,"[i];",Cr,"}"),wr&&rn("for(var i=0;i<",dn,";++i){",ln,".vertexAttribDivisorANGLE(i,",gr,"[i].divisor);","}"),rn(It.shared.vao,".currentVAO=null;",It.shared.vao,".setVAO(",It.shared.vao,".targetVAO);"),Object.keys(ra).forEach(function(On){var qn=ra[On],xn=hn.def(kn,".",On),Wn=It.block();Wn("if(",xn,"){",un,".enable(",qn,")}else{",un,".disable(",qn,")}",bn,".",On,"=",xn,";"),rn(Wn),vr("if(",xn,"!==",bn,".",On,"){",Wn,"}")}),Object.keys(In).forEach(function(On){var qn=In[On],xn=_n[On],Wn,aa,da=It.block();da(un,".",qn,"("),b(xn)?(qn=xn.length,Wn=It.global.def(kn,".",On),aa=It.global.def(bn,".",On),da(i(qn,function(ma){return Wn+"["+ma+"]"}),");",i(qn,function(ma){return aa+"["+ma+"]="+Wn+"["+ma+"];"}).join("")),vr("if(",i(qn,function(ma){return Wn+"["+ma+"]!=="+aa+"["+ma+"]"}).join("||"),"){",da,"}")):(Wn=hn.def(kn,".",On),aa=hn.def(bn,".",On),da(Wn,");",bn,".",On,"=",Wn,";"),vr("if(",Wn,"!==",aa,"){",da,"}")),rn(da)}),It.compile()}(),compile:function(It,vr,rn,hn,un){var kn=hr();kn.stats=kn.link(un),Object.keys(vr.static).forEach(function(ln){ci(kn,vr,ln)}),Qt.forEach(function(ln){ci(kn,It,ln)});var bn=tt(It,vr,rn,hn,kn);return bn.shader.program&&(bn.shader.program.attributes.sort(function(ln,gr){return ln.name<gr.name?-1:1}),bn.shader.program.uniforms.sort(function(ln,gr){return ln.name<gr.name?-1:1})),zn(kn,bn),Ua(kn,bn),Aa(kn,bn),le(kn.compile(),{destroy:function(){bn.shader.program.destroy()}})}}}function ae(ot,Vt){for(var jt=0;jt<ot.length;++jt)if(ot[jt]===Vt)return jt;return-1}var le=function(ot,Vt){for(var jt=Object.keys(Vt),Ut=0;Ut<jt.length;++Ut)ot[jt[Ut]]=Vt[jt[Ut]];return ot},ye=0,fe={DynamicVariable:w,define:function(ot,Vt){return new w(ot,M(Vt+""))},isDynamic:function(ot){return typeof ot=="function"&&!ot._reglType||ot instanceof w},unbox:T,accessor:M},pe={next:typeof requestAnimationFrame=="function"?function(ot){return requestAnimationFrame(ot)}:function(ot){return setTimeout(ot,16)},cancel:typeof cancelAnimationFrame=="function"?function(ot){return cancelAnimationFrame(ot)}:clearTimeout},ge=typeof performance!="undefined"&&performance.now?function(){return performance.now()}:function(){return+new Date},Ae=p();Ae.zero=p();var we=function(ot,Vt){var jt=1;Vt.ext_texture_filter_anisotropic&&(jt=ot.getParameter(34047));var Ut=1,yr=1;Vt.webgl_draw_buffers&&(Ut=ot.getParameter(34852),yr=ot.getParameter(36063));var nt=!!Vt.oes_texture_float;if(nt){nt=ot.createTexture(),ot.bindTexture(3553,nt),ot.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var _e=ot.createFramebuffer();if(ot.bindFramebuffer(36160,_e),ot.framebufferTexture2D(36160,36064,3553,nt,0),ot.bindTexture(3553,null),ot.checkFramebufferStatus(36160)!==36053)nt=!1;else{ot.viewport(0,0,1,1),ot.clearColor(1,0,0,1),ot.clear(16384);var Me=Ae.allocType(5126,4);ot.readPixels(0,0,1,1,6408,5126,Me),ot.getError()?nt=!1:(ot.deleteFramebuffer(_e),ot.deleteTexture(nt),nt=Me[0]===1),Ae.freeType(Me)}}return Me=!0,typeof navigator!="undefined"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(Me=ot.createTexture(),_e=Ae.allocType(5121,36),ot.activeTexture(33984),ot.bindTexture(34067,Me),ot.texImage2D(34069,0,6408,3,3,0,6408,5121,_e),Ae.freeType(_e),ot.bindTexture(34067,null),ot.deleteTexture(Me),Me=!ot.getError()),{colorBits:[ot.getParameter(3410),ot.getParameter(3411),ot.getParameter(3412),ot.getParameter(3413)],depthBits:ot.getParameter(3414),stencilBits:ot.getParameter(3415),subpixelBits:ot.getParameter(3408),extensions:Object.keys(Vt).filter(function(Ne){return!!Vt[Ne]}),maxAnisotropic:jt,maxDrawbuffers:Ut,maxColorAttachments:yr,pointSizeDims:ot.getParameter(33901),lineWidthDims:ot.getParameter(33902),maxViewportDims:ot.getParameter(3386),maxCombinedTextureUnits:ot.getParameter(35661),maxCubeMapSize:ot.getParameter(34076),maxRenderbufferSize:ot.getParameter(34024),maxTextureUnits:ot.getParameter(34930),maxTextureSize:ot.getParameter(3379),maxAttributes:ot.getParameter(34921),maxVertexUniforms:ot.getParameter(36347),maxVertexTextureUnits:ot.getParameter(35660),maxVaryingVectors:ot.getParameter(36348),maxFragmentUniforms:ot.getParameter(36349),glsl:ot.getParameter(35724),renderer:ot.getParameter(7937),vendor:ot.getParameter(7936),version:ot.getParameter(7938),readFloat:nt,npotTextureCube:Me}},De=function(ot){return ot instanceof Uint8Array||ot instanceof Uint16Array||ot instanceof Uint32Array||ot instanceof Int8Array||ot instanceof Int16Array||ot instanceof Int32Array||ot instanceof Float32Array||ot instanceof Float64Array||ot instanceof Uint8ClampedArray},Be=function(ot){return Object.keys(ot).map(function(Vt){return ot[Vt]})},Ve={shape:function(ot){for(var Vt=[];ot.length;ot=ot[0])Vt.push(ot.length);return Vt},flatten:function(ot,Vt,jt,Ut){var yr=1;if(Vt.length)for(var nt=0;nt<Vt.length;++nt)yr*=Vt[nt];else yr=0;switch(jt=Ut||Ae.allocType(jt,yr),Vt.length){case 0:break;case 1:for(Ut=Vt[0],Vt=0;Vt<Ut;++Vt)jt[Vt]=ot[Vt];break;case 2:for(Ut=Vt[0],Vt=Vt[1],nt=yr=0;nt<Ut;++nt)for(var _e=ot[nt],Me=0;Me<Vt;++Me)jt[yr++]=_e[Me];break;case 3:h(ot,Vt[0],Vt[1],Vt[2],jt,0);break;default:m(ot,Vt,0,jt,0)}return jt}},xe={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Le={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},He={dynamic:35048,stream:35040,static:35044},Je=Ve.flatten,Oe=Ve.shape,Pe=[];Pe[5120]=1,Pe[5122]=2,Pe[5124]=4,Pe[5121]=1,Pe[5123]=2,Pe[5125]=4,Pe[5126]=4;var Ue={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},vt=new Float32Array(1),Lt=new Uint32Array(vt.buffer),Yt=[9984,9986,9985,9987],At=[0,6409,6410,6407,6408],Rt={};Rt[6409]=Rt[6406]=Rt[6402]=1,Rt[34041]=Rt[6410]=2,Rt[6407]=Rt[35904]=3,Rt[6408]=Rt[35906]=4;var Bt=l("HTMLCanvasElement"),Mt=l("OffscreenCanvas"),Tt=l("CanvasRenderingContext2D"),at=l("ImageBitmap"),ct=l("HTMLImageElement"),je=l("HTMLVideoElement"),ke=Object.keys(xe).concat([Bt,Mt,Tt,at,ct,je]),Ye=[];Ye[5121]=1,Ye[5126]=4,Ye[36193]=2,Ye[5123]=2,Ye[5125]=4;var Ke=[];Ke[32854]=2,Ke[32855]=2,Ke[36194]=2,Ke[34041]=4,Ke[33776]=.5,Ke[33777]=.5,Ke[33778]=1,Ke[33779]=1,Ke[35986]=.5,Ke[35987]=1,Ke[34798]=1,Ke[35840]=.5,Ke[35841]=.25,Ke[35842]=.5,Ke[35843]=.25,Ke[36196]=.5;var st=[];st[32854]=2,st[32855]=2,st[36194]=2,st[33189]=2,st[36168]=1,st[34041]=4,st[35907]=4,st[34836]=16,st[34842]=8,st[34843]=6;var Et=function(ot,Vt,jt,Ut,yr){function nt(rt){this.id=We++,this.refCount=1,this.renderbuffer=rt,this.format=32854,this.height=this.width=0,yr.profile&&(this.stats={size:0})}function _e(rt){var $e=rt.renderbuffer;ot.bindRenderbuffer(36161,null),ot.deleteRenderbuffer($e),rt.renderbuffer=null,rt.refCount=0,delete Qe[rt.id],Ut.renderbufferCount--}var Me={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};Vt.ext_srgb&&(Me.srgba=35907),Vt.ext_color_buffer_half_float&&(Me.rgba16f=34842,Me.rgb16f=34843),Vt.webgl_color_buffer_float&&(Me.rgba32f=34836);var Ne=[];Object.keys(Me).forEach(function(rt){Ne[Me[rt]]=rt});var We=0,Qe={};return nt.prototype.decRef=function(){0>=--this.refCount&&_e(this)},yr.profile&&(Ut.getTotalRenderbufferSize=function(){var rt=0;return Object.keys(Qe).forEach(function($e){rt+=Qe[$e].stats.size}),rt}),{create:function(rt,$e){function ht(kt,Wt){var Ft=0,ir=0,hr=32854;if(typeof kt=="object"&&kt?("shape"in kt?(ir=kt.shape,Ft=ir[0]|0,ir=ir[1]|0):("radius"in kt&&(Ft=ir=kt.radius|0),"width"in kt&&(Ft=kt.width|0),"height"in kt&&(ir=kt.height|0)),"format"in kt&&(hr=Me[kt.format])):typeof kt=="number"?(Ft=kt|0,ir=typeof Wt=="number"?Wt|0:Ft):kt||(Ft=ir=1),Ft!==xt.width||ir!==xt.height||hr!==xt.format)return ht.width=xt.width=Ft,ht.height=xt.height=ir,xt.format=hr,ot.bindRenderbuffer(36161,xt.renderbuffer),ot.renderbufferStorage(36161,hr,Ft,ir),yr.profile&&(xt.stats.size=st[xt.format]*xt.width*xt.height),ht.format=Ne[xt.format],ht}var xt=new nt(ot.createRenderbuffer());return Qe[xt.id]=xt,Ut.renderbufferCount++,ht(rt,$e),ht.resize=function(kt,Wt){var Ft=kt|0,ir=Wt|0||Ft;return Ft===xt.width&&ir===xt.height||(ht.width=xt.width=Ft,ht.height=xt.height=ir,ot.bindRenderbuffer(36161,xt.renderbuffer),ot.renderbufferStorage(36161,xt.format,Ft,ir),yr.profile&&(xt.stats.size=st[xt.format]*xt.width*xt.height)),ht},ht._reglType="renderbuffer",ht._renderbuffer=xt,yr.profile&&(ht.stats=xt.stats),ht.destroy=function(){xt.decRef()},ht},clear:function(){Be(Qe).forEach(_e)},restore:function(){Be(Qe).forEach(function(rt){rt.renderbuffer=ot.createRenderbuffer(),ot.bindRenderbuffer(36161,rt.renderbuffer),ot.renderbufferStorage(36161,rt.format,rt.width,rt.height)}),ot.bindRenderbuffer(36161,null)}}},bt=[];bt[6408]=4,bt[6407]=3;var zt=[];zt[5121]=1,zt[5126]=4,zt[36193]=2;var $t=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Ot=["x","y","z","w"],Qt="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),tr={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},qt={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},lr={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Wr={cw:2304,ccw:2305},cn=new Q(!1,!1,!1,function(){}),Jr=function(ot,Vt){function jt(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function Ut(Qe,rt,$e){var ht=_e.pop()||new jt;ht.startQueryIndex=Qe,ht.endQueryIndex=rt,ht.sum=0,ht.stats=$e,Me.push(ht)}if(!Vt.ext_disjoint_timer_query)return null;var yr=[],nt=[],_e=[],Me=[],Ne=[],We=[];return{beginQuery:function(Qe){var rt=yr.pop()||Vt.ext_disjoint_timer_query.createQueryEXT();Vt.ext_disjoint_timer_query.beginQueryEXT(35007,rt),nt.push(rt),Ut(nt.length-1,nt.length,Qe)},endQuery:function(){Vt.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:Ut,update:function(){var Qe,rt;if(Qe=nt.length,Qe!==0){We.length=Math.max(We.length,Qe+1),Ne.length=Math.max(Ne.length,Qe+1),Ne[0]=0;var $e=We[0]=0;for(rt=Qe=0;rt<nt.length;++rt){var ht=nt[rt];Vt.ext_disjoint_timer_query.getQueryObjectEXT(ht,34919)?($e+=Vt.ext_disjoint_timer_query.getQueryObjectEXT(ht,34918),yr.push(ht)):nt[Qe++]=ht,Ne[rt+1]=$e,We[rt+1]=Qe}for(nt.length=Qe,rt=Qe=0;rt<Me.length;++rt){var $e=Me[rt],xt=$e.startQueryIndex,ht=$e.endQueryIndex;$e.sum+=Ne[ht]-Ne[xt],xt=We[xt],ht=We[ht],ht===xt?($e.stats.gpuTime+=$e.sum/1e6,_e.push($e)):($e.startQueryIndex=xt,$e.endQueryIndex=ht,Me[Qe++]=$e)}Me.length=Qe}},getNumPendingQueries:function(){return nt.length},clear:function(){yr.push.apply(yr,nt);for(var Qe=0;Qe<yr.length;Qe++)Vt.ext_disjoint_timer_query.deleteQueryEXT(yr[Qe]);nt.length=0,yr.length=0},restore:function(){nt.length=0,yr.length=0}}};return function(ot){function Vt(){if(Pr.length===0)hr&&hr.update(),An=null;else{An=pe.next(Vt),Qe();for(var zn=Pr.length-1;0<=zn;--zn){var Yn=Pr[zn];Yn&&Yn(Rr,null,0)}ht.flush(),hr&&hr.update()}}function jt(){!An&&0<Pr.length&&(An=pe.next(Vt))}function Ut(){An&&(pe.cancel(Vt),An=null)}function yr(zn){zn.preventDefault(),Ut(),Tr.forEach(function(Yn){Yn()})}function nt(zn){ht.getError(),kt.restore(),Ir.restore(),xr.restore(),Sr.restore(),tt.restore(),Ct.restore(),Fr.restore(),hr&&hr.restore(),Zt.procs.refresh(),jt(),jr.forEach(function(Yn){Yn()})}function _e(zn){function Yn(_n,Bn){var sa={},ra={};return Object.keys(_n).forEach(function(In){var ea=_n[In];if(fe.isDynamic(ea))ra[In]=fe.unbox(ea,In);else{if(Bn&&Array.isArray(ea)){for(var Va=0;Va<ea.length;++Va)if(fe.isDynamic(ea[Va])){ra[In]=fe.unbox(ea,In);return}}sa[In]=ea}}),{dynamic:ra,static:sa}}function Kn(_n){for(;on.length<_n;)on.push(null);return on}var Aa=Yn(zn.context||{},!0),Ua=Yn(zn.uniforms||{},!0),vi=Yn(zn.attributes||{},!1);zn=Yn(function(_n){function Bn(ra){if(ra in sa){var In=sa[ra];delete sa[ra],Object.keys(In).forEach(function(ea){sa[ra+"."+ea]=In[ea]})}}var sa=le({},_n);return delete sa.uniforms,delete sa.attributes,delete sa.context,delete sa.vao,"stencil"in sa&&sa.stencil.op&&(sa.stencil.opBack=sa.stencil.opFront=sa.stencil.op,delete sa.stencil.op),Bn("blend"),Bn("depth"),Bn("cull"),Bn("stencil"),Bn("polygonOffset"),Bn("scissor"),Bn("sample"),"vao"in _n&&(sa.vao=_n.vao),sa}(zn),!1);var ci={gpuTime:0,cpuTime:0,count:0},ui=Zt.compile(zn,vi,Ua,Aa,ci),Ga=ui.draw,wr=ui.batch,vn=ui.scope,on=[];return le(function(_n,Bn){var sa;if(typeof _n=="function")return vn.call(this,null,_n,0);if(typeof Bn=="function")if(typeof _n=="number")for(sa=0;sa<_n;++sa)vn.call(this,null,Bn,sa);else if(Array.isArray(_n))for(sa=0;sa<_n.length;++sa)vn.call(this,_n[sa],Bn,sa);else return vn.call(this,_n,Bn,0);else if(typeof _n=="number"){if(0<_n)return wr.call(this,Kn(_n|0),_n|0)}else if(Array.isArray(_n)){if(_n.length)return wr.call(this,_n,_n.length)}else return Ga.call(this,_n)},{stats:ci,destroy:function(){ui.destroy()}})}function Me(zn,Yn){var Kn=0;Zt.procs.poll();var Aa=Yn.color;Aa&&(ht.clearColor(+Aa[0]||0,+Aa[1]||0,+Aa[2]||0,+Aa[3]||0),Kn|=16384),"depth"in Yn&&(ht.clearDepth(+Yn.depth),Kn|=256),"stencil"in Yn&&(ht.clearStencil(Yn.stencil|0),Kn|=1024),ht.clear(Kn)}function Ne(zn){return Pr.push(zn),jt(),{cancel:function(){function Yn(){var Aa=ae(Pr,Yn);Pr[Aa]=Pr[Pr.length-1],--Pr.length,0>=Pr.length&&Ut()}var Kn=ae(Pr,zn);Pr[Kn]=Yn}}}function We(){var zn=Lr.viewport,Yn=Lr.scissor_box;zn[0]=zn[1]=Yn[0]=Yn[1]=0,Rr.viewportWidth=Rr.framebufferWidth=Rr.drawingBufferWidth=zn[2]=Yn[2]=ht.drawingBufferWidth,Rr.viewportHeight=Rr.framebufferHeight=Rr.drawingBufferHeight=zn[3]=Yn[3]=ht.drawingBufferHeight}function Qe(){Rr.tick+=1,Rr.time=$e(),We(),Zt.procs.poll()}function rt(){Sr.refresh(),We(),Zt.procs.refresh(),hr&&hr.update()}function $e(){return(ge()-_r)/1e3}if(ot=f(ot),!ot)return null;var ht=ot.gl,xt=ht.getContextAttributes();ht.isContextLost();var kt=o(ht,ot);if(!kt)return null;var ur=e(),Wt={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Ft=ot.cachedCode||{},ir=kt.extensions,hr=Jr(ht,ir),_r=ge(),Vr=ht.drawingBufferWidth,an=ht.drawingBufferHeight,Rr={tick:0,time:0,viewportWidth:Vr,viewportHeight:an,framebufferWidth:Vr,framebufferHeight:an,drawingBufferWidth:Vr,drawingBufferHeight:an,pixelRatio:ot.pixelRatio},Vr={elements:null,primitive:4,count:-1,offset:0,instances:-1},fn=we(ht,ir),xr=A(ht,Wt,ot,function(zn){return Fr.destroyBuffer(zn)}),mr=x(ht,ir,xr,Wt),Fr=F(ht,ir,fn,Wt,xr,mr,Vr),Ir=V(ht,ur,Wt,ot),Sr=D(ht,ir,fn,function(){Zt.procs.poll()},Rr,Wt,ot),tt=Et(ht,ir,fn,Wt,ot),Ct=R(ht,ir,fn,Sr,tt,Wt),Zt=te(ht,ur,ir,fn,xr,mr,Sr,Ct,{},Fr,Ir,Vr,Rr,hr,Ft,ot),ur=G(ht,Ct,Zt.procs.poll,Rr),Lr=Zt.next,Br=ht.canvas,Pr=[],Tr=[],jr=[],Pn=[ot.onDestroy],An=null;Br&&(Br.addEventListener("webglcontextlost",yr,!1),Br.addEventListener("webglcontextrestored",nt,!1));var $n=Ct.setFBO=_e({framebuffer:fe.define.call(null,1,"framebuffer")});return rt(),xt=le(_e,{clear:function(zn){if("framebuffer"in zn)if(zn.framebuffer&&zn.framebuffer_reglType==="framebufferCube")for(var Yn=0;6>Yn;++Yn)$n(le({framebuffer:zn.framebuffer.faces[Yn]},zn),Me);else $n(zn,Me);else Me(null,zn)},prop:fe.define.bind(null,1),context:fe.define.bind(null,2),this:fe.define.bind(null,3),draw:_e({}),buffer:function(zn){return xr.create(zn,34962,!1,!1)},elements:function(zn){return mr.create(zn,!1)},texture:Sr.create2D,cube:Sr.createCube,renderbuffer:tt.create,framebuffer:Ct.create,framebufferCube:Ct.createCube,vao:Fr.createVAO,attributes:xt,frame:Ne,on:function(zn,Yn){var Kn;switch(zn){case"frame":return Ne(Yn);case"lost":Kn=Tr;break;case"restore":Kn=jr;break;case"destroy":Kn=Pn}return Kn.push(Yn),{cancel:function(){for(var Aa=0;Aa<Kn.length;++Aa)if(Kn[Aa]===Yn){Kn[Aa]=Kn[Kn.length-1],Kn.pop();break}}}},limits:fn,hasExtension:function(zn){return 0<=fn.extensions.indexOf(zn.toLowerCase())},read:ur,destroy:function(){Pr.length=0,Ut(),Br&&(Br.removeEventListener("webglcontextlost",yr),Br.removeEventListener("webglcontextrestored",nt)),Ir.clear(),Ct.clear(),tt.clear(),Fr.clear(),Sr.clear(),mr.clear(),xr.clear(),hr&&hr.clear(),Pn.forEach(function(zn){zn()})},_gl:ht,_refresh:rt,poll:function(){Qe(),hr&&hr.update()},now:$e,stats:Wt,getCachedCode:function(){return Ft},preloadCachedCode:function(zn){Object.entries(zn).forEach(function(Yn){Ft[Yn[0]]=Yn[1]})}}),ot.onDone(null,xt),xt}})},{}],284:[function(d,re,ne){var w=d("buffer"),c=w.Buffer;function M(e,a){for(var n in e)a[n]=e[n]}c.from&&c.alloc&&c.allocUnsafe&&c.allocUnsafeSlow?re.exports=w:(M(w,ne),ne.Buffer=T);function T(e,a,n){return c(e,a,n)}T.prototype=Object.create(c.prototype),M(c,T),T.from=function(e,a,n){if(typeof e=="number")throw new TypeError("Argument must not be a number");return c(e,a,n)},T.alloc=function(e,a,n){if(typeof e!="number")throw new TypeError("Argument must be a number");var r=c(e);return a!==void 0?typeof n=="string"?r.fill(a,n):r.fill(a):r.fill(0),r},T.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return c(e)},T.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return w.SlowBuffer(e)}},{buffer:85}],285:[function(d,re,ne){re.exports=M;var w=d("events").EventEmitter,c=d("inherits");c(M,w),M.Readable=d("readable-stream/lib/_stream_readable.js"),M.Writable=d("readable-stream/lib/_stream_writable.js"),M.Duplex=d("readable-stream/lib/_stream_duplex.js"),M.Transform=d("readable-stream/lib/_stream_transform.js"),M.PassThrough=d("readable-stream/lib/_stream_passthrough.js"),M.finished=d("readable-stream/lib/internal/streams/end-of-stream.js"),M.pipeline=d("readable-stream/lib/internal/streams/pipeline.js"),M.Stream=M;function M(){w.call(this)}M.prototype.pipe=function(T,e){var a=this;function n(p){T.writable&&T.write(p)===!1&&a.pause&&a.pause()}a.on("data",n);function r(){a.readable&&a.resume&&a.resume()}T.on("drain",r),!T._isStdio&&(!e||e.end!==!1)&&(a.on("end",f),a.on("close",o));var t=!1;function f(){t||(t=!0,T.end())}function o(){t||(t=!0,typeof T.destroy=="function"&&T.destroy())}function i(p){if(g(),w.listenerCount(this,"error")===0)throw p}a.on("error",i),T.on("error",i);function g(){a.removeListener("data",n),T.removeListener("drain",r),a.removeListener("end",f),a.removeListener("close",o),a.removeListener("error",i),T.removeListener("error",i),a.removeListener("end",g),a.removeListener("close",g),T.removeListener("close",g)}return a.on("end",g),a.on("close",g),T.on("close",g),T.emit("pipe",a),T}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":287,"readable-stream/lib/_stream_passthrough.js":288,"readable-stream/lib/_stream_readable.js":289,"readable-stream/lib/_stream_transform.js":290,"readable-stream/lib/_stream_writable.js":291,"readable-stream/lib/internal/streams/end-of-stream.js":295,"readable-stream/lib/internal/streams/pipeline.js":297}],286:[function(d,re,ne){function w(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.__proto__=t}var c={};function M(r,t,f){f||(f=Error);function o(g,p,y){return typeof t=="string"?t:t(g,p,y)}var i=function(g){w(p,g);function p(y,h,m){return g.call(this,o(y,h,m))||this}return p}(f);i.prototype.name=f.name,i.prototype.code=r,c[r]=i}function T(r,t){if(Array.isArray(r)){var f=r.length;return r=r.map(function(o){return String(o)}),f>2?"one of ".concat(t," ").concat(r.slice(0,f-1).join(", "),", or ")+r[f-1]:f===2?"one of ".concat(t," ").concat(r[0]," or ").concat(r[1]):"of ".concat(t," ").concat(r[0])}else return"of ".concat(t," ").concat(String(r))}function e(r,t,f){return r.substr(!f||f<0?0:+f,t.length)===t}function a(r,t,f){return(f===void 0||f>r.length)&&(f=r.length),r.substring(f-t.length,f)===t}function n(r,t,f){return typeof f!="number"&&(f=0),f+t.length>r.length?!1:r.indexOf(t,f)!==-1}M("ERR_INVALID_OPT_VALUE",function(r,t){return'The value "'+t+'" is invalid for option "'+r+'"'},TypeError),M("ERR_INVALID_ARG_TYPE",function(r,t,f){var o;typeof t=="string"&&e(t,"not ")?(o="must not be",t=t.replace(/^not /,"")):o="must be";var i;if(a(r," argument"))i="The ".concat(r," ").concat(o," ").concat(T(t,"type"));else{var g=n(r,".")?"property":"argument";i='The "'.concat(r,'" ').concat(g," ").concat(o," ").concat(T(t,"type"))}return i+=". Received type ".concat(typeof f),i},TypeError),M("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),M("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"}),M("ERR_STREAM_PREMATURE_CLOSE","Premature close"),M("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"}),M("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),M("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),M("ERR_STREAM_WRITE_AFTER_END","write after end"),M("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),M("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError),M("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),re.exports.codes=c},{}],287:[function(d,re,ne){(function(w){(function(){var c=Object.keys||function(o){var i=[];for(var g in o)i.push(g);return i};re.exports=r;var M=d("./_stream_readable"),T=d("./_stream_writable");d("inherits")(r,M);for(var e=c(T.prototype),a=0;a<e.length;a++){var n=e[a];r.prototype[n]||(r.prototype[n]=T.prototype[n])}function r(o){if(!(this instanceof r))return new r(o);M.call(this,o),T.call(this,o),this.allowHalfOpen=!0,o&&(o.readable===!1&&(this.readable=!1),o.writable===!1&&(this.writable=!1),o.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",t)))}Object.defineProperty(r.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(r.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(r.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function t(){this._writableState.ended||w.nextTick(f,this)}function f(o){o.end()}Object.defineProperty(r.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(i){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=i,this._writableState.destroyed=i)}})}).call(this)}).call(this,d("_process"))},{"./_stream_readable":289,"./_stream_writable":291,_process:277,inherits:231}],288:[function(d,re,ne){re.exports=c;var w=d("./_stream_transform");d("inherits")(c,w);function c(M){if(!(this instanceof c))return new c(M);w.call(this,M)}c.prototype._transform=function(M,T,e){e(null,M)}},{"./_stream_transform":290,inherits:231}],289:[function(d,re,ne){(function(w,c){(function(){re.exports=k;var M;k.ReadableState=S,d("events").EventEmitter;var T=function(ee,te){return ee.listeners(te).length},e=d("./internal/streams/stream"),a=d("buffer").Buffer,n=c.Uint8Array||function(){};function r(Z){return a.from(Z)}function t(Z){return a.isBuffer(Z)||Z instanceof n}var f=d("util"),o;f&&f.debuglog?o=f.debuglog("stream"):o=function(){};var i=d("./internal/streams/buffer_list"),g=d("./internal/streams/destroy"),p=d("./internal/streams/state"),y=p.getHighWaterMark,h=d("../errors").codes,m=h.ERR_INVALID_ARG_TYPE,u=h.ERR_STREAM_PUSH_AFTER_EOF,_=h.ERR_METHOD_NOT_IMPLEMENTED,s=h.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,A,x,v;d("inherits")(k,e);var b=g.errorOrDestroy,l=["error","close","destroy","pause","resume"];function L(Z,ee,te){if(typeof Z.prependListener=="function")return Z.prependListener(ee,te);!Z._events||!Z._events[ee]?Z.on(ee,te):Array.isArray(Z._events[ee])?Z._events[ee].unshift(te):Z._events[ee]=[te,Z._events[ee]]}function S(Z,ee,te){M=M||d("./_stream_duplex"),Z=Z||{},typeof te!="boolean"&&(te=ee instanceof M),this.objectMode=!!Z.objectMode,te&&(this.objectMode=this.objectMode||!!Z.readableObjectMode),this.highWaterMark=y(this,Z,"readableHighWaterMark",te),this.buffer=new i,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Z.emitClose!==!1,this.autoDestroy=!!Z.autoDestroy,this.destroyed=!1,this.defaultEncoding=Z.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Z.encoding&&(A||(A=d("string_decoder/").StringDecoder),this.decoder=new A(Z.encoding),this.encoding=Z.encoding)}function k(Z){if(M=M||d("./_stream_duplex"),!(this instanceof k))return new k(Z);var ee=this instanceof M;this._readableState=new S(Z,this,ee),this.readable=!0,Z&&(typeof Z.read=="function"&&(this._read=Z.read),typeof Z.destroy=="function"&&(this._destroy=Z.destroy)),e.call(this)}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(ee){!this._readableState||(this._readableState.destroyed=ee)}}),k.prototype.destroy=g.destroy,k.prototype._undestroy=g.undestroy,k.prototype._destroy=function(Z,ee){ee(Z)},k.prototype.push=function(Z,ee){var te=this._readableState,ae;return te.objectMode?ae=!0:typeof Z=="string"&&(ee=ee||te.defaultEncoding,ee!==te.encoding&&(Z=a.from(Z,ee),ee=""),ae=!0),P(this,Z,ee,!1,ae)},k.prototype.unshift=function(Z){return P(this,Z,null,!0,!1)};function P(Z,ee,te,ae,le){o("readableAddChunk",ee);var ye=Z._readableState;if(ee===null)ye.reading=!1,F(Z,ye);else{var fe;if(le||(fe=I(ye,ee)),fe)b(Z,fe);else if(ye.objectMode||ee&&ee.length>0)if(typeof ee!="string"&&!ye.objectMode&&Object.getPrototypeOf(ee)!==a.prototype&&(ee=r(ee)),ae)ye.endEmitted?b(Z,new s):z(Z,ye,ee,!0);else if(ye.ended)b(Z,new u);else{if(ye.destroyed)return!1;ye.reading=!1,ye.decoder&&!te?(ee=ye.decoder.write(ee),ye.objectMode||ee.length!==0?z(Z,ye,ee,!1):J(Z,ye)):z(Z,ye,ee,!1)}else ae||(ye.reading=!1,J(Z,ye))}return!ye.ended&&(ye.length<ye.highWaterMark||ye.length===0)}function z(Z,ee,te,ae){ee.flowing&&ee.length===0&&!ee.sync?(ee.awaitDrain=0,Z.emit("data",te)):(ee.length+=ee.objectMode?1:te.length,ae?ee.buffer.unshift(te):ee.buffer.push(te),ee.needReadable&&V(Z)),J(Z,ee)}function I(Z,ee){var te;return!t(ee)&&typeof ee!="string"&&ee!==void 0&&!Z.objectMode&&(te=new m("chunk",["string","Buffer","Uint8Array"],ee)),te}k.prototype.isPaused=function(){return this._readableState.flowing===!1},k.prototype.setEncoding=function(Z){A||(A=d("string_decoder/").StringDecoder);var ee=new A(Z);this._readableState.decoder=ee,this._readableState.encoding=this._readableState.decoder.encoding;for(var te=this._readableState.buffer.head,ae="";te!==null;)ae+=ee.write(te.data),te=te.next;return this._readableState.buffer.clear(),ae!==""&&this._readableState.buffer.push(ae),this._readableState.length=ae.length,this};var D=1073741824;function R(Z){return Z>=D?Z=D:(Z--,Z|=Z>>>1,Z|=Z>>>2,Z|=Z>>>4,Z|=Z>>>8,Z|=Z>>>16,Z++),Z}function B(Z,ee){return Z<=0||ee.length===0&&ee.ended?0:ee.objectMode?1:Z!==Z?ee.flowing&&ee.length?ee.buffer.head.data.length:ee.length:(Z>ee.highWaterMark&&(ee.highWaterMark=R(Z)),Z<=ee.length?Z:ee.ended?ee.length:(ee.needReadable=!0,0))}k.prototype.read=function(Z){o("read",Z),Z=parseInt(Z,10);var ee=this._readableState,te=Z;if(Z!==0&&(ee.emittedReadable=!1),Z===0&&ee.needReadable&&((ee.highWaterMark!==0?ee.length>=ee.highWaterMark:ee.length>0)||ee.ended))return o("read: emitReadable",ee.length,ee.ended),ee.length===0&&ee.ended?q(this):V(this),null;if(Z=B(Z,ee),Z===0&&ee.ended)return ee.length===0&&q(this),null;var ae=ee.needReadable;o("need readable",ae),(ee.length===0||ee.length-Z<ee.highWaterMark)&&(ae=!0,o("length less than watermark",ae)),ee.ended||ee.reading?(ae=!1,o("reading or ended",ae)):ae&&(o("do read"),ee.reading=!0,ee.sync=!0,ee.length===0&&(ee.needReadable=!0),this._read(ee.highWaterMark),ee.sync=!1,ee.reading||(Z=B(te,ee)));var le;return Z>0?le=U(Z,ee):le=null,le===null?(ee.needReadable=ee.length<=ee.highWaterMark,Z=0):(ee.length-=Z,ee.awaitDrain=0),ee.length===0&&(ee.ended||(ee.needReadable=!0),te!==Z&&ee.ended&&q(this)),le!==null&&this.emit("data",le),le};function F(Z,ee){if(o("onEofChunk"),!ee.ended){if(ee.decoder){var te=ee.decoder.end();te&&te.length&&(ee.buffer.push(te),ee.length+=ee.objectMode?1:te.length)}ee.ended=!0,ee.sync?V(Z):(ee.needReadable=!1,ee.emittedReadable||(ee.emittedReadable=!0,G(Z)))}}function V(Z){var ee=Z._readableState;o("emitReadable",ee.needReadable,ee.emittedReadable),ee.needReadable=!1,ee.emittedReadable||(o("emitReadable",ee.flowing),ee.emittedReadable=!0,w.nextTick(G,Z))}function G(Z){var ee=Z._readableState;o("emitReadable_",ee.destroyed,ee.length,ee.ended),!ee.destroyed&&(ee.length||ee.ended)&&(Z.emit("readable"),ee.emittedReadable=!1),ee.needReadable=!ee.flowing&&!ee.ended&&ee.length<=ee.highWaterMark,N(Z)}function J(Z,ee){ee.readingMore||(ee.readingMore=!0,w.nextTick(j,Z,ee))}function j(Z,ee){for(;!ee.reading&&!ee.ended&&(ee.length<ee.highWaterMark||ee.flowing&&ee.length===0);){var te=ee.length;if(o("maybeReadMore read 0"),Z.read(0),te===ee.length)break}ee.readingMore=!1}k.prototype._read=function(Z){b(this,new _("_read()"))},k.prototype.pipe=function(Z,ee){var te=this,ae=this._readableState;switch(ae.pipesCount){case 0:ae.pipes=Z;break;case 1:ae.pipes=[ae.pipes,Z];break;default:ae.pipes.push(Z);break}ae.pipesCount+=1,o("pipe count=%d opts=%j",ae.pipesCount,ee);var le=(!ee||ee.end!==!1)&&Z!==w.stdout&&Z!==w.stderr,ye=le?pe:Le;ae.endEmitted?w.nextTick(ye):te.once("end",ye),Z.on("unpipe",fe);function fe(He,Je){o("onunpipe"),He===te&&Je&&Je.hasUnpiped===!1&&(Je.hasUnpiped=!0,we())}function pe(){o("onend"),Z.end()}var ge=Y(te);Z.on("drain",ge);var Ae=!1;function we(){o("cleanup"),Z.removeListener("close",Ve),Z.removeListener("finish",xe),Z.removeListener("drain",ge),Z.removeListener("error",Be),Z.removeListener("unpipe",fe),te.removeListener("end",pe),te.removeListener("end",Le),te.removeListener("data",De),Ae=!0,ae.awaitDrain&&(!Z._writableState||Z._writableState.needDrain)&&ge()}te.on("data",De);function De(He){o("ondata");var Je=Z.write(He);o("dest.write",Je),Je===!1&&((ae.pipesCount===1&&ae.pipes===Z||ae.pipesCount>1&&W(ae.pipes,Z)!==-1)&&!Ae&&(o("false write response, pause",ae.awaitDrain),ae.awaitDrain++),te.pause())}function Be(He){o("onerror",He),Le(),Z.removeListener("error",Be),T(Z,"error")===0&&b(Z,He)}L(Z,"error",Be);function Ve(){Z.removeListener("finish",xe),Le()}Z.once("close",Ve);function xe(){o("onfinish"),Z.removeListener("close",Ve),Le()}Z.once("finish",xe);function Le(){o("unpipe"),te.unpipe(Z)}return Z.emit("pipe",te),ae.flowing||(o("pipe resume"),te.resume()),Z};function Y(Z){return function(){var te=Z._readableState;o("pipeOnDrain",te.awaitDrain),te.awaitDrain&&te.awaitDrain--,te.awaitDrain===0&&T(Z,"data")&&(te.flowing=!0,N(Z))}}k.prototype.unpipe=function(Z){var ee=this._readableState,te={hasUnpiped:!1};if(ee.pipesCount===0)return this;if(ee.pipesCount===1)return Z&&Z!==ee.pipes?this:(Z||(Z=ee.pipes),ee.pipes=null,ee.pipesCount=0,ee.flowing=!1,Z&&Z.emit("unpipe",this,te),this);if(!Z){var ae=ee.pipes,le=ee.pipesCount;ee.pipes=null,ee.pipesCount=0,ee.flowing=!1;for(var ye=0;ye<le;ye++)ae[ye].emit("unpipe",this,{hasUnpiped:!1});return this}var fe=W(ee.pipes,Z);return fe===-1?this:(ee.pipes.splice(fe,1),ee.pipesCount-=1,ee.pipesCount===1&&(ee.pipes=ee.pipes[0]),Z.emit("unpipe",this,te),this)},k.prototype.on=function(Z,ee){var te=e.prototype.on.call(this,Z,ee),ae=this._readableState;return Z==="data"?(ae.readableListening=this.listenerCount("readable")>0,ae.flowing!==!1&&this.resume()):Z==="readable"&&!ae.endEmitted&&!ae.readableListening&&(ae.readableListening=ae.needReadable=!0,ae.flowing=!1,ae.emittedReadable=!1,o("on readable",ae.length,ae.reading),ae.length?V(this):ae.reading||w.nextTick(oe,this)),te},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(Z,ee){var te=e.prototype.removeListener.call(this,Z,ee);return Z==="readable"&&w.nextTick(X,this),te},k.prototype.removeAllListeners=function(Z){var ee=e.prototype.removeAllListeners.apply(this,arguments);return(Z==="readable"||Z===void 0)&&w.nextTick(X,this),ee};function X(Z){var ee=Z._readableState;ee.readableListening=Z.listenerCount("readable")>0,ee.resumeScheduled&&!ee.paused?ee.flowing=!0:Z.listenerCount("data")>0&&Z.resume()}function oe(Z){o("readable nexttick read 0"),Z.read(0)}k.prototype.resume=function(){var Z=this._readableState;return Z.flowing||(o("resume"),Z.flowing=!Z.readableListening,se(this,Z)),Z.paused=!1,this};function se(Z,ee){ee.resumeScheduled||(ee.resumeScheduled=!0,w.nextTick(ie,Z,ee))}function ie(Z,ee){o("resume",ee.reading),ee.reading||Z.read(0),ee.resumeScheduled=!1,Z.emit("resume"),N(Z),ee.flowing&&!ee.reading&&Z.read(0)}k.prototype.pause=function(){return o("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(o("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function N(Z){var ee=Z._readableState;for(o("flow",ee.flowing);ee.flowing&&Z.read()!==null;);}k.prototype.wrap=function(Z){var ee=this,te=this._readableState,ae=!1;Z.on("end",function(){if(o("wrapped end"),te.decoder&&!te.ended){var fe=te.decoder.end();fe&&fe.length&&ee.push(fe)}ee.push(null)}),Z.on("data",function(fe){if(o("wrapped data"),te.decoder&&(fe=te.decoder.write(fe)),!(te.objectMode&&fe==null)&&!(!te.objectMode&&(!fe||!fe.length))){var pe=ee.push(fe);pe||(ae=!0,Z.pause())}});for(var le in Z)this[le]===void 0&&typeof Z[le]=="function"&&(this[le]=function(pe){return function(){return Z[pe].apply(Z,arguments)}}(le));for(var ye=0;ye<l.length;ye++)Z.on(l[ye],this.emit.bind(this,l[ye]));return this._read=function(fe){o("wrapped _read",fe),ae&&(ae=!1,Z.resume())},this},typeof Symbol=="function"&&(k.prototype[Symbol.asyncIterator]=function(){return x===void 0&&(x=d("./internal/streams/async_iterator")),x(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(ee){this._readableState&&(this._readableState.flowing=ee)}}),k._fromList=U,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function U(Z,ee){if(ee.length===0)return null;var te;return ee.objectMode?te=ee.buffer.shift():!Z||Z>=ee.length?(ee.decoder?te=ee.buffer.join(""):ee.buffer.length===1?te=ee.buffer.first():te=ee.buffer.concat(ee.length),ee.buffer.clear()):te=ee.buffer.consume(Z,ee.decoder),te}function q(Z){var ee=Z._readableState;o("endReadable",ee.endEmitted),ee.endEmitted||(ee.ended=!0,w.nextTick(Q,ee,Z))}function Q(Z,ee){if(o("endReadableNT",Z.endEmitted,Z.length),!Z.endEmitted&&Z.length===0&&(Z.endEmitted=!0,ee.readable=!1,ee.emit("end"),Z.autoDestroy)){var te=ee._writableState;(!te||te.autoDestroy&&te.finished)&&ee.destroy()}}typeof Symbol=="function"&&(k.from=function(Z,ee){return v===void 0&&(v=d("./internal/streams/from")),v(k,Z,ee)});function W(Z,ee){for(var te=0,ae=Z.length;te<ae;te++)if(Z[te]===ee)return te;return-1}}).call(this)}).call(this,d("_process"),typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":286,"./_stream_duplex":287,"./internal/streams/async_iterator":292,"./internal/streams/buffer_list":293,"./internal/streams/destroy":294,"./internal/streams/from":296,"./internal/streams/state":298,"./internal/streams/stream":299,_process:277,buffer:85,events:84,inherits:231,"string_decoder/":300,util:83}],290:[function(d,re,ne){re.exports=r;var w=d("../errors").codes,c=w.ERR_METHOD_NOT_IMPLEMENTED,M=w.ERR_MULTIPLE_CALLBACK,T=w.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=w.ERR_TRANSFORM_WITH_LENGTH_0,a=d("./_stream_duplex");d("inherits")(r,a);function n(o,i){var g=this._transformState;g.transforming=!1;var p=g.writecb;if(p===null)return this.emit("error",new M);g.writechunk=null,g.writecb=null,i!=null&&this.push(i),p(o);var y=this._readableState;y.reading=!1,(y.needReadable||y.length<y.highWaterMark)&&this._read(y.highWaterMark)}function r(o){if(!(this instanceof r))return new r(o);a.call(this,o),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,o&&(typeof o.transform=="function"&&(this._transform=o.transform),typeof o.flush=="function"&&(this._flush=o.flush)),this.on("prefinish",t)}function t(){var o=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(i,g){f(o,i,g)}):f(this,null,null)}r.prototype.push=function(o,i){return this._transformState.needTransform=!1,a.prototype.push.call(this,o,i)},r.prototype._transform=function(o,i,g){g(new c("_transform()"))},r.prototype._write=function(o,i,g){var p=this._transformState;if(p.writecb=g,p.writechunk=o,p.writeencoding=i,!p.transforming){var y=this._readableState;(p.needTransform||y.needReadable||y.length<y.highWaterMark)&&this._read(y.highWaterMark)}},r.prototype._read=function(o){var i=this._transformState;i.writechunk!==null&&!i.transforming?(i.transforming=!0,this._transform(i.writechunk,i.writeencoding,i.afterTransform)):i.needTransform=!0},r.prototype._destroy=function(o,i){a.prototype._destroy.call(this,o,function(g){i(g)})};function f(o,i,g){if(i)return o.emit("error",i);if(g!=null&&o.push(g),o._writableState.length)throw new e;if(o._transformState.transforming)throw new T;return o.push(null)}},{"../errors":286,"./_stream_duplex":287,inherits:231}],291:[function(d,re,ne){(function(w,c){(function(){re.exports=S;function M(N){var U=this;this.next=null,this.entry=null,this.finish=function(){ie(U,N)}}var T;S.WritableState=l;var e={deprecate:d("util-deprecate")},a=d("./internal/streams/stream"),n=d("buffer").Buffer,r=c.Uint8Array||function(){};function t(N){return n.from(N)}function f(N){return n.isBuffer(N)||N instanceof r}var o=d("./internal/streams/destroy"),i=d("./internal/streams/state"),g=i.getHighWaterMark,p=d("../errors").codes,y=p.ERR_INVALID_ARG_TYPE,h=p.ERR_METHOD_NOT_IMPLEMENTED,m=p.ERR_MULTIPLE_CALLBACK,u=p.ERR_STREAM_CANNOT_PIPE,_=p.ERR_STREAM_DESTROYED,s=p.ERR_STREAM_NULL_VALUES,A=p.ERR_STREAM_WRITE_AFTER_END,x=p.ERR_UNKNOWN_ENCODING,v=o.errorOrDestroy;d("inherits")(S,a);function b(){}function l(N,U,q){T=T||d("./_stream_duplex"),N=N||{},typeof q!="boolean"&&(q=U instanceof T),this.objectMode=!!N.objectMode,q&&(this.objectMode=this.objectMode||!!N.writableObjectMode),this.highWaterMark=g(this,N,"writableHighWaterMark",q),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Q=N.decodeStrings===!1;this.decodeStrings=!Q,this.defaultEncoding=N.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(W){F(U,W)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=N.emitClose!==!1,this.autoDestroy=!!N.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new M(this)}l.prototype.getBuffer=function(){for(var U=this.bufferedRequest,q=[];U;)q.push(U),U=U.next;return q},function(){try{Object.defineProperty(l.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var L;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(L=Function.prototype[Symbol.hasInstance],Object.defineProperty(S,Symbol.hasInstance,{value:function(U){return L.call(this,U)?!0:this!==S?!1:U&&U._writableState instanceof l}})):L=function(U){return U instanceof this};function S(N){T=T||d("./_stream_duplex");var U=this instanceof T;if(!U&&!L.call(S,this))return new S(N);this._writableState=new l(N,this,U),this.writable=!0,N&&(typeof N.write=="function"&&(this._write=N.write),typeof N.writev=="function"&&(this._writev=N.writev),typeof N.destroy=="function"&&(this._destroy=N.destroy),typeof N.final=="function"&&(this._final=N.final)),a.call(this)}S.prototype.pipe=function(){v(this,new u)};function k(N,U){var q=new A;v(N,q),w.nextTick(U,q)}function P(N,U,q,Q){var W;return q===null?W=new s:typeof q!="string"&&!U.objectMode&&(W=new y("chunk",["string","Buffer"],q)),W?(v(N,W),w.nextTick(Q,W),!1):!0}S.prototype.write=function(N,U,q){var Q=this._writableState,W=!1,Z=!Q.objectMode&&f(N);return Z&&!n.isBuffer(N)&&(N=t(N)),typeof U=="function"&&(q=U,U=null),Z?U="buffer":U||(U=Q.defaultEncoding),typeof q!="function"&&(q=b),Q.ending?k(this,q):(Z||P(this,Q,N,q))&&(Q.pendingcb++,W=I(this,Q,Z,N,U,q)),W},S.prototype.cork=function(){this._writableState.corked++},S.prototype.uncork=function(){var N=this._writableState;N.corked&&(N.corked--,!N.writing&&!N.corked&&!N.bufferProcessing&&N.bufferedRequest&&J(this,N))},S.prototype.setDefaultEncoding=function(U){if(typeof U=="string"&&(U=U.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((U+"").toLowerCase())>-1))throw new x(U);return this._writableState.defaultEncoding=U,this},Object.defineProperty(S.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function z(N,U,q){return!N.objectMode&&N.decodeStrings!==!1&&typeof U=="string"&&(U=n.from(U,q)),U}Object.defineProperty(S.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function I(N,U,q,Q,W,Z){if(!q){var ee=z(U,Q,W);Q!==ee&&(q=!0,W="buffer",Q=ee)}var te=U.objectMode?1:Q.length;U.length+=te;var ae=U.length<U.highWaterMark;if(ae||(U.needDrain=!0),U.writing||U.corked){var le=U.lastBufferedRequest;U.lastBufferedRequest={chunk:Q,encoding:W,isBuf:q,callback:Z,next:null},le?le.next=U.lastBufferedRequest:U.bufferedRequest=U.lastBufferedRequest,U.bufferedRequestCount+=1}else D(N,U,!1,te,Q,W,Z);return ae}function D(N,U,q,Q,W,Z,ee){U.writelen=Q,U.writecb=ee,U.writing=!0,U.sync=!0,U.destroyed?U.onwrite(new _("write")):q?N._writev(W,U.onwrite):N._write(W,Z,U.onwrite),U.sync=!1}function R(N,U,q,Q,W){--U.pendingcb,q?(w.nextTick(W,Q),w.nextTick(oe,N,U),N._writableState.errorEmitted=!0,v(N,Q)):(W(Q),N._writableState.errorEmitted=!0,v(N,Q),oe(N,U))}function B(N){N.writing=!1,N.writecb=null,N.length-=N.writelen,N.writelen=0}function F(N,U){var q=N._writableState,Q=q.sync,W=q.writecb;if(typeof W!="function")throw new m;if(B(q),U)R(N,q,Q,U,W);else{var Z=j(q)||N.destroyed;!Z&&!q.corked&&!q.bufferProcessing&&q.bufferedRequest&&J(N,q),Q?w.nextTick(V,N,q,Z,W):V(N,q,Z,W)}}function V(N,U,q,Q){q||G(N,U),U.pendingcb--,Q(),oe(N,U)}function G(N,U){U.length===0&&U.needDrain&&(U.needDrain=!1,N.emit("drain"))}function J(N,U){U.bufferProcessing=!0;var q=U.bufferedRequest;if(N._writev&&q&&q.next){var Q=U.bufferedRequestCount,W=new Array(Q),Z=U.corkedRequestsFree;Z.entry=q;for(var ee=0,te=!0;q;)W[ee]=q,q.isBuf||(te=!1),q=q.next,ee+=1;W.allBuffers=te,D(N,U,!0,U.length,W,"",Z.finish),U.pendingcb++,U.lastBufferedRequest=null,Z.next?(U.corkedRequestsFree=Z.next,Z.next=null):U.corkedRequestsFree=new M(U),U.bufferedRequestCount=0}else{for(;q;){var ae=q.chunk,le=q.encoding,ye=q.callback,fe=U.objectMode?1:ae.length;if(D(N,U,!1,fe,ae,le,ye),q=q.next,U.bufferedRequestCount--,U.writing)break}q===null&&(U.lastBufferedRequest=null)}U.bufferedRequest=q,U.bufferProcessing=!1}S.prototype._write=function(N,U,q){q(new h("_write()"))},S.prototype._writev=null,S.prototype.end=function(N,U,q){var Q=this._writableState;return typeof N=="function"?(q=N,N=null,U=null):typeof U=="function"&&(q=U,U=null),N!=null&&this.write(N,U),Q.corked&&(Q.corked=1,this.uncork()),Q.ending||se(this,Q,q),this},Object.defineProperty(S.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function j(N){return N.ending&&N.length===0&&N.bufferedRequest===null&&!N.finished&&!N.writing}function Y(N,U){N._final(function(q){U.pendingcb--,q&&v(N,q),U.prefinished=!0,N.emit("prefinish"),oe(N,U)})}function X(N,U){!U.prefinished&&!U.finalCalled&&(typeof N._final=="function"&&!U.destroyed?(U.pendingcb++,U.finalCalled=!0,w.nextTick(Y,N,U)):(U.prefinished=!0,N.emit("prefinish")))}function oe(N,U){var q=j(U);if(q&&(X(N,U),U.pendingcb===0&&(U.finished=!0,N.emit("finish"),U.autoDestroy))){var Q=N._readableState;(!Q||Q.autoDestroy&&Q.endEmitted)&&N.destroy()}return q}function se(N,U,q){U.ending=!0,oe(N,U),q&&(U.finished?w.nextTick(q):N.once("finish",q)),U.ended=!0,N.writable=!1}function ie(N,U,q){var Q=N.entry;for(N.entry=null;Q;){var W=Q.callback;U.pendingcb--,W(q),Q=Q.next}U.corkedRequestsFree.next=N}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(U){!this._writableState||(this._writableState.destroyed=U)}}),S.prototype.destroy=o.destroy,S.prototype._undestroy=o.undestroy,S.prototype._destroy=function(N,U){U(N)}}).call(this)}).call(this,d("_process"),typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../errors":286,"./_stream_duplex":287,"./internal/streams/destroy":294,"./internal/streams/state":298,"./internal/streams/stream":299,_process:277,buffer:85,inherits:231,"util-deprecate":330}],292:[function(d,re,ne){(function(w){(function(){var c;function M(_,s,A){return s in _?Object.defineProperty(_,s,{value:A,enumerable:!0,configurable:!0,writable:!0}):_[s]=A,_}var T=d("./end-of-stream"),e=Symbol("lastResolve"),a=Symbol("lastReject"),n=Symbol("error"),r=Symbol("ended"),t=Symbol("lastPromise"),f=Symbol("handlePromise"),o=Symbol("stream");function i(_,s){return{value:_,done:s}}function g(_){var s=_[e];if(s!==null){var A=_[o].read();A!==null&&(_[t]=null,_[e]=null,_[a]=null,s(i(A,!1)))}}function p(_){w.nextTick(g,_)}function y(_,s){return function(A,x){_.then(function(){if(s[r]){A(i(void 0,!0));return}s[f](A,x)},x)}}var h=Object.getPrototypeOf(function(){}),m=Object.setPrototypeOf((c={get stream(){return this[o]},next:function(){var s=this,A=this[n];if(A!==null)return Promise.reject(A);if(this[r])return Promise.resolve(i(void 0,!0));if(this[o].destroyed)return new Promise(function(l,L){w.nextTick(function(){s[n]?L(s[n]):l(i(void 0,!0))})});var x=this[t],v;if(x)v=new Promise(y(x,this));else{var b=this[o].read();if(b!==null)return Promise.resolve(i(b,!1));v=new Promise(this[f])}return this[t]=v,v}},M(c,Symbol.asyncIterator,function(){return this}),M(c,"return",function(){var s=this;return new Promise(function(A,x){s[o].destroy(null,function(v){if(v){x(v);return}A(i(void 0,!0))})})}),c),h),u=function(s){var A,x=Object.create(m,(A={},M(A,o,{value:s,writable:!0}),M(A,e,{value:null,writable:!0}),M(A,a,{value:null,writable:!0}),M(A,n,{value:null,writable:!0}),M(A,r,{value:s._readableState.endEmitted,writable:!0}),M(A,f,{value:function(b,l){var L=x[o].read();L?(x[t]=null,x[e]=null,x[a]=null,b(i(L,!1))):(x[e]=b,x[a]=l)},writable:!0}),A));return x[t]=null,T(s,function(v){if(v&&v.code!=="ERR_STREAM_PREMATURE_CLOSE"){var b=x[a];b!==null&&(x[t]=null,x[e]=null,x[a]=null,b(v)),x[n]=v;return}var l=x[e];l!==null&&(x[t]=null,x[e]=null,x[a]=null,l(i(void 0,!0))),x[r]=!0}),s.on("readable",p.bind(null,x)),x};re.exports=u}).call(this)}).call(this,d("_process"))},{"./end-of-stream":295,_process:277}],293:[function(d,re,ne){function w(g,p){var y=Object.keys(g);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(g);p&&(h=h.filter(function(m){return Object.getOwnPropertyDescriptor(g,m).enumerable})),y.push.apply(y,h)}return y}function c(g){for(var p=1;p<arguments.length;p++){var y=arguments[p]!=null?arguments[p]:{};p%2?w(Object(y),!0).forEach(function(h){M(g,h,y[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(y)):w(Object(y)).forEach(function(h){Object.defineProperty(g,h,Object.getOwnPropertyDescriptor(y,h))})}return g}function M(g,p,y){return p in g?Object.defineProperty(g,p,{value:y,enumerable:!0,configurable:!0,writable:!0}):g[p]=y,g}function T(g,p){if(!(g instanceof p))throw new TypeError("Cannot call a class as a function")}function e(g,p){for(var y=0;y<p.length;y++){var h=p[y];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(g,h.key,h)}}function a(g,p,y){return p&&e(g.prototype,p),y&&e(g,y),g}var n=d("buffer"),r=n.Buffer,t=d("util"),f=t.inspect,o=f&&f.custom||"inspect";function i(g,p,y){r.prototype.copy.call(g,p,y)}re.exports=function(){function g(){T(this,g),this.head=null,this.tail=null,this.length=0}return a(g,[{key:"push",value:function(y){var h={data:y,next:null};this.length>0?this.tail.next=h:this.head=h,this.tail=h,++this.length}},{key:"unshift",value:function(y){var h={data:y,next:this.head};this.length===0&&(this.tail=h),this.head=h,++this.length}},{key:"shift",value:function(){if(this.length!==0){var y=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,y}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(y){if(this.length===0)return"";for(var h=this.head,m=""+h.data;h=h.next;)m+=y+h.data;return m}},{key:"concat",value:function(y){if(this.length===0)return r.alloc(0);for(var h=r.allocUnsafe(y>>>0),m=this.head,u=0;m;)i(m.data,h,u),u+=m.data.length,m=m.next;return h}},{key:"consume",value:function(y,h){var m;return y<this.head.data.length?(m=this.head.data.slice(0,y),this.head.data=this.head.data.slice(y)):y===this.head.data.length?m=this.shift():m=h?this._getString(y):this._getBuffer(y),m}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(y){var h=this.head,m=1,u=h.data;for(y-=u.length;h=h.next;){var _=h.data,s=y>_.length?_.length:y;if(s===_.length?u+=_:u+=_.slice(0,y),y-=s,y===0){s===_.length?(++m,h.next?this.head=h.next:this.head=this.tail=null):(this.head=h,h.data=_.slice(s));break}++m}return this.length-=m,u}},{key:"_getBuffer",value:function(y){var h=r.allocUnsafe(y),m=this.head,u=1;for(m.data.copy(h),y-=m.data.length;m=m.next;){var _=m.data,s=y>_.length?_.length:y;if(_.copy(h,h.length-y,0,s),y-=s,y===0){s===_.length?(++u,m.next?this.head=m.next:this.head=this.tail=null):(this.head=m,m.data=_.slice(s));break}++u}return this.length-=u,h}},{key:o,value:function(y,h){return f(this,c({},h,{depth:0,customInspect:!1}))}}]),g}()},{buffer:85,util:83}],294:[function(d,re,ne){(function(w){(function(){function c(r,t){var f=this,o=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return o||i?(t?t(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,w.nextTick(a,this,r)):w.nextTick(a,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(g){!t&&g?f._writableState?f._writableState.errorEmitted?w.nextTick(T,f):(f._writableState.errorEmitted=!0,w.nextTick(M,f,g)):w.nextTick(M,f,g):t?(w.nextTick(T,f),t(g)):w.nextTick(T,f)}),this)}function M(r,t){a(r,t),T(r)}function T(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function a(r,t){r.emit("error",t)}function n(r,t){var f=r._readableState,o=r._writableState;f&&f.autoDestroy||o&&o.autoDestroy?r.destroy(t):r.emit("error",t)}re.exports={destroy:c,undestroy:e,errorOrDestroy:n}}).call(this)}).call(this,d("_process"))},{_process:277}],295:[function(d,re,ne){var w=d("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function c(a){var n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,t=new Array(r),f=0;f<r;f++)t[f]=arguments[f];a.apply(this,t)}}}function M(){}function T(a){return a.setHeader&&typeof a.abort=="function"}function e(a,n,r){if(typeof n=="function")return e(a,null,n);n||(n={}),r=c(r||M);var t=n.readable||n.readable!==!1&&a.readable,f=n.writable||n.writable!==!1&&a.writable,o=function(){a.writable||g()},i=a._writableState&&a._writableState.finished,g=function(){f=!1,i=!0,t||r.call(a)},p=a._readableState&&a._readableState.endEmitted,y=function(){t=!1,p=!0,f||r.call(a)},h=function(s){r.call(a,s)},m=function(){var s;if(t&&!p)return(!a._readableState||!a._readableState.ended)&&(s=new w),r.call(a,s);if(f&&!i)return(!a._writableState||!a._writableState.ended)&&(s=new w),r.call(a,s)},u=function(){a.req.on("finish",g)};return T(a)?(a.on("complete",g),a.on("abort",m),a.req?u():a.on("request",u)):f&&!a._writableState&&(a.on("end",o),a.on("close",o)),a.on("end",y),a.on("finish",g),n.error!==!1&&a.on("error",h),a.on("close",m),function(){a.removeListener("complete",g),a.removeListener("abort",m),a.removeListener("request",u),a.req&&a.req.removeListener("finish",g),a.removeListener("end",o),a.removeListener("close",o),a.removeListener("finish",g),a.removeListener("end",y),a.removeListener("error",h),a.removeListener("close",m)}}re.exports=e},{"../../../errors":286}],296:[function(d,re,ne){re.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],297:[function(d,re,ne){var w;function c(g){var p=!1;return function(){p||(p=!0,g.apply(void 0,arguments))}}var M=d("../../../errors").codes,T=M.ERR_MISSING_ARGS,e=M.ERR_STREAM_DESTROYED;function a(g){if(g)throw g}function n(g){return g.setHeader&&typeof g.abort=="function"}function r(g,p,y,h){h=c(h);var m=!1;g.on("close",function(){m=!0}),w===void 0&&(w=d("./end-of-stream")),w(g,{readable:p,writable:y},function(_){if(_)return h(_);m=!0,h()});var u=!1;return function(_){if(!m&&!u){if(u=!0,n(g))return g.abort();if(typeof g.destroy=="function")return g.destroy();h(_||new e("pipe"))}}}function t(g){g()}function f(g,p){return g.pipe(p)}function o(g){return!g.length||typeof g[g.length-1]!="function"?a:g.pop()}function i(){for(var g=arguments.length,p=new Array(g),y=0;y<g;y++)p[y]=arguments[y];var h=o(p);if(Array.isArray(p[0])&&(p=p[0]),p.length<2)throw new T("streams");var m,u=p.map(function(_,s){var A=s<p.length-1,x=s>0;return r(_,A,x,function(v){m||(m=v),v&&u.forEach(t),!A&&(u.forEach(t),h(m))})});return p.reduce(f)}re.exports=i},{"../../../errors":286,"./end-of-stream":295}],298:[function(d,re,ne){var w=d("../../../errors").codes.ERR_INVALID_OPT_VALUE;function c(T,e,a){return T.highWaterMark!=null?T.highWaterMark:e?T[a]:null}function M(T,e,a,n){var r=c(e,n,a);if(r!=null){if(!(isFinite(r)&&Math.floor(r)===r)||r<0){var t=n?a:"highWaterMark";throw new w(t,r)}return Math.floor(r)}return T.objectMode?16:16*1024}re.exports={getHighWaterMark:M}},{"../../../errors":286}],299:[function(d,re,ne){re.exports=d("events").EventEmitter},{events:84}],300:[function(d,re,ne){var w=d("safe-buffer").Buffer,c=w.isEncoding||function(u){switch(u=""+u,u&&u.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function M(u){if(!u)return"utf8";for(var _;;)switch(u){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return u;default:if(_)return;u=(""+u).toLowerCase(),_=!0}}function T(u){var _=M(u);if(typeof _!="string"&&(w.isEncoding===c||!c(u)))throw new Error("Unknown encoding: "+u);return _||u}ne.StringDecoder=e;function e(u){this.encoding=T(u);var _;switch(this.encoding){case"utf16le":this.text=i,this.end=g,_=4;break;case"utf8":this.fillLast=t,_=4;break;case"base64":this.text=p,this.end=y,_=3;break;default:this.write=h,this.end=m;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=w.allocUnsafe(_)}e.prototype.write=function(u){if(u.length===0)return"";var _,s;if(this.lastNeed){if(_=this.fillLast(u),_===void 0)return"";s=this.lastNeed,this.lastNeed=0}else s=0;return s<u.length?_?_+this.text(u,s):this.text(u,s):_||""},e.prototype.end=o,e.prototype.text=f,e.prototype.fillLast=function(u){if(this.lastNeed<=u.length)return u.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);u.copy(this.lastChar,this.lastTotal-this.lastNeed,0,u.length),this.lastNeed-=u.length};function a(u){return u<=127?0:u>>5===6?2:u>>4===14?3:u>>3===30?4:u>>6===2?-1:-2}function n(u,_,s){var A=_.length-1;if(A<s)return 0;var x=a(_[A]);return x>=0?(x>0&&(u.lastNeed=x-1),x):--A<s||x===-2?0:(x=a(_[A]),x>=0?(x>0&&(u.lastNeed=x-2),x):--A<s||x===-2?0:(x=a(_[A]),x>=0?(x>0&&(x===2?x=0:u.lastNeed=x-3),x):0))}function r(u,_,s){if((_[0]&192)!==128)return u.lastNeed=0,"\uFFFD";if(u.lastNeed>1&&_.length>1){if((_[1]&192)!==128)return u.lastNeed=1,"\uFFFD";if(u.lastNeed>2&&_.length>2&&(_[2]&192)!==128)return u.lastNeed=2,"\uFFFD"}}function t(u){var _=this.lastTotal-this.lastNeed,s=r(this,u);if(s!==void 0)return s;if(this.lastNeed<=u.length)return u.copy(this.lastChar,_,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);u.copy(this.lastChar,_,0,u.length),this.lastNeed-=u.length}function f(u,_){var s=n(this,u,_);if(!this.lastNeed)return u.toString("utf8",_);this.lastTotal=s;var A=u.length-(s-this.lastNeed);return u.copy(this.lastChar,0,A),u.toString("utf8",_,A)}function o(u){var _=u&&u.length?this.write(u):"";return this.lastNeed?_+"\uFFFD":_}function i(u,_){if((u.length-_)%2===0){var s=u.toString("utf16le",_);if(s){var A=s.charCodeAt(s.length-1);if(A>=55296&&A<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=u[u.length-2],this.lastChar[1]=u[u.length-1],s.slice(0,-1)}return s}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=u[u.length-1],u.toString("utf16le",_,u.length-1)}function g(u){var _=u&&u.length?this.write(u):"";if(this.lastNeed){var s=this.lastTotal-this.lastNeed;return _+this.lastChar.toString("utf16le",0,s)}return _}function p(u,_){var s=(u.length-_)%3;return s===0?u.toString("base64",_):(this.lastNeed=3-s,this.lastTotal=3,s===1?this.lastChar[0]=u[u.length-1]:(this.lastChar[0]=u[u.length-2],this.lastChar[1]=u[u.length-1]),u.toString("base64",_,u.length-s))}function y(u){var _=u&&u.length?this.write(u):"";return this.lastNeed?_+this.lastChar.toString("base64",0,3-this.lastNeed):_}function h(u){return u.toString(this.encoding)}function m(u){return u&&u.length?this.write(u):""}},{"safe-buffer":284}],301:[function(d,re,ne){(function(w,c){(function(){var M=d("assert"),T=d("debug")("stream-parser");re.exports=t;var e=-1,a=0,n=1,r=2;function t(s){var A=s&&typeof s._transform=="function",x=s&&typeof s._write=="function";if(!A&&!x)throw new Error("must pass a Writable or Transform stream in");T("extending Parser into stream"),s._bytes=o,s._skipBytes=i,A&&(s._passthrough=g),A?s._transform=y:s._write=p}function f(s){T("initializing parser stream"),s._parserBytesLeft=0,s._parserBuffers=[],s._parserBuffered=0,s._parserState=e,s._parserCallback=null,typeof s.push=="function"&&(s._parserOutput=s.push.bind(s)),s._parserInit=!0}function o(s,A){M(!this._parserCallback,'there is already a "callback" set!'),M(isFinite(s)&&s>0,'can only buffer a finite number of bytes > 0, got "'+s+'"'),this._parserInit||f(this),T("buffering %o bytes",s),this._parserBytesLeft=s,this._parserCallback=A,this._parserState=a}function i(s,A){M(!this._parserCallback,'there is already a "callback" set!'),M(s>0,'can only skip > 0 bytes, got "'+s+'"'),this._parserInit||f(this),T("skipping %o bytes",s),this._parserBytesLeft=s,this._parserCallback=A,this._parserState=n}function g(s,A){M(!this._parserCallback,'There is already a "callback" set!'),M(s>0,'can only pass through > 0 bytes, got "'+s+'"'),this._parserInit||f(this),T("passing through %o bytes",s),this._parserBytesLeft=s,this._parserCallback=A,this._parserState=r}function p(s,A,x){this._parserInit||f(this),T("write(%o bytes)",s.length),typeof A=="function"&&(x=A),u(this,s,null,x)}function y(s,A,x){this._parserInit||f(this),T("transform(%o bytes)",s.length),typeof A!="function"&&(A=this._parserOutput),u(this,s,A,x)}function h(s,A,x,v){return s._parserBytesLeft<=0?v(new Error("got data but not currently parsing anything")):A.length<=s._parserBytesLeft?function(){return m(s,A,x,v)}:function(){var b=A.slice(0,s._parserBytesLeft);return m(s,b,x,function(l){if(l)return v(l);if(A.length>b.length)return function(){return h(s,A.slice(b.length),x,v)}})}}function m(s,A,x,v){if(s._parserBytesLeft-=A.length,T("%o bytes left for stream piece",s._parserBytesLeft),s._parserState===a?(s._parserBuffers.push(A),s._parserBuffered+=A.length):s._parserState===r&&x(A),s._parserBytesLeft===0){var b=s._parserCallback;if(b&&s._parserState===a&&s._parserBuffers.length>1&&(A=c.concat(s._parserBuffers,s._parserBuffered)),s._parserState!==a&&(A=null),s._parserCallback=null,s._parserBuffered=0,s._parserState=e,s._parserBuffers.splice(0),b){var l=[];A&&l.push(A),x&&l.push(x);var L=b.length>l.length;L&&l.push(_(v));var S=b.apply(s,l);if(!L||v===S)return v}}else return v}var u=_(h);function _(s){return function(){for(var A=s.apply(this,arguments);typeof A=="function";)A=A();return A}}}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:277,assert:75,buffer:85,debug:302}],302:[function(d,re,ne){(function(w){(function(){ne=re.exports=d("./debug"),ne.log=T,ne.formatArgs=M,ne.save=e,ne.load=a,ne.useColors=c,ne.storage=typeof chrome!="undefined"&&typeof chrome.storage!="undefined"?chrome.storage.local:n(),ne.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function c(){return typeof window!="undefined"&&window.process&&window.process.type==="renderer"?!0:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}ne.formatters.j=function(r){try{return JSON.stringify(r)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}};function M(r){var t=this.useColors;if(r[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+r[0]+(t?"%c ":" ")+"+"+ne.humanize(this.diff),!!t){var f="color: "+this.color;r.splice(1,0,f,"color: inherit");var o=0,i=0;r[0].replace(/%[a-zA-Z%]/g,function(g){g!=="%%"&&(o++,g==="%c"&&(i=o))}),r.splice(i,0,f)}}function T(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function e(r){try{r==null?ne.storage.removeItem("debug"):ne.storage.debug=r}catch{}}function a(){var r;try{r=ne.storage.debug}catch{}return!r&&typeof w!="undefined"&&"env"in w&&(r={}.DEBUG),r}ne.enable(a());function n(){try{return window.localStorage}catch{}}}).call(this)}).call(this,d("_process"))},{"./debug":303,_process:277}],303:[function(d,re,ne){ne=re.exports=M.debug=M.default=M,ne.coerce=n,ne.disable=e,ne.enable=T,ne.enabled=a,ne.humanize=d("ms"),ne.names=[],ne.skips=[],ne.formatters={};var w;function c(r){var t=0,f;for(f in r)t=(t<<5)-t+r.charCodeAt(f),t|=0;return ne.colors[Math.abs(t)%ne.colors.length]}function M(r){function t(){if(!!t.enabled){var f=t,o=+new Date,i=o-(w||o);f.diff=i,f.prev=w,f.curr=o,w=o;for(var g=new Array(arguments.length),p=0;p<g.length;p++)g[p]=arguments[p];g[0]=ne.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");var y=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,function(m,u){if(m==="%%")return m;y++;var _=ne.formatters[u];if(typeof _=="function"){var s=g[y];m=_.call(f,s),g.splice(y,1),y--}return m}),ne.formatArgs.call(f,g);var h=t.log||ne.log||console.log.bind(console);h.apply(f,g)}}return t.namespace=r,t.enabled=ne.enabled(r),t.useColors=ne.useColors(),t.color=c(r),typeof ne.init=="function"&&ne.init(t),t}function T(r){ne.save(r),ne.names=[],ne.skips=[];for(var t=(typeof r=="string"?r:"").split(/[\s,]+/),f=t.length,o=0;o<f;o++)!t[o]||(r=t[o].replace(/\*/g,".*?"),r[0]==="-"?ne.skips.push(new RegExp("^"+r.substr(1)+"$")):ne.names.push(new RegExp("^"+r+"$")))}function e(){ne.enable("")}function a(r){var t,f;for(t=0,f=ne.skips.length;t<f;t++)if(ne.skips[t].test(r))return!1;for(t=0,f=ne.names.length;t<f;t++)if(ne.names[t].test(r))return!0;return!1}function n(r){return r instanceof Error?r.stack||r.message:r}},{ms:304}],304:[function(d,re,ne){var w=1e3,c=w*60,M=c*60,T=M*24,e=T*365.25;re.exports=function(f,o){o=o||{};var i=typeof f;if(i==="string"&&f.length>0)return a(f);if(i==="number"&&isNaN(f)===!1)return o.long?r(f):n(f);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(f))};function a(f){if(f=String(f),!(f.length>100)){var o=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(f);if(!!o){var i=parseFloat(o[1]),g=(o[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return i*e;case"days":case"day":case"d":return i*T;case"hours":case"hour":case"hrs":case"hr":case"h":return i*M;case"minutes":case"minute":case"mins":case"min":case"m":return i*c;case"seconds":case"second":case"secs":case"sec":case"s":return i*w;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}function n(f){return f>=T?Math.round(f/T)+"d":f>=M?Math.round(f/M)+"h":f>=c?Math.round(f/c)+"m":f>=w?Math.round(f/w)+"s":f+"ms"}function r(f){return t(f,T,"day")||t(f,M,"hour")||t(f,c,"minute")||t(f,w,"second")||f+" ms"}function t(f,o,i){if(!(f<o))return f<o*1.5?Math.floor(f/o)+" "+i:Math.ceil(f/o)+" "+i+"s"}},{}],305:[function(d,re,ne){var w=d("parenthesis");re.exports=function(M,T,e){if(M==null)throw Error("First argument should be a string");if(T==null)throw Error("Separator should be a string or a RegExp");e?(typeof e=="string"||Array.isArray(e))&&(e={ignore:e}):e={},e.escape==null&&(e.escape=!0),e.ignore==null?e.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof e.ignore=="string"&&(e.ignore=[e.ignore]),e.ignore=e.ignore.map(function(g){return g.length===1&&(g=g+g),g}));var a=w.parse(M,{flat:!0,brackets:e.ignore}),n=a[0],r=n.split(T);if(e.escape){for(var t=[],f=0;f<r.length;f++){var o=r[f],i=r[f+1];o[o.length-1]==="\\"&&o[o.length-2]!=="\\"?(t.push(o+T+i),f++):t.push(o)}r=t}for(var f=0;f<r.length;f++)a[0]=r[f],r[f]=w.stringify(a,{flat:!0});return r}},{parenthesis:248}],306:[function(d,re,ne){re.exports=w;function w(c){for(var M=c.length,T=new Array(M),e=new Array(M),a=new Array(M),n=new Array(M),r=new Array(M),t=new Array(M),f=0;f<M;++f)T[f]=-1,e[f]=0,a[f]=!1,n[f]=0,r[f]=-1,t[f]=[];var o=0,i=[],g=[];function p(u){var _=[u],s=[u];for(T[u]=e[u]=o,a[u]=!0,o+=1;s.length>0;){u=s[s.length-1];var A=c[u];if(n[u]<A.length){for(var x=n[u];x<A.length;++x){var v=A[x];if(T[v]<0){T[v]=e[v]=o,a[v]=!0,o+=1,_.push(v),s.push(v);break}else a[v]&&(e[u]=Math.min(e[u],e[v])|0);r[v]>=0&&t[u].push(r[v])}n[u]=x}else{if(e[u]===T[u]){for(var b=[],l=[],L=0,x=_.length-1;x>=0;--x){var S=_[x];if(a[S]=!1,b.push(S),l.push(t[S]),L+=t[S].length,r[S]=i.length,S===u){_.length=x;break}}i.push(b);for(var k=new Array(L),x=0;x<l.length;x++)for(var P=0;P<l[x].length;P++)k[--L]=l[x][P];g.push(k)}s.pop()}}}for(var f=0;f<M;++f)T[f]<0&&p(f);for(var y,f=0;f<g.length;f++){var h=g[f];if(h.length!==0){h.sort(function(_,s){return _-s}),y=[h[0]];for(var m=1;m<h.length;m++)h[m]!==h[m-1]&&y.push(h[m]);g[f]=y}}return{components:i,adjacencyList:g}}},{}],307:[function(d,re,ne){Object.defineProperty(ne,"__esModule",{value:!0});var w=function(){function r(t,f){var o=[],i=!0,g=!1,p=void 0;try{for(var y=t[Symbol.iterator](),h;!(i=(h=y.next()).done)&&(o.push(h.value),!(f&&o.length===f));i=!0);}catch(m){g=!0,p=m}finally{try{!i&&y.return&&y.return()}finally{if(g)throw p}}return o}return function(t,f){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return r(t,f);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=Math.PI*2,M=function(t,f,o,i,g,p,y){var h=t.x,m=t.y;h*=f,m*=o;var u=i*h-g*m,_=g*h+i*m;return{x:u+p,y:_+y}},T=function(t,f){var o=f===1.5707963267948966?.551915024494:f===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(f/4),i=Math.cos(t),g=Math.sin(t),p=Math.cos(t+f),y=Math.sin(t+f);return[{x:i-g*o,y:g+i*o},{x:p+y*o,y:y-p*o},{x:p,y}]},e=function(t,f,o,i){var g=t*i-f*o<0?-1:1,p=t*o+f*i;return p>1&&(p=1),p<-1&&(p=-1),g*Math.acos(p)},a=function(t,f,o,i,g,p,y,h,m,u,_,s){var A=Math.pow(g,2),x=Math.pow(p,2),v=Math.pow(_,2),b=Math.pow(s,2),l=A*x-A*b-x*v;l<0&&(l=0),l/=A*b+x*v,l=Math.sqrt(l)*(y===h?-1:1);var L=l*g/p*s,S=l*-p/g*_,k=u*L-m*S+(t+o)/2,P=m*L+u*S+(f+i)/2,z=(_-L)/g,I=(s-S)/p,D=(-_-L)/g,R=(-s-S)/p,B=e(1,0,z,I),F=e(z,I,D,R);return h===0&&F>0&&(F-=c),h===1&&F<0&&(F+=c),[k,P,B,F]},n=function(t){var f=t.px,o=t.py,i=t.cx,g=t.cy,p=t.rx,y=t.ry,h=t.xAxisRotation,m=h===void 0?0:h,u=t.largeArcFlag,_=u===void 0?0:u,s=t.sweepFlag,A=s===void 0?0:s,x=[];if(p===0||y===0)return[];var v=Math.sin(m*c/360),b=Math.cos(m*c/360),l=b*(f-i)/2+v*(o-g)/2,L=-v*(f-i)/2+b*(o-g)/2;if(l===0&&L===0)return[];p=Math.abs(p),y=Math.abs(y);var S=Math.pow(l,2)/Math.pow(p,2)+Math.pow(L,2)/Math.pow(y,2);S>1&&(p*=Math.sqrt(S),y*=Math.sqrt(S));var k=a(f,o,i,g,p,y,_,A,v,b,l,L),P=w(k,4),z=P[0],I=P[1],D=P[2],R=P[3],B=Math.abs(R)/(c/4);Math.abs(1-B)<1e-7&&(B=1);var F=Math.max(Math.ceil(B),1);R/=F;for(var V=0;V<F;V++)x.push(T(D,R)),D+=R;return x.map(function(G){var J=M(G[0],p,y,b,v,z,I),j=J.x,Y=J.y,X=M(G[1],p,y,b,v,z,I),oe=X.x,se=X.y,ie=M(G[2],p,y,b,v,z,I),N=ie.x,U=ie.y;return{x1:j,y1:Y,x2:oe,y2:se,x:N,y:U}})};ne.default=n,re.exports=ne.default},{}],308:[function(d,re,ne){var w=d("parse-svg-path"),c=d("abs-svg-path"),M=d("normalize-svg-path"),T=d("is-svg-path"),e=d("assert");re.exports=a;function a(n){if(Array.isArray(n)&&n.length===1&&typeof n[0]=="string"&&(n=n[0]),typeof n=="string"&&(e(T(n),"String is not an SVG path."),n=w(n)),e(Array.isArray(n),"Argument should be a string or an array of path segments."),n=c(n),n=M(n),!n.length)return[0,0,0,0];for(var r=[1/0,1/0,-1/0,-1/0],t=0,f=n.length;t<f;t++)for(var o=n[t].slice(1),i=0;i<o.length;i+=2)o[i+0]<r[0]&&(r[0]=o[i+0]),o[i+1]<r[1]&&(r[1]=o[i+1]),o[i+0]>r[2]&&(r[2]=o[i+0]),o[i+1]>r[3]&&(r[3]=o[i+1]);return r}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":309,"parse-svg-path":250}],309:[function(d,re,ne){re.exports=c;var w=d("svg-arc-to-cubic-bezier");function c(e){for(var a,n=[],r=0,t=0,f=0,o=0,i=null,g=null,p=0,y=0,h=0,m=e.length;h<m;h++){var u=e[h],_=u[0];switch(_){case"M":f=u[1],o=u[2];break;case"A":var s=w({px:p,py:y,cx:u[6],cy:u[7],rx:u[1],ry:u[2],xAxisRotation:u[3],largeArcFlag:u[4],sweepFlag:u[5]});if(!s.length)continue;for(var A=0,x;A<s.length;A++)x=s[A],u=["C",x.x1,x.y1,x.x2,x.y2,x.x,x.y],A<s.length-1&&n.push(u);break;case"S":var v=p,b=y;(a=="C"||a=="S")&&(v+=v-r,b+=b-t),u=["C",v,b,u[1],u[2],u[3],u[4]];break;case"T":a=="Q"||a=="T"?(i=p*2-i,g=y*2-g):(i=p,g=y),u=T(p,y,i,g,u[1],u[2]);break;case"Q":i=u[1],g=u[2],u=T(p,y,u[1],u[2],u[3],u[4]);break;case"L":u=M(p,y,u[1],u[2]);break;case"H":u=M(p,y,u[1],y);break;case"V":u=M(p,y,p,u[1]);break;case"Z":u=M(p,y,f,o);break}a=_,p=u[u.length-2],y=u[u.length-1],u.length>4?(r=u[u.length-4],t=u[u.length-3]):(r=p,t=y),n.push(u)}return n}function M(e,a,n,r){return["C",e,a,n,r,n,r]}function T(e,a,n,r,t,f){return["C",e/3+2/3*n,a/3+2/3*r,t/3+2/3*n,f/3+2/3*r,t,f]}},{"svg-arc-to-cubic-bezier":307}],310:[function(d,re,ne){var w=d("svg-path-bounds"),c=d("parse-svg-path"),M=d("draw-svg-path"),T=d("is-svg-path"),e=d("bitmap-sdf"),a=document.createElement("canvas"),n=a.getContext("2d");re.exports=r;function r(o,i){if(!T(o))throw Error("Argument should be valid svg path string");i||(i={});var g,p;i.shape?(g=i.shape[0],p=i.shape[1]):(g=a.width=i.w||i.width||200,p=a.height=i.h||i.height||200);var y=Math.min(g,p),h=i.stroke||0,m=i.viewbox||i.viewBox||w(o),u=[g/(m[2]-m[0]),p/(m[3]-m[1])],_=Math.min(u[0]||0,u[1]||0)/2;if(n.fillStyle="black",n.fillRect(0,0,g,p),n.fillStyle="white",h&&(typeof h!="number"&&(h=1),h>0?n.strokeStyle="white":n.strokeStyle="black",n.lineWidth=Math.abs(h)),n.translate(g*.5,p*.5),n.scale(_,_),f()){var s=new Path2D(o);n.fill(s),h&&n.stroke(s)}else{var A=c(o);M(n,A),n.fill(),h&&n.stroke()}n.setTransform(1,0,0,1,0,0);var x=e(n,{cutoff:i.cutoff!=null?i.cutoff:.5,radius:i.radius!=null?i.radius:y*.5});return x}var t;function f(){if(t!=null)return t;var o=document.createElement("canvas").getContext("2d");if(o.canvas.width=o.canvas.height=1,!window.Path2D)return t=!1;var i=new Path2D("M0,0h1v1h-1v-1Z");o.fillStyle="black",o.fill(i);var g=o.getImageData(0,0,1,1);return t=g&&g.data&&g.data[3]===255}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":308}],311:[function(d,re,ne){(function(w,c){(function(){var M=d("process/browser.js").nextTick,T=Function.prototype.apply,e=Array.prototype.slice,a={},n=0;ne.setTimeout=function(){return new r(T.call(setTimeout,window,arguments),clearTimeout)},ne.setInterval=function(){return new r(T.call(setInterval,window,arguments),clearInterval)},ne.clearTimeout=ne.clearInterval=function(t){t.close()};function r(t,f){this._id=t,this._clearFn=f}r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},ne.enroll=function(t,f){clearTimeout(t._idleTimeoutId),t._idleTimeout=f},ne.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},ne._unrefActive=ne.active=function(t){clearTimeout(t._idleTimeoutId);var f=t._idleTimeout;f>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},f))},ne.setImmediate=typeof w=="function"?w:function(t){var f=n++,o=arguments.length<2?!1:e.call(arguments,1);return a[f]=!0,M(function(){a[f]&&(o?t.apply(null,o):t.call(null),ne.clearImmediate(f))}),f},ne.clearImmediate=typeof c=="function"?c:function(t){delete a[t]}}).call(this)}).call(this,d("timers").setImmediate,d("timers").clearImmediate)},{"process/browser.js":277,timers:311}],312:[function(d,re,ne){(function(w){var c=/^\s+/,M=/\s+$/,T=0,e=w.round,a=w.min,n=w.max,r=w.random;function t(W,Z){if(W=W||"",Z=Z||{},W instanceof t)return W;if(!(this instanceof t))return new t(W,Z);var ee=f(W);this._originalInput=W,this._r=ee.r,this._g=ee.g,this._b=ee.b,this._a=ee.a,this._roundA=e(100*this._a)/100,this._format=Z.format||ee.format,this._gradientType=Z.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=ee.ok,this._tc_id=T++}t.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var W=this.toRgb();return(W.r*299+W.g*587+W.b*114)/1e3},getLuminance:function(){var W=this.toRgb(),Z,ee,te,ae,le,ye;return Z=W.r/255,ee=W.g/255,te=W.b/255,Z<=.03928?ae=Z/12.92:ae=w.pow((Z+.055)/1.055,2.4),ee<=.03928?le=ee/12.92:le=w.pow((ee+.055)/1.055,2.4),te<=.03928?ye=te/12.92:ye=w.pow((te+.055)/1.055,2.4),.2126*ae+.7152*le+.0722*ye},setAlpha:function(W){return this._a=F(W),this._roundA=e(100*this._a)/100,this},toHsv:function(){var W=p(this._r,this._g,this._b);return{h:W.h*360,s:W.s,v:W.v,a:this._a}},toHsvString:function(){var W=p(this._r,this._g,this._b),Z=e(W.h*360),ee=e(W.s*100),te=e(W.v*100);return this._a==1?"hsv("+Z+", "+ee+"%, "+te+"%)":"hsva("+Z+", "+ee+"%, "+te+"%, "+this._roundA+")"},toHsl:function(){var W=i(this._r,this._g,this._b);return{h:W.h*360,s:W.s,l:W.l,a:this._a}},toHslString:function(){var W=i(this._r,this._g,this._b),Z=e(W.h*360),ee=e(W.s*100),te=e(W.l*100);return this._a==1?"hsl("+Z+", "+ee+"%, "+te+"%)":"hsla("+Z+", "+ee+"%, "+te+"%, "+this._roundA+")"},toHex:function(W){return h(this._r,this._g,this._b,W)},toHexString:function(W){return"#"+this.toHex(W)},toHex8:function(W){return m(this._r,this._g,this._b,this._a,W)},toHex8String:function(W){return"#"+this.toHex8(W)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(V(this._r,255)*100)+"%",g:e(V(this._g,255)*100)+"%",b:e(V(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(V(this._r,255)*100)+"%, "+e(V(this._g,255)*100)+"%, "+e(V(this._b,255)*100)+"%)":"rgba("+e(V(this._r,255)*100)+"%, "+e(V(this._g,255)*100)+"%, "+e(V(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:R[h(this._r,this._g,this._b,!0)]||!1},toFilter:function(W){var Z="#"+u(this._r,this._g,this._b,this._a),ee=Z,te=this._gradientType?"GradientType = 1, ":"";if(W){var ae=t(W);ee="#"+u(ae._r,ae._g,ae._b,ae._a)}return"progid:DXImageTransform.Microsoft.gradient("+te+"startColorstr="+Z+",endColorstr="+ee+")"},toString:function(W){var Z=!!W;W=W||this._format;var ee=!1,te=this._a<1&&this._a>=0,ae=!Z&&te&&(W==="hex"||W==="hex6"||W==="hex3"||W==="hex4"||W==="hex8"||W==="name");return ae?W==="name"&&this._a===0?this.toName():this.toRgbString():(W==="rgb"&&(ee=this.toRgbString()),W==="prgb"&&(ee=this.toPercentageRgbString()),(W==="hex"||W==="hex6")&&(ee=this.toHexString()),W==="hex3"&&(ee=this.toHexString(!0)),W==="hex4"&&(ee=this.toHex8String(!0)),W==="hex8"&&(ee=this.toHex8String()),W==="name"&&(ee=this.toName()),W==="hsl"&&(ee=this.toHslString()),W==="hsv"&&(ee=this.toHsvString()),ee||this.toHexString())},clone:function(){return t(this.toString())},_applyModification:function(W,Z){var ee=W.apply(null,[this].concat([].slice.call(Z)));return this._r=ee._r,this._g=ee._g,this._b=ee._b,this.setAlpha(ee._a),this},lighten:function(){return this._applyModification(x,arguments)},brighten:function(){return this._applyModification(v,arguments)},darken:function(){return this._applyModification(b,arguments)},desaturate:function(){return this._applyModification(_,arguments)},saturate:function(){return this._applyModification(s,arguments)},greyscale:function(){return this._applyModification(A,arguments)},spin:function(){return this._applyModification(l,arguments)},_applyCombination:function(W,Z){return W.apply(null,[this].concat([].slice.call(Z)))},analogous:function(){return this._applyCombination(z,arguments)},complement:function(){return this._applyCombination(L,arguments)},monochromatic:function(){return this._applyCombination(I,arguments)},splitcomplement:function(){return this._applyCombination(P,arguments)},triad:function(){return this._applyCombination(S,arguments)},tetrad:function(){return this._applyCombination(k,arguments)}},t.fromRatio=function(W,Z){if(typeof W=="object"){var ee={};for(var te in W)W.hasOwnProperty(te)&&(te==="a"?ee[te]=W[te]:ee[te]=oe(W[te]));W=ee}return t(W,Z)};function f(W){var Z={r:0,g:0,b:0},ee=1,te=null,ae=null,le=null,ye=!1,fe=!1;return typeof W=="string"&&(W=q(W)),typeof W=="object"&&(U(W.r)&&U(W.g)&&U(W.b)?(Z=o(W.r,W.g,W.b),ye=!0,fe=String(W.r).substr(-1)==="%"?"prgb":"rgb"):U(W.h)&&U(W.s)&&U(W.v)?(te=oe(W.s),ae=oe(W.v),Z=y(W.h,te,ae),ye=!0,fe="hsv"):U(W.h)&&U(W.s)&&U(W.l)&&(te=oe(W.s),le=oe(W.l),Z=g(W.h,te,le),ye=!0,fe="hsl"),W.hasOwnProperty("a")&&(ee=W.a)),ee=F(ee),{ok:ye,format:W.format||fe,r:a(255,n(Z.r,0)),g:a(255,n(Z.g,0)),b:a(255,n(Z.b,0)),a:ee}}function o(W,Z,ee){return{r:V(W,255)*255,g:V(Z,255)*255,b:V(ee,255)*255}}function i(W,Z,ee){W=V(W,255),Z=V(Z,255),ee=V(ee,255);var te=n(W,Z,ee),ae=a(W,Z,ee),le,ye,fe=(te+ae)/2;if(te==ae)le=ye=0;else{var pe=te-ae;switch(ye=fe>.5?pe/(2-te-ae):pe/(te+ae),te){case W:le=(Z-ee)/pe+(Z<ee?6:0);break;case Z:le=(ee-W)/pe+2;break;case ee:le=(W-Z)/pe+4;break}le/=6}return{h:le,s:ye,l:fe}}function g(W,Z,ee){var te,ae,le;W=V(W,360),Z=V(Z,100),ee=V(ee,100);function ye(ge,Ae,we){return we<0&&(we+=1),we>1&&(we-=1),we<1/6?ge+(Ae-ge)*6*we:we<1/2?Ae:we<2/3?ge+(Ae-ge)*(2/3-we)*6:ge}if(Z===0)te=ae=le=ee;else{var fe=ee<.5?ee*(1+Z):ee+Z-ee*Z,pe=2*ee-fe;te=ye(pe,fe,W+1/3),ae=ye(pe,fe,W),le=ye(pe,fe,W-1/3)}return{r:te*255,g:ae*255,b:le*255}}function p(W,Z,ee){W=V(W,255),Z=V(Z,255),ee=V(ee,255);var te=n(W,Z,ee),ae=a(W,Z,ee),le,ye,fe=te,pe=te-ae;if(ye=te===0?0:pe/te,te==ae)le=0;else{switch(te){case W:le=(Z-ee)/pe+(Z<ee?6:0);break;case Z:le=(ee-W)/pe+2;break;case ee:le=(W-Z)/pe+4;break}le/=6}return{h:le,s:ye,v:fe}}function y(W,Z,ee){W=V(W,360)*6,Z=V(Z,100),ee=V(ee,100);var te=w.floor(W),ae=W-te,le=ee*(1-Z),ye=ee*(1-ae*Z),fe=ee*(1-(1-ae)*Z),pe=te%6,ge=[ee,ye,le,le,fe,ee][pe],Ae=[fe,ee,ee,ye,le,le][pe],we=[le,le,fe,ee,ee,ye][pe];return{r:ge*255,g:Ae*255,b:we*255}}function h(W,Z,ee,te){var ae=[X(e(W).toString(16)),X(e(Z).toString(16)),X(e(ee).toString(16))];return te&&ae[0].charAt(0)==ae[0].charAt(1)&&ae[1].charAt(0)==ae[1].charAt(1)&&ae[2].charAt(0)==ae[2].charAt(1)?ae[0].charAt(0)+ae[1].charAt(0)+ae[2].charAt(0):ae.join("")}function m(W,Z,ee,te,ae){var le=[X(e(W).toString(16)),X(e(Z).toString(16)),X(e(ee).toString(16)),X(se(te))];return ae&&le[0].charAt(0)==le[0].charAt(1)&&le[1].charAt(0)==le[1].charAt(1)&&le[2].charAt(0)==le[2].charAt(1)&&le[3].charAt(0)==le[3].charAt(1)?le[0].charAt(0)+le[1].charAt(0)+le[2].charAt(0)+le[3].charAt(0):le.join("")}function u(W,Z,ee,te){var ae=[X(se(te)),X(e(W).toString(16)),X(e(Z).toString(16)),X(e(ee).toString(16))];return ae.join("")}t.equals=function(W,Z){return!W||!Z?!1:t(W).toRgbString()==t(Z).toRgbString()},t.random=function(){return t.fromRatio({r:r(),g:r(),b:r()})};function _(W,Z){Z=Z===0?0:Z||10;var ee=t(W).toHsl();return ee.s-=Z/100,ee.s=G(ee.s),t(ee)}function s(W,Z){Z=Z===0?0:Z||10;var ee=t(W).toHsl();return ee.s+=Z/100,ee.s=G(ee.s),t(ee)}function A(W){return t(W).desaturate(100)}function x(W,Z){Z=Z===0?0:Z||10;var ee=t(W).toHsl();return ee.l+=Z/100,ee.l=G(ee.l),t(ee)}function v(W,Z){Z=Z===0?0:Z||10;var ee=t(W).toRgb();return ee.r=n(0,a(255,ee.r-e(255*-(Z/100)))),ee.g=n(0,a(255,ee.g-e(255*-(Z/100)))),ee.b=n(0,a(255,ee.b-e(255*-(Z/100)))),t(ee)}function b(W,Z){Z=Z===0?0:Z||10;var ee=t(W).toHsl();return ee.l-=Z/100,ee.l=G(ee.l),t(ee)}function l(W,Z){var ee=t(W).toHsl(),te=(ee.h+Z)%360;return ee.h=te<0?360+te:te,t(ee)}function L(W){var Z=t(W).toHsl();return Z.h=(Z.h+180)%360,t(Z)}function S(W){var Z=t(W).toHsl(),ee=Z.h;return[t(W),t({h:(ee+120)%360,s:Z.s,l:Z.l}),t({h:(ee+240)%360,s:Z.s,l:Z.l})]}function k(W){var Z=t(W).toHsl(),ee=Z.h;return[t(W),t({h:(ee+90)%360,s:Z.s,l:Z.l}),t({h:(ee+180)%360,s:Z.s,l:Z.l}),t({h:(ee+270)%360,s:Z.s,l:Z.l})]}function P(W){var Z=t(W).toHsl(),ee=Z.h;return[t(W),t({h:(ee+72)%360,s:Z.s,l:Z.l}),t({h:(ee+216)%360,s:Z.s,l:Z.l})]}function z(W,Z,ee){Z=Z||6,ee=ee||30;var te=t(W).toHsl(),ae=360/ee,le=[t(W)];for(te.h=(te.h-(ae*Z>>1)+720)%360;--Z;)te.h=(te.h+ae)%360,le.push(t(te));return le}function I(W,Z){Z=Z||6;for(var ee=t(W).toHsv(),te=ee.h,ae=ee.s,le=ee.v,ye=[],fe=1/Z;Z--;)ye.push(t({h:te,s:ae,v:le})),le=(le+fe)%1;return ye}t.mix=function(W,Z,ee){ee=ee===0?0:ee||50;var te=t(W).toRgb(),ae=t(Z).toRgb(),le=ee/100,ye={r:(ae.r-te.r)*le+te.r,g:(ae.g-te.g)*le+te.g,b:(ae.b-te.b)*le+te.b,a:(ae.a-te.a)*le+te.a};return t(ye)},t.readability=function(W,Z){var ee=t(W),te=t(Z);return(w.max(ee.getLuminance(),te.getLuminance())+.05)/(w.min(ee.getLuminance(),te.getLuminance())+.05)},t.isReadable=function(W,Z,ee){var te=t.readability(W,Z),ae,le;switch(le=!1,ae=Q(ee),ae.level+ae.size){case"AAsmall":case"AAAlarge":le=te>=4.5;break;case"AAlarge":le=te>=3;break;case"AAAsmall":le=te>=7;break}return le},t.mostReadable=function(W,Z,ee){var te=null,ae=0,le,ye,fe,pe;ee=ee||{},ye=ee.includeFallbackColors,fe=ee.level,pe=ee.size;for(var ge=0;ge<Z.length;ge++)le=t.readability(W,Z[ge]),le>ae&&(ae=le,te=t(Z[ge]));return t.isReadable(W,te,{level:fe,size:pe})||!ye?te:(ee.includeFallbackColors=!1,t.mostReadable(W,["#fff","#000"],ee))};var D=t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},R=t.hexNames=B(D);function B(W){var Z={};for(var ee in W)W.hasOwnProperty(ee)&&(Z[W[ee]]=ee);return Z}function F(W){return W=parseFloat(W),(isNaN(W)||W<0||W>1)&&(W=1),W}function V(W,Z){j(W)&&(W="100%");var ee=Y(W);return W=a(Z,n(0,parseFloat(W))),ee&&(W=parseInt(W*Z,10)/100),w.abs(W-Z)<1e-6?1:W%Z/parseFloat(Z)}function G(W){return a(1,n(0,W))}function J(W){return parseInt(W,16)}function j(W){return typeof W=="string"&&W.indexOf(".")!=-1&&parseFloat(W)===1}function Y(W){return typeof W=="string"&&W.indexOf("%")!=-1}function X(W){return W.length==1?"0"+W:""+W}function oe(W){return W<=1&&(W=W*100+"%"),W}function se(W){return w.round(parseFloat(W)*255).toString(16)}function ie(W){return J(W)/255}var N=function(){var W="[-\\+]?\\d+%?",Z="[-\\+]?\\d*\\.\\d+%?",ee="(?:"+Z+")|(?:"+W+")",te="[\\s|\\(]+("+ee+")[,|\\s]+("+ee+")[,|\\s]+("+ee+")\\s*\\)?",ae="[\\s|\\(]+("+ee+")[,|\\s]+("+ee+")[,|\\s]+("+ee+")[,|\\s]+("+ee+")\\s*\\)?";return{CSS_UNIT:new RegExp(ee),rgb:new RegExp("rgb"+te),rgba:new RegExp("rgba"+ae),hsl:new RegExp("hsl"+te),hsla:new RegExp("hsla"+ae),hsv:new RegExp("hsv"+te),hsva:new RegExp("hsva"+ae),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function U(W){return!!N.CSS_UNIT.exec(W)}function q(W){W=W.replace(c,"").replace(M,"").toLowerCase();var Z=!1;if(D[W])W=D[W],Z=!0;else if(W=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var ee;return(ee=N.rgb.exec(W))?{r:ee[1],g:ee[2],b:ee[3]}:(ee=N.rgba.exec(W))?{r:ee[1],g:ee[2],b:ee[3],a:ee[4]}:(ee=N.hsl.exec(W))?{h:ee[1],s:ee[2],l:ee[3]}:(ee=N.hsla.exec(W))?{h:ee[1],s:ee[2],l:ee[3],a:ee[4]}:(ee=N.hsv.exec(W))?{h:ee[1],s:ee[2],v:ee[3]}:(ee=N.hsva.exec(W))?{h:ee[1],s:ee[2],v:ee[3],a:ee[4]}:(ee=N.hex8.exec(W))?{r:J(ee[1]),g:J(ee[2]),b:J(ee[3]),a:ie(ee[4]),format:Z?"name":"hex8"}:(ee=N.hex6.exec(W))?{r:J(ee[1]),g:J(ee[2]),b:J(ee[3]),format:Z?"name":"hex"}:(ee=N.hex4.exec(W))?{r:J(ee[1]+""+ee[1]),g:J(ee[2]+""+ee[2]),b:J(ee[3]+""+ee[3]),a:ie(ee[4]+""+ee[4]),format:Z?"name":"hex8"}:(ee=N.hex3.exec(W))?{r:J(ee[1]+""+ee[1]),g:J(ee[2]+""+ee[2]),b:J(ee[3]+""+ee[3]),format:Z?"name":"hex"}:!1}function Q(W){var Z,ee;return W=W||{level:"AA",size:"small"},Z=(W.level||"AA").toUpperCase(),ee=(W.size||"small").toLowerCase(),Z!=="AA"&&Z!=="AAA"&&(Z="AA"),ee!=="small"&&ee!=="large"&&(ee="small"),{level:Z,size:ee}}typeof re!="undefined"&&re.exports?re.exports=t:window.tinycolor=t})(Math)},{}],313:[function(d,re,ne){re.exports=M,re.exports.float32=re.exports.float=M,re.exports.fract32=re.exports.fract=c;var w=new Float32Array(1);function c(T,e){if(T.length){if(T instanceof Float32Array)return new Float32Array(T.length);e instanceof Float32Array||(e=M(T));for(var a=0,n=e.length;a<n;a++)e[a]=T[a]-e[a];return e}return M(T-M(T))}function M(T){return T.length?T instanceof Float32Array?T:new Float32Array(T):(w[0]=T,w[0])}},{}],314:[function(d,re,ne){var w=d("parse-unit");re.exports=e;var c=96;function M(a,n){var r=w(getComputedStyle(a).getPropertyValue(n));return r[0]*e(r[1],a)}function T(a,n){var r=document.createElement("div");r.style["font-size"]="128"+a,n.appendChild(r);var t=M(r,"font-size")/128;return n.removeChild(r),t}function e(a,n){switch(n=n||document.body,a=(a||"px").trim().toLowerCase(),(n===window||n===document)&&(n=document.body),a){case"%":return n.clientHeight/100;case"ch":case"ex":return T(a,n);case"em":return M(n,"font-size");case"rem":return M(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return c;case"cm":return c/2.54;case"mm":return c/25.4;case"pt":return c/72;case"pc":return c/6}return 1}},{"parse-unit":251}],315:[function(d,re,ne){(function(w,c){typeof ne=="object"&&typeof re!="undefined"?c(ne):(w=w||self,c(w.topojson=w.topojson||{}))})(this,function(w){function c(s){return s}function M(s){if(s==null)return c;var A,x,v=s.scale[0],b=s.scale[1],l=s.translate[0],L=s.translate[1];return function(S,k){k||(A=x=0);var P=2,z=S.length,I=new Array(z);for(I[0]=(A+=S[0])*v+l,I[1]=(x+=S[1])*b+L;P<z;)I[P]=S[P],++P;return I}}function T(s){var A=M(s.transform),x,v=1/0,b=v,l=-v,L=-v;function S(P){P=A(P),P[0]<v&&(v=P[0]),P[0]>l&&(l=P[0]),P[1]<b&&(b=P[1]),P[1]>L&&(L=P[1])}function k(P){switch(P.type){case"GeometryCollection":P.geometries.forEach(k);break;case"Point":S(P.coordinates);break;case"MultiPoint":P.coordinates.forEach(S);break}}s.arcs.forEach(function(P){for(var z=-1,I=P.length,D;++z<I;)D=A(P[z],z),D[0]<v&&(v=D[0]),D[0]>l&&(l=D[0]),D[1]<b&&(b=D[1]),D[1]>L&&(L=D[1])});for(x in s.objects)k(s.objects[x]);return[v,b,l,L]}function e(s,A){for(var x,v=s.length,b=v-A;b<--v;)x=s[b],s[b++]=s[v],s[v]=x}function a(s,A){return typeof A=="string"&&(A=s.objects[A]),A.type==="GeometryCollection"?{type:"FeatureCollection",features:A.geometries.map(function(x){return n(s,x)})}:n(s,A)}function n(s,A){var x=A.id,v=A.bbox,b=A.properties==null?{}:A.properties,l=r(s,A);return x==null&&v==null?{type:"Feature",properties:b,geometry:l}:v==null?{type:"Feature",id:x,properties:b,geometry:l}:{type:"Feature",id:x,bbox:v,properties:b,geometry:l}}function r(s,A){var x=M(s.transform),v=s.arcs;function b(z,I){I.length&&I.pop();for(var D=v[z<0?~z:z],R=0,B=D.length;R<B;++R)I.push(x(D[R],R));z<0&&e(I,B)}function l(z){return x(z)}function L(z){for(var I=[],D=0,R=z.length;D<R;++D)b(z[D],I);return I.length<2&&I.push(I[0]),I}function S(z){for(var I=L(z);I.length<4;)I.push(I[0]);return I}function k(z){return z.map(S)}function P(z){var I=z.type,D;switch(I){case"GeometryCollection":return{type:I,geometries:z.geometries.map(P)};case"Point":D=l(z.coordinates);break;case"MultiPoint":D=z.coordinates.map(l);break;case"LineString":D=L(z.arcs);break;case"MultiLineString":D=z.arcs.map(L);break;case"Polygon":D=k(z.arcs);break;case"MultiPolygon":D=z.arcs.map(k);break;default:return null}return{type:I,coordinates:D}}return P(A)}function t(s,A){var x={},v={},b={},l=[],L=-1;A.forEach(function(P,z){var I=s.arcs[P<0?~P:P],D;I.length<3&&!I[1][0]&&!I[1][1]&&(D=A[++L],A[L]=P,A[z]=D)}),A.forEach(function(P){var z=S(P),I=z[0],D=z[1],R,B;if(R=b[I])if(delete b[R.end],R.push(P),R.end=D,B=v[D]){delete v[B.start];var F=B===R?R:R.concat(B);v[F.start=R.start]=b[F.end=B.end]=F}else v[R.start]=b[R.end]=R;else if(R=v[D])if(delete v[R.start],R.unshift(P),R.start=I,B=b[I]){delete b[B.end];var V=B===R?R:B.concat(R);v[V.start=B.start]=b[V.end=R.end]=V}else v[R.start]=b[R.end]=R;else R=[P],v[R.start=I]=b[R.end=D]=R});function S(P){var z=s.arcs[P<0?~P:P],I=z[0],D;return s.transform?(D=[0,0],z.forEach(function(R){D[0]+=R[0],D[1]+=R[1]})):D=z[z.length-1],P<0?[D,I]:[I,D]}function k(P,z){for(var I in P){var D=P[I];delete z[D.start],delete D.start,delete D.end,D.forEach(function(R){x[R<0?~R:R]=1}),l.push(D)}}return k(b,v),k(v,b),A.forEach(function(P){x[P<0?~P:P]||l.push([P])}),l}function f(s){return r(s,o.apply(this,arguments))}function o(s,A,x){var v,b,l;if(arguments.length>1)v=i(s,A,x);else for(b=0,v=new Array(l=s.arcs.length);b<l;++b)v[b]=b;return{type:"MultiLineString",arcs:t(s,v)}}function i(s,A,x){var v=[],b=[],l;function L(I){var D=I<0?~I:I;(b[D]||(b[D]=[])).push({i:I,g:l})}function S(I){I.forEach(L)}function k(I){I.forEach(S)}function P(I){I.forEach(k)}function z(I){switch(l=I,I.type){case"GeometryCollection":I.geometries.forEach(z);break;case"LineString":S(I.arcs);break;case"MultiLineString":case"Polygon":k(I.arcs);break;case"MultiPolygon":P(I.arcs);break}}return z(A),b.forEach(x==null?function(I){v.push(I[0].i)}:function(I){x(I[0].g,I[I.length-1].g)&&v.push(I[0].i)}),v}function g(s){for(var A=-1,x=s.length,v,b=s[x-1],l=0;++A<x;)v=b,b=s[A],l+=v[0]*b[1]-v[1]*b[0];return Math.abs(l)}function p(s){return r(s,y.apply(this,arguments))}function y(s,A){var x={},v=[],b=[];A.forEach(l);function l(k){switch(k.type){case"GeometryCollection":k.geometries.forEach(l);break;case"Polygon":L(k.arcs);break;case"MultiPolygon":k.arcs.forEach(L);break}}function L(k){k.forEach(function(P){P.forEach(function(z){(x[z=z<0?~z:z]||(x[z]=[])).push(k)})}),v.push(k)}function S(k){return g(r(s,{type:"Polygon",arcs:[k]}).coordinates[0])}return v.forEach(function(k){if(!k._){var P=[],z=[k];for(k._=1,b.push(P);k=z.pop();)P.push(k),k.forEach(function(I){I.forEach(function(D){x[D<0?~D:D].forEach(function(R){R._||(R._=1,z.push(R))})})})}}),v.forEach(function(k){delete k._}),{type:"MultiPolygon",arcs:b.map(function(k){var P=[],z;if(k.forEach(function(F){F.forEach(function(V){V.forEach(function(G){x[G<0?~G:G].length<2&&P.push(G)})})}),P=t(s,P),(z=P.length)>1)for(var I=1,D=S(P[0]),R,B;I<z;++I)(R=S(P[I]))>D&&(B=P[0],P[0]=P[I],P[I]=B,D=R);return P}).filter(function(k){return k.length>0})}}function h(s,A){for(var x=0,v=s.length;x<v;){var b=x+v>>>1;s[b]<A?x=b+1:v=b}return x}function m(s){var A={},x=s.map(function(){return[]});function v(F,V){F.forEach(function(G){G<0&&(G=~G);var J=A[G];J?J.push(V):A[G]=[V]})}function b(F,V){F.forEach(function(G){v(G,V)})}function l(F,V){F.type==="GeometryCollection"?F.geometries.forEach(function(G){l(G,V)}):F.type in L&&L[F.type](F.arcs,V)}var L={LineString:v,MultiLineString:b,Polygon:b,MultiPolygon:function(F,V){F.forEach(function(G){b(G,V)})}};s.forEach(l);for(var S in A)for(var k=A[S],P=k.length,z=0;z<P;++z)for(var I=z+1;I<P;++I){var D=k[z],R=k[I],B;(B=x[D])[S=h(B,R)]!==R&&B.splice(S,0,R),(B=x[R])[S=h(B,D)]!==D&&B.splice(S,0,D)}return x}function u(s){if(s==null)return c;var A,x,v=s.scale[0],b=s.scale[1],l=s.translate[0],L=s.translate[1];return function(S,k){k||(A=x=0);var P=2,z=S.length,I=new Array(z),D=Math.round((S[0]-l)/v),R=Math.round((S[1]-L)/b);for(I[0]=D-A,A=D,I[1]=R-x,x=R;P<z;)I[P]=S[P],++P;return I}}function _(s,A){if(s.transform)throw new Error("already quantized");if(!A||!A.scale){if(!((L=Math.floor(A))>=2))throw new Error("n must be \u22652");k=s.bbox||T(s);var x=k[0],v=k[1],b=k[2],l=k[3],L;A={scale:[b-x?(b-x)/(L-1):1,l-v?(l-v)/(L-1):1],translate:[x,v]}}else k=s.bbox;var S=u(A),k,P,z=s.objects,I={};function D(F){return S(F)}function R(F){var V;switch(F.type){case"GeometryCollection":V={type:"GeometryCollection",geometries:F.geometries.map(R)};break;case"Point":V={type:"Point",coordinates:D(F.coordinates)};break;case"MultiPoint":V={type:"MultiPoint",coordinates:F.coordinates.map(D)};break;default:return F}return F.id!=null&&(V.id=F.id),F.bbox!=null&&(V.bbox=F.bbox),F.properties!=null&&(V.properties=F.properties),V}function B(F){var V=0,G=1,J=F.length,j,Y=new Array(J);for(Y[0]=S(F[0],0);++V<J;)((j=S(F[V],V))[0]||j[1])&&(Y[G++]=j);return G===1&&(Y[G++]=[0,0]),Y.length=G,Y}for(P in z)I[P]=R(z[P]);return{type:"Topology",bbox:k,transform:A,objects:I,arcs:s.arcs.map(B)}}w.bbox=T,w.feature=a,w.merge=p,w.mergeArcs=y,w.mesh=f,w.meshArcs=o,w.neighbors=m,w.quantize=_,w.transform=M,w.untransform=u,Object.defineProperty(w,"__esModule",{value:!0})})},{}],316:[function(d,re,ne){var w=d("../prototype/is");re.exports=function(c){if(typeof c!="function"||!hasOwnProperty.call(c,"length"))return!1;try{if(typeof c.length!="number"||typeof c.call!="function"||typeof c.apply!="function")return!1}catch{return!1}return!w(c)}},{"../prototype/is":323}],317:[function(d,re,ne){var w=d("../value/is"),c=d("../object/is"),M=d("../string/coerce"),T=d("./to-short-string"),e=function(a,n){return a.replace("%v",T(n))};re.exports=function(a,n,r){if(!c(r))throw new TypeError(e(n,a));if(!w(a)){if("default"in r)return r.default;if(r.isOptional)return null}var t=M(r.errorMessage);throw w(t)||(t=n),new TypeError(e(t,a))}},{"../object/is":320,"../string/coerce":324,"../value/is":326,"./to-short-string":319}],318:[function(d,re,ne){re.exports=function(w){try{return w.toString()}catch{try{return String(w)}catch{return null}}}},{}],319:[function(d,re,ne){var w=d("./safe-to-string"),c=/[\n\r\u2028\u2029]/g;re.exports=function(M){var T=w(M);return T===null?"<Non-coercible to string value>":(T.length>100&&(T=T.slice(0,99)+"\u2026"),T=T.replace(c,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}),T)}},{"./safe-to-string":318}],320:[function(d,re,ne){var w=d("../value/is"),c={object:!0,function:!0,undefined:!0};re.exports=function(M){return w(M)?hasOwnProperty.call(c,typeof M):!1}},{"../value/is":326}],321:[function(d,re,ne){var w=d("../lib/resolve-exception"),c=d("./is");re.exports=function(M){return c(M)?M:w(M,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":317,"./is":322}],322:[function(d,re,ne){var w=d("../function/is"),c=/^\s*class[\s{/}]/,M=Function.prototype.toString;re.exports=function(T){return!(!w(T)||c.test(M.call(T)))}},{"../function/is":316}],323:[function(d,re,ne){var w=d("../object/is");re.exports=function(c){if(!w(c))return!1;try{return c.constructor?c.constructor.prototype===c:!1}catch{return!1}}},{"../object/is":320}],324:[function(d,re,ne){var w=d("../value/is"),c=d("../object/is"),M=Object.prototype.toString;re.exports=function(T){if(!w(T))return null;if(c(T)){var e=T.toString;if(typeof e!="function"||e===M)return null}try{return""+T}catch{return null}}},{"../object/is":320,"../value/is":326}],325:[function(d,re,ne){var w=d("../lib/resolve-exception"),c=d("./is");re.exports=function(M){return c(M)?M:w(M,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":317,"./is":326}],326:[function(d,re,ne){var w=void 0;re.exports=function(c){return c!==w&&c!==null}},{}],327:[function(d,re,ne){(function(w){(function(){var c=d("bit-twiddle"),M=d("dup"),T=d("buffer").Buffer;w.__TYPEDARRAY_POOL||(w.__TYPEDARRAY_POOL={UINT8:M([32,0]),UINT16:M([32,0]),UINT32:M([32,0]),BIGUINT64:M([32,0]),INT8:M([32,0]),INT16:M([32,0]),INT32:M([32,0]),BIGINT64:M([32,0]),FLOAT:M([32,0]),DOUBLE:M([32,0]),DATA:M([32,0]),UINT8C:M([32,0]),BUFFER:M([32,0])});var e=typeof Uint8ClampedArray!="undefined",a=typeof BigUint64Array!="undefined",n=typeof BigInt64Array!="undefined",r=w.__TYPEDARRAY_POOL;r.UINT8C||(r.UINT8C=M([32,0])),r.BIGUINT64||(r.BIGUINT64=M([32,0])),r.BIGINT64||(r.BIGINT64=M([32,0])),r.BUFFER||(r.BUFFER=M([32,0]));var t=r.DATA,f=r.BUFFER;ne.free=function(k){if(T.isBuffer(k))f[c.log2(k.length)].push(k);else{if(Object.prototype.toString.call(k)!=="[object ArrayBuffer]"&&(k=k.buffer),!k)return;var P=k.length||k.byteLength,z=c.log2(P)|0;t[z].push(k)}};function o(S){if(!!S){var k=S.length||S.byteLength,P=c.log2(k);t[P].push(S)}}function i(S){o(S.buffer)}ne.freeUint8=ne.freeUint16=ne.freeUint32=ne.freeBigUint64=ne.freeInt8=ne.freeInt16=ne.freeInt32=ne.freeBigInt64=ne.freeFloat32=ne.freeFloat=ne.freeFloat64=ne.freeDouble=ne.freeUint8Clamped=ne.freeDataView=i,ne.freeArrayBuffer=o,ne.freeBuffer=function(k){f[c.log2(k.length)].push(k)},ne.malloc=function(k,P){if(P===void 0||P==="arraybuffer")return g(k);switch(P){case"uint8":return p(k);case"uint16":return y(k);case"uint32":return h(k);case"int8":return m(k);case"int16":return u(k);case"int32":return _(k);case"float":case"float32":return s(k);case"double":case"float64":return A(k);case"uint8_clamped":return x(k);case"bigint64":return b(k);case"biguint64":return v(k);case"buffer":return L(k);case"data":case"dataview":return l(k);default:return null}return null};function g(k){var k=c.nextPow2(k),P=c.log2(k),z=t[P];return z.length>0?z.pop():new ArrayBuffer(k)}ne.mallocArrayBuffer=g;function p(S){return new Uint8Array(g(S),0,S)}ne.mallocUint8=p;function y(S){return new Uint16Array(g(2*S),0,S)}ne.mallocUint16=y;function h(S){return new Uint32Array(g(4*S),0,S)}ne.mallocUint32=h;function m(S){return new Int8Array(g(S),0,S)}ne.mallocInt8=m;function u(S){return new Int16Array(g(2*S),0,S)}ne.mallocInt16=u;function _(S){return new Int32Array(g(4*S),0,S)}ne.mallocInt32=_;function s(S){return new Float32Array(g(4*S),0,S)}ne.mallocFloat32=ne.mallocFloat=s;function A(S){return new Float64Array(g(8*S),0,S)}ne.mallocFloat64=ne.mallocDouble=A;function x(S){return e?new Uint8ClampedArray(g(S),0,S):p(S)}ne.mallocUint8Clamped=x;function v(S){return a?new BigUint64Array(g(8*S),0,S):null}ne.mallocBigUint64=v;function b(S){return n?new BigInt64Array(g(8*S),0,S):null}ne.mallocBigInt64=b;function l(S){return new DataView(g(S),0,S)}ne.mallocDataView=l;function L(S){S=c.nextPow2(S);var k=c.log2(S),P=f[k];return P.length>0?P.pop():new T(S)}ne.mallocBuffer=L,ne.clearCache=function(){for(var k=0;k<32;++k)r.UINT8[k].length=0,r.UINT16[k].length=0,r.UINT32[k].length=0,r.INT8[k].length=0,r.INT16[k].length=0,r.INT32[k].length=0,r.FLOAT[k].length=0,r.DOUBLE[k].length=0,r.BIGUINT64[k].length=0,r.BIGINT64[k].length=0,r.UINT8C[k].length=0,t[k].length=0,f[k].length=0}}).call(this)}).call(this,typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],328:[function(d,re,ne){var w=/[\'\"]/;re.exports=function(M){return M?(w.test(M.charAt(0))&&(M=M.substr(1)),w.test(M.charAt(M.length-1))&&(M=M.substr(0,M.length-1)),M):""}},{}],329:[function(d,re,ne){re.exports=function(c,M,T){Array.isArray(T)||(T=[].slice.call(arguments,2));for(var e=0,a=T.length;e<a;e++){var n=T[e];for(var r in n)if(!(M[r]!==void 0&&!Array.isArray(M[r])&&c[r]===M[r])&&r in M){var t;if(n[r]===!0)t=M[r];else{if(n[r]===!1)continue;if(typeof n[r]=="function"&&(t=n[r](M[r],c,M),t===void 0))continue}c[r]=t}}return c}},{}],330:[function(d,re,ne){(function(w){(function(){re.exports=c;function c(T,e){if(M("noDeprecation"))return T;var a=!1;function n(){if(!a){if(M("throwDeprecation"))throw new Error(e);M("traceDeprecation")?console.trace(e):console.warn(e),a=!0}return T.apply(this,arguments)}return n}function M(T){try{if(!w.localStorage)return!1}catch{return!1}var e=w.localStorage[T];return e==null?!1:String(e).toLowerCase()==="true"}}).call(this)}).call(this,typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],331:[function(d,re,ne){var w=d("get-canvas-context");re.exports=function(M){return w("webgl",M)}},{"get-canvas-context":194}],332:[function(d,re,ne){var w=d("../main"),c=d("object-assign"),M=w.instance();function T(g){this.local=this.regionalOptions[g||""]||this.regionalOptions[""]}T.prototype=new w.baseCalendar,c(T.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(g,p){if(typeof g=="string"){var y=g.match(a);return y?y[0]:""}var h=this._validateYear(g),m=g.month(),u=""+this.toChineseMonth(h,m);return p&&u.length<2&&(u="0"+u),this.isIntercalaryMonth(h,m)&&(u+="i"),u},monthNames:function(g){if(typeof g=="string"){var p=g.match(n);return p?p[0]:""}var y=this._validateYear(g),h=g.month(),m=this.toChineseMonth(y,h),u=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][m-1];return this.isIntercalaryMonth(y,h)&&(u="\u95F0"+u),u},monthNamesShort:function(g){if(typeof g=="string"){var p=g.match(r);return p?p[0]:""}var y=this._validateYear(g),h=g.month(),m=this.toChineseMonth(y,h),u=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][m-1];return this.isIntercalaryMonth(y,h)&&(u="\u95F0"+u),u},parseMonth:function(g,p){g=this._validateYear(g);var y=parseInt(p),h;if(isNaN(y))p[0]==="\u95F0"&&(h=!0,p=p.substring(1)),p[p.length-1]==="\u6708"&&(p=p.substring(0,p.length-1)),y=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(p);else{var m=p[p.length-1];h=m==="i"||m==="I"}var u=this.toMonthIndex(g,y,h);return u},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(g,p){if(g.year&&(g=g.year()),typeof g!="number"||g<1888||g>2111)throw p.replace(/\{0\}/,this.local.name);return g},toMonthIndex:function(g,p,y){var h=this.intercalaryMonth(g),m=y&&p!==h;if(m||p<1||p>12)throw w.local.invalidMonth.replace(/\{0\}/,this.local.name);var u;return h?!y&&p<=h?u=p-1:u=p:u=p-1,u},toChineseMonth:function(g,p){g.year&&(g=g.year(),p=g.month());var y=this.intercalaryMonth(g),h=y?12:11;if(p<0||p>h)throw w.local.invalidMonth.replace(/\{0\}/,this.local.name);var m;return y?p<y?m=p+1:m=p:m=p+1,m},intercalaryMonth:function(g){g=this._validateYear(g);var p=t[g-t[0]],y=p>>13;return y},isIntercalaryMonth:function(g,p){g.year&&(g=g.year(),p=g.month());var y=this.intercalaryMonth(g);return!!y&&y===p},leapYear:function(g){return this.intercalaryMonth(g)!==0},weekOfYear:function(g,p,y){var h=this._validateYear(g,w.local.invalidyear),m=f[h-f[0]],u=m>>9&4095,_=m>>5&15,s=m&31,A;A=M.newDate(u,_,s),A.add(4-(A.dayOfWeek()||7),"d");var x=this.toJD(g,p,y)-A.toJD();return 1+Math.floor(x/7)},monthsInYear:function(g){return this.leapYear(g)?13:12},daysInMonth:function(g,p){g.year&&(p=g.month(),g=g.year()),g=this._validateYear(g);var y=t[g-t[0]],h=y>>13,m=h?12:11;if(p>m)throw w.local.invalidMonth.replace(/\{0\}/,this.local.name);var u=y&1<<12-p?30:29;return u},weekDay:function(g,p,y){return(this.dayOfWeek(g,p,y)||7)<6},toJD:function(g,p,y){var h=this._validate(g,u,y,w.local.invalidDate);g=this._validateYear(h.year()),p=h.month(),y=h.day();var m=this.isIntercalaryMonth(g,p),u=this.toChineseMonth(g,p),_=i(g,u,y,m);return M.toJD(_.year,_.month,_.day)},fromJD:function(g){var p=M.fromJD(g),y=o(p.year(),p.month(),p.day()),h=this.toMonthIndex(y.year,y.month,y.isIntercalary);return this.newDate(y.year,h,y.day)},fromString:function(g){var p=g.match(e),y=this._validateYear(+p[1]),h=+p[2],m=!!p[3],u=this.toMonthIndex(y,h,m),_=+p[4];return this.newDate(y,u,_)},add:function(g,p,y){var h=g.year(),m=g.month(),u=this.isIntercalaryMonth(h,m),_=this.toChineseMonth(h,m),s=Object.getPrototypeOf(T.prototype).add.call(this,g,p,y);if(y==="y"){var A=s.year(),x=s.month(),v=this.isIntercalaryMonth(A,_),b=u&&v?this.toMonthIndex(A,_,!0):this.toMonthIndex(A,_,!1);b!==x&&s.month(b)}return s}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,a=/^\d?\d[iI]?/m,n=/^??[]?/m,r=/^??[]?/m;w.calendars.chinese=T;var t=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],f=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function o(g,p,y,h){var m,u;if(typeof g=="object")m=g,u=p||{};else{var _=typeof g=="number"&&g>=1888&&g<=2111;if(!_)throw new Error("Solar year outside range 1888-2111");var s=typeof p=="number"&&p>=1&&p<=12;if(!s)throw new Error("Solar month outside range 1 - 12");var A=typeof y=="number"&&y>=1&&y<=31;if(!A)throw new Error("Solar day outside range 1 - 31");m={year:g,month:p,day:y},u=h||{}}var x=f[m.year-f[0]],v=m.year<<9|m.month<<5|m.day;u.year=v>=x?m.year:m.year-1,x=f[u.year-f[0]];var b=x>>9&4095,l=x>>5&15,L=x&31,S,k=new Date(b,l-1,L),P=new Date(m.year,m.month-1,m.day);S=Math.round((P-k)/(24*3600*1e3));var z=t[u.year-t[0]],I;for(I=0;I<13;I++){var D=z&1<<12-I?30:29;if(S<D)break;S-=D}var R=z>>13;return!R||I<R?(u.isIntercalary=!1,u.month=1+I):I===R?(u.isIntercalary=!0,u.month=I):(u.isIntercalary=!1,u.month=I),u.day=1+S,u}function i(g,p,y,h,m){var u,_;if(typeof g=="object")_=g,u=p||{};else{var s=typeof g=="number"&&g>=1888&&g<=2111;if(!s)throw new Error("Lunar year outside range 1888-2111");var A=typeof p=="number"&&p>=1&&p<=12;if(!A)throw new Error("Lunar month outside range 1 - 12");var x=typeof y=="number"&&y>=1&&y<=30;if(!x)throw new Error("Lunar day outside range 1 - 30");var v;typeof h=="object"?(v=!1,u=h):(v=!!h,u=m||{}),_={year:g,month:p,day:y,isIntercalary:v}}var b;b=_.day-1;var l=t[_.year-t[0]],L=l>>13,S;L&&(_.month>L||_.isIntercalary)?S=_.month:S=_.month-1;for(var k=0;k<S;k++){var P=l&1<<12-k?30:29;b+=P}var z=f[_.year-f[0]],I=z>>9&4095,D=z>>5&15,R=z&31,B=new Date(I,D-1,R+b);return u.year=B.getFullYear(),u.month=1+B.getMonth(),u.day=B.getDate(),u}},{"../main":346,"object-assign":247}],333:[function(d,re,ne){var w=d("../main"),c=d("object-assign");function M(T){this.local=this.regionalOptions[T||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,c(M.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),a=e.year()+(e.year()<0?1:0);return a%4===3||a%4===-1},monthsInYear:function(T){return this._validate(T,this.minMonth,this.minDay,w.local.invalidYear||w.regionalOptions[""].invalidYear),13},weekOfYear:function(T,e,a){var n=this.newDate(T,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(T,e){var a=this._validate(T,e,this.minDay,w.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===13&&this.leapYear(a.year())?1:0)},weekDay:function(T,e,a){return(this.dayOfWeek(T,e,a)||7)<6},toJD:function(T,e,a){var n=this._validate(T,e,a,w.local.invalidDate);return T=n.year(),T<0&&T++,n.day()+(n.month()-1)*30+(T-1)*365+Math.floor(T/4)+this.jdEpoch-1},fromJD:function(T){var e=Math.floor(T)+.5-this.jdEpoch,a=Math.floor((e-Math.floor((e+366)/1461))/365)+1;a<=0&&a--,e=Math.floor(T)+.5-this.newDate(a,1,1).toJD();var n=Math.floor(e/30)+1,r=e-(n-1)*30+1;return this.newDate(a,n,r)}}),w.calendars.coptic=M},{"../main":346,"object-assign":247}],334:[function(d,re,ne){var w=d("../main"),c=d("object-assign");function M(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,c(M.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,w.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,w.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,w.local.invalidYear),400},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/8)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,w.local.invalidMonth);return this.daysPerMonth[n.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);return(r.day()+1)%8},weekDay:function(e,a,n){var r=this.dayOfWeek(e,a,n);return r>=2&&r<=6},extraInfo:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);return{century:T[Math.floor((r.year()-1)/100)+1]||""}},toJD:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);return e=r.year()+(r.year()<0?1:0),a=r.month(),n=r.day(),n+(a>1?16:0)+(a>2?(a-2)*32:0)+(e-1)*400+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var a=Math.floor(e/400)+1;e-=(a-1)*400,e+=e>15?16:0;var n=Math.floor(e/32)+1,r=e-(n-1)*32+1;return this.newDate(a<=0?a-1:a,n,r)}});var T={20:"Fruitbat",21:"Anchovy"};w.calendars.discworld=M},{"../main":346,"object-assign":247}],335:[function(d,re,ne){var w=d("../main"),c=d("object-assign");function M(T){this.local=this.regionalOptions[T||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,c(M.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),a=e.year()+(e.year()<0?1:0);return a%4===3||a%4===-1},monthsInYear:function(T){return this._validate(T,this.minMonth,this.minDay,w.local.invalidYear||w.regionalOptions[""].invalidYear),13},weekOfYear:function(T,e,a){var n=this.newDate(T,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(T,e){var a=this._validate(T,e,this.minDay,w.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===13&&this.leapYear(a.year())?1:0)},weekDay:function(T,e,a){return(this.dayOfWeek(T,e,a)||7)<6},toJD:function(T,e,a){var n=this._validate(T,e,a,w.local.invalidDate);return T=n.year(),T<0&&T++,n.day()+(n.month()-1)*30+(T-1)*365+Math.floor(T/4)+this.jdEpoch-1},fromJD:function(T){var e=Math.floor(T)+.5-this.jdEpoch,a=Math.floor((e-Math.floor((e+366)/1461))/365)+1;a<=0&&a--,e=Math.floor(T)+.5-this.newDate(a,1,1).toJD();var n=Math.floor(e/30)+1,r=e-(n-1)*30+1;return this.newDate(a,n,r)}}),w.calendars.ethiopian=M},{"../main":346,"object-assign":247}],336:[function(d,re,ne){var w=d("../main"),c=d("object-assign");function M(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,c(M.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,w.local.invalidYear);return this._leapYear(a.year())},_leapYear:function(e){return e=e<0?e+1:e,T(e*7+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,w.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,w.local.invalidYear);return e=a.year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,a){return e.year&&(a=e.month(),e=e.year()),this._validate(e,a,this.minDay,w.local.invalidMonth),a===12&&this.leapYear(e)||a===8&&T(this.daysInYear(e),10)===5?30:a===9&&T(this.daysInYear(e),10)===3?29:this.daysPerMonth[a-1]},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==6},extraInfo:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);return{yearType:(this.leapYear(r)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(r)%10-3]}},toJD:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);e=r.year(),a=r.month(),n=r.day();var t=e<=0?e+1:e,f=this.jdEpoch+this._delay1(t)+this._delay2(t)+n+1;if(a<7){for(var o=7;o<=this.monthsInYear(e);o++)f+=this.daysInMonth(e,o);for(var o=1;o<a;o++)f+=this.daysInMonth(e,o)}else for(var o=7;o<a;o++)f+=this.daysInMonth(e,o);return f},_delay1:function(e){var a=Math.floor((235*e-234)/19),n=12084+13753*a,r=a*29+Math.floor(n/25920);return T(3*(r+1),7)<3&&r++,r},_delay2:function(e){var a=this._delay1(e-1),n=this._delay1(e),r=this._delay1(e+1);return r-n===356?2:n-a===382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var a=Math.floor((e-this.jdEpoch)*98496/35975351)-1;e>=this.toJD(a===-1?1:a+1,7,1);)a++;for(var n=e<this.toJD(a,1,1)?7:1;e>this.toJD(a,n,this.daysInMonth(a,n));)n++;var r=e-this.toJD(a,n,1)+1;return this.newDate(a,n,r)}});function T(e,a){return e-a*Math.floor(e/a)}w.calendars.hebrew=M},{"../main":346,"object-assign":247}],337:[function(d,re,ne){var w=d("../main"),c=d("object-assign");function M(T){this.local=this.regionalOptions[T||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,c(M.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(T){var e=this._validate(T,this.minMonth,this.minDay,w.local.invalidYear);return(e.year()*11+14)%30<11},weekOfYear:function(T,e,a){var n=this.newDate(T,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(T){return this.leapYear(T)?355:354},daysInMonth:function(T,e){var a=this._validate(T,e,this.minDay,w.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===12&&this.leapYear(a.year())?1:0)},weekDay:function(T,e,a){return this.dayOfWeek(T,e,a)!==5},toJD:function(T,e,a){var n=this._validate(T,e,a,w.local.invalidDate);return T=n.year(),e=n.month(),a=n.day(),T=T<=0?T+1:T,a+Math.ceil(29.5*(e-1))+(T-1)*354+Math.floor((3+11*T)/30)+this.jdEpoch-1},fromJD:function(T){T=Math.floor(T)+.5;var e=Math.floor((30*(T-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var a=Math.min(12,Math.ceil((T-29-this.toJD(e,1,1))/29.5)+1),n=T-this.toJD(e,a,1)+1;return this.newDate(e,a,n)}}),w.calendars.islamic=M},{"../main":346,"object-assign":247}],338:[function(d,re,ne){var w=d("../main"),c=d("object-assign");function M(T){this.local=this.regionalOptions[T||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,c(M.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(a){var e=this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),a=e.year()<0?e.year()+1:e.year();return a%4===0},weekOfYear:function(T,e,a){var n=this.newDate(T,e,a);return n.add(4-(n.dayOfWeek()||7),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(T,e){var a=this._validate(T,e,this.minDay,w.local.invalidMonth);return this.daysPerMonth[a.month()-1]+(a.month()===2&&this.leapYear(a.year())?1:0)},weekDay:function(T,e,a){return(this.dayOfWeek(T,e,a)||7)<6},toJD:function(T,e,a){var n=this._validate(T,e,a,w.local.invalidDate);return T=n.year(),e=n.month(),a=n.day(),T<0&&T++,e<=2&&(T--,e+=12),Math.floor(365.25*(T+4716))+Math.floor(30.6001*(e+1))+a-1524.5},fromJD:function(T){var e=Math.floor(T+.5),a=e+1524,n=Math.floor((a-122.1)/365.25),r=Math.floor(365.25*n),t=Math.floor((a-r)/30.6001),f=t-Math.floor(t<14?1:13),o=n-Math.floor(f>2?4716:4715),i=a-r-Math.floor(30.6001*t);return o<=0&&o--,this.newDate(o,f,i)}}),w.calendars.julian=M},{"../main":346,"object-assign":247}],339:[function(d,re,ne){var w=d("../main"),c=d("object-assign");function M(a){this.local=this.regionalOptions[a||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,c(M.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(a){return this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),!1},formatYear:function(a){var n=this._validate(a,this.minMonth,this.minDay,w.local.invalidYear);a=n.year();var r=Math.floor(a/400);a=a%400,a+=a<0?400:0;var t=Math.floor(a/20);return r+"."+t+"."+a%20},forYear:function(a){if(a=a.split("."),a.length<3)throw"Invalid Mayan year";for(var n=0,r=0;r<a.length;r++){var t=parseInt(a[r],10);if(Math.abs(t)>19||r>0&&t<0)throw"Invalid Mayan year";n=n*20+t}return n},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),18},weekOfYear:function(a,n,r){return this._validate(a,n,r,w.local.invalidDate),0},daysInYear:function(a){return this._validate(a,this.minMonth,this.minDay,w.local.invalidYear),360},daysInMonth:function(a,n){return this._validate(a,n,this.minDay,w.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(a,n,r){var t=this._validate(a,n,r,w.local.invalidDate);return t.day()},weekDay:function(a,n,r){return this._validate(a,n,r,w.local.invalidDate),!0},extraInfo:function(a,n,r){var t=this._validate(a,n,r,w.local.invalidDate),f=t.toJD(),o=this._toHaab(f),i=this._toTzolkin(f);return{haabMonthName:this.local.haabMonths[o[0]-1],haabMonth:o[0],haabDay:o[1],tzolkinDayName:this.local.tzolkinMonths[i[0]-1],tzolkinDay:i[0],tzolkinTrecena:i[1]}},_toHaab:function(a){a-=this.jdEpoch;var n=T(a+8+(18-1)*20,365);return[Math.floor(n/20)+1,T(n,20)]},_toTzolkin:function(a){return a-=this.jdEpoch,[e(a+20,20),e(a+4,13)]},toJD:function(a,n,r){var t=this._validate(a,n,r,w.local.invalidDate);return t.day()+t.month()*20+t.year()*360+this.jdEpoch},fromJD:function(a){a=Math.floor(a)+.5-this.jdEpoch;var n=Math.floor(a/360);a=a%360,a+=a<0?360:0;var r=Math.floor(a/20),t=a%20;return this.newDate(n,r,t)}});function T(a,n){return a-n*Math.floor(a/n)}function e(a,n){return T(a-1,n)+1}w.calendars.mayan=M},{"../main":346,"object-assign":247}],340:[function(d,re,ne){var w=d("../main"),c=d("object-assign");function M(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar;var T=w.instance("gregorian");c(M.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,w.local.invalidYear||w.regionalOptions[""].invalidYear);return T.leapYear(a.year()+(a.year()<1?1:0)+1469)},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(1-(r.dayOfWeek()||7),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,w.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,w.local.invalidMonth),t=r.year();t<0&&t++;for(var f=r.day(),o=1;o<r.month();o++)f+=this.daysPerMonth[o-1];return f+T.toJD(t+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var a=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(a+1,1,1);)a++;for(var n=e-Math.floor(this.toJD(a,1,1)+.5)+1,r=1;n>this.daysInMonth(a,r);)n-=this.daysInMonth(a,r),r++;return this.newDate(a,r,n)}}),w.calendars.nanakshahi=M},{"../main":346,"object-assign":247}],341:[function(d,re,ne){var w=d("../main"),c=d("object-assign");function M(T){this.local=this.regionalOptions[T||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,c(M.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(T){return this.daysInYear(T)!==this.daysPerYear},weekOfYear:function(T,e,a){var n=this.newDate(T,e,a);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(T){var e=this._validate(T,this.minMonth,this.minDay,w.local.invalidYear);if(T=e.year(),typeof this.NEPALI_CALENDAR_DATA[T]=="undefined")return this.daysPerYear;for(var a=0,n=this.minMonth;n<=12;n++)a+=this.NEPALI_CALENDAR_DATA[T][n];return a},daysInMonth:function(T,e){return T.year&&(e=T.month(),T=T.year()),this._validate(T,e,this.minDay,w.local.invalidMonth),typeof this.NEPALI_CALENDAR_DATA[T]=="undefined"?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[T][e]},weekDay:function(T,e,a){return this.dayOfWeek(T,e,a)!==6},toJD:function(T,e,a){var n=this._validate(T,e,a,w.local.invalidDate);T=n.year(),e=n.month(),a=n.day();var r=w.instance(),t=0,f=e,o=T;this._createMissingCalendarData(T);var i=T-(f>9||f===9&&a>=this.NEPALI_CALENDAR_DATA[o][0]?56:57);for(e!==9&&(t=a,f--);f!==9;)f<=0&&(f=12,o--),t+=this.NEPALI_CALENDAR_DATA[o][f],f--;return e===9?(t+=a-this.NEPALI_CALENDAR_DATA[o][0],t<0&&(t+=r.daysInYear(i))):t+=this.NEPALI_CALENDAR_DATA[o][9]-this.NEPALI_CALENDAR_DATA[o][0],r.newDate(i,1,1).add(t,"d").toJD()},fromJD:function(T){var e=w.instance(),a=e.fromJD(T),n=a.year(),r=a.dayOfYear(),t=n+56;this._createMissingCalendarData(t);for(var f=9,o=this.NEPALI_CALENDAR_DATA[t][0],i=this.NEPALI_CALENDAR_DATA[t][f]-o+1;r>i;)f++,f>12&&(f=1,t++),i+=this.NEPALI_CALENDAR_DATA[t][f];var g=this.NEPALI_CALENDAR_DATA[t][f]-(i-r);return this.newDate(t,f,g)},_createMissingCalendarData:function(T){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var a=T-1;a<T+2;a++)typeof this.NEPALI_CALENDAR_DATA[a]=="undefined"&&(this.NEPALI_CALENDAR_DATA[a]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),w.calendars.nepali=M},{"../main":346,"object-assign":247}],342:[function(d,re,ne){var w=d("../main"),c=d("object-assign");function M(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,c(M.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,w.local.invalidYear);return((a.year()-(a.year()>0?474:473))%2820+474+38)*682%2816<682},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-((r.dayOfWeek()+1)%7),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,w.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==5},toJD:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate);e=r.year(),a=r.month(),n=r.day();var t=e-(e>=0?474:473),f=474+T(t,2820);return n+(a<=7?(a-1)*31:(a-1)*30+6)+Math.floor((f*682-110)/2816)+(f-1)*365+Math.floor(t/2820)*1029983+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e)+.5;var a=e-this.toJD(475,1,1),n=Math.floor(a/1029983),r=T(a,1029983),t=2820;if(r!==1029982){var f=Math.floor(r/366),o=T(r,366);t=Math.floor((2134*f+2816*o+2815)/1028522)+f+1}var i=t+2820*n+474;i=i<=0?i-1:i;var g=e-this.toJD(i,1,1)+1,p=g<=186?Math.ceil(g/31):Math.ceil((g-6)/30),y=e-this.toJD(i,p,1)+1;return this.newDate(i,p,y)}});function T(e,a){return e-a*Math.floor(e/a)}w.calendars.persian=M,w.calendars.jalali=M},{"../main":346,"object-assign":247}],343:[function(d,re,ne){var w=d("../main"),c=d("object-assign"),M=w.instance();function T(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}T.prototype=new w.baseCalendar,c(T.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(n){var a=this._validate(n,this.minMonth,this.minDay,w.local.invalidYear),n=this._t2gYear(a.year());return M.leapYear(n)},weekOfYear:function(t,a,n){var r=this._validate(t,this.minMonth,this.minDay,w.local.invalidYear),t=this._t2gYear(r.year());return M.weekOfYear(t,r.month(),r.day())},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,w.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,w.local.invalidDate),t=this._t2gYear(r.year());return M.toJD(t,r.month(),r.day())},fromJD:function(e){var a=M.fromJD(e),n=this._g2tYear(a.year());return this.newDate(n,a.month(),a.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),w.calendars.taiwan=T},{"../main":346,"object-assign":247}],344:[function(d,re,ne){var w=d("../main"),c=d("object-assign"),M=w.instance();function T(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}T.prototype=new w.baseCalendar,c(T.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(n){var a=this._validate(n,this.minMonth,this.minDay,w.local.invalidYear),n=this._t2gYear(a.year());return M.leapYear(n)},weekOfYear:function(t,a,n){var r=this._validate(t,this.minMonth,this.minDay,w.local.invalidYear),t=this._t2gYear(r.year());return M.weekOfYear(t,r.month(),r.day())},daysInMonth:function(e,a){var n=this._validate(e,a,this.minDay,w.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,a,n){return(this.dayOfWeek(e,a,n)||7)<6},toJD:function(t,a,n){var r=this._validate(t,a,n,w.local.invalidDate),t=this._t2gYear(r.year());return M.toJD(t,r.month(),r.day())},fromJD:function(e){var a=M.fromJD(e),n=this._g2tYear(a.year());return this.newDate(n,a.month(),a.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),w.calendars.thai=T},{"../main":346,"object-assign":247}],345:[function(d,re,ne){var w=d("../main"),c=d("object-assign");function M(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}M.prototype=new w.baseCalendar,c(M.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var a=this._validate(e,this.minMonth,this.minDay,w.local.invalidYear);return this.daysInYear(a.year())===355},weekOfYear:function(e,a,n){var r=this.newDate(e,a,n);return r.add(-r.dayOfWeek(),"d"),Math.floor((r.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var a=0,n=1;n<=12;n++)a+=this.daysInMonth(e,n);return a},daysInMonth:function(e,a){for(var n=this._validate(e,a,this.minDay,w.local.invalidMonth),r=n.toJD()-24e5+.5,t=0,f=0;f<T.length;f++){if(T[f]>r)return T[t]-T[t-1];t++}return 30},weekDay:function(e,a,n){return this.dayOfWeek(e,a,n)!==5},toJD:function(e,a,n){var r=this._validate(e,a,n,w.local.invalidDate),t=12*(r.year()-1)+r.month()-15292,f=r.day()+T[t-1]-1;return f+24e5-.5},fromJD:function(e){for(var a=e-24e5+.5,n=0,r=0;r<T.length&&!(T[r]>a);r++)n++;var t=n+15292,f=Math.floor((t-1)/12),o=f+1,i=t-12*f,g=a-T[n-1]+1;return this.newDate(o,i,g)},isValid:function(e,a,n){var r=w.baseCalendar.prototype.isValid.apply(this,arguments);return r&&(e=e.year!=null?e.year:e,r=e>=1276&&e<=1500),r},_validate:function(e,a,n,r){var t=w.baseCalendar.prototype._validate.apply(this,arguments);if(t.year<1276||t.year>1500)throw r.replace(/\{0\}/,this.local.name);return t}}),w.calendars.ummalqura=M;var T=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":346,"object-assign":247}],346:[function(d,re,ne){var w=d("object-assign");function c(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}w(c.prototype,{instance:function(r,t){r=(r||"gregorian").toLowerCase(),t=t||"";var f=this._localCals[r+"-"+t];if(!f&&this.calendars[r]&&(f=new this.calendars[r](t),this._localCals[r+"-"+t]=f),!f)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,r);return f},newDate:function(r,t,f,o,i){return o=(r!=null&&r.year?r.calendar():typeof o=="string"?this.instance(o,i):o)||this.instance(),o.newDate(r,t,f)},substituteDigits:function(r){return function(t){return(t+"").replace(/[0-9]/g,function(f){return r[f]})}},substituteChineseDigits:function(r,t){return function(f){for(var o="",i=0;f>0;){var g=f%10;o=(g===0?"":r[g]+t[i])+o,i++,f=Math.floor(f/10)}return o.indexOf(r[1]+t[1])===0&&(o=o.substr(1)),o||r[0]}}});function M(r,t,f,o){if(this._calendar=r,this._year=t,this._month=f,this._day=o,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function T(r,t){return r=""+r,"000000".substring(0,t-r.length)+r}w(M.prototype,{newDate:function(r,t,f){return this._calendar.newDate(r==null?this:r,t,f)},year:function(r){return arguments.length===0?this._year:this.set(r,"y")},month:function(r){return arguments.length===0?this._month:this.set(r,"m")},day:function(r){return arguments.length===0?this._day:this.set(r,"d")},date:function(r,t,f){if(!this._calendar.isValid(r,t,f))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=r,this._month=t,this._day=f,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(r,t){return this._calendar.add(this,r,t)},set:function(r,t){return this._calendar.set(this,r,t)},compareTo:function(r){if(this._calendar.name!==r._calendar.name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,r._calendar.local.name);var t=this._year!==r._year?this._year-r._year:this._month!==r._month?this.monthOfYear()-r.monthOfYear():this._day-r._day;return t===0?0:t<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(r){return this._calendar.fromJD(r)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(r){return this._calendar.fromJSDate(r)},toString:function(){return(this.year()<0?"-":"")+T(Math.abs(this.year()),4)+"-"+T(this.month(),2)+"-"+T(this.day(),2)}});function e(){this.shortYearCutoff="+10"}w(e.prototype,{_validateLevel:0,newDate:function(r,t,f){return r==null?this.today():(r.year&&(this._validate(r,t,f,n.local.invalidDate||n.regionalOptions[""].invalidDate),f=r.day(),t=r.month(),r=r.year()),new M(this,r,t,f))},today:function(){return this.fromJSDate(new Date)},epoch:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return t.year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return(t.year()<0?"-":"")+T(Math.abs(t.year()),4)},monthsInYear:function(r){return this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),12},monthOfYear:function(r,t){var f=this._validate(r,t,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return(f.month()+this.monthsInYear(f)-this.firstMonth)%this.monthsInYear(f)+this.minMonth},fromMonthOfYear:function(r,t){var f=(t+this.firstMonth-2*this.minMonth)%this.monthsInYear(r)+this.minMonth;return this._validate(r,f,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth),f},daysInYear:function(r){var t=this._validate(r,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return this.leapYear(t)?366:365},dayOfYear:function(r,t,f){var o=this._validate(r,t,f,n.local.invalidDate||n.regionalOptions[""].invalidDate);return o.toJD()-this.newDate(o.year(),this.fromMonthOfYear(o.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(r,t,f){var o=this._validate(r,t,f,n.local.invalidDate||n.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(o))+2)%this.daysInWeek()},extraInfo:function(r,t,f){return this._validate(r,t,f,n.local.invalidDate||n.regionalOptions[""].invalidDate),{}},add:function(r,t,f){return this._validate(r,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate),this._correctAdd(r,this._add(r,t,f),t,f)},_add:function(r,t,f){if(this._validateLevel++,f==="d"||f==="w"){var o=r.toJD()+t*(f==="w"?this.daysInWeek():1),i=r.calendar().fromJD(o);return this._validateLevel--,[i.year(),i.month(),i.day()]}try{var g=r.year()+(f==="y"?t:0),p=r.monthOfYear()+(f==="m"?t:0),i=r.day(),y=function(u){for(;p<u.minMonth;)g--,p+=u.monthsInYear(g);for(var _=u.monthsInYear(g);p>_-1+u.minMonth;)g++,p-=_,_=u.monthsInYear(g)};f==="y"?(r.month()!==this.fromMonthOfYear(g,p)&&(p=this.newDate(g,r.month(),this.minDay).monthOfYear()),p=Math.min(p,this.monthsInYear(g)),i=Math.min(i,this.daysInMonth(g,this.fromMonthOfYear(g,p)))):f==="m"&&(y(this),i=Math.min(i,this.daysInMonth(g,this.fromMonthOfYear(g,p))));var h=[g,this.fromMonthOfYear(g,p),i];return this._validateLevel--,h}catch(m){throw this._validateLevel--,m}},_correctAdd:function(r,t,f,o){if(!this.hasYearZero&&(o==="y"||o==="m")&&(t[0]===0||r.year()>0!=t[0]>0)){var i={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[o],g=f<0?-1:1;t=this._add(r,f*i[0]+g*i[1],i[2])}return r.date(t[0],t[1],t[2])},set:function(r,t,f){this._validate(r,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate);var o=f==="y"?t:r.year(),i=f==="m"?t:r.month(),g=f==="d"?t:r.day();return(f==="y"||f==="m")&&(g=Math.min(g,this.daysInMonth(o,i))),r.date(o,i,g)},isValid:function(r,t,f){this._validateLevel++;var o=this.hasYearZero||r!==0;if(o){var i=this.newDate(r,t,this.minDay);o=t>=this.minMonth&&t-this.minMonth<this.monthsInYear(i)&&f>=this.minDay&&f-this.minDay<this.daysInMonth(i)}return this._validateLevel--,o},toJSDate:function(r,t,f){var o=this._validate(r,t,f,n.local.invalidDate||n.regionalOptions[""].invalidDate);return n.instance().fromJD(this.toJD(o)).toJSDate()},fromJSDate:function(r){return this.fromJD(n.instance().fromJSDate(r).toJD())},_validate:function(r,t,f,o){if(r.year){if(this._validateLevel===0&&this.name!==r.calendar().name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,r.calendar().local.name);return r}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(r,t,f))throw o.replace(/\{0\}/,this.local.name);var i=this.newDate(r,t,f);return this._validateLevel--,i}catch(g){throw this._validateLevel--,g}}});function a(r){this.local=this.regionalOptions[r]||this.regionalOptions[""]}a.prototype=new e,w(a.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(f){var t=this._validate(f,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),f=t.year()+(t.year()<0?1:0);return f%4===0&&(f%100!==0||f%400===0)},weekOfYear:function(r,t,f){var o=this.newDate(r,t,f);return o.add(4-(o.dayOfWeek()||7),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInMonth:function(r,t){var f=this._validate(r,t,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return this.daysPerMonth[f.month()-1]+(f.month()===2&&this.leapYear(f.year())?1:0)},weekDay:function(r,t,f){return(this.dayOfWeek(r,t,f)||7)<6},toJD:function(r,t,f){var o=this._validate(r,t,f,n.local.invalidDate||n.regionalOptions[""].invalidDate);r=o.year(),t=o.month(),f=o.day(),r<0&&r++,t<3&&(t+=12,r--);var i=Math.floor(r/100),g=2-i+Math.floor(i/4);return Math.floor(365.25*(r+4716))+Math.floor(30.6001*(t+1))+f+g-1524.5},fromJD:function(r){var t=Math.floor(r+.5),f=Math.floor((t-186721625e-2)/36524.25);f=t+1+f-Math.floor(f/4);var o=f+1524,i=Math.floor((o-122.1)/365.25),g=Math.floor(365.25*i),p=Math.floor((o-g)/30.6001),y=o-g-Math.floor(p*30.6001),h=p-(p>13.5?13:1),m=i-(h>2.5?4716:4715);return m<=0&&m--,this.newDate(m,h,y)},toJSDate:function(r,t,f){var o=this._validate(r,t,f,n.local.invalidDate||n.regionalOptions[""].invalidDate),i=new Date(o.year(),o.month()-1,o.day());return i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.setMilliseconds(0),i.setHours(i.getHours()>12?i.getHours()+2:0),i},fromJSDate:function(r){return this.newDate(r.getFullYear(),r.getMonth()+1,r.getDate())}});var n=re.exports=new c;n.cdate=M,n.baseCalendar=e,n.calendars.gregorian=a},{"object-assign":247}],347:[function(d,re,ne){var w=d("object-assign"),c=d("./main");w(c.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),c.local=c.regionalOptions[""],w(c.cdate.prototype,{formatDate:function(M,T){return typeof M!="string"&&(T=M,M=""),this._calendar.formatDate(M||"",this,T)}}),w(c.baseCalendar.prototype,{UNIX_EPOCH:c.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:24*60*60,TICKS_EPOCH:c.instance().jdEpoch,TICKS_PER_DAY:24*60*60*1e7,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(M,T,e){if(typeof M!="string"&&(e=T,T=M,M=""),!T)return"";if(T.calendar()!==this)throw c.local.invalidFormat||c.regionalOptions[""].invalidFormat;M=M||this.local.dateFormat,e=e||{};var a=e.dayNamesShort||this.local.dayNamesShort,n=e.dayNames||this.local.dayNames,r=e.monthNumbers||this.local.monthNumbers,t=e.monthNamesShort||this.local.monthNamesShort,f=e.monthNames||this.local.monthNames;e.calculateWeek||this.local.calculateWeek;for(var o=function(x,v){for(var b=1;A+b<M.length&&M.charAt(A+b)===x;)b++;return A+=b-1,Math.floor(b/(v||1))>1},i=function(x,v,b,l){var L=""+v;if(o(x,l))for(;L.length<b;)L="0"+L;return L},g=function(x,v,b,l){return o(x)?l[v]:b[v]},p=this,y=function(x){return typeof r=="function"?r.call(p,x,o("m")):u(i("m",x.month(),2))},h=function(x,v){return v?typeof f=="function"?f.call(p,x):f[x.month()-p.minMonth]:typeof t=="function"?t.call(p,x):t[x.month()-p.minMonth]},m=this.local.digits,u=function(x){return e.localNumbers&&m?m(x):x},_="",s=!1,A=0;A<M.length;A++)if(s)M.charAt(A)==="'"&&!o("'")?s=!1:_+=M.charAt(A);else switch(M.charAt(A)){case"d":_+=u(i("d",T.day(),2));break;case"D":_+=g("D",T.dayOfWeek(),a,n);break;case"o":_+=i("o",T.dayOfYear(),3);break;case"w":_+=i("w",T.weekOfYear(),2);break;case"m":_+=y(T);break;case"M":_+=h(T,o("M"));break;case"y":_+=o("y",2)?T.year():(T.year()%100<10?"0":"")+T.year()%100;break;case"Y":o("Y",2),_+=T.formatYear();break;case"J":_+=T.toJD();break;case"@":_+=(T.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":_+=(T.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":o("'")?_+="'":s=!0;break;default:_+=M.charAt(A)}return _},parseDate:function(M,T,e){if(T==null)throw c.local.invalidArguments||c.regionalOptions[""].invalidArguments;if(T=typeof T=="object"?T.toString():T+"",T==="")return null;M=M||this.local.dateFormat,e=e||{};var a=e.shortYearCutoff||this.shortYearCutoff;a=typeof a!="string"?a:this.today().year()%100+parseInt(a,10);for(var n=e.dayNamesShort||this.local.dayNamesShort,r=e.dayNames||this.local.dayNames,t=e.parseMonth||this.local.parseMonth,f=e.monthNumbers||this.local.monthNumbers,o=e.monthNamesShort||this.local.monthNamesShort,i=e.monthNames||this.local.monthNames,g=-1,p=-1,y=-1,h=-1,m=-1,u=!1,_=!1,s=function(I,D){for(var R=1;k+R<M.length&&M.charAt(k+R)===I;)R++;return k+=R-1,Math.floor(R/(D||1))>1},A=function(I,D){var R=s(I,D),B=[2,3,R?4:2,R?4:2,10,11,20]["oyYJ@!".indexOf(I)+1],F=new RegExp("^-?\\d{1,"+B+"}"),V=T.substring(S).match(F);if(!V)throw(c.local.missingNumberAt||c.regionalOptions[""].missingNumberAt).replace(/\{0\}/,S);return S+=V[0].length,parseInt(V[0],10)},x=this,v=function(){if(typeof f=="function"){s("m");var I=f.call(x,T.substring(S));return S+=I.length,I}return A("m")},b=function(I,D,R,B){for(var F=s(I,B)?R:D,V=0;V<F.length;V++)if(T.substr(S,F[V].length).toLowerCase()===F[V].toLowerCase())return S+=F[V].length,V+x.minMonth;throw(c.local.unknownNameAt||c.regionalOptions[""].unknownNameAt).replace(/\{0\}/,S)},l=function(){if(typeof i=="function"){var I=s("M")?i.call(x,T.substring(S)):o.call(x,T.substring(S));return S+=I.length,I}return b("M",o,i)},L=function(){if(T.charAt(S)!==M.charAt(k))throw(c.local.unexpectedLiteralAt||c.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,S);S++},S=0,k=0;k<M.length;k++)if(_)M.charAt(k)==="'"&&!s("'")?_=!1:L();else switch(M.charAt(k)){case"d":h=A("d");break;case"D":b("D",n,r);break;case"o":m=A("o");break;case"w":A("w");break;case"m":y=v();break;case"M":y=l();break;case"y":var P=k;u=!s("y",2),k=P,p=A("y",2);break;case"Y":p=A("Y",2);break;case"J":g=A("J")+.5,T.charAt(S)==="."&&(S++,A("J"));break;case"@":g=A("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":g=A("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":S=T.length;break;case"'":s("'")?L():_=!0;break;default:L()}if(S<T.length)throw c.local.unexpectedText||c.regionalOptions[""].unexpectedText;if(p===-1?p=this.today().year():p<100&&u&&(p+=a===-1?1900:this.today().year()-this.today().year()%100-(p<=a?0:100)),typeof y=="string"&&(y=t.call(this,p,y)),m>-1){y=1,h=m;for(var z=this.daysInMonth(p,y);h>z;z=this.daysInMonth(p,y))y++,h-=z}return g>-1?this.fromJD(g):this.newDate(p,y,h)},determineDate:function(M,T,e,a,n){e&&typeof e!="object"&&(n=a,a=e,e=null),typeof a!="string"&&(n=a,a="");var r=this,t=function(f){try{return r.parseDate(a,f,n)}catch{}f=f.toLowerCase();for(var o=(f.match(/^c/)&&e?e.newDate():null)||r.today(),i=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,g=i.exec(f);g;)o.add(parseInt(g[1],10),g[2]||"d"),g=i.exec(f);return o};return T=T?T.newDate():null,M=M==null?T:typeof M=="string"?t(M):typeof M=="number"?isNaN(M)||M===1/0||M===-1/0?T:r.today().add(M,"d"):r.newDate(M),M}})},{"./main":346,"object-assign":247}],348:[function(d,re,ne){re.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],349:[function(d,re,ne){var w=d("./arrow_paths"),c=d("../../plots/font_attributes"),M=d("../../plots/cartesian/constants"),T=d("../../plot_api/plot_template").templatedArray;d("../../constants/axis_placeable_objects"),re.exports=T("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:c({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:w.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:w.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",M.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",M.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",M.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",M.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:c({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":472,"../../plot_api/plot_template":543,"../../plots/cartesian/constants":561,"../../plots/font_attributes":585,"./arrow_paths":348}],350:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes"),M=d("./draw").draw;re.exports=function(n){var r=n._fullLayout,t=w.filterVisible(r.annotations);if(t.length&&n._fullData.length)return w.syncOrAsync([M,T],n)};function T(a){var n=a._fullLayout;w.filterVisible(n.annotations).forEach(function(r){var t=c.getFromId(a,r.xref),f=c.getFromId(a,r.yref),o=c.getRefType(r.xref),i=c.getRefType(r.yref);r._extremes={},o==="range"&&e(r,t),i==="range"&&e(r,f)})}function e(a,n){var r=n._id,t=r.charAt(0),f=a[t],o=a["a"+t],i=a[t+"ref"],g=a["a"+t+"ref"],p=a["_"+t+"padplus"],y=a["_"+t+"padminus"],h={x:1,y:-1}[t]*a[t+"shift"],m=3*a.arrowsize*a.arrowwidth||0,u=m+h,_=m-h,s=3*a.startarrowsize*a.arrowwidth||0,A=s+h,x=s-h,v;if(g===i){var b=c.findExtremes(n,[n.r2c(f)],{ppadplus:u,ppadminus:_}),l=c.findExtremes(n,[n.r2c(o)],{ppadplus:Math.max(p,A),ppadminus:Math.max(y,x)});v={min:[b.min[0],l.min[0]],max:[b.max[0],l.max[0]]}}else A=o?A+o:A,x=o?x-o:x,v=c.findExtremes(n,[n.r2c(f)],{ppadplus:Math.max(p,u,A),ppadminus:Math.max(y,_,x)});a._extremes[r]=v}},{"../../lib":503,"../../plots/cartesian/axes":554,"./draw":355}],351:[function(d,re,ne){var w=d("../../lib"),c=d("../../registry"),M=d("../../plot_api/plot_template").arrayEditor;re.exports={hasClickToShow:T,onClick:e};function T(r,t){var f=a(r,t);return f.on.length>0||f.explicitOff.length>0}function e(r,t){var f=a(r,t),o=f.on,i=f.off.concat(f.explicitOff),g={},p=r._fullLayout.annotations,y,h;if(!!(o.length||i.length)){for(y=0;y<o.length;y++)h=M(r.layout,"annotations",p[o[y]]),h.modifyItem("visible",!0),w.extendFlat(g,h.getUpdateObj());for(y=0;y<i.length;y++)h=M(r.layout,"annotations",p[i[y]]),h.modifyItem("visible",!1),w.extendFlat(g,h.getUpdateObj());return c.call("update",r,{},g)}}function a(r,t){var f=r._fullLayout.annotations,o=[],i=[],g=[],p=(t||[]).length,y,h,m,u,_,s,A,x;for(y=0;y<f.length;y++)if(m=f[y],u=m.clicktoshow,u){for(h=0;h<p;h++)if(_=t[h],s=_.xaxis,A=_.yaxis,s._id===m.xref&&A._id===m.yref&&s.d2r(_.x)===n(m._xclick,s)&&A.d2r(_.y)===n(m._yclick,A)){m.visible?u==="onout"?x=i:x=g:x=o,x.push(y);break}h===p&&m.visible&&u==="onout"&&i.push(y)}return{on:o,off:i,explicitOff:g}}function n(r,t){return t.type==="log"?t.l2r(r):t.d2r(r)}},{"../../lib":503,"../../plot_api/plot_template":543,"../../registry":638}],352:[function(d,re,ne){var w=d("../../lib"),c=d("../color");re.exports=function(T,e,a,n){n("opacity");var r=n("bgcolor"),t=n("bordercolor"),f=c.opacity(t);n("borderpad");var o=n("borderwidth"),i=n("showarrow");n("text",i?" ":a._dfltTitle.annotation),n("textangle"),w.coerceFont(n,"font",a.font),n("width"),n("align");var g=n("height");if(g&&n("valign"),i){var p=n("arrowside"),y,h;p.indexOf("end")!==-1&&(y=n("arrowhead"),h=n("arrowsize")),p.indexOf("start")!==-1&&(n("startarrowhead",y),n("startarrowsize",h)),n("arrowcolor",f?e.bordercolor:c.defaultLine),n("arrowwidth",(f&&o||1)*2),n("standoff"),n("startstandoff")}var m=n("hovertext"),u=a.hoverlabel||{};if(m){var _=n("hoverlabel.bgcolor",u.bgcolor||(c.opacity(r)?c.rgb(r):c.defaultLine)),s=n("hoverlabel.bordercolor",u.bordercolor||c.contrast(_));w.coerceFont(n,"hoverlabel.font",{family:u.font.family,size:u.font.size,color:u.font.color||s})}n("captureevents",!!m)}},{"../../lib":503,"../color":366}],353:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib/to_log_range");re.exports=function(T,e,a,n){e=e||{};var r=a==="log"&&e.type==="linear",t=a==="linear"&&e.type==="log";if(!(r||t))return;var f=T._fullLayout.annotations,o=e._id.charAt(0),i,g;function p(h){var m=i[h],u=null;r?u=c(m,e.range):u=Math.pow(10,m),w(u)||(u=null),n(g+h,u)}for(var y=0;y<f.length;y++)i=f[y],g="annotations["+y+"].",i[o+"ref"]===e._id&&p(o),i["a"+o+"ref"]===e._id&&p("a"+o)}},{"../../lib/to_log_range":531,"fast-isnumeric":190}],354:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes"),M=d("../../plots/array_container_defaults"),T=d("./common_defaults"),e=d("./attributes");re.exports=function(r,t){M(r,t,{name:"annotations",handleItemDefaults:a})};function a(n,r,t){function f(L,S){return w.coerce(n,r,e,L,S)}var o=f("visible"),i=f("clicktoshow");if(!!(o||i)){T(n,r,t,f);for(var g=r.showarrow,p=["x","y"],y=[-10,-30],h={_fullLayout:t},m=0;m<2;m++){var u=p[m],_=c.coerceRef(n,r,h,u,"","paper");if(_!=="paper"){var s=c.getFromId(h,_);s._annIndices.push(r._index)}if(c.coercePosition(r,h,f,_,u,.5),g){var A="a"+u,x=c.coerceRef(n,r,h,A,"pixel",["pixel","paper"]);x!=="pixel"&&x!==_&&(x=r[A]="pixel");var v=x==="pixel"?y[m]:.4;c.coercePosition(r,h,f,x,A,v)}f(u+"anchor"),f(u+"shift")}if(w.noneOrAll(n,r,["x","y"]),g&&w.noneOrAll(n,r,["ax","ay"]),i){var b=f("xclick"),l=f("yclick");r._xclick=b===void 0?r.x:c.cleanPosition(b,h,r.xref),r._yclick=l===void 0?r.y:c.cleanPosition(l,h,r.yref)}}}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"./attributes":349,"./common_defaults":352}],355:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../registry"),M=d("../../plots/plots"),T=d("../../lib"),e=T.strTranslate,a=d("../../plots/cartesian/axes"),n=d("../color"),r=d("../drawing"),t=d("../fx"),f=d("../../lib/svg_text_utils"),o=d("../../lib/setcursor"),i=d("../dragelement"),g=d("../../plot_api/plot_template").arrayEditor,p=d("./draw_arrow_head");re.exports={draw:y,drawOne:h,drawRaw:u};function y(_){var s=_._fullLayout;s._infolayer.selectAll(".annotation").remove();for(var A=0;A<s.annotations.length;A++)s.annotations[A].visible&&h(_,A);return M.previousPromises(_)}function h(_,s){var A=_._fullLayout,x=A.annotations[s]||{},v=a.getFromId(_,x.xref),b=a.getFromId(_,x.yref);v&&v.setScale(),b&&b.setScale(),u(_,x,s,!1,v,b)}function m(_,s,A,x,v){var b=v[A],l=v[A+"ref"],L=A.indexOf("y")!==-1,S=a.getRefType(l)==="domain",k=L?x.h:x.w;return _?S?b+(L?-s:s)/_._length:_.p2r(_.r2p(b)+s):b+(L?-s:s)/k}function u(_,s,A,x,v,b){var l=_._fullLayout,L=_._fullLayout._size,S=_._context.edits,k,P;x?(k="annotation-"+x,P=x+".annotations"):(k="annotation",P="annotations");var z=g(_.layout,P,s),I=z.modifyBase,D=z.modifyItem,R=z.getUpdateObj;l._infolayer.selectAll("."+k+'[data-index="'+A+'"]').remove();var B="clip"+l._uid+"_ann"+A;if(!s._input||s.visible===!1){w.selectAll("#"+B).remove();return}var F={x:{},y:{}},V=+s.textangle||0,G=l._infolayer.append("g").classed(k,!0).attr("data-index",String(A)).style("opacity",s.opacity),J=G.append("g").classed("annotation-text-g",!0),j=S[s.showarrow?"annotationTail":"annotationPosition"],Y=s.captureevents||S.annotationText||j;function X(le){var ye={index:A,annotation:s._input,fullAnnotation:s,event:le};return x&&(ye.subplotId=x),ye}var oe=J.append("g").style("pointer-events",Y?"all":null).call(o,"pointer").on("click",function(){_._dragging=!1,_.emit("plotly_clickannotation",X(w.event))});s.hovertext&&oe.on("mouseover",function(){var le=s.hoverlabel,ye=le.font,fe=this.getBoundingClientRect(),pe=_.getBoundingClientRect();t.loneHover({x0:fe.left-pe.left,x1:fe.right-pe.left,y:(fe.top+fe.bottom)/2-pe.top,text:s.hovertext,color:le.bgcolor,borderColor:le.bordercolor,fontFamily:ye.family,fontSize:ye.size,fontColor:ye.color},{container:l._hoverlayer.node(),outerContainer:l._paper.node(),gd:_})}).on("mouseout",function(){t.loneUnhover(l._hoverlayer.node())});var se=s.borderwidth,ie=s.borderpad,N=se+ie,U=oe.append("rect").attr("class","bg").style("stroke-width",se+"px").call(n.stroke,s.bordercolor).call(n.fill,s.bgcolor),q=s.width||s.height,Q=l._topclips.selectAll("#"+B).data(q?[0]:[]);Q.enter().append("clipPath").classed("annclip",!0).attr("id",B).append("rect"),Q.exit().remove();var W=s.font,Z=l._meta?T.templateString(s.text,l._meta):s.text,ee=oe.append("text").classed("annotation-text",!0).text(Z);function te(le){return le.call(r.font,W).attr({"text-anchor":{left:"start",right:"end"}[s.align]||"middle"}),f.convertToTspans(le,_,ae),le}function ae(){var le=ee.selectAll("a");if(le.size()===1&&le.text()===ee.text()){var ye=oe.insert("a",":first-child").attr({"xlink:xlink:href":le.attr("xlink:href"),"xlink:xlink:show":le.attr("xlink:show")}).style({cursor:"pointer"});ye.node().appendChild(U.node())}var fe=oe.select(".annotation-text-math-group"),pe=!fe.empty(),ge=r.bBox((pe?fe:ee).node()),Ae=ge.width,we=ge.height,De=s.width||Ae,Be=s.height||we,Ve=Math.round(De+2*N),xe=Math.round(Be+2*N);function Le(Vt,jt){return jt==="auto"&&(Vt<1/3?jt="left":Vt>2/3?jt="right":jt="center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[jt]}for(var He=!1,Je=["x","y"],Oe=0;Oe<Je.length;Oe++){var Pe=Je[Oe],Ue=s[Pe+"ref"]||Pe,vt=s["a"+Pe+"ref"],Lt={x:v,y:b}[Pe],Yt=(V+(Pe==="x"?0:-90))*Math.PI/180,At=Ve*Math.cos(Yt),Rt=xe*Math.sin(Yt),Bt=Math.abs(At)+Math.abs(Rt),Mt=s[Pe+"anchor"],Tt=s[Pe+"shift"]*(Pe==="x"?1:-1),at=F[Pe],ct,je,ke,Ye,Ke,st=a.getRefType(Ue);if(Lt&&st!=="domain"){var Et=Lt.r2fraction(s[Pe]);(Et<0||Et>1)&&(vt===Ue?(Et=Lt.r2fraction(s["a"+Pe]),(Et<0||Et>1)&&(He=!0)):He=!0),ct=Lt._offset+Lt.r2p(s[Pe]),Ye=.5}else{var bt=st==="domain";Pe==="x"?(ke=s[Pe],ct=bt?Lt._offset+Lt._length*ke:ct=L.l+L.w*ke):(ke=1-s[Pe],ct=bt?Lt._offset+Lt._length*ke:ct=L.t+L.h*ke),Ye=s.showarrow?.5:ke}if(s.showarrow){at.head=ct;var zt=s["a"+Pe];if(Ke=At*Le(.5,s.xanchor)-Rt*Le(.5,s.yanchor),vt===Ue){var $t=a.getRefType(vt);$t==="domain"?(Pe==="y"&&(zt=1-zt),at.tail=Lt._offset+Lt._length*zt):$t==="paper"?Pe==="y"?(zt=1-zt,at.tail=L.t+L.h*zt):at.tail=L.l+L.w*zt:at.tail=Lt._offset+Lt.r2p(zt),je=Ke}else at.tail=ct+zt,je=Ke+zt;at.text=at.tail+Ke;var Ot=l[Pe==="x"?"width":"height"];if(Ue==="paper"&&(at.head=T.constrain(at.head,1,Ot-1)),vt==="pixel"){var Qt=-Math.max(at.tail-3,at.text),tr=Math.min(at.tail+3,at.text)-Ot;Qt>0?(at.tail+=Qt,at.text+=Qt):tr>0&&(at.tail-=tr,at.text-=tr)}at.tail+=Tt,at.head+=Tt}else Ke=Bt*Le(Ye,Mt),je=Ke,at.text=ct+Ke;at.text+=Tt,Ke+=Tt,je+=Tt,s["_"+Pe+"padplus"]=Bt/2+je,s["_"+Pe+"padminus"]=Bt/2-je,s["_"+Pe+"size"]=Bt,s["_"+Pe+"shift"]=Ke}if(He){oe.remove();return}var qt=0,lr=0;if(s.align!=="left"&&(qt=(De-Ae)*(s.align==="center"?.5:1)),s.valign!=="top"&&(lr=(Be-we)*(s.valign==="middle"?.5:1)),pe)fe.select("svg").attr({x:N+qt-1,y:N+lr}).call(r.setClipUrl,q?B:null,_);else{var Wr=N+lr-ge.top,cn=N+qt-ge.left;ee.call(f.positionText,cn,Wr).call(r.setClipUrl,q?B:null,_)}Q.select("rect").call(r.setRect,N,N,De,Be),U.call(r.setRect,se/2,se/2,Ve-se,xe-se),oe.call(r.setTranslate,Math.round(F.x.text-Ve/2),Math.round(F.y.text-xe/2)),J.attr({transform:"rotate("+V+","+F.x.text+","+F.y.text+")"});var Jr=function(Vt,jt){G.selectAll(".annotation-arrow-g").remove();var Ut=F.x.head,yr=F.y.head,nt=F.x.tail+Vt,_e=F.y.tail+jt,Me=F.x.text+Vt,Ne=F.y.text+jt,We=T.rotationXYMatrix(V,Me,Ne),Qe=T.apply2DTransform(We),rt=T.apply2DTransform2(We),$e=+U.attr("width"),ht=+U.attr("height"),xt=Me-.5*$e,kt=xt+$e,Wt=Ne-.5*ht,Ft=Wt+ht,ir=[[xt,Wt,xt,Ft],[xt,Ft,kt,Ft],[kt,Ft,kt,Wt],[kt,Wt,xt,Wt]].map(rt);if(!ir.reduce(function(tt,Ct){return tt^!!T.segmentsIntersect(Ut,yr,Ut+1e6,yr+1e6,Ct[0],Ct[1],Ct[2],Ct[3])},!1)){ir.forEach(function(tt){var Ct=T.segmentsIntersect(nt,_e,Ut,yr,tt[0],tt[1],tt[2],tt[3]);Ct&&(nt=Ct.x,_e=Ct.y)});var hr=s.arrowwidth,_r=s.arrowcolor,an=s.arrowside,Rr=G.append("g").style({opacity:n.opacity(_r)}).classed("annotation-arrow-g",!0),Vr=Rr.append("path").attr("d","M"+nt+","+_e+"L"+Ut+","+yr).style("stroke-width",hr+"px").call(n.stroke,n.rgb(_r));if(p(Vr,an,s),S.annotationPosition&&Vr.node().parentNode&&!x){var fn=Ut,xr=yr;if(s.standoff){var mr=Math.sqrt(Math.pow(Ut-nt,2)+Math.pow(yr-_e,2));fn+=s.standoff*(nt-Ut)/mr,xr+=s.standoff*(_e-yr)/mr}var Fr=Rr.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(nt-fn)+","+(_e-xr),transform:e(fn,xr)}).style("stroke-width",hr+6+"px").call(n.stroke,"rgba(0,0,0,0)").call(n.fill,"rgba(0,0,0,0)"),Ir,Sr;i.init({element:Fr.node(),gd:_,prepFn:function(){var tt=r.getTranslate(oe);Ir=tt.x,Sr=tt.y,v&&v.autorange&&I(v._name+".autorange",!0),b&&b.autorange&&I(b._name+".autorange",!0)},moveFn:function(tt,Ct){var Zt=Qe(Ir,Sr),ur=Zt[0]+tt,Lr=Zt[1]+Ct;oe.call(r.setTranslate,ur,Lr),D("x",m(v,tt,"x",L,s)),D("y",m(b,Ct,"y",L,s)),s.axref===s.xref&&D("ax",m(v,tt,"ax",L,s)),s.ayref===s.yref&&D("ay",m(b,Ct,"ay",L,s)),Rr.attr("transform",e(tt,Ct)),J.attr({transform:"rotate("+V+","+ur+","+Lr+")"})},doneFn:function(){c.call("_guiRelayout",_,R());var tt=document.querySelector(".js-notes-box-panel");tt&&tt.redraw(tt.selectedObj)}})}}};if(s.showarrow&&Jr(0,0),j){var ot;i.init({element:oe.node(),gd:_,prepFn:function(){ot=J.attr("transform")},moveFn:function(Vt,jt){var Ut="pointer";if(s.showarrow)s.axref===s.xref?D("ax",m(v,Vt,"ax",L,s)):D("ax",s.ax+Vt),s.ayref===s.yref?D("ay",m(b,jt,"ay",L.w,s)):D("ay",s.ay+jt),Jr(Vt,jt);else{if(x)return;var yr,nt;if(v)yr=m(v,Vt,"x",L,s);else{var _e=s._xsize/L.w,Me=s.x+(s._xshift-s.xshift)/L.w-_e/2;yr=i.align(Me+Vt/L.w,_e,0,1,s.xanchor)}if(b)nt=m(b,jt,"y",L,s);else{var Ne=s._ysize/L.h,We=s.y-(s._yshift+s.yshift)/L.h-Ne/2;nt=i.align(We-jt/L.h,Ne,0,1,s.yanchor)}D("x",yr),D("y",nt),(!v||!b)&&(Ut=i.getCursor(v?.5:yr,b?.5:nt,s.xanchor,s.yanchor))}J.attr({transform:e(Vt,jt)+ot}),o(oe,Ut)},clickFn:function(Vt,jt){s.captureevents&&_.emit("plotly_clickannotation",X(jt))},doneFn:function(){o(oe),c.call("_guiRelayout",_,R());var Vt=document.querySelector(".js-notes-box-panel");Vt&&Vt.redraw(Vt.selectedObj)}})}}S.annotationText?ee.call(f.makeEditable,{delegate:oe,gd:_}).call(te).on("edit",function(le){s.text=le,this.call(te),D("text",le),v&&v.autorange&&I(v._name+".autorange",!0),b&&b.autorange&&I(b._name+".autorange",!0),c.call("_guiRelayout",_,R())}):ee.call(te)}},{"../../lib":503,"../../lib/setcursor":524,"../../lib/svg_text_utils":529,"../../plot_api/plot_template":543,"../../plots/cartesian/axes":554,"../../plots/plots":619,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"../fx":406,"./draw_arrow_head":356,"@plotly/d3":58}],356:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../color"),M=d("./arrow_paths"),T=d("../../lib"),e=T.strScale,a=T.strRotate,n=T.strTranslate;re.exports=function(t,f,o){var i=t.node(),g=M[o.arrowhead||0],p=M[o.startarrowhead||0],y=(o.arrowwidth||1)*(o.arrowsize||1),h=(o.arrowwidth||1)*(o.startarrowsize||1),m=f.indexOf("start")>=0,u=f.indexOf("end")>=0,_=g.backoff*y+o.standoff,s=p.backoff*h+o.startstandoff,A,x,v,b;if(i.nodeName==="line"){A={x:+t.attr("x1"),y:+t.attr("y1")},x={x:+t.attr("x2"),y:+t.attr("y2")};var l=A.x-x.x,L=A.y-x.y;if(v=Math.atan2(L,l),b=v+Math.PI,_&&s&&_+s>Math.sqrt(l*l+L*L)){J();return}if(_){if(_*_>l*l+L*L){J();return}var S=_*Math.cos(v),k=_*Math.sin(v);x.x+=S,x.y+=k,t.attr({x2:x.x,y2:x.y})}if(s){if(s*s>l*l+L*L){J();return}var P=s*Math.cos(v),z=s*Math.sin(v);A.x-=P,A.y-=z,t.attr({x1:A.x,y1:A.y})}}else if(i.nodeName==="path"){var I=i.getTotalLength(),D="";if(I<_+s){J();return}var R=i.getPointAtLength(0),B=i.getPointAtLength(.1);v=Math.atan2(R.y-B.y,R.x-B.x),A=i.getPointAtLength(Math.min(s,I)),D="0px,"+s+"px,";var F=i.getPointAtLength(I),V=i.getPointAtLength(I-.1);b=Math.atan2(F.y-V.y,F.x-V.x),x=i.getPointAtLength(Math.max(0,I-_));var G=D?s+_:_;D+=I-G+"px,"+I+"px",t.style("stroke-dasharray",D)}function J(){t.style("stroke-dasharray","0px,100px")}function j(Y,X,oe,se){!Y.path||(Y.noRotate&&(oe=0),w.select(i.parentNode).append("path").attr({class:t.attr("class"),d:Y.path,transform:n(X.x,X.y)+a(oe*180/Math.PI)+e(se)}).style({fill:c.rgb(o.arrowcolor),"stroke-width":0}))}m&&j(p,A,v,h),u&&j(g,x,b,y)}},{"../../lib":503,"../color":366,"./arrow_paths":348,"@plotly/d3":58}],357:[function(d,re,ne){var w=d("./draw"),c=d("./click");re.exports={moduleType:"component",name:"annotations",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),includeBasePlot:d("../../plots/cartesian/include_components")("annotations"),calcAutorange:d("./calc_autorange"),draw:w.draw,drawOne:w.drawOne,drawRaw:w.drawRaw,hasClickToShow:c.hasClickToShow,onClick:c.onClick,convertCoords:d("./convert_coords")}},{"../../plots/cartesian/include_components":567,"./attributes":349,"./calc_autorange":350,"./click":351,"./convert_coords":353,"./defaults":354,"./draw":355}],358:[function(d,re,ne){var w=d("../annotations/attributes"),c=d("../../plot_api/edit_types").overrideAll,M=d("../../plot_api/plot_template").templatedArray;re.exports=c(M("annotation",{visible:w.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:w.xanchor,xshift:w.xshift,yanchor:w.yanchor,yshift:w.yshift,text:w.text,textangle:w.textangle,font:w.font,width:w.width,height:w.height,opacity:w.opacity,align:w.align,valign:w.valign,bgcolor:w.bgcolor,bordercolor:w.bordercolor,borderpad:w.borderpad,borderwidth:w.borderwidth,showarrow:w.showarrow,arrowcolor:w.arrowcolor,arrowhead:w.arrowhead,startarrowhead:w.startarrowhead,arrowside:w.arrowside,arrowsize:w.arrowsize,startarrowsize:w.startarrowsize,arrowwidth:w.arrowwidth,standoff:w.standoff,startstandoff:w.startstandoff,hovertext:w.hovertext,hoverlabel:w.hoverlabel,captureevents:w.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../annotations/attributes":349}],359:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes");re.exports=function(e){for(var a=e.fullSceneLayout,n=a.annotations,r=0;r<n.length;r++)M(n[r],e);e.fullLayout._infolayer.selectAll(".annotation-"+e.id).remove()};function M(T,e){var a=e.fullSceneLayout,n=a.domain,r=e.fullLayout._size,t={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};T._xa={},w.extendFlat(T._xa,t),c.setConvert(T._xa),T._xa._offset=r.l+n.x[0]*r.w,T._xa.l2p=function(){return .5*(1+T._pdata[0]/T._pdata[3])*r.w*(n.x[1]-n.x[0])},T._ya={},w.extendFlat(T._ya,t),c.setConvert(T._ya),T._ya._offset=r.t+(1-n.y[1])*r.h,T._ya.l2p=function(){return .5*(1-T._pdata[1]/T._pdata[3])*r.h*(n.y[1]-n.y[0])}}},{"../../lib":503,"../../plots/cartesian/axes":554}],360:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes"),M=d("../../plots/array_container_defaults"),T=d("../annotations/common_defaults"),e=d("./attributes");re.exports=function(r,t,f){M(r,t,{name:"annotations",handleItemDefaults:a,fullLayout:f.fullLayout})};function a(n,r,t,f){function o(p,y){return w.coerce(n,r,e,p,y)}function i(p){var y=p+"axis",h={_fullLayout:{}};return h._fullLayout[y]=t[y],c.coercePosition(r,h,o,p,p,.5)}var g=o("visible");!g||(T(n,r,f.fullLayout,o),i("x"),i("y"),i("z"),w.noneOrAll(n,r,["x","y","z"]),r.xref="x",r.yref="y",r.zref="z",o("xanchor"),o("yanchor"),o("xshift"),o("yshift"),r.showarrow&&(r.axref="pixel",r.ayref="pixel",o("ax",-10),o("ay",-30),w.noneOrAll(n,r,["ax","ay"])))}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"../annotations/common_defaults":352,"./attributes":358}],361:[function(d,re,ne){var w=d("../annotations/draw").drawRaw,c=d("../../plots/gl3d/project"),M=["x","y","z"];re.exports=function(e){for(var a=e.fullSceneLayout,n=e.dataScale,r=a.annotations,t=0;t<r.length;t++){for(var f=r[t],o=!1,i=0;i<3;i++){var g=M[i],p=f[g],y=a[g+"axis"],h=y.r2fraction(p);if(h<0||h>1){o=!0;break}}o?e.fullLayout._infolayer.select(".annotation-"+e.id+'[data-index="'+t+'"]').remove():(f._pdata=c(e.glplot.cameraParams,[a.xaxis.r2l(f.x)*n[0],a.yaxis.r2l(f.y)*n[1],a.zaxis.r2l(f.z)*n[2]]),w(e.graphDiv,f,t,e.id,f._xa,f._ya))}}},{"../../plots/gl3d/project":607,"../annotations/draw":355}],362:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib");re.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:d("./attributes")}}},layoutAttributes:d("./attributes"),handleDefaults:d("./defaults"),includeBasePlot:M,convert:d("./convert"),draw:d("./draw")};function M(T,e){var a=w.subplotsRegistry.gl3d;if(!!a)for(var n=a.attrRegex,r=Object.keys(T),t=0;t<r.length;t++){var f=r[t];n.test(f)&&(T[f].annotations||[]).length&&(c.pushUnique(e._basePlotModules,a),c.pushUnique(e._subplots.gl3d,f))}}},{"../../lib":503,"../../registry":638,"./attributes":358,"./convert":359,"./defaults":360,"./draw":361}],363:[function(d,re,ne){re.exports=d("world-calendars/dist/main"),d("world-calendars/dist/plus"),d("world-calendars/dist/calendars/chinese"),d("world-calendars/dist/calendars/coptic"),d("world-calendars/dist/calendars/discworld"),d("world-calendars/dist/calendars/ethiopian"),d("world-calendars/dist/calendars/hebrew"),d("world-calendars/dist/calendars/islamic"),d("world-calendars/dist/calendars/julian"),d("world-calendars/dist/calendars/mayan"),d("world-calendars/dist/calendars/nanakshahi"),d("world-calendars/dist/calendars/nepali"),d("world-calendars/dist/calendars/persian"),d("world-calendars/dist/calendars/taiwan"),d("world-calendars/dist/calendars/thai"),d("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":332,"world-calendars/dist/calendars/coptic":333,"world-calendars/dist/calendars/discworld":334,"world-calendars/dist/calendars/ethiopian":335,"world-calendars/dist/calendars/hebrew":336,"world-calendars/dist/calendars/islamic":337,"world-calendars/dist/calendars/julian":338,"world-calendars/dist/calendars/mayan":339,"world-calendars/dist/calendars/nanakshahi":340,"world-calendars/dist/calendars/nepali":341,"world-calendars/dist/calendars/persian":342,"world-calendars/dist/calendars/taiwan":343,"world-calendars/dist/calendars/thai":344,"world-calendars/dist/calendars/ummalqura":345,"world-calendars/dist/main":346,"world-calendars/dist/plus":347}],364:[function(d,re,ne){var w=d("./calendars"),c=d("../../lib"),M=d("../../constants/numerical"),T=M.EPOCHJD,e=M.ONEDAY,a={valType:"enumerated",values:c.sortObjectKeys(w.calendars),editType:"calc",dflt:"gregorian"},n=function(v,b,l,L){var S={};return S[l]=a,c.coerce(v,b,S,l,L)},r=function(v,b,l,L){for(var S=0;S<l.length;S++)n(v,b,l[S]+"calendar",L.calendar)},t={chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},f={chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},o={chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},i="##",g={d:{"0":"dd","-":"d"},e:{"0":"d","-":"d"},a:{"0":"D","-":"D"},A:{"0":"DD","-":"DD"},j:{"0":"oo","-":"o"},W:{"0":"ww","-":"w"},m:{"0":"mm","-":"m"},b:{"0":"M","-":"M"},B:{"0":"MM","-":"MM"},y:{"0":"yy","-":"yy"},Y:{"0":"yyyy","-":"yyyy"},U:i,w:i,c:{"0":"D M d %X yyyy","-":"D M d %X yyyy"},x:{"0":"mm/dd/yyyy","-":"mm/dd/yyyy"}};function p(v,b,l){for(var L=Math.floor((b+.05)/e)+T,S=h(l).fromJD(L),k=0,P,z,I,D,R;(k=v.indexOf("%",k))!==-1;)P=v.charAt(k+1),P==="0"||P==="-"||P==="_"?(I=3,z=v.charAt(k+2),P==="_"&&(P="-")):(z=P,P="0",I=2),D=g[z],D?(D===i?R=i:R=S.formatDate(D[P]),v=v.substr(0,k)+R+v.substr(k+I),k+=R.length):k+=I;return v}var y={};function h(v){var b=y[v];return b||(b=y[v]=w.instance(v),b)}function m(v){return c.extendFlat({},a,{description:v})}function u(v){return"Sets the calendar system to use with `"+v+"` date data."}var _={xcalendar:m(u("x"))},s=c.extendFlat({},_,{ycalendar:m(u("y"))}),A=c.extendFlat({},s,{zcalendar:m(u("z"))}),x=m(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));re.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:s,bar:s,box:s,heatmap:s,contour:s,histogram:s,histogram2d:s,histogram2dcontour:s,scatter3d:A,surface:A,mesh3d:A,scattergl:s,ohlc:_,candlestick:_},layout:{calendar:m(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:x},yaxis:{calendar:x},scene:{xaxis:{calendar:x},yaxis:{calendar:x},zaxis:{calendar:x}},polar:{radialaxis:{calendar:x}}},transforms:{filter:{valuecalendar:m(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:m(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:a,handleDefaults:n,handleTraceDefaults:r,CANONICAL_SUNDAY:f,CANONICAL_TICK:t,DFLTRANGE:o,getCal:h,worldCalFmt:p}},{"../../constants/numerical":479,"../../lib":503,"./calendars":363}],365:[function(d,re,ne){ne.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],ne.defaultLine="#444",ne.lightLine="#eee",ne.background="#fff",ne.borderLine="#BEC8D9",ne.lightFraction=100*(14-4)/(15-4)},{}],366:[function(d,re,ne){var w=d("tinycolor2"),c=d("fast-isnumeric"),M=d("../../lib/array").isTypedArray,T=re.exports={},e=d("./attributes");T.defaults=e.defaults;var a=T.defaultLine=e.defaultLine;T.lightLine=e.lightLine;var n=T.background=e.background;T.tinyRGB=function(t){var f=t.toRgb();return"rgb("+Math.round(f.r)+", "+Math.round(f.g)+", "+Math.round(f.b)+")"},T.rgb=function(t){return T.tinyRGB(w(t))},T.opacity=function(t){return t?w(t).getAlpha():0},T.addOpacity=function(t,f){var o=w(t).toRgb();return"rgba("+Math.round(o.r)+", "+Math.round(o.g)+", "+Math.round(o.b)+", "+f+")"},T.combine=function(t,f){var o=w(t).toRgb();if(o.a===1)return w(t).toRgbString();var i=w(f||n).toRgb(),g=i.a===1?i:{r:255*(1-i.a)+i.r*i.a,g:255*(1-i.a)+i.g*i.a,b:255*(1-i.a)+i.b*i.a},p={r:g.r*(1-o.a)+o.r*o.a,g:g.g*(1-o.a)+o.g*o.a,b:g.b*(1-o.a)+o.b*o.a};return w(p).toRgbString()},T.contrast=function(t,f,o){var i=w(t);i.getAlpha()!==1&&(i=w(T.combine(t,n)));var g=i.isDark()?f?i.lighten(f):n:o?i.darken(o):a;return g.toString()},T.stroke=function(t,f){var o=w(f);t.style({stroke:T.tinyRGB(o),"stroke-opacity":o.getAlpha()})},T.fill=function(t,f){var o=w(f);t.style({fill:T.tinyRGB(o),"fill-opacity":o.getAlpha()})},T.clean=function(t){if(!(!t||typeof t!="object")){var f=Object.keys(t),o,i,g,p;for(o=0;o<f.length;o++)if(g=f[o],p=t[g],g.substr(g.length-5)==="color")if(Array.isArray(p))for(i=0;i<p.length;i++)p[i]=r(p[i]);else t[g]=r(p);else if(g.substr(g.length-10)==="colorscale"&&Array.isArray(p))for(i=0;i<p.length;i++)Array.isArray(p[i])&&(p[i][1]=r(p[i][1]));else if(Array.isArray(p)){var y=p[0];if(!Array.isArray(y)&&y&&typeof y=="object")for(i=0;i<p.length;i++)T.clean(p[i])}else p&&typeof p=="object"&&!M(p)&&T.clean(p)}};function r(t){if(c(t)||typeof t!="string")return t;var f=t.trim();if(f.substr(0,3)!=="rgb")return t;var o=f.match(/^rgba?\s*\(([^()]*)\)$/);if(!o)return t;var i=o[1].trim().split(/\s*[\s,]\s*/),g=f.charAt(3)==="a"&&i.length===4;if(!g&&i.length!==3)return t;for(var p=0;p<i.length;p++){if(!i[p].length||(i[p]=Number(i[p]),!(i[p]>=0)))return t;if(p===3)i[p]>1&&(i[p]=1);else if(i[p]>=1)return t}var y=Math.round(i[0]*255)+", "+Math.round(i[1]*255)+", "+Math.round(i[2]*255);return g?"rgba("+y+", "+i[3]+")":"rgb("+y+")"}},{"../../lib/array":485,"./attributes":365,"fast-isnumeric":190,tinycolor2:312}],367:[function(d,re,ne){var w=d("../../plots/cartesian/layout_attributes"),c=d("../../plots/font_attributes"),M=d("../../lib/extend").extendFlat,T=d("../../plot_api/edit_types").overrideAll;re.exports=T({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:w.linecolor,outlinewidth:w.linewidth,bordercolor:w.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:w.tickmode,nticks:w.nticks,tick0:w.tick0,dtick:w.dtick,tickvals:w.tickvals,ticktext:w.ticktext,ticks:M({},w.ticks,{dflt:""}),ticklabeloverflow:M({},w.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:w.ticklen,tickwidth:w.tickwidth,tickcolor:w.tickcolor,ticklabelstep:w.ticklabelstep,showticklabels:w.showticklabels,tickfont:c({}),tickangle:w.tickangle,tickformat:w.tickformat,tickformatstops:w.tickformatstops,tickprefix:w.tickprefix,showtickprefix:w.showtickprefix,ticksuffix:w.ticksuffix,showticksuffix:w.showticksuffix,separatethousands:w.separatethousands,exponentformat:w.exponentformat,minexponent:w.minexponent,showexponent:w.showexponent,title:{text:{valType:"string"},font:c({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:c({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/cartesian/layout_attributes":569,"../../plots/font_attributes":585}],368:[function(d,re,ne){re.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],369:[function(d,re,ne){var w=d("../../lib"),c=d("../../plot_api/plot_template"),M=d("../../plots/cartesian/tick_value_defaults"),T=d("../../plots/cartesian/tick_mark_defaults"),e=d("../../plots/cartesian/tick_label_defaults"),a=d("../../plots/cartesian/prefix_suffix_defaults"),n=d("./attributes");re.exports=function(t,f,o){var i=c.newContainer(f,"colorbar"),g=t.colorbar||{};function p(S,k){return w.coerce(g,i,n,S,k)}var y=o.margin||{t:0,b:0,l:0,r:0},h=o.width-y.l-y.r,m=o.height-y.t-y.b,u=p("orientation"),_=u==="v",s=p("thicknessmode");p("thickness",s==="fraction"?30/(_?h:m):30);var A=p("lenmode");p("len",A==="fraction"?1:_?m:h),p("x",_?1.02:.5),p("xanchor",_?"left":"center"),p("xpad"),p("y",_?.5:1.02),p("yanchor",_?"middle":"bottom"),p("ypad"),w.noneOrAll(g,i,["x","y"]),p("outlinecolor"),p("outlinewidth"),p("bordercolor"),p("borderwidth"),p("bgcolor");var x=w.coerce(g,i,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:_?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");p("ticklabeloverflow",x.indexOf("inside")!==-1?"hide past domain":"hide past div"),M(g,i,p,"linear");var v=o.font,b={outerTicks:!1,font:v};x.indexOf("inside")!==-1&&(b.bgColor="black"),a(g,i,p,"linear",b),e(g,i,p,"linear",b),T(g,i,p,"linear",b),p("title.text",o._dfltTitle.colorbar);var l=i.tickfont,L=w.extendFlat({},l,{color:v.color,size:w.bigFont(l.size)});w.coerceFont(p,"title.font",L),p("title.side",_?"top":"right")}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/cartesian/prefix_suffix_defaults":573,"../../plots/cartesian/tick_label_defaults":578,"../../plots/cartesian/tick_mark_defaults":579,"../../plots/cartesian/tick_value_defaults":580,"./attributes":367}],370:[function(d,re,ne){var w=d("@plotly/d3"),c=d("tinycolor2"),M=d("../../plots/plots"),T=d("../../registry"),e=d("../../plots/cartesian/axes"),a=d("../dragelement"),n=d("../../lib"),r=n.strTranslate,t=d("../../lib/extend").extendFlat,f=d("../../lib/setcursor"),o=d("../drawing"),i=d("../color"),g=d("../titles"),p=d("../../lib/svg_text_utils"),y=d("../colorscale/helpers").flipScale,h=d("../../plots/cartesian/axis_defaults"),m=d("../../plots/cartesian/position_defaults"),u=d("../../plots/cartesian/layout_attributes"),_=d("../../constants/alignment"),s=_.LINE_SPACING,A=_.FROM_TL,x=_.FROM_BR,v=d("./constants").cn;function b(z){var I=z._fullLayout,D=I._infolayer.selectAll("g."+v.colorbar).data(l(z),function(R){return R._id});D.enter().append("g").attr("class",function(R){return R._id}).classed(v.colorbar,!0),D.each(function(R){var B=w.select(this);n.ensureSingle(B,"rect",v.cbbg),n.ensureSingle(B,"g",v.cbfills),n.ensureSingle(B,"g",v.cblines),n.ensureSingle(B,"g",v.cbaxis,function(V){V.classed(v.crisp,!0)}),n.ensureSingle(B,"g",v.cbtitleunshift,function(V){V.append("g").classed(v.cbtitle,!0)}),n.ensureSingle(B,"rect",v.cboutline);var F=L(B,R,z);F&&F.then&&(z._promises||[]).push(F),z._context.edits.colorbarPosition&&S(B,R,z)}),D.exit().each(function(R){M.autoMargin(z,R._id)}).remove(),D.order()}function l(z){var I=z._fullLayout,D=z.calcdata,R=[],B,F,V,G;function J(W){return t(W,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function j(){typeof G.calc=="function"?G.calc(z,V,B):(B._fillgradient=F.reversescale?y(F.colorscale):F.colorscale,B._zrange=[F[G.min],F[G.max]])}for(var Y=0;Y<D.length;Y++){var X=D[Y];V=X[0].trace;var oe=V._module.colorbar;if(V.visible===!0&&oe)for(var se=Array.isArray(oe),ie=se?oe:[oe],N=0;N<ie.length;N++){G=ie[N];var U=G.container;F=U?V[U]:V,F&&F.showscale&&(B=J(F.colorbar),B._id="cb"+V.uid+(se&&U?"-"+U:""),B._traceIndex=V.index,B._propPrefix=(U?U+".":"")+"colorbar.",B._meta=V._meta,j(),R.push(B))}}for(var q in I._colorAxes)if(F=I[q],F.showscale){var Q=I._colorAxes[q];B=J(F.colorbar),B._id="cb"+q,B._propPrefix=q+".colorbar.",B._meta=I._meta,G={min:"cmin",max:"cmax"},Q[0]!=="heatmap"&&(V=Q[1],G.calc=V._module.colorbar.calc),j(),R.push(B)}return R}function L(z,I,D){var R=I.orientation==="v",B=I.len,F=I.lenmode,V=I.thickness,G=I.thicknessmode,J=I.outlinewidth,j=I.borderwidth,Y=I.bgcolor,X=I.xanchor,oe=I.yanchor,se=I.xpad,ie=I.ypad,N=I.x,U=R?I.y:1-I.y,q=D._fullLayout,Q=q._size,W=I._fillcolor,Z=I._line,ee=I.title,te=ee.side,ae=I._zrange||w.extent((typeof W=="function"?W:Z.color).domain()),le=typeof Z.color=="function"?Z.color:function(){return Z.color},ye=typeof W=="function"?W:function(){return W},fe=I._levels,pe=k(D,I,ae),ge=pe.fill,Ae=pe.line,we=Math.round(V*(G==="fraction"?R?Q.w:Q.h:1)),De=we/(R?Q.w:Q.h),Be=Math.round(B*(F==="fraction"?R?Q.h:Q.w:1)),Ve=Be/(R?Q.h:Q.w),xe=Math.round(R?N*Q.w+se:U*Q.h+ie),Le={center:.5,right:1}[X]||0,He={top:1,middle:.5}[oe]||0,Je=R?N-Le*De:U-He*De,Oe=R?U-He*Ve:N-Le*Ve,Pe=Math.round(R?Q.h*(1-Oe):Q.w*Oe);I._lenFrac=Ve,I._thickFrac=De,I._uFrac=Je,I._vFrac=Oe;var Ue=I._axis=P(D,I,ae);Ue.position=De+(R?N+se/Q.w:U+ie/Q.h);var vt=["top","bottom"].indexOf(te)!==-1;if(R&&vt&&(Ue.title.side=te,Ue.titlex=N+se/Q.w,Ue.titley=Oe+(ee.side==="top"?Ve-ie/Q.h:ie/Q.h)),!R&&!vt&&(Ue.title.side=te,Ue.titley=U+ie/Q.h,Ue.titlex=Oe+se/Q.w),Z.color&&I.tickmode==="auto"){Ue.tickmode="linear",Ue.tick0=fe.start;var Lt=fe.size,Yt=n.constrain(Be/50,4,15)+1,At=(ae[1]-ae[0])/((I.nticks||Yt)*Lt);if(At>1){var Rt=Math.pow(10,Math.floor(Math.log(At)/Math.LN10));Lt*=Rt*n.roundUp(At/Rt,[2,5,10]),(Math.abs(fe.start)/fe.size+1e-6)%1<2e-6&&(Ue.tick0=0)}Ue.dtick=Lt}Ue.domain=R?[Oe+ie/Q.h,Oe+Ve-ie/Q.h]:[Oe+se/Q.w,Oe+Ve-se/Q.w],Ue.setScale(),z.attr("transform",r(Math.round(Q.l),Math.round(Q.t)));var Bt=z.select("."+v.cbtitleunshift).attr("transform",r(-Math.round(Q.l),-Math.round(Q.t))),Mt=Ue.ticklabelposition,Tt=Ue.title.font.size,at=z.select("."+v.cbaxis),ct,je=0,ke=0;function Ye(zt,$t){var Ot={propContainer:Ue,propName:I._propPrefix+"title",traceIndex:I._traceIndex,_meta:I._meta,placeholder:q._dfltTitle.colorbar,containerGroup:z.select("."+v.cbtitle)},Qt=zt.charAt(0)==="h"?zt.substr(1):"h"+zt;z.selectAll("."+Qt+",."+Qt+"-math-group").remove(),g.draw(D,zt,t(Ot,$t||{}))}function Ke(){if(R&&vt||!R&&!vt){var zt,$t;te==="top"&&(zt=se+Q.l+Q.w*N,$t=ie+Q.t+Q.h*(1-Oe-Ve)+3+Tt*.75),te==="bottom"&&(zt=se+Q.l+Q.w*N,$t=ie+Q.t+Q.h*(1-Oe)-3-Tt*.25),te==="right"&&($t=ie+Q.t+Q.h*U+3+Tt*.75,zt=se+Q.l+Q.w*Oe),Ye(Ue._id+"title",{attributes:{x:zt,y:$t,"text-anchor":R?"start":"middle"}})}}function st(){if(R&&!vt||!R&&vt){var zt=Ue.position||0,$t=Ue._offset+Ue._length/2,Ot,Qt;if(te==="right")Qt=$t,Ot=Q.l+Q.w*zt+10+Tt*(Ue.showticklabels?1:.5);else if(Ot=$t,te==="bottom"&&(Qt=Q.t+Q.h*zt+10+(Mt.indexOf("inside")===-1?Ue.tickfont.size:0)+(Ue.ticks!=="intside"&&I.ticklen||0)),te==="top"){var tr=ee.text.split("<br>").length;Qt=Q.t+Q.h*zt+10-we-s*Tt*tr}Ye((R?"h":"v")+Ue._id+"title",{avoid:{selection:w.select(D).selectAll("g."+Ue._id+"tick"),side:te,offsetTop:R?0:Q.t,offsetLeft:R?Q.l:0,maxShift:R?q.width:q.height},attributes:{x:Ot,y:Qt,"text-anchor":"middle"},transform:{rotate:R?-90:0,offset:0}})}}function Et(){if(!R&&!vt||R&&vt){var zt=z.select("."+v.cbtitle),$t=zt.select("text"),Ot=[-J/2,J/2],Qt=zt.select(".h"+Ue._id+"title-math-group").node(),tr=15.6;$t.node()&&(tr=parseInt($t.node().style.fontSize,10)*s);var qt;if(Qt?(qt=o.bBox(Qt),ke=qt.width,je=qt.height,je>tr&&(Ot[1]-=(je-tr)/2)):$t.node()&&!$t.classed(v.jsPlaceholder)&&(qt=o.bBox($t.node()),ke=qt.width,je=qt.height),R){if(je){if(je+=5,te==="top")Ue.domain[1]-=je/Q.h,Ot[1]*=-1;else{Ue.domain[0]+=je/Q.h;var lr=p.lineCount($t);Ot[1]+=(1-lr)*tr}zt.attr("transform",r(Ot[0],Ot[1])),Ue.setScale()}}else ke&&(te==="right"&&(Ue.domain[0]+=(ke+Tt/2)/Q.w),zt.attr("transform",r(Ot[0],Ot[1])),Ue.setScale())}z.selectAll("."+v.cbfills+",."+v.cblines).attr("transform",R?r(0,Math.round(Q.h*(1-Ue.domain[1]))):r(Math.round(Q.w*Ue.domain[0]),0)),at.attr("transform",R?r(0,Math.round(-Q.t)):r(Math.round(-Q.l),0));var Wr=z.select("."+v.cbfills).selectAll("rect."+v.cbfill).attr("style","").data(ge);Wr.enter().append("rect").classed(v.cbfill,!0).style("stroke","none"),Wr.exit().remove();var cn=ae.map(Ue.c2p).map(Math.round).sort(function(Ut,yr){return Ut-yr});Wr.each(function(Ut,yr){var nt=[yr===0?ae[0]:(ge[yr]+ge[yr-1])/2,yr===ge.length-1?ae[1]:(ge[yr]+ge[yr+1])/2].map(Ue.c2p).map(Math.round);R&&(nt[1]=n.constrain(nt[1]+(nt[1]>nt[0])?1:-1,cn[0],cn[1]));var _e=w.select(this).attr(R?"x":"y",xe).attr(R?"y":"x",w.min(nt)).attr(R?"width":"height",Math.max(we,2)).attr(R?"height":"width",Math.max(w.max(nt)-w.min(nt),2));if(I._fillgradient)o.gradient(_e,D,I._id,R?"vertical":"horizontalreversed",I._fillgradient,"fill");else{var Me=ye(Ut).replace("e-","");_e.attr("fill",c(Me).toHexString())}});var Jr=z.select("."+v.cblines).selectAll("path."+v.cbline).data(Z.color&&Z.width?Ae:[]);Jr.enter().append("path").classed(v.cbline,!0),Jr.exit().remove(),Jr.each(function(Ut){var yr=xe,nt=Math.round(Ue.c2p(Ut))+Z.width/2%1;w.select(this).attr("d","M"+(R?yr+","+nt:nt+","+yr)+(R?"h":"v")+we).call(o.lineGroupStyle,Z.width,le(Ut),Z.dash)}),at.selectAll("g."+Ue._id+"tick,path").remove();var ot=xe+we+(J||0)/2-(I.ticks==="outside"?1:0),Vt=e.calcTicks(Ue),jt=e.getTickSigns(Ue)[2];return e.drawTicks(D,Ue,{vals:Ue.ticks==="inside"?e.clipEnds(Ue,Vt):Vt,layer:at,path:e.makeTickPath(Ue,ot,jt),transFn:e.makeTransTickFn(Ue)}),e.drawLabels(D,Ue,{vals:Vt,layer:at,transFn:e.makeTransTickLabelFn(Ue),labelFns:e.makeLabelFns(Ue,ot)})}function bt(){var zt,$t=we+J/2;Mt.indexOf("inside")===-1&&(zt=o.bBox(at.node()),$t+=R?zt.width:zt.height),ct=Bt.select("text");var Ot=0,Qt=R&&te==="top",tr=!R&&te==="right",qt=0;if(ct.node()&&!ct.classed(v.jsPlaceholder)){var lr,Wr=Bt.select(".h"+Ue._id+"title-math-group").node();Wr&&(R&&vt||!R&&!vt)?(zt=o.bBox(Wr),Ot=zt.width,lr=zt.height):(zt=o.bBox(Bt.node()),Ot=zt.right-Q.l-(R?xe:Pe),lr=zt.bottom-Q.t-(R?Pe:xe),!R&&te==="top"&&($t+=zt.height,qt=zt.height)),tr&&(ct.attr("transform",r(Ot/2+Tt/2,0)),Ot*=2),$t=Math.max($t,R?Ot:lr)}var cn=(R?se:ie)*2+$t+j+J/2,Jr=0;!R&&ee.text&&oe==="bottom"&&U<=0&&(Jr=cn/2,cn+=Jr,qt+=Jr),q._hColorbarMoveTitle=Jr,q._hColorbarMoveCBTitle=qt;var ot=j+J;z.select("."+v.cbbg).attr("x",(R?xe:Pe)-ot/2-(R?se:0)).attr("y",(R?Pe:xe)-(R?Be:ie+qt-Jr)).attr(R?"width":"height",Math.max(cn-Jr,2)).attr(R?"height":"width",Math.max(Be+ot,2)).call(i.fill,Y).call(i.stroke,I.bordercolor).style("stroke-width",j);var Vt=tr?Math.max(Ot-10,0):0;if(z.selectAll("."+v.cboutline).attr("x",(R?xe:Pe+se)+Vt).attr("y",(R?Pe+ie-Be:xe)+(Qt?je:0)).attr(R?"width":"height",Math.max(we,2)).attr(R?"height":"width",Math.max(Be-(R?2*ie+je:2*se+Vt),2)).call(i.stroke,I.outlinecolor).style({fill:"none","stroke-width":J}),z.attr("transform",r(Q.l-(R?Le*cn:0),Q.t-(R?0:(1-He)*cn-qt))),!R&&(j||c(Y).getAlpha()&&!c.equals(q.paper_bgcolor,Y))){var jt=at.selectAll("text"),Ut=jt[0].length,yr=z.select("."+v.cbbg).node(),nt=o.bBox(yr),_e=o.getTranslate(z),Me=2;jt.each(function(xt,kt){var Wt=0,Ft=Ut-1;if(kt===Wt||kt===Ft){var ir=o.bBox(this),hr=o.getTranslate(this),_r;if(kt===Ft){var an=ir.right+hr.x,Rr=nt.right+_e.x+Pe-j-Me+N;_r=Rr-an,_r>0&&(_r=0)}else if(kt===Wt){var Vr=ir.left+hr.x,fn=nt.left+_e.x+Pe+j+Me;_r=fn-Vr,_r<0&&(_r=0)}_r&&(Ut<3?this.setAttribute("transform","translate("+_r+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var Ne={},We=A[X],Qe=x[X],rt=A[oe],$e=x[oe],ht=cn-we;R?(F==="pixels"?(Ne.y=U,Ne.t=Be*rt,Ne.b=Be*$e):(Ne.t=Ne.b=0,Ne.yt=U+B*rt,Ne.yb=U-B*$e),G==="pixels"?(Ne.x=N,Ne.l=cn*We,Ne.r=cn*Qe):(Ne.l=ht*We,Ne.r=ht*Qe,Ne.xl=N-V*We,Ne.xr=N+V*Qe)):(F==="pixels"?(Ne.x=N,Ne.l=Be*We,Ne.r=Be*Qe):(Ne.l=Ne.r=0,Ne.xl=N+B*We,Ne.xr=N-B*Qe),G==="pixels"?(Ne.y=1-U,Ne.t=cn*rt,Ne.b=cn*$e):(Ne.t=ht*rt,Ne.b=ht*$e,Ne.yt=U-V*rt,Ne.yb=U+V*$e)),M.autoMargin(D,I._id,Ne)}return n.syncOrAsync([M.previousPromises,Ke,Et,st,M.previousPromises,bt],D)}function S(z,I,D){var R=I.orientation==="v",B=D._fullLayout,F=B._size,V,G,J;a.init({element:z.node(),gd:D,prepFn:function(){V=z.attr("transform"),f(z)},moveFn:function(j,Y){z.attr("transform",V+r(j,Y)),G=a.align((R?I._uFrac:I._vFrac)+j/F.w,R?I._thickFrac:I._lenFrac,0,1,I.xanchor),J=a.align((R?I._vFrac:1-I._uFrac)-Y/F.h,R?I._lenFrac:I._thickFrac,0,1,I.yanchor);var X=a.getCursor(G,J,I.xanchor,I.yanchor);f(z,X)},doneFn:function(){if(f(z),G!==void 0&&J!==void 0){var j={};j[I._propPrefix+"x"]=G,j[I._propPrefix+"y"]=J,I._traceIndex!==void 0?T.call("_guiRestyle",D,j,I._traceIndex):T.call("_guiRelayout",D,j)}}})}function k(z,I,D){var R=I._levels,B=[],F=[],V,G,J=R.end+R.size/100,j=R.size,Y=1.001*D[0]-.001*D[1],X=1.001*D[1]-.001*D[0];for(G=0;G<1e5&&(V=R.start+G*j,!(j>0?V>=J:V<=J));G++)V>Y&&V<X&&B.push(V);if(I._fillgradient)F=[0];else if(typeof I._fillcolor=="function"){var oe=I._filllevels;if(oe)for(J=oe.end+oe.size/100,j=oe.size,G=0;G<1e5&&(V=oe.start+G*j,!(j>0?V>=J:V<=J));G++)V>D[0]&&V<D[1]&&F.push(V);else F=B.map(function(se){return se-R.size/2}),F.push(F[F.length-1]+R.size)}else I._fillcolor&&typeof I._fillcolor=="string"&&(F=[0]);return R.size<0&&(B.reverse(),F.reverse()),{line:B,fill:F}}function P(z,I,D){var R=z._fullLayout,B=I.orientation==="v",F={type:"linear",range:D,tickmode:I.tickmode,nticks:I.nticks,tick0:I.tick0,dtick:I.dtick,tickvals:I.tickvals,ticktext:I.ticktext,ticks:I.ticks,ticklen:I.ticklen,tickwidth:I.tickwidth,tickcolor:I.tickcolor,showticklabels:I.showticklabels,ticklabelposition:I.ticklabelposition,ticklabeloverflow:I.ticklabeloverflow,ticklabelstep:I.ticklabelstep,tickfont:I.tickfont,tickangle:I.tickangle,tickformat:I.tickformat,exponentformat:I.exponentformat,minexponent:I.minexponent,separatethousands:I.separatethousands,showexponent:I.showexponent,showtickprefix:I.showtickprefix,tickprefix:I.tickprefix,showticksuffix:I.showticksuffix,ticksuffix:I.ticksuffix,title:I.title,showline:!0,anchor:"free",side:B?"right":"bottom",position:1},V=B?"y":"x",G={type:"linear",_id:V+I._id},J={letter:V,font:R.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:R.calendar};function j(Y,X){return n.coerce(F,G,u,Y,X)}return h(F,G,j,J,R),m(F,G,j,J),G}re.exports={draw:b}},{"../../constants/alignment":471,"../../lib":503,"../../lib/extend":493,"../../lib/setcursor":524,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_defaults":556,"../../plots/cartesian/layout_attributes":569,"../../plots/cartesian/position_defaults":572,"../../plots/plots":619,"../../registry":638,"../color":366,"../colorscale/helpers":377,"../dragelement":385,"../drawing":388,"../titles":464,"./constants":368,"@plotly/d3":58,tinycolor2:312}],371:[function(d,re,ne){var w=d("../../lib");re.exports=function(M){return w.isPlainObject(M.colorbar)}},{"../../lib":503}],372:[function(d,re,ne){re.exports={moduleType:"component",name:"colorbar",attributes:d("./attributes"),supplyDefaults:d("./defaults"),draw:d("./draw").draw,hasColorbar:d("./has_colorbar")}},{"./attributes":367,"./defaults":369,"./draw":370,"./has_colorbar":371}],373:[function(d,re,ne){var w=d("../colorbar/attributes"),c=d("../../lib/regex").counter,M=d("../../lib/sort_object_keys"),T=d("./scales.js").scales;M(T),re.exports=function(a,n){a=a||"",n=n||{};var r=n.cLetter||"c";"onlyIfNumerical"in n?n.onlyIfNumerical:Boolean(a);var t="noScale"in n?n.noScale:a==="marker.line",f="showScaleDflt"in n?n.showScaleDflt:r==="z",o=typeof n.colorscaleDflt=="string"?T[n.colorscaleDflt]:null,i=n.editTypeOverride||"",g;"colorAttr"in n?g=n.colorAttr:g={z:"z",c:"color"}[r];var p=r+"auto",y=r+"min",h=r+"max",m=r+"mid",u={};u[y]=u[h]=void 0;var _={};_[p]=!1;var s={};return g==="color"&&(s.color={valType:"color",arrayOk:!0,editType:i||"style"},n.anim&&(s.color.anim=!0)),s[p]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:u},s[y]={valType:"number",dflt:null,editType:i||"plot",impliedEdits:_},s[h]={valType:"number",dflt:null,editType:i||"plot",impliedEdits:_},s[m]={valType:"number",dflt:null,editType:"calc",impliedEdits:u},s.colorscale={valType:"colorscale",editType:"calc",dflt:o,impliedEdits:{autocolorscale:!1}},s.autocolorscale={valType:"boolean",dflt:n.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},s.reversescale={valType:"boolean",dflt:!1,editType:"plot"},t||(s.showscale={valType:"boolean",dflt:f,editType:"calc"},s.colorbar=w),n.noColorAxis||(s.coloraxis={valType:"subplotid",regex:c("coloraxis"),dflt:null,editType:"calc"}),s}},{"../../lib/regex":520,"../../lib/sort_object_keys":526,"../colorbar/attributes":367,"./scales.js":381}],374:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("./helpers").extractOpts;re.exports=function(e,a,n){var r=e._fullLayout,t=n.vals,f=n.containerStr,o=f?c.nestedProperty(a,f).get():a,i=M(o),g=i.auto!==!1,p=i.min,y=i.max,h=i.mid,m=function(){return c.aggNums(Math.min,null,t)},u=function(){return c.aggNums(Math.max,null,t)};if(p===void 0?p=m():g&&(o._colorAx&&w(p)?p=Math.min(p,m()):p=m()),y===void 0?y=u():g&&(o._colorAx&&w(y)?y=Math.max(y,u()):y=u()),g&&h!==void 0&&(y-h>h-p?p=h-(y-h):y-h<h-p&&(y=h+(h-p))),p===y&&(p-=.5,y+=.5),i._sync("min",p),i._sync("max",y),i.autocolorscale){var _;p*y<0?_=r.colorscale.diverging:p>=0?_=r.colorscale.sequential:_=r.colorscale.sequentialminus,i._sync("colorscale",_)}}},{"../../lib":503,"./helpers":377,"fast-isnumeric":190}],375:[function(d,re,ne){var w=d("../../lib"),c=d("./helpers").hasColorscale,M=d("./helpers").extractOpts;re.exports=function(e,a){function n(p,y){var h=p["_"+y];h!==void 0&&(p[y]=h)}function r(p,y){var h=y.container?w.nestedProperty(p,y.container).get():p;if(h)if(h.coloraxis)h._colorAx=a[h.coloraxis];else{var m=M(h),u=m.auto;(u||m.min===void 0)&&n(h,y.min),(u||m.max===void 0)&&n(h,y.max),m.autocolorscale&&n(h,"colorscale")}}for(var t=0;t<e.length;t++){var f=e[t],o=f._module.colorbar;if(o)if(Array.isArray(o))for(var i=0;i<o.length;i++)r(f,o[i]);else r(f,o);c(f,"marker.line")&&r(f,{container:"marker.line",min:"cmin",max:"cmax"})}for(var g in a._colorAxes)r(a[g],{min:"cmin",max:"cmax"})}},{"../../lib":503,"./helpers":377}],376:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("../colorbar/has_colorbar"),T=d("../colorbar/defaults"),e=d("./scales").isValid,a=d("../../registry").traceIs;function n(r,t){var f=t.slice(0,t.length-1);return t?c.nestedProperty(r,f).get()||{}:r}re.exports=function r(t,f,o,i,g){var p=g.prefix,y=g.cLetter,h="_module"in f,m=n(t,p),u=n(f,p),_=n(f._template||{},p)||{},s=function(){return delete t.coloraxis,delete f.coloraxis,r(t,f,o,i,g)};if(h){var A=o._colorAxes||{},x=i(p+"coloraxis");if(x){var v=a(f,"contour")&&c.nestedProperty(f,"contours.coloring").get()||"heatmap",b=A[x];b?(b[2].push(s),b[0]!==v&&(b[0]=!1,c.warn(["Ignoring coloraxis:",x,"setting","as it is linked to incompatible colorscales."].join(" ")))):A[x]=[v,f,[s]];return}}var l=m[y+"min"],L=m[y+"max"],S=w(l)&&w(L)&&l<L,k=i(p+y+"auto",!S);k?i(p+y+"mid"):(i(p+y+"min"),i(p+y+"max"));var P=m.colorscale,z=_.colorscale,I;if(P!==void 0&&(I=!e(P)),z!==void 0&&(I=!e(z)),i(p+"autocolorscale",I),i(p+"colorscale"),i(p+"reversescale"),p!=="marker.line."){var D;p&&h&&(D=M(m));var R=i(p+"showscale",D);R&&(p&&_&&(u._template=_),T(m,u,o))}}},{"../../lib":503,"../../registry":638,"../colorbar/defaults":369,"../colorbar/has_colorbar":371,"./scales":381,"fast-isnumeric":190}],377:[function(d,re,ne){var w=d("@plotly/d3"),c=d("tinycolor2"),M=d("fast-isnumeric"),T=d("../../lib"),e=d("../color"),a=d("./scales").isValid;function n(h,m,u){var _=m?T.nestedProperty(h,m).get()||{}:h,s=_[u||"color"],A=!1;if(T.isArrayOrTypedArray(s)){for(var x=0;x<s.length;x++)if(M(s[x])){A=!0;break}}return T.isPlainObject(_)&&(A||_.showscale===!0||M(_.cmin)&&M(_.cmax)||a(_.colorscale)||T.isPlainObject(_.colorbar))}var r=["showscale","autocolorscale","colorscale","reversescale","colorbar"],t=["min","max","mid","auto"];function f(h){var m=h._colorAx,u=m||h,_={},s,A,x;for(A=0;A<r.length;A++)x=r[A],_[x]=u[x];if(m)for(s="c",A=0;A<t.length;A++)x=t[A],_[x]=u["c"+x];else{var v;for(A=0;A<t.length;A++){if(x=t[A],v="c"+x,v in u){_[x]=u[v];continue}v="z"+x,v in u&&(_[x]=u[v])}s=v.charAt(0)}return _._sync=function(b,l){var L=t.indexOf(b)!==-1?s+b:b;u[L]=u["_"+L]=l},_}function o(h){for(var m=f(h),u=m.min,_=m.max,s=m.reversescale?i(m.colorscale):m.colorscale,A=s.length,x=new Array(A),v=new Array(A),b=0;b<A;b++){var l=s[b];x[b]=u+l[0]*(_-u),v[b]=l[1]}return{domain:x,range:v}}function i(h){for(var m=h.length,u=new Array(m),_=m-1,s=0;_>=0;_--,s++){var A=h[_];u[s]=[1-A[0],A[1]]}return u}function g(h,m){m=m||{};for(var u=h.domain,_=h.range,s=_.length,A=new Array(s),x=0;x<s;x++){var v=c(_[x]).toRgb();A[x]=[v.r,v.g,v.b,v.a]}var b=w.scale.linear().domain(u).range(A).clamp(!0),l=m.noNumericCheck,L=m.returnArray,S;return l&&L?S=b:l?S=function(k){return y(b(k))}:L?S=function(k){return M(k)?b(k):c(k).isValid()?k:e.defaultLine}:S=function(k){return M(k)?y(b(k)):c(k).isValid()?k:e.defaultLine},S.domain=b.domain,S.range=function(){return _},S}function p(h,m){return g(o(h),m)}function y(h){var m={r:h[0],g:h[1],b:h[2],a:h[3]};return c(m).toRgbString()}re.exports={hasColorscale:n,extractOpts:f,extractScale:o,flipScale:i,makeColorScaleFunc:g,makeColorScaleFuncFromTrace:p}},{"../../lib":503,"../color":366,"./scales":381,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:312}],378:[function(d,re,ne){var w=d("./scales"),c=d("./helpers");re.exports={moduleType:"component",name:"colorscale",attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),handleDefaults:d("./defaults"),crossTraceDefaults:d("./cross_trace_defaults"),calc:d("./calc"),scales:w.scales,defaultScale:w.defaultScale,getScale:w.get,isValidScale:w.isValid,hasColorscale:c.hasColorscale,extractOpts:c.extractOpts,extractScale:c.extractScale,flipScale:c.flipScale,makeColorScaleFunc:c.makeColorScaleFunc,makeColorScaleFuncFromTrace:c.makeColorScaleFuncFromTrace}},{"./attributes":373,"./calc":374,"./cross_trace_defaults":375,"./defaults":376,"./helpers":377,"./layout_attributes":379,"./layout_defaults":380,"./scales":381}],379:[function(d,re,ne){var w=d("../../lib/extend").extendFlat,c=d("./attributes"),M=d("./scales").scales;re.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:M.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:M.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:M.RdBu,editType:"calc"}},coloraxis:w({_isSubplotObj:!0,editType:"calc"},c("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":493,"./attributes":373,"./scales":381}],380:[function(d,re,ne){var w=d("../../lib"),c=d("../../plot_api/plot_template"),M=d("./layout_attributes"),T=d("./defaults");re.exports=function(a,n){function r(h,m){return w.coerce(a,n,M,h,m)}r("colorscale.sequential"),r("colorscale.sequentialminus"),r("colorscale.diverging");var t=n._colorAxes,f,o;function i(h,m){return w.coerce(f,o,M.coloraxis,h,m)}for(var g in t){var p=t[g];if(p[0])f=a[g]||{},o=c.newContainer(n,g,"coloraxis"),o._name=g,T(f,o,n,i,{prefix:"",cLetter:"c"});else{for(var y=0;y<p[2].length;y++)p[2][y]();delete n._colorAxes[g]}}}},{"../../lib":503,"../../plot_api/plot_template":543,"./defaults":376,"./layout_attributes":379}],381:[function(d,re,ne){var w=d("tinycolor2"),c={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},M=c.RdBu;function T(n,r){if(r||(r=M),!n)return r;function t(){try{n=c[n]||JSON.parse(n)}catch{n=r}}return typeof n=="string"&&(t(),typeof n=="string"&&t()),e(n)?n:r}function e(n){var r=0;if(!Array.isArray(n)||n.length<2||!n[0]||!n[n.length-1]||+n[0][0]!=0||+n[n.length-1][0]!=1)return!1;for(var t=0;t<n.length;t++){var f=n[t];if(f.length!==2||+f[0]<r||!w(f[1]).isValid())return!1;r=+f[0]}return!0}function a(n){return c[n]!==void 0?!0:e(n)}re.exports={scales:c,defaultScale:M,get:T,isValid:a}},{tinycolor2:312}],382:[function(d,re,ne){re.exports=function(c,M,T,e,a){var n=(c-T)/(e-T),r=n+M/(e-T),t=(n+r)/2;return a==="left"||a==="bottom"?n:a==="center"||a==="middle"?t:a==="right"||a==="top"?r:n<2/3-t?n:r>4/3-t?r:t}},{}],383:[function(d,re,ne){var w=d("../../lib"),c=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];re.exports=function(T,e,a,n){return a==="left"?T=0:a==="center"?T=1:a==="right"?T=2:T=w.constrain(Math.floor(T*3),0,2),n==="bottom"?e=0:n==="middle"?e=1:n==="top"?e=2:e=w.constrain(Math.floor(e*3),0,2),c[e][T]}},{"../../lib":503}],384:[function(d,re,ne){ne.selectMode=function(w){return w==="lasso"||w==="select"},ne.drawMode=function(w){return w==="drawclosedpath"||w==="drawopenpath"||w==="drawline"||w==="drawrect"||w==="drawcircle"},ne.openMode=function(w){return w==="drawline"||w==="drawopenpath"},ne.rectMode=function(w){return w==="select"||w==="drawline"||w==="drawrect"||w==="drawcircle"},ne.freeMode=function(w){return w==="lasso"||w==="drawclosedpath"||w==="drawopenpath"},ne.selectingOrDrawing=function(w){return ne.freeMode(w)||ne.rectMode(w)}},{}],385:[function(d,re,ne){var w=d("mouse-event-offset"),c=d("has-hover"),M=d("has-passive-events"),T=d("../../lib").removeElement,e=d("../../plots/cartesian/constants"),a=re.exports={};a.align=d("./align"),a.getCursor=d("./cursor");var n=d("./unhover");a.unhover=n.wrapped,a.unhoverRaw=n.raw,a.init=function(o){var i=o.gd,g=1,p=i._context.doubleClickDelay,y=o.element,h,m,u,_,s,A,x,v;i._mouseDownTime||(i._mouseDownTime=0),y.style.pointerEvents="all",y.onmousedown=L,M?(y._ontouchstart&&y.removeEventListener("touchstart",y._ontouchstart),y._ontouchstart=L,y.addEventListener("touchstart",L,{passive:!1})):y.ontouchstart=L;function b(P,z,I){return Math.abs(P)<I&&(P=0),Math.abs(z)<I&&(z=0),[P,z]}var l=o.clampFn||b;function L(P){i._dragged=!1,i._dragging=!0;var z=t(P);h=z[0],m=z[1],x=P.target,A=P,v=P.buttons===2||P.ctrlKey,typeof P.clientX=="undefined"&&typeof P.clientY=="undefined"&&(P.clientX=h,P.clientY=m),u=new Date().getTime(),u-i._mouseDownTime<p?g+=1:(g=1,i._mouseDownTime=u),o.prepFn&&o.prepFn(P,h,m),c&&!v?(s=r(),s.style.cursor=window.getComputedStyle(y).cursor):c||(s=document,_=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(y).cursor),document.addEventListener("mouseup",k),document.addEventListener("touchend",k),o.dragmode!==!1&&(P.preventDefault(),document.addEventListener("mousemove",S),document.addEventListener("touchmove",S,{passive:!1}))}function S(P){P.preventDefault();var z=t(P),I=o.minDrag||e.MINDRAG,D=l(z[0]-h,z[1]-m,I),R=D[0],B=D[1];(R||B)&&(i._dragged=!0,a.unhover(i,P)),i._dragged&&o.moveFn&&!v&&(i._dragdata={element:y,dx:R,dy:B},o.moveFn(R,B))}function k(P){if(delete i._dragdata,o.dragmode!==!1&&(P.preventDefault(),document.removeEventListener("mousemove",S),document.removeEventListener("touchmove",S)),document.removeEventListener("mouseup",k),document.removeEventListener("touchend",k),c?T(s):_&&(s.documentElement.style.cursor=_,_=null),!i._dragging){i._dragged=!1;return}if(i._dragging=!1,new Date().getTime()-i._mouseDownTime>p&&(g=Math.max(g-1,1)),i._dragged)o.doneFn&&o.doneFn();else if(o.clickFn&&o.clickFn(g,A),!v){var z;try{z=new MouseEvent("click",P)}catch{var I=t(P);z=document.createEvent("MouseEvents"),z.initMouseEvent("click",P.bubbles,P.cancelable,P.view,P.detail,P.screenX,P.screenY,I[0],I[1],P.ctrlKey,P.altKey,P.shiftKey,P.metaKey,P.button,P.relatedTarget)}x.dispatchEvent(z)}i._dragging=!1,i._dragged=!1}};function r(){var f=document.createElement("div");f.className="dragcover";var o=f.style;return o.position="fixed",o.left=0,o.right=0,o.top=0,o.bottom=0,o.zIndex=999999999,o.background="none",document.body.appendChild(f),f}a.coverSlip=r;function t(f){return w(f.changedTouches?f.changedTouches[0]:f,document.body)}},{"../../lib":503,"../../plots/cartesian/constants":561,"./align":382,"./cursor":383,"./unhover":386,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],386:[function(d,re,ne){var w=d("../../lib/events"),c=d("../../lib/throttle"),M=d("../../lib/dom").getGraphDiv,T=d("../fx/constants"),e=re.exports={};e.wrapped=function(a,n,r){a=M(a),a._fullLayout&&c.clear(a._fullLayout._uid+T.HOVERID),e.raw(a,n,r)},e.raw=function(n,r){var t=n._fullLayout,f=n._hoverdata;r||(r={}),!(r.target&&!n._dragged&&w.triggerHandler(n,"plotly_beforehover",r)===!1)&&(t._hoverlayer.selectAll("g").remove(),t._hoverlayer.selectAll("line").remove(),t._hoverlayer.selectAll("circle").remove(),n._hoverdata=void 0,r.target&&f&&n.emit("plotly_unhover",{event:r,points:f}))}},{"../../lib/dom":491,"../../lib/events":492,"../../lib/throttle":530,"../fx/constants":400}],387:[function(d,re,ne){ne.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},ne.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],388:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=c.numberFormat,T=d("fast-isnumeric"),e=d("tinycolor2"),a=d("../../registry"),n=d("../color"),r=d("../colorscale"),t=c.strTranslate,f=d("../../lib/svg_text_utils"),o=d("../../constants/xmlns_namespaces"),i=d("../../constants/alignment"),g=i.LINE_SPACING,p=d("../../constants/interactions").DESELECTDIM,y=d("../../traces/scatter/subtypes"),h=d("../../traces/scatter/make_bubble_size_func"),m=d("../../components/fx/helpers").appendArrayPointValue,u=re.exports={};u.font=function(X,oe,se,ie){c.isPlainObject(oe)&&(ie=oe.color,se=oe.size,oe=oe.family),oe&&X.style("font-family",oe),se+1&&X.style("font-size",se+"px"),ie&&X.call(n.fill,ie)},u.setPosition=function(X,oe,se){X.attr("x",oe).attr("y",se)},u.setSize=function(X,oe,se){X.attr("width",oe).attr("height",se)},u.setRect=function(X,oe,se,ie,N){X.call(u.setPosition,oe,se).call(u.setSize,ie,N)},u.translatePoint=function(X,oe,se,ie){var N=se.c2p(X.x),U=ie.c2p(X.y);if(T(N)&&T(U)&&oe.node())oe.node().nodeName==="text"?oe.attr("x",N).attr("y",U):oe.attr("transform",t(N,U));else return!1;return!0},u.translatePoints=function(X,oe,se){X.each(function(ie){var N=w.select(this);u.translatePoint(ie,N,oe,se)})},u.hideOutsideRangePoint=function(X,oe,se,ie,N,U){oe.attr("display",se.isPtWithinRange(X,N)&&ie.isPtWithinRange(X,U)?null:"none")},u.hideOutsideRangePoints=function(X,oe){if(!!oe._hasClipOnAxisFalse){var se=oe.xaxis,ie=oe.yaxis;X.each(function(N){var U=N[0].trace,q=U.xcalendar,Q=U.ycalendar,W=a.traceIs(U,"bar-like")?".bartext":".point,.textpoint";X.selectAll(W).each(function(Z){u.hideOutsideRangePoint(Z,w.select(this),se,ie,q,Q)})})}},u.crispRound=function(X,oe,se){return!oe||!T(oe)?se||0:X._context.staticPlot?oe:oe<1?1:Math.round(oe)},u.singleLineStyle=function(X,oe,se,ie,N){oe.style("fill","none");var U=(((X||[])[0]||{}).trace||{}).line||{},q=se||U.width||0,Q=N||U.dash||"";n.stroke(oe,ie||U.color),u.dashLine(oe,Q,q)},u.lineGroupStyle=function(X,oe,se,ie){X.style("fill","none").each(function(N){var U=(((N||[])[0]||{}).trace||{}).line||{},q=oe||U.width||0,Q=ie||U.dash||"";w.select(this).call(n.stroke,se||U.color).call(u.dashLine,Q,q)})},u.dashLine=function(X,oe,se){se=+se||0,oe=u.dashStyle(oe,se),X.style({"stroke-dasharray":oe,"stroke-width":se+"px"})},u.dashStyle=function(X,oe){oe=+oe||1;var se=Math.max(oe,3);return X==="solid"?X="":X==="dot"?X=se+"px,"+se+"px":X==="dash"?X=3*se+"px,"+3*se+"px":X==="longdash"?X=5*se+"px,"+5*se+"px":X==="dashdot"?X=3*se+"px,"+se+"px,"+se+"px,"+se+"px":X==="longdashdot"&&(X=5*se+"px,"+2*se+"px,"+se+"px,"+2*se+"px"),X};function _(X,oe,se){var ie=oe.fillpattern,N=ie&&u.getPatternAttr(ie.shape,0,"");if(N){var U=u.getPatternAttr(ie.bgcolor,0,null),q=u.getPatternAttr(ie.fgcolor,0,null),Q=ie.fgopacity,W=u.getPatternAttr(ie.size,0,8),Z=u.getPatternAttr(ie.solidity,0,.3),ee=oe.uid;u.pattern(X,"point",se,ee,N,W,Z,void 0,ie.fillmode,U,q,Q)}else oe.fillcolor&&X.call(n.fill,oe.fillcolor)}u.singleFillStyle=function(X,oe){var se=w.select(X.node()),ie=se.data(),N=((ie[0]||[])[0]||{}).trace||{};_(X,N,oe)},u.fillGroupStyle=function(X,oe){X.style("stroke-width",0).each(function(se){var ie=w.select(this);se[0].trace&&_(ie,se[0].trace,oe)})};var s=d("./symbol_defs");u.symbolNames=[],u.symbolFuncs=[],u.symbolNeedLines={},u.symbolNoDot={},u.symbolNoFill={},u.symbolList=[],Object.keys(s).forEach(function(X){var oe=s[X],se=oe.n;u.symbolList.push(se,String(se),X,se+100,String(se+100),X+"-open"),u.symbolNames[se]=X,u.symbolFuncs[se]=oe.f,oe.needLine&&(u.symbolNeedLines[se]=!0),oe.noDot?u.symbolNoDot[se]=!0:u.symbolList.push(se+200,String(se+200),X+"-dot",se+300,String(se+300),X+"-open-dot"),oe.noFill&&(u.symbolNoFill[se]=!0)});var A=u.symbolNames.length,x="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";u.symbolNumber=function(X){if(T(X))X=+X;else if(typeof X=="string"){var oe=0;X.indexOf("-open")>0&&(oe=100,X=X.replace("-open","")),X.indexOf("-dot")>0&&(oe+=200,X=X.replace("-dot","")),X=u.symbolNames.indexOf(X),X>=0&&(X+=oe)}return X%100>=A||X>=400?0:Math.floor(Math.max(X,0))};function v(X,oe){var se=X%100;return u.symbolFuncs[se](oe)+(X>=200?x:"")}var b={x1:1,x2:0,y1:0,y2:0},l={x1:0,x2:0,y1:1,y2:0},L=M("~f"),S={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:b},horizontalreversed:{node:"linearGradient",attrs:b,reversed:!0},vertical:{node:"linearGradient",attrs:l},verticalreversed:{node:"linearGradient",attrs:l,reversed:!0}};u.gradient=function(X,oe,se,ie,N,U){for(var q=N.length,Q=S[ie],W=new Array(q),Z=0;Z<q;Z++)Q.reversed?W[q-1-Z]=[L((1-N[Z][0])*100),N[Z][1]]:W[Z]=[L(N[Z][0]*100),N[Z][1]];var ee=oe._fullLayout,te="g"+ee._uid+"-"+se,ae=ee._defs.select(".gradients").selectAll("#"+te).data([ie+W.join(";")],c.identity);ae.exit().remove(),ae.enter().append(Q.node).each(function(){var le=w.select(this);Q.attrs&&le.attr(Q.attrs),le.attr("id",te);var ye=le.selectAll("stop").data(W);ye.exit().remove(),ye.enter().append("stop"),ye.each(function(fe){var pe=e(fe[1]);w.select(this).attr({offset:fe[0]+"%","stop-color":n.tinyRGB(pe),"stop-opacity":pe.getAlpha()})})}),X.style(U,J(te,oe)).style(U+"-opacity",null),X.classed("gradient_filled",!0)},u.pattern=function(X,oe,se,ie,N,U,q,Q,W,Z,ee,te){var ae=oe==="legend";Q&&(W==="overlay"?(Z=Q,ee=n.contrast(Z)):(Z=void 0,ee=Q));var le=se._fullLayout,ye="p"+le._uid+"-"+ie,fe,pe,ge=function(He,Je,Oe,Pe,Ue){return Pe+(Ue-Pe)*(He-Je)/(Oe-Je)},Ae,we,De,Be,Ve={};switch(N){case"/":fe=U*Math.sqrt(2),pe=U*Math.sqrt(2),Ae="M-"+fe/4+","+pe/4+"l"+fe/2+",-"+pe/2+"M0,"+pe+"L"+fe+",0M"+fe/4*3+","+pe/4*5+"l"+fe/2+",-"+pe/2,we=q*U,Be="path",Ve={d:Ae,opacity:te,stroke:ee,"stroke-width":we+"px"};break;case"\\":fe=U*Math.sqrt(2),pe=U*Math.sqrt(2),Ae="M"+fe/4*3+",-"+pe/4+"l"+fe/2+","+pe/2+"M0,0L"+fe+","+pe+"M-"+fe/4+","+pe/4*3+"l"+fe/2+","+pe/2,we=q*U,Be="path",Ve={d:Ae,opacity:te,stroke:ee,"stroke-width":we+"px"};break;case"x":fe=U*Math.sqrt(2),pe=U*Math.sqrt(2),Ae="M-"+fe/4+","+pe/4+"l"+fe/2+",-"+pe/2+"M0,"+pe+"L"+fe+",0M"+fe/4*3+","+pe/4*5+"l"+fe/2+",-"+pe/2+"M"+fe/4*3+",-"+pe/4+"l"+fe/2+","+pe/2+"M0,0L"+fe+","+pe+"M-"+fe/4+","+pe/4*3+"l"+fe/2+","+pe/2,we=U-U*Math.sqrt(1-q),Be="path",Ve={d:Ae,opacity:te,stroke:ee,"stroke-width":we+"px"};break;case"|":fe=U,pe=U,Be="path",Ae="M"+fe/2+",0L"+fe/2+","+pe,we=q*U,Be="path",Ve={d:Ae,opacity:te,stroke:ee,"stroke-width":we+"px"};break;case"-":fe=U,pe=U,Be="path",Ae="M0,"+pe/2+"L"+fe+","+pe/2,we=q*U,Be="path",Ve={d:Ae,opacity:te,stroke:ee,"stroke-width":we+"px"};break;case"+":fe=U,pe=U,Be="path",Ae="M"+fe/2+",0L"+fe/2+","+pe+"M0,"+pe/2+"L"+fe+","+pe/2,we=U-U*Math.sqrt(1-q),Be="path",Ve={d:Ae,opacity:te,stroke:ee,"stroke-width":we+"px"};break;case".":fe=U,pe=U,q<Math.PI/4?De=Math.sqrt(q*U*U/Math.PI):De=ge(q,Math.PI/4,1,U/2,U/Math.sqrt(2)),Be="circle",Ve={cx:fe/2,cy:pe/2,r:De,opacity:te,fill:ee};break}var xe=[N||"noSh",Z||"noBg",ee||"noFg",U,q].join(";"),Le=le._defs.select(".patterns").selectAll("#"+ye).data([xe],c.identity);Le.exit().remove(),Le.enter().append("pattern").each(function(){var He=w.select(this);if(He.attr({id:ye,width:fe+"px",height:pe+"px",patternUnits:"userSpaceOnUse",patternTransform:ae?"scale(0.8)":""}),Z){var Je=He.selectAll("rect").data([0]);Je.exit().remove(),Je.enter().append("rect").attr({width:fe+"px",height:pe+"px",fill:Z})}var Oe=He.selectAll(Be).data([0]);Oe.exit().remove(),Oe.enter().append(Be).attr(Ve)}),X.style("fill",J(ye,se)).style("fill-opacity",null),X.classed("pattern_filled",!0)},u.initGradients=function(X){var oe=X._fullLayout,se=c.ensureSingle(oe._defs,"g","gradients");se.selectAll("linearGradient,radialGradient").remove(),w.select(X).selectAll(".gradient_filled").classed("gradient_filled",!1)},u.initPatterns=function(X){var oe=X._fullLayout,se=c.ensureSingle(oe._defs,"g","patterns");se.selectAll("pattern").remove(),w.select(X).selectAll(".pattern_filled").classed("pattern_filled",!1)},u.getPatternAttr=function(X,oe,se){return X&&c.isArrayOrTypedArray(X)?oe<X.length?X[oe]:se:X},u.pointStyle=function(X,oe,se){if(!!X.size()){var ie=u.makePointStyleFns(oe);X.each(function(N){u.singlePointStyle(N,w.select(this),oe,ie,se)})}},u.singlePointStyle=function(X,oe,se,ie,N){var U=se.marker,q=U.line;if(oe.style("opacity",ie.selectedOpacityFn?ie.selectedOpacityFn(X):X.mo===void 0?U.opacity:X.mo),ie.ms2mrc){var Q;X.ms==="various"||U.size==="various"?Q=3:Q=ie.ms2mrc(X.ms),X.mrc=Q,ie.selectedSizeFn&&(Q=X.mrc=ie.selectedSizeFn(X));var W=u.symbolNumber(X.mx||U.symbol)||0;X.om=W%200>=100,oe.attr("d",v(W,Q))}var Z=!1,ee,te,ae;if(X.so)ae=q.outlierwidth,te=q.outliercolor,ee=U.outliercolor;else{var le=(q||{}).width;ae=(X.mlw+1||le+1||(X.trace?(X.trace.marker.line||{}).width:0)+1)-1||0,"mlc"in X?te=X.mlcc=ie.lineScale(X.mlc):c.isArrayOrTypedArray(q.color)?te=n.defaultLine:te=q.color,c.isArrayOrTypedArray(U.color)&&(ee=n.defaultLine,Z=!0),"mc"in X?ee=X.mcc=ie.markerScale(X.mc):ee=U.color||"rgba(0,0,0,0)",ie.selectedColorFn&&(ee=ie.selectedColorFn(X))}if(X.om)oe.call(n.stroke,ee).style({"stroke-width":(ae||1)+"px",fill:"none"});else{oe.style("stroke-width",(X.isBlank?0:ae)+"px");var ye=U.gradient,fe=X.mgt;fe?Z=!0:fe=ye&&ye.type,c.isArrayOrTypedArray(fe)&&(fe=fe[0],S[fe]||(fe=0));var pe=U.pattern,ge=pe&&u.getPatternAttr(pe.shape,X.i,"");if(fe&&fe!=="none"){var Ae=X.mgc;Ae?Z=!0:Ae=ye.color;var we=se.uid;Z&&(we+="-"+X.i),u.gradient(oe,N,we,fe,[[0,Ae],[1,ee]],"fill")}else if(ge){var De=u.getPatternAttr(pe.bgcolor,X.i,null),Be=u.getPatternAttr(pe.fgcolor,X.i,null),Ve=pe.fgopacity,xe=u.getPatternAttr(pe.size,X.i,8),Le=u.getPatternAttr(pe.solidity,X.i,.3),He=X.mcc||c.isArrayOrTypedArray(pe.shape)||c.isArrayOrTypedArray(pe.bgcolor)||c.isArrayOrTypedArray(pe.size)||c.isArrayOrTypedArray(pe.solidity),Je=se.uid;He&&(Je+="-"+X.i),u.pattern(oe,"point",N,Je,ge,xe,Le,X.mcc,pe.fillmode,De,Be,Ve)}else n.fill(oe,ee);ae&&n.stroke(oe,te)}},u.makePointStyleFns=function(X){var oe={},se=X.marker;return oe.markerScale=u.tryColorscale(se,""),oe.lineScale=u.tryColorscale(se,"line"),a.traceIs(X,"symbols")&&(oe.ms2mrc=y.isBubble(X)?h(X):function(){return(se.size||6)/2}),X.selectedpoints&&c.extendFlat(oe,u.makeSelectedPointStyleFns(X)),oe},u.makeSelectedPointStyleFns=function(X){var oe={},se=X.selected||{},ie=X.unselected||{},N=X.marker||{},U=se.marker||{},q=ie.marker||{},Q=N.opacity,W=U.opacity,Z=q.opacity,ee=W!==void 0,te=Z!==void 0;(c.isArrayOrTypedArray(Q)||ee||te)&&(oe.selectedOpacityFn=function(De){var Be=De.mo===void 0?N.opacity:De.mo;return De.selected?ee?W:Be:te?Z:p*Be});var ae=N.color,le=U.color,ye=q.color;(le||ye)&&(oe.selectedColorFn=function(De){var Be=De.mcc||ae;return De.selected?le||Be:ye||Be});var fe=N.size,pe=U.size,ge=q.size,Ae=pe!==void 0,we=ge!==void 0;return a.traceIs(X,"symbols")&&(Ae||we)&&(oe.selectedSizeFn=function(De){var Be=De.mrc||fe/2;return De.selected?Ae?pe/2:Be:we?ge/2:Be}),oe},u.makeSelectedTextStyleFns=function(X){var oe={},se=X.selected||{},ie=X.unselected||{},N=X.textfont||{},U=se.textfont||{},q=ie.textfont||{},Q=N.color,W=U.color,Z=q.color;return oe.selectedTextColorFn=function(ee){var te=ee.tc||Q;return ee.selected?W||te:Z||(W?te:n.addOpacity(te,p))},oe},u.selectedPointStyle=function(X,oe){if(!(!X.size()||!oe.selectedpoints)){var se=u.makeSelectedPointStyleFns(oe),ie=oe.marker||{},N=[];se.selectedOpacityFn&&N.push(function(U,q){U.style("opacity",se.selectedOpacityFn(q))}),se.selectedColorFn&&N.push(function(U,q){n.fill(U,se.selectedColorFn(q))}),se.selectedSizeFn&&N.push(function(U,q){var Q=q.mx||ie.symbol||0,W=se.selectedSizeFn(q);U.attr("d",v(u.symbolNumber(Q),W)),q.mrc2=W}),N.length&&X.each(function(U){for(var q=w.select(this),Q=0;Q<N.length;Q++)N[Q](q,U)})}},u.tryColorscale=function(X,oe){var se=oe?c.nestedProperty(X,oe).get():X;if(se){var ie=se.color;if((se.colorscale||se._colorAx)&&c.isArrayOrTypedArray(ie))return r.makeColorScaleFuncFromTrace(se)}return c.identity};var k={start:1,end:-1,middle:0,bottom:1,top:-1};function P(X,oe,se,ie,N){var U=w.select(X.node().parentNode),q=oe.indexOf("top")!==-1?"top":oe.indexOf("bottom")!==-1?"bottom":"middle",Q=oe.indexOf("left")!==-1?"end":oe.indexOf("right")!==-1?"start":"middle",W=ie?ie/.8+1:0,Z=(f.lineCount(X)-1)*g+1,ee=k[Q]*W,te=se*.75+k[q]*W+(k[q]-1)*Z*se/2;X.attr("text-anchor",Q),N||U.attr("transform",t(ee,te))}function z(X,oe){var se=X.ts||oe.textfont.size;return T(se)&&se>0?se:0}u.textPointStyle=function(X,oe,se){if(!!X.size()){var ie;if(oe.selectedpoints){var N=u.makeSelectedTextStyleFns(oe);ie=N.selectedTextColorFn}var U=oe.texttemplate,q=se._fullLayout;X.each(function(Q){var W=w.select(this),Z=U?c.extractOption(Q,oe,"txt","texttemplate"):c.extractOption(Q,oe,"tx","text");if(!Z&&Z!==0){W.remove();return}if(U){var ee=oe._module.formatLabels,te=ee?ee(Q,oe,q):{},ae={};m(ae,oe,Q.i);var le=oe._meta||{};Z=c.texttemplateString(Z,te,q._d3locale,ae,Q,le)}var ye=Q.tp||oe.textposition,fe=z(Q,oe),pe=ie?ie(Q):Q.tc||oe.textfont.color;W.call(u.font,Q.tf||oe.textfont.family,fe,pe).text(Z).call(f.convertToTspans,se).call(P,ye,fe,Q.mrc)})}},u.selectedTextStyle=function(X,oe){if(!(!X.size()||!oe.selectedpoints)){var se=u.makeSelectedTextStyleFns(oe);X.each(function(ie){var N=w.select(this),U=se.selectedTextColorFn(ie),q=ie.tp||oe.textposition,Q=z(ie,oe);n.fill(N,U);var W=a.traceIs(oe,"bar-like");P(N,q,Q,ie.mrc2||ie.mrc,W)})}};var I=.5;u.smoothopen=function(X,oe){if(X.length<3)return"M"+X.join("L");var se="M"+X[0],ie=[],N;for(N=1;N<X.length-1;N++)ie.push(D(X[N-1],X[N],X[N+1],oe));for(se+="Q"+ie[0][0]+" "+X[1],N=2;N<X.length-1;N++)se+="C"+ie[N-2][1]+" "+ie[N-1][0]+" "+X[N];return se+="Q"+ie[X.length-3][1]+" "+X[X.length-1],se},u.smoothclosed=function(X,oe){if(X.length<3)return"M"+X.join("L")+"Z";var se="M"+X[0],ie=X.length-1,N=[D(X[ie],X[0],X[1],oe)],U;for(U=1;U<ie;U++)N.push(D(X[U-1],X[U],X[U+1],oe));for(N.push(D(X[ie-1],X[ie],X[0],oe)),U=1;U<=ie;U++)se+="C"+N[U-1][1]+" "+N[U][0]+" "+X[U];return se+="C"+N[ie][1]+" "+N[0][0]+" "+X[0]+"Z",se};function D(X,oe,se,ie){var N=X[0]-oe[0],U=X[1]-oe[1],q=se[0]-oe[0],Q=se[1]-oe[1],W=Math.pow(N*N+U*U,I/2),Z=Math.pow(q*q+Q*Q,I/2),ee=(Z*Z*N-W*W*q)*ie,te=(Z*Z*U-W*W*Q)*ie,ae=3*Z*(W+Z),le=3*W*(W+Z);return[[w.round(oe[0]+(ae&&ee/ae),2),w.round(oe[1]+(ae&&te/ae),2)],[w.round(oe[0]-(le&&ee/le),2),w.round(oe[1]-(le&&te/le),2)]]}var R={hv:function(X,oe){return"H"+w.round(oe[0],2)+"V"+w.round(oe[1],2)},vh:function(X,oe){return"V"+w.round(oe[1],2)+"H"+w.round(oe[0],2)},hvh:function(X,oe){return"H"+w.round((X[0]+oe[0])/2,2)+"V"+w.round(oe[1],2)+"H"+w.round(oe[0],2)},vhv:function(X,oe){return"V"+w.round((X[1]+oe[1])/2,2)+"H"+w.round(oe[0],2)+"V"+w.round(oe[1],2)}},B=function(X,oe){return"L"+w.round(oe[0],2)+","+w.round(oe[1],2)};u.steps=function(X){var oe=R[X]||B;return function(se){for(var ie="M"+w.round(se[0][0],2)+","+w.round(se[0][1],2),N=1;N<se.length;N++)ie+=oe(se[N-1],se[N]);return ie}},u.makeTester=function(){var X=c.ensureSingleById(w.select("body"),"svg","js-plotly-tester",function(se){se.attr(o.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),oe=c.ensureSingle(X,"path","js-reference-point",function(se){se.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});u.tester=X,u.testref=oe},u.savedBBoxes={};var F=0,V=1e4;u.bBox=function(X,oe,se){se||(se=G(X));var ie;if(se){if(ie=u.savedBBoxes[se],ie)return c.extendFlat({},ie)}else if(X.childNodes.length===1){var N=X.childNodes[0];if(se=G(N),se){var U=+N.getAttribute("x")||0,q=+N.getAttribute("y")||0,Q=N.getAttribute("transform");if(!Q){var W=u.bBox(N,!1,se);return U&&(W.left+=U,W.right+=U),q&&(W.top+=q,W.bottom+=q),W}if(se+="~"+U+"~"+q+"~"+Q,ie=u.savedBBoxes[se],ie)return c.extendFlat({},ie)}}var Z,ee;oe?Z=X:(ee=u.tester.node(),Z=X.cloneNode(!0),ee.appendChild(Z)),w.select(Z).attr("transform",null).call(f.positionText,0,0);var te=Z.getBoundingClientRect(),ae=u.testref.node().getBoundingClientRect();oe||ee.removeChild(Z);var le={height:te.height,width:te.width,left:te.left-ae.left,top:te.top-ae.top,right:te.right-ae.left,bottom:te.bottom-ae.top};return F>=V&&(u.savedBBoxes={},F=0),se&&(u.savedBBoxes[se]=le),F++,c.extendFlat({},le)};function G(X){var oe=X.getAttribute("data-unformatted");if(oe!==null)return oe+X.getAttribute("data-math")+X.getAttribute("text-anchor")+X.getAttribute("style")}u.setClipUrl=function(X,oe,se){X.attr("clip-path",J(oe,se))};function J(X,oe){if(!X)return null;var se=oe._context,ie=se._exportedPlot?"":se._baseUrl||"";return ie?"url('"+ie+"#"+X+"')":"url(#"+X+")"}u.getTranslate=function(X){var oe=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,se=X.attr?"attr":"getAttribute",ie=X[se]("transform")||"",N=ie.replace(oe,function(U,q,Q){return[q,Q].join(" ")}).split(" ");return{x:+N[0]||0,y:+N[1]||0}},u.setTranslate=function(X,oe,se){var ie=/(\btranslate\(.*?\);?)/,N=X.attr?"attr":"getAttribute",U=X.attr?"attr":"setAttribute",q=X[N]("transform")||"";return oe=oe||0,se=se||0,q=q.replace(ie,"").trim(),q+=t(oe,se),q=q.trim(),X[U]("transform",q),q},u.getScale=function(X){var oe=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,se=X.attr?"attr":"getAttribute",ie=X[se]("transform")||"",N=ie.replace(oe,function(U,q,Q){return[q,Q].join(" ")}).split(" ");return{x:+N[0]||1,y:+N[1]||1}},u.setScale=function(X,oe,se){var ie=/(\bscale\(.*?\);?)/,N=X.attr?"attr":"getAttribute",U=X.attr?"attr":"setAttribute",q=X[N]("transform")||"";return oe=oe||1,se=se||1,q=q.replace(ie,"").trim(),q+="scale("+oe+","+se+")",q=q.trim(),X[U]("transform",q),q};var j=/\s*sc.*/;u.setPointGroupScale=function(X,oe,se){if(oe=oe||1,se=se||1,!!X){var ie=oe===1&&se===1?"":"scale("+oe+","+se+")";X.each(function(){var N=(this.getAttribute("transform")||"").replace(j,"");N+=ie,N=N.trim(),this.setAttribute("transform",N)})}};var Y=/translate\([^)]*\)\s*$/;u.setTextPointsScale=function(X,oe,se){!X||X.each(function(){var ie,N=w.select(this),U=N.select("text");if(!!U.node()){var q=parseFloat(U.attr("x")||0),Q=parseFloat(U.attr("y")||0),W=(N.attr("transform")||"").match(Y);oe===1&&se===1?ie=[]:ie=[t(q,Q),"scale("+oe+","+se+")",t(-q,-Q)],W&&ie.push(W),N.attr("transform",ie.join(""))}})}},{"../../components/fx/helpers":402,"../../constants/alignment":471,"../../constants/interactions":478,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../lib/svg_text_utils":529,"../../registry":638,"../../traces/scatter/make_bubble_size_func":944,"../../traces/scatter/subtypes":952,"../color":366,"../colorscale":378,"./symbol_defs":389,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:312}],389:[function(d,re,ne){var w=d("@plotly/d3");re.exports={circle:{n:0,f:function(c){var M=w.round(c,2);return"M"+M+",0A"+M+","+M+" 0 1,1 0,-"+M+"A"+M+","+M+" 0 0,1 "+M+",0Z"}},square:{n:1,f:function(c){var M=w.round(c,2);return"M"+M+","+M+"H-"+M+"V-"+M+"H"+M+"Z"}},diamond:{n:2,f:function(c){var M=w.round(c*1.3,2);return"M"+M+",0L0,"+M+"L-"+M+",0L0,-"+M+"Z"}},cross:{n:3,f:function(c){var M=w.round(c*.4,2),T=w.round(c*1.2,2);return"M"+T+","+M+"H"+M+"V"+T+"H-"+M+"V"+M+"H-"+T+"V-"+M+"H-"+M+"V-"+T+"H"+M+"V-"+M+"H"+T+"Z"}},x:{n:4,f:function(c){var M=w.round(c*.8/Math.sqrt(2),2),T="l"+M+","+M,e="l"+M+",-"+M,a="l-"+M+",-"+M,n="l-"+M+","+M;return"M0,"+M+T+e+a+e+a+n+a+n+T+n+T+"Z"}},"triangle-up":{n:5,f:function(c){var M=w.round(c*2/Math.sqrt(3),2),T=w.round(c/2,2),e=w.round(c,2);return"M-"+M+","+T+"H"+M+"L0,-"+e+"Z"}},"triangle-down":{n:6,f:function(c){var M=w.round(c*2/Math.sqrt(3),2),T=w.round(c/2,2),e=w.round(c,2);return"M-"+M+",-"+T+"H"+M+"L0,"+e+"Z"}},"triangle-left":{n:7,f:function(c){var M=w.round(c*2/Math.sqrt(3),2),T=w.round(c/2,2),e=w.round(c,2);return"M"+T+",-"+M+"V"+M+"L-"+e+",0Z"}},"triangle-right":{n:8,f:function(c){var M=w.round(c*2/Math.sqrt(3),2),T=w.round(c/2,2),e=w.round(c,2);return"M-"+T+",-"+M+"V"+M+"L"+e+",0Z"}},"triangle-ne":{n:9,f:function(c){var M=w.round(c*.6,2),T=w.round(c*1.2,2);return"M-"+T+",-"+M+"H"+M+"V"+T+"Z"}},"triangle-se":{n:10,f:function(c){var M=w.round(c*.6,2),T=w.round(c*1.2,2);return"M"+M+",-"+T+"V"+M+"H-"+T+"Z"}},"triangle-sw":{n:11,f:function(c){var M=w.round(c*.6,2),T=w.round(c*1.2,2);return"M"+T+","+M+"H-"+M+"V-"+T+"Z"}},"triangle-nw":{n:12,f:function(c){var M=w.round(c*.6,2),T=w.round(c*1.2,2);return"M-"+M+","+T+"V-"+M+"H"+T+"Z"}},pentagon:{n:13,f:function(c){var M=w.round(c*.951,2),T=w.round(c*.588,2),e=w.round(-c,2),a=w.round(c*-.309,2),n=w.round(c*.809,2);return"M"+M+","+a+"L"+T+","+n+"H-"+T+"L-"+M+","+a+"L0,"+e+"Z"}},hexagon:{n:14,f:function(c){var M=w.round(c,2),T=w.round(c/2,2),e=w.round(c*Math.sqrt(3)/2,2);return"M"+e+",-"+T+"V"+T+"L0,"+M+"L-"+e+","+T+"V-"+T+"L0,-"+M+"Z"}},hexagon2:{n:15,f:function(c){var M=w.round(c,2),T=w.round(c/2,2),e=w.round(c*Math.sqrt(3)/2,2);return"M-"+T+","+e+"H"+T+"L"+M+",0L"+T+",-"+e+"H-"+T+"L-"+M+",0Z"}},octagon:{n:16,f:function(c){var M=w.round(c*.924,2),T=w.round(c*.383,2);return"M-"+T+",-"+M+"H"+T+"L"+M+",-"+T+"V"+T+"L"+T+","+M+"H-"+T+"L-"+M+","+T+"V-"+T+"Z"}},star:{n:17,f:function(c){var M=c*1.4,T=w.round(M*.225,2),e=w.round(M*.951,2),a=w.round(M*.363,2),n=w.round(M*.588,2),r=w.round(-M,2),t=w.round(M*-.309,2),f=w.round(M*.118,2),o=w.round(M*.809,2),i=w.round(M*.382,2);return"M"+T+","+t+"H"+e+"L"+a+","+f+"L"+n+","+o+"L0,"+i+"L-"+n+","+o+"L-"+a+","+f+"L-"+e+","+t+"H-"+T+"L0,"+r+"Z"}},hexagram:{n:18,f:function(c){var M=w.round(c*.66,2),T=w.round(c*.38,2),e=w.round(c*.76,2);return"M-"+e+",0l-"+T+",-"+M+"h"+e+"l"+T+",-"+M+"l"+T+","+M+"h"+e+"l-"+T+","+M+"l"+T+","+M+"h-"+e+"l-"+T+","+M+"l-"+T+",-"+M+"h-"+e+"Z"}},"star-triangle-up":{n:19,f:function(c){var M=w.round(c*Math.sqrt(3)*.8,2),T=w.round(c*.8,2),e=w.round(c*1.6,2),a=w.round(c*4,2),n="A "+a+","+a+" 0 0 1 ";return"M-"+M+","+T+n+M+","+T+n+"0,-"+e+n+"-"+M+","+T+"Z"}},"star-triangle-down":{n:20,f:function(c){var M=w.round(c*Math.sqrt(3)*.8,2),T=w.round(c*.8,2),e=w.round(c*1.6,2),a=w.round(c*4,2),n="A "+a+","+a+" 0 0 1 ";return"M"+M+",-"+T+n+"-"+M+",-"+T+n+"0,"+e+n+M+",-"+T+"Z"}},"star-square":{n:21,f:function(c){var M=w.round(c*1.1,2),T=w.round(c*2,2),e="A "+T+","+T+" 0 0 1 ";return"M-"+M+",-"+M+e+"-"+M+","+M+e+M+","+M+e+M+",-"+M+e+"-"+M+",-"+M+"Z"}},"star-diamond":{n:22,f:function(c){var M=w.round(c*1.4,2),T=w.round(c*1.9,2),e="A "+T+","+T+" 0 0 1 ";return"M-"+M+",0"+e+"0,"+M+e+M+",0"+e+"0,-"+M+e+"-"+M+",0Z"}},"diamond-tall":{n:23,f:function(c){var M=w.round(c*.7,2),T=w.round(c*1.4,2);return"M0,"+T+"L"+M+",0L0,-"+T+"L-"+M+",0Z"}},"diamond-wide":{n:24,f:function(c){var M=w.round(c*1.4,2),T=w.round(c*.7,2);return"M0,"+T+"L"+M+",0L0,-"+T+"L-"+M+",0Z"}},hourglass:{n:25,f:function(c){var M=w.round(c,2);return"M"+M+","+M+"H-"+M+"L"+M+",-"+M+"H-"+M+"Z"},noDot:!0},bowtie:{n:26,f:function(c){var M=w.round(c,2);return"M"+M+","+M+"V-"+M+"L-"+M+","+M+"V-"+M+"Z"},noDot:!0},"circle-cross":{n:27,f:function(c){var M=w.round(c,2);return"M0,"+M+"V-"+M+"M"+M+",0H-"+M+"M"+M+",0A"+M+","+M+" 0 1,1 0,-"+M+"A"+M+","+M+" 0 0,1 "+M+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(c){var M=w.round(c,2),T=w.round(c/Math.sqrt(2),2);return"M"+T+","+T+"L-"+T+",-"+T+"M"+T+",-"+T+"L-"+T+","+T+"M"+M+",0A"+M+","+M+" 0 1,1 0,-"+M+"A"+M+","+M+" 0 0,1 "+M+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(c){var M=w.round(c,2);return"M0,"+M+"V-"+M+"M"+M+",0H-"+M+"M"+M+","+M+"H-"+M+"V-"+M+"H"+M+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(c){var M=w.round(c,2);return"M"+M+","+M+"L-"+M+",-"+M+"M"+M+",-"+M+"L-"+M+","+M+"M"+M+","+M+"H-"+M+"V-"+M+"H"+M+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(c){var M=w.round(c*1.3,2);return"M"+M+",0L0,"+M+"L-"+M+",0L0,-"+M+"ZM0,-"+M+"V"+M+"M-"+M+",0H"+M},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(c){var M=w.round(c*1.3,2),T=w.round(c*.65,2);return"M"+M+",0L0,"+M+"L-"+M+",0L0,-"+M+"ZM-"+T+",-"+T+"L"+T+","+T+"M-"+T+","+T+"L"+T+",-"+T},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(c){var M=w.round(c*1.4,2);return"M0,"+M+"V-"+M+"M"+M+",0H-"+M},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(c){var M=w.round(c,2);return"M"+M+","+M+"L-"+M+",-"+M+"M"+M+",-"+M+"L-"+M+","+M},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(c){var M=w.round(c*1.2,2),T=w.round(c*.85,2);return"M0,"+M+"V-"+M+"M"+M+",0H-"+M+"M"+T+","+T+"L-"+T+",-"+T+"M"+T+",-"+T+"L-"+T+","+T},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(c){var M=w.round(c/2,2),T=w.round(c,2);return"M"+M+","+T+"V-"+T+"m-"+T+",0V"+T+"M"+T+","+M+"H-"+T+"m0,-"+T+"H"+T},needLine:!0,noFill:!0},"y-up":{n:37,f:function(c){var M=w.round(c*1.2,2),T=w.round(c*1.6,2),e=w.round(c*.8,2);return"M-"+M+","+e+"L0,0M"+M+","+e+"L0,0M0,-"+T+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(c){var M=w.round(c*1.2,2),T=w.round(c*1.6,2),e=w.round(c*.8,2);return"M-"+M+",-"+e+"L0,0M"+M+",-"+e+"L0,0M0,"+T+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(c){var M=w.round(c*1.2,2),T=w.round(c*1.6,2),e=w.round(c*.8,2);return"M"+e+","+M+"L0,0M"+e+",-"+M+"L0,0M-"+T+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(c){var M=w.round(c*1.2,2),T=w.round(c*1.6,2),e=w.round(c*.8,2);return"M-"+e+","+M+"L0,0M-"+e+",-"+M+"L0,0M"+T+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(c){var M=w.round(c*1.4,2);return"M"+M+",0H-"+M},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(c){var M=w.round(c*1.4,2);return"M0,"+M+"V-"+M},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(c){var M=w.round(c,2);return"M"+M+",-"+M+"L-"+M+","+M},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(c){var M=w.round(c,2);return"M"+M+","+M+"L-"+M+",-"+M},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(c){var M=w.round(c,2),T=w.round(c*2,2);return"M0,0L-"+M+","+T+"H"+M+"Z"},noDot:!0},"arrow-down":{n:46,f:function(c){var M=w.round(c,2),T=w.round(c*2,2);return"M0,0L-"+M+",-"+T+"H"+M+"Z"},noDot:!0},"arrow-left":{n:47,f:function(c){var M=w.round(c*2,2),T=w.round(c,2);return"M0,0L"+M+",-"+T+"V"+T+"Z"},noDot:!0},"arrow-right":{n:48,f:function(c){var M=w.round(c*2,2),T=w.round(c,2);return"M0,0L-"+M+",-"+T+"V"+T+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(c){var M=w.round(c,2),T=w.round(c*2,2);return"M-"+M+",0H"+M+"M0,0L-"+M+","+T+"H"+M+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(c){var M=w.round(c,2),T=w.round(c*2,2);return"M-"+M+",0H"+M+"M0,0L-"+M+",-"+T+"H"+M+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(c){var M=w.round(c*2,2),T=w.round(c,2);return"M0,-"+T+"V"+T+"M0,0L"+M+",-"+T+"V"+T+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(c){var M=w.round(c*2,2),T=w.round(c,2);return"M0,-"+T+"V"+T+"M0,0L-"+M+",-"+T+"V"+T+"Z"},needLine:!0,noDot:!0}}},{"@plotly/d3":58}],390:[function(d,re,ne){re.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],391:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../registry"),M=d("../../plots/cartesian/axes"),T=d("../../lib"),e=d("./compute_error");re.exports=function(r){for(var t=r.calcdata,f=0;f<t.length;f++){var o=t[f],i=o[0].trace;if(i.visible===!0&&c.traceIs(i,"errorBarsOK")){var g=M.getFromId(r,i.xaxis),p=M.getFromId(r,i.yaxis);a(o,i,g,"x"),a(o,i,p,"y")}}};function a(n,r,t,f){var o=r["error_"+f]||{},i=o.visible&&["linear","log"].indexOf(t.type)!==-1,g=[];if(!!i){for(var p=e(o),y=0;y<n.length;y++){var h=n[y],m=h.i;if(m===void 0)m=y;else if(m===null)continue;var u=h[f];if(!!w(t.c2l(u))){var _=p(u,m);if(w(_[0])&&w(_[1])){var s=h[f+"s"]=u-_[0],A=h[f+"h"]=u+_[1];g.push(s,A)}}}var x=t._id,v=r._extremes[x],b=M.findExtremes(t,g,T.extendFlat({tozero:v.opts.tozero},{padded:!0}));v.min=v.min.concat(b.min),v.max=v.max.concat(b.max)}}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"./compute_error":392,"fast-isnumeric":190}],392:[function(d,re,ne){re.exports=function(M){var T=M.type,e=M.symmetric;if(T==="data"){var a=M.array||[];if(e)return function(o,i){var g=+a[i];return[g,g]};var n=M.arrayminus||[];return function(o,i){var g=+a[i],p=+n[i];return!isNaN(g)||!isNaN(p)?[p||0,g||0]:[NaN,NaN]}}else{var r=w(T,M.value),t=w(T,M.valueminus);return e||M.valueminus===void 0?function(o){var i=r(o);return[i,i]}:function(o){return[t(o),r(o)]}}};function w(c,M){if(c==="percent")return function(T){return Math.abs(T*M/100)};if(c==="constant")return function(){return Math.abs(M)};if(c==="sqrt")return function(T){return Math.sqrt(Math.abs(T))}}},{}],393:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../registry"),M=d("../../lib"),T=d("../../plot_api/plot_template"),e=d("./attributes");re.exports=function(a,n,r,t){var f="error_"+t.axis,o=T.newContainer(n,f),i=a[f]||{};function g(s,A){return M.coerce(i,o,e,s,A)}var p=i.array!==void 0||i.value!==void 0||i.type==="sqrt",y=g("visible",p);if(y!==!1){var h=g("type","array"in i?"data":"percent"),m=!0;h!=="sqrt"&&(m=g("symmetric",!((h==="data"?"arrayminus":"valueminus")in i))),h==="data"?(g("array"),g("traceref"),m||(g("arrayminus"),g("tracerefminus"))):(h==="percent"||h==="constant")&&(g("value"),m||g("valueminus"));var u="copy_"+t.inherit+"style";if(t.inherit){var _=n["error_"+t.inherit];(_||{}).visible&&g(u,!(i.color||w(i.thickness)||w(i.width)))}(!t.inherit||!o[u])&&(g("color",r),g("thickness"),g("width",c.traceIs(n,"gl3d")?0:4))}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../registry":638,"./attributes":390,"fast-isnumeric":190}],394:[function(d,re,ne){var w=d("../../lib"),c=d("../../plot_api/edit_types").overrideAll,M=d("./attributes"),T={error_x:w.extendFlat({},M),error_y:w.extendFlat({},M)};delete T.error_x.copy_zstyle,delete T.error_y.copy_zstyle,delete T.error_y.copy_ystyle;var e={error_x:w.extendFlat({},M),error_y:w.extendFlat({},M),error_z:w.extendFlat({},M)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,re.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:T,bar:T,histogram:T,scatter3d:c(e,"calc","nested"),scattergl:c(T,"calc","nested")}},supplyDefaults:d("./defaults"),calc:d("./calc"),makeComputeError:d("./compute_error"),plot:d("./plot"),style:d("./style"),hoverInfo:a};function a(n,r,t){(r.error_y||{}).visible&&(t.yerr=n.yh-n.y,r.error_y.symmetric||(t.yerrneg=n.y-n.ys)),(r.error_x||{}).visible&&(t.xerr=n.xh-n.x,r.error_x.symmetric||(t.xerrneg=n.x-n.xs))}},{"../../lib":503,"../../plot_api/edit_types":536,"./attributes":390,"./calc":391,"./compute_error":392,"./defaults":393,"./plot":395,"./style":396}],395:[function(d,re,ne){var w=d("@plotly/d3"),c=d("fast-isnumeric"),M=d("../drawing"),T=d("../../traces/scatter/subtypes");re.exports=function(n,r,t,f){var o,i=t.xaxis,g=t.yaxis,p=f&&f.duration>0;r.each(function(y){var h=y[0].trace,m=h.error_x||{},u=h.error_y||{},_;h.ids&&(_=function(v){return v.id});var s=T.hasMarkers(h)&&h.marker.maxdisplayed>0;!u.visible&&!m.visible&&(y=[]);var A=w.select(this).selectAll("g.errorbar").data(y,_);if(A.exit().remove(),!!y.length){m.visible||A.selectAll("path.xerror").remove(),u.visible||A.selectAll("path.yerror").remove(),A.style("opacity",1);var x=A.enter().append("g").classed("errorbar",!0);p&&x.style("opacity",0).transition().duration(f.duration).style("opacity",1),M.setClipUrl(A,t.layerClipId,n),A.each(function(v){var b=w.select(this),l=e(v,i,g);if(!(s&&!v.vis)){var L,S=b.select("path.yerror");if(u.visible&&c(l.x)&&c(l.yh)&&c(l.ys)){var k=u.width;L="M"+(l.x-k)+","+l.yh+"h"+2*k+"m-"+k+",0V"+l.ys,l.noYS||(L+="m-"+k+",0h"+2*k),o=!S.size(),o?S=b.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0):p&&(S=S.transition().duration(f.duration).ease(f.easing)),S.attr("d",L)}else S.remove();var P=b.select("path.xerror");if(m.visible&&c(l.y)&&c(l.xh)&&c(l.xs)){var z=(m.copy_ystyle?u:m).width;L="M"+l.xh+","+(l.y-z)+"v"+2*z+"m0,-"+z+"H"+l.xs,l.noXS||(L+="m0,-"+z+"v"+2*z),o=!P.size(),o?P=b.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0):p&&(P=P.transition().duration(f.duration).ease(f.easing)),P.attr("d",L)}else P.remove()}})}})};function e(a,n,r){var t={x:n.c2p(a.x),y:r.c2p(a.y)};return a.yh!==void 0&&(t.yh=r.c2p(a.yh),t.ys=r.c2p(a.ys),c(t.ys)||(t.noYS=!0,t.ys=r.c2p(a.ys,!0))),a.xh!==void 0&&(t.xh=n.c2p(a.xh),t.xs=n.c2p(a.xs),c(t.xs)||(t.noXS=!0,t.xs=n.c2p(a.xs,!0))),t}},{"../../traces/scatter/subtypes":952,"../drawing":388,"@plotly/d3":58,"fast-isnumeric":190}],396:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../color");re.exports=function(T){T.each(function(e){var a=e[0].trace,n=a.error_y||{},r=a.error_x||{},t=w.select(this);t.selectAll("path.yerror").style("stroke-width",n.thickness+"px").call(c.stroke,n.color),r.copy_ystyle&&(r=n),t.selectAll("path.xerror").style("stroke-width",r.thickness+"px").call(c.stroke,r.color)})}},{"../color":366,"@plotly/d3":58}],397:[function(d,re,ne){var w=d("../../plots/font_attributes"),c=d("./layout_attributes").hoverlabel,M=d("../../lib/extend").extendFlat;re.exports={hoverlabel:{bgcolor:M({},c.bgcolor,{arrayOk:!0}),bordercolor:M({},c.bordercolor,{arrayOk:!0}),font:w({arrayOk:!0,editType:"none"}),align:M({},c.align,{arrayOk:!0}),namelength:M({},c.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":493,"../../plots/font_attributes":585,"./layout_attributes":407}],398:[function(d,re,ne){var w=d("../../lib"),c=d("../../registry");re.exports=function(e){var a=e.calcdata,n=e._fullLayout;function r(g){return function(p){return w.coerceHoverinfo({hoverinfo:p},{_module:g._module},n)}}for(var t=0;t<a.length;t++){var f=a[t],o=f[0].trace;if(!c.traceIs(o,"pie-like")){var i=c.traceIs(o,"2dMap")?M:w.fillArray;i(o.hoverinfo,f,"hi",r(o)),o.hovertemplate&&i(o.hovertemplate,f,"ht"),o.hoverlabel&&(i(o.hoverlabel.bgcolor,f,"hbg"),i(o.hoverlabel.bordercolor,f,"hbc"),i(o.hoverlabel.font.size,f,"hts"),i(o.hoverlabel.font.color,f,"htc"),i(o.hoverlabel.font.family,f,"htf"),i(o.hoverlabel.namelength,f,"hnl"),i(o.hoverlabel.align,f,"hta"))}}};function M(T,e,a,n){n=n||w.identity,Array.isArray(T)&&(e[0][a]=n(T))}},{"../../lib":503,"../../registry":638}],399:[function(d,re,ne){var w=d("../../registry"),c=d("./hover").hover;re.exports=function(T,e,a){var n=w.getComponentMethod("annotations","onClick")(T,T._hoverdata);a!==void 0&&c(T,e,a,!0);function r(){T.emit("plotly_click",{points:T._hoverdata,event:e})}T._hoverdata&&e&&e.target&&(n&&n.then?n.then(r):r(),e.stopImmediatePropagation&&e.stopImmediatePropagation())}},{"../../registry":638,"./hover":403}],400:[function(d,re,ne){re.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],401:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes"),M=d("./hoverlabel_defaults");re.exports=function(e,a,n,r){function t(o,i){return w.coerce(e,a,c,o,i)}var f=w.extendFlat({},r.hoverlabel);a.hovertemplate&&(f.namelength=-1),M(e,a,t,f)}},{"../../lib":503,"./attributes":397,"./hoverlabel_defaults":404}],402:[function(d,re,ne){var w=d("../../lib");ne.getSubplot=function(n){return n.subplot||n.xaxis+n.yaxis||n.geo},ne.isTraceInSubplots=function(n,r){if(n.type==="splom"){for(var t=n.xaxes||[],f=n.yaxes||[],o=0;o<t.length;o++)for(var i=0;i<f.length;i++)if(r.indexOf(t[o]+f[i])!==-1)return!0;return!1}return r.indexOf(ne.getSubplot(n))!==-1},ne.flat=function(n,r){for(var t=new Array(n.length),f=0;f<n.length;f++)t[f]=r;return t},ne.p2c=function(n,r){for(var t=new Array(n.length),f=0;f<n.length;f++)t[f]=n[f].p2c(r);return t},ne.getDistanceFunction=function(n,r,t,f){return n==="closest"?f||ne.quadrature(r,t):n.charAt(0)==="x"?r:t},ne.getClosest=function(n,r,t){if(t.index!==!1)t.index>=0&&t.index<n.length?t.distance=0:t.index=!1;else for(var f=0;f<n.length;f++){var o=r(n[f]);o<=t.distance&&(t.index=f,t.distance=o)}return t},ne.inbox=function(n,r,t){return n*r<0||n===0?t:1/0},ne.quadrature=function(n,r){return function(t){var f=n(t),o=r(t);return Math.sqrt(f*f+o*o)}},ne.makeEventData=function(n,r,t){var f="index"in n?n.index:n.pointNumber,o={data:r._input,fullData:r,curveNumber:r.index,pointNumber:f};if(r._indexToPoints){var i=r._indexToPoints[f];i.length===1?o.pointIndex=i[0]:o.pointIndices=i}else o.pointIndex=f;return r._module.eventData?o=r._module.eventData(o,n,r,t,f):("xVal"in n?o.x=n.xVal:"x"in n&&(o.x=n.x),"yVal"in n?o.y=n.yVal:"y"in n&&(o.y=n.y),n.xa&&(o.xaxis=n.xa),n.ya&&(o.yaxis=n.ya),n.zLabelVal!==void 0&&(o.z=n.zLabelVal)),ne.appendArrayPointValue(o,r,f),o},ne.appendArrayPointValue=function(n,r,t){var f=r._arrayAttrs;if(!!f)for(var o=0;o<f.length;o++){var i=f[o],g=M(i);if(n[g]===void 0){var p=w.nestedProperty(r,i).get(),y=T(p,t);y!==void 0&&(n[g]=y)}}},ne.appendArrayMultiPointValues=function(n,r,t){var f=r._arrayAttrs;if(!!f)for(var o=0;o<f.length;o++){var i=f[o],g=M(i);if(n[g]===void 0){for(var p=w.nestedProperty(r,i).get(),y=new Array(t.length),h=0;h<t.length;h++)y[h]=T(p,t[h]);n[g]=y}}};var c={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function M(n){return c[n]||n}function T(n,r){if(Array.isArray(r)){if(Array.isArray(n)&&Array.isArray(n[r[0]]))return n[r[0]][r[1]]}else return n[r]}var e={x:!0,y:!0},a={"x unified":!0,"y unified":!0};ne.isUnifiedHover=function(n){return typeof n!="string"?!1:!!a[n]},ne.isXYhover=function(n){return typeof n!="string"?!1:!!e[n]}},{"../../lib":503}],403:[function(d,re,ne){var w=d("@plotly/d3"),c=d("fast-isnumeric"),M=d("tinycolor2"),T=d("../../lib"),e=T.strTranslate,a=T.strRotate,n=d("../../lib/events"),r=d("../../lib/svg_text_utils"),t=d("../../lib/override_cursor"),f=d("../drawing"),o=d("../color"),i=d("../dragelement"),g=d("../../plots/cartesian/axes"),p=d("../../registry"),y=d("./helpers"),h=d("./constants"),m=d("../legend/defaults"),u=d("../legend/draw"),_=h.YANGLE,s=Math.PI*_/180,A=1/Math.sin(s),x=Math.cos(s),v=Math.sin(s),b=h.HOVERARROWSIZE,l=h.HOVERTEXTPAD,L={box:!0,ohlc:!0,violin:!0,candlestick:!0},S={scatter:!0,scattergl:!0,splom:!0};ne.hover=function(U,q,Q,W){U=T.getGraphDiv(U);var Z=q.target;T.throttle(U._fullLayout._uid+h.HOVERID,h.HOVERMINTIME,function(){k(U,q,Q,W,Z)})},ne.loneHover=function(U,q){var Q=!0;Array.isArray(U)||(Q=!1,U=[U]);var W=q.gd,Z=oe(W),ee=se(W),te=U.map(function(we){var De=we._x0||we.x0||we.x||0,Be=we._x1||we.x1||we.x||0,Ve=we._y0||we.y0||we.y||0,xe=we._y1||we.y1||we.y||0,Le=we.eventData;if(Le){var He=Math.min(De,Be),Je=Math.max(De,Be),Oe=Math.min(Ve,xe),Pe=Math.max(Ve,xe),Ue=we.trace;if(p.traceIs(Ue,"gl3d")){var vt=W._fullLayout[Ue.scene]._scene.container,Lt=vt.offsetLeft,Yt=vt.offsetTop;He+=Lt,Je+=Lt,Oe+=Yt,Pe+=Yt}Le.bbox={x0:He+ee,x1:Je+ee,y0:Oe+Z,y1:Pe+Z},q.inOut_bbox&&q.inOut_bbox.push(Le.bbox)}else Le=!1;return{color:we.color||o.defaultLine,x0:we.x0||we.x||0,x1:we.x1||we.x||0,y0:we.y0||we.y||0,y1:we.y1||we.y||0,xLabel:we.xLabel,yLabel:we.yLabel,zLabel:we.zLabel,text:we.text,name:we.name,idealAlign:we.idealAlign,borderColor:we.borderColor,fontFamily:we.fontFamily,fontSize:we.fontSize,fontColor:we.fontColor,nameLength:we.nameLength,textAlign:we.textAlign,trace:we.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:we.hovertemplate||!1,hovertemplateLabels:we.hovertemplateLabels||!1,eventData:Le}}),ae=!1,le=I(te,{gd:W,hovermode:"closest",rotateLabels:ae,bgColor:q.bgColor||o.background,container:w.select(q.container),outerContainer:q.outerContainer||q.container}),ye=5,fe=0,pe=0;le.sort(function(we,De){return we.y0-De.y0}).each(function(we,De){var Be=we.y0-we.by/2;Be-ye<fe?we.offset=fe-Be+ye:we.offset=0,fe=Be+we.by+we.offset,De===q.anchorIndex&&(pe=we.offset)}).each(function(we){we.offset-=pe});var ge=W._fullLayout._invScaleX,Ae=W._fullLayout._invScaleY;return B(le,ae,ge,Ae),Q?le:le.node()};function k(N,U,q,Q,W){q||(q="xy");var Z=Array.isArray(q)?q:[q],ee=N._fullLayout,te=ee._plots||[],ae=te[q],le=ee._has("cartesian");if(ae){var ye=ae.overlays.map(function(ur){return ur.id});Z=Z.concat(ye)}for(var fe=Z.length,pe=new Array(fe),ge=new Array(fe),Ae=!1,we=0;we<fe;we++){var De=Z[we];if(te[De])Ae=!0,pe[we]=te[De].xaxis,ge[we]=te[De].yaxis;else if(ee[De]&&ee[De]._subplot){var Be=ee[De]._subplot;pe[we]=Be.xaxis,ge[we]=Be.yaxis}else{T.warn("Unrecognized subplot: "+De);return}}var Ve=U.hovermode||ee.hovermode;if(Ve&&!Ae&&(Ve="closest"),["x","y","closest","x unified","y unified"].indexOf(Ve)===-1||!N.calcdata||N.querySelector(".zoombox")||N._dragging)return i.unhoverRaw(N,U);var xe=ee.hoverdistance;xe===-1&&(xe=1/0);var Le=ee.spikedistance;Le===-1&&(Le=1/0);var He=[],Je=[],Oe,Pe,Ue,vt,Lt,Yt,At,Rt,Bt,Mt,Tt,at,ct,je={hLinePoint:null,vLinePoint:null},ke=!1;if(Array.isArray(U))for(Ve="array",Ue=0;Ue<U.length;Ue++)Lt=N.calcdata[U[Ue].curveNumber||0],Lt&&(Yt=Lt[0].trace,Lt[0].trace.hoverinfo!=="skip"&&(Je.push(Lt),Yt.orientation==="h"&&(ke=!0)));else{for(vt=0;vt<N.calcdata.length;vt++)Lt=N.calcdata[vt],Yt=Lt[0].trace,Yt.hoverinfo!=="skip"&&y.isTraceInSubplots(Yt,Z)&&(Je.push(Lt),Yt.orientation==="h"&&(ke=!0));var Ye=!W,Ke,st;if(Ye)"xpx"in U?Ke=U.xpx:Ke=pe[0]._length/2,"ypx"in U?st=U.ypx:st=ge[0]._length/2;else{if(n.triggerHandler(N,"plotly_beforehover",U)===!1)return;var Et=W.getBoundingClientRect();Ke=U.clientX-Et.left,st=U.clientY-Et.top,ee._calcInverseTransform(N);var bt=T.apply3DTransform(ee._invTransform)(Ke,st);if(Ke=bt[0],st=bt[1],Ke<0||Ke>pe[0]._length||st<0||st>ge[0]._length)return i.unhoverRaw(N,U)}if(U.pointerX=Ke+pe[0]._offset,U.pointerY=st+ge[0]._offset,"xval"in U?Oe=y.flat(Z,U.xval):Oe=y.p2c(pe,Ke),"yval"in U?Pe=y.flat(Z,U.yval):Pe=y.p2c(ge,st),!c(Oe[0])||!c(Pe[0]))return T.warn("Fx.hover failed",U,N),i.unhoverRaw(N,U)}var zt=1/0;function $t(ur,Lr){for(vt=0;vt<Je.length;vt++)if(Lt=Je[vt],!(!Lt||!Lt[0]||!Lt[0].trace)&&(Yt=Lt[0].trace,!(Yt.visible!==!0||Yt._length===0)&&["carpet","contourcarpet"].indexOf(Yt._module.name)===-1)){if(Yt.type==="splom"?(Rt=0,At=Z[Rt]):(At=y.getSubplot(Yt),Rt=Z.indexOf(At)),Bt=Ve,y.isUnifiedHover(Bt)&&(Bt=Bt.charAt(0)),at={cd:Lt,trace:Yt,xa:pe[Rt],ya:ge[Rt],maxHoverDistance:xe,maxSpikeDistance:Le,index:!1,distance:Math.min(zt,xe),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:o.defaultLine,name:Yt.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},ee[At]&&(at.subplot=ee[At]._subplot),ee._splomScenes&&ee._splomScenes[Yt.uid]&&(at.scene=ee._splomScenes[Yt.uid]),ct=He.length,Bt==="array"){var Br=U[vt];"pointNumber"in Br?(at.index=Br.pointNumber,Bt="closest"):(Bt="","xval"in Br&&(Mt=Br.xval,Bt="x"),"yval"in Br&&(Tt=Br.yval,Bt=Bt?"closest":"y"))}else ur!==void 0&&Lr!==void 0?(Mt=ur,Tt=Lr):(Mt=Oe[Rt],Tt=Pe[Rt]);if(xe!==0)if(Yt._module&&Yt._module.hoverPoints){var Pr=Yt._module.hoverPoints(at,Mt,Tt,Bt,{finiteRange:!0,hoverLayer:ee._hoverlayer});if(Pr)for(var Tr,jr=0;jr<Pr.length;jr++)Tr=Pr[jr],c(Tr.x0)&&c(Tr.y0)&&He.push(F(Tr,Ve))}else T.log("Unrecognized trace type in hover:",Yt);if(Ve==="closest"&&He.length>ct&&(He.splice(0,ct),zt=He[0].distance),le&&Le!==0&&He.length===0){at.distance=Le,at.index=!1;var Pn=Yt._module.hoverPoints(at,Mt,Tt,"closest",{hoverLayer:ee._hoverlayer});if(Pn&&(Pn=Pn.filter(function(Aa){return Aa.spikeDistance<=Le})),Pn&&Pn.length){var An,$n=Pn.filter(function(Aa){return Aa.xa.showspikes&&Aa.xa.spikesnap!=="hovered data"});if($n.length){var zn=$n[0];c(zn.x0)&&c(zn.y0)&&(An=Qt(zn),(!je.vLinePoint||je.vLinePoint.spikeDistance>An.spikeDistance)&&(je.vLinePoint=An))}var Yn=Pn.filter(function(Aa){return Aa.ya.showspikes&&Aa.ya.spikesnap!=="hovered data"});if(Yn.length){var Kn=Yn[0];c(Kn.x0)&&c(Kn.y0)&&(An=Qt(Kn),(!je.hLinePoint||je.hLinePoint.spikeDistance>An.spikeDistance)&&(je.hLinePoint=An))}}}}}$t();function Ot(ur,Lr,Br){for(var Pr=null,Tr=1/0,jr,Pn=0;Pn<ur.length;Pn++)jr=ur[Pn].spikeDistance,Br&&Pn===0&&(jr=-1/0),jr<=Tr&&jr<=Lr&&(Pr=ur[Pn],Tr=jr);return Pr}function Qt(ur){return ur?{xa:ur.xa,ya:ur.ya,x:ur.xSpike!==void 0?ur.xSpike:(ur.x0+ur.x1)/2,y:ur.ySpike!==void 0?ur.ySpike:(ur.y0+ur.y1)/2,distance:ur.distance,spikeDistance:ur.spikeDistance,curveNumber:ur.trace.index,color:ur.color,pointNumber:ur.index}:null}var tr={fullLayout:ee,container:ee._hoverlayer,event:U},qt=N._spikepoints,lr={vLinePoint:je.vLinePoint,hLinePoint:je.hLinePoint};N._spikepoints=lr;var Wr=function(){He.sort(function(ur,Lr){return ur.distance-Lr.distance}),He=Y(He,Ve)};Wr();var cn=Ve.charAt(0),Jr=(cn==="x"||cn==="y")&&He[0]&&S[He[0].trace.type];if(le&&Le!==0&&He.length!==0){var ot=He.filter(function(ur){return ur.ya.showspikes}),Vt=Ot(ot,Le,Jr);je.hLinePoint=Qt(Vt);var jt=He.filter(function(ur){return ur.xa.showspikes}),Ut=Ot(jt,Le,Jr);je.vLinePoint=Qt(Ut)}if(He.length===0){var yr=i.unhoverRaw(N,U);return le&&(je.hLinePoint!==null||je.vLinePoint!==null)&&J(qt)&&V(N,je,tr),yr}if(le&&J(qt)&&V(N,je,tr),y.isXYhover(Bt)&&He[0].length!==0&&He[0].trace.type!=="splom"){var nt=He[0];L[nt.trace.type]?He=He.filter(function(ur){return ur.trace.index===nt.trace.index}):He=[nt];var _e=He.length,Me=X("x",nt,ee),Ne=X("y",nt,ee);$t(Me,Ne);var We=[],Qe={},rt=0,$e=function(ur){var Lr=L[ur.trace.type]?P(ur):ur.trace.index;if(!Qe[Lr])rt++,Qe[Lr]=rt,We.push(ur);else{var Br=Qe[Lr]-1,Pr=We[Br];Br>0&&Math.abs(ur.distance)<Math.abs(Pr.distance)&&(We[Br]=ur)}},ht;for(ht=0;ht<_e;ht++)$e(He[ht]);for(ht=He.length-1;ht>_e-1;ht--)$e(He[ht]);He=We,Wr()}var xt=N._hoverdata,kt=[],Wt=oe(N),Ft=se(N);for(Ue=0;Ue<He.length;Ue++){var ir=He[Ue],hr=y.makeEventData(ir,ir.trace,ir.cd);if(ir.hovertemplate!==!1){var _r=!1;ir.cd[ir.index]&&ir.cd[ir.index].ht&&(_r=ir.cd[ir.index].ht),ir.hovertemplate=_r||ir.trace.hovertemplate||!1}if(ir.xa&&ir.ya){var an=ir.x0+ir.xa._offset,Rr=ir.x1+ir.xa._offset,Vr=ir.y0+ir.ya._offset,fn=ir.y1+ir.ya._offset,xr=Math.min(an,Rr),mr=Math.max(an,Rr),Fr=Math.min(Vr,fn),Ir=Math.max(Vr,fn);hr.bbox={x0:xr+Ft,x1:mr+Ft,y0:Fr+Wt,y1:Ir+Wt}}ir.eventData=[hr],kt.push(hr)}N._hoverdata=kt;var Sr=Ve==="y"&&(Je.length>1||He.length>1)||Ve==="closest"&&ke&&He.length>1,tt=o.combine(ee.plot_bgcolor||o.background,ee.paper_bgcolor),Ct=I(He,{gd:N,hovermode:Ve,rotateLabels:Sr,bgColor:tt,container:ee._hoverlayer,outerContainer:ee._paper.node(),commonLabelOpts:ee.hoverlabel,hoverdistance:ee.hoverdistance});if(y.isUnifiedHover(Ve)||(R(Ct,Sr?"xa":"ya",ee),B(Ct,Sr,ee._invScaleX,ee._invScaleY)),W&&W.tagName){var Zt=p.getComponentMethod("annotations","hasClickToShow")(N,kt);t(w.select(W),Zt?"pointer":"")}!W||Q||!G(N,U,xt)||(xt&&N.emit("plotly_unhover",{event:U,points:xt}),N.emit("plotly_hover",{event:U,points:N._hoverdata,xaxes:pe,yaxes:ge,xvals:Oe,yvals:Pe}))}function P(N){return[N.trace.index,N.index,N.x0,N.y0,N.name,N.attr,N.xa?N.xa._id:"",N.ya?N.ya._id:""].join(",")}var z=/<extra>([\s\S]*)<\/extra>/;function I(N,U){var q=U.gd,Q=q._fullLayout,W=U.hovermode,Z=U.rotateLabels,ee=U.bgColor,te=U.container,ae=U.outerContainer,le=U.commonLabelOpts||{};if(N.length===0)return[[]];var ye=U.fontFamily||h.HOVERFONT,fe=U.fontSize||h.HOVERFONTSIZE,pe=N[0],ge=pe.xa,Ae=pe.ya,we=W.charAt(0),De=pe[we+"Label"],Be=ie(q,ae),Ve=Be.top,xe=Be.width,Le=Be.height,He=De!==void 0&&pe.distance<=U.hoverdistance&&(W==="x"||W==="y");if(He){var Je=!0,Oe,Pe;for(Oe=0;Oe<N.length;Oe++)if(Je&&N[Oe].zLabel===void 0&&(Je=!1),Pe=N[Oe].hoverinfo||N[Oe].trace.hoverinfo,Pe){var Ue=Array.isArray(Pe)?Pe:Pe.split("+");if(Ue.indexOf("all")===-1&&Ue.indexOf(W)===-1){He=!1;break}}Je&&(He=!1)}var vt=te.selectAll("g.axistext").data(He?[0]:[]);if(vt.enter().append("g").classed("axistext",!0),vt.exit().remove(),vt.each(function(){var Ut=w.select(this),yr=T.ensureSingle(Ut,"path","",function(fn){fn.style({"stroke-width":"1px"})}),nt=T.ensureSingle(Ut,"text","",function(fn){fn.attr("data-notex",1)}),_e=le.bgcolor||o.defaultLine,Me=le.bordercolor||o.contrast(_e),Ne=o.contrast(_e),We={family:le.font.family||ye,size:le.font.size||fe,color:le.font.color||Ne};yr.style({fill:_e,stroke:Me}),nt.text(De).call(f.font,We).call(r.positionText,0,0).call(r.convertToTspans,q),Ut.attr("transform","");var Qe=ie(q,nt.node()),rt,$e;if(W==="x"){var ht=ge.side==="top"?"-":"";nt.attr("text-anchor","middle").call(r.positionText,0,ge.side==="top"?Ve-Qe.bottom-b-l:Ve-Qe.top+b+l),rt=ge._offset+(pe.x0+pe.x1)/2,$e=Ae._offset+(ge.side==="top"?0:Ae._length);var xt=Qe.width/2+l;rt<xt?(rt=xt,yr.attr("d","M-"+(xt-b)+",0L-"+(xt-b*2)+","+ht+b+"H"+(l+Qe.width/2)+"v"+ht+(l*2+Qe.height)+"H-"+xt+"V"+ht+b+"Z")):rt>Q.width-xt?(rt=Q.width-xt,yr.attr("d","M"+(xt-b)+",0L"+xt+","+ht+b+"v"+ht+(l*2+Qe.height)+"H-"+xt+"V"+ht+b+"H"+(xt-b*2)+"Z")):yr.attr("d","M0,0L"+b+","+ht+b+"H"+(l+Qe.width/2)+"v"+ht+(l*2+Qe.height)+"H-"+(l+Qe.width/2)+"V"+ht+b+"H-"+b+"Z")}else{var kt,Wt,Ft;Ae.side==="right"?(kt="start",Wt=1,Ft="",rt=ge._offset+ge._length):(kt="end",Wt=-1,Ft="-",rt=ge._offset),$e=Ae._offset+(pe.y0+pe.y1)/2,nt.attr("text-anchor",kt),yr.attr("d","M0,0L"+Ft+b+","+b+"V"+(l+Qe.height/2)+"h"+Ft+(l*2+Qe.width)+"V-"+(l+Qe.height/2)+"H"+Ft+b+"V-"+b+"Z");var ir=Qe.height/2,hr=Ve-Qe.top-ir,_r="clip"+Q._uid+"commonlabel"+Ae._id,an;if(rt<Qe.width+2*l+b){an="M-"+(b+l)+"-"+ir+"h-"+(Qe.width-l)+"V"+ir+"h"+(Qe.width-l)+"Z";var Rr=Qe.width-rt+l;r.positionText(nt,Rr,hr),kt==="end"&&nt.selectAll("tspan").each(function(){var fn=w.select(this),xr=f.tester.append("text").text(fn.text()).call(f.font,We),mr=ie(q,xr.node());Math.round(mr.width)<Math.round(Qe.width)&&fn.attr("x",Rr-mr.width),xr.remove()})}else r.positionText(nt,Wt*(l+b),hr),an=null;var Vr=Q._topclips.selectAll("#"+_r).data(an?[0]:[]);Vr.enter().append("clipPath").attr("id",_r).append("path"),Vr.exit().remove(),Vr.select("path").attr("d",an),f.setClipUrl(nt,an?_r:null,q)}Ut.attr("transform",e(rt,$e))}),y.isUnifiedHover(W)){te.selectAll("g.hovertext").remove();var Lt=N.filter(function(Ut){return Ut.hoverinfo!=="none"});if(Lt.length===0)return;var Yt=Q.hoverlabel,At=Yt.font,Rt={showlegend:!0,legend:{title:{text:De,font:At},font:At,bgcolor:Yt.bgcolor,bordercolor:Yt.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:Q.legend?Q.legend.traceorder:void 0,orientation:"v"}},Bt={font:At};m(Rt,Bt,q._fullData);var Mt=Bt.legend;Mt.entries=[];for(var Tt=0;Tt<Lt.length;Tt++){var at=Lt[Tt];if(at.hoverinfo!=="none"){var ct=D(at,!0,W,Q,De),je=ct[0],ke=ct[1];at.name=ke,ke!==""?at.text=ke+" : "+je:at.text=je;var Ye=at.cd[at.index];Ye&&(Ye.mc&&(at.mc=Ye.mc),Ye.mcc&&(at.mc=Ye.mcc),Ye.mlc&&(at.mlc=Ye.mlc),Ye.mlcc&&(at.mlc=Ye.mlcc),Ye.mlw&&(at.mlw=Ye.mlw),Ye.mrc&&(at.mrc=Ye.mrc),Ye.dir&&(at.dir=Ye.dir)),at._distinct=!0,Mt.entries.push([at])}}Mt.entries.sort(function(Ut,yr){return Ut[0].trace.index-yr[0].trace.index}),Mt.layer=te,Mt._inHover=!0,Mt._groupTitleFont=Yt.grouptitlefont,u(q,Mt);var Ke=te.select("g.legend"),st=ie(q,Ke.node()),Et=st.width+2*l,bt=st.height+2*l,zt=Lt[0],$t=(zt.x0+zt.x1)/2,Ot=(zt.y0+zt.y1)/2,Qt=!(p.traceIs(zt.trace,"bar-like")||p.traceIs(zt.trace,"box-violin")),tr,qt;we==="y"?Qt?(qt=Ot-l,tr=Ot+l):(qt=Math.min.apply(null,Lt.map(function(Ut){return Math.min(Ut.y0,Ut.y1)})),tr=Math.max.apply(null,Lt.map(function(Ut){return Math.max(Ut.y0,Ut.y1)}))):qt=tr=T.mean(Lt.map(function(Ut){return(Ut.y0+Ut.y1)/2}))-bt/2;var lr,Wr;we==="x"?Qt?(lr=$t+l,Wr=$t-l):(lr=Math.max.apply(null,Lt.map(function(Ut){return Math.max(Ut.x0,Ut.x1)})),Wr=Math.min.apply(null,Lt.map(function(Ut){return Math.min(Ut.x0,Ut.x1)}))):lr=Wr=T.mean(Lt.map(function(Ut){return(Ut.x0+Ut.x1)/2}))-Et/2;var cn=ge._offset,Jr=Ae._offset;tr+=Jr,lr+=cn,Wr+=cn-Et,qt+=Jr-bt;var ot,Vt;return lr+Et<xe&&lr>=0?ot=lr:Wr+Et<xe&&Wr>=0?ot=Wr:cn+Et<xe?ot=cn:lr-$t<$t-Wr+Et?ot=xe-Et:ot=0,ot+=l,tr+bt<Le&&tr>=0?Vt=tr:qt+bt<Le&&qt>=0?Vt=qt:Jr+bt<Le?Vt=Jr:tr-Ot<Ot-qt+bt?Vt=Le-bt:Vt=0,Vt+=l,Ke.attr("transform",e(ot-1,Vt-1)),Ke}var jt=te.selectAll("g.hovertext").data(N,function(Ut){return P(Ut)});return jt.enter().append("g").classed("hovertext",!0).each(function(){var Ut=w.select(this);Ut.append("rect").call(o.fill,o.addOpacity(ee,.8)),Ut.append("text").classed("name",!0),Ut.append("path").style("stroke-width","1px"),Ut.append("text").classed("nums",!0).call(f.font,ye,fe)}),jt.exit().remove(),jt.each(function(Ut){var yr=w.select(this).attr("transform",""),nt=Ut.color;Array.isArray(nt)&&(nt=nt[Ut.eventData[0].pointNumber]);var _e=Ut.bgcolor||nt,Me=o.combine(o.opacity(_e)?_e:o.defaultLine,ee),Ne=o.combine(o.opacity(nt)?nt:o.defaultLine,ee),We=Ut.borderColor||o.contrast(Me),Qe=D(Ut,He,W,Q,De,yr),rt=Qe[0],$e=Qe[1],ht=yr.select("text.nums").call(f.font,Ut.fontFamily||ye,Ut.fontSize||fe,Ut.fontColor||We).text(rt).attr("data-notex",1).call(r.positionText,0,0).call(r.convertToTspans,q),xt=yr.select("text.name"),kt=0,Wt=0;if($e&&$e!==rt){xt.call(f.font,Ut.fontFamily||ye,Ut.fontSize||fe,Ne).text($e).attr("data-notex",1).call(r.positionText,0,0).call(r.convertToTspans,q);var Ft=ie(q,xt.node());kt=Ft.width+2*l,Wt=Ft.height+2*l}else xt.remove(),yr.select("rect").remove();yr.select("path").style({fill:Me,stroke:We});var ir=Ut.xa._offset+(Ut.x0+Ut.x1)/2,hr=Ut.ya._offset+(Ut.y0+Ut.y1)/2,_r=Math.abs(Ut.x1-Ut.x0),an=Math.abs(Ut.y1-Ut.y0),Rr=ie(q,ht.node()),Vr=Rr.width/Q._invScaleX,fn=Rr.height/Q._invScaleY;Ut.ty0=(Ve-Rr.top)/Q._invScaleY,Ut.bx=Vr+2*l,Ut.by=Math.max(fn+2*l,Wt),Ut.anchor="start",Ut.txwidth=Vr,Ut.tx2width=kt,Ut.offset=0;var xr=(Vr+b+l+kt)*Q._invScaleX,mr,Fr;if(Z)Ut.pos=ir,mr=hr+an/2+xr<=Le,Fr=hr-an/2-xr>=0,(Ut.idealAlign==="top"||!mr)&&Fr?(hr-=an/2,Ut.anchor="end"):mr?(hr+=an/2,Ut.anchor="start"):Ut.anchor="middle";else if(Ut.pos=hr,mr=ir+_r/2+xr<=xe,Fr=ir-_r/2-xr>=0,(Ut.idealAlign==="left"||!mr)&&Fr)ir-=_r/2,Ut.anchor="end";else if(mr)ir+=_r/2,Ut.anchor="start";else{Ut.anchor="middle";var Ir=xr/2,Sr=ir+Ir-xe,tt=ir-Ir;Sr>0&&(ir-=Sr),tt<0&&(ir+=-tt)}ht.attr("text-anchor",Ut.anchor),kt&&xt.attr("text-anchor",Ut.anchor),yr.attr("transform",e(ir,hr)+(Z?a(_):""))}),jt}function D(N,U,q,Q,W,Z){var ee="",te="";N.nameOverride!==void 0&&(N.name=N.nameOverride),N.name&&(N.trace._meta&&(N.name=T.templateString(N.name,N.trace._meta)),ee=j(N.name,N.nameLength));var ae=q.charAt(0),le=ae==="x"?"y":"x";N.zLabel!==void 0?(N.xLabel!==void 0&&(te+="x: "+N.xLabel+"<br>"),N.yLabel!==void 0&&(te+="y: "+N.yLabel+"<br>"),N.trace.type!=="choropleth"&&N.trace.type!=="choroplethmapbox"&&(te+=(te?"z: ":"")+N.zLabel)):U&&N[ae+"Label"]===W?te=N[le+"Label"]||"":N.xLabel===void 0?N.yLabel!==void 0&&N.trace.type!=="scattercarpet"&&(te=N.yLabel):N.yLabel===void 0?te=N.xLabel:te="("+N.xLabel+", "+N.yLabel+")",(N.text||N.text===0)&&!Array.isArray(N.text)&&(te+=(te?"<br>":"")+N.text),N.extraText!==void 0&&(te+=(te?"<br>":"")+N.extraText),Z&&te===""&&!N.hovertemplate&&(ee===""&&Z.remove(),te=ee);var ye=N.hovertemplate||!1;if(ye){var fe=N.hovertemplateLabels||N;N[ae+"Label"]!==W&&(fe[ae+"other"]=fe[ae+"Val"],fe[ae+"otherLabel"]=fe[ae+"Label"]),te=T.hovertemplateString(ye,fe,Q._d3locale,N.eventData[0]||{},N.trace._meta),te=te.replace(z,function(pe,ge){return ee=j(ge,N.nameLength),""})}return[te,ee]}function R(N,U,q){var Q=0,W=1,Z=N.size(),ee=new Array(Z),te=0;N.each(function(Oe){var Pe=Oe[U],Ue=Pe._id.charAt(0)==="x",vt=Pe.range;te===0&&vt&&vt[0]>vt[1]!==Ue&&(W=-1),ee[te++]=[{datum:Oe,traceIndex:Oe.trace.index,dp:0,pos:Oe.pos,posref:Oe.posref,size:Oe.by*(Ue?A:1)/2,pmin:0,pmax:Ue?q.width:q.height}]}),ee.sort(function(Oe,Pe){return Oe[0].posref-Pe[0].posref||W*(Pe[0].traceIndex-Oe[0].traceIndex)});var ae,le,ye,fe,pe,ge,Ae;function we(Oe){var Pe=Oe[0],Ue=Oe[Oe.length-1];if(le=Pe.pmin-Pe.pos-Pe.dp+Pe.size,ye=Ue.pos+Ue.dp+Ue.size-Pe.pmax,le>.01){for(pe=Oe.length-1;pe>=0;pe--)Oe[pe].dp+=le;ae=!1}if(!(ye<.01)){if(le<-.01){for(pe=Oe.length-1;pe>=0;pe--)Oe[pe].dp-=ye;ae=!1}if(!!ae){var vt=0;for(fe=0;fe<Oe.length;fe++)ge=Oe[fe],ge.pos+ge.dp+ge.size>Pe.pmax&&vt++;for(fe=Oe.length-1;fe>=0&&!(vt<=0);fe--)ge=Oe[fe],ge.pos>Pe.pmax-1&&(ge.del=!0,vt--);for(fe=0;fe<Oe.length&&!(vt<=0);fe++)if(ge=Oe[fe],ge.pos<Pe.pmin+1)for(ge.del=!0,vt--,ye=ge.size*2,pe=Oe.length-1;pe>=0;pe--)Oe[pe].dp-=ye;for(fe=Oe.length-1;fe>=0&&!(vt<=0);fe--)ge=Oe[fe],ge.pos+ge.dp+ge.size>Pe.pmax&&(ge.del=!0,vt--)}}}for(;!ae&&Q<=Z;){for(Q++,ae=!0,fe=0;fe<ee.length-1;){var De=ee[fe],Be=ee[fe+1],Ve=De[De.length-1],xe=Be[0];if(le=Ve.pos+Ve.dp+Ve.size-xe.pos-xe.dp+xe.size,le>.01&&Ve.pmin===xe.pmin&&Ve.pmax===xe.pmax){for(pe=Be.length-1;pe>=0;pe--)Be[pe].dp+=le;for(De.push.apply(De,Be),ee.splice(fe+1,1),Ae=0,pe=De.length-1;pe>=0;pe--)Ae+=De[pe].dp;for(ye=Ae/De.length,pe=De.length-1;pe>=0;pe--)De[pe].dp-=ye;ae=!1}else fe++}ee.forEach(we)}for(fe=ee.length-1;fe>=0;fe--){var Le=ee[fe];for(pe=Le.length-1;pe>=0;pe--){var He=Le[pe],Je=He.datum;Je.offset=He.dp,Je.del=He.del}}}function B(N,U,q,Q){var W=function(ee){return ee*q},Z=function(ee){return ee*Q};N.each(function(ee){var te=w.select(this);if(ee.del)return te.remove();var ae=te.select("text.nums"),le=ee.anchor,ye=le==="end"?-1:1,fe={start:1,end:-1,middle:0}[le],pe=fe*(b+l),ge=pe+fe*(ee.txwidth+l),Ae=0,we=ee.offset,De=le==="middle";De&&(pe-=ee.tx2width/2,ge+=ee.txwidth/2+l),U&&(we*=-v,Ae=ee.offset*x),te.select("path").attr("d",De?"M-"+W(ee.bx/2+ee.tx2width/2)+","+Z(we-ee.by/2)+"h"+W(ee.bx)+"v"+Z(ee.by)+"h-"+W(ee.bx)+"Z":"M0,0L"+W(ye*b+Ae)+","+Z(b+we)+"v"+Z(ee.by/2-b)+"h"+W(ye*ee.bx)+"v-"+Z(ee.by)+"H"+W(ye*b+Ae)+"V"+Z(we-b)+"Z");var Be=Ae+pe,Ve=we+ee.ty0-ee.by/2+l,xe=ee.textAlign||"auto";xe!=="auto"&&(xe==="left"&&le!=="start"?(ae.attr("text-anchor","start"),Be=De?-ee.bx/2-ee.tx2width/2+l:-ee.bx-l):xe==="right"&&le!=="end"&&(ae.attr("text-anchor","end"),Be=De?ee.bx/2-ee.tx2width/2-l:ee.bx+l)),ae.call(r.positionText,W(Be),Z(Ve)),ee.tx2width&&(te.select("text.name").call(r.positionText,W(ge+fe*l+Ae),Z(we+ee.ty0-ee.by/2+l)),te.select("rect").call(f.setRect,W(ge+(fe-1)*ee.tx2width/2+Ae),Z(we-ee.by/2-1),W(ee.tx2width),Z(ee.by+2)))})}function F(N,U){var q=N.index,Q=N.trace||{},W=N.cd[0],Z=N.cd[q]||{};function ee(pe){return pe||c(pe)&&pe===0}var te=Array.isArray(q)?function(pe,ge){var Ae=T.castOption(W,q,pe);return ee(Ae)?Ae:T.extractOption({},Q,"",ge)}:function(pe,ge){return T.extractOption(Z,Q,pe,ge)};function ae(pe,ge,Ae){var we=te(ge,Ae);ee(we)&&(N[pe]=we)}if(ae("hoverinfo","hi","hoverinfo"),ae("bgcolor","hbg","hoverlabel.bgcolor"),ae("borderColor","hbc","hoverlabel.bordercolor"),ae("fontFamily","htf","hoverlabel.font.family"),ae("fontSize","hts","hoverlabel.font.size"),ae("fontColor","htc","hoverlabel.font.color"),ae("nameLength","hnl","hoverlabel.namelength"),ae("textAlign","hta","hoverlabel.align"),N.posref=U==="y"||U==="closest"&&Q.orientation==="h"?N.xa._offset+(N.x0+N.x1)/2:N.ya._offset+(N.y0+N.y1)/2,N.x0=T.constrain(N.x0,0,N.xa._length),N.x1=T.constrain(N.x1,0,N.xa._length),N.y0=T.constrain(N.y0,0,N.ya._length),N.y1=T.constrain(N.y1,0,N.ya._length),N.xLabelVal!==void 0&&(N.xLabel="xLabel"in N?N.xLabel:g.hoverLabelText(N.xa,N.xLabelVal,Q.xhoverformat),N.xVal=N.xa.c2d(N.xLabelVal)),N.yLabelVal!==void 0&&(N.yLabel="yLabel"in N?N.yLabel:g.hoverLabelText(N.ya,N.yLabelVal,Q.yhoverformat),N.yVal=N.ya.c2d(N.yLabelVal)),N.zLabelVal!==void 0&&N.zLabel===void 0&&(N.zLabel=String(N.zLabelVal)),!isNaN(N.xerr)&&!(N.xa.type==="log"&&N.xerr<=0)){var le=g.tickText(N.xa,N.xa.c2l(N.xerr),"hover").text;N.xerrneg!==void 0?N.xLabel+=" +"+le+" / -"+g.tickText(N.xa,N.xa.c2l(N.xerrneg),"hover").text:N.xLabel+=" \xB1 "+le,U==="x"&&(N.distance+=1)}if(!isNaN(N.yerr)&&!(N.ya.type==="log"&&N.yerr<=0)){var ye=g.tickText(N.ya,N.ya.c2l(N.yerr),"hover").text;N.yerrneg!==void 0?N.yLabel+=" +"+ye+" / -"+g.tickText(N.ya,N.ya.c2l(N.yerrneg),"hover").text:N.yLabel+=" \xB1 "+ye,U==="y"&&(N.distance+=1)}var fe=N.hoverinfo||N.trace.hoverinfo;return fe&&fe!=="all"&&(fe=Array.isArray(fe)?fe:fe.split("+"),fe.indexOf("x")===-1&&(N.xLabel=void 0),fe.indexOf("y")===-1&&(N.yLabel=void 0),fe.indexOf("z")===-1&&(N.zLabel=void 0),fe.indexOf("text")===-1&&(N.text=void 0),fe.indexOf("name")===-1&&(N.name=void 0)),N}function V(N,U,q){var Q=q.container,W=q.fullLayout,Z=W._size,ee=q.event,te=!!U.hLinePoint,ae=!!U.vLinePoint,le,ye;if(Q.selectAll(".spikeline").remove(),!!(ae||te)){var fe=o.combine(W.plot_bgcolor,W.paper_bgcolor);if(te){var pe=U.hLinePoint,ge,Ae;le=pe&&pe.xa,ye=pe&&pe.ya;var we=ye.spikesnap;we==="cursor"?(ge=ee.pointerX,Ae=ee.pointerY):(ge=le._offset+pe.x,Ae=ye._offset+pe.y);var De=M.readability(pe.color,fe)<1.5?o.contrast(fe):pe.color,Be=ye.spikemode,Ve=ye.spikethickness,xe=ye.spikecolor||De,Le=g.getPxPosition(N,ye),He,Je;if(Be.indexOf("toaxis")!==-1||Be.indexOf("across")!==-1){if(Be.indexOf("toaxis")!==-1&&(He=Le,Je=ge),Be.indexOf("across")!==-1){var Oe=ye._counterDomainMin,Pe=ye._counterDomainMax;ye.anchor==="free"&&(Oe=Math.min(Oe,ye.position),Pe=Math.max(Pe,ye.position)),He=Z.l+Oe*Z.w,Je=Z.l+Pe*Z.w}Q.insert("line",":first-child").attr({x1:He,x2:Je,y1:Ae,y2:Ae,"stroke-width":Ve,stroke:xe,"stroke-dasharray":f.dashStyle(ye.spikedash,Ve)}).classed("spikeline",!0).classed("crisp",!0),Q.insert("line",":first-child").attr({x1:He,x2:Je,y1:Ae,y2:Ae,"stroke-width":Ve+2,stroke:fe}).classed("spikeline",!0).classed("crisp",!0)}Be.indexOf("marker")!==-1&&Q.insert("circle",":first-child").attr({cx:Le+(ye.side!=="right"?Ve:-Ve),cy:Ae,r:Ve,fill:xe}).classed("spikeline",!0)}if(ae){var Ue=U.vLinePoint,vt,Lt;le=Ue&&Ue.xa,ye=Ue&&Ue.ya;var Yt=le.spikesnap;Yt==="cursor"?(vt=ee.pointerX,Lt=ee.pointerY):(vt=le._offset+Ue.x,Lt=ye._offset+Ue.y);var At=M.readability(Ue.color,fe)<1.5?o.contrast(fe):Ue.color,Rt=le.spikemode,Bt=le.spikethickness,Mt=le.spikecolor||At,Tt=g.getPxPosition(N,le),at,ct;if(Rt.indexOf("toaxis")!==-1||Rt.indexOf("across")!==-1){if(Rt.indexOf("toaxis")!==-1&&(at=Tt,ct=Lt),Rt.indexOf("across")!==-1){var je=le._counterDomainMin,ke=le._counterDomainMax;le.anchor==="free"&&(je=Math.min(je,le.position),ke=Math.max(ke,le.position)),at=Z.t+(1-ke)*Z.h,ct=Z.t+(1-je)*Z.h}Q.insert("line",":first-child").attr({x1:vt,x2:vt,y1:at,y2:ct,"stroke-width":Bt,stroke:Mt,"stroke-dasharray":f.dashStyle(le.spikedash,Bt)}).classed("spikeline",!0).classed("crisp",!0),Q.insert("line",":first-child").attr({x1:vt,x2:vt,y1:at,y2:ct,"stroke-width":Bt+2,stroke:fe}).classed("spikeline",!0).classed("crisp",!0)}Rt.indexOf("marker")!==-1&&Q.insert("circle",":first-child").attr({cx:vt,cy:Tt-(le.side!=="top"?Bt:-Bt),r:Bt,fill:Mt}).classed("spikeline",!0)}}}function G(N,U,q){if(!q||q.length!==N._hoverdata.length)return!0;for(var Q=q.length-1;Q>=0;Q--){var W=q[Q],Z=N._hoverdata[Q];if(W.curveNumber!==Z.curveNumber||String(W.pointNumber)!==String(Z.pointNumber)||String(W.pointNumbers)!==String(Z.pointNumbers))return!0}return!1}function J(N,U){return!U||U.vLinePoint!==N._spikepoints.vLinePoint||U.hLinePoint!==N._spikepoints.hLinePoint}function j(N,U){return r.plainText(N||"",{len:U,allowedTags:["br","sub","sup","b","i","em"]})}function Y(N,U){for(var q=U.charAt(0),Q=[],W=[],Z=[],ee=0;ee<N.length;ee++){var te=N[ee];p.traceIs(te.trace,"bar-like")||p.traceIs(te.trace,"box-violin")?Z.push(te):te.trace[q+"period"]?W.push(te):Q.push(te)}return Q.concat(W).concat(Z)}function X(N,U,q){var Q=U[N+"a"],W=U[N+"Val"],Z=U.cd[0];if(Q.type==="category")W=Q._categoriesMap[W];else if(Q.type==="date"){var ee=U.trace[N+"periodalignment"];if(ee){var te=U.cd[U.index],ae=te[N+"Start"];ae===void 0&&(ae=te[N]);var le=te[N+"End"];le===void 0&&(le=te[N]);var ye=le-ae;ee==="end"?W+=ye:ee==="middle"&&(W+=ye/2)}W=Q.d2c(W)}return Z&&Z.t&&Z.t.posLetter===Q._id&&(q.boxmode==="group"||q.violinmode==="group")&&(W+=Z.t.dPos),W}function oe(N){return N.offsetTop+N.clientTop}function se(N){return N.offsetLeft+N.clientLeft}function ie(N,U){var q=N._fullLayout,Q=U.getBoundingClientRect(),W=Q.x,Z=Q.y,ee=W+Q.width,te=Z+Q.height,ae=T.apply3DTransform(q._invTransform)(W,Z),le=T.apply3DTransform(q._invTransform)(ee,te),ye=ae[0],fe=ae[1],pe=le[0],ge=le[1];return{x:ye,y:fe,width:pe-ye,height:ge-fe,top:Math.min(fe,ge),left:Math.min(ye,pe),right:Math.max(ye,pe),bottom:Math.max(fe,ge)}}},{"../../lib":503,"../../lib/events":492,"../../lib/override_cursor":514,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"../legend/defaults":418,"../legend/draw":419,"./constants":400,"./helpers":402,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:312}],404:[function(d,re,ne){var w=d("../../lib"),c=d("../color"),M=d("./helpers").isUnifiedHover;re.exports=function(e,a,n,r){r=r||{};var t=a.legend;function f(o){r.font[o]||(r.font[o]=t?a.legend.font[o]:a.font[o])}a&&M(a.hovermode)&&(r.font||(r.font={}),f("size"),f("family"),f("color"),t?(r.bgcolor||(r.bgcolor=c.combine(a.legend.bgcolor,a.paper_bgcolor)),r.bordercolor||(r.bordercolor=a.legend.bordercolor)):r.bgcolor||(r.bgcolor=a.paper_bgcolor)),n("hoverlabel.bgcolor",r.bgcolor),n("hoverlabel.bordercolor",r.bordercolor),n("hoverlabel.namelength",r.namelength),w.coerceFont(n,"hoverlabel.font",r.font),n("hoverlabel.align",r.align)}},{"../../lib":503,"../color":366,"./helpers":402}],405:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes");re.exports=function(T,e){function a(n,r){return e[n]!==void 0?e[n]:w.coerce(T,e,c,n,r)}return a("clickmode"),a("hovermode")}},{"../../lib":503,"./layout_attributes":407}],406:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../dragelement"),T=d("./helpers"),e=d("./layout_attributes"),a=d("./hover");re.exports={moduleType:"component",name:"fx",constants:d("./constants"),schema:{layout:e},attributes:d("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:d("./layout_global_defaults"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),getDistanceFunction:T.getDistanceFunction,getClosest:T.getClosest,inbox:T.inbox,quadrature:T.quadrature,appendArrayPointValue:T.appendArrayPointValue,castHoverOption:r,castHoverinfo:t,hover:a.hover,unhover:M.unhover,loneHover:a.loneHover,loneUnhover:n,click:d("./click")};function n(f){var o=c.isD3Selection(f)?f:w.select(f);o.selectAll("g.hovertext").remove(),o.selectAll(".spikeline").remove()}function r(f,o,i){return c.castOption(f,o,"hoverlabel."+i)}function t(f,o,i){function g(p){return c.coerceHoverinfo({hoverinfo:p},{_module:f._module},o)}return c.castOption(f,i,"hoverinfo",g)}},{"../../lib":503,"../dragelement":385,"./attributes":397,"./calc":398,"./click":399,"./constants":400,"./defaults":401,"./helpers":402,"./hover":403,"./layout_attributes":407,"./layout_defaults":408,"./layout_global_defaults":409,"@plotly/d3":58}],407:[function(d,re,ne){var w=d("./constants"),c=d("../../plots/font_attributes"),M=c({editType:"none"});M.family.dflt=w.HOVERFONT,M.size.dflt=w.HOVERFONTSIZE,re.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:M,grouptitlefont:c({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":585,"./constants":400}],408:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes"),M=d("./hovermode_defaults"),T=d("./hoverlabel_defaults");re.exports=function(a,n){function r(p,y){return w.coerce(a,n,c,p,y)}var t=M(a,n);t&&(r("hoverdistance"),r("spikedistance"));var f=r("dragmode");f==="select"&&r("selectdirection");var o=n._has("mapbox"),i=n._has("geo"),g=n._basePlotModules.length;n.dragmode==="zoom"&&((o||i)&&g===1||o&&i&&g===2)&&(n.dragmode="pan"),T(a,n,r),w.coerceFont(r,"hoverlabel.grouptitlefont",n.hoverlabel.font)}},{"../../lib":503,"./hoverlabel_defaults":404,"./hovermode_defaults":405,"./layout_attributes":407}],409:[function(d,re,ne){var w=d("../../lib"),c=d("./hoverlabel_defaults"),M=d("./layout_attributes");re.exports=function(e,a){function n(r,t){return w.coerce(e,a,M,r,t)}c(e,a,n)}},{"../../lib":503,"./hoverlabel_defaults":404,"./layout_attributes":407}],410:[function(d,re,ne){var w=d("../../lib"),c=d("../../lib/regex").counter,M=d("../../plots/domain").attributes,T=d("../../plots/cartesian/constants").idRegex,e=d("../../plot_api/plot_template"),a={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[c("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[T.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[T.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:M({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function n(i,g,p){var y=g[p+"axes"],h=Object.keys((i._splomAxes||{})[p]||{});if(Array.isArray(y))return y;if(h.length)return h}function r(i,g){var p=i.grid||{},y=n(g,p,"x"),h=n(g,p,"y");if(!i.grid&&!y&&!h)return;var m=Array.isArray(p.subplots)&&Array.isArray(p.subplots[0]),u=Array.isArray(y),_=Array.isArray(h),s=u&&y!==p.xaxes&&_&&h!==p.yaxes,A,x;m?(A=p.subplots.length,x=p.subplots[0].length):(_&&(A=h.length),u&&(x=y.length));var v=e.newContainer(g,"grid");function b(B,F){return w.coerce(p,v,a,B,F)}var l=b("rows",A),L=b("columns",x);if(!(l*L>1)){delete g.grid;return}if(!m&&!u&&!_){var S=b("pattern")==="independent";S&&(m=!0)}v._hasSubplotGrid=m;var k=b("roworder"),P=k==="top to bottom",z=m?.2:.1,I=m?.3:.1,D,R;s&&g._splomGridDflt&&(D=g._splomGridDflt.xside,R=g._splomGridDflt.yside),v._domains={x:t("x",b,z,D,L),y:t("y",b,I,R,l,P)}}function t(i,g,p,y,h,m){var u=g(i+"gap",p),_=g("domain."+i);g(i+"side",y);for(var s=new Array(h),A=_[0],x=(_[1]-A)/(h-u),v=x*(1-u),b=0;b<h;b++){var l=A+x*b;s[m?h-1-b:b]=[l,l+v]}return s}function f(i,g){var p=g.grid;if(!(!p||!p._domains)){var y=i.grid||{},h=g._subplots,m=p._hasSubplotGrid,u=p.rows,_=p.columns,s=p.pattern==="independent",A,x,v,b,l,L,S,k=p._axisMap={};if(m){var P=y.subplots||[];L=p.subplots=new Array(u);var z=1;for(A=0;A<u;A++){var I=L[A]=new Array(_),D=P[A]||[];for(x=0;x<_;x++)if(s?(l=z===1?"xy":"x"+z+"y"+z,z++):l=D[x],I[x]="",h.cartesian.indexOf(l)!==-1){if(S=l.indexOf("y"),v=l.slice(0,S),b=l.slice(S),k[v]!==void 0&&k[v]!==x||k[b]!==void 0&&k[b]!==A)continue;I[x]=l,k[v]=x,k[b]=A}}}else{var R=n(g,y,"x"),B=n(g,y,"y");p.xaxes=o(R,h.xaxis,_,k,"x"),p.yaxes=o(B,h.yaxis,u,k,"y")}var F=p._anchors={},V=p.roworder==="top to bottom";for(var G in k){var J=G.charAt(0),j=p[J+"side"],Y,X,oe;if(j.length<8)F[G]="free";else if(J==="x"){if(j.charAt(0)==="t"===V?(Y=0,X=1,oe=u):(Y=u-1,X=-1,oe=-1),m){var se=k[G];for(A=Y;A!==oe;A+=X)if(l=L[A][se],!!l&&(S=l.indexOf("y"),l.slice(0,S)===G)){F[G]=l.slice(S);break}}else for(A=Y;A!==oe;A+=X)if(b=p.yaxes[A],h.cartesian.indexOf(G+b)!==-1){F[G]=b;break}}else if(j.charAt(0)==="l"?(Y=0,X=1,oe=_):(Y=_-1,X=-1,oe=-1),m){var ie=k[G];for(A=Y;A!==oe;A+=X)if(l=L[ie][A],!!l&&(S=l.indexOf("y"),l.slice(S)===G)){F[G]=l.slice(0,S);break}}else for(A=Y;A!==oe;A+=X)if(v=p.xaxes[A],h.cartesian.indexOf(v+G)!==-1){F[G]=v;break}}}}function o(i,g,p,y,h){var m=new Array(p),u;function _(s,A){g.indexOf(A)!==-1&&y[A]===void 0?(m[s]=A,y[A]=s):m[s]=""}if(Array.isArray(i))for(u=0;u<p;u++)_(u,i[u]);else for(_(0,h),u=1;u<p;u++)_(u,h+(u+1));return m}re.exports={moduleType:"component",name:"grid",schema:{layout:{grid:a}},layoutAttributes:a,sizeDefaults:r,contentDefaults:f}},{"../../lib":503,"../../lib/regex":520,"../../plot_api/plot_template":543,"../../plots/cartesian/constants":561,"../../plots/domain":584}],411:[function(d,re,ne){var w=d("../../plots/cartesian/constants"),c=d("../../plot_api/plot_template").templatedArray;d("../../constants/axis_placeable_objects"),re.exports=c("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",w.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",w.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":472,"../../plot_api/plot_template":543,"../../plots/cartesian/constants":561}],412:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib/to_log_range");re.exports=function(T,e,a,n){e=e||{};var r=a==="log"&&e.type==="linear",t=a==="linear"&&e.type==="log";if(!!(r||t)){for(var f=T._fullLayout.images,o=e._id.charAt(0),i,g,p=0;p<f.length;p++)if(i=f[p],g="images["+p+"].",i[o+"ref"]===e._id){var y=i[o],h=i["size"+o],m=null,u=null;if(r){m=c(y,e.range);var _=h/Math.pow(10,m)/2;u=2*Math.log(_+Math.sqrt(1+_*_))/Math.LN10}else m=Math.pow(10,y),u=m*(Math.pow(10,h/2)-Math.pow(10,-h/2));w(m)?w(u)||(u=null):(m=null,u=null),n(g+o,m),n(g+"size"+o,u)}}}},{"../../lib/to_log_range":531,"fast-isnumeric":190}],413:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes"),M=d("../../plots/array_container_defaults"),T=d("./attributes"),e="images";re.exports=function(r,t){var f={name:e,handleItemDefaults:a};M(r,t,f)};function a(n,r,t){function f(_,s){return w.coerce(n,r,T,_,s)}var o=f("source"),i=f("visible",!!o);if(!i)return r;f("layer"),f("xanchor"),f("yanchor"),f("sizex"),f("sizey"),f("sizing"),f("opacity");for(var g={_fullLayout:t},p=["x","y"],y=0;y<2;y++){var h=p[y],m=c.coerceRef(n,r,g,h,"paper",void 0);if(m!=="paper"){var u=c.getFromId(g,m);u._imgIndices.push(r._index)}c.coercePosition(r,g,f,m,h,0)}return r}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"./attributes":411}],414:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../drawing"),M=d("../../plots/cartesian/axes"),T=d("../../plots/cartesian/axis_ids"),e=d("../../constants/xmlns_namespaces");re.exports=function(n){var r=n._fullLayout,t=[],f={},o=[],i,g;for(g=0;g<r.images.length;g++){var p=r.images[g];if(p.visible)if(p.layer==="below"&&p.xref!=="paper"&&p.yref!=="paper"){i=T.ref2id(p.xref)+T.ref2id(p.yref);var y=r._plots[i];if(!y){o.push(p);continue}y.mainplot&&(i=y.mainplot.id),f[i]||(f[i]=[]),f[i].push(p)}else p.layer==="above"?t.push(p):o.push(p)}var h={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function m(b){var l=w.select(this);if(this._imgSrc!==b.source)if(l.attr("xmlns",e.svg),b.source&&b.source.slice(0,5)==="data:")l.attr("xlink:href",b.source),this._imgSrc=b.source;else{var L=new Promise(function(S){var k=new Image;this.img=k,k.setAttribute("crossOrigin","anonymous"),k.onerror=P,k.onload=function(){var z=document.createElement("canvas");z.width=this.width,z.height=this.height;var I=z.getContext("2d");I.drawImage(this,0,0);var D=z.toDataURL("image/png");l.attr("xlink:href",D),S()},l.on("error",P),k.src=b.source,this._imgSrc=b.source;function P(){l.remove(),S()}}.bind(this));n._promises.push(L)}}function u(b){var l=w.select(this),L=M.getFromId(n,b.xref),S=M.getFromId(n,b.yref),k=M.getRefType(b.xref)==="domain",P=M.getRefType(b.yref)==="domain",z=r._size,I,D;L!==void 0?I=typeof b.xref=="string"&&k?L._length*b.sizex:Math.abs(L.l2p(b.sizex)-L.l2p(0)):I=b.sizex*z.w,S!==void 0?D=typeof b.yref=="string"&&P?S._length*b.sizey:Math.abs(S.l2p(b.sizey)-S.l2p(0)):D=b.sizey*z.h;var R=I*h.x[b.xanchor].offset,B=D*h.y[b.yanchor].offset,F=h.x[b.xanchor].sizing+h.y[b.yanchor].sizing,V,G;switch(L!==void 0?V=typeof b.xref=="string"&&k?L._length*b.x+L._offset:L.r2p(b.x)+L._offset:V=b.x*z.w+z.l,V+=R,S!==void 0?G=typeof b.yref=="string"&&P?S._length*(1-b.y)+S._offset:S.r2p(b.y)+S._offset:G=z.h-b.y*z.h+z.t,G+=B,b.sizing){case"fill":F+=" slice";break;case"stretch":F="none";break}l.attr({x:V,y:G,width:I,height:D,preserveAspectRatio:F,opacity:b.opacity});var J=L&&M.getRefType(b.xref)!=="domain"?L._id:"",j=S&&M.getRefType(b.yref)!=="domain"?S._id:"",Y=J+j;c.setClipUrl(l,Y?"clip"+r._uid+Y:null,n)}var _=r._imageLowerLayer.selectAll("image").data(o),s=r._imageUpperLayer.selectAll("image").data(t);_.enter().append("image"),s.enter().append("image"),_.exit().remove(),s.exit().remove(),_.each(function(b){m.bind(this)(b),u.bind(this)(b)}),s.each(function(b){m.bind(this)(b),u.bind(this)(b)});var A=Object.keys(r._plots);for(g=0;g<A.length;g++){i=A[g];var x=r._plots[i];if(!!x.imagelayer){var v=x.imagelayer.selectAll("image").data(f[i]||[]);v.enter().append("image"),v.exit().remove(),v.each(function(b){m.bind(this)(b),u.bind(this)(b)})}}}},{"../../constants/xmlns_namespaces":480,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_ids":558,"../drawing":388,"@plotly/d3":58}],415:[function(d,re,ne){re.exports={moduleType:"component",name:"images",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),includeBasePlot:d("../../plots/cartesian/include_components")("images"),draw:d("./draw"),convertCoords:d("./convert_coords")}},{"../../plots/cartesian/include_components":567,"./attributes":411,"./convert_coords":412,"./defaults":413,"./draw":414}],416:[function(d,re,ne){var w=d("../../plots/font_attributes"),c=d("../color/attributes");re.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:c.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:w({editType:"legend"}),grouptitlefont:w({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:w({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":585,"../color/attributes":365}],417:[function(d,re,ne){re.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],418:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib"),M=d("../../plot_api/plot_template"),T=d("../../plots/attributes"),e=d("./attributes"),a=d("../../plots/layout_attributes"),n=d("./helpers");re.exports=function(t,f,o){var i=t.legend||{},g=M.newContainer(f,"legend");function p(D,R){return c.coerce(i,g,e,D,R)}for(var y,h=function(D,R){var B=y._input,F=y;return c.coerce(B,F,T,D,R)},m=f.font||{},u=c.coerceFont(p,"grouptitlefont",c.extendFlat({},m,{size:Math.round(m.size*1.1)})),_=0,s=!1,A="normal",x=0;x<o.length;x++)y=o[x],y.visible&&((y.showlegend||y._dfltShowLegend&&!(y._module&&y._module.attributes&&y._module.attributes.showlegend&&y._module.attributes.showlegend.dflt===!1))&&(_++,y.showlegend&&(s=!0,(w.traceIs(y,"pie-like")||y._input.showlegend===!0)&&_++),c.coerceFont(h,"legendgrouptitle.font",u)),(w.traceIs(y,"bar")&&f.barmode==="stack"||["tonextx","tonexty"].indexOf(y.fill)!==-1)&&(A=n.isGrouped({traceorder:A})?"grouped+reversed":"reversed"),y.legendgroup!==void 0&&y.legendgroup!==""&&(A=n.isReversed({traceorder:A})?"reversed+grouped":"grouped"));var v=c.coerce(t,f,a,"showlegend",s&&_>1);if(v===!1&&(f.legend=void 0),!(v===!1&&!i.uirevision)&&(p("uirevision",f.uirevision),v!==!1)){p("bgcolor",f.paper_bgcolor),p("bordercolor"),p("borderwidth");var b=c.coerceFont(p,"font",f.font),l=p("orientation"),L=l==="h",S,k,P;L?(S=0,w.getComponentMethod("rangeslider","isVisible")(t.xaxis)?(k=1.1,P="bottom"):(k=-.1,P="top")):(S=1.02,k=1,P="auto"),p("traceorder",A),n.isGrouped(f.legend)&&p("tracegroupgap"),p("itemsizing"),p("itemwidth"),p("itemclick"),p("itemdoubleclick"),p("groupclick"),p("x",S),p("xanchor"),p("y",k),p("yanchor",P),p("valign"),c.noneOrAll(i,g,["x","y"]);var z=p("title.text");if(z){p("title.side",L?"left":"top");var I=c.extendFlat({},b,{size:c.bigFont(b.size)});c.coerceFont(p,"title.font",I)}}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/attributes":550,"../../plots/layout_attributes":610,"../../registry":638,"./attributes":416,"./helpers":422}],419:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../plots/plots"),T=d("../../registry"),e=d("../../lib/events"),a=d("../dragelement"),n=d("../drawing"),r=d("../color"),t=d("../../lib/svg_text_utils"),f=d("./handle_click"),o=d("./constants"),i=d("../../constants/alignment"),g=i.LINE_SPACING,p=i.FROM_TL,y=i.FROM_BR,h=d("./get_legend_data"),m=d("./style"),u=d("./helpers"),_=1;re.exports=function(R,B){return B||(B=R._fullLayout.legend||{}),s(R,B)};function s(D,R){var B=D._fullLayout,F="legend"+B._uid,V,G=R._inHover;if(G?(V=R.layer,F+="-hover"):V=B._infolayer,!!V){D._legendMouseDownTime||(D._legendMouseDownTime=0);var J;if(G){if(!R.entries)return;J=h(R.entries,R)}else{if(!D.calcdata)return;J=B.showlegend&&h(D.calcdata,R)}var j=B.hiddenlabels||[];if(!G&&(!B.showlegend||!J.length))return V.selectAll(".legend").remove(),B._topdefs.select("#"+F).remove(),M.autoMargin(D,"legend");var Y=c.ensureSingle(V,"g","legend",function(W){G||W.attr("pointer-events","all")}),X=c.ensureSingleById(B._topdefs,"clipPath",F,function(W){W.append("rect")}),oe=c.ensureSingle(Y,"rect","bg",function(W){W.attr("shape-rendering","crispEdges")});oe.call(r.stroke,R.bordercolor).call(r.fill,R.bgcolor).style("stroke-width",R.borderwidth+"px");var se=c.ensureSingle(Y,"g","scrollbox"),ie=R.title;if(R._titleWidth=0,R._titleHeight=0,ie.text){var N=c.ensureSingle(se,"text","legendtitletext");N.attr("text-anchor","start").call(n.font,ie.font).text(ie.text),l(N,se,D,R,_)}else se.selectAll(".legendtitletext").remove();var U=c.ensureSingle(Y,"rect","scrollbar",function(W){W.attr(o.scrollBarEnterAttrs).call(r.fill,o.scrollBarColor)}),q=se.selectAll("g.groups").data(J);q.enter().append("g").attr("class","groups"),q.exit().remove();var Q=q.selectAll("g.traces").data(c.identity);Q.enter().append("g").attr("class","traces"),Q.exit().remove(),Q.style("opacity",function(W){var Z=W[0].trace;return T.traceIs(Z,"pie-like")?j.indexOf(W[0].label)!==-1?.5:1:Z.visible==="legendonly"?.5:1}).each(function(){w.select(this).call(x,D,R)}).call(m,D,R).each(function(){G||w.select(this).call(b,D)}),c.syncOrAsync([M.previousPromises,function(){return k(D,q,Q,R)},function(){var W=B._size,Z=R.borderwidth;if(!G){var ee=P(D);if(ee)return;var te=W.l+W.w*R.x-p[z(R)]*R._width,ae=W.t+W.h*(1-R.y)-p[I(R)]*R._effHeight;if(B.margin.autoexpand){var le=te,ye=ae;te=c.constrain(te,0,B.width-R._width),ae=c.constrain(ae,0,B.height-R._effHeight),te!==le&&c.log("Constrain legend.x to make legend fit inside graph"),ae!==ye&&c.log("Constrain legend.y to make legend fit inside graph")}n.setTranslate(Y,te,ae)}if(U.on(".drag",null),Y.on("wheel",null),G||R._height<=R._maxHeight||D._context.staticPlot){var fe=R._effHeight;G&&(fe=R._height),oe.attr({width:R._width-Z,height:fe-Z,x:Z/2,y:Z/2}),n.setTranslate(se,0,0),X.select("rect").attr({width:R._width-2*Z,height:fe-2*Z,x:Z,y:Z}),n.setClipUrl(se,F,D),n.setRect(U,0,0,0,0),delete R._scrollY}else{var pe=Math.max(o.scrollBarMinHeight,R._effHeight*R._effHeight/R._height),ge=R._effHeight-pe-2*o.scrollBarMargin,Ae=R._height-R._effHeight,we=ge/Ae,De=Math.min(R._scrollY||0,Ae);oe.attr({width:R._width-2*Z+o.scrollBarWidth+o.scrollBarMargin,height:R._effHeight-Z,x:Z/2,y:Z/2}),X.select("rect").attr({width:R._width-2*Z+o.scrollBarWidth+o.scrollBarMargin,height:R._effHeight-2*Z,x:Z,y:Z+De}),n.setClipUrl(se,F,D),Pe(De,pe,we),Y.on("wheel",function(){De=c.constrain(R._scrollY+w.event.deltaY/ge*Ae,0,Ae),Pe(De,pe,we),De!==0&&De!==Ae&&w.event.preventDefault()});var Be,Ve,xe,Le=function(At,Rt,Bt){var Mt=(Bt-Rt)/we+At;return c.constrain(Mt,0,Ae)},He=function(At,Rt,Bt){var Mt=(Rt-Bt)/we+At;return c.constrain(Mt,0,Ae)},Je=w.behavior.drag().on("dragstart",function(){var At=w.event.sourceEvent;At.type==="touchstart"?Be=At.changedTouches[0].clientY:Be=At.clientY,xe=De}).on("drag",function(){var At=w.event.sourceEvent;At.buttons===2||At.ctrlKey||(At.type==="touchmove"?Ve=At.changedTouches[0].clientY:Ve=At.clientY,De=Le(xe,Be,Ve),Pe(De,pe,we))});U.call(Je);var Oe=w.behavior.drag().on("dragstart",function(){var At=w.event.sourceEvent;At.type==="touchstart"&&(Be=At.changedTouches[0].clientY,xe=De)}).on("drag",function(){var At=w.event.sourceEvent;At.type==="touchmove"&&(Ve=At.changedTouches[0].clientY,De=He(xe,Be,Ve),Pe(De,pe,we))});se.call(Oe)}function Pe(At,Rt,Bt){R._scrollY=D._fullLayout.legend._scrollY=At,n.setTranslate(se,0,-At),n.setRect(U,R._width,o.scrollBarMargin+At*Bt,o.scrollBarWidth,Rt),X.select("rect").attr("y",Z+At)}if(D._context.edits.legendPosition){var Ue,vt,Lt,Yt;Y.classed("cursor-move",!0),a.init({element:Y.node(),gd:D,prepFn:function(){var At=n.getTranslate(Y);Lt=At.x,Yt=At.y},moveFn:function(At,Rt){var Bt=Lt+At,Mt=Yt+Rt;n.setTranslate(Y,Bt,Mt),Ue=a.align(Bt,0,W.l,W.l+W.w,R.xanchor),vt=a.align(Mt,0,W.t+W.h,W.t,R.yanchor)},doneFn:function(){Ue!==void 0&&vt!==void 0&&T.call("_guiRelayout",D,{"legend.x":Ue,"legend.y":vt})},clickFn:function(At,Rt){var Bt=V.selectAll("g.traces").filter(function(){var Mt=this.getBoundingClientRect();return Rt.clientX>=Mt.left&&Rt.clientX<=Mt.right&&Rt.clientY>=Mt.top&&Rt.clientY<=Mt.bottom});Bt.size()>0&&A(D,Y,Bt,At,Rt)}})}}],D)}}function A(D,R,B,F,V){var G=B.data()[0][0].trace,J={event:V,node:B.node(),curveNumber:G.index,expandedIndex:G._expandedIndex,data:D.data,layout:D.layout,frames:D._transitionData._frames,config:D._context,fullData:D._fullData,fullLayout:D._fullLayout};G._group&&(J.group=G._group),T.traceIs(G,"pie-like")&&(J.label=B.datum()[0].label);var j=e.triggerHandler(D,"plotly_legendclick",J);if(j!==!1){if(F===1)R._clickTimeout=setTimeout(function(){!D._fullLayout||f(B,D,F)},D._context.doubleClickDelay);else if(F===2){R._clickTimeout&&clearTimeout(R._clickTimeout),D._legendMouseDownTime=0;var Y=e.triggerHandler(D,"plotly_legenddoubleclick",J);Y!==!1&&f(B,D,F)}}}function x(D,R,B){var F=D.data()[0][0],V=F.trace,G=T.traceIs(V,"pie-like"),J=!B._inHover&&R._context.edits.legendText&&!G,j=B._maxNameLength,Y,X;F.groupTitle?(Y=F.groupTitle.text,X=F.groupTitle.font):(X=B.font,B.entries?Y=F.text:(Y=G?F.label:V.name,V._meta&&(Y=c.templateString(Y,V._meta))));var oe=c.ensureSingle(D,"text","legendtext");oe.attr("text-anchor","start").call(n.font,X).text(J?v(Y,j):Y);var se=B.itemwidth+o.itemGap*2;t.positionText(oe,se,0),J?oe.call(t.makeEditable,{gd:R,text:Y}).call(l,D,R,B).on("edit",function(ie){this.text(v(ie,j)).call(l,D,R,B);var N=F.trace._fullInput||{},U={};if(T.hasTransform(N,"groupby")){var q=T.getTransformIndices(N,"groupby"),Q=q[q.length-1],W=c.keyedContainer(N,"transforms["+Q+"].styles","target","value.name");W.set(F.trace._group,ie),U=W.constructUpdate()}else U.name=ie;return T.call("_guiRestyle",R,U,V.index)}):l(oe,D,R,B)}function v(D,R){var B=Math.max(4,R);if(D&&D.trim().length>=B/2)return D;D=D||"";for(var F=B-D.length;F>0;F--)D+=" ";return D}function b(D,R){var B=R._context.doubleClickDelay,F,V=1,G=c.ensureSingle(D,"rect","legendtoggle",function(J){R._context.staticPlot||J.style("cursor","pointer").attr("pointer-events","all"),J.call(r.fill,"rgba(0,0,0,0)")});R._context.staticPlot||(G.on("mousedown",function(){F=new Date().getTime(),F-R._legendMouseDownTime<B?V+=1:(V=1,R._legendMouseDownTime=F)}),G.on("mouseup",function(){if(!(R._dragged||R._editing)){var J=R._fullLayout.legend;new Date().getTime()-R._legendMouseDownTime>B&&(V=Math.max(V-1,1)),A(R,J,D,V,w.event)}}))}function l(D,R,B,F,V){F._inHover&&D.attr("data-notex",!0),t.convertToTspans(D,B,function(){L(R,B,F,V)})}function L(D,R,B,F){var V=D.data()[0][0];if(!B._inHover&&V&&!V.trace.showlegend){D.remove();return}var G=D.select("g[class*=math-group]"),J=G.node();B||(B=R._fullLayout.legend);var j=B.borderwidth,Y;F===_?Y=B.title.font:V.groupTitle?Y=V.groupTitle.font:Y=B.font;var X=Y.size*g,oe,se;if(J){var ie=n.bBox(J);oe=ie.height,se=ie.width,F===_?n.setTranslate(G,j,j+oe*.75):n.setTranslate(G,0,oe*.25)}else{var N=D.select(F===_?".legendtitletext":".legendtext"),U=t.lineCount(N),q=N.node();if(oe=X*U,se=q?n.bBox(q).width:0,F===_)B.title.side==="left"&&(se+=o.itemGap*2),t.positionText(N,j+o.titlePad,j+X);else{var Q=o.itemGap*2+B.itemwidth;V.groupTitle&&(Q=o.itemGap,se-=B.itemwidth),t.positionText(N,Q,-X*((U-1)/2-.3))}}F===_?(B._titleWidth=se,B._titleHeight=oe):(V.lineHeight=X,V.height=Math.max(oe,16)+3,V.width=se)}function S(D){var R=0,B=0,F=D.title.side;return F&&(F.indexOf("left")!==-1&&(R=D._titleWidth),F.indexOf("top")!==-1&&(B=D._titleHeight)),[R,B]}function k(D,R,B,F){var V=D._fullLayout;F||(F=V.legend);var G=V._size,J=u.isVertical(F),j=u.isGrouped(F),Y=F.borderwidth,X=2*Y,oe=o.itemGap,se=F.itemwidth+oe*2,ie=2*(Y+oe),N=I(F),U=F.y<0||F.y===0&&N==="top",q=F.y>1||F.y===1&&N==="bottom",Q=F.tracegroupgap;F._maxHeight=Math.max(U||q?V.height/2:G.h,30);var W=0;F._width=0,F._height=0;var Z=S(F);if(J)B.each(function(Ue){var vt=Ue[0].height;n.setTranslate(this,Y+Z[0],Y+Z[1]+F._height+vt/2+oe),F._height+=vt,F._width=Math.max(F._width,Ue[0].width)}),W=se+F._width,F._width+=oe+se+X,F._height+=ie,j&&(R.each(function(Ue,vt){n.setTranslate(this,0,vt*F.tracegroupgap)}),F._height+=(F._lgroupsLength-1)*F.tracegroupgap);else{var ee=z(F),te=F.x<0||F.x===0&&ee==="right",ae=F.x>1||F.x===1&&ee==="left",le=q||U,ye=V.width/2;F._maxWidth=Math.max(te?le&&ee==="left"?G.l+G.w:ye:ae?le&&ee==="right"?G.r+G.w:ye:G.w,2*se);var fe=0,pe=0;B.each(function(Ue){var vt=Ue[0].width+se;fe=Math.max(fe,vt),pe+=vt}),W=null;var ge=0;if(j){var Ae=0,we=0,De=0;R.each(function(){var Ue=0,vt=0;w.select(this).selectAll("g.traces").each(function(Yt){var At=Yt[0].width,Rt=Yt[0].height;n.setTranslate(this,Z[0],Z[1]+Y+oe+Rt/2+vt),vt+=Rt,Ue=Math.max(Ue,se+At)});var Lt=Ue+oe;we>0&&Lt+Y+we>F._maxWidth?(ge=Math.max(ge,we),we=0,De+=Ae+Q,Ae=vt):Ae=Math.max(Ae,vt),n.setTranslate(this,we,De),we+=Lt}),F._width=Math.max(ge,we)+Y,F._height=De+Ae+ie}else{var Be=B.size(),Ve=pe+X+(Be-1)*oe<F._maxWidth,xe=0,Le=0,He=0,Je=0;B.each(function(Ue){var vt=Ue[0].height,Lt=se+Ue[0].width,Yt=(Ve?Lt:fe)+oe;Yt+Y+Le-oe>=F._maxWidth&&(ge=Math.max(ge,Je),Le=0,He+=xe,F._height+=xe,xe=0),n.setTranslate(this,Z[0]+Y+Le,Z[1]+Y+He+vt/2+oe),Je=Le+Lt+oe,Le+=Yt,xe=Math.max(xe,vt)}),Ve?(F._width=Le+X,F._height=xe+ie):(F._width=Math.max(ge,Je)+X,F._height+=xe+ie)}}F._width=Math.ceil(Math.max(F._width+Z[0],F._titleWidth+2*(Y+o.titlePad))),F._height=Math.ceil(Math.max(F._height+Z[1],F._titleHeight+2*(Y+o.itemGap))),F._effHeight=Math.min(F._height,F._maxHeight);var Oe=D._context.edits,Pe=Oe.legendText||Oe.legendPosition;B.each(function(Ue){var vt=w.select(this).select(".legendtoggle"),Lt=Ue[0].height,Yt=Pe?se:W||se+Ue[0].width;J||(Yt+=oe/2),n.setRect(vt,0,-Lt/2,Yt,Lt)})}function P(D){var R=D._fullLayout,B=R.legend,F=z(B),V=I(B);return M.autoMargin(D,"legend",{x:B.x,y:B.y,l:B._width*p[F],r:B._width*y[F],b:B._effHeight*y[V],t:B._effHeight*p[V]})}function z(D){return c.isRightAnchor(D)?"right":c.isCenterAnchor(D)?"center":"left"}function I(D){return c.isBottomAnchor(D)?"bottom":c.isMiddleAnchor(D)?"middle":"top"}},{"../../constants/alignment":471,"../../lib":503,"../../lib/events":492,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"./constants":417,"./get_legend_data":420,"./handle_click":421,"./helpers":422,"./style":424,"@plotly/d3":58}],420:[function(d,re,ne){var w=d("../../registry"),c=d("./helpers");re.exports=function(T,e){var a=e._inHover,n=c.isGrouped(e),r=c.isReversed(e),t={},f=[],o=!1,i={},g=0,p=0,y,h;function m(B,F){if(B===""||!c.isGrouped(e)){var V="~~i"+g;f.push(V),t[V]=[F],g++}else f.indexOf(B)===-1?(f.push(B),o=!0,t[B]=[F]):t[B].push(F)}for(y=0;y<T.length;y++){var u=T[y],_=u[0],s=_.trace,A=s.legendgroup;if(!(!a&&(!s.visible||!s.showlegend)))if(w.traceIs(s,"pie-like"))for(i[A]||(i[A]={}),h=0;h<u.length;h++){var x=u[h].label;i[A][x]||(m(A,{label:x,color:u[h].color,i:u[h].i,trace:s,pts:u[h].pts}),i[A][x]=!0,p=Math.max(p,(x||"").length))}else m(A,_),p=Math.max(p,(s.name||"").length)}if(!f.length)return[];var v=!o||!n,b=[];for(y=0;y<f.length;y++){var l=t[f[y]];v?b.push(l[0]):b.push(l)}for(v&&(b=[b]),y=0;y<b.length;y++){var L=1/0;for(h=0;h<b[y].length;h++){var S=b[y][h].trace.legendrank;L>S&&(L=S)}b[y][0]._groupMinRank=L,b[y][0]._preGroupSort=y}var k=function(B,F){return B[0]._groupMinRank-F[0]._groupMinRank||B[0]._preGroupSort-F[0]._preGroupSort},P=function(B,F){return B.trace.legendrank-F.trace.legendrank||B._preSort-F._preSort};for(b.forEach(function(B,F){B[0]._preGroupSort=F}),b.sort(k),y=0;y<b.length;y++){b[y].forEach(function(B,F){B._preSort=F}),b[y].sort(P);var z=b[y][0].trace,I=null;for(h=0;h<b[y].length;h++){var D=b[y][h].trace.legendgrouptitle;if(D&&D.text){I=D,a&&(D.font=e._groupTitleFont);break}}if(r&&b[y].reverse(),I){var R=!1;for(h=0;h<b[y].length;h++)if(w.traceIs(b[y][h].trace,"pie-like")){R=!0;break}b[y].unshift({i:-1,groupTitle:I,noClick:R,trace:{showlegend:z.showlegend,legendgroup:z.legendgroup,visible:e.groupclick==="toggleitem"?!0:z.visible}})}for(h=0;h<b[y].length;h++)b[y][h]=[b[y][h]]}return e._lgroupsLength=b.length,e._maxNameLength=p,b}},{"../../registry":638,"./helpers":422}],421:[function(d,re,ne){var w=d("../../lib"),c=d("../../registry"),M=!0;re.exports=function(e,a,n){var r=a._fullLayout;if(a._dragged||a._editing)return;var t=r.legend.itemclick,f=r.legend.itemdoubleclick,o=r.legend.groupclick;n===1&&t==="toggle"&&f==="toggleothers"&&M&&a.data&&a._context.showTips&&w.notifier(w._(a,"Double-click on legend to isolate one trace"),"long"),M=!1;var i;if(n===1?i=t:n===2&&(i=f),!i)return;var g=o==="togglegroup",p=r.hiddenlabels?r.hiddenlabels.slice():[],y=e.data()[0][0];if(y.groupTitle&&y.noClick)return;var h=a._fullData,m=y.trace,u=m.legendgroup,_,s,A,x,v,b,l={},L=[],S=[],k=[];function P(ie,N,U){var q=L.indexOf(ie),Q=l[N];return Q||(Q=l[N]=[]),L.indexOf(ie)===-1&&(L.push(ie),q=L.length-1),Q[q]=U,q}function z(ie,N){if(!(y.groupTitle&&!g)){var U=ie._fullInput;if(c.hasTransform(U,"groupby")){var q=S[U.index];if(!q){var Q=c.getTransformIndices(U,"groupby"),W=Q[Q.length-1];q=w.keyedContainer(U,"transforms["+W+"].styles","target","value.visible"),S[U.index]=q}var Z=q.get(ie._group);Z===void 0&&(Z=!0),Z!==!1&&q.set(ie._group,N),k[U.index]=P(U.index,"visible",U.visible!==!1)}else{var ee=U.visible===!1?!1:N;P(U.index,"visible",ee)}}}if(c.traceIs(m,"pie-like")){var I=y.label,D=p.indexOf(I);i==="toggle"?D===-1?p.push(I):p.splice(D,1):i==="toggleothers"&&(p=[],a.calcdata[0].forEach(function(ie){I!==ie.label&&p.push(ie.label)}),a._fullLayout.hiddenlabels&&a._fullLayout.hiddenlabels.length===p.length&&D===-1&&(p=[])),c.call("_guiRelayout",a,"hiddenlabels",p)}else{var R=u&&u.length,B=[],F;if(R)for(_=0;_<h.length;_++)F=h[_],!!F.visible&&F.legendgroup===u&&B.push(_);if(i==="toggle"){var V;switch(m.visible){case!0:V="legendonly";break;case!1:V=!1;break;case"legendonly":V=!0;break}if(R)if(g)for(_=0;_<h.length;_++)h[_].visible!==!1&&h[_].legendgroup===u&&z(h[_],V);else z(m,V);else z(m,V)}else if(i==="toggleothers"){var G,J,j,Y,X=!0;for(_=0;_<h.length;_++)if(G=h[_]===m,j=h[_].showlegend!==!0,!(G||j)&&(J=R&&h[_].legendgroup===u,!J&&h[_].visible===!0&&!c.traceIs(h[_],"notLegendIsolatable"))){X=!1;break}for(_=0;_<h.length;_++)if(h[_].visible!==!1&&!c.traceIs(h[_],"notLegendIsolatable"))switch(m.visible){case"legendonly":z(h[_],!0);break;case!0:Y=X?!0:"legendonly",G=h[_]===m,j=h[_].showlegend!==!0&&!h[_].legendgroup,J=G||R&&h[_].legendgroup===u,z(h[_],J||j?!0:Y);break}}for(_=0;_<S.length;_++)if(A=S[_],!!A){var oe=A.constructUpdate(),se=Object.keys(oe);for(s=0;s<se.length;s++)x=se[s],b=l[x]=l[x]||[],b[k[_]]=oe[x]}for(v=Object.keys(l),_=0;_<v.length;_++)for(x=v[_],s=0;s<L.length;s++)l[x].hasOwnProperty(s)||(l[x][s]=void 0);c.call("_guiRestyle",a,l,L)}}},{"../../lib":503,"../../registry":638}],422:[function(d,re,ne){ne.isGrouped=function(c){return(c.traceorder||"").indexOf("grouped")!==-1},ne.isVertical=function(c){return c.orientation!=="h"},ne.isReversed=function(c){return(c.traceorder||"").indexOf("reversed")!==-1}},{}],423:[function(d,re,ne){re.exports={moduleType:"component",name:"legend",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),draw:d("./draw"),style:d("./style")}},{"./attributes":416,"./defaults":418,"./draw":419,"./style":424}],424:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../registry"),M=d("../../lib"),T=M.strTranslate,e=d("../drawing"),a=d("../color"),n=d("../colorscale/helpers").extractOpts,r=d("../../traces/scatter/subtypes"),t=d("../../traces/pie/style_one"),f=d("../../traces/pie/helpers").castOption,o=d("./constants"),i=12,g=5,p=2,y=10,h=5;re.exports=function(A,x,v){var b=x._fullLayout;v||(v=b.legend);var l=v.itemsizing==="constant",L=v.itemwidth,S=(L+o.itemGap*2)/2,k=T(S,0),P=function(se,ie,N,U){var q;if(se+1)q=se;else if(ie&&ie.width>0)q=ie.width;else return 0;return l?U:Math.min(q,N)};A.each(function(se){var ie=w.select(this),N=M.ensureSingle(ie,"g","layers");N.style("opacity",se[0].trace.opacity);var U=v.valign,q=se[0].lineHeight,Q=se[0].height;if(U==="middle"||!q||!Q)N.attr("transform",null);else{var W={top:1,bottom:-1}[U],Z=W*(.5*(q-Q+3));N.attr("transform",T(0,Z))}var ee=N.selectAll("g.legendfill").data([se]);ee.enter().append("g").classed("legendfill",!0);var te=N.selectAll("g.legendlines").data([se]);te.enter().append("g").classed("legendlines",!0);var ae=N.selectAll("g.legendsymbols").data([se]);ae.enter().append("g").classed("legendsymbols",!0),ae.selectAll("g.legendpoints").data([se]).enter().append("g").classed("legendpoints",!0)}).each(oe).each(D).each(B).each(R).each(V).each(Y).each(j).each(z).each(I).each(G).each(J);function z(se){var ie=u(se),N=ie.showFill,U=ie.showLine,q=ie.showGradientLine,Q=ie.showGradientFill,W=ie.anyFill,Z=ie.anyLine,ee=se[0],te=ee.trace,ae,le,ye=n(te),fe=ye.colorscale,pe=ye.reversescale,ge=function(Le){if(Le.size())if(N)e.fillGroupStyle(Le,x);else{var He="legendfill-"+te.uid;e.gradient(Le,x,He,m(pe),fe,"fill")}},Ae=function(Le){if(Le.size()){var He="legendline-"+te.uid;e.lineGroupStyle(Le),e.gradient(Le,x,He,m(pe),fe,"stroke")}},we=r.hasMarkers(te)||!W?"M5,0":Z?"M5,-2":"M5,-3",De=w.select(this),Be=De.select(".legendfill").selectAll("path").data(N||Q?[se]:[]);if(Be.enter().append("path").classed("js-fill",!0),Be.exit().remove(),Be.attr("d",we+"h"+L+"v6h-"+L+"z").call(ge),U||q){var Ve=P(void 0,te.line,y,g);le=M.minExtend(te,{line:{width:Ve}}),ae=[M.minExtend(ee,{trace:le})]}var xe=De.select(".legendlines").selectAll("path").data(U||q?[ae]:[]);xe.enter().append("path").classed("js-line",!0),xe.exit().remove(),xe.attr("d",we+(q?"l"+L+",0.0001":"h"+L)).call(U?e.lineGroupStyle:Ae)}function I(se){var ie=u(se),N=ie.anyFill,U=ie.anyLine,q=ie.showLine,Q=ie.showMarker,W=se[0],Z=W.trace,ee=!Q&&!U&&!N&&r.hasText(Z),te,ae;function le(Be,Ve,xe,Le){var He=M.nestedProperty(Z,Be).get(),Je=M.isArrayOrTypedArray(He)&&Ve?Ve(He):He;if(l&&Je&&Le!==void 0&&(Je=Le),xe){if(Je<xe[0])return xe[0];if(Je>xe[1])return xe[1]}return Je}function ye(Be){return W._distinct&&W.index&&Be[W.index]?Be[W.index]:Be[0]}if(Q||ee||q){var fe={},pe={};if(Q){fe.mc=le("marker.color",ye),fe.mx=le("marker.symbol",ye),fe.mo=le("marker.opacity",M.mean,[.2,1]),fe.mlc=le("marker.line.color",ye),fe.mlw=le("marker.line.width",M.mean,[0,5],p),pe.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var ge=le("marker.size",M.mean,[2,16],i);fe.ms=ge,pe.marker.size=ge}q&&(pe.line={width:le("line.width",ye,[0,10],g)}),ee&&(fe.tx="Aa",fe.tp=le("textposition",ye),fe.ts=10,fe.tc=le("textfont.color",ye),fe.tf=le("textfont.family",ye)),te=[M.minExtend(W,fe)],ae=M.minExtend(Z,pe),ae.selectedpoints=null,ae.texttemplate=null}var Ae=w.select(this).select("g.legendpoints"),we=Ae.selectAll("path.scatterpts").data(Q?te:[]);we.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",k),we.exit().remove(),we.call(e.pointStyle,ae,x),Q&&(te[0].mrc=3);var De=Ae.selectAll("g.pointtext").data(ee?te:[]);De.enter().append("g").classed("pointtext",!0).append("text").attr("transform",k),De.exit().remove(),De.selectAll("text").call(e.textPointStyle,ae,x)}function D(se){var ie=se[0].trace,N=ie.type==="waterfall";if(se[0]._distinct&&N){var U=se[0].trace[se[0].dir].marker;return se[0].mc=U.color,se[0].mlw=U.line.width,se[0].mlc=U.line.color,F(se,this,"waterfall")}var q=[];ie.visible&&N&&(q=se[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var Q=w.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(q);Q.enter().append("path").classed("legendwaterfall",!0).attr("transform",k).style("stroke-miterlimit",1),Q.exit().remove(),Q.each(function(W){var Z=w.select(this),ee=ie[W[0]].marker,te=P(void 0,ee.line,h,p);Z.attr("d",W[1]).style("stroke-width",te+"px").call(a.fill,ee.color),te&&Z.call(a.stroke,ee.line.color)})}function R(se){F(se,this)}function B(se){F(se,this,"funnel")}function F(se,ie,N){var U=se[0].trace,q=U.marker||{},Q=q.line||{},W=N?U.visible&&U.type===N:c.traceIs(U,"bar"),Z=w.select(ie).select("g.legendpoints").selectAll("path.legend"+N).data(W?[se]:[]);Z.enter().append("path").classed("legend"+N,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),Z.exit().remove(),Z.each(function(ee){var te=w.select(this),ae=ee[0],le=P(ae.mlw,q.line,h,p);te.style("stroke-width",le+"px");var ye=ae.mcc;if(!v._inHover&&"mc"in ae){var fe=n(q),pe=fe.mid;pe===void 0&&(pe=(fe.max+fe.min)/2),ye=e.tryColorscale(q,"")(pe)}var ge=ye||ae.mc||q.color,Ae=q.pattern,we=Ae&&e.getPatternAttr(Ae.shape,0,"");if(we){var De=e.getPatternAttr(Ae.bgcolor,0,null),Be=e.getPatternAttr(Ae.fgcolor,0,null),Ve=Ae.fgopacity,xe=_(Ae.size,8,10),Le=_(Ae.solidity,.5,1),He="legend-"+U.uid;te.call(e.pattern,"legend",x,He,we,xe,Le,ye,Ae.fillmode,De,Be,Ve)}else te.call(a.fill,ge);le&&a.stroke(te,ae.mlc||Q.color)})}function V(se){var ie=se[0].trace,N=w.select(this).select("g.legendpoints").selectAll("path.legendbox").data(ie.visible&&c.traceIs(ie,"box-violin")?[se]:[]);N.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),N.exit().remove(),N.each(function(){var U=w.select(this);if((ie.boxpoints==="all"||ie.points==="all")&&a.opacity(ie.fillcolor)===0&&a.opacity((ie.line||{}).color)===0){var q=M.minExtend(ie,{marker:{size:l?i:M.constrain(ie.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});N.call(e.pointStyle,q,x)}else{var Q=P(void 0,ie.line,h,p);U.style("stroke-width",Q+"px").call(a.fill,ie.fillcolor),Q&&a.stroke(U,ie.line.color)}})}function G(se){var ie=se[0].trace,N=w.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(ie.visible&&ie.type==="candlestick"?[se,se]:[]);N.enter().append("path").classed("legendcandle",!0).attr("d",function(U,q){return q?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",k).style("stroke-miterlimit",1),N.exit().remove(),N.each(function(U,q){var Q=w.select(this),W=ie[q?"increasing":"decreasing"],Z=P(void 0,W.line,h,p);Q.style("stroke-width",Z+"px").call(a.fill,W.fillcolor),Z&&a.stroke(Q,W.line.color)})}function J(se){var ie=se[0].trace,N=w.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(ie.visible&&ie.type==="ohlc"?[se,se]:[]);N.enter().append("path").classed("legendohlc",!0).attr("d",function(U,q){return q?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",k).style("stroke-miterlimit",1),N.exit().remove(),N.each(function(U,q){var Q=w.select(this),W=ie[q?"increasing":"decreasing"],Z=P(void 0,W.line,h,p);Q.style("fill","none").call(e.dashLine,W.line.dash,Z),Z&&a.stroke(Q,W.line.color)})}function j(se){X(se,this,"pie")}function Y(se){X(se,this,"funnelarea")}function X(se,ie,N){var U=se[0],q=U.trace,Q=N?q.visible&&q.type===N:c.traceIs(q,N),W=w.select(ie).select("g.legendpoints").selectAll("path.legend"+N).data(Q?[se]:[]);if(W.enter().append("path").classed("legend"+N,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",k),W.exit().remove(),W.size()){var Z=(q.marker||{}).line,ee=P(f(Z.width,U.pts),Z,h,p),te=M.minExtend(q,{marker:{line:{width:ee}}});te.marker.line.color=Z.color;var ae=M.minExtend(U,{trace:te});t(W,ae,te)}}function oe(se){var ie=se[0].trace,N,U=[];if(ie.visible)switch(ie.type){case"histogram2d":case"heatmap":U=[["M-15,-2V4H15V-2Z"]],N=!0;break;case"choropleth":case"choroplethmapbox":U=[["M-6,-6V6H6V-6Z"]],N=!0;break;case"densitymapbox":U=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],N="radial";break;case"cone":U=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],N=!1;break;case"streamtube":U=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],N=!1;break;case"surface":U=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],N=!0;break;case"mesh3d":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],N=!1;break;case"volume":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],N=!0;break;case"isosurface":U=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],N=!1;break}var q=w.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(U);q.enter().append("path").classed("legend3dandfriends",!0).attr("transform",k).style("stroke-miterlimit",1),q.exit().remove(),q.each(function(Q,W){var Z=w.select(this),ee=n(ie),te=ee.colorscale,ae=ee.reversescale,le=function(ge){if(ge.size()){var Ae="legendfill-"+ie.uid;e.gradient(ge,x,Ae,m(ae,N==="radial"),te,"fill")}},ye;if(te){if(!N){var pe=te.length;ye=W===0?te[ae?pe-1:0][1]:W===1?te[ae?0:pe-1][1]:te[Math.floor((pe-1)/2)][1]}}else{var fe=ie.vertexcolor||ie.facecolor||ie.color;ye=M.isArrayOrTypedArray(fe)?fe[W]||fe[0]:fe}Z.attr("d",Q[0]),ye?Z.call(a.fill,ye):Z.call(le)})}};function m(s,A){var x=A?"radial":"horizontal";return x+(s?"":"reversed")}function u(s){var A=s[0].trace,x=A.contours,v=r.hasLines(A),b=r.hasMarkers(A),l=A.visible&&A.fill&&A.fill!=="none",L=!1,S=!1;if(x){var k=x.coloring;k==="lines"?L=!0:v=k==="none"||k==="heatmap"||x.showlines,x.type==="constraint"?l=x._operation!=="=":(k==="fill"||k==="heatmap")&&(S=!0)}return{showMarker:b,showLine:v,showFill:l,showGradientLine:L,showGradientFill:S,anyLine:v||L,anyFill:l||S}}function _(s,A,x){return s&&M.isArrayOrTypedArray(s)?A:s>x?x:s}},{"../../lib":503,"../../registry":638,"../../traces/pie/helpers":906,"../../traces/pie/style_one":912,"../../traces/scatter/subtypes":952,"../color":366,"../colorscale/helpers":377,"../drawing":388,"./constants":417,"@plotly/d3":58}],425:[function(d,re,ne){d("./constants"),re.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":427}],426:[function(d,re,ne){var w=d("../../registry"),c=d("../../plots/plots"),M=d("../../plots/cartesian/axis_ids"),T=d("../../fonts/ploticon"),e=d("../shapes/draw").eraseActiveShape,a=d("../../lib"),n=a._,r=re.exports={};r.toImage={name:"toImage",title:function(s){var A=s._context.toImageButtonOptions||{},x=A.format||"png";return x==="png"?n(s,"Download plot as a png"):n(s,"Download plot")},icon:T.camera,click:function(s){var A=s._context.toImageButtonOptions,x={format:A.format||"png"};a.notifier(n(s,"Taking snapshot - this may take a few seconds"),"long"),x.format!=="svg"&&a.isIE()&&(a.notifier(n(s,"IE only supports svg.  Changing format to svg."),"long"),x.format="svg"),["filename","width","height","scale"].forEach(function(v){v in A&&(x[v]=A[v])}),w.call("downloadImage",s,x).then(function(v){a.notifier(n(s,"Snapshot succeeded")+" - "+v,"long")}).catch(function(){a.notifier(n(s,"Sorry, there was a problem downloading your snapshot!"),"long")})}},r.sendDataToCloud={name:"sendDataToCloud",title:function(s){return n(s,"Edit in Chart Studio")},icon:T.disk,click:function(s){c.sendDataToCloud(s)}},r.editInChartStudio={name:"editInChartStudio",title:function(s){return n(s,"Edit in Chart Studio")},icon:T.pencil,click:function(s){c.sendDataToCloud(s)}},r.zoom2d={name:"zoom2d",_cat:"zoom",title:function(s){return n(s,"Zoom")},attr:"dragmode",val:"zoom",icon:T.zoombox,click:t},r.pan2d={name:"pan2d",_cat:"pan",title:function(s){return n(s,"Pan")},attr:"dragmode",val:"pan",icon:T.pan,click:t},r.select2d={name:"select2d",_cat:"select",title:function(s){return n(s,"Box Select")},attr:"dragmode",val:"select",icon:T.selectbox,click:t},r.lasso2d={name:"lasso2d",_cat:"lasso",title:function(s){return n(s,"Lasso Select")},attr:"dragmode",val:"lasso",icon:T.lasso,click:t},r.drawclosedpath={name:"drawclosedpath",title:function(s){return n(s,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:T.drawclosedpath,click:t},r.drawopenpath={name:"drawopenpath",title:function(s){return n(s,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:T.drawopenpath,click:t},r.drawline={name:"drawline",title:function(s){return n(s,"Draw line")},attr:"dragmode",val:"drawline",icon:T.drawline,click:t},r.drawrect={name:"drawrect",title:function(s){return n(s,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:T.drawrect,click:t},r.drawcircle={name:"drawcircle",title:function(s){return n(s,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:T.drawcircle,click:t},r.eraseshape={name:"eraseshape",title:function(s){return n(s,"Erase active shape")},icon:T.eraseshape,click:e},r.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(s){return n(s,"Zoom in")},attr:"zoom",val:"in",icon:T.zoom_plus,click:t},r.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(s){return n(s,"Zoom out")},attr:"zoom",val:"out",icon:T.zoom_minus,click:t},r.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(s){return n(s,"Autoscale")},attr:"zoom",val:"auto",icon:T.autoscale,click:t},r.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(s){return n(s,"Reset axes")},attr:"zoom",val:"reset",icon:T.home,click:t},r.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(s){return n(s,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:T.tooltip_basic,gravity:"ne",click:t},r.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(s){return n(s,"Compare data on hover")},attr:"hovermode",val:function(s){return s._fullLayout._isHoriz?"y":"x"},icon:T.tooltip_compare,gravity:"ne",click:t};function t(s,A){var x=A.currentTarget,v=x.getAttribute("data-attr"),b=x.getAttribute("data-val")||!0,l=s._fullLayout,L={},S=M.list(s,null,!0),k=l._cartesianSpikesEnabled,P,z;if(v==="zoom"){var I=b==="in"?.5:2,D=(1+I)/2,R=(1-I)/2,B;for(z=0;z<S.length;z++)if(P=S[z],!P.fixedrange)if(B=P._name,b==="auto")L[B+".autorange"]=!0;else if(b==="reset"){if(P._rangeInitial===void 0)L[B+".autorange"]=!0;else{var F=P._rangeInitial.slice();L[B+".range[0]"]=F[0],L[B+".range[1]"]=F[1]}P._showSpikeInitial!==void 0&&(L[B+".showspikes"]=P._showSpikeInitial,k==="on"&&!P._showSpikeInitial&&(k="off"))}else{var V=[P.r2l(P.range[0]),P.r2l(P.range[1])],G=[D*V[0]+R*V[1],D*V[1]+R*V[0]];L[B+".range[0]"]=P.l2r(G[0]),L[B+".range[1]"]=P.l2r(G[1])}}else v==="hovermode"&&(b==="x"||b==="y")&&(b=l._isHoriz?"y":"x",x.setAttribute("data-val",b)),L[v]=b;l._cartesianSpikesEnabled=k,w.call("_guiRelayout",s,L)}r.zoom3d={name:"zoom3d",_cat:"zoom",title:function(s){return n(s,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:T.zoombox,click:f},r.pan3d={name:"pan3d",_cat:"pan",title:function(s){return n(s,"Pan")},attr:"scene.dragmode",val:"pan",icon:T.pan,click:f},r.orbitRotation={name:"orbitRotation",title:function(s){return n(s,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:T["3d_rotate"],click:f},r.tableRotation={name:"tableRotation",title:function(s){return n(s,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:T["z-axis"],click:f};function f(s,A){for(var x=A.currentTarget,v=x.getAttribute("data-attr"),b=x.getAttribute("data-val")||!0,l=s._fullLayout._subplots.gl3d||[],L={},S=v.split("."),k=0;k<l.length;k++)L[l[k]+"."+S[1]]=b;var P=b==="pan"?b:"zoom";L.dragmode=P,w.call("_guiRelayout",s,L)}r.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(s){return n(s,"Reset camera to default")},attr:"resetDefault",icon:T.home,click:o},r.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(s){return n(s,"Reset camera to last save")},attr:"resetLastSave",icon:T.movie,click:o};function o(s,A){for(var x=A.currentTarget,v=x.getAttribute("data-attr"),b=v==="resetLastSave",l=v==="resetDefault",L=s._fullLayout,S=L._subplots.gl3d||[],k={},P=0;P<S.length;P++){var z=S[P],I=z+".camera",D=z+".aspectratio",R=z+".aspectmode",B=L[z]._scene,F;b?(k[I+".up"]=B.viewInitial.up,k[I+".eye"]=B.viewInitial.eye,k[I+".center"]=B.viewInitial.center,F=!0):l&&(k[I+".up"]=null,k[I+".eye"]=null,k[I+".center"]=null,F=!0),F&&(k[D+".x"]=B.viewInitial.aspectratio.x,k[D+".y"]=B.viewInitial.aspectratio.y,k[D+".z"]=B.viewInitial.aspectratio.z,k[R]=B.viewInitial.aspectmode)}w.call("_guiRelayout",s,k)}r.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(s){return n(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:T.tooltip_basic,gravity:"ne",click:g};function i(s,A){var x=A.currentTarget,v=x._previousVal,b=s._fullLayout,l=b._subplots.gl3d||[],L=["xaxis","yaxis","zaxis"],S={},k={};if(v)k=v,x._previousVal=null;else{for(var P=0;P<l.length;P++){var z=l[P],I=b[z],D=z+".hovermode";S[D]=I.hovermode,k[D]=!1;for(var R=0;R<3;R++){var B=L[R],F=z+"."+B+".showspikes";k[F]=!1,S[F]=I[B].showspikes}}x._previousVal=S}return k}function g(s,A){var x=i(s,A);w.call("_guiRelayout",s,x)}r.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(s){return n(s,"Zoom in")},attr:"zoom",val:"in",icon:T.zoom_plus,click:p},r.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(s){return n(s,"Zoom out")},attr:"zoom",val:"out",icon:T.zoom_minus,click:p},r.resetGeo={name:"resetGeo",_cat:"reset",title:function(s){return n(s,"Reset")},attr:"reset",val:null,icon:T.autoscale,click:p},r.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(s){return n(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:T.tooltip_basic,gravity:"ne",click:h};function p(s,A){for(var x=A.currentTarget,v=x.getAttribute("data-attr"),b=x.getAttribute("data-val")||!0,l=s._fullLayout,L=l._subplots.geo||[],S=0;S<L.length;S++){var k=L[S],P=l[k];if(v==="zoom"){var z=P.projection.scale,I=b==="in"?2*z:.5*z;w.call("_guiRelayout",s,k+".projection.scale",I)}}v==="reset"&&_(s,"geo")}r.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(s){return n(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:T.tooltip_basic,gravity:"ne",click:h},r.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(s){return n(s,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:T.tooltip_basic,gravity:"ne",click:h};function y(s){var A=s._fullLayout;return A.hovermode?!1:A._has("cartesian")?A._isHoriz?"y":"x":"closest"}function h(s){var A=y(s);w.call("_guiRelayout",s,"hovermode",A)}r.resetViewSankey={name:"resetSankeyGroup",title:function(s){return n(s,"Reset view")},icon:T.home,click:function(s){for(var A={"node.groups":[],"node.x":[],"node.y":[]},x=0;x<s._fullData.length;x++){var v=s._fullData[x]._viewInitial;A["node.groups"].push(v.node.groups.slice()),A["node.x"].push(v.node.x.slice()),A["node.y"].push(v.node.y.slice())}w.call("restyle",s,A)}},r.toggleHover={name:"toggleHover",title:function(s){return n(s,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:T.tooltip_basic,gravity:"ne",click:function(s,A){var x=i(s,A);x.hovermode=y(s),w.call("_guiRelayout",s,x)}},r.resetViews={name:"resetViews",title:function(s){return n(s,"Reset views")},icon:T.home,click:function(s,A){var x=A.currentTarget;x.setAttribute("data-attr","zoom"),x.setAttribute("data-val","reset"),t(s,A),x.setAttribute("data-attr","resetLastSave"),o(s,A),_(s,"geo"),_(s,"mapbox")}},r.toggleSpikelines={name:"toggleSpikelines",title:function(s){return n(s,"Toggle Spike Lines")},icon:T.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(s){var A=s._fullLayout,x=A._cartesianSpikesEnabled;A._cartesianSpikesEnabled=x==="on"?"off":"on",w.call("_guiRelayout",s,m(s))}};function m(s){for(var A=s._fullLayout,x=A._cartesianSpikesEnabled==="on",v=M.list(s,null,!0),b={},l=0;l<v.length;l++){var L=v[l];b[L._name+".showspikes"]=x?!0:L._showSpikeInitial}return b}r.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(s){return n(s,"Reset view")},attr:"reset",icon:T.home,click:function(s){_(s,"mapbox")}},r.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(s){return n(s,"Zoom in")},attr:"zoom",val:"in",icon:T.zoom_plus,click:u},r.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(s){return n(s,"Zoom out")},attr:"zoom",val:"out",icon:T.zoom_minus,click:u};function u(s,A){for(var x=A.currentTarget,v=x.getAttribute("data-val"),b=s._fullLayout,l=b._subplots.mapbox||[],L=1.05,S={},k=0;k<l.length;k++){var P=l[k],z=b[P].zoom,I=v==="in"?L*z:z/L;S[P+".zoom"]=I}w.call("_guiRelayout",s,S)}function _(s,A){for(var x=s._fullLayout,v=x._subplots[A]||[],b={},l=0;l<v.length;l++)for(var L=v[l],S=x[L]._subplot,k=S.viewInitial,P=Object.keys(k),z=0;z<P.length;z++){var I=P[z];b[L+"."+I]=k[I]}w.call("_guiRelayout",s,b)}},{"../../fonts/ploticon":482,"../../lib":503,"../../plots/cartesian/axis_ids":558,"../../plots/plots":619,"../../registry":638,"../shapes/draw":450}],427:[function(d,re,ne){var w=d("./buttons"),c=Object.keys(w),M=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],T=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(M),e=[],a=function(n){if(T.indexOf(n._cat||n.name)===-1){var r=n.name,t=(n._cat||n.name).toLowerCase();e.indexOf(r)===-1&&e.push(r),e.indexOf(t)===-1&&e.push(t)}};c.forEach(function(n){a(w[n])}),e.sort(),re.exports={DRAW_MODES:M,backButtons:T,foreButtons:e}},{"./buttons":426}],428:[function(d,re,ne){var w=d("../../lib"),c=d("../color"),M=d("../../plot_api/plot_template"),T=d("./attributes");re.exports=function(a,n){var r=a.modebar||{},t=M.newContainer(n,"modebar");function f(i,g){return w.coerce(r,t,T,i,g)}f("orientation"),f("bgcolor",c.addOpacity(n.paper_bgcolor,.5));var o=c.contrast(c.rgb(n.modebar.bgcolor));f("color",c.addOpacity(o,.3)),f("activecolor",c.addOpacity(o,.7)),f("uirevision",n.uirevision),f("add"),f("remove")}},{"../../lib":503,"../../plot_api/plot_template":543,"../color":366,"./attributes":425}],429:[function(d,re,ne){re.exports={moduleType:"component",name:"modebar",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),manage:d("./manage")}},{"./attributes":425,"./defaults":428,"./manage":430}],430:[function(d,re,ne){var w=d("../../plots/cartesian/axis_ids"),c=d("../../traces/scatter/subtypes"),M=d("../../registry"),T=d("../fx/helpers").isUnifiedHover,e=d("./modebar"),a=d("./buttons"),n=d("./constants").DRAW_MODES;re.exports=function(y){var h=y._fullLayout,m=y._context,u=h._modeBar;if(!m.displayModeBar&&!m.watermark){u&&(u.destroy(),delete h._modeBar);return}if(!Array.isArray(m.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(m.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var _=m.modeBarButtons,s;Array.isArray(_)&&_.length?s=g(_):!m.displayModeBar&&m.watermark?s=[]:s=r(y),u?u.update(y,s):h._modeBar=e(y,s)};function r(p){var y=p._fullLayout,h=p._fullData,m=p._context;function u(Q,W){if(typeof W=="string"){if(W.toLowerCase()===Q.toLowerCase())return!0}else{var Z=W.name,ee=W._cat||W.name;if(Z===Q||ee===Q.toLowerCase())return!0}return!1}var _=y.modebar.add;typeof _=="string"&&(_=[_]);var s=y.modebar.remove;typeof s=="string"&&(s=[s]);var A=m.modeBarButtonsToAdd.concat(_.filter(function(Q){for(var W=0;W<m.modeBarButtonsToRemove.length;W++)if(u(Q,m.modeBarButtonsToRemove[W]))return!1;return!0})),x=m.modeBarButtonsToRemove.concat(s.filter(function(Q){for(var W=0;W<m.modeBarButtonsToAdd.length;W++)if(u(Q,m.modeBarButtonsToAdd[W]))return!1;return!0})),v=y._has("cartesian"),b=y._has("gl3d"),l=y._has("geo"),L=y._has("pie"),S=y._has("funnelarea"),k=y._has("gl2d"),P=y._has("ternary"),z=y._has("mapbox"),I=y._has("polar"),D=y._has("smith"),R=y._has("sankey"),B=t(y),F=T(y.hovermode),V=[];function G(Q){if(!!Q.length){for(var W=[],Z=0;Z<Q.length;Z++){for(var ee=Q[Z],te=a[ee],ae=te.name.toLowerCase(),le=(te._cat||te.name).toLowerCase(),ye=!1,fe=0;fe<x.length;fe++){var pe=x[fe].toLowerCase();if(pe===ae||pe===le){ye=!0;break}}ye||W.push(a[ee])}V.push(W)}}var J=["toImage"];m.showEditInChartStudio?J.push("editInChartStudio"):m.showSendToCloud&&J.push("sendDataToCloud"),G(J);var j=[],Y=[],X=[],oe=[];(v||k||L||S||P)+l+b+z+I+D>1?(Y=["toggleHover"],X=["resetViews"]):l?(j=["zoomInGeo","zoomOutGeo"],Y=["hoverClosestGeo"],X=["resetGeo"]):b?(Y=["hoverClosest3d"],X=["resetCameraDefault3d","resetCameraLastSave3d"]):z?(j=["zoomInMapbox","zoomOutMapbox"],Y=["toggleHover"],X=["resetViewMapbox"]):k?Y=["hoverClosestGl2d"]:L?Y=["hoverClosestPie"]:R?(Y=["hoverClosestCartesian","hoverCompareCartesian"],X=["resetViewSankey"]):Y=["toggleHover"],v&&(Y=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(o(h)||F)&&(Y=[]),(v||k)&&!B&&(j=["zoomIn2d","zoomOut2d","autoScale2d"],X[0]!=="resetViews"&&(X=["resetScale2d"])),b?oe=["zoom3d","pan3d","orbitRotation","tableRotation"]:(v||k)&&!B||P?oe=["zoom2d","pan2d"]:z||l?oe=["pan2d"]:I&&(oe=["zoom2d"]),f(h)&&oe.push("select2d","lasso2d");var se=[],ie=function(Q){se.indexOf(Q)===-1&&Y.indexOf(Q)!==-1&&se.push(Q)};if(Array.isArray(A)){for(var N=[],U=0;U<A.length;U++){var q=A[U];typeof q=="string"?(q=q.toLowerCase(),n.indexOf(q)!==-1?(y._has("mapbox")||y._has("cartesian"))&&oe.push(q):q==="togglespikelines"?ie("toggleSpikelines"):q==="togglehover"?ie("toggleHover"):q==="hovercompare"?ie("hoverCompareCartesian"):q==="hoverclosest"?(ie("hoverClosestCartesian"),ie("hoverClosestGeo"),ie("hoverClosest3d"),ie("hoverClosestGl2d"),ie("hoverClosestPie")):q==="v1hovermode"&&(ie("toggleHover"),ie("hoverClosestCartesian"),ie("hoverCompareCartesian"),ie("hoverClosestGeo"),ie("hoverClosest3d"),ie("hoverClosestGl2d"),ie("hoverClosestPie"))):N.push(q)}A=N}return G(oe),G(j.concat(X)),G(se),i(V,A)}function t(p){for(var y=w.list({_fullLayout:p},null,!0),h=0;h<y.length;h++)if(!y[h].fixedrange)return!1;return!0}function f(p){for(var y=!1,h=0;h<p.length&&!y;h++){var m=p[h];!m._module||!m._module.selectPoints||(M.traceIs(m,"scatter-like")?(c.hasMarkers(m)||c.hasText(m))&&(y=!0):M.traceIs(m,"box-violin")?(m.boxpoints==="all"||m.points==="all")&&(y=!0):y=!0)}return y}function o(p){for(var y=0;y<p.length;y++)if(!M.traceIs(p[y],"noHover"))return!1;return!0}function i(p,y){if(y.length)if(Array.isArray(y[0]))for(var h=0;h<y.length;h++)p.push(y[h]);else p.push(y);return p}function g(p){for(var y=0;y<p.length;y++)for(var h=p[y],m=0;m<h.length;m++){var u=h[m];if(typeof u=="string")if(a[u]!==void 0)p[y][m]=a[u];else throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}return p}},{"../../plots/cartesian/axis_ids":558,"../../registry":638,"../../traces/scatter/subtypes":952,"../fx/helpers":402,"./buttons":426,"./constants":427,"./modebar":431}],431:[function(d,re,ne){var w=d("@plotly/d3"),c=d("fast-isnumeric"),M=d("../../lib"),T=d("../../fonts/ploticon"),e=d("../../version").version,a=new DOMParser;function n(o){this.container=o.container,this.element=document.createElement("div"),this.update(o.graphInfo,o.buttons),this.container.appendChild(this.element)}var r=n.prototype;r.update=function(o,i){this.graphInfo=o;var g=this.graphInfo._context,p=this.graphInfo._fullLayout,y="modebar-"+p._uid;this.element.setAttribute("id",y),this._uid=y,this.element.className="modebar",g.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),p.modebar.orientation==="v"&&(this.element.className+=" vertical",i=i.reverse());var h=p.modebar,m=g.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";M.deleteRelatedStyleRule(y),M.addRelatedStyleRule(y,m+"#"+y+" .modebar-group","background-color: "+h.bgcolor),M.addRelatedStyleRule(y,"#"+y+" .modebar-btn .icon path","fill: "+h.color),M.addRelatedStyleRule(y,"#"+y+" .modebar-btn:hover .icon path","fill: "+h.activecolor),M.addRelatedStyleRule(y,"#"+y+" .modebar-btn.active .icon path","fill: "+h.activecolor);var u=!this.hasButtons(i),_=this.hasLogo!==g.displaylogo,s=this.locale!==g.locale;if(this.locale=g.locale,(u||_||s)&&(this.removeAllButtons(),this.updateButtons(i),g.watermark||g.displaylogo)){var A=this.getLogo();g.watermark&&(A.className=A.className+" watermark"),p.modebar.orientation==="v"?this.element.insertBefore(A,this.element.childNodes[0]):this.element.appendChild(A),this.hasLogo=!0}this.updateActiveButton()},r.updateButtons=function(o){var i=this;this.buttons=o,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(g){var p=i.createGroup();g.forEach(function(y){var h=y.name;if(!h)throw new Error("must provide button 'name' in button config");if(i.buttonsNames.indexOf(h)!==-1)throw new Error("button name '"+h+"' is taken");i.buttonsNames.push(h);var m=i.createButton(y);i.buttonElements.push(m),p.appendChild(m)}),i.element.appendChild(p)})},r.createGroup=function(){var o=document.createElement("div");return o.className="modebar-group",o},r.createButton=function(o){var i=this,g=document.createElement("a");g.setAttribute("rel","tooltip"),g.className="modebar-btn";var p=o.title;p===void 0?p=o.name:typeof p=="function"&&(p=p(this.graphInfo)),(p||p===0)&&g.setAttribute("data-title",p),o.attr!==void 0&&g.setAttribute("data-attr",o.attr);var y=o.val;y!==void 0&&(typeof y=="function"&&(y=y(this.graphInfo)),g.setAttribute("data-val",y));var h=o.click;if(typeof h!="function")throw new Error("must provide button 'click' function in button config");g.addEventListener("click",function(u){o.click(i.graphInfo,u),i.updateActiveButton(u.currentTarget)}),g.setAttribute("data-toggle",o.toggle||!1),o.toggle&&w.select(g).classed("active",!0);var m=o.icon;return typeof m=="function"?g.appendChild(m()):g.appendChild(this.createIcon(m||T.question)),g.setAttribute("data-gravity",o.gravity||"n"),g},r.createIcon=function(o){var i=c(o.height)?Number(o.height):o.ascent-o.descent,g="http://www.w3.org/2000/svg",p;if(o.path){p=document.createElementNS(g,"svg"),p.setAttribute("viewBox",[0,0,o.width,i].join(" ")),p.setAttribute("class","icon");var y=document.createElementNS(g,"path");y.setAttribute("d",o.path),o.transform?y.setAttribute("transform",o.transform):o.ascent!==void 0&&y.setAttribute("transform","matrix(1 0 0 -1 0 "+o.ascent+")"),p.appendChild(y)}if(o.svg){var h=a.parseFromString(o.svg,"application/xml");p=h.childNodes[0]}return p.setAttribute("height","1em"),p.setAttribute("width","1em"),p},r.updateActiveButton=function(o){var i=this.graphInfo._fullLayout,g=o!==void 0?o.getAttribute("data-attr"):null;this.buttonElements.forEach(function(p){var y=p.getAttribute("data-val")||!0,h=p.getAttribute("data-attr"),m=p.getAttribute("data-toggle")==="true",u=w.select(p);if(m)h===g&&u.classed("active",!u.classed("active"));else{var _=h===null?h:M.nestedProperty(i,h).get();u.classed("active",_===y)}})},r.hasButtons=function(o){var i=this.buttons;if(!i||o.length!==i.length)return!1;for(var g=0;g<o.length;++g){if(o[g].length!==i[g].length)return!1;for(var p=0;p<o[g].length;p++)if(o[g][p].name!==i[g][p].name)return!1}return!0};function t(o){return o+" (v"+e+")"}r.getLogo=function(){var o=this.createGroup(),i=document.createElement("a");return i.href="https://plotly.com/",i.target="_blank",i.setAttribute("data-title",t(M._(this.graphInfo,"Produced with Plotly.js"))),i.className="modebar-btn plotlyjsicon modebar-btn--logo",i.appendChild(this.createIcon(T.newplotlylogo)),o.appendChild(i),o},r.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},r.destroy=function(){M.removeElement(this.container.querySelector(".modebar")),M.deleteRelatedStyleRule(this._uid)};function f(o,i){var g=o._fullLayout,p=new n({graphInfo:o,container:g._modebardiv.node(),buttons:i});return g._privateplot&&w.select(p.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),p}re.exports=f},{"../../fonts/ploticon":482,"../../lib":503,"../../version":1123,"@plotly/d3":58,"fast-isnumeric":190}],432:[function(d,re,ne){var w=d("../../plots/font_attributes"),c=d("../color/attributes"),M=d("../../plot_api/plot_template").templatedArray,T=M("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});re.exports={visible:{valType:"boolean",editType:"plot"},buttons:T,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:w({editType:"plot"}),bgcolor:{valType:"color",dflt:c.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:c.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":543,"../../plots/font_attributes":585,"../color/attributes":365}],433:[function(d,re,ne){re.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],434:[function(d,re,ne){var w=d("../../lib"),c=d("../color"),M=d("../../plot_api/plot_template"),T=d("../../plots/array_container_defaults"),e=d("./attributes"),a=d("./constants");re.exports=function(f,o,i,g,p){var y=f.rangeselector||{},h=M.newContainer(o,"rangeselector");function m(x,v){return w.coerce(y,h,e,x,v)}var u=T(y,h,{name:"buttons",handleItemDefaults:n,calendar:p}),_=m("visible",u.length>0);if(_){var s=r(o,i,g);m("x",s[0]),m("y",s[1]),w.noneOrAll(f,o,["x","y"]),m("xanchor"),m("yanchor"),w.coerceFont(m,"font",i.font);var A=m("bgcolor");m("activecolor",c.contrast(A,a.lightAmount,a.darkAmount)),m("bordercolor"),m("borderwidth")}};function n(t,f,o,i){var g=i.calendar;function p(m,u){return w.coerce(t,f,e.buttons,m,u)}var y=p("visible");if(y){var h=p("step");h!=="all"&&(g&&g!=="gregorian"&&(h==="month"||h==="year")?f.stepmode="backward":p("stepmode"),p("count")),p("label")}}function r(t,f,o){for(var i=o.filter(function(h){return f[h].anchor===t._id}),g=0,p=0;p<i.length;p++){var y=f[i[p]].domain;y&&(g=Math.max(y[1],g))}return[t.domain[0],g+a.yPad]}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/array_container_defaults":549,"../color":366,"./attributes":432,"./constants":433}],435:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../registry"),M=d("../../plots/plots"),T=d("../color"),e=d("../drawing"),a=d("../../lib"),n=a.strTranslate,r=d("../../lib/svg_text_utils"),t=d("../../plots/cartesian/axis_ids"),f=d("../../constants/alignment"),o=f.LINE_SPACING,i=f.FROM_TL,g=f.FROM_BR,p=d("./constants"),y=d("./get_update_object");re.exports=function(l){var L=l._fullLayout,S=L._infolayer.selectAll(".rangeselector").data(h(l),m);S.enter().append("g").classed("rangeselector",!0),S.exit().remove(),S.style({cursor:"pointer","pointer-events":"all"}),S.each(function(k){var P=w.select(this),z=k,I=z.rangeselector,D=P.selectAll("g.button").data(a.filterVisible(I.buttons));D.enter().append("g").classed("button",!0),D.exit().remove(),D.each(function(R){var B=w.select(this),F=y(z,R);R._isActive=u(z,R,F),B.call(_,I,R),B.call(A,I,R,l),B.on("click",function(){l._dragged||c.call("_guiRelayout",l,F)}),B.on("mouseover",function(){R._isHovered=!0,B.call(_,I,R)}),B.on("mouseout",function(){R._isHovered=!1,B.call(_,I,R)})}),v(l,D,I,z._name,P)})};function h(b){for(var l=t.list(b,"x",!0),L=[],S=0;S<l.length;S++){var k=l[S];k.rangeselector&&k.rangeselector.visible&&L.push(k)}return L}function m(b){return b._id}function u(b,l,L){if(l.step==="all")return b.autorange===!0;var S=Object.keys(L);return b.range[0]===L[S[0]]&&b.range[1]===L[S[1]]}function _(b,l,L){var S=a.ensureSingle(b,"rect","selector-rect",function(k){k.attr("shape-rendering","crispEdges")});S.attr({rx:p.rx,ry:p.ry}),S.call(T.stroke,l.bordercolor).call(T.fill,s(l,L)).style("stroke-width",l.borderwidth+"px")}function s(b,l){return l._isActive||l._isHovered?b.activecolor:b.bgcolor}function A(b,l,L,S){function k(z){r.convertToTspans(z,S)}var P=a.ensureSingle(b,"text","selector-text",function(z){z.attr("text-anchor","middle")});P.call(e.font,l.font).text(x(L,S._fullLayout._meta)).call(k)}function x(b,l){return b.label?l?a.templateString(b.label,l):b.label:b.step==="all"?"all":b.count+b.step.charAt(0)}function v(b,l,L,S,k){var P=0,z=0,I=L.borderwidth;l.each(function(){var G=w.select(this),J=G.select(".selector-text"),j=L.font.size*o,Y=Math.max(j*r.lineCount(J),16)+3;z=Math.max(z,Y)}),l.each(function(){var G=w.select(this),J=G.select(".selector-rect"),j=G.select(".selector-text"),Y=j.node()&&e.bBox(j.node()).width,X=L.font.size*o,oe=r.lineCount(j),se=Math.max(Y+10,p.minButtonWidth);G.attr("transform",n(I+P,I)),J.attr({x:0,y:0,width:se,height:z}),r.positionText(j,se/2,z/2-(oe-1)*X/2+3),P+=se+5});var D=b._fullLayout._size,R=D.l+D.w*L.x,B=D.t+D.h*(1-L.y),F="left";a.isRightAnchor(L)&&(R-=P,F="right"),a.isCenterAnchor(L)&&(R-=P/2,F="center");var V="top";a.isBottomAnchor(L)&&(B-=z,V="bottom"),a.isMiddleAnchor(L)&&(B-=z/2,V="middle"),P=Math.ceil(P),z=Math.ceil(z),R=Math.round(R),B=Math.round(B),M.autoMargin(b,S+"-range-selector",{x:L.x,y:L.y,l:P*i[F],r:P*g[F],b:z*g[V],t:z*i[V]}),k.attr("transform",n(R,B))}},{"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axis_ids":558,"../../plots/plots":619,"../../registry":638,"../color":366,"../drawing":388,"./constants":433,"./get_update_object":436,"@plotly/d3":58}],436:[function(d,re,ne){var w=d("d3-time"),c=d("../../lib").titleCase;re.exports=function(e,a){var n=e._name,r={};if(a.step==="all")r[n+".autorange"]=!0;else{var t=M(e,a);r[n+".range[0]"]=t[0],r[n+".range[1]"]=t[1]}return r};function M(T,e){var a=T.range,n=new Date(T.r2l(a[1])),r=e.step,t=w["utc"+c(r)],f=e.count,o;switch(e.stepmode){case"backward":o=T.l2r(+t.offset(n,-f));break;case"todate":var i=t.offset(n,-f);o=T.l2r(+t.ceil(i));break}var g=a[1];return[o,g]}},{"../../lib":503,"d3-time":122}],437:[function(d,re,ne){re.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:d("./attributes")}}},layoutAttributes:d("./attributes"),handleDefaults:d("./defaults"),draw:d("./draw")}},{"./attributes":432,"./defaults":434,"./draw":435}],438:[function(d,re,ne){var w=d("../color/attributes");re.exports={bgcolor:{valType:"color",dflt:w.background,editType:"plot"},bordercolor:{valType:"color",dflt:w.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":365}],439:[function(d,re,ne){var w=d("../../plots/cartesian/axis_ids").list,c=d("../../plots/cartesian/autorange").getAutoRange,M=d("./constants");re.exports=function(e){for(var a=w(e,"x",!0),n=0;n<a.length;n++){var r=a[n],t=r[M.name];t&&t.visible&&t.autorange&&(t._input.autorange=!0,t._input.range=t.range=c(e,r))}}},{"../../plots/cartesian/autorange":553,"../../plots/cartesian/axis_ids":558,"./constants":440}],440:[function(d,re,ne){re.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],441:[function(d,re,ne){var w=d("../../lib"),c=d("../../plot_api/plot_template"),M=d("../../plots/cartesian/axis_ids"),T=d("./attributes"),e=d("./oppaxis_attributes");re.exports=function(n,r,t){var f=n[t],o=r[t];if(!(f.rangeslider||r._requestRangeslider[o._id]))return;w.isPlainObject(f.rangeslider)||(f.rangeslider={});var i=f.rangeslider,g=c.newContainer(o,"rangeslider");function p(S,k){return w.coerce(i,g,T,S,k)}var y,h;function m(S,k){return w.coerce(y,h,e,S,k)}var u=p("visible");if(!!u){p("bgcolor",r.plot_bgcolor),p("bordercolor"),p("borderwidth"),p("thickness"),p("autorange",!o.isValidRange(i.range)),p("range");var _=r._subplots;if(_)for(var s=_.cartesian.filter(function(S){return S.substr(0,S.indexOf("y"))===M.name2id(t)}).map(function(S){return S.substr(S.indexOf("y"),S.length)}),A=w.simpleMap(s,M.id2name),x=0;x<A.length;x++){var v=A[x];y=i[v]||{},h=c.newContainer(g,v,"yaxis");var b=r[v],l;y.range&&b.isValidRange(y.range)&&(l="fixed");var L=m("rangemode",l);L!=="match"&&m("range",b.range.slice())}g._input=i}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_ids":558,"./attributes":438,"./oppaxis_attributes":445}],442:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../registry"),M=d("../../plots/plots"),T=d("../../lib"),e=T.strTranslate,a=d("../drawing"),n=d("../color"),r=d("../titles"),t=d("../../plots/cartesian"),f=d("../../plots/cartesian/axis_ids"),o=d("../dragelement"),i=d("../../lib/setcursor"),g=d("./constants");re.exports=function(b){for(var l=b._fullLayout,L=l._rangeSliderData,S=0;S<L.length;S++){var k=L[S][g.name];k._clipId=k._id+"-"+l._uid}function P(I){return I._name}var z=l._infolayer.selectAll("g."+g.containerClassName).data(L,P);z.exit().each(function(I){var D=I[g.name];l._topdefs.select("#"+D._clipId).remove()}).remove(),L.length!==0&&(z.enter().append("g").classed(g.containerClassName,!0).attr("pointer-events","all"),z.each(function(I){var D=w.select(this),R=I[g.name],B=l[f.id2name(I.anchor)],F=R[f.id2name(I.anchor)];if(R.range){var V=T.simpleMap(R.range,I.r2l),G=T.simpleMap(I.range,I.r2l),J;G[0]<G[1]?J=[Math.min(V[0],G[0]),Math.max(V[1],G[1])]:J=[Math.max(V[0],G[0]),Math.min(V[1],G[1])],R.range=R._input.range=T.simpleMap(J,I.l2r)}I.cleanRange("rangeslider.range");var j=l._size,Y=I.domain;R._width=j.w*(Y[1]-Y[0]);var X=Math.round(j.l+j.w*Y[0]),oe=Math.round(j.t+j.h*(1-I._counterDomainMin)+(I.side==="bottom"?I._depth:0)+R._offsetShift+g.extraPad);D.attr("transform",e(X,oe)),R._rl=T.simpleMap(R.range,I.r2l);var se=R._rl[0],ie=R._rl[1],N=ie-se;if(R.p2d=function(ye){return ye/R._width*N+se},R.d2p=function(ye){return(ye-se)/N*R._width},I.rangebreaks){var U=I.locateBreaks(se,ie);if(U.length){var q,Q,W=0;for(q=0;q<U.length;q++)Q=U[q],W+=Q.max-Q.min;var Z=R._width/(ie-se-W),ee=[-Z*se];for(q=0;q<U.length;q++)Q=U[q],ee.push(ee[ee.length-1]-Z*(Q.max-Q.min));for(R.d2p=function(ye){for(var fe=ee[0],pe=0;pe<U.length;pe++){var ge=U[pe];if(ye>=ge.max)fe=ee[pe+1];else if(ye<ge.min)break}return fe+Z*ye},q=0;q<U.length;q++)Q=U[q],Q.pmin=R.d2p(Q.min),Q.pmax=R.d2p(Q.max);R.p2d=function(ye){for(var fe=ee[0],pe=0;pe<U.length;pe++){var ge=U[pe];if(ye>=ge.pmax)fe=ee[pe+1];else if(ye<ge.pmin)break}return(ye-fe)/Z}}}if(F.rangemode!=="match"){var te=B.r2l(F.range[0]),ae=B.r2l(F.range[1]),le=ae-te;R.d2pOppAxis=function(ye){return(ye-te)/le*R._height}}D.call(m,b,I,R).call(u,b,I,R).call(_,b,I,R).call(A,b,I,R,F).call(x,b,I,R).call(v,b,I,R),p(D,b,I,R),h(D,b,I,R,B,F),I.side==="bottom"&&r.draw(b,I._id+"title",{propContainer:I,propName:I._name+".title",placeholder:l._dfltTitle.x,attributes:{x:I._offset+I._length/2,y:oe+R._height+R._offsetShift+10+1.5*I.title.font.size,"text-anchor":"middle"}})}))};function p(b,l,L,S){if(l._context.staticPlot)return;var k=b.select("rect."+g.slideBoxClassName).node(),P=b.select("rect."+g.grabAreaMinClassName).node(),z=b.select("rect."+g.grabAreaMaxClassName).node();function I(){var D=w.event,R=D.target,B=D.clientX||D.touches[0].clientX,F=B-b.node().getBoundingClientRect().left,V=S.d2p(L._rl[0]),G=S.d2p(L._rl[1]),J=o.coverSlip();this.addEventListener("touchmove",j),this.addEventListener("touchend",Y),J.addEventListener("mousemove",j),J.addEventListener("mouseup",Y);function j(X){var oe=X.clientX||X.touches[0].clientX,se=+oe-B,ie,N,U;switch(R){case k:U="ew-resize",ie=V+se,N=G+se;break;case P:U="col-resize",ie=V+se,N=G;break;case z:U="col-resize",ie=V,N=G+se;break;default:U="ew-resize",ie=F,N=F+se;break}if(N<ie){var q=N;N=ie,ie=q}S._pixelMin=ie,S._pixelMax=N,i(w.select(J),U),y(b,l,L,S)}function Y(){J.removeEventListener("mousemove",j),J.removeEventListener("mouseup",Y),this.removeEventListener("touchmove",j),this.removeEventListener("touchend",Y),T.removeElement(J)}}b.on("mousedown",I),b.on("touchstart",I)}function y(b,l,L,S){function k(I){return L.l2r(T.constrain(I,S._rl[0],S._rl[1]))}var P=k(S.p2d(S._pixelMin)),z=k(S.p2d(S._pixelMax));window.requestAnimationFrame(function(){c.call("_guiRelayout",l,L._name+".range",[P,z])})}function h(b,l,L,S,k,P){var z=g.handleWidth/2;function I(X){return T.constrain(X,0,S._width)}function D(X){return T.constrain(X,0,S._height)}function R(X){return T.constrain(X,-z,S._width+z)}var B=I(S.d2p(L._rl[0])),F=I(S.d2p(L._rl[1]));if(b.select("rect."+g.slideBoxClassName).attr("x",B).attr("width",F-B),b.select("rect."+g.maskMinClassName).attr("width",B),b.select("rect."+g.maskMaxClassName).attr("x",F).attr("width",S._width-F),P.rangemode!=="match"){var V=S._height-D(S.d2pOppAxis(k._rl[1])),G=S._height-D(S.d2pOppAxis(k._rl[0]));b.select("rect."+g.maskMinOppAxisClassName).attr("x",B).attr("height",V).attr("width",F-B),b.select("rect."+g.maskMaxOppAxisClassName).attr("x",B).attr("y",G).attr("height",S._height-G).attr("width",F-B),b.select("rect."+g.slideBoxClassName).attr("y",V).attr("height",G-V)}var J=.5,j=Math.round(R(B-z))-J,Y=Math.round(R(F-z))+J;b.select("g."+g.grabberMinClassName).attr("transform",e(j,J)),b.select("g."+g.grabberMaxClassName).attr("transform",e(Y,J))}function m(b,l,L,S){var k=T.ensureSingle(b,"rect",g.bgClassName,function(D){D.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),P=S.borderwidth%2===0?S.borderwidth:S.borderwidth-1,z=-S._offsetShift,I=a.crispRound(l,S.borderwidth);k.attr({width:S._width+P,height:S._height+P,transform:e(z,z),fill:S.bgcolor,stroke:S.bordercolor,"stroke-width":I})}function u(b,l,L,S){var k=l._fullLayout,P=T.ensureSingleById(k._topdefs,"clipPath",S._clipId,function(z){z.append("rect").attr({x:0,y:0})});P.select("rect").attr({width:S._width,height:S._height})}function _(b,l,L,S){var k=l.calcdata,P=b.selectAll("g."+g.rangePlotClassName).data(L._subplotsWith,T.identity);P.enter().append("g").attr("class",function(I){return g.rangePlotClassName+" "+I}).call(a.setClipUrl,S._clipId,l),P.order(),P.exit().remove();var z;P.each(function(I,D){var R=w.select(this),B=D===0,F=f.getFromId(l,I,"y"),V=F._name,G=S[V],J={data:[],layout:{xaxis:{type:L.type,domain:[0,1],range:S.range.slice(),calendar:L.calendar},width:S._width,height:S._height,margin:{t:0,b:0,l:0,r:0}},_context:l._context};L.rangebreaks&&(J.layout.xaxis.rangebreaks=L.rangebreaks),J.layout[V]={type:F.type,domain:[0,1],range:G.rangemode!=="match"?G.range.slice():F.range.slice(),calendar:F.calendar},F.rangebreaks&&(J.layout[V].rangebreaks=F.rangebreaks),M.supplyDefaults(J);var j=J._fullLayout.xaxis,Y=J._fullLayout[V];j.clearCalc(),j.setScale(),Y.clearCalc(),Y.setScale();var X={id:I,plotgroup:R,xaxis:j,yaxis:Y,isRangePlot:!0};B?z=X:(X.mainplot="xy",X.mainplotinfo=z),t.rangePlot(l,X,s(k,I))})}function s(b,l){for(var L=[],S=0;S<b.length;S++){var k=b[S],P=k[0].trace;P.xaxis+P.yaxis===l&&L.push(k)}return L}function A(b,l,L,S,k){var P=T.ensureSingle(b,"rect",g.maskMinClassName,function(R){R.attr({x:0,y:0,"shape-rendering":"crispEdges"})});P.attr("height",S._height).call(n.fill,g.maskColor);var z=T.ensureSingle(b,"rect",g.maskMaxClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});if(z.attr("height",S._height).call(n.fill,g.maskColor),k.rangemode!=="match"){var I=T.ensureSingle(b,"rect",g.maskMinOppAxisClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});I.attr("width",S._width).call(n.fill,g.maskOppAxisColor);var D=T.ensureSingle(b,"rect",g.maskMaxOppAxisClassName,function(R){R.attr({y:0,"shape-rendering":"crispEdges"})});D.attr("width",S._width).style("border-top",g.maskOppBorder).call(n.fill,g.maskOppAxisColor)}}function x(b,l,L,S){if(!l._context.staticPlot){var k=T.ensureSingle(b,"rect",g.slideBoxClassName,function(P){P.attr({y:0,cursor:g.slideBoxCursor,"shape-rendering":"crispEdges"})});k.attr({height:S._height,fill:g.slideBoxFill})}}function v(b,l,L,S){var k=T.ensureSingle(b,"g",g.grabberMinClassName),P=T.ensureSingle(b,"g",g.grabberMaxClassName),z={x:0,width:g.handleWidth,rx:g.handleRadius,fill:n.background,stroke:n.defaultLine,"stroke-width":g.handleStrokeWidth,"shape-rendering":"crispEdges"},I={y:Math.round(S._height/4),height:Math.round(S._height/2)},D=T.ensureSingle(k,"rect",g.handleMinClassName,function(G){G.attr(z)});D.attr(I);var R=T.ensureSingle(P,"rect",g.handleMaxClassName,function(G){G.attr(z)});R.attr(I);var B={width:g.grabAreaWidth,x:0,y:0,fill:g.grabAreaFill,cursor:l._context.staticPlot?void 0:g.grabAreaCursor},F=T.ensureSingle(k,"rect",g.grabAreaMinClassName,function(G){G.attr(B)});F.attr("height",S._height);var V=T.ensureSingle(P,"rect",g.grabAreaMaxClassName,function(G){G.attr(B)});V.attr("height",S._height)}},{"../../lib":503,"../../lib/setcursor":524,"../../plots/cartesian":568,"../../plots/cartesian/axis_ids":558,"../../plots/plots":619,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"../titles":464,"./constants":440,"@plotly/d3":58}],443:[function(d,re,ne){var w=d("../../plots/cartesian/axis_ids"),c=d("../../lib/svg_text_utils"),M=d("./constants"),T=d("../../constants/alignment").LINE_SPACING,e=M.name;function a(n){var r=n&&n[e];return r&&r.visible}ne.isVisible=a,ne.makeData=function(n){var r=w.list({_fullLayout:n},"x",!0),t=n.margin,f=[];if(!n._has("gl2d"))for(var o=0;o<r.length;o++){var i=r[o];if(a(i)){f.push(i);var g=i[e];g._id=e+i._id,g._height=(n.height-t.b-t.t)*g.thickness,g._offsetShift=Math.floor(g.borderwidth/2)}}n._rangeSliderData=f},ne.autoMarginOpts=function(n,r){var t=n._fullLayout,f=r[e],o=r._id.charAt(0),i=0,g=0;if(r.side==="bottom"&&(i=r._depth,r.title.text!==t._dfltTitle[o])){g=1.5*r.title.font.size+10+f._offsetShift;var p=(r.title.text.match(c.BR_TAG_ALL)||[]).length;g+=p*r.title.font.size*T}return{x:0,y:r._counterDomainMin,l:0,r:0,t:0,b:f._height+i+Math.max(t.margin.b,g),pad:M.extraPad+f._offsetShift*2}}},{"../../constants/alignment":471,"../../lib/svg_text_utils":529,"../../plots/cartesian/axis_ids":558,"./constants":440}],444:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes"),M=d("./oppaxis_attributes"),T=d("./helpers");re.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:w.extendFlat({},c,{yaxis:M})}}},layoutAttributes:d("./attributes"),handleDefaults:d("./defaults"),calcAutorange:d("./calc_autorange"),draw:d("./draw"),isVisible:T.isVisible,makeData:T.makeData,autoMarginOpts:T.autoMarginOpts}},{"../../lib":503,"./attributes":438,"./calc_autorange":439,"./defaults":441,"./draw":442,"./helpers":443,"./oppaxis_attributes":445}],445:[function(d,re,ne){re.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],446:[function(d,re,ne){var w=d("../annotations/attributes"),c=d("../../traces/scatter/attributes").line,M=d("../drawing/attributes").dash,T=d("../../lib/extend").extendFlat,e=d("../../plot_api/plot_template").templatedArray;d("../../constants/axis_placeable_objects"),re.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:T({},w.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:T({},w.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:T({},c.color,{editType:"arraydraw"}),width:T({},c.width,{editType:"calc+arraydraw"}),dash:T({},M,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":472,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../traces/scatter/attributes":927,"../annotations/attributes":349,"../drawing/attributes":387}],447:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes"),M=d("./constants"),T=d("./helpers");re.exports=function(f){var o=f._fullLayout,i=w.filterVisible(o.shapes);if(!(!i.length||!f._fullData.length))for(var g=0;g<i.length;g++){var p=i[g];p._extremes={};var y,h,m=c.getRefType(p.xref),u=c.getRefType(p.yref);if(p.xref!=="paper"&&m!=="domain"){var _=p.xsizemode==="pixel"?p.xanchor:p.x0,s=p.xsizemode==="pixel"?p.xanchor:p.x1;y=c.getFromId(f,p.xref),h=r(y,_,s,p.path,M.paramIsX),h&&(p._extremes[y._id]=c.findExtremes(y,h,e(p)))}if(p.yref!=="paper"&&u!=="domain"){var A=p.ysizemode==="pixel"?p.yanchor:p.y0,x=p.ysizemode==="pixel"?p.yanchor:p.y1;y=c.getFromId(f,p.yref),h=r(y,A,x,p.path,M.paramIsY),h&&(p._extremes[y._id]=c.findExtremes(y,h,a(p)))}}};function e(t){return n(t.line.width,t.xsizemode,t.x0,t.x1,t.path,!1)}function a(t){return n(t.line.width,t.ysizemode,t.y0,t.y1,t.path,!0)}function n(t,f,o,i,g,p){var y=t/2,h=p;if(f==="pixel"){var m=g?T.extractPathCoords(g,p?M.paramIsY:M.paramIsX):[o,i],u=w.aggNums(Math.max,null,m),_=w.aggNums(Math.min,null,m),s=_<0?Math.abs(_)+y:y,A=u>0?u+y:y;return{ppad:y,ppadplus:h?s:A,ppadminus:h?A:s}}else return{ppad:y}}function r(t,f,o,i,g){var p=t.type==="category"||t.type==="multicategory"?t.r2c:t.d2c;if(f!==void 0)return[p(f),p(o)];if(!!i){var y=1/0,h=-1/0,m=i.match(M.segmentRE),u,_,s,A,x;for(t.type==="date"&&(p=T.decodeDate(p)),u=0;u<m.length;u++)_=m[u],s=g[_.charAt(0)].drawn,s!==void 0&&(A=m[u].substr(1).match(M.paramRE),!(!A||A.length<s)&&(x=p(A[s]),x<y&&(y=x),x>h&&(h=x)));if(h>=y)return[y,h]}}},{"../../lib":503,"../../plots/cartesian/axes":554,"./constants":448,"./helpers":457}],448:[function(d,re,ne){re.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],449:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes"),M=d("../../plots/array_container_defaults"),T=d("./attributes"),e=d("./helpers");re.exports=function(r,t){M(r,t,{name:"shapes",handleItemDefaults:a})};function a(n,r,t){function f(V,G){return w.coerce(n,r,T,V,G)}var o=f("visible");if(!!o){var i=f("path"),g=i?"path":"rect",p=f("type",g);r.type!=="path"&&delete r.path,f("editable"),f("layer"),f("opacity"),f("fillcolor"),f("fillrule");var y=f("line.width");y&&(f("line.color"),f("line.dash"));for(var h=f("xsizemode"),m=f("ysizemode"),u=["x","y"],_=0;_<2;_++){var s=u[_],A=s+"anchor",x=s==="x"?h:m,v={_fullLayout:t},b,l,L,S=c.coerceRef(n,r,v,s,void 0,"paper"),k=c.getRefType(S);if(k==="range"?(b=c.getFromId(v,S),b._shapeIndices.push(r._index),L=e.rangeToShapePosition(b),l=e.shapePositionToRange(b)):l=L=w.identity,p!=="path"){var P=.25,z=.75,I=s+"0",D=s+"1",R=n[I],B=n[D];n[I]=l(n[I],!0),n[D]=l(n[D],!0),x==="pixel"?(f(I,0),f(D,10)):(c.coercePosition(r,v,f,S,I,P),c.coercePosition(r,v,f,S,D,z)),r[I]=L(r[I]),r[D]=L(r[D]),n[I]=R,n[D]=B}if(x==="pixel"){var F=n[A];n[A]=l(n[A],!0),c.coercePosition(r,v,f,S,A,.25),r[A]=L(r[A]),n[A]=F}}p==="path"?f("path"):w.noneOrAll(n,r,["x0","x1","y0","y1"])}}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"./attributes":446,"./helpers":457}],450:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib"),M=d("../../plots/cartesian/axes"),T=d("./draw_newshape/helpers").readPaths,e=d("./draw_newshape/display_outlines"),a=d("../../plots/cartesian/handle_outline").clearOutlineControllers,n=d("../color"),r=d("../drawing"),t=d("../../plot_api/plot_template").arrayEditor,f=d("../dragelement"),o=d("../../lib/setcursor"),i=d("./constants"),g=d("./helpers");re.exports={draw:p,drawOne:m,eraseActiveShape:l};function p(L){var S=L._fullLayout;S._shapeUpperLayer.selectAll("path").remove(),S._shapeLowerLayer.selectAll("path").remove();for(var k in S._plots){var P=S._plots[k].shapelayer;P&&P.selectAll("path").remove()}for(var z=0;z<S.shapes.length;z++)S.shapes[z].visible&&m(L,z)}function y(L){return!!L._fullLayout._drawing}function h(L){return!L._context.edits.shapePosition}function m(L,S){L._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+S+'"]').remove();var k=g.makeOptionsAndPlotinfo(L,S),P=k.options,z=k.plotinfo;if(!P._input||P.visible===!1)return;if(P.layer!=="below")D(L._fullLayout._shapeUpperLayer);else if(P.xref==="paper"||P.yref==="paper")D(L._fullLayout._shapeLowerLayer);else if(z._hadPlotinfo){var I=z.mainplotinfo||z;D(I.shapelayer)}else D(L._fullLayout._shapeLowerLayer);function D(R){var B=s(L,P),F={"data-index":S,"fill-rule":P.fillrule,d:B},V=P.opacity,G=P.fillcolor,J=P.line.width?P.line.color:"rgba(0,0,0,0)",j=P.line.width,Y=P.line.dash;!j&&P.editable===!0&&(j=5,Y="solid");var X=B[B.length-1]!=="Z",oe=h(L)&&P.editable&&L._fullLayout._activeShapeIndex===S;oe&&(G=X?"rgba(0,0,0,0)":L._fullLayout.activeshape.fillcolor,V=L._fullLayout.activeshape.opacity);var se=R.append("path").attr(F).style("opacity",V).call(n.stroke,J).call(n.fill,G).call(r.dashLine,Y,j);u(se,L,P);var ie;if((oe||L._context.edits.shapePosition)&&(ie=t(L.layout,"shapes",P)),oe){se.style({cursor:"move"});var N={element:se.node(),plotinfo:z,gd:L,editHelpers:ie,isActiveShape:!0},U=T(B,L);e(U,se,N)}else L._context.edits.shapePosition?_(L,se,P,S,R,ie):P.editable===!0&&se.style("pointer-events",X||n.opacity(G)*V<=.5?"stroke":"all");se.node().addEventListener("click",function(){return v(L,se)})}}function u(L,S,k){var P=(k.xref+k.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");r.setClipUrl(L,P?"clip"+S._fullLayout._uid+P:null,S)}function _(L,S,k,P,z,I){var D=10,R=10,B=k.xsizemode==="pixel",F=k.ysizemode==="pixel",V=k.type==="line",G=k.type==="path",J=I.modifyItem,j,Y,X,oe,se,ie,N,U,q,Q,W,Z,ee,te,ae,le=M.getFromId(L,k.xref),ye=M.getRefType(k.xref),fe=M.getFromId(L,k.yref),pe=M.getRefType(k.yref),ge=g.getDataToPixel(L,le,!1,ye),Ae=g.getDataToPixel(L,fe,!0,pe),we=g.getPixelToData(L,le,!1,ye),De=g.getPixelToData(L,fe,!0,pe),Be=Le(),Ve={element:Be.node(),gd:L,prepFn:Oe,doneFn:Pe,clickFn:Ue},xe;f.init(Ve),Be.node().onmousemove=Je;function Le(){return V?He():S}function He(){var Bt=10,Mt=Math.max(k.line.width,Bt),Tt=z.append("g").attr("data-index",P);Tt.append("path").attr("d",S.attr("d")).style({cursor:"move","stroke-width":Mt,"stroke-opacity":"0"});var at={"fill-opacity":"0"},ct=Math.max(Mt/2,Bt);return Tt.append("circle").attr({"data-line-point":"start-point",cx:B?ge(k.xanchor)+k.x0:ge(k.x0),cy:F?Ae(k.yanchor)-k.y0:Ae(k.y0),r:ct}).style(at).classed("cursor-grab",!0),Tt.append("circle").attr({"data-line-point":"end-point",cx:B?ge(k.xanchor)+k.x1:ge(k.x1),cy:F?Ae(k.yanchor)-k.y1:Ae(k.y1),r:ct}).style(at).classed("cursor-grab",!0),Tt}function Je(Bt){if(y(L)){xe=null;return}if(V)Bt.target.tagName==="path"?xe="move":xe=Bt.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var Mt=Ve.element.getBoundingClientRect(),Tt=Mt.right-Mt.left,at=Mt.bottom-Mt.top,ct=Bt.clientX-Mt.left,je=Bt.clientY-Mt.top,ke=!G&&Tt>D&&at>R&&!Bt.shiftKey?f.getCursor(ct/Tt,1-je/at):"move";o(S,ke),xe=ke.split("-")[0]}}function Oe(Bt){y(L)||(B&&(se=ge(k.xanchor)),F&&(ie=Ae(k.yanchor)),k.type==="path"?ae=k.path:(j=B?k.x0:ge(k.x0),Y=F?k.y0:Ae(k.y0),X=B?k.x1:ge(k.x1),oe=F?k.y1:Ae(k.y1)),j<X?(q=j,ee="x0",Q=X,te="x1"):(q=X,ee="x1",Q=j,te="x0"),!F&&Y<oe||F&&Y>oe?(N=Y,W="y0",U=oe,Z="y1"):(N=oe,W="y1",U=Y,Z="y0"),Je(Bt),Yt(z,k),Rt(S,k,L),Ve.moveFn=xe==="move"?vt:Lt,Ve.altKey=Bt.altKey)}function Pe(){y(L)||(o(S),At(z),u(S,L,k),w.call("_guiRelayout",L,I.getUpdateObj()))}function Ue(){y(L)||At(z)}function vt(Bt,Mt){if(k.type==="path"){var Tt=function(je){return je},at=Tt,ct=Tt;B?J("xanchor",k.xanchor=we(se+Bt)):(at=function(ke){return we(ge(ke)+Bt)},le&&le.type==="date"&&(at=g.encodeDate(at))),F?J("yanchor",k.yanchor=De(ie+Mt)):(ct=function(ke){return De(Ae(ke)+Mt)},fe&&fe.type==="date"&&(ct=g.encodeDate(ct))),J("path",k.path=x(ae,at,ct))}else B?J("xanchor",k.xanchor=we(se+Bt)):(J("x0",k.x0=we(j+Bt)),J("x1",k.x1=we(X+Bt))),F?J("yanchor",k.yanchor=De(ie+Mt)):(J("y0",k.y0=De(Y+Mt)),J("y1",k.y1=De(oe+Mt)));S.attr("d",s(L,k)),Yt(z,k)}function Lt(Bt,Mt){if(G){var Tt=function(lr){return lr},at=Tt,ct=Tt;B?J("xanchor",k.xanchor=we(se+Bt)):(at=function(Wr){return we(ge(Wr)+Bt)},le&&le.type==="date"&&(at=g.encodeDate(at))),F?J("yanchor",k.yanchor=De(ie+Mt)):(ct=function(Wr){return De(Ae(Wr)+Mt)},fe&&fe.type==="date"&&(ct=g.encodeDate(ct))),J("path",k.path=x(ae,at,ct))}else if(V){if(xe==="resize-over-start-point"){var je=j+Bt,ke=F?Y-Mt:Y+Mt;J("x0",k.x0=B?je:we(je)),J("y0",k.y0=F?ke:De(ke))}else if(xe==="resize-over-end-point"){var Ye=X+Bt,Ke=F?oe-Mt:oe+Mt;J("x1",k.x1=B?Ye:we(Ye)),J("y1",k.y1=F?Ke:De(Ke))}}else{var st=function(lr){return xe.indexOf(lr)!==-1},Et=st("n"),bt=st("s"),zt=st("w"),$t=st("e"),Ot=Et?N+Mt:N,Qt=bt?U+Mt:U,tr=zt?q+Bt:q,qt=$t?Q+Bt:Q;F&&(Et&&(Ot=N-Mt),bt&&(Qt=U-Mt)),(!F&&Qt-Ot>R||F&&Ot-Qt>R)&&(J(W,k[W]=F?Ot:De(Ot)),J(Z,k[Z]=F?Qt:De(Qt))),qt-tr>D&&(J(ee,k[ee]=B?tr:we(tr)),J(te,k[te]=B?qt:we(qt)))}S.attr("d",s(L,k)),Yt(z,k)}function Yt(Bt,Mt){(B||F)&&Tt();function Tt(){var at=Mt.type!=="path",ct=Bt.selectAll(".visual-cue").data([0]),je=1;ct.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":je}).classed("visual-cue",!0);var ke=ge(B?Mt.xanchor:c.midRange(at?[Mt.x0,Mt.x1]:g.extractPathCoords(Mt.path,i.paramIsX))),Ye=Ae(F?Mt.yanchor:c.midRange(at?[Mt.y0,Mt.y1]:g.extractPathCoords(Mt.path,i.paramIsY)));if(ke=g.roundPositionForSharpStrokeRendering(ke,je),Ye=g.roundPositionForSharpStrokeRendering(Ye,je),B&&F){var Ke="M"+(ke-1-je)+","+(Ye-1-je)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";ct.attr("d",Ke)}else if(B){var st="M"+(ke-1-je)+","+(Ye-9-je)+"v18 h2 v-18 Z";ct.attr("d",st)}else{var Et="M"+(ke-9-je)+","+(Ye-1-je)+"h18 v2 h-18 Z";ct.attr("d",Et)}}}function At(Bt){Bt.selectAll(".visual-cue").remove()}function Rt(Bt,Mt,Tt){var at=Mt.xref,ct=Mt.yref,je=M.getFromId(Tt,at),ke=M.getFromId(Tt,ct),Ye="";at!=="paper"&&!je.autorange&&(Ye+=at),ct!=="paper"&&!ke.autorange&&(Ye+=ct),r.setClipUrl(Bt,Ye?"clip"+Tt._fullLayout._uid+Ye:null,Tt)}}function s(L,S){var k=S.type,P=M.getRefType(S.xref),z=M.getRefType(S.yref),I=M.getFromId(L,S.xref),D=M.getFromId(L,S.yref),R=L._fullLayout._size,B,F,V,G,J,j,Y,X;if(I?P==="domain"?F=function(ee){return I._offset+I._length*ee}:(B=g.shapePositionToRange(I),F=function(ee){return I._offset+I.r2p(B(ee,!0))}):F=function(ee){return R.l+R.w*ee},D?z==="domain"?G=function(ee){return D._offset+D._length*(1-ee)}:(V=g.shapePositionToRange(D),G=function(ee){return D._offset+D.r2p(V(ee,!0))}):G=function(ee){return R.t+R.h*(1-ee)},k==="path")return I&&I.type==="date"&&(F=g.decodeDate(F)),D&&D.type==="date"&&(G=g.decodeDate(G)),A(S,F,G);if(S.xsizemode==="pixel"){var oe=F(S.xanchor);J=oe+S.x0,j=oe+S.x1}else J=F(S.x0),j=F(S.x1);if(S.ysizemode==="pixel"){var se=G(S.yanchor);Y=se-S.y0,X=se-S.y1}else Y=G(S.y0),X=G(S.y1);if(k==="line")return"M"+J+","+Y+"L"+j+","+X;if(k==="rect")return"M"+J+","+Y+"H"+j+"V"+X+"H"+J+"Z";var ie=(J+j)/2,N=(Y+X)/2,U=Math.abs(ie-J),q=Math.abs(N-Y),Q="A"+U+","+q,W=ie+U+","+N,Z=ie+","+(N-q);return"M"+W+Q+" 0 1,1 "+Z+Q+" 0 0,1 "+W+"Z"}function A(L,S,k){var P=L.path,z=L.xsizemode,I=L.ysizemode,D=L.xanchor,R=L.yanchor;return P.replace(i.segmentRE,function(B){var F=0,V=B.charAt(0),G=i.paramIsX[V],J=i.paramIsY[V],j=i.numParams[V],Y=B.substr(1).replace(i.paramRE,function(X){return G[F]?z==="pixel"?X=S(D)+Number(X):X=S(X):J[F]&&(I==="pixel"?X=k(R)-Number(X):X=k(X)),F++,F>j&&(X="X"),X});return F>j&&(Y=Y.replace(/[\s,]*X.*/,""),c.log("Ignoring extra params in segment "+B)),V+Y})}function x(L,S,k){return L.replace(i.segmentRE,function(P){var z=0,I=P.charAt(0),D=i.paramIsX[I],R=i.paramIsY[I],B=i.numParams[I],F=P.substr(1).replace(i.paramRE,function(V){return z>=B||(D[z]?V=S(V):R[z]&&(V=k(V)),z++),V});return I+F})}function v(L,S){if(!!h(L)){var k=S.node(),P=+k.getAttribute("data-index");if(P>=0){if(P===L._fullLayout._activeShapeIndex){b(L);return}L._fullLayout._activeShapeIndex=P,L._fullLayout._deactivateShape=b,p(L)}}}function b(L){if(!!h(L)){var S=L._fullLayout._activeShapeIndex;S>=0&&(a(L),delete L._fullLayout._activeShapeIndex,p(L))}}function l(L){if(!!h(L)){a(L);var S=L._fullLayout._activeShapeIndex,k=(L.layout||{}).shapes||[];if(S<k.length){for(var P=[],z=0;z<k.length;z++)z!==S&&P.push(k[z]);delete L._fullLayout._activeShapeIndex,w.call("_guiRelayout",L,{shapes:P})}}}},{"../../lib":503,"../../lib/setcursor":524,"../../plot_api/plot_template":543,"../../plots/cartesian/axes":554,"../../plots/cartesian/handle_outline":565,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"./constants":448,"./draw_newshape/display_outlines":454,"./draw_newshape/helpers":455,"./helpers":457}],451:[function(d,re,ne){var w=d("../../drawing/attributes").dash,c=d("../../../lib/extend").extendFlat;re.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:c({},w,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":493,"../../drawing/attributes":387}],452:[function(d,re,ne){var w=32;re.exports={CIRCLE_SIDES:w,i000:0,i090:w/4,i180:w/2,i270:w/4*3,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],453:[function(d,re,ne){var w=d("../../color");re.exports=function(M,T,e){e("newshape.drawdirection"),e("newshape.layer"),e("newshape.fillcolor"),e("newshape.fillrule"),e("newshape.opacity");var a=e("newshape.line.width");if(a){var n=(M||{}).plot_bgcolor||"#FFF";e("newshape.line.color",w.contrast(n)),e("newshape.line.dash")}e("activeshape.fillcolor"),e("activeshape.opacity")}},{"../../color":366}],454:[function(d,re,ne){var w=d("../../dragelement"),c=d("../../dragelement/helpers"),M=c.drawMode,T=d("../../../registry"),e=d("./constants"),a=e.i000,n=e.i090,r=e.i180,t=e.i270,f=d("../../../plots/cartesian/handle_outline"),o=f.clearOutlineControllers,i=d("./helpers"),g=i.pointsShapeRectangle,p=i.pointsShapeEllipse,y=i.writePaths,h=d("./newshapes");re.exports=function u(_,s,A,x){x||(x=0);var v=A.gd;function b(){u(_,s,A,x++),p(_[0])&&l({redrawing:!0})}function l(Q){A.isActiveShape=!1;var W=h(s,A);Object.keys(W).length&&T.call((Q||{}).redrawing?"relayout":"_guiRelayout",v,W)}var L=A.isActiveShape,S=v._fullLayout,k=S._zoomlayer,P=A.dragmode,z=M(P);z?v._fullLayout._drawing=!0:v._fullLayout._activeShapeIndex>=0&&o(v),s.attr("d",y(_));var I,D,R,B,F;if(L&&!x){F=m([],_);var V=k.append("g").attr("class","outline-controllers");oe(V),q()}function G(Q){R=+Q.srcElement.getAttribute("data-i"),B=+Q.srcElement.getAttribute("data-j"),I[R][B].moveFn=J}function J(Q,W){if(!!_.length){var Z=F[R][B][1],ee=F[R][B][2],te=_[R],ae=te.length;if(g(te)){for(var le=0;le<ae;le++)if(le!==B){var ye=te[le];ye[1]===te[B][1]&&(ye[1]=Z+Q),ye[2]===te[B][2]&&(ye[2]=ee+W)}if(te[B][1]=Z+Q,te[B][2]=ee+W,!g(te))for(var fe=0;fe<ae;fe++)for(var pe=0;pe<te[fe].length;pe++)te[fe][pe]=F[R][fe][pe]}else te[B][1]=Z+Q,te[B][2]=ee+W;b()}}function j(){l()}function Y(){if(!!_.length&&!!_[R]&&!!_[R].length){for(var Q=[],W=0;W<_[R].length;W++)W!==B&&Q.push(_[R][W]);Q.length>1&&!(Q.length===2&&Q[1][0]==="Z")&&(B===0&&(Q[0][0]="M"),_[R]=Q,b(),l())}}function X(Q,W){if(Q===2){R=+W.srcElement.getAttribute("data-i"),B=+W.srcElement.getAttribute("data-j");var Z=_[R];!g(Z)&&!p(Z)&&Y()}}function oe(Q){I=[];for(var W=0;W<_.length;W++){var Z=_[W],ee=g(Z),te=!ee&&p(Z);I[W]=[];for(var ae=0;ae<Z.length;ae++)if(Z[ae][0]!=="Z"&&!(te&&ae!==a&&ae!==n&&ae!==r&&ae!==t)){var le=Z[ae][1],ye=Z[ae][2],fe=Q.append("circle").classed("cursor-grab",!0).attr("data-i",W).attr("data-j",ae).attr("cx",le).attr("cy",ye).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});I[W][ae]={element:fe.node(),gd:v,prepFn:G,doneFn:j,clickFn:X},w.init(I[W][ae])}}}function se(Q,W){if(!!_.length)for(var Z=0;Z<_.length;Z++)for(var ee=0;ee<_[Z].length;ee++)for(var te=0;te+2<_[Z][ee].length;te+=2)_[Z][ee][te+1]=F[Z][ee][te+1]+Q,_[Z][ee][te+2]=F[Z][ee][te+2]+W}function ie(Q,W){se(Q,W),b()}function N(Q){R=+Q.srcElement.getAttribute("data-i"),R||(R=0),D[R].moveFn=ie}function U(){l()}function q(){if(D=[],!!_.length){var Q=0;D[Q]={element:s[0][0],gd:v,prepFn:N,doneFn:U},w.init(D[Q])}}};function m(u,_){for(var s=0;s<_.length;s++){var A=_[s];u[s]=[];for(var x=0;x<A.length;x++){u[s][x]=[];for(var v=0;v<A[x].length;v++)u[s][x][v]=A[x][v]}}return u}},{"../../../plots/cartesian/handle_outline":565,"../../../registry":638,"../../dragelement":385,"../../dragelement/helpers":384,"./constants":452,"./helpers":455,"./newshapes":456}],455:[function(d,re,ne){var w=d("parse-svg-path"),c=d("./constants"),M=c.CIRCLE_SIDES,T=c.SQRT2,e=d("../../../plots/cartesian/helpers"),a=e.p2r,n=e.r2p,r=[0,3,4,5,6,1,2],t=[0,3,4,1,2];ne.writePaths=function(i){var g=i.length;if(!g)return"M0,0Z";for(var p="",y=0;y<g;y++)for(var h=i[y].length,m=0;m<h;m++){var u=i[y][m][0];if(u==="Z")p+="Z";else for(var _=i[y][m].length,s=0;s<_;s++){var A=s;u==="Q"||u==="S"?A=t[s]:u==="C"&&(A=r[s]),p+=i[y][m][A],s>0&&s<_-1&&(p+=",")}}return p},ne.readPaths=function(i,g,p,y){var h=w(i),m=[],u=-1,_=function(){u++,m[u]=[]},s,A=0,x=0,v,b,l=function(){v=A,b=x};l();for(var L=0;L<h.length;L++){var S=[],k,P,z,I,D=h[L][0],R=D;switch(D){case"M":_(),A=+h[L][1],x=+h[L][2],S.push([R,A,x]),l();break;case"Q":case"S":k=+h[L][1],z=+h[L][2],A=+h[L][3],x=+h[L][4],S.push([R,A,x,k,z]);break;case"C":k=+h[L][1],z=+h[L][2],P=+h[L][3],I=+h[L][4],A=+h[L][5],x=+h[L][6],S.push([R,A,x,k,z,P,I]);break;case"T":case"L":A=+h[L][1],x=+h[L][2],S.push([R,A,x]);break;case"H":R="L",A=+h[L][1],S.push([R,A,x]);break;case"V":R="L",x=+h[L][1],S.push([R,A,x]);break;case"A":R="L";var B=+h[L][1],F=+h[L][2];+h[L][4]||(B=-B,F=-F);var V=A-B,G=x;for(s=1;s<=M/2;s++){var J=2*Math.PI*s/M;S.push([R,V+B*Math.cos(J),G+F*Math.sin(J)])}break;case"Z":(A!==v||x!==b)&&(A=v,x=b,S.push([R,A,x]));break}for(var j=(p||{}).domain,Y=g._fullLayout._size,X=p&&p.xsizemode==="pixel",oe=p&&p.ysizemode==="pixel",se=y===!1,ie=0;ie<S.length;ie++){for(s=0;s+2<7;s+=2){var N=S[ie][s+1],U=S[ie][s+2];N===void 0||U===void 0||(A=N,x=U,p&&(p.xaxis&&p.xaxis.p2r?(se&&(N-=p.xaxis._offset),X?N=n(p.xaxis,p.xanchor)+N:N=a(p.xaxis,N)):(se&&(N-=Y.l),j?N=j.x[0]+N/Y.w:N=N/Y.w),p.yaxis&&p.yaxis.p2r?(se&&(U-=p.yaxis._offset),oe?U=n(p.yaxis,p.yanchor)-U:U=a(p.yaxis,U)):(se&&(U-=Y.t),j?U=j.y[1]-U/Y.h:U=1-U/Y.h)),S[ie][s+1]=N,S[ie][s+2]=U)}m[u].push(S[ie].slice())}}return m};function f(i,g){return Math.abs(i-g)<=1e-6}function o(i,g){var p=g[1]-i[1],y=g[2]-i[2];return Math.sqrt(p*p+y*y)}ne.pointsShapeRectangle=function(i){var g=i.length;if(g!==5)return!1;for(var p=1;p<3;p++){var y=i[0][p]-i[1][p],h=i[3][p]-i[2][p];if(!f(y,h))return!1;var m=i[0][p]-i[3][p],u=i[1][p]-i[2][p];if(!f(m,u))return!1}return!f(i[0][1],i[1][1])&&!f(i[0][1],i[3][1])?!1:!!(o(i[0],i[1])*o(i[0],i[3]))},ne.pointsShapeEllipse=function(i){var g=i.length;if(g!==M+1)return!1;g=M;for(var p=0;p<g;p++){var y=(g*2-p)%g,h=(g/2+y)%g,m=(g/2+p)%g;if(!f(o(i[p],i[m]),o(i[y],i[h])))return!1}return!0},ne.handleEllipse=function(i,g,p){if(!i)return[g,p];var y=ne.ellipseOver({x0:g[0],y0:g[1],x1:p[0],y1:p[1]}),h=(y.x1+y.x0)/2,m=(y.y1+y.y0)/2,u=(y.x1-y.x0)/2,_=(y.y1-y.y0)/2;u||(u=_=_/T),_||(_=u=u/T);for(var s=[],A=0;A<M;A++){var x=A*2*Math.PI/M;s.push([h+u*Math.cos(x),m+_*Math.sin(x)])}return s},ne.ellipseOver=function(i){var g=i.x0,p=i.y0,y=i.x1,h=i.y1,m=y-g,u=h-p;g-=m,p-=u;var _=(g+y)/2,s=(p+h)/2,A=T;return m*=A,u*=A,{x0:_-m,y0:s-u,x1:_+m,y1:s+u}}},{"../../../plots/cartesian/helpers":566,"./constants":452,"parse-svg-path":250}],456:[function(d,re,ne){var w=d("../../dragelement/helpers"),c=w.drawMode,M=w.openMode,T=d("./constants"),e=T.i000,a=T.i090,n=T.i180,r=T.i270,t=T.cos45,f=T.sin45,o=d("../../../plots/cartesian/helpers"),i=o.p2r,g=o.r2p,p=d("../../../plots/cartesian/handle_outline"),y=p.clearSelect,h=d("./helpers"),m=h.readPaths,u=h.writePaths,_=h.ellipseOver;re.exports=function(x,v){if(!!x.length){var b=x[0][0];if(!!b){var l=b.getAttribute("d"),L=v.gd,S=L._fullLayout.newshape,k=v.plotinfo,P=k.xaxis,z=k.yaxis,I=!!k.domain||!k.xaxis,D=!!k.domain||!k.yaxis,R=v.isActiveShape,B=v.dragmode,F=(L.layout||{}).shapes||[];if(!c(B)&&R!==void 0){var V=L._fullLayout._activeShapeIndex;if(V<F.length)switch(L._fullLayout.shapes[V].type){case"rect":B="drawrect";break;case"circle":B="drawcircle";break;case"line":B="drawline";break;case"path":var G=F[V].path||"";G[G.length-1]==="Z"?B="drawclosedpath":B="drawopenpath";break}}var J=M(B),j=m(l,L,k,R),Y={editable:!0,xref:I?"paper":P._id,yref:D?"paper":z._id,layer:S.layer,opacity:S.opacity,line:{color:S.line.color,width:S.line.width,dash:S.line.dash}};J||(Y.fillcolor=S.fillcolor,Y.fillrule=S.fillrule);var X;if(j.length===1&&(X=j[0]),X&&B==="drawrect")Y.type="rect",Y.x0=X[0][1],Y.y0=X[0][2],Y.x1=X[2][1],Y.y1=X[2][2];else if(X&&B==="drawline")Y.type="line",Y.x0=X[0][1],Y.y0=X[0][2],Y.x1=X[1][1],Y.y1=X[1][2];else if(X&&B==="drawcircle"){Y.type="circle";var oe=X[e][1],se=X[a][1],ie=X[n][1],N=X[r][1],U=X[e][2],q=X[a][2],Q=X[n][2],W=X[r][2],Z=k.xaxis&&(k.xaxis.type==="date"||k.xaxis.type==="log"),ee=k.yaxis&&(k.yaxis.type==="date"||k.yaxis.type==="log");Z&&(oe=g(k.xaxis,oe),se=g(k.xaxis,se),ie=g(k.xaxis,ie),N=g(k.xaxis,N)),ee&&(U=g(k.yaxis,U),q=g(k.yaxis,q),Q=g(k.yaxis,Q),W=g(k.yaxis,W));var te=(se+N)/2,ae=(U+Q)/2,le=(N-se+ie-oe)/2,ye=(W-q+Q-U)/2,fe=_({x0:te,y0:ae,x1:te+le*t,y1:ae+ye*f});Z&&(fe.x0=i(k.xaxis,fe.x0),fe.x1=i(k.xaxis,fe.x1)),ee&&(fe.y0=i(k.yaxis,fe.y0),fe.y1=i(k.yaxis,fe.y1)),Y.x0=fe.x0,Y.y0=fe.y0,Y.x1=fe.x1,Y.y1=fe.y1}else Y.type="path",P&&z&&s(j,P,z),Y.path=u(j),X=null;y(L);for(var pe=v.editHelpers,ge=(pe||{}).modifyItem,Ae=[],we=0;we<F.length;we++){var De=L._fullLayout.shapes[we];if(Ae[we]=De._input,R!==void 0&&we===L._fullLayout._activeShapeIndex){var Be=Y;switch(De.type){case"line":case"rect":case"circle":ge("x0",Be.x0),ge("x1",Be.x1),ge("y0",Be.y0),ge("y1",Be.y1);break;case"path":ge("path",Be.path);break}}}return R===void 0?(Ae.push(Y),Ae):pe?pe.getUpdateObj():{}}}};function s(A,x,v){var b=x.type==="date",l=v.type==="date";if(!b&&!l)return A;for(var L=0;L<A.length;L++)for(var S=0;S<A[L].length;S++)for(var k=0;k+2<A[L][S].length;k+=2)b&&(A[L][S][k+1]=A[L][S][k+1].replace(" ","_")),l&&(A[L][S][k+2]=A[L][S][k+2].replace(" ","_"));return A}},{"../../../plots/cartesian/handle_outline":565,"../../../plots/cartesian/helpers":566,"../../dragelement/helpers":384,"./constants":452,"./helpers":455}],457:[function(d,re,ne){var w=d("./constants"),c=d("../../lib");ne.rangeToShapePosition=function(M){return M.type==="log"?M.r2d:function(T){return T}},ne.shapePositionToRange=function(M){return M.type==="log"?M.d2r:function(T){return T}},ne.decodeDate=function(M){return function(T){return T.replace&&(T=T.replace("_"," ")),M(T)}},ne.encodeDate=function(M){return function(T){return M(T).replace(" ","_")}},ne.extractPathCoords=function(M,T){var e=[],a=M.match(w.segmentRE);return a.forEach(function(n){var r=T[n.charAt(0)].drawn;if(r!==void 0){var t=n.substr(1).match(w.paramRE);!t||t.length<r||e.push(c.cleanNumber(t[r]))}}),e},ne.getDataToPixel=function(M,T,e,a){var n=M._fullLayout._size,r;if(T)if(a==="domain")r=function(f){return T._length*(e?1-f:f)+T._offset};else{var t=ne.shapePositionToRange(T);r=function(f){return T._offset+T.r2p(t(f,!0))},T.type==="date"&&(r=ne.decodeDate(r))}else e?r=function(f){return n.t+n.h*(1-f)}:r=function(f){return n.l+n.w*f};return r},ne.getPixelToData=function(M,T,e,a){var n=M._fullLayout._size,r;if(T)if(a==="domain")r=function(f){var o=(f-T._offset)/T._length;return e?1-o:o};else{var t=ne.rangeToShapePosition(T);r=function(f){return t(T.p2r(f-T._offset))}}else e?r=function(f){return 1-(f-n.t)/n.h}:r=function(f){return(f-n.l)/n.w};return r},ne.roundPositionForSharpStrokeRendering=function(M,T){var e=Math.round(T%2)===1,a=Math.round(M);return e?a+.5:a},ne.makeOptionsAndPlotinfo=function(M,T){var e=M._fullLayout.shapes[T]||{},a=M._fullLayout._plots[e.xref+e.yref],n=!!a;return n?a._hadPlotinfo=!0:(a={},e.xref&&e.xref!=="paper"&&(a.xaxis=M._fullLayout[e.xref+"axis"]),e.yref&&e.yref!=="paper"&&(a.yaxis=M._fullLayout[e.yref+"axis"])),a.xsizemode=e.xsizemode,a.ysizemode=e.ysizemode,a.xanchor=e.xanchor,a.yanchor=e.yanchor,{options:e,plotinfo:a}}},{"../../lib":503,"./constants":448}],458:[function(d,re,ne){var w=d("./draw");re.exports={moduleType:"component",name:"shapes",layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),supplyDrawNewShapeDefaults:d("./draw_newshape/defaults"),includeBasePlot:d("../../plots/cartesian/include_components")("shapes"),calcAutorange:d("./calc_autorange"),draw:w.draw,drawOne:w.drawOne}},{"../../plots/cartesian/include_components":567,"./attributes":446,"./calc_autorange":447,"./defaults":449,"./draw":450,"./draw_newshape/defaults":453}],459:[function(d,re,ne){var w=d("../../plots/font_attributes"),c=d("../../plots/pad_attributes"),M=d("../../lib/extend").extendDeepAll,T=d("../../plot_api/edit_types").overrideAll,e=d("../../plots/animation_attributes"),a=d("../../plot_api/plot_template").templatedArray,n=d("./constants"),r=a("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});re.exports=T(a("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:r,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:M(c({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:w({})},font:w({}),activebgcolor:{valType:"color",dflt:n.gripBgActiveColor},bgcolor:{valType:"color",dflt:n.railBgColor},bordercolor:{valType:"color",dflt:n.railBorderColor},borderwidth:{valType:"number",min:0,dflt:n.railBorderWidth},ticklen:{valType:"number",min:0,dflt:n.tickLength},tickcolor:{valType:"color",dflt:n.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:n.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/animation_attributes":548,"../../plots/font_attributes":585,"../../plots/pad_attributes":618,"./constants":460}],460:[function(d,re,ne){re.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],461:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/array_container_defaults"),M=d("./attributes"),T=d("./constants"),e=T.name,a=M.steps;re.exports=function(f,o){c(f,o,{name:e,handleItemDefaults:n})};function n(t,f,o){function i(s,A){return w.coerce(t,f,M,s,A)}for(var g=c(t,f,{name:"steps",handleItemDefaults:r}),p=0,y=0;y<g.length;y++)g[y].visible&&p++;var h;if(p<2?h=f.visible=!1:h=i("visible"),!!h){f._stepCount=p;var m=f._visibleSteps=w.filterVisible(g),u=i("active");(g[u]||{}).visible||(f.active=m[0]._index),i("x"),i("y"),w.noneOrAll(t,f,["x","y"]),i("xanchor"),i("yanchor"),i("len"),i("lenmode"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),w.coerceFont(i,"font",o.font);var _=i("currentvalue.visible");_&&(i("currentvalue.xanchor"),i("currentvalue.prefix"),i("currentvalue.suffix"),i("currentvalue.offset"),w.coerceFont(i,"currentvalue.font",f.font)),i("transition.duration"),i("transition.easing"),i("bgcolor"),i("activebgcolor"),i("bordercolor"),i("borderwidth"),i("ticklen"),i("tickwidth"),i("tickcolor"),i("minorticklen")}}function r(t,f){function o(p,y){return w.coerce(t,f,a,p,y)}var i;if(t.method!=="skip"&&!Array.isArray(t.args)?i=f.visible=!1:i=o("visible"),i){o("method"),o("args");var g=o("label","step-"+f._index);o("value",g),o("execute")}}},{"../../lib":503,"../../plots/array_container_defaults":549,"./attributes":459,"./constants":460}],462:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../plots/plots"),M=d("../color"),T=d("../drawing"),e=d("../../lib"),a=e.strTranslate,n=d("../../lib/svg_text_utils"),r=d("../../plot_api/plot_template").arrayEditor,t=d("./constants"),f=d("../../constants/alignment"),o=f.LINE_SPACING,i=f.FROM_TL,g=f.FROM_BR;re.exports=function(B){var F=B._fullLayout,V=y(F,B),G=F._infolayer.selectAll("g."+t.containerClassName).data(V.length>0?[0]:[]);G.enter().append("g").classed(t.containerClassName,!0).style("cursor","ew-resize");function J(oe){oe._commandObserver&&(oe._commandObserver.remove(),delete oe._commandObserver),c.autoMargin(B,p(oe))}if(G.exit().each(function(){w.select(this).selectAll("g."+t.groupClassName).each(J)}).remove(),V.length!==0){var j=G.selectAll("g."+t.groupClassName).data(V,h);j.enter().append("g").classed(t.groupClassName,!0),j.exit().each(J).remove();for(var Y=0;Y<V.length;Y++){var X=V[Y];m(B,X)}j.each(function(oe){var se=w.select(this);S(oe),c.manageCommandObserver(B,oe,oe._visibleSteps,function(ie){var N=se.data()[0];N.active!==ie.index&&(N._dragging||b(B,se,N,ie.index,!1,!0))}),u(B,w.select(this),oe)})}};function p(R){return t.autoMarginIdRoot+R._index}function y(R,B){for(var F=R[t.name],V=[],G=0;G<F.length;G++){var J=F[G];!J.visible||(J._gd=B,V.push(J))}return V}function h(R){return R._index}function m(R,B){var F=T.tester.selectAll("g."+t.labelGroupClass).data(B._visibleSteps);F.enter().append("g").classed(t.labelGroupClass,!0);var V=0,G=0;F.each(function(q){var Q=w.select(this),W=A(Q,{step:q},B),Z=W.node();if(Z){var ee=T.bBox(Z);G=Math.max(G,ee.height),V=Math.max(V,ee.width)}}),F.remove();var J=B._dims={};J.inputAreaWidth=Math.max(t.railWidth,t.gripHeight);var j=R._fullLayout._size;J.lx=j.l+j.w*B.x,J.ly=j.t+j.h*(1-B.y),B.lenmode==="fraction"?J.outerLength=Math.round(j.w*B.len):J.outerLength=B.len,J.inputAreaStart=0,J.inputAreaLength=Math.round(J.outerLength-B.pad.l-B.pad.r);var Y=J.inputAreaLength-2*t.stepInset,X=Y/(B._stepCount-1),oe=V+t.labelPadding;if(J.labelStride=Math.max(1,Math.ceil(oe/X)),J.labelHeight=G,J.currentValueMaxWidth=0,J.currentValueHeight=0,J.currentValueTotalHeight=0,J.currentValueMaxLines=1,B.currentvalue.visible){var se=T.tester.append("g");F.each(function(q){var Q=_(se,B,q.label),W=Q.node()&&T.bBox(Q.node())||{width:0,height:0},Z=n.lineCount(Q);J.currentValueMaxWidth=Math.max(J.currentValueMaxWidth,Math.ceil(W.width)),J.currentValueHeight=Math.max(J.currentValueHeight,Math.ceil(W.height)),J.currentValueMaxLines=Math.max(J.currentValueMaxLines,Z)}),J.currentValueTotalHeight=J.currentValueHeight+B.currentvalue.offset,se.remove()}J.height=J.currentValueTotalHeight+t.tickOffset+B.ticklen+t.labelOffset+J.labelHeight+B.pad.t+B.pad.b;var ie="left";e.isRightAnchor(B)&&(J.lx-=J.outerLength,ie="right"),e.isCenterAnchor(B)&&(J.lx-=J.outerLength/2,ie="center");var N="top";e.isBottomAnchor(B)&&(J.ly-=J.height,N="bottom"),e.isMiddleAnchor(B)&&(J.ly-=J.height/2,N="middle"),J.outerLength=Math.ceil(J.outerLength),J.height=Math.ceil(J.height),J.lx=Math.round(J.lx),J.ly=Math.round(J.ly);var U={y:B.y,b:J.height*g[N],t:J.height*i[N]};B.lenmode==="fraction"?(U.l=0,U.xl=B.x-B.len*i[ie],U.r=0,U.xr=B.x+B.len*g[ie]):(U.x=B.x,U.l=J.outerLength*i[ie],U.r=J.outerLength*g[ie]),c.autoMargin(R,p(B),U)}function u(R,B,F){(F.steps[F.active]||{}).visible||(F.active=F._visibleSteps[0]._index),B.call(_,F).call(D,F).call(x,F).call(L,F).call(I,R,F).call(s,R,F);var V=F._dims;T.setTranslate(B,V.lx+F.pad.l,V.ly+F.pad.t),B.call(k,F,!1),B.call(_,F)}function _(R,B,F){if(!!B.currentvalue.visible){var V=B._dims,G,J;switch(B.currentvalue.xanchor){case"right":G=V.inputAreaLength-t.currentValueInset-V.currentValueMaxWidth,J="left";break;case"center":G=V.inputAreaLength*.5,J="middle";break;default:G=t.currentValueInset,J="left"}var j=e.ensureSingle(R,"text",t.labelClass,function(N){N.attr({"text-anchor":J,"data-notex":1})}),Y=B.currentvalue.prefix?B.currentvalue.prefix:"";if(typeof F=="string")Y+=F;else{var X=B.steps[B.active].label,oe=B._gd._fullLayout._meta;oe&&(X=e.templateString(X,oe)),Y+=X}B.currentvalue.suffix&&(Y+=B.currentvalue.suffix),j.call(T.font,B.currentvalue.font).text(Y).call(n.convertToTspans,B._gd);var se=n.lineCount(j),ie=(V.currentValueMaxLines+1-se)*B.currentvalue.font.size*o;return n.positionText(j,G,ie),j}}function s(R,B,F){var V=e.ensureSingle(R,"rect",t.gripRectClass,function(G){G.call(l,B,R,F).style("pointer-events","all")});V.attr({width:t.gripWidth,height:t.gripHeight,rx:t.gripRadius,ry:t.gripRadius}).call(M.stroke,F.bordercolor).call(M.fill,F.bgcolor).style("stroke-width",F.borderwidth+"px")}function A(R,B,F){var V=e.ensureSingle(R,"text",t.labelClass,function(j){j.attr({"text-anchor":"middle","data-notex":1})}),G=B.step.label,J=F._gd._fullLayout._meta;return J&&(G=e.templateString(G,J)),V.call(T.font,F.font).text(G).call(n.convertToTspans,F._gd),V}function x(R,B){var F=e.ensureSingle(R,"g",t.labelsClass),V=B._dims,G=F.selectAll("g."+t.labelGroupClass).data(V.labelSteps);G.enter().append("g").classed(t.labelGroupClass,!0),G.exit().remove(),G.each(function(J){var j=w.select(this);j.call(A,J,B),T.setTranslate(j,P(B,J.fraction),t.tickOffset+B.ticklen+B.font.size*o+t.labelOffset+V.currentValueTotalHeight)})}function v(R,B,F,V,G){var J=Math.round(V*(F._stepCount-1)),j=F._visibleSteps[J]._index;j!==F.active&&b(R,B,F,j,!0,G)}function b(R,B,F,V,G,J){var j=F.active;F.active=V,r(R.layout,t.name,F).applyUpdate("active",V);var Y=F.steps[F.active];B.call(k,F,J),B.call(_,F),R.emit("plotly_sliderchange",{slider:F,step:F.steps[F.active],interaction:G,previousActive:j}),Y&&Y.method&&G&&(B._nextMethod?(B._nextMethod.step=Y,B._nextMethod.doCallback=G,B._nextMethod.doTransition=J):(B._nextMethod={step:Y,doCallback:G,doTransition:J},B._nextMethodRaf=window.requestAnimationFrame(function(){var X=B._nextMethod.step;!X.method||(X.execute&&c.executeAPICommand(R,X.method,X.args),B._nextMethod=null,B._nextMethodRaf=null)})))}function l(R,B,F){var V=F.node(),G=w.select(B);function J(){return F.data()[0]}function j(){var Y=J();B.emit("plotly_sliderstart",{slider:Y});var X=F.select("."+t.gripRectClass);w.event.stopPropagation(),w.event.preventDefault(),X.call(M.fill,Y.activebgcolor);var oe=z(Y,w.mouse(V)[0]);v(B,F,Y,oe,!0),Y._dragging=!0;function se(){var N=J(),U=z(N,w.mouse(V)[0]);v(B,F,N,U,!1)}G.on("mousemove",se),G.on("touchmove",se);function ie(){var N=J();N._dragging=!1,X.call(M.fill,N.bgcolor),G.on("mouseup",null),G.on("mousemove",null),G.on("touchend",null),G.on("touchmove",null),B.emit("plotly_sliderend",{slider:N,step:N.steps[N.active]})}G.on("mouseup",ie),G.on("touchend",ie)}R.on("mousedown",j),R.on("touchstart",j)}function L(R,B){var F=R.selectAll("rect."+t.tickRectClass).data(B._visibleSteps),V=B._dims;F.enter().append("rect").classed(t.tickRectClass,!0),F.exit().remove(),F.attr({width:B.tickwidth+"px","shape-rendering":"crispEdges"}),F.each(function(G,J){var j=J%V.labelStride===0,Y=w.select(this);Y.attr({height:j?B.ticklen:B.minorticklen}).call(M.fill,B.tickcolor),T.setTranslate(Y,P(B,J/(B._stepCount-1))-.5*B.tickwidth,(j?t.tickOffset:t.minorTickOffset)+V.currentValueTotalHeight)})}function S(R){var B=R._dims;B.labelSteps=[];for(var F=R._stepCount,V=0;V<F;V+=B.labelStride)B.labelSteps.push({fraction:V/(F-1),step:R._visibleSteps[V]})}function k(R,B,F){for(var V=R.select("rect."+t.gripRectClass),G=0,J=0;J<B._stepCount;J++)if(B._visibleSteps[J]._index===B.active){G=J;break}var j=P(B,G/(B._stepCount-1));if(!B._invokingCommand){var Y=V;F&&B.transition.duration>0&&(Y=Y.transition().duration(B.transition.duration).ease(B.transition.easing)),Y.attr("transform",a(j-t.gripWidth*.5,B._dims.currentValueTotalHeight))}}function P(R,B){var F=R._dims;return F.inputAreaStart+t.stepInset+(F.inputAreaLength-2*t.stepInset)*Math.min(1,Math.max(0,B))}function z(R,B){var F=R._dims;return Math.min(1,Math.max(0,(B-t.stepInset-F.inputAreaStart)/(F.inputAreaLength-2*t.stepInset-2*F.inputAreaStart)))}function I(R,B,F){var V=F._dims,G=e.ensureSingle(R,"rect",t.railTouchRectClass,function(J){J.call(l,B,R,F).style("pointer-events","all")});G.attr({width:V.inputAreaLength,height:Math.max(V.inputAreaWidth,t.tickOffset+F.ticklen+V.labelHeight)}).call(M.fill,F.bgcolor).attr("opacity",0),T.setTranslate(G,0,V.currentValueTotalHeight)}function D(R,B){var F=B._dims,V=F.inputAreaLength-t.railInset*2,G=e.ensureSingle(R,"rect",t.railRectClass);G.attr({width:V,height:t.railWidth,rx:t.railRadius,ry:t.railRadius,"shape-rendering":"crispEdges"}).call(M.stroke,B.bordercolor).call(M.fill,B.bgcolor).style("stroke-width",B.borderwidth+"px"),T.setTranslate(G,t.railInset,(F.inputAreaWidth-t.railWidth)*.5+F.currentValueTotalHeight)}},{"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plot_api/plot_template":543,"../../plots/plots":619,"../color":366,"../drawing":388,"./constants":460,"@plotly/d3":58}],463:[function(d,re,ne){var w=d("./constants");re.exports={moduleType:"component",name:w.name,layoutAttributes:d("./attributes"),supplyLayoutDefaults:d("./defaults"),draw:d("./draw")}},{"./attributes":459,"./constants":460,"./defaults":461,"./draw":462}],464:[function(d,re,ne){var w=d("@plotly/d3"),c=d("fast-isnumeric"),M=d("../../plots/plots"),T=d("../../registry"),e=d("../../lib"),a=e.strTranslate,n=d("../drawing"),r=d("../color"),t=d("../../lib/svg_text_utils"),f=d("../../constants/interactions"),o=d("../../constants/alignment").OPPOSITE_SIDE,i=/ [XY][0-9]* /;function g(p,y,h){var m=h.propContainer,u=h.propName,_=h.placeholder,s=h.traceIndex,A=h.avoid||{},x=h.attributes,v=h.transform,b=h.containerGroup,l=p._fullLayout,L=1,S=!1,k=m.title,P=(k&&k.text?k.text:"").trim(),z=k&&k.font?k.font:{},I=z.family,D=z.size,R=z.color,B;u==="title.text"?B="titleText":u.indexOf("axis")!==-1?B="axisTitleText":u.indexOf("colorbar"!==-1)&&(B="colorbarTitleText");var F=p._context.edits[B];P===""?L=0:P.replace(i," % ")===_.replace(i," % ")&&(L=.2,S=!0,F||(P="")),h._meta?P=e.templateString(P,h._meta):l._meta&&(P=e.templateString(P,l._meta));var V=P||F,G;b||(b=e.ensureSingle(l._infolayer,"g","g-"+y),G=l._hColorbarMoveTitle);var J=b.selectAll("text").data(V?[0]:[]);if(J.enter().append("text"),J.text(P).attr("class",y),J.exit().remove(),!V)return b;function j(se){e.syncOrAsync([Y,X],se)}function Y(se){var ie;return!v&&G&&(v={}),v?(ie="",v.rotate&&(ie+="rotate("+[v.rotate,x.x,x.y]+")"),(v.offset||G)&&(ie+=a(0,(v.offset||0)-(G||0)))):ie=null,se.attr("transform",ie),se.style({"font-family":I,"font-size":w.round(D,2)+"px",fill:r.rgb(R),opacity:L*r.opacity(R),"font-weight":M.fontWeight}).attr(x).call(t.convertToTspans,p),M.previousPromises(p)}function X(se){var ie=w.select(se.node().parentNode);if(A&&A.selection&&A.side&&P){ie.attr("transform",null);var N=o[A.side],U=A.side==="left"||A.side==="top"?-1:1,q=c(A.pad)?A.pad:2,Q=n.bBox(ie.node()),W={left:0,top:0,right:l.width,bottom:l.height},Z=A.maxShift||U*(W[A.side]-Q[A.side]),ee=0;if(Z<0)ee=Z;else{var te=A.offsetLeft||0,ae=A.offsetTop||0;Q.left-=te,Q.right-=te,Q.top-=ae,Q.bottom-=ae,A.selection.each(function(){var ye=n.bBox(this);e.bBoxIntersect(Q,ye,q)&&(ee=Math.max(ee,U*(ye[A.side]-Q[N])+q))}),ee=Math.min(Z,ee)}if(ee>0||Z<0){var le={left:[-ee,0],right:[ee,0],top:[0,-ee],bottom:[0,ee]}[A.side];ie.attr("transform",a(le[0],le[1]))}}}J.call(j);function oe(){L=0,S=!0,J.text(_).on("mouseover.opacity",function(){w.select(this).transition().duration(f.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){w.select(this).transition().duration(f.HIDE_PLACEHOLDER).style("opacity",0)})}return F&&(P?J.on(".opacity",null):oe(),J.call(t.makeEditable,{gd:p}).on("edit",function(se){s!==void 0?T.call("_guiRestyle",p,u,se,s):T.call("_guiRelayout",p,u,se)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(j)}).on("input",function(se){this.text(se||" ").call(t.positionText,x.x,x.y)})),J.classed("js-placeholder",S),b}re.exports={draw:g}},{"../../constants/alignment":471,"../../constants/interactions":478,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../../registry":638,"../color":366,"../drawing":388,"@plotly/d3":58,"fast-isnumeric":190}],465:[function(d,re,ne){var w=d("../../plots/font_attributes"),c=d("../color/attributes"),M=d("../../lib/extend").extendFlat,T=d("../../plot_api/edit_types").overrideAll,e=d("../../plots/pad_attributes"),a=d("../../plot_api/plot_template").templatedArray,n=a("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});re.exports=T(a("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:n,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:M(e({editType:"arraydraw"}),{}),font:w({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:c.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/font_attributes":585,"../../plots/pad_attributes":618,"../color/attributes":365}],466:[function(d,re,ne){re.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],467:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/array_container_defaults"),M=d("./attributes"),T=d("./constants"),e=T.name,a=M.buttons;re.exports=function(f,o){var i={name:e,handleItemDefaults:n};c(f,o,i)};function n(t,f,o){function i(y,h){return w.coerce(t,f,M,y,h)}var g=c(t,f,{name:"buttons",handleItemDefaults:r}),p=i("visible",g.length>0);!p||(i("active"),i("direction"),i("type"),i("showactive"),i("x"),i("y"),w.noneOrAll(t,f,["x","y"]),i("xanchor"),i("yanchor"),i("pad.t"),i("pad.r"),i("pad.b"),i("pad.l"),w.coerceFont(i,"font",o.font),i("bgcolor",o.paper_bgcolor),i("bordercolor"),i("borderwidth"))}function r(t,f){function o(g,p){return w.coerce(t,f,a,g,p)}var i=o("visible",t.method==="skip"||Array.isArray(t.args));i&&(o("method"),o("args"),o("args2"),o("label"),o("execute"))}},{"../../lib":503,"../../plots/array_container_defaults":549,"./attributes":465,"./constants":466}],468:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../plots/plots"),M=d("../color"),T=d("../drawing"),e=d("../../lib"),a=d("../../lib/svg_text_utils"),n=d("../../plot_api/plot_template").arrayEditor,r=d("../../constants/alignment").LINE_SPACING,t=d("./constants"),f=d("./scrollbox");re.exports=function(z){var I=z._fullLayout,D=e.filterVisible(I[t.name]);function R(X){c.autoMargin(z,L(X))}var B=I._menulayer.selectAll("g."+t.containerClassName).data(D.length>0?[0]:[]);if(B.enter().append("g").classed(t.containerClassName,!0).style("cursor","pointer"),B.exit().each(function(){w.select(this).selectAll("g."+t.headerGroupClassName).each(R)}).remove(),D.length!==0){var F=B.selectAll("g."+t.headerGroupClassName).data(D,o);F.enter().append("g").classed(t.headerGroupClassName,!0);for(var V=e.ensureSingle(B,"g",t.dropdownButtonGroupClassName,function(X){X.style("pointer-events","all")}),G=0;G<D.length;G++){var J=D[G];l(z,J)}var j="updatemenus"+I._uid,Y=new f(z,V,j);F.enter().size()&&(V.node().parentNode.appendChild(V.node()),V.call(k)),F.exit().each(function(X){V.call(k),R(X)}).remove(),F.each(function(X){var oe=w.select(this),se=X.type==="dropdown"?V:null;c.manageCommandObserver(z,X,X.buttons,function(ie){p(z,X,X.buttons[ie.index],oe,se,Y,ie.index,!0)}),X.type==="dropdown"?(y(z,oe,V,Y,X),g(V,X)&&h(z,oe,V,Y,X)):h(z,oe,null,null,X)})}};function o(P){return P._index}function i(P){return+P.attr(t.menuIndexAttrName)==-1}function g(P,z){return+P.attr(t.menuIndexAttrName)===z._index}function p(P,z,I,D,R,B,F,V){z.active=F,n(P.layout,t.name,z).applyUpdate("active",F),z.type==="buttons"?h(P,D,null,null,z):z.type==="dropdown"&&(R.attr(t.menuIndexAttrName,"-1"),y(P,D,R,B,z),V||h(P,D,R,B,z))}function y(P,z,I,D,R){var B=e.ensureSingle(z,"g",t.headerClassName,function(X){X.style("pointer-events","all")}),F=R._dims,V=R.active,G=R.buttons[V]||t.blankHeaderOpts,J={y:R.pad.t,yPad:0,x:R.pad.l,xPad:0,index:0},j={width:F.headerWidth,height:F.headerHeight};B.call(_,R,G,P).call(S,R,J,j);var Y=e.ensureSingle(z,"text",t.headerArrowClassName,function(X){X.attr("text-anchor","end").call(T.font,R.font).text(t.arrowSymbol[R.direction])});Y.attr({x:F.headerWidth-t.arrowOffsetX+R.pad.l,y:F.headerHeight/2+t.textOffsetY+R.pad.t}),B.on("click",function(){I.call(k,String(g(I,R)?-1:R._index)),h(P,z,I,D,R)}),B.on("mouseover",function(){B.call(v)}),B.on("mouseout",function(){B.call(b,R)}),T.setTranslate(z,F.lx,F.ly)}function h(P,z,I,D,R){I||(I=z,I.attr("pointer-events","all"));var B=!i(I)||R.type==="buttons"?R.buttons:[],F=R.type==="dropdown"?t.dropdownButtonClassName:t.buttonClassName,V=I.selectAll("g."+F).data(e.filterVisible(B)),G=V.enter().append("g").classed(F,!0),J=V.exit();R.type==="dropdown"?(G.attr("opacity","0").transition().attr("opacity","1"),J.transition().attr("opacity","0").remove()):J.remove();var j=0,Y=0,X=R._dims,oe=["up","down"].indexOf(R.direction)!==-1;R.type==="dropdown"&&(oe?Y=X.headerHeight+t.gapButtonHeader:j=X.headerWidth+t.gapButtonHeader),R.type==="dropdown"&&R.direction==="up"&&(Y=-t.gapButtonHeader+t.gapButton-X.openHeight),R.type==="dropdown"&&R.direction==="left"&&(j=-t.gapButtonHeader+t.gapButton-X.openWidth);var se={x:X.lx+j+R.pad.l,y:X.ly+Y+R.pad.t,yPad:t.gapButton,xPad:t.gapButton,index:0},ie={l:se.x+R.borderwidth,t:se.y+R.borderwidth};V.each(function(N,U){var q=w.select(this);q.call(_,R,N,P).call(S,R,se),q.on("click",function(){w.event.defaultPrevented||(N.execute&&(N.args2&&R.active===U?(p(P,R,N,z,I,D,-1),c.executeAPICommand(P,N.method,N.args2)):(p(P,R,N,z,I,D,U),c.executeAPICommand(P,N.method,N.args))),P.emit("plotly_buttonclicked",{menu:R,button:N,active:R.active}))}),q.on("mouseover",function(){q.call(v)}),q.on("mouseout",function(){q.call(b,R),V.call(x,R)})}),V.call(x,R),oe?(ie.w=Math.max(X.openWidth,X.headerWidth),ie.h=se.y-ie.t):(ie.w=se.x-ie.l,ie.h=Math.max(X.openHeight,X.headerHeight)),ie.direction=R.direction,D&&(V.size()?m(P,z,I,D,R,ie):u(D))}function m(P,z,I,D,R,B){var F=R.direction,V=F==="up"||F==="down",G=R._dims,J=R.active,j,Y,X;if(V)for(Y=0,X=0;X<J;X++)Y+=G.heights[X]+t.gapButton;else for(j=0,X=0;X<J;X++)j+=G.widths[X]+t.gapButton;D.enable(B,j,Y),D.hbar&&D.hbar.attr("opacity","0").transition().attr("opacity","1"),D.vbar&&D.vbar.attr("opacity","0").transition().attr("opacity","1")}function u(P){var z=!!P.hbar,I=!!P.vbar;z&&P.hbar.transition().attr("opacity","0").each("end",function(){z=!1,I||P.disable()}),I&&P.vbar.transition().attr("opacity","0").each("end",function(){I=!1,z||P.disable()})}function _(P,z,I,D){P.call(s,z).call(A,z,I,D)}function s(P,z){var I=e.ensureSingle(P,"rect",t.itemRectClassName,function(D){D.attr({rx:t.rx,ry:t.ry,"shape-rendering":"crispEdges"})});I.call(M.stroke,z.bordercolor).call(M.fill,z.bgcolor).style("stroke-width",z.borderwidth+"px")}function A(P,z,I,D){var R=e.ensureSingle(P,"text",t.itemTextClassName,function(V){V.attr({"text-anchor":"start","data-notex":1})}),B=I.label,F=D._fullLayout._meta;F&&(B=e.templateString(B,F)),R.call(T.font,z.font).text(B).call(a.convertToTspans,D)}function x(P,z){var I=z.active;P.each(function(D,R){var B=w.select(this);R===I&&z.showactive&&B.select("rect."+t.itemRectClassName).call(M.fill,t.activeColor)})}function v(P){P.select("rect."+t.itemRectClassName).call(M.fill,t.hoverColor)}function b(P,z){P.select("rect."+t.itemRectClassName).call(M.fill,z.bgcolor)}function l(P,z){var I=z._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},D=T.tester.selectAll("g."+t.dropdownButtonClassName).data(e.filterVisible(z.buttons));D.enter().append("g").classed(t.dropdownButtonClassName,!0);var R=["up","down"].indexOf(z.direction)!==-1;D.each(function(j,Y){var X=w.select(this);X.call(_,z,j,P);var oe=X.select("."+t.itemTextClassName),se=oe.node()&&T.bBox(oe.node()).width,ie=Math.max(se+t.textPadX,t.minWidth),N=z.font.size*r,U=a.lineCount(oe),q=Math.max(N*U,t.minHeight)+t.textOffsetY;q=Math.ceil(q),ie=Math.ceil(ie),I.widths[Y]=ie,I.heights[Y]=q,I.height1=Math.max(I.height1,q),I.width1=Math.max(I.width1,ie),R?(I.totalWidth=Math.max(I.totalWidth,ie),I.openWidth=I.totalWidth,I.totalHeight+=q+t.gapButton,I.openHeight+=q+t.gapButton):(I.totalWidth+=ie+t.gapButton,I.openWidth+=ie+t.gapButton,I.totalHeight=Math.max(I.totalHeight,q),I.openHeight=I.totalHeight)}),R?I.totalHeight-=t.gapButton:I.totalWidth-=t.gapButton,I.headerWidth=I.width1+t.arrowPadX,I.headerHeight=I.height1,z.type==="dropdown"&&(R?(I.width1+=t.arrowPadX,I.totalHeight=I.height1):I.totalWidth=I.width1,I.totalWidth+=t.arrowPadX),D.remove();var B=I.totalWidth+z.pad.l+z.pad.r,F=I.totalHeight+z.pad.t+z.pad.b,V=P._fullLayout._size;I.lx=V.l+V.w*z.x,I.ly=V.t+V.h*(1-z.y);var G="left";e.isRightAnchor(z)&&(I.lx-=B,G="right"),e.isCenterAnchor(z)&&(I.lx-=B/2,G="center");var J="top";e.isBottomAnchor(z)&&(I.ly-=F,J="bottom"),e.isMiddleAnchor(z)&&(I.ly-=F/2,J="middle"),I.totalWidth=Math.ceil(I.totalWidth),I.totalHeight=Math.ceil(I.totalHeight),I.lx=Math.round(I.lx),I.ly=Math.round(I.ly),c.autoMargin(P,L(z),{x:z.x,y:z.y,l:B*({right:1,center:.5}[G]||0),r:B*({left:1,center:.5}[G]||0),b:F*({top:1,middle:.5}[J]||0),t:F*({bottom:1,middle:.5}[J]||0)})}function L(P){return t.autoMarginIdRoot+P._index}function S(P,z,I,D){D=D||{};var R=P.select("."+t.itemRectClassName),B=P.select("."+t.itemTextClassName),F=z.borderwidth,V=I.index,G=z._dims;T.setTranslate(P,F+I.x,F+I.y);var J=["up","down"].indexOf(z.direction)!==-1,j=D.height||(J?G.heights[V]:G.height1);R.attr({x:0,y:0,width:D.width||(J?G.width1:G.widths[V]),height:j});var Y=z.font.size*r,X=a.lineCount(B),oe=(X-1)*Y/2;a.positionText(B,t.textOffsetX,j/2-oe+t.textOffsetY),J?I.y+=G.heights[V]+I.yPad:I.x+=G.widths[V]+I.xPad,I.index++}function k(P,z){P.attr(t.menuIndexAttrName,z||"-1").selectAll("g."+t.dropdownButtonClassName).remove()}},{"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plot_api/plot_template":543,"../../plots/plots":619,"../color":366,"../drawing":388,"./constants":466,"./scrollbox":470,"@plotly/d3":58}],469:[function(d,re,ne){arguments[4][463][0].apply(ne,arguments)},{"./attributes":465,"./constants":466,"./defaults":467,"./draw":468,dup:463}],470:[function(d,re,ne){re.exports=e;var w=d("@plotly/d3"),c=d("../color"),M=d("../drawing"),T=d("../../lib");function e(a,n,r){this.gd=a,this.container=n,this.id=r,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(n,r,t){var f=this.gd._fullLayout,o=f.width,i=f.height;this.position=n;var g=this.position.l,p=this.position.w,y=this.position.t,h=this.position.h,m=this.position.direction,u=m==="down",_=m==="left",s=m==="right",A=m==="up",x=p,v=h,b,l,L,S;!u&&!_&&!s&&!A&&(this.position.direction="down",u=!0);var k=u||A;k?(b=g,l=b+x,u?(L=y,S=Math.min(L+v,i),v=S-L):(S=y+v,L=Math.max(S-v,0),v=S-L)):(L=y,S=L+v,_?(l=g+x,b=Math.max(l-x,0),x=l-b):(b=g,l=Math.min(b+x,o),x=l-b)),this._box={l:b,t:L,w:x,h:v};var P=p>x,z=e.barLength+2*e.barPad,I=e.barWidth+2*e.barPad,D=g,R=y+h;R+I>i&&(R=i-I);var B=this.container.selectAll("rect.scrollbar-horizontal").data(P?[0]:[]);B.exit().on(".drag",null).remove(),B.enter().append("rect").classed("scrollbar-horizontal",!0).call(c.fill,e.barColor),P?(this.hbar=B.attr({rx:e.barRadius,ry:e.barRadius,x:D,y:R,width:z,height:I}),this._hbarXMin=D+z/2,this._hbarTranslateMax=x-z):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var F=h>v,V=e.barWidth+2*e.barPad,G=e.barLength+2*e.barPad,J=g+p,j=y;J+V>o&&(J=o-V);var Y=this.container.selectAll("rect.scrollbar-vertical").data(F?[0]:[]);Y.exit().on(".drag",null).remove(),Y.enter().append("rect").classed("scrollbar-vertical",!0).call(c.fill,e.barColor),F?(this.vbar=Y.attr({rx:e.barRadius,ry:e.barRadius,x:J,y:j,width:V,height:G}),this._vbarYMin=j+G/2,this._vbarTranslateMax=v-G):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var X=this.id,oe=b-.5,se=F?l+V+.5:l+.5,ie=L-.5,N=P?S+I+.5:S+.5,U=f._topdefs.selectAll("#"+X).data(P||F?[0]:[]);if(U.exit().remove(),U.enter().append("clipPath").attr("id",X).append("rect"),P||F?(this._clipRect=U.select("rect").attr({x:Math.floor(oe),y:Math.floor(ie),width:Math.ceil(se)-Math.floor(oe),height:Math.ceil(N)-Math.floor(ie)}),this.container.call(M.setClipUrl,X,this.gd),this.bg.attr({x:g,y,width:p,height:h})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(M.setClipUrl,null),delete this._clipRect),P||F){var q=w.behavior.drag().on("dragstart",function(){w.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(q);var Q=w.behavior.drag().on("dragstart",function(){w.event.sourceEvent.preventDefault(),w.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));P&&this.hbar.on(".drag",null).call(Q),F&&this.vbar.on(".drag",null).call(Q)}this.setTranslate(r,t)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(M.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var n=this.translateX,r=this.translateY;this.hbar&&(n-=w.event.dx),this.vbar&&(r-=w.event.dy),this.setTranslate(n,r)},e.prototype._onBoxWheel=function(){var n=this.translateX,r=this.translateY;this.hbar&&(n+=w.event.deltaY),this.vbar&&(r+=w.event.deltaY),this.setTranslate(n,r)},e.prototype._onBarDrag=function(){var n=this.translateX,r=this.translateY;if(this.hbar){var t=n+this._hbarXMin,f=t+this._hbarTranslateMax,o=T.constrain(w.event.x,t,f),i=(o-t)/(f-t),g=this.position.w-this._box.w;n=i*g}if(this.vbar){var p=r+this._vbarYMin,y=p+this._vbarTranslateMax,h=T.constrain(w.event.y,p,y),m=(h-p)/(y-p),u=this.position.h-this._box.h;r=m*u}this.setTranslate(n,r)},e.prototype.setTranslate=function(n,r){var t=this.position.w-this._box.w,f=this.position.h-this._box.h;if(n=T.constrain(n||0,0,t),r=T.constrain(r||0,0,f),this.translateX=n,this.translateY=r,this.container.call(M.setTranslate,this._box.l-this.position.l-n,this._box.t-this.position.t-r),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+n-.5),y:Math.floor(this.position.t+r-.5)}),this.hbar){var o=n/t;this.hbar.call(M.setTranslate,n+o*this._hbarTranslateMax,r)}if(this.vbar){var i=r/f;this.vbar.call(M.setTranslate,n,r+i*this._vbarTranslateMax)}}},{"../../lib":503,"../color":366,"../drawing":388,"@plotly/d3":58}],471:[function(d,re,ne){re.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],472:[function(d,re,ne){re.exports={axisRefDescription:function(w,c,M){return["If set to a",w,"axis id (e.g. *"+w+"* or","*"+w+"2*), the `"+w+"` position refers to a",w,"coordinate. If set to *paper*, the `"+w+"`","position refers to the distance from the",c,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",c,"("+M+"). If set to a",w,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",c,"of the domain of that axis: e.g.,","*"+w+"2 domain* refers to the domain of the second",w," axis and a",w,"position of 0.5 refers to the","point between the",c,"and the",M,"of the domain of the","second",w,"axis."].join(" ")}}},{}],473:[function(d,re,ne){re.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],474:[function(d,re,ne){re.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],475:[function(d,re,ne){re.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],476:[function(d,re,ne){re.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],477:[function(d,re,ne){re.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],478:[function(d,re,ne){re.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],479:[function(d,re,ne){re.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE*1e-4,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],480:[function(d,re,ne){ne.xmlns="http://www.w3.org/2000/xmlns/",ne.svg="http://www.w3.org/2000/svg",ne.xlink="http://www.w3.org/1999/xlink",ne.svgAttrs={xmlns:ne.svg,"xmlns:xlink":ne.xlink}},{}],481:[function(d,re,ne){ne.version=d("./version").version,d("native-promise-only"),d("../build/plotcss");for(var w=d("./registry"),c=ne.register=w.register,M=d("./plot_api"),T=Object.keys(M),e=0;e<T.length;e++){var a=T[e];a.charAt(0)!=="_"&&(ne[a]=M[a]),c({moduleType:"apiMethod",name:a,fn:M[a]})}c(d("./traces/scatter")),c([d("./components/legend"),d("./components/fx"),d("./components/annotations"),d("./components/annotations3d"),d("./components/shapes"),d("./components/images"),d("./components/updatemenus"),d("./components/sliders"),d("./components/rangeslider"),d("./components/rangeselector"),d("./components/grid"),d("./components/errorbars"),d("./components/colorscale"),d("./components/colorbar"),d("./components/modebar")]),c([d("./locale-en"),d("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(c(window.PlotlyLocales),delete window.PlotlyLocales),ne.Icons=d("./fonts/ploticon");var n=d("./components/fx"),r=d("./plots/plots");ne.Plots={resize:r.resize,graphJson:r.graphJson,sendDataToCloud:r.sendDataToCloud},ne.Fx={hover:n.hover,unhover:n.unhover,loneHover:n.loneHover,loneUnhover:n.loneUnhover},ne.Snapshot=d("./snapshot"),ne.PlotSchema=d("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":357,"./components/annotations3d":362,"./components/colorbar":372,"./components/colorscale":378,"./components/errorbars":394,"./components/fx":406,"./components/grid":410,"./components/images":415,"./components/legend":423,"./components/modebar":429,"./components/rangeselector":437,"./components/rangeslider":444,"./components/shapes":458,"./components/sliders":463,"./components/updatemenus":469,"./fonts/ploticon":482,"./locale-en":534,"./locale-en-us":533,"./plot_api":538,"./plot_api/plot_schema":542,"./plots/plots":619,"./registry":638,"./snapshot":643,"./traces/scatter":939,"./version":1123,"native-promise-only":245}],482:[function(d,re,ne){re.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],483:[function(d,re,ne){ne.isLeftAnchor=function(c){return c.xanchor==="left"||c.xanchor==="auto"&&c.x<=1/3},ne.isCenterAnchor=function(c){return c.xanchor==="center"||c.xanchor==="auto"&&c.x>1/3&&c.x<2/3},ne.isRightAnchor=function(c){return c.xanchor==="right"||c.xanchor==="auto"&&c.x>=2/3},ne.isTopAnchor=function(c){return c.yanchor==="top"||c.yanchor==="auto"&&c.y>=2/3},ne.isMiddleAnchor=function(c){return c.yanchor==="middle"||c.yanchor==="auto"&&c.y>1/3&&c.y<2/3},ne.isBottomAnchor=function(c){return c.yanchor==="bottom"||c.yanchor==="auto"&&c.y<=1/3}},{}],484:[function(d,re,ne){var w=d("./mod"),c=w.mod,M=w.modHalf,T=Math.PI,e=2*T;function a(m){return m/180*T}function n(m){return m/T*180}function r(m){return Math.abs(m[1]-m[0])>e-1e-14}function t(m,u){return M(u-m,e)}function f(m,u){return Math.abs(t(m,u))}function o(m,u){if(r(u))return!0;var _,s;u[0]<u[1]?(_=u[0],s=u[1]):(_=u[1],s=u[0]),_=c(_,e),s=c(s,e),_>s&&(s+=e);var A=c(m,e),x=A+e;return A>=_&&A<=s||x>=_&&x<=s}function i(m,u,_,s){if(!o(u,s))return!1;var A,x;return _[0]<_[1]?(A=_[0],x=_[1]):(A=_[1],x=_[0]),m>=A&&m<=x}function g(m,u,_,s,A,x,v){A=A||0,x=x||0;var b=r([_,s]),l,L,S,k,P;b?(l=0,L=T,S=e):_<s?(l=_,S=s):(l=s,S=_),m<u?(k=m,P=u):(k=u,P=m);function z(B,F){return[B*Math.cos(F)+A,x-B*Math.sin(F)]}var I=Math.abs(S-l)<=T?0:1;function D(B,F,V){return"A"+[B,B]+" "+[0,I,V]+" "+z(B,F)}var R;return b?k===null?R="M"+z(P,l)+D(P,L,0)+D(P,S,0)+"Z":R="M"+z(k,l)+D(k,L,0)+D(k,S,0)+"ZM"+z(P,l)+D(P,L,1)+D(P,S,1)+"Z":k===null?(R="M"+z(P,l)+D(P,S,0),v&&(R+="L0,0Z")):R="M"+z(k,l)+"L"+z(P,l)+D(P,S,0)+"L"+z(k,S)+D(k,l,1)+"Z",R}function p(m,u,_,s,A){return g(null,m,u,_,s,A,0)}function y(m,u,_,s,A){return g(null,m,u,_,s,A,1)}function h(m,u,_,s,A,x){return g(m,u,_,s,A,x,1)}re.exports={deg2rad:a,rad2deg:n,angleDelta:t,angleDist:f,isFullCircle:r,isAngleInsideSector:o,isPtInsideSector:i,pathArc:p,pathSector:y,pathAnnulus:h}},{"./mod":510}],485:[function(d,re,ne){var w=Array.isArray,c=ArrayBuffer,M=DataView;function T(r){return c.isView(r)&&!(r instanceof M)}ne.isTypedArray=T;function e(r){return w(r)||T(r)}ne.isArrayOrTypedArray=e;function a(r){return!e(r[0])}ne.isArray1D=a,ne.ensureArray=function(r,t){return w(r)||(r=[]),r.length=t,r},ne.concat=function(){var r=[],t=!0,f=0,o,i,g,p,y,h,m,u;for(g=0;g<arguments.length;g++)p=arguments[g],h=p.length,h&&(i?r.push(p):(i=p,y=h),w(p)?o=!1:(t=!1,f?o!==p.constructor&&(o=!1):o=p.constructor),f+=h);if(!f)return[];if(!r.length)return i;if(t)return i.concat.apply(i,r);if(o){for(m=new o(f),m.set(i),g=0;g<r.length;g++)p=r[g],m.set(p,y),y+=p.length;return m}for(m=new Array(f),u=0;u<i.length;u++)m[u]=i[u];for(g=0;g<r.length;g++){for(p=r[g],u=0;u<p.length;u++)m[y+u]=p[u];y+=u}return m},ne.maxRowLength=function(r){return n(r,Math.max,0)},ne.minRowLength=function(r){return n(r,Math.min,1/0)};function n(r,t,f){if(e(r))if(e(r[0])){for(var o=f,i=0;i<r.length;i++)o=t(o,r[i].length);return o}else return r.length;return 0}},{}],486:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../constants/numerical").BADNUM,M=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;re.exports=function(e){return typeof e=="string"&&(e=e.replace(M,"")),w(e)?Number(e):c}},{"../constants/numerical":479,"fast-isnumeric":190}],487:[function(d,re,ne){re.exports=function(c){var M=c._fullLayout;M._glcanvas&&M._glcanvas.size()&&M._glcanvas.each(function(T){T.regl&&T.regl.clear({color:!0,depth:!0})})}},{}],488:[function(d,re,ne){re.exports=function(c){c._responsiveChartHandler&&(window.removeEventListener("resize",c._responsiveChartHandler),delete c._responsiveChartHandler)}},{}],489:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("tinycolor2"),M=d("../plots/attributes"),T=d("../components/colorscale/scales"),e=d("../components/color"),a=d("../constants/interactions").DESELECTDIM,n=d("./nested_property"),r=d("./regex").counter,t=d("./mod").modHalf,f=d("./array").isArrayOrTypedArray;ne.valObjectMeta={data_array:{coerceFunction:function(i,g,p){f(i)?g.set(i):p!==void 0&&g.set(p)}},enumerated:{coerceFunction:function(i,g,p,y){y.coerceNumber&&(i=+i),y.values.indexOf(i)===-1?g.set(p):g.set(i)},validateFunction:function(i,g){g.coerceNumber&&(i=+i);for(var p=g.values,y=0;y<p.length;y++){var h=String(p[y]);if(h.charAt(0)==="/"&&h.charAt(h.length-1)==="/"){var m=new RegExp(h.substr(1,h.length-2));if(m.test(i))return!0}else if(i===p[y])return!0}return!1}},boolean:{coerceFunction:function(i,g,p){i===!0||i===!1?g.set(i):g.set(p)}},number:{coerceFunction:function(i,g,p,y){!w(i)||y.min!==void 0&&i<y.min||y.max!==void 0&&i>y.max?g.set(p):g.set(+i)}},integer:{coerceFunction:function(i,g,p,y){i%1||!w(i)||y.min!==void 0&&i<y.min||y.max!==void 0&&i>y.max?g.set(p):g.set(+i)}},string:{coerceFunction:function(i,g,p,y){if(typeof i!="string"){var h=typeof i=="number";y.strict===!0||!h?g.set(p):g.set(String(i))}else y.noBlank&&!i?g.set(p):g.set(i)}},color:{coerceFunction:function(i,g,p){c(i).isValid()?g.set(i):g.set(p)}},colorlist:{coerceFunction:function(i,g,p){function y(h){return c(h).isValid()}!Array.isArray(i)||!i.length?g.set(p):i.every(y)?g.set(i):g.set(p)}},colorscale:{coerceFunction:function(i,g,p){g.set(T.get(i,p))}},angle:{coerceFunction:function(i,g,p){i==="auto"?g.set("auto"):w(i)?g.set(t(+i,360)):g.set(p)}},subplotid:{coerceFunction:function(i,g,p,y){var h=y.regex||r(p);if(typeof i=="string"&&h.test(i)){g.set(i);return}g.set(p)},validateFunction:function(i,g){var p=g.dflt;return i===p?!0:typeof i!="string"?!1:!!r(p).test(i)}},flaglist:{coerceFunction:function(i,g,p,y){if(typeof i!="string"){g.set(p);return}if((y.extras||[]).indexOf(i)!==-1){g.set(i);return}for(var h=i.split("+"),m=0;m<h.length;){var u=h[m];y.flags.indexOf(u)===-1||h.indexOf(u)<m?h.splice(m,1):m++}h.length?g.set(h.join("+")):g.set(p)}},any:{coerceFunction:function(i,g,p){i===void 0?g.set(p):g.set(i)}},info_array:{coerceFunction:function(i,g,p,y){function h(z,I,D){var R,B={set:function(F){R=F}};return D===void 0&&(D=I.dflt),ne.valObjectMeta[I.valType].coerceFunction(z,B,D,I),R}var m=y.dimensions===2||y.dimensions==="1-2"&&Array.isArray(i)&&Array.isArray(i[0]);if(!Array.isArray(i)){g.set(p);return}var u=y.items,_=[],s=Array.isArray(u),A=s&&m&&Array.isArray(u[0]),x=m&&s&&!A,v=s&&!x?u.length:i.length,b,l,L,S,k,P;if(p=Array.isArray(p)?p:[],m)for(b=0;b<v;b++)for(_[b]=[],L=Array.isArray(i[b])?i[b]:[],x?k=u.length:s?k=u[b].length:k=L.length,l=0;l<k;l++)x?S=u[l]:s?S=u[b][l]:S=u,P=h(L[l],S,(p[b]||[])[l]),P!==void 0&&(_[b][l]=P);else for(b=0;b<v;b++)P=h(i[b],s?u[b]:u,p[b]),P!==void 0&&(_[b]=P);g.set(_)},validateFunction:function(i,g){if(!Array.isArray(i))return!1;var p=g.items,y=Array.isArray(p),h=g.dimensions===2;if(!g.freeLength&&i.length!==p.length)return!1;for(var m=0;m<i.length;m++)if(h){if(!Array.isArray(i[m])||!g.freeLength&&i[m].length!==p[m].length)return!1;for(var u=0;u<i[m].length;u++)if(!o(i[m][u],y?p[m][u]:p))return!1}else if(!o(i[m],y?p[m]:p))return!1;return!0}}},ne.coerce=function(i,g,p,y,h){var m=n(p,y).get(),u=n(i,y),_=n(g,y),s=u.get(),A=g._template;if(s===void 0&&A&&(s=n(A,y).get(),A=0),h===void 0&&(h=m.dflt),m.arrayOk&&f(s))return _.set(s),s;var x=ne.valObjectMeta[m.valType].coerceFunction;x(s,_,h,m);var v=_.get();return A&&v===h&&!o(s,m)&&(s=n(A,y).get(),x(s,_,h,m),v=_.get()),v},ne.coerce2=function(i,g,p,y,h){var m=n(i,y),u=ne.coerce(i,g,p,y,h),_=m.get();return _!=null?u:!1},ne.coerceFont=function(i,g,p){var y={};return p=p||{},y.family=i(g+".family",p.family),y.size=i(g+".size",p.size),y.color=i(g+".color",p.color),y},ne.coercePattern=function(i,g,p,y){var h=i(g+".shape");if(h){i(g+".solidity"),i(g+".size");var m=i(g+".fillmode"),u=m==="overlay";if(!y){var _=i(g+".bgcolor",u?p:void 0);i(g+".fgcolor",u?e.contrast(_):p)}i(g+".fgopacity",u?.5:1)}},ne.coerceHoverinfo=function(i,g,p){var y=g._module.attributes,h=y.hoverinfo?y:M,m=h.hoverinfo,u;if(p._dataLength===1){var _=m.dflt==="all"?m.flags.slice():m.dflt.split("+");_.splice(_.indexOf("name"),1),u=_.join("+")}return ne.coerce(i,g,h,"hoverinfo",u)},ne.coerceSelectionMarkerOpacity=function(i,g){if(!!i.marker){var p=i.marker.opacity;if(p!==void 0){var y,h;!f(p)&&!i.selected&&!i.unselected&&(y=p,h=a*p),g("selected.marker.opacity",y),g("unselected.marker.opacity",h)}}};function o(i,g){var p=ne.valObjectMeta[g.valType];if(g.arrayOk&&f(i))return!0;if(p.validateFunction)return p.validateFunction(i,g);var y={},h=y,m={set:function(u){h=u}};return p.coerceFunction(i,m,y,g),h!==y}ne.validate=o},{"../components/color":366,"../components/colorscale/scales":381,"../constants/interactions":478,"../plots/attributes":550,"./array":485,"./mod":510,"./nested_property":511,"./regex":520,"fast-isnumeric":190,tinycolor2:312}],490:[function(d,re,ne){var w=d("d3-time-format").timeFormat,c=d("fast-isnumeric"),M=d("./loggers"),T=d("./mod").mod,e=d("../constants/numerical"),a=e.BADNUM,n=e.ONEDAY,r=e.ONEHOUR,t=e.ONEMIN,f=e.ONESEC,o=e.EPOCHJD,i=d("../registry"),g=d("d3-time-format").utcFormat,p=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,y=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,h=new Date().getFullYear()-70;function m(R){return R&&i.componentsRegistry.calendars&&typeof R=="string"&&R!=="gregorian"}ne.dateTick0=function(R,B){var F=u(R,!!B);if(B<2)return F;var V=ne.dateTime2ms(F,R);return V+=n*(B-1),ne.ms2DateTime(V,0,R)};function u(R,B){return m(R)?B?i.getComponentMethod("calendars","CANONICAL_SUNDAY")[R]:i.getComponentMethod("calendars","CANONICAL_TICK")[R]:B?"2000-01-02":"2000-01-01"}ne.dfltRange=function(R){return m(R)?i.getComponentMethod("calendars","DFLTRANGE")[R]:["2000-01-01","2001-01-01"]},ne.isJSDate=function(R){return typeof R=="object"&&R!==null&&typeof R.getTime=="function"};var _,s;ne.dateTime2ms=function(R,B){if(ne.isJSDate(R)){var F=R.getTimezoneOffset()*t,V=(R.getUTCMinutes()-R.getMinutes())*t+(R.getUTCSeconds()-R.getSeconds())*f+(R.getUTCMilliseconds()-R.getMilliseconds());if(V){var G=3*t;F=F-G/2+T(V-F+G/2,G)}return R=Number(R)-F,R>=_&&R<=s?R:a}if(typeof R!="string"&&typeof R!="number")return a;R=String(R);var J=m(B),j=R.charAt(0);J&&(j==="G"||j==="g")&&(R=R.substr(1),B="");var Y=J&&B.substr(0,7)==="chinese",X=R.match(Y?y:p);if(!X)return a;var oe=X[1],se=X[3]||"1",ie=Number(X[5]||1),N=Number(X[7]||0),U=Number(X[9]||0),q=Number(X[11]||0);if(J){if(oe.length===2)return a;oe=Number(oe);var Q;try{var W=i.getComponentMethod("calendars","getCal")(B);if(Y){var Z=se.charAt(se.length-1)==="i";se=parseInt(se,10),Q=W.newDate(oe,W.toMonthIndex(oe,se,Z),ie)}else Q=W.newDate(oe,Number(se),ie)}catch{return a}return Q?(Q.toJD()-o)*n+N*r+U*t+q*f:a}oe.length===2?oe=(Number(oe)+2e3-h)%100+h:oe=Number(oe),se-=1;var ee=new Date(Date.UTC(2e3,se,ie,N,U));return ee.setUTCFullYear(oe),ee.getUTCMonth()!==se||ee.getUTCDate()!==ie?a:ee.getTime()+q*f},_=ne.MIN_MS=ne.dateTime2ms("-9999"),s=ne.MAX_MS=ne.dateTime2ms("9999-12-31 23:59:59.9999"),ne.isDateTime=function(R,B){return ne.dateTime2ms(R,B)!==a};function A(R,B){return String(R+Math.pow(10,B)).substr(1)}var x=90*n,v=3*r,b=5*t;ne.ms2DateTime=function(R,B,F){if(typeof R!="number"||!(R>=_&&R<=s))return a;B||(B=0);var V=Math.floor(T(R+.05,1)*10),G=Math.round(R-V/10),J,j,Y,X,oe,se;if(m(F)){var ie=Math.floor(G/n)+o,N=Math.floor(T(R,n));try{J=i.getComponentMethod("calendars","getCal")(F).fromJD(ie).formatDate("yyyy-mm-dd")}catch{J=g("G%Y-%m-%d")(new Date(G))}if(J.charAt(0)==="-")for(;J.length<11;)J="-0"+J.substr(1);else for(;J.length<10;)J="0"+J;j=B<x?Math.floor(N/r):0,Y=B<x?Math.floor(N%r/t):0,X=B<v?Math.floor(N%t/f):0,oe=B<b?N%f*10+V:0}else se=new Date(G),J=g("%Y-%m-%d")(se),j=B<x?se.getUTCHours():0,Y=B<x?se.getUTCMinutes():0,X=B<v?se.getUTCSeconds():0,oe=B<b?se.getUTCMilliseconds()*10+V:0;return l(J,j,Y,X,oe)},ne.ms2DateTimeLocal=function(R){if(!(R>=_+n&&R<=s-n))return a;var B=Math.floor(T(R+.05,1)*10),F=new Date(Math.round(R-B/10)),V=w("%Y-%m-%d")(F),G=F.getHours(),J=F.getMinutes(),j=F.getSeconds(),Y=F.getUTCMilliseconds()*10+B;return l(V,G,J,j,Y)};function l(R,B,F,V,G){if((B||F||V||G)&&(R+=" "+A(B,2)+":"+A(F,2),(V||G)&&(R+=":"+A(V,2),G))){for(var J=4;G%10===0;)J-=1,G/=10;R+="."+A(G,J)}return R}ne.cleanDate=function(R,B,F){if(R===a)return B;if(ne.isJSDate(R)||typeof R=="number"&&isFinite(R)){if(m(F))return M.error("JS Dates and milliseconds are incompatible with world calendars",R),B;if(R=ne.ms2DateTimeLocal(+R),!R&&B!==void 0)return B}else if(!ne.isDateTime(R,F))return M.error("unrecognized date",R),B;return R};var L=/%\d?f/g,S=/%h/g,k={"1":"1","2":"1","3":"2","4":"2"};function P(R,B,F,V){R=R.replace(L,function(J){var j=Math.min(+J.charAt(1)||6,6),Y=(B/1e3%1+2).toFixed(j).substr(2).replace(/0+$/,"")||"0";return Y});var G=new Date(Math.floor(B+.05));if(R=R.replace(S,function(){return k[F("%q")(G)]}),m(V))try{R=i.getComponentMethod("calendars","worldCalFmt")(R,B,V)}catch{return"Invalid"}return F(R)(G)}var z=[59,59.9,59.99,59.999,59.9999];function I(R,B){var F=T(R+.05,n),V=A(Math.floor(F/r),2)+":"+A(T(Math.floor(F/t),60),2);if(B!=="M"){c(B)||(B=0);var G=Math.min(T(R/f,60),z[B]),J=(100+G).toFixed(B).substr(1);B>0&&(J=J.replace(/0+$/,"").replace(/[\.]$/,"")),V+=":"+J}return V}ne.formatDate=function(R,B,F,V,G,J){if(G=m(G)&&G,!B)if(F==="y")B=J.year;else if(F==="m")B=J.month;else if(F==="d")B=J.dayMonth+`
`+J.year;else return I(R,F)+`
`+P(J.dayMonthYear,R,V,G);return P(B,R,V,G)};var D=3*n;ne.incrementMonth=function(R,B,F){F=m(F)&&F;var V=T(R,n);if(R=Math.round(R-V),F)try{var G=Math.round(R/n)+o,J=i.getComponentMethod("calendars","getCal")(F),j=J.fromJD(G);return B%12?J.add(j,B,"m"):J.add(j,B/12,"y"),(j.toJD()-o)*n+V}catch{M.error("invalid ms "+R+" in calendar "+F)}var Y=new Date(R+D);return Y.setUTCMonth(Y.getUTCMonth()+B)+V-D},ne.findExactDates=function(R,B){for(var F=0,V=0,G=0,J=0,j,Y,X=m(B)&&i.getComponentMethod("calendars","getCal")(B),oe=0;oe<R.length;oe++){if(Y=R[oe],!c(Y)){J++;continue}if(!(Y%n))if(X)try{j=X.fromJD(Y/n+o),j.day()===1?j.month()===1?F++:V++:G++}catch{}else j=new Date(Y),j.getUTCDate()===1?j.getUTCMonth()===0?F++:V++:G++}V+=F,G+=V;var se=R.length-J;return{exactYears:F/se,exactMonths:V/se,exactDays:G/se}}},{"../constants/numerical":479,"../registry":638,"./loggers":507,"./mod":510,"d3-time-format":120,"fast-isnumeric":190}],491:[function(d,re,ne){var w=d("@plotly/d3"),c=d("./loggers"),M=d("./matrix"),T=d("gl-mat4");function e(h){var m;if(typeof h=="string"){if(m=document.getElementById(h),m===null)throw new Error("No DOM element with id '"+h+"' exists on the page.");return m}else if(h==null)throw new Error("DOM element provided is null or undefined");return h}function a(h){var m=w.select(h);return m.node()instanceof HTMLElement&&m.size()&&m.classed("js-plotly-plot")}function n(h){var m=h&&h.parentNode;m&&m.removeChild(h)}function r(h,m){t("global",h,m)}function t(h,m,u){var _="plotly.js-style-"+h,s=document.getElementById(_);s||(s=document.createElement("style"),s.setAttribute("id",_),s.appendChild(document.createTextNode("")),document.head.appendChild(s));var A=s.sheet;A.insertRule?A.insertRule(m+"{"+u+"}",0):A.addRule?A.addRule(m,u,0):c.warn("addStyleRule failed")}function f(h){var m="plotly.js-style-"+h,u=document.getElementById(m);u&&n(u)}function o(h){var m=g(h),u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return m.forEach(function(_){var s=i(_);if(s){var A=M.convertCssMatrix(s);u=T.multiply(u,u,A)}}),u}function i(h){var m=window.getComputedStyle(h,null),u=m.getPropertyValue("-webkit-transform")||m.getPropertyValue("-moz-transform")||m.getPropertyValue("-ms-transform")||m.getPropertyValue("-o-transform")||m.getPropertyValue("transform");return u==="none"?null:u.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(_){return+_})}function g(h){for(var m=[];p(h);)m.push(h),h=h.parentNode;return m}function p(h){return h&&(h instanceof Element||h instanceof HTMLElement)}function y(h,m){return h&&m&&h.x===m.x&&h.y===m.y&&h.top===m.top&&h.left===m.left&&h.right===m.right&&h.bottom===m.bottom}re.exports={getGraphDiv:e,isPlotDiv:a,removeElement:n,addStyleRule:r,addRelatedStyleRule:t,deleteRelatedStyleRule:f,getFullTransformMatrix:o,getElementTransformMatrix:i,getElementAndAncestors:g,equalDomRects:y}},{"./loggers":507,"./matrix":509,"@plotly/d3":58,"gl-mat4":210}],492:[function(d,re,ne){var w=d("events").EventEmitter,c={init:function(M){if(M._ev instanceof w)return M;var T=new w,e=new w;return M._ev=T,M._internalEv=e,M.on=T.on.bind(T),M.once=T.once.bind(T),M.removeListener=T.removeListener.bind(T),M.removeAllListeners=T.removeAllListeners.bind(T),M._internalOn=e.on.bind(e),M._internalOnce=e.once.bind(e),M._removeInternalListener=e.removeListener.bind(e),M._removeAllInternalListeners=e.removeAllListeners.bind(e),M.emit=function(a,n){typeof jQuery!="undefined"&&jQuery(M).trigger(a,n),T.emit(a,n),e.emit(a,n)},M},triggerHandler:function(M,T,e){var a,n;typeof jQuery!="undefined"&&(a=jQuery(M).triggerHandler(T,e));var r=M._ev;if(!r)return a;var t=r._events[T];if(!t)return a;function f(i){if(i.listener){if(r.removeListener(T,i.listener),!i.fired)return i.fired=!0,i.listener.apply(r,[e])}else return i.apply(r,[e])}t=Array.isArray(t)?t:[t];var o;for(o=0;o<t.length-1;o++)f(t[o]);return n=f(t[o]),a!==void 0?a:n},purge:function(M){return delete M._ev,delete M.on,delete M.once,delete M.removeListener,delete M.removeAllListeners,delete M.emit,delete M._ev,delete M._internalEv,delete M._internalOn,delete M._internalOnce,delete M._removeInternalListener,delete M._removeAllInternalListeners,M}};re.exports=c},{events:84}],493:[function(d,re,ne){var w=d("./is_plain_object.js"),c=Array.isArray;function M(e,a){var n,r;for(n=0;n<e.length;n++){if(r=e[n],r!==null&&typeof r=="object")return!1;r!==void 0&&(a[n]=r)}return!0}ne.extendFlat=function(){return T(arguments,!1,!1,!1)},ne.extendDeep=function(){return T(arguments,!0,!1,!1)},ne.extendDeepAll=function(){return T(arguments,!0,!0,!1)},ne.extendDeepNoArrays=function(){return T(arguments,!0,!1,!0)};function T(e,a,n,r){var t=e[0],f=e.length,o,i,g,p,y,h,m;if(f===2&&c(t)&&c(e[1])&&t.length===0){if(m=M(e[1],t),m)return t;t.splice(0,t.length)}for(var u=1;u<f;u++){o=e[u];for(i in o)g=t[i],p=o[i],r&&c(p)?t[i]=p:a&&p&&(w(p)||(y=c(p)))?(y?(y=!1,h=g&&c(g)?g:[]):h=g&&w(g)?g:{},t[i]=T([h,p],a,n,r)):(typeof p!="undefined"||n)&&(t[i]=p)}return t}},{"./is_plain_object.js":504}],494:[function(d,re,ne){re.exports=function(c){for(var M={},T=[],e=0,a=0;a<c.length;a++){var n=c[a];M[n]!==1&&(M[n]=1,T[e++]=n)}return T}},{}],495:[function(d,re,ne){re.exports=function(e){for(var a=M(e)?c:w,n=[],r=0;r<e.length;r++){var t=e[r];a(t)&&n.push(t)}return n};function w(T){return T.visible===!0}function c(T){var e=T[0].trace;return e.visible===!0&&e._length!==0}function M(T){return Array.isArray(T)&&Array.isArray(T[0])&&T[0][0]&&T[0][0].trace}},{}],496:[function(d,re,ne){var w=d("@plotly/d3"),c=d("country-regex"),M=d("@turf/area"),T=d("@turf/centroid"),e=d("@turf/bbox"),a=d("./identity"),n=d("./loggers"),r=d("./is_plain_object"),t=d("./nested_property"),f=d("./polygon"),o=Object.keys(c),i={"ISO-3":a,"USA-states":a,"country names":g};function g(A){for(var x=0;x<o.length;x++){var v=o[x],b=new RegExp(c[v]);if(b.test(A.trim().toLowerCase()))return v}return n.log("Unrecognized country name: "+A+"."),!1}function p(A,x,v){if(!x||typeof x!="string")return!1;var b=i[A](x),l,L,S;if(b){if(A==="USA-states")for(l=[],S=0;S<v.length;S++)L=v[S],L.properties&&L.properties.gu&&L.properties.gu==="USA"&&l.push(L);else l=v;for(S=0;S<l.length;S++)if(L=l[S],L.id===b)return L;n.log(["Location with id",b,"does not have a matching topojson feature at this resolution."].join(" "))}return!1}function y(A){var x=A.geometry,v=x.coordinates,b=A.id,l=[],L,S,k,P;function z(I){for(var D=0;D<I.length-1;D++)if(I[D][0]>0&&I[D+1][0]<0)return D;return null}switch(b==="RUS"||b==="FJI"?L=function(I){var D;if(z(I)===null)D=I;else for(D=new Array(I.length),P=0;P<I.length;P++)D[P]=[I[P][0]<0?I[P][0]+360:I[P][0],I[P][1]];l.push(f.tester(D))}:b==="ATA"?L=function(I){var D=z(I);if(D===null)return l.push(f.tester(I));var R=new Array(I.length+1),B=0;for(P=0;P<I.length;P++)P>D?R[B++]=[I[P][0]+360,I[P][1]]:P===D?(R[B++]=I[P],R[B++]=[I[P][0],-90]):R[B++]=I[P];var F=f.tester(R);F.pts.pop(),l.push(F)}:L=function(I){l.push(f.tester(I))},x.type){case"MultiPolygon":for(S=0;S<v.length;S++)for(k=0;k<v[S].length;k++)L(v[S][k]);break;case"Polygon":for(S=0;S<v.length;S++)L(v[S]);break}return l}function h(A){var x=A.geojson,v=window.PlotlyGeoAssets||{},b=typeof x=="string"?v[x]:x;return r(b)?b:(n.error("Oops ... something went wrong when fetching "+x),!1)}function m(A){var x=A[0].trace,v=h(x);if(!v)return!1;var b={},l=[],L;for(L=0;L<x._length;L++){var S=A[L];(S.loc||S.loc===0)&&(b[S.loc]=S)}function k(I){var D=t(I,x.featureidkey||"id").get(),R=b[D];if(R){var B=I.geometry;if(B.type==="Polygon"||B.type==="MultiPolygon"){var F={type:"Feature",id:D,geometry:B,properties:{}};F.properties.ct=u(F),R.fIn=I,R.fOut=F,l.push(F)}else n.log(["Location",R.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete b[D]}switch(v.type){case"FeatureCollection":var P=v.features;for(L=0;L<P.length;L++)k(P[L]);break;case"Feature":k(v);break;default:return n.warn(["Invalid GeoJSON type",(v.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var z in b)n.log(["Location *"+z+"*","does not have a matching feature with id-key","*"+x.featureidkey+"*."].join(" "));return l}function u(A){var x=A.geometry,v;if(x.type==="MultiPolygon")for(var b=x.coordinates,l=0,L=0;L<b.length;L++){var S={type:"Polygon",coordinates:b[L]},k=M.default(S);k>l&&(l=k,v=S)}else v=x;return T.default(v).geometry.coordinates}function _(A){var x=window.PlotlyGeoAssets||{},v=[];function b(P){return new Promise(function(z,I){w.json(P,function(D,R){if(D){delete x[P];var B=D.status===404?'GeoJSON at URL "'+P+'" does not exist.':"Unexpected error while fetching from "+P;return I(new Error(B))}return x[P]=R,z(R)})})}function l(P){return new Promise(function(z,I){var D=0,R=setInterval(function(){if(x[P]&&x[P]!=="pending")return clearInterval(R),z(x[P]);if(D>100)return clearInterval(R),I("Unexpected error while fetching from "+P);D++},50)})}for(var L=0;L<A.length;L++){var S=A[L][0].trace,k=S.geojson;typeof k=="string"&&(x[k]?x[k]==="pending"&&v.push(l(k)):(x[k]="pending",v.push(b(k))))}return v}function s(A){return e.default(A)}re.exports={locationToFeature:p,feature2polygons:y,getTraceGeojson:h,extractTraceFeature:m,fetchTraceGeoData:_,computeBbox:s}},{"./identity":501,"./is_plain_object":504,"./loggers":507,"./nested_property":511,"./polygon":515,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],497:[function(d,re,ne){var w=d("../constants/numerical").BADNUM;ne.calcTraceToLineCoords=function(c){for(var M=c[0].trace,T=M.connectgaps,e=[],a=[],n=0;n<c.length;n++){var r=c[n],t=r.lonlat;t[0]!==w?a.push(t):!T&&a.length>0&&(e.push(a),a=[])}return a.length>0&&e.push(a),e},ne.makeLine=function(c){return c.length===1?{type:"LineString",coordinates:c[0]}:{type:"MultiLineString",coordinates:c}},ne.makePolygon=function(c){if(c.length===1)return{type:"Polygon",coordinates:c};for(var M=new Array(c.length),T=0;T<c.length;T++)M[T]=[c[T]];return{type:"MultiPolygon",coordinates:M}},ne.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":479}],498:[function(d,re,ne){var w=d("./mod").mod;ne.segmentsIntersect=c;function c(n,r,t,f,o,i,g,p){var y=t-n,h=o-n,m=g-o,u=f-r,_=i-r,s=p-i,A=y*s-m*u;if(A===0)return null;var x=(h*s-m*_)/A,v=(h*u-y*_)/A;return v<0||v>1||x<0||x>1?null:{x:n+y*x,y:r+u*x}}ne.segmentDistance=function(r,t,f,o,i,g,p,y){if(c(r,t,f,o,i,g,p,y))return 0;var h=f-r,m=o-t,u=p-i,_=y-g,s=h*h+m*m,A=u*u+_*_,x=Math.min(M(h,m,s,i-r,g-t),M(h,m,s,p-r,y-t),M(u,_,A,r-i,t-g),M(u,_,A,f-i,o-g));return Math.sqrt(x)};function M(n,r,t,f,o){var i=f*n+o*r;if(i<0)return f*f+o*o;if(i>t){var g=f-n,p=o-r;return g*g+p*p}else{var y=f*r-o*n;return y*y/t}}var T,e,a;ne.getTextLocation=function(r,t,f,o){if((r!==e||o!==a)&&(T={},e=r,a=o),T[f])return T[f];var i=r.getPointAtLength(w(f-o/2,t)),g=r.getPointAtLength(w(f+o/2,t)),p=Math.atan((g.y-i.y)/(g.x-i.x)),y=r.getPointAtLength(w(f,t)),h=(y.x*4+i.x+g.x)/6,m=(y.y*4+i.y+g.y)/6,u={x:h,y:m,theta:p};return T[f]=u,u},ne.clearLocationCache=function(){e=null},ne.getVisibleSegment=function(r,t,f){var o=t.left,i=t.right,g=t.top,p=t.bottom,y=0,h=r.getTotalLength(),m=h,u,_;function s(x){var v=r.getPointAtLength(x);x===0?u=v:x===h&&(_=v);var b=v.x<o?o-v.x:v.x>i?v.x-i:0,l=v.y<g?g-v.y:v.y>p?v.y-p:0;return Math.sqrt(b*b+l*l)}for(var A=s(y);A;){if(y+=A+f,y>m)return;A=s(y)}for(A=s(m);A;){if(m-=A+f,y>m)return;A=s(m)}return{min:y,max:m,len:m-y,total:h,isClosed:y===0&&m===h&&Math.abs(u.x-_.x)<.1&&Math.abs(u.y-_.y)<.1}},ne.findPointOnPath=function(r,t,f,o){o=o||{};for(var i=o.pathLength||r.getTotalLength(),g=o.tolerance||.001,p=o.iterationLimit||30,y=r.getPointAtLength(0)[f]>r.getPointAtLength(i)[f]?-1:1,h=0,m=0,u=i,_,s,A;h<p;){if(_=(m+u)/2,s=r.getPointAtLength(_),A=s[f]-t,Math.abs(A)<g)return s;y*A>0?u=_:m=_,h++}return s}},{"./mod":510}],499:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("tinycolor2"),M=d("color-normalize"),T=d("../components/colorscale"),e=d("../components/color/attributes").defaultLine,a=d("./array").isArrayOrTypedArray,n=M(e),r=1;function t(p,y){var h=p;return h[3]*=y,h}function f(p){if(w(p))return n;var y=M(p);return y.length?y:n}function o(p){return w(p)?p:r}function i(p,y,h){var m=p.color,u=a(m),_=a(y),s=T.extractOpts(p),A=[],x,v,b,l,L;if(s.colorscale!==void 0?x=T.makeColorScaleFuncFromTrace(p):x=f,u?v=function(k,P){return k[P]===void 0?n:M(x(k[P]))}:v=f,_?b=function(k,P){return k[P]===void 0?r:o(k[P])}:b=o,u||_)for(var S=0;S<h;S++)l=v(m,S),L=b(y,S),A[S]=t(l,L);else A=t(M(m),y);return A}function g(p){var y=T.extractOpts(p),h=y.colorscale;return y.reversescale&&(h=T.flipScale(y.colorscale)),h.map(function(m){var u=m[0],_=c(m[1]),s=_.toRgb();return{index:u,rgb:[s.r,s.g,s.b,s.a]}})}re.exports={formatColor:i,parseColorScale:g}},{"../components/color/attributes":365,"../components/colorscale":378,"./array":485,"color-normalize":89,"fast-isnumeric":190,tinycolor2:312}],500:[function(d,re,ne){var w=d("./identity");function c(M){return[M]}re.exports={keyFun:function(M){return M.key},repeat:c,descend:w,wrap:c,unwrap:function(M){return M[0]}}},{"./identity":501}],501:[function(d,re,ne){re.exports=function(c){return c}},{}],502:[function(d,re,ne){re.exports=function(c,M){if(!M)return c;var T=1/Math.abs(M),e=T>1?(T*c+T*M)/T:c+M,a=String(e).length;if(a>16){var n=String(M).length,r=String(c).length;if(a>=r+n){var t=parseFloat(e).toPrecision(12);t.indexOf("e+")===-1&&(e=+t)}}return e}},{}],503:[function(d,re,ne){var w=d("@plotly/d3"),c=d("d3-time-format").utcFormat,M=d("d3-format").format,T=d("fast-isnumeric"),e=d("../constants/numerical"),a=e.FP_SAFE,n=-a,r=e.BADNUM,t=re.exports={};t.adjustFormat=function(se){return!se||/^\d[.]\df/.test(se)||/[.]\d%/.test(se)?se:se==="0.f"?"~f":/^\d%/.test(se)?"~%":/^\ds/.test(se)?"~s":!/^[~,.0$]/.test(se)&&/[&fps]/.test(se)?"~"+se:se};var f={};t.warnBadFormat=function(oe){var se=String(oe);f[se]||(f[se]=1,t.warn('encountered bad format: "'+se+'"'))},t.noFormat=function(oe){return String(oe)},t.numberFormat=function(oe){var se;try{se=M(t.adjustFormat(oe))}catch{return t.warnBadFormat(oe),t.noFormat}return se},t.nestedProperty=d("./nested_property"),t.keyedContainer=d("./keyed_container"),t.relativeAttr=d("./relative_attr"),t.isPlainObject=d("./is_plain_object"),t.toLogRange=d("./to_log_range"),t.relinkPrivateKeys=d("./relink_private");var o=d("./array");t.isTypedArray=o.isTypedArray,t.isArrayOrTypedArray=o.isArrayOrTypedArray,t.isArray1D=o.isArray1D,t.ensureArray=o.ensureArray,t.concat=o.concat,t.maxRowLength=o.maxRowLength,t.minRowLength=o.minRowLength;var i=d("./mod");t.mod=i.mod,t.modHalf=i.modHalf;var g=d("./coerce");t.valObjectMeta=g.valObjectMeta,t.coerce=g.coerce,t.coerce2=g.coerce2,t.coerceFont=g.coerceFont,t.coercePattern=g.coercePattern,t.coerceHoverinfo=g.coerceHoverinfo,t.coerceSelectionMarkerOpacity=g.coerceSelectionMarkerOpacity,t.validate=g.validate;var p=d("./dates");t.dateTime2ms=p.dateTime2ms,t.isDateTime=p.isDateTime,t.ms2DateTime=p.ms2DateTime,t.ms2DateTimeLocal=p.ms2DateTimeLocal,t.cleanDate=p.cleanDate,t.isJSDate=p.isJSDate,t.formatDate=p.formatDate,t.incrementMonth=p.incrementMonth,t.dateTick0=p.dateTick0,t.dfltRange=p.dfltRange,t.findExactDates=p.findExactDates,t.MIN_MS=p.MIN_MS,t.MAX_MS=p.MAX_MS;var y=d("./search");t.findBin=y.findBin,t.sorterAsc=y.sorterAsc,t.sorterDes=y.sorterDes,t.distinctVals=y.distinctVals,t.roundUp=y.roundUp,t.sort=y.sort,t.findIndexOfMin=y.findIndexOfMin,t.sortObjectKeys=d("./sort_object_keys");var h=d("./stats");t.aggNums=h.aggNums,t.len=h.len,t.mean=h.mean,t.median=h.median,t.midRange=h.midRange,t.variance=h.variance,t.stdev=h.stdev,t.interp=h.interp;var m=d("./matrix");t.init2dArray=m.init2dArray,t.transposeRagged=m.transposeRagged,t.dot=m.dot,t.translationMatrix=m.translationMatrix,t.rotationMatrix=m.rotationMatrix,t.rotationXYMatrix=m.rotationXYMatrix,t.apply3DTransform=m.apply3DTransform,t.apply2DTransform=m.apply2DTransform,t.apply2DTransform2=m.apply2DTransform2,t.convertCssMatrix=m.convertCssMatrix,t.inverseTransformMatrix=m.inverseTransformMatrix;var u=d("./angles");t.deg2rad=u.deg2rad,t.rad2deg=u.rad2deg,t.angleDelta=u.angleDelta,t.angleDist=u.angleDist,t.isFullCircle=u.isFullCircle,t.isAngleInsideSector=u.isAngleInsideSector,t.isPtInsideSector=u.isPtInsideSector,t.pathArc=u.pathArc,t.pathSector=u.pathSector,t.pathAnnulus=u.pathAnnulus;var _=d("./anchor_utils");t.isLeftAnchor=_.isLeftAnchor,t.isCenterAnchor=_.isCenterAnchor,t.isRightAnchor=_.isRightAnchor,t.isTopAnchor=_.isTopAnchor,t.isMiddleAnchor=_.isMiddleAnchor,t.isBottomAnchor=_.isBottomAnchor;var s=d("./geometry2d");t.segmentsIntersect=s.segmentsIntersect,t.segmentDistance=s.segmentDistance,t.getTextLocation=s.getTextLocation,t.clearLocationCache=s.clearLocationCache,t.getVisibleSegment=s.getVisibleSegment,t.findPointOnPath=s.findPointOnPath;var A=d("./extend");t.extendFlat=A.extendFlat,t.extendDeep=A.extendDeep,t.extendDeepAll=A.extendDeepAll,t.extendDeepNoArrays=A.extendDeepNoArrays;var x=d("./loggers");t.log=x.log,t.warn=x.warn,t.error=x.error;var v=d("./regex");t.counterRegex=v.counter;var b=d("./throttle");t.throttle=b.throttle,t.throttleDone=b.done,t.clearThrottle=b.clear;var l=d("./dom");t.getGraphDiv=l.getGraphDiv,t.isPlotDiv=l.isPlotDiv,t.removeElement=l.removeElement,t.addStyleRule=l.addStyleRule,t.addRelatedStyleRule=l.addRelatedStyleRule,t.deleteRelatedStyleRule=l.deleteRelatedStyleRule,t.getFullTransformMatrix=l.getFullTransformMatrix,t.getElementTransformMatrix=l.getElementTransformMatrix,t.getElementAndAncestors=l.getElementAndAncestors,t.equalDomRects=l.equalDomRects,t.clearResponsive=d("./clear_responsive"),t.preserveDrawingBuffer=d("./preserve_drawing_buffer"),t.makeTraceGroups=d("./make_trace_groups"),t._=d("./localize"),t.notifier=d("./notifier"),t.filterUnique=d("./filter_unique"),t.filterVisible=d("./filter_visible"),t.pushUnique=d("./push_unique"),t.increment=d("./increment"),t.cleanNumber=d("./clean_number"),t.ensureNumber=function(se){return T(se)?(se=Number(se),se>a||se<n?r:se):r},t.isIndex=function(oe,se){return se!==void 0&&oe>=se?!1:T(oe)&&oe>=0&&oe%1===0},t.noop=d("./noop"),t.identity=d("./identity"),t.repeat=function(oe,se){for(var ie=new Array(se),N=0;N<se;N++)ie[N]=oe;return ie},t.swapAttrs=function(oe,se,ie,N){ie||(ie="x"),N||(N="y");for(var U=0;U<se.length;U++){var q=se[U],Q=t.nestedProperty(oe,q.replace("?",ie)),W=t.nestedProperty(oe,q.replace("?",N)),Z=Q.get();Q.set(W.get()),W.set(Z)}},t.raiseToTop=function(se){se.parentNode.appendChild(se)},t.cancelTransition=function(oe){return oe.transition().duration(0)},t.constrain=function(oe,se,ie){return se>ie?Math.max(ie,Math.min(se,oe)):Math.max(se,Math.min(ie,oe))},t.bBoxIntersect=function(oe,se,ie){return ie=ie||0,oe.left<=se.right+ie&&se.left<=oe.right+ie&&oe.top<=se.bottom+ie&&se.top<=oe.bottom+ie},t.simpleMap=function(oe,se,ie,N,U){for(var q=oe.length,Q=new Array(q),W=0;W<q;W++)Q[W]=se(oe[W],ie,N,U);return Q},t.randstr=function oe(se,ie,N,U){if(N||(N=16),ie===void 0&&(ie=24),ie<=0)return"0";var q=Math.log(Math.pow(2,ie))/Math.log(N),Q="",W,Z,ee;for(W=2;q===1/0;W*=2)q=Math.log(Math.pow(2,ie/W))/Math.log(N)*W;var te=q-Math.floor(q);for(W=0;W<Math.floor(q);W++)ee=Math.floor(Math.random()*N).toString(N),Q=ee+Q;te&&(Z=Math.pow(N,te),ee=Math.floor(Math.random()*Z).toString(N),Q=ee+Q);var ae=parseInt(Q,N);return se&&se[Q]||ae!==1/0&&ae>=Math.pow(2,ie)?U>10?(t.warn("randstr failed uniqueness"),Q):oe(se,ie,N,(U||0)+1):Q},t.OptionControl=function(oe,se){oe||(oe={}),se||(se="opt");var ie={};return ie.optionList=[],ie._newoption=function(N){N[se]=oe,ie[N.name]=N,ie.optionList.push(N)},ie["_"+se]=oe,ie},t.smooth=function(oe,se){if(se=Math.round(se)||0,se<2)return oe;var ie=oe.length,N=2*ie,U=2*se-1,q=new Array(U),Q=new Array(ie),W,Z,ee,te;for(W=0;W<U;W++)q[W]=(1-Math.cos(Math.PI*(W+1)/se))/(2*se);for(W=0;W<ie;W++){for(te=0,Z=0;Z<U;Z++)ee=W+Z+1-se,ee<-ie?ee-=N*Math.round(ee/N):ee>=N&&(ee-=N*Math.floor(ee/N)),ee<0?ee=-1-ee:ee>=ie&&(ee=N-1-ee),te+=oe[ee]*q[Z];Q[W]=te}return Q},t.syncOrAsync=function(oe,se,ie){var N,U;function q(){return t.syncOrAsync(oe,se,ie)}for(;oe.length;)if(U=oe.splice(0,1)[0],N=U(se),N&&N.then)return N.then(q);return ie&&ie(se)},t.stripTrailingSlash=function(oe){return oe.substr(-1)==="/"?oe.substr(0,oe.length-1):oe},t.noneOrAll=function(oe,se,ie){if(!!oe){var N=!1,U=!0,q,Q;for(q=0;q<ie.length;q++)Q=oe[ie[q]],Q!=null?N=!0:U=!1;if(N&&!U)for(q=0;q<ie.length;q++)oe[ie[q]]=se[ie[q]]}},t.mergeArray=function(oe,se,ie,N){var U=typeof N=="function";if(t.isArrayOrTypedArray(oe))for(var q=Math.min(oe.length,se.length),Q=0;Q<q;Q++){var W=oe[Q];se[Q][ie]=U?N(W):W}},t.mergeArrayCastPositive=function(oe,se,ie){return t.mergeArray(oe,se,ie,function(N){var U=+N;return isFinite(U)&&U>0?U:0})},t.fillArray=function(oe,se,ie,N){if(N=N||t.identity,t.isArrayOrTypedArray(oe))for(var U=0;U<se.length;U++)se[U][ie]=N(oe[U])},t.castOption=function(oe,se,ie,N){N=N||t.identity;var U=t.nestedProperty(oe,ie).get();return t.isArrayOrTypedArray(U)?Array.isArray(se)&&t.isArrayOrTypedArray(U[se[0]])?N(U[se[0]][se[1]]):N(U[se]):U},t.extractOption=function(oe,se,ie,N){if(ie in oe)return oe[ie];var U=t.nestedProperty(se,N).get();if(!Array.isArray(U))return U};function L(oe){var se={};for(var ie in oe)for(var N=oe[ie],U=0;U<N.length;U++)se[N[U]]=+ie;return se}t.tagSelected=function(oe,se,ie){var N=se.selectedpoints,U=se._indexToPoints,q;U&&(q=L(U));function Q(ae){return ae!==void 0&&ae<oe.length}for(var W=0;W<N.length;W++){var Z=N[W];if(t.isIndex(Z)||t.isArrayOrTypedArray(Z)&&t.isIndex(Z[0])&&t.isIndex(Z[1])){var ee=q?q[Z]:Z,te=ie?ie[ee]:ee;Q(te)&&(oe[te].selected=1)}}},t.selIndices2selPoints=function(oe){var se=oe.selectedpoints,ie=oe._indexToPoints;if(ie){for(var N=L(ie),U=[],q=0;q<se.length;q++){var Q=se[q];if(t.isIndex(Q)){var W=N[Q];t.isIndex(W)&&U.push(W)}}return U}else return se},t.getTargetArray=function(oe,se){var ie=se.target;if(typeof ie=="string"&&ie){var N=t.nestedProperty(oe,ie).get();return Array.isArray(N)?N:!1}else if(Array.isArray(ie))return ie;return!1},t.minExtend=function(oe,se){var ie={};typeof se!="object"&&(se={});var N=3,U=Object.keys(oe),q,Q,W;for(q=0;q<U.length;q++)Q=U[q],W=oe[Q],!(Q.charAt(0)==="_"||typeof W=="function")&&(Q==="module"?ie[Q]=W:Array.isArray(W)?Q==="colorscale"?ie[Q]=W.slice():ie[Q]=W.slice(0,N):t.isTypedArray(W)?ie[Q]=W.subarray(0,N):W&&typeof W=="object"?ie[Q]=t.minExtend(oe[Q],se[Q]):ie[Q]=W);for(U=Object.keys(se),q=0;q<U.length;q++)Q=U[q],W=se[Q],(typeof W!="object"||!(Q in ie)||typeof ie[Q]!="object")&&(ie[Q]=W);return ie},t.titleCase=function(oe){return oe.charAt(0).toUpperCase()+oe.substr(1)},t.containsAny=function(oe,se){for(var ie=0;ie<se.length;ie++)if(oe.indexOf(se[ie])!==-1)return!0;return!1},t.isIE=function(){return typeof window.navigator.msSaveBlob!="undefined"};var S=/Version\/[\d\.]+.*Safari/;t.isSafari=function(){return S.test(window.navigator.userAgent)};var k=/iPad|iPhone|iPod/;t.isIOS=function(){return k.test(window.navigator.userAgent)};var P=/Firefox\/(\d+)\.\d+/;t.getFirefoxVersion=function(){var oe=P.exec(window.navigator.userAgent);if(oe&&oe.length===2){var se=parseInt(oe[1]);if(!isNaN(se))return se}return null},t.isD3Selection=function(oe){return oe instanceof w.selection},t.ensureSingle=function(oe,se,ie,N){var U=oe.select(se+(ie?"."+ie:""));if(U.size())return U;var q=oe.append(se);return ie&&q.classed(ie,!0),N&&q.call(N),q},t.ensureSingleById=function(oe,se,ie,N){var U=oe.select(se+"#"+ie);if(U.size())return U;var q=oe.append(se).attr("id",ie);return N&&q.call(N),q},t.objectFromPath=function(oe,se){for(var ie=oe.split("."),N,U=N={},q=0;q<ie.length;q++){var Q=ie[q],W=null,Z=ie[q].match(/(.*)\[([0-9]+)\]/);Z?(Q=Z[1],W=Z[2],N=N[Q]=[],q===ie.length-1?N[W]=se:N[W]={},N=N[W]):(q===ie.length-1?N[Q]=se:N[Q]={},N=N[Q])}return U};var z=/^([^\[\.]+)\.(.+)?/,I=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;t.expandObjectPaths=function(oe){var se,ie,N,U,q,Q,W;if(typeof oe=="object"&&!Array.isArray(oe))for(ie in oe)oe.hasOwnProperty(ie)&&((se=ie.match(z))?(U=oe[ie],N=se[1],delete oe[ie],oe[N]=t.extendDeepNoArrays(oe[N]||{},t.objectFromPath(ie,t.expandObjectPaths(U))[N])):(se=ie.match(I))?(U=oe[ie],N=se[1],q=parseInt(se[2]),delete oe[ie],oe[N]=oe[N]||[],se[3]==="."?(W=se[4],Q=oe[N][q]=oe[N][q]||{},t.extendDeepNoArrays(Q,t.objectFromPath(W,t.expandObjectPaths(U)))):oe[N][q]=t.expandObjectPaths(U)):oe[ie]=t.expandObjectPaths(oe[ie]));return oe},t.numSeparate=function(oe,se,ie){if(ie||(ie=!1),typeof se!="string"||se.length===0)throw new Error("Separator string required for formatting!");typeof oe=="number"&&(oe=String(oe));var N=/(\d+)(\d{3})/,U=se.charAt(0),q=se.charAt(1),Q=oe.split("."),W=Q[0],Z=Q.length>1?U+Q[1]:"";if(q&&(Q.length>1||W.length>4||ie))for(;N.test(W);)W=W.replace(N,"$1"+q+"$2");return W+Z},t.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var D=/^\w*$/;t.templateString=function(oe,se){var ie={};return oe.replace(t.TEMPLATE_STRING_REGEX,function(N,U){var q;return D.test(U)?q=se[U]:(ie[U]=ie[U]||t.nestedProperty(se,U).get,q=ie[U]()),t.isValidTextValue(q)?q:""})};var R={max:10,count:0,name:"hovertemplate"};t.hovertemplateString=function(){return V.apply(R,arguments)};var B={max:10,count:0,name:"texttemplate"};t.texttemplateString=function(){return V.apply(B,arguments)};var F=/^[:|\|]/;function V(oe,se,ie){var N=this,U=arguments;se||(se={});var q={};return oe.replace(t.TEMPLATE_STRING_REGEX,function(Q,W,Z){var ee=W==="xother"||W==="yother",te=W==="_xother"||W==="_yother",ae=W==="_xother_"||W==="_yother_",le=W==="xother_"||W==="yother_",ye=ee||te||le||ae,fe=W;(te||ae)&&(fe=fe.substring(1)),(le||ae)&&(fe=fe.substring(0,fe.length-1));var pe;if(ye){if(pe=se[fe],pe===void 0)return""}else{var ge,Ae;for(Ae=3;Ae<U.length;Ae++)if(ge=U[Ae],!!ge){if(ge.hasOwnProperty(fe)){pe=ge[fe];break}if(D.test(fe)||(pe=t.nestedProperty(ge,fe).get(),pe=q[fe]||t.nestedProperty(ge,fe).get(),pe&&(q[fe]=pe)),pe!==void 0)break}}if(pe===void 0&&N)return N.count<N.max&&(t.warn("Variable '"+fe+"' in "+N.name+" could not be found!"),pe=Q),N.count===N.max&&t.warn("Too many "+N.name+" warnings - additional warnings will be suppressed"),N.count++,Q;if(Z){var we;if(Z[0]===":"&&(we=ie?ie.numberFormat:t.numberFormat,pe=we(Z.replace(F,""))(pe)),Z[0]==="|"){we=ie?ie.timeFormat:c;var De=t.dateTime2ms(pe);pe=t.formatDate(De,Z.replace(F,""),!1,we)}}else{var Be=fe+"Label";se.hasOwnProperty(Be)&&(pe=se[Be])}return ye&&(pe="("+pe+")",(te||ae)&&(pe=" "+pe),(le||ae)&&(pe=pe+" ")),pe})}var G=48,J=57;t.subplotSort=function(oe,se){for(var ie=Math.min(oe.length,se.length)+1,N=0,U=0,q=0;q<ie;q++){var Q=oe.charCodeAt(q)||0,W=se.charCodeAt(q)||0,Z=Q>=G&&Q<=J,ee=W>=G&&W<=J;if(Z&&(N=10*N+Q-G),ee&&(U=10*U+W-G),!Z||!ee){if(N!==U)return N-U;if(Q!==W)return Q-W}}return U-N};var j=2e9;t.seedPseudoRandom=function(){j=2e9},t.pseudoRandom=function(){var oe=j;return j=(69069*j+1)%4294967296,Math.abs(j-oe)<429496729?t.pseudoRandom():j/4294967296},t.fillText=function(oe,se,ie){var N=Array.isArray(ie)?function(Q){ie.push(Q)}:function(Q){ie.text=Q},U=t.extractOption(oe,se,"htx","hovertext");if(t.isValidTextValue(U))return N(U);var q=t.extractOption(oe,se,"tx","text");if(t.isValidTextValue(q))return N(q)},t.isValidTextValue=function(oe){return oe||oe===0},t.formatPercent=function(oe,se){se=se||0;for(var ie=(Math.round(100*oe*Math.pow(10,se))*Math.pow(.1,se)).toFixed(se)+"%",N=0;N<se;N++)ie.indexOf(".")!==-1&&(ie=ie.replace("0%","%"),ie=ie.replace(".%","%"));return ie},t.isHidden=function(oe){var se=window.getComputedStyle(oe).display;return!se||se==="none"},t.strTranslate=function(oe,se){return oe||se?"translate("+oe+","+se+")":""},t.strRotate=function(oe){return oe?"rotate("+oe+")":""},t.strScale=function(oe){return oe!==1?"scale("+oe+")":""},t.getTextTransform=function(oe){var se=oe.noCenter,ie=oe.textX,N=oe.textY,U=oe.targetX,q=oe.targetY,Q=oe.anchorX||0,W=oe.anchorY||0,Z=oe.rotate,ee=oe.scale;return ee?ee>1&&(ee=1):ee=0,t.strTranslate(U-ee*(ie+Q),q-ee*(N+W))+t.strScale(ee)+(Z?"rotate("+Z+(se?"":" "+ie+" "+N)+")":"")},t.ensureUniformFontSize=function(oe,se){var ie=t.extendFlat({},se);return ie.size=Math.max(se.size,oe._fullLayout.uniformtext.minsize||0),ie},t.join2=function(oe,se,ie){var N=oe.length;return N>1?oe.slice(0,-1).join(se)+ie+oe[N-1]:oe.join(se)},t.bigFont=function(oe){return Math.round(1.2*oe)};var Y=t.getFirefoxVersion(),X=Y!==null&&Y<86;t.getPositionFromD3Event=function(){return X?[w.event.layerX,w.event.layerY]:[w.event.offsetX,w.event.offsetY]}},{"../constants/numerical":479,"./anchor_utils":483,"./angles":484,"./array":485,"./clean_number":486,"./clear_responsive":488,"./coerce":489,"./dates":490,"./dom":491,"./extend":493,"./filter_unique":494,"./filter_visible":495,"./geometry2d":498,"./identity":501,"./increment":502,"./is_plain_object":504,"./keyed_container":505,"./localize":506,"./loggers":507,"./make_trace_groups":508,"./matrix":509,"./mod":510,"./nested_property":511,"./noop":512,"./notifier":513,"./preserve_drawing_buffer":517,"./push_unique":518,"./regex":520,"./relative_attr":521,"./relink_private":522,"./search":523,"./sort_object_keys":526,"./stats":527,"./throttle":530,"./to_log_range":531,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],504:[function(d,re,ne){re.exports=function(c){return window&&window.process&&window.process.versions?Object.prototype.toString.call(c)==="[object Object]":Object.prototype.toString.call(c)==="[object Object]"&&Object.getPrototypeOf(c).hasOwnProperty("hasOwnProperty")}},{}],505:[function(d,re,ne){var w=d("./nested_property"),c=/^\w*$/,M=0,T=1,e=2,a=3,n=4;re.exports=function(t,f,o,i){o=o||"name",i=i||"value";var g,p,y,h={};f&&f.length?(y=w(t,f),p=y.get()):p=t,f=f||"";var m={};if(p)for(g=0;g<p.length;g++)m[p[g][o]]=g;var u=c.test(i),_={set:function(s,A){var x=A===null?n:M;if(!p){if(!y||x===n)return;p=[],y.set(p)}var v=m[s];if(v===void 0){if(x===n)return;x=x|a,v=p.length,m[s]=v}else A!==(u?p[v][i]:w(p[v],i).get())&&(x=x|e);var b=p[v]=p[v]||{};return b[o]=s,u?b[i]=A:w(b,i).set(A),A!==null&&(x=x&~n),h[v]=h[v]|x,_},get:function(s){if(!!p){var A=m[s];if(A!==void 0)return u?p[A][i]:w(p[A],i).get()}},rename:function(s,A){var x=m[s];return x===void 0||(h[x]=h[x]|T,m[A]=x,delete m[s],p[x][o]=A),_},remove:function(s){var A=m[s];if(A===void 0)return _;var x=p[A];if(Object.keys(x).length>2)return h[A]=h[A]|e,_.set(s,null);if(u){for(g=A;g<p.length;g++)h[g]=h[g]|a;for(g=A;g<p.length;g++)m[p[g][o]]--;p.splice(A,1),delete m[s]}else w(x,i).set(null),h[A]=h[A]|e|n;return _},constructUpdate:function(){for(var s,A,x={},v=Object.keys(h),b=0;b<v.length;b++)A=v[b],s=f+"["+A+"]",p[A]?(h[A]&T&&(x[s+"."+o]=p[A][o]),h[A]&e&&(u?x[s+"."+i]=h[A]&n?null:p[A][i]:x[s+"."+i]=h[A]&n?null:w(p[A],i).get())):x[s]=null;return x}};return _}},{"./nested_property":511}],506:[function(d,re,ne){var w=d("../registry");re.exports=function(M,T){for(var e=M._context.locale,a=0;a<2;a++){for(var n=M._context.locales,r=0;r<2;r++){var t=(n[e]||{}).dictionary;if(t){var f=t[T];if(f)return f}n=w.localeRegistry}var o=e.split("-")[0];if(o===e)break;e=o}return T}},{"../registry":638}],507:[function(d,re,ne){var w=d("../plot_api/plot_config").dfltConfig,c=d("./notifier"),M=re.exports={};M.log=function(){var T;if(w.logging>1){var e=["LOG:"];for(T=0;T<arguments.length;T++)e.push(arguments[T]);console.trace.apply(console,e)}if(w.notifyOnLogging>1){var a=[];for(T=0;T<arguments.length;T++)a.push(arguments[T]);c(a.join("<br>"),"long")}},M.warn=function(){var T;if(w.logging>0){var e=["WARN:"];for(T=0;T<arguments.length;T++)e.push(arguments[T]);console.trace.apply(console,e)}if(w.notifyOnLogging>0){var a=[];for(T=0;T<arguments.length;T++)a.push(arguments[T]);c(a.join("<br>"),"stick")}},M.error=function(){var T;if(w.logging>0){var e=["ERROR:"];for(T=0;T<arguments.length;T++)e.push(arguments[T]);console.error.apply(console,e)}if(w.notifyOnLogging>0){var a=[];for(T=0;T<arguments.length;T++)a.push(arguments[T]);c(a.join("<br>"),"stick")}}},{"../plot_api/plot_config":541,"./notifier":513}],508:[function(d,re,ne){var w=d("@plotly/d3");re.exports=function(M,T,e){var a=M.selectAll("g."+e.replace(/\s/g,".")).data(T,function(r){return r[0].trace.uid});a.exit().remove(),a.enter().append("g").attr("class",e),a.order();var n=M.classed("rangeplot")?"nodeRangePlot3":"node3";return a.each(function(r){r[0][n]=w.select(this)}),a}},{"@plotly/d3":58}],509:[function(d,re,ne){var w=d("gl-mat4");ne.init2dArray=function(c,M){for(var T=new Array(c),e=0;e<c;e++)T[e]=new Array(M);return T},ne.transposeRagged=function(c){var M=0,T=c.length,e,a;for(e=0;e<T;e++)M=Math.max(M,c[e].length);var n=new Array(M);for(e=0;e<M;e++)for(n[e]=new Array(T),a=0;a<T;a++)n[e][a]=c[a][e];return n},ne.dot=function(c,M){if(!(c.length&&M.length)||c.length!==M.length)return null;var T=c.length,e,a;if(c[0].length)for(e=new Array(T),a=0;a<T;a++)e[a]=ne.dot(c[a],M);else if(M[0].length){var n=ne.transposeRagged(M);for(e=new Array(n.length),a=0;a<n.length;a++)e[a]=ne.dot(c,n[a])}else for(e=0,a=0;a<T;a++)e+=c[a]*M[a];return e},ne.translationMatrix=function(c,M){return[[1,0,c],[0,1,M],[0,0,1]]},ne.rotationMatrix=function(c){var M=c*Math.PI/180;return[[Math.cos(M),-Math.sin(M),0],[Math.sin(M),Math.cos(M),0],[0,0,1]]},ne.rotationXYMatrix=function(c,M,T){return ne.dot(ne.dot(ne.translationMatrix(M,T),ne.rotationMatrix(c)),ne.translationMatrix(-M,-T))},ne.apply3DTransform=function(c){return function(){var M=arguments,T=arguments.length===1?M[0]:[M[0],M[1],M[2]||0];return ne.dot(c,[T[0],T[1],T[2],1]).slice(0,3)}},ne.apply2DTransform=function(c){return function(){var M=arguments;M.length===3&&(M=M[0]);var T=arguments.length===1?M[0]:[M[0],M[1]];return ne.dot(c,[T[0],T[1],1]).slice(0,2)}},ne.apply2DTransform2=function(c){var M=ne.apply2DTransform(c);return function(T){return M(T.slice(0,2)).concat(M(T.slice(2,4)))}},ne.convertCssMatrix=function(c){if(c){var M=c.length;if(M===16)return c;if(M===6)return[c[0],c[1],0,0,c[2],c[3],0,0,0,0,1,0,c[4],c[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},ne.inverseTransformMatrix=function(c){var M=[];return w.invert(M,c),[[M[0],M[1],M[2],M[3]],[M[4],M[5],M[6],M[7]],[M[8],M[9],M[10],M[11]],[M[12],M[13],M[14],M[15]]]}},{"gl-mat4":210}],510:[function(d,re,ne){function w(M,T){var e=M%T;return e<0?e+T:e}function c(M,T){return Math.abs(M)>T/2?M-Math.round(M/T)*T:M}re.exports={mod:w,modHalf:c}},{}],511:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("./array").isArrayOrTypedArray;re.exports=function(i,g){if(w(g))g=String(g);else if(typeof g!="string"||g.substr(g.length-4)==="[-1]")throw"bad property string";for(var p=0,y=g.split("."),h,m,u;p<y.length;){if(h=String(y[p]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/),h){if(h[1])y[p]=h[1];else if(p===0)y.splice(0,1);else throw"bad property string";for(m=h[2].substr(1,h[2].length-2).split("]["),u=0;u<m.length;u++)p++,y.splice(p,0,Number(m[u]))}p++}return typeof i!="object"?f(i,g,y):{set:a(i,y,g),get:M(i,y),astr:g,parts:y,obj:i}};function M(o,i){return function(){var g=o,p,y,h,m,u;for(m=0;m<i.length-1;m++){if(p=i[m],p===-1){for(y=!0,h=[],u=0;u<g.length;u++)h[u]=M(g[u],i.slice(m+1))(),h[u]!==h[0]&&(y=!1);return y?h[0]:h}if(typeof p=="number"&&!c(g)||(g=g[p],typeof g!="object"||g===null))return}if(!(typeof g!="object"||g===null)&&(h=g[i[m]],h!==null))return h}}var T=/(^|\.)args\[/;function e(o,i){return o===void 0||o===null&&!i.match(T)}function a(o,i,g){return function(p){var y=o,h="",m=e(p,g),u,_;for(_=0;_<i.length-1;_++){if(u=i[_],typeof u=="number"&&!c(y))throw"array index but container is not an array";if(u===-1){if(m=!r(y,i.slice(_+1),p,g),m)break;return}if(!t(y,u,i[_+1],m))break;if(y=y[u],typeof y!="object"||y===null)throw"container is not an object";h=n(h,u)}if(m){if(_===i.length-1&&(delete y[i[_]],Array.isArray(y)&&+i[_]===y.length-1))for(;y.length&&y[y.length-1]===void 0;)y.pop()}else y[i[_]]=p}}function n(o,i){var g=i;return w(i)?g="["+i+"]":o&&(g="."+i),o+g}function r(o,i,g,p){var y=c(g),h=!0,m=g,u=p.replace("-1",0),_=y?!1:e(g,u),s=i[0],A;for(A=0;A<o.length;A++)u=p.replace("-1",A),y&&(m=g[A%g.length],_=e(m,u)),_&&(h=!1),t(o,A,s,_)&&a(o[A],i,p.replace("-1",A))(m);return h}function t(o,i,g,p){if(o[i]===void 0){if(p)return!1;typeof g=="number"?o[i]=[]:o[i]={}}return!0}function f(o,i,g){return{set:function(){throw"bad container"},get:function(){},astr:i,parts:g,obj:o}}},{"./array":485,"fast-isnumeric":190}],512:[function(d,re,ne){re.exports=function(){}},{}],513:[function(d,re,ne){var w=d("@plotly/d3"),c=d("fast-isnumeric"),M=[];re.exports=function(T,e){if(M.indexOf(T)!==-1)return;M.push(T);var a=1e3;c(e)?a=e:e==="long"&&(a=3e3);var n=w.select("body").selectAll(".plotly-notifier").data([0]);n.enter().append("div").classed("plotly-notifier",!0);var r=n.selectAll(".notifier-note").data(M);function t(f){f.duration(700).style("opacity",0).each("end",function(o){var i=M.indexOf(o);i!==-1&&M.splice(i,1),w.select(this).remove()})}r.enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(f){var o=w.select(this);o.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){o.transition().call(t)});for(var i=o.append("p"),g=f.split(/<br\s*\/?>/g),p=0;p<g.length;p++)p&&i.append("br"),i.append("span").text(g[p]);e==="stick"?o.transition().duration(350).style("opacity",1):o.transition().duration(700).style("opacity",1).transition().delay(a).call(t)})}},{"@plotly/d3":58,"fast-isnumeric":190}],514:[function(d,re,ne){var w=d("./setcursor"),c="data-savedcursor",M="!!";re.exports=function(e,a){var n=e.attr(c);if(a){if(!n){for(var r=(e.attr("class")||"").split(" "),t=0;t<r.length;t++){var f=r[t];f.indexOf("cursor-")===0&&e.attr(c,f.substr(7)).classed(f,!1)}e.attr(c)||e.attr(c,M)}w(e,a)}else n&&(e.attr(c,null),n===M?w(e):w(e,n))}},{"./setcursor":524}],515:[function(d,re,ne){var w=d("./matrix").dot,c=d("../constants/numerical").BADNUM,M=re.exports={};M.tester=function(e){var a=e.slice(),n=a[0][0],r=n,t=a[0][1],f=t,o;for(a.push(a[0]),o=1;o<a.length;o++)n=Math.min(n,a[o][0]),r=Math.max(r,a[o][0]),t=Math.min(t,a[o][1]),f=Math.max(f,a[o][1]);var i=!1,g;a.length===5&&(a[0][0]===a[1][0]?a[2][0]===a[3][0]&&a[0][1]===a[3][1]&&a[1][1]===a[2][1]&&(i=!0,g=function(u){return u[0]===a[0][0]}):a[0][1]===a[1][1]&&a[2][1]===a[3][1]&&a[0][0]===a[3][0]&&a[1][0]===a[2][0]&&(i=!0,g=function(u){return u[1]===a[0][1]}));function p(u,_){var s=u[0],A=u[1];return!(s===c||s<n||s>r||A===c||A<t||A>f||_&&g(u))}function y(u,_){var s=u[0],A=u[1];if(s===c||s<n||s>r||A===c||A<t||A>f)return!1;var x=a.length,v=a[0][0],b=a[0][1],l=0,L,S,k,P,z;for(L=1;L<x;L++)if(S=v,k=b,v=a[L][0],b=a[L][1],P=Math.min(S,v),!(s<P||s>Math.max(S,v)||A>Math.max(k,b)))if(A<Math.min(k,b))s!==P&&l++;else{if(v===S?z=A:z=k+(s-S)*(b-k)/(v-S),A===z)return!(L===1&&_);A<=z&&s!==P&&l++}return l%2===1}var h=!0,m=a[0];for(o=1;o<a.length;o++)if(m[0]!==a[o][0]||m[1]!==a[o][1]){h=!1;break}return{xmin:n,xmax:r,ymin:t,ymax:f,pts:a,contains:i?p:y,isRect:i,degenerate:h}},M.isSegmentBent=function(e,a,n,r){var t=e[a],f=[e[n][0]-t[0],e[n][1]-t[1]],o=w(f,f),i=Math.sqrt(o),g=[-f[1]/i,f[0]/i],p,y,h;for(p=a+1;p<n;p++)if(y=[e[p][0]-t[0],e[p][1]-t[1]],h=w(y,f),h<0||h>o||Math.abs(w(y,g))>r)return!0;return!1},M.filter=function(e,a){var n=[e[0]],r=0,t=0;function f(i){e.push(i);var g=n.length,p=r;n.splice(t+1);for(var y=p+1;y<e.length;y++)(y===e.length-1||M.isSegmentBent(e,p,y+1,a))&&(n.push(e[y]),n.length<g-2&&(r=y,t=n.length-1),p=y)}if(e.length>1){var o=e.pop();f(o)}return{addPt:f,raw:e,filtered:n}}},{"../constants/numerical":479,"./matrix":509}],516:[function(d,re,ne){(function(w){(function(){var c=d("./show_no_webgl_msg"),M=d("regl");re.exports=function(e,a,n){var r=e._fullLayout,t=!0;return r._glcanvas.each(function(f){if(f.regl){f.regl.preloadCachedCode(n);return}if(!(f.pick&&!r._has("parcoords"))){try{f.regl=M({canvas:this,attributes:{antialias:!f.pick,preserveDrawingBuffer:!0},pixelRatio:e._context.plotGlPixelRatio||w.devicePixelRatio,extensions:a||[],cachedCode:n||{}})}catch{t=!1}f.regl||(t=!1),t&&this.addEventListener("webglcontextlost",function(o){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:o,layer:f.key})},!1)}}),t||c({container:r._glcontainer.node()}),t}}).call(this)}).call(this,typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./show_no_webgl_msg":525,regl:283}],517:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("is-mobile");re.exports=function(e){var a;if(e&&e.hasOwnProperty("userAgent")?a=e.userAgent:a=M(),typeof a!="string")return!0;var n=c({ua:{headers:{"user-agent":a}},tablet:!0,featureDetect:!1});if(!n)for(var r=a.split(" "),t=1;t<r.length;t++){var f=r[t];if(f.indexOf("Safari")!==-1)for(var o=t-1;o>-1;o--){var i=r[o];if(i.substr(0,8)==="Version/"){var g=i.substr(8).split(".")[0];if(w(g)&&(g=+g),g>=13)return!0}}}return n};function M(){var T;return typeof navigator!="undefined"&&(T=navigator.userAgent),T&&T.headers&&typeof T.headers["user-agent"]=="string"&&(T=T.headers["user-agent"]),T}},{"fast-isnumeric":190,"is-mobile":234}],518:[function(d,re,ne){re.exports=function(c,M){if(M instanceof RegExp){for(var T=M.toString(),e=0;e<c.length;e++)if(c[e]instanceof RegExp&&c[e].toString()===T)return c;c.push(M)}else(M||M===0)&&c.indexOf(M)===-1&&c.push(M);return c}},{}],519:[function(d,re,ne){var w=d("../lib"),c=d("../plot_api/plot_config").dfltConfig;function M(e,a){for(var n=[],r,t=0;t<a.length;t++)r=a[t],r===e?n[t]=r:typeof r=="object"?n[t]=Array.isArray(r)?w.extendDeep([],r):w.extendDeepAll({},r):n[t]=r;return n}var T={};T.add=function(e,a,n,r,t){var f,o;if(e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},o=e.undoQueue.index,e.autoplay){e.undoQueue.inSequence||(e.autoplay=!1);return}!e.undoQueue.sequence||e.undoQueue.beginSequence?(f={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},e.undoQueue.queue.splice(o,e.undoQueue.queue.length-o,f),e.undoQueue.index+=1):f=e.undoQueue.queue[o-1],e.undoQueue.beginSequence=!1,f&&(f.undo.calls.unshift(a),f.undo.args.unshift(n),f.redo.calls.push(r),f.redo.args.push(t)),e.undoQueue.queue.length>c.queueLength&&(e.undoQueue.queue.shift(),e.undoQueue.index--)},T.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!0,e.undoQueue.beginSequence=!0},T.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!1,e.undoQueue.beginSequence=!1},T.undo=function(a){var n,r;if(!(a.undoQueue===void 0||isNaN(a.undoQueue.index)||a.undoQueue.index<=0)){for(a.undoQueue.index--,n=a.undoQueue.queue[a.undoQueue.index],a.undoQueue.inSequence=!0,r=0;r<n.undo.calls.length;r++)T.plotDo(a,n.undo.calls[r],n.undo.args[r]);a.undoQueue.inSequence=!1,a.autoplay=!1}},T.redo=function(a){var n,r;if(!(a.undoQueue===void 0||isNaN(a.undoQueue.index)||a.undoQueue.index>=a.undoQueue.queue.length)){for(n=a.undoQueue.queue[a.undoQueue.index],a.undoQueue.inSequence=!0,r=0;r<n.redo.calls.length;r++)T.plotDo(a,n.redo.calls[r],n.redo.args[r]);a.undoQueue.inSequence=!1,a.autoplay=!1,a.undoQueue.index++}},T.plotDo=function(e,a,n){e.autoplay=!0,n=M(e,n),a.apply(null,n)},re.exports=T},{"../lib":503,"../plot_api/plot_config":541}],520:[function(d,re,ne){ne.counter=function(w,c,M,T){var e=(c||"")+(M?"":"$"),a=T===!1?"":"^";return w==="xy"?new RegExp(a+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(a+w+"([2-9]|[1-9][0-9]+)?"+e)}},{}],521:[function(d,re,ne){var w=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,c=/^[^\.\[\]]+$/;re.exports=function(M,T){for(;T;){var e=M.match(w);if(e)M=e[1];else if(M.match(c))M="";else throw new Error("bad relativeAttr call:"+[M,T]);if(T.charAt(0)==="^")T=T.slice(1);else break}return M&&T.charAt(0)!=="["?M+"."+T:M+T}},{}],522:[function(d,re,ne){var w=d("./array").isArrayOrTypedArray,c=d("./is_plain_object");re.exports=function M(T,e){for(var a in e){var n=e[a],r=T[a];if(r!==n)if(a.charAt(0)==="_"||typeof n=="function"){if(a in T)continue;T[a]=n}else if(w(n)&&w(r)&&c(n[0])){if(a==="customdata"||a==="ids")continue;for(var t=Math.min(n.length,r.length),f=0;f<t;f++)r[f]!==n[f]&&c(n[f])&&c(r[f])&&M(r[f],n[f])}else c(n)&&c(r)&&(M(r,n),Object.keys(r).length||delete T[a])}}},{"./array":485,"./is_plain_object":504}],523:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("./loggers"),M=d("./identity"),T=d("../constants/numerical").BADNUM,e=1e-9;ne.findBin=function(f,o,i){if(w(o.start))return i?Math.ceil((f-o.start)/o.size-e)-1:Math.floor((f-o.start)/o.size+e);var g=0,p=o.length,y=0,h=p>1?(o[p-1]-o[0])/(p-1):1,m,u;for(h>=0?u=i?a:n:u=i?t:r,f+=h*e*(i?-1:1)*(h>=0?1:-1);g<p&&y++<100;)m=Math.floor((g+p)/2),u(o[m],f)?g=m+1:p=m;return y>90&&c.log("Long binary search..."),g-1};function a(f,o){return f<o}function n(f,o){return f<=o}function r(f,o){return f>o}function t(f,o){return f>=o}ne.sorterAsc=function(f,o){return f-o},ne.sorterDes=function(f,o){return o-f},ne.distinctVals=function(f){var o=f.slice();o.sort(ne.sorterAsc);var i;for(i=o.length-1;i>-1&&o[i]===T;i--);for(var g=o[i]-o[0]||1,p=g/(i||1)/1e4,y=[],h,m=0;m<=i;m++){var u=o[m],_=u-h;h===void 0?(y.push(u),h=u):_>p&&(g=Math.min(g,_),y.push(u),h=u)}return{vals:y,minDiff:g}},ne.roundUp=function(f,o,i){for(var g=0,p=o.length-1,y,h=0,m=i?0:1,u=i?1:0,_=i?Math.ceil:Math.floor;g<p&&h++<100;)y=_((g+p)/2),o[y]<=f?g=y+m:p=y-u;return o[g]},ne.sort=function(f,o){for(var i=0,g=0,p=1;p<f.length;p++){var y=o(f[p],f[p-1]);if(y<0?i=1:y>0&&(g=1),i&&g)return f.sort(o)}return g?f:f.reverse()},ne.findIndexOfMin=function(f,o){o=o||M;for(var i=1/0,g,p=0;p<f.length;p++){var y=o(f[p]);y<i&&(i=y,g=p)}return g}},{"../constants/numerical":479,"./identity":501,"./loggers":507,"fast-isnumeric":190}],524:[function(d,re,ne){re.exports=function(c,M){(c.attr("class")||"").split(" ").forEach(function(T){T.indexOf("cursor-")===0&&c.classed(T,!1)}),M&&c.classed("cursor-"+M,!0)}},{}],525:[function(d,re,ne){var w=d("../components/color"),c=function(){};re.exports=function(T){for(var e in T)typeof T[e]=="function"&&(T[e]=c);T.destroy=function(){T.container.parentNode.removeChild(T.container)};var a=document.createElement("div");a.className="no-webgl",a.style.cursor="pointer",a.style.fontSize="24px",a.style.color=w.defaults[0],a.style.position="absolute",a.style.left=a.style.top="0px",a.style.width=a.style.height="100%",a.style["background-color"]=w.lightLine,a.style["z-index"]=30;var n=document.createElement("p");return n.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",n.style.position="relative",n.style.top="50%",n.style.left="50%",n.style.height="30%",n.style.width="50%",n.style.margin="-15% 0 0 -25%",a.appendChild(n),T.container.appendChild(a),T.container.style.background="#FFFFFF",T.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":366}],526:[function(d,re,ne){re.exports=function(c){return Object.keys(c).sort()}},{}],527:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("./array").isArrayOrTypedArray;ne.aggNums=function(M,T,e,a){var n,r;if((!a||a>e.length)&&(a=e.length),w(T)||(T=!1),c(e[0])){for(r=new Array(a),n=0;n<a;n++)r[n]=ne.aggNums(M,T,e[n]);e=r}for(n=0;n<a;n++)w(T)?w(e[n])&&(T=M(+T,+e[n])):T=e[n];return T},ne.len=function(M){return ne.aggNums(function(T){return T+1},0,M)},ne.mean=function(M,T){return T||(T=ne.len(M)),ne.aggNums(function(e,a){return e+a},0,M)/T},ne.midRange=function(M){if(!(M===void 0||M.length===0))return(ne.aggNums(Math.max,null,M)+ne.aggNums(Math.min,null,M))/2},ne.variance=function(M,T,e){return T||(T=ne.len(M)),w(e)||(e=ne.mean(M,T)),ne.aggNums(function(a,n){return a+Math.pow(n-e,2)},0,M)/T},ne.stdev=function(M,T,e){return Math.sqrt(ne.variance(M,T,e))},ne.median=function(M){var T=M.slice().sort();return ne.interp(T,.5)},ne.interp=function(M,T){if(!w(T))throw"n should be a finite number";if(T=T*M.length-.5,T<0)return M[0];if(T>M.length-1)return M[M.length-1];var e=T%1;return e*M[Math.ceil(T)]+(1-e)*M[Math.floor(T)]}},{"./array":485,"fast-isnumeric":190}],528:[function(d,re,ne){var w=d("color-normalize");function c(M){return M?w(M):[0,0,0,1]}re.exports=c},{"color-normalize":89}],529:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../lib"),M=c.strTranslate,T=d("../constants/xmlns_namespaces"),e=d("../constants/alignment").LINE_SPACING,a=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;ne.convertToTspans=function(F,V,G){var J=F.text(),j=!F.attr("data-notex")&&V&&V._context.typesetMath&&typeof MathJax!="undefined"&&J.match(a),Y=w.select(F.node().parentNode);if(Y.empty())return;var X=F.attr("class")?F.attr("class").split(" ")[0]:"text";X+="-math",Y.selectAll("svg."+X).remove(),Y.selectAll("g."+X+"-group").remove(),F.style("display",null).attr({"data-unformatted":J,"data-math":"N"});function oe(){Y.empty()||(X=F.attr("class")+"-math",Y.select("svg."+X).remove()),F.text("").style("white-space","pre");var se=I(F.node(),J);se&&F.style("pointer-events","all"),ne.positionText(F),G&&G.call(F)}return j?(V&&V._promises||[]).push(new Promise(function(se){F.style("display","none");var ie=parseInt(F.node().style.fontSize,10),N={fontSize:ie};o(j[2],N,function(U,q,Q){Y.selectAll("svg."+X).remove(),Y.selectAll("g."+X+"-group").remove();var W=U&&U.select("svg");if(!W||!W.node()){oe(),se();return}var Z=Y.append("g").classed(X+"-group",!0).attr({"pointer-events":"none","data-unformatted":J,"data-math":"Y"});Z.node().appendChild(W.node()),q&&q.node()&&W.node().insertBefore(q.node().cloneNode(!0),W.node().firstChild);var ee=Q.width,te=Q.height;W.attr({class:X,height:te,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var ae=F.node().style.fill||"black",le=W.select("g");le.attr({fill:ae,stroke:ae});var ye=le.node().getBoundingClientRect(),fe=ye.width,pe=ye.height;(fe>ee||pe>te)&&(W.style("overflow","hidden"),ye=W.node().getBoundingClientRect(),fe=ye.width,pe=ye.height);var ge=+F.attr("x"),Ae=+F.attr("y"),we=ie||F.node().getBoundingClientRect().height,De=-we/4;if(X[0]==="y")Z.attr({transform:"rotate("+[-90,ge,Ae]+")"+M(-fe/2,De-pe/2)});else if(X[0]==="l")Ae=De-pe/2;else if(X[0]==="a"&&X.indexOf("atitle")!==0)ge=0,Ae=De;else{var Be=F.attr("text-anchor");ge=ge-fe*(Be==="middle"?.5:Be==="end"?1:0),Ae=Ae+De-pe/2}W.attr({x:ge,y:Ae}),G&&G.call(F,Z),se(Z)})})):oe(),F};var n=/(<|&lt;|&#60;)/g,r=/(>|&gt;|&#62;)/g;function t(F){return F.replace(n,"\\lt ").replace(r,"\\gt ")}var f=[["$","$"],["\\(","\\)"]];function o(F,V,G){var J=parseInt((MathJax.version||"").split(".")[0]);if(J!==2&&J!==3){c.warn("No MathJax version:",MathJax.version);return}var j,Y,X,oe,se=function(){return Y=c.extendDeepAll({},MathJax.Hub.config),X=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:f},displayAlign:"left"})},ie=function(){Y=c.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=f},N=function(){if(j=MathJax.Hub.config.menuSettings.renderer,j!=="SVG")return MathJax.Hub.setRenderer("SVG")},U=function(){j=MathJax.config.startup.output,j!=="svg"&&(MathJax.config.startup.output="svg")},q=function(){var ae="math-output-"+c.randstr({},64);oe=w.select("body").append("div").attr({id:ae}).style({visibility:"hidden",position:"absolute","font-size":V.fontSize+"px"}).text(t(F));var le=oe.node();return J===2?MathJax.Hub.Typeset(le):MathJax.typeset([le])},Q=function(){var ae=oe.select(J===2?".MathJax_SVG":".MathJax"),le=!ae.empty()&&oe.select("svg").node();if(!le)c.log("There was an error in the tex syntax.",F),G();else{var ye=le.getBoundingClientRect(),fe;J===2?fe=w.select("body").select("#MathJax_SVG_glyphs"):fe=ae.select("defs"),G(ae,fe,ye)}oe.remove()},W=function(){if(j!=="SVG")return MathJax.Hub.setRenderer(j)},Z=function(){j!=="svg"&&(MathJax.config.startup.output=j)},ee=function(){return X!==void 0&&(MathJax.Hub.processSectionDelay=X),MathJax.Hub.Config(Y)},te=function(){MathJax.config=Y};J===2?MathJax.Hub.Queue(se,N,q,Q,W,ee):J===3&&(ie(),U(),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){q(),Q(),Z(),te()}))}var i={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},g={sub:"0.3em",sup:"-0.6em"},p={sub:"-0.21em",sup:"0.42em"},y="\u200B",h=["http:","https:","mailto:","",void 0,":"],m=ne.NEWLINES=/(\r\n?|\n)/g,u=/(<[^<>]*>)/,_=/<(\/?)([^ >]*)(\s+(.*))?>/i,s=/<br(\s+.*)?>/i;ne.BR_TAG_ALL=/<br(\s+.*)?>/gi;var A=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,x=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,v=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,b=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function l(F,V){if(!F)return null;var G=F.match(V),J=G&&(G[3]||G[4]);return J&&P(J)}var L=/(^|;)\s*color:/;ne.plainText=function(F,V){V=V||{};for(var G=V.len!==void 0&&V.len!==-1?V.len:1/0,J=V.allowedTags!==void 0?V.allowedTags:["br"],j="...",Y=j.length,X=F.split(u),oe=[],se="",ie=0,N=0;N<X.length;N++){var U=X[N],q=U.match(_),Q=q&&q[2].toLowerCase();if(Q)J.indexOf(Q)!==-1&&(oe.push(U),se=Q);else{var W=U.length;if(ie+W<G)oe.push(U),ie+=W;else if(ie<G){var Z=G-ie;se&&(se!=="br"||Z<=Y||W<=Y)&&oe.pop(),G>Y?oe.push(U.substr(0,Z-Y)+j):oe.push(U.substr(0,Z));break}se=""}}return oe.join("")};var S={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},k=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function P(F){return F.replace(k,function(V,G){var J;return G.charAt(0)==="#"?J=z(G.charAt(1)==="x"?parseInt(G.substr(2),16):parseInt(G.substr(1),10)):J=S[G],J||V})}ne.convertEntities=P;function z(F){if(!(F>1114111)){var V=String.fromCodePoint;if(V)return V(F);var G=String.fromCharCode;return F<=65535?G(F):G((F>>10)+55232,F%1024+56320)}}function I(F,V){V=V.replace(m," ");var G=!1,J=[],j,Y=-1;function X(){Y++;var pe=document.createElementNS(T.svg,"tspan");w.select(pe).attr({class:"line",dy:Y*e+"em"}),F.appendChild(pe),j=pe;var ge=J;if(J=[{node:pe}],ge.length>1)for(var Ae=1;Ae<ge.length;Ae++)oe(ge[Ae])}function oe(pe){var ge=pe.type,Ae={},we;if(ge==="a"){we="a";var De=pe.target,Be=pe.href,Ve=pe.popup;Be&&(Ae={"xlink:xlink:show":De==="_blank"||De.charAt(0)!=="_"?"new":"replace",target:De,"xlink:xlink:href":Be},Ve&&(Ae.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+Ve+'");return false;'))}else we="tspan";pe.style&&(Ae.style=pe.style);var xe=document.createElementNS(T.svg,we);if(ge==="sup"||ge==="sub"){se(j,y),j.appendChild(xe);var Le=document.createElementNS(T.svg,"tspan");se(Le,y),w.select(Le).attr("dy",p[ge]),Ae.dy=g[ge],j.appendChild(xe),j.appendChild(Le)}else j.appendChild(xe);w.select(xe).attr(Ae),j=pe.node=xe,J.push(pe)}function se(pe,ge){pe.appendChild(document.createTextNode(ge))}function ie(pe){if(J.length===1){c.log("Ignoring unexpected end tag </"+pe+">.",V);return}var ge=J.pop();pe!==ge.type&&c.log("Start tag <"+ge.type+"> doesnt match end tag <"+pe+">. Pretending it did match.",V),j=J[J.length-1].node}var N=s.test(V);N?X():(j=F,J=[{node:F}]);for(var U=V.split(u),q=0;q<U.length;q++){var Q=U[q],W=Q.match(_),Z=W&&W[2].toLowerCase(),ee=i[Z];if(Z==="br")X();else if(ee===void 0)se(j,P(Q));else if(W[1])ie(Z);else{var te=W[4],ae={type:Z},le=l(te,A);if(le?(le=le.replace(L,"$1 fill:"),ee&&(le+=";"+ee)):ee&&(le=ee),le&&(ae.style=le),Z==="a"){G=!0;var ye=l(te,x);if(ye){var fe=D(ye);fe&&(ae.href=fe,ae.target=l(te,v)||"_blank",ae.popup=l(te,b))}}oe(ae)}}return G}function D(F){var V=encodeURI(decodeURI(F)),G=document.createElement("a"),J=document.createElement("a");G.href=F,J.href=V;var j=G.protocol,Y=J.protocol;return h.indexOf(j)!==-1&&h.indexOf(Y)!==-1?V:""}ne.sanitizeHTML=function(V){V=V.replace(m," ");for(var G=document.createElement("p"),J=G,j=[],Y=V.split(u),X=0;X<Y.length;X++){var oe=Y[X],se=oe.match(_),ie=se&&se[2].toLowerCase();if(ie in i)if(se[1])j.length&&(J=j.pop());else{var N=se[4],U=l(N,A),q=U?{style:U}:{};if(ie==="a"){var Q=l(N,x);if(Q){var W=D(Q);if(W){q.href=W;var Z=l(N,v);Z&&(q.target=Z)}}}var ee=document.createElement(ie);J.appendChild(ee),w.select(ee).attr(q),J=ee,j.push(ee)}else J.appendChild(document.createTextNode(P(oe)))}var te="innerHTML";return G[te]},ne.lineCount=function(V){return V.selectAll("tspan.line").size()||1},ne.positionText=function(V,G,J){return V.each(function(){var j=w.select(this);function Y(se,ie){return ie===void 0?(ie=j.attr(se),ie===null&&(j.attr(se,0),ie=0)):j.attr(se,ie),ie}var X=Y("x",G),oe=Y("y",J);this.nodeName==="text"&&j.selectAll("tspan.line").attr({x:X,y:oe})})};function R(F,V,G){var J=G.horizontalAlign,j=G.verticalAlign||"top",Y=F.node().getBoundingClientRect(),X=V.node().getBoundingClientRect(),oe,se,ie;return j==="bottom"?se=function(){return Y.bottom-oe.height}:j==="middle"?se=function(){return Y.top+(Y.height-oe.height)/2}:se=function(){return Y.top},J==="right"?ie=function(){return Y.right-oe.width}:J==="center"?ie=function(){return Y.left+(Y.width-oe.width)/2}:ie=function(){return Y.left},function(){oe=this.node().getBoundingClientRect();var N=ie()-X.left,U=se()-X.top,q=G.gd||{};if(G.gd){q._fullLayout._calcInverseTransform(q);var Q=c.apply3DTransform(q._fullLayout._invTransform)(N,U);N=Q[0],U=Q[1]}return this.style({top:U+"px",left:N+"px","z-index":1e3}),this}}var B="1px ";ne.makeTextShadow=function(F){var V=B,G=B,J=B;return V+G+J+F+", -"+V+"-"+G+J+F+", "+V+"-"+G+J+F+", -"+V+G+J+F},ne.makeEditable=function(F,V){var G=V.gd,J=V.delegate,j=w.dispatch("edit","input","cancel"),Y=J||F;if(F.style({"pointer-events":J?"none":"all"}),F.size()!==1)throw new Error("boo");function X(){se(),F.style({opacity:0});var ie=Y.attr("class"),N;ie?N="."+ie.split(" ")[0]+"-math-group":N="[class*=-math-group]",N&&w.select(F.node().parentNode).select(N).style({opacity:0})}function oe(ie){var N=ie.node(),U=document.createRange();U.selectNodeContents(N);var q=window.getSelection();q.removeAllRanges(),q.addRange(U),N.focus()}function se(){var ie=w.select(G),N=ie.select(".svg-container"),U=N.append("div"),q=F.node().style,Q=parseFloat(q.fontSize||12),W=V.text;W===void 0&&(W=F.attr("data-unformatted")),U.classed("plugin-editable editable",!0).style({position:"absolute","font-family":q.fontFamily||"Arial","font-size":Q,color:V.fill||q.fill||"black",opacity:1,"background-color":V.background||"transparent",outline:"#ffffff33 1px solid",margin:[-Q/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(W).call(R(F,N,V)).on("blur",function(){G._editing=!1,F.text(this.textContent).style({opacity:1});var Z=w.select(this).attr("class"),ee;Z?ee="."+Z.split(" ")[0]+"-math-group":ee="[class*=-math-group]",ee&&w.select(F.node().parentNode).select(ee).style({opacity:0});var te=this.textContent;w.select(this).transition().duration(0).remove(),w.select(document).on("mouseup",null),j.edit.call(F,te)}).on("focus",function(){var Z=this;G._editing=!0,w.select(document).on("mouseup",function(){if(w.event.target===Z)return!1;document.activeElement===U.node()&&U.node().blur()})}).on("keyup",function(){w.event.which===27?(G._editing=!1,F.style({opacity:1}),w.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),j.cancel.call(F,this.textContent)):(j.input.call(F,this.textContent),w.select(this).call(R(F,N,V)))}).on("keydown",function(){w.event.which===13&&this.blur()}).call(oe)}return V.immediate?X():Y.on("click",X),w.rebind(F,j,"on")}},{"../constants/alignment":471,"../constants/xmlns_namespaces":480,"../lib":503,"@plotly/d3":58}],530:[function(d,re,ne){var w={};ne.throttle=function(T,e,a){var n=w[T],r=Date.now();if(!n){for(var t in w)w[t].ts<r-6e4&&delete w[t];n=w[T]={ts:0,timer:null}}c(n);function f(){a(),n.ts=Date.now(),n.onDone&&(n.onDone(),n.onDone=null)}if(r>n.ts+e){f();return}n.timer=setTimeout(function(){f(),n.timer=null},e)},ne.done=function(M){var T=w[M];return!T||!T.timer?Promise.resolve():new Promise(function(e){var a=T.onDone;T.onDone=function(){a&&a(),e(),T.onDone=null}})},ne.clear=function(M){if(M)c(w[M]),delete w[M];else for(var T in w)ne.clear(T)};function c(M){M&&M.timer!==null&&(clearTimeout(M.timer),M.timer=null)}},{}],531:[function(d,re,ne){var w=d("fast-isnumeric");re.exports=function(M,T){if(M>0)return Math.log(M)/Math.LN10;var e=Math.log(Math.min(T[0],T[1]))/Math.LN10;return w(e)||(e=Math.log(Math.max(T[0],T[1]))/Math.LN10-6),e}},{"fast-isnumeric":190}],532:[function(d,re,ne){var w=re.exports={},c=d("../plots/geo/constants").locationmodeToLayer,M=d("topojson-client").feature;w.getTopojsonName=function(T){return[T.scope.replace(/ /g,"-"),"_",T.resolution.toString(),"m"].join("")},w.getTopojsonPath=function(T,e){return T+e+".json"},w.getTopojsonFeatures=function(T,e){var a=c[T.locationmode],n=e.objects[a];return M(e,n).features}},{"../plots/geo/constants":587,"topojson-client":315}],533:[function(d,re,ne){re.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],534:[function(d,re,ne){re.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],535:[function(d,re,ne){var w=d("../registry");re.exports=function(M){for(var T=w.layoutArrayContainers,e=w.layoutArrayRegexes,a=M.split("[")[0],n,r,t=0;t<e.length;t++)if(r=M.match(e[t]),r&&r.index===0){n=r[0];break}if(n||(n=T[T.indexOf(a)]),!n)return!1;var f=M.substr(n.length);return f?(r=f.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/),r?{array:n,index:Number(r[1]),property:r[3]||""}:!1):{array:n,index:"",property:""}}},{"../registry":638}],536:[function(d,re,ne){var w=d("../lib"),c=w.extendFlat,M=w.isPlainObject,T={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},a=T.flags.slice().concat(["fullReplot"]),n=e.flags.slice().concat("layoutReplot");re.exports={traces:T,layout:e,traceFlags:function(){return r(a)},layoutFlags:function(){return r(n)},update:function(o,i){var g=i.editType;if(g&&g!=="none")for(var p=g.split("+"),y=0;y<p.length;y++)o[p[y]]=!0},overrideAll:t};function r(o){for(var i={},g=0;g<o.length;g++)i[o[g]]=!1;return i}function t(o,i,g){var p=c({},o);for(var y in p){var h=p[y];M(h)&&(p[y]=f(h,i,g,y))}return g==="from-root"&&(p.editType=i),p}function f(o,i,g,p){if(o.valType){var y=c({},o);if(y.editType=i,Array.isArray(o.items)){y.items=new Array(o.items.length);for(var h=0;h<o.items.length;h++)y.items[h]=f(o.items[h],i)}return y}else return t(o,i,p.charAt(0)==="_"?"nested":"from-root")}},{"../lib":503}],537:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("gl-mat4/fromQuat"),M=d("../registry"),T=d("../lib"),e=d("../plots/plots"),a=d("../plots/cartesian/axis_ids"),n=d("../components/color"),r=a.cleanId,t=a.getFromTrace,f=M.traceIs;ne.clearPromiseQueue=function(s){Array.isArray(s._promises)&&s._promises.length>0&&T.log("Clearing previous rejected promises from queue."),s._promises=[]},ne.cleanLayout=function(s){var A,x;s||(s={}),s.xaxis1&&(s.xaxis||(s.xaxis=s.xaxis1),delete s.xaxis1),s.yaxis1&&(s.yaxis||(s.yaxis=s.yaxis1),delete s.yaxis1),s.scene1&&(s.scene||(s.scene=s.scene1),delete s.scene1);var v=(e.subplotsRegistry.cartesian||{}).attrRegex,b=(e.subplotsRegistry.polar||{}).attrRegex,l=(e.subplotsRegistry.ternary||{}).attrRegex,L=(e.subplotsRegistry.gl3d||{}).attrRegex,S=Object.keys(s);for(A=0;A<S.length;A++){var k=S[A];if(v&&v.test(k)){var P=s[k];P.anchor&&P.anchor!=="free"&&(P.anchor=r(P.anchor)),P.overlaying&&(P.overlaying=r(P.overlaying)),P.type||(P.isdate?P.type="date":P.islog?P.type="log":P.isdate===!1&&P.islog===!1&&(P.type="linear")),(P.autorange==="withzero"||P.autorange==="tozero")&&(P.autorange=!0,P.rangemode="tozero"),delete P.islog,delete P.isdate,delete P.categories,h(P,"domain")&&delete P.domain,P.autotick!==void 0&&(P.tickmode===void 0&&(P.tickmode=P.autotick?"auto":"linear"),delete P.autotick),i(P)}else if(b&&b.test(k)){var z=s[k];i(z.radialaxis)}else if(l&&l.test(k)){var I=s[k];i(I.aaxis),i(I.baxis),i(I.caxis)}else if(L&&L.test(k)){var D=s[k],R=D.cameraposition;if(Array.isArray(R)&&R[0].length===4){var B=R[0],F=R[1],V=R[2],G=c([],B),J=[];for(x=0;x<3;++x)J[x]=F[x]+V*G[2+4*x];D.camera={eye:{x:J[0],y:J[1],z:J[2]},center:{x:F[0],y:F[1],z:F[2]},up:{x:0,y:0,z:1}},delete D.cameraposition}i(D.xaxis),i(D.yaxis),i(D.zaxis)}}var j=Array.isArray(s.annotations)?s.annotations.length:0;for(A=0;A<j;A++){var Y=s.annotations[A];!T.isPlainObject(Y)||(Y.ref&&(Y.ref==="paper"?(Y.xref="paper",Y.yref="paper"):Y.ref==="data"&&(Y.xref="x",Y.yref="y"),delete Y.ref),o(Y,"xref"),o(Y,"yref"))}var X=Array.isArray(s.shapes)?s.shapes.length:0;for(A=0;A<X;A++){var oe=s.shapes[A];!T.isPlainObject(oe)||(o(oe,"xref"),o(oe,"yref"))}var se=Array.isArray(s.images)?s.images.length:0;for(A=0;A<se;A++){var ie=s.images[A];!T.isPlainObject(ie)||(o(ie,"xref"),o(ie,"yref"))}var N=s.legend;return N&&(N.x>3?(N.x=1.02,N.xanchor="left"):N.x<-2&&(N.x=-.02,N.xanchor="right"),N.y>3?(N.y=1.02,N.yanchor="bottom"):N.y<-2&&(N.y=-.02,N.yanchor="top")),i(s),s.dragmode==="rotate"&&(s.dragmode="orbit"),n.clean(s),s.template&&s.template.layout&&ne.cleanLayout(s.template.layout),s};function o(s,A){var x=s[A],v=A.charAt(0);x&&x!=="paper"&&(s[A]=r(x,v,!0))}function i(s){s&&((typeof s.title=="string"||typeof s.title=="number")&&(s.title={text:s.title}),A("titlefont","font"),A("titleposition","position"),A("titleside","side"),A("titleoffset","offset"));function A(x,v){var b=s[x],l=s.title&&s.title[v];b&&!l&&(s.title||(s.title={}),s.title[v]=s[x],delete s[x])}}ne.cleanData=function(s){for(var A=0;A<s.length;A++){var x=s[A],v;if(x.type==="histogramy"&&"xbins"in x&&!("ybins"in x)&&(x.ybins=x.xbins,delete x.xbins),x.error_y&&"opacity"in x.error_y){var b=n.defaults,l=x.error_y.color||(f(x,"bar")?n.defaultLine:b[A%b.length]);x.error_y.color=n.addOpacity(n.rgb(l),n.opacity(l)*x.error_y.opacity),delete x.error_y.opacity}if("bardir"in x&&(x.bardir==="h"&&(f(x,"bar")||x.type.substr(0,9)==="histogram")&&(x.orientation="h",ne.swapXYData(x)),delete x.bardir),x.type==="histogramy"&&ne.swapXYData(x),(x.type==="histogramx"||x.type==="histogramy")&&(x.type="histogram"),"scl"in x&&!("colorscale"in x)&&(x.colorscale=x.scl,delete x.scl),"reversescl"in x&&!("reversescale"in x)&&(x.reversescale=x.reversescl,delete x.reversescl),x.xaxis&&(x.xaxis=r(x.xaxis,"x")),x.yaxis&&(x.yaxis=r(x.yaxis,"y")),f(x,"gl3d")&&x.scene&&(x.scene=e.subplotsRegistry.gl3d.cleanId(x.scene)),!f(x,"pie-like")&&!f(x,"bar-like"))if(Array.isArray(x.textposition))for(v=0;v<x.textposition.length;v++)x.textposition[v]=y(x.textposition[v]);else x.textposition&&(x.textposition=y(x.textposition));var L=M.getModule(x);if(L&&L.colorbar){var S=L.colorbar.container,k=S?x[S]:x;k&&k.colorscale&&(k.colorscale==="YIGnBu"&&(k.colorscale="YlGnBu"),k.colorscale==="YIOrRd"&&(k.colorscale="YlOrRd"))}if(x.type==="surface"&&T.isPlainObject(x.contours)){var P=["x","y","z"];for(v=0;v<P.length;v++){var z=x.contours[P[v]];!T.isPlainObject(z)||(z.highlightColor&&(z.highlightcolor=z.highlightColor,delete z.highlightColor),z.highlightWidth&&(z.highlightwidth=z.highlightWidth,delete z.highlightWidth))}}if(x.type==="candlestick"||x.type==="ohlc"){var I=(x.increasing||{}).showlegend!==!1,D=(x.decreasing||{}).showlegend!==!1,R=g(x.increasing),B=g(x.decreasing);if(R!==!1&&B!==!1){var F=p(R,B,I,D);F&&(x.name=F)}else(R||B)&&!x.name&&(x.name=R||B)}if(Array.isArray(x.transforms)){var V=x.transforms;for(v=0;v<V.length;v++){var G=V[v];if(!!T.isPlainObject(G))switch(G.type){case"filter":G.filtersrc&&(G.target=G.filtersrc,delete G.filtersrc),G.calendar&&(G.valuecalendar||(G.valuecalendar=G.calendar),delete G.calendar);break;case"groupby":if(G.styles=G.styles||G.style,G.styles&&!Array.isArray(G.styles)){var J=G.styles,j=Object.keys(J);G.styles=[];for(var Y=0;Y<j.length;Y++)G.styles.push({target:j[Y],value:J[j[Y]]})}break}}}h(x,"line")&&delete x.line,"marker"in x&&(h(x.marker,"line")&&delete x.marker.line,h(x,"marker")&&delete x.marker),n.clean(x),x.autobinx&&(delete x.autobinx,delete x.xbins),x.autobiny&&(delete x.autobiny,delete x.ybins),i(x),x.colorbar&&i(x.colorbar),x.marker&&x.marker.colorbar&&i(x.marker.colorbar),x.line&&x.line.colorbar&&i(x.line.colorbar),x.aaxis&&i(x.aaxis),x.baxis&&i(x.baxis)}};function g(s){if(!T.isPlainObject(s))return!1;var A=s.name;return delete s.name,delete s.showlegend,(typeof A=="string"||typeof A=="number")&&String(A)}function p(s,A,x,v){if(x&&!v)return s;if(v&&!x||!s.trim())return A;if(!A.trim())return s;var b=Math.min(s.length,A.length),l;for(l=0;l<b&&s.charAt(l)===A.charAt(l);l++);var L=s.substr(0,l);return L.trim()}function y(s){var A="middle",x="center";return typeof s=="string"&&(s.indexOf("top")!==-1?A="top":s.indexOf("bottom")!==-1&&(A="bottom"),s.indexOf("left")!==-1?x="left":s.indexOf("right")!==-1&&(x="right")),A+" "+x}function h(s,A){return A in s&&typeof s[A]=="object"&&Object.keys(s[A]).length===0}ne.swapXYData=function(s){var A;if(T.swapAttrs(s,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(s.z)&&Array.isArray(s.z[0])&&(s.transpose?delete s.transpose:s.transpose=!0),s.error_x&&s.error_y){var x=s.error_y,v="copy_ystyle"in x?x.copy_ystyle:!(x.color||x.thickness||x.width);T.swapAttrs(s,["error_?.copy_ystyle"]),v&&T.swapAttrs(s,["error_?.color","error_?.thickness","error_?.width"])}if(typeof s.hoverinfo=="string"){var b=s.hoverinfo.split("+");for(A=0;A<b.length;A++)b[A]==="x"?b[A]="y":b[A]==="y"&&(b[A]="x");s.hoverinfo=b.join("+")}},ne.coerceTraceIndices=function(s,A){if(w(A))return[A];if(!Array.isArray(A)||!A.length)return s.data.map(function(b,l){return l});if(Array.isArray(A)){for(var x=[],v=0;v<A.length;v++)T.isIndex(A[v],s.data.length)?x.push(A[v]):T.warn("trace index (",A[v],") is not a number or is out of bounds");return x}return A},ne.manageArrayContainers=function(s,A,x){var v=s.obj,b=s.parts,l=b.length,L=b[l-1],S=w(L);if(S&&A===null){var k=b.slice(0,l-1).join("."),P=T.nestedProperty(v,k).get();P.splice(L,1)}else S&&s.get()===void 0&&s.get()===void 0&&(x[s.astr]=null),s.set(A)};var m=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function u(s){var A=s.search(m);if(A>0)return s.substr(0,A)}ne.hasParent=function(s,A){for(var x=u(A);x;){if(x in s)return!0;x=u(x)}return!1};var _=["x","y","z"];ne.clearAxisTypes=function(s,A,x){for(var v=0;v<A.length;v++)for(var b=s._fullData[v],l=0;l<3;l++){var L=t(s,b,_[l]);if(L&&L.type!=="log"){var S=L._name,k=L._id.substr(1);if(k.substr(0,5)==="scene"){if(x[k]!==void 0)continue;S=k+"."+S}var P=S+".type";x[S]===void 0&&x[P]===void 0&&T.nestedProperty(s.layout,P).set(null)}}}},{"../components/color":366,"../lib":503,"../plots/cartesian/axis_ids":558,"../plots/plots":619,"../registry":638,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],538:[function(d,re,ne){var w=d("./plot_api");ne._doPlot=w._doPlot,ne.newPlot=w.newPlot,ne.restyle=w.restyle,ne.relayout=w.relayout,ne.redraw=w.redraw,ne.update=w.update,ne._guiRestyle=w._guiRestyle,ne._guiRelayout=w._guiRelayout,ne._guiUpdate=w._guiUpdate,ne._storeDirectGUIEdit=w._storeDirectGUIEdit,ne.react=w.react,ne.extendTraces=w.extendTraces,ne.prependTraces=w.prependTraces,ne.addTraces=w.addTraces,ne.deleteTraces=w.deleteTraces,ne.moveTraces=w.moveTraces,ne.purge=w.purge,ne.addFrames=w.addFrames,ne.deleteFrames=w.deleteFrames,ne.animate=w.animate,ne.setPlotConfig=w.setPlotConfig,ne.toImage=d("./to_image"),ne.validate=d("./validate"),ne.downloadImage=d("../snapshot/download");var c=d("./template_api");ne.makeTemplate=c.makeTemplate,ne.validateTemplate=c.validateTemplate},{"../snapshot/download":640,"./plot_api":540,"./template_api":545,"./to_image":546,"./validate":547}],539:[function(d,re,ne){var w=d("../lib/is_plain_object"),c=d("../lib/noop"),M=d("../lib/loggers"),T=d("../lib/search").sorterAsc,e=d("../registry");ne.containerArrayMatch=d("./container_array_match");var a=ne.isAddVal=function(t){return t==="add"||w(t)},n=ne.isRemoveVal=function(t){return t===null||t==="remove"};ne.applyContainerArrayChanges=function(t,f,o,i,g){var p=f.astr,y=e.getComponentMethod(p,"supplyLayoutDefaults"),h=e.getComponentMethod(p,"draw"),m=e.getComponentMethod(p,"drawOne"),u=i.replot||i.recalc||y===c||h===c,_=t.layout,s=t._fullLayout;if(o[""]){Object.keys(o).length>1&&M.warn("Full array edits are incompatible with other edits",p);var A=o[""][""];if(n(A))f.set(null);else if(Array.isArray(A))f.set(A);else return M.warn("Unrecognized full array edit value",p,A),!0;return u?!1:(y(_,s),h(t),!0)}var x=Object.keys(o).map(Number).sort(T),v=f.get(),b=v||[],l=g(s,p).get(),L=[],S=-1,k=b.length,P,z,I,D,R,B,F,V;for(P=0;P<x.length;P++){if(I=x[P],D=o[I],R=Object.keys(D),B=D[""],F=a(B),I<0||I>b.length-(F?0:1)){M.warn("index out of range",p,I);continue}if(B!==void 0)R.length>1&&M.warn("Insertion & removal are incompatible with edits to the same index.",p,I),n(B)?L.push(I):F?(B==="add"&&(B={}),b.splice(I,0,B),l&&l.splice(I,0,{})):M.warn("Unrecognized full object edit value",p,I,B),S===-1&&(S=I);else for(z=0;z<R.length;z++)V=p+"["+I+"].",g(b[I],R[z],V).set(D[R[z]])}for(P=L.length-1;P>=0;P--)b.splice(L[P],1),l&&l.splice(L[P],1);if(b.length?v||f.set(b):f.set(null),u)return!1;if(y(_,s),m!==c){var G;if(S===-1)G=x;else{for(k=Math.max(b.length,k),G=[],P=0;P<x.length&&(I=x[P],!(I>=S));P++)G.push(I);for(P=S;P<k;P++)G.push(P)}for(P=0;P<G.length;P++)m(t,G[P])}else h(t);return!0}},{"../lib/is_plain_object":504,"../lib/loggers":507,"../lib/noop":512,"../lib/search":523,"../registry":638,"./container_array_match":535}],540:[function(d,re,ne){var w=d("@plotly/d3"),c=d("fast-isnumeric"),M=d("has-hover"),T=d("../lib"),e=T.nestedProperty,a=d("../lib/events"),n=d("../lib/queue"),r=d("../registry"),t=d("./plot_schema"),f=d("../plots/plots"),o=d("../plots/cartesian/axes"),i=d("../components/drawing"),g=d("../components/color"),p=d("../plots/cartesian/graph_interact").initInteractions,y=d("../constants/xmlns_namespaces"),h=d("../plots/cartesian/select").clearSelect,m=d("./plot_config").dfltConfig,u=d("./manage_arrays"),_=d("./helpers"),s=d("./subroutines"),A=d("./edit_types"),x=d("../plots/cartesian/constants").AX_NAME_PATTERN,v=0,b=5;function l(ke,Ye,Ke,st){var Et;if(ke=T.getGraphDiv(ke),a.init(ke),T.isPlainObject(Ye)){var bt=Ye;Ye=bt.data,Ke=bt.layout,st=bt.config,Et=bt.frames}var zt=a.triggerHandler(ke,"plotly_beforeplot",[Ye,Ke,st]);if(zt===!1)return Promise.reject();!Ye&&!Ke&&!T.isPlotDiv(ke)&&T.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",ke);function $t(){if(Et)return ne.addFrames(ke,Et)}z(ke,st),Ke||(Ke={}),w.select(ke).classed("js-plotly-plot",!0),i.makeTester(),Array.isArray(ke._promises)||(ke._promises=[]);var Ot=(ke.data||[]).length===0&&Array.isArray(Ye);Array.isArray(Ye)&&(_.cleanData(Ye),Ot?ke.data=Ye:ke.data.push.apply(ke.data,Ye),ke.empty=!1),(!ke.layout||Ot)&&(ke.layout=_.cleanLayout(Ke)),f.supplyDefaults(ke);var Qt=ke._fullLayout,tr=Qt._has("cartesian");Qt._replotting=!0,(Ot||Qt._shouldCreateBgLayer)&&(je(ke),Qt._shouldCreateBgLayer&&delete Qt._shouldCreateBgLayer),i.initGradients(ke),i.initPatterns(ke),Ot&&o.saveShowSpikeInitial(ke);var qt=!ke.calcdata||ke.calcdata.length!==(ke._fullData||[]).length;qt&&f.doCalcdata(ke);for(var lr=0;lr<ke.calcdata.length;lr++)ke.calcdata[lr][0].trace=ke._fullData[lr];ke._context.responsive?ke._responsiveChartHandler||(ke._responsiveChartHandler=function(){T.isHidden(ke)||f.resize(ke)},window.addEventListener("resize",ke._responsiveChartHandler)):T.clearResponsive(ke);var Wr=T.extendFlat({},Qt._size),cn=0;function Jr(){for(var Ne=Qt._basePlotModules,We=0;We<Ne.length;We++)Ne[We].drawFramework&&Ne[We].drawFramework(ke);!Qt._glcanvas&&Qt._has("gl")&&(Qt._glcanvas=Qt._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(ht){return ht.key}),Qt._glcanvas.enter().append("canvas").attr("class",function(ht){return"gl-canvas gl-canvas-"+ht.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var Qe=ke._context.plotGlPixelRatio;if(Qt._glcanvas){Qt._glcanvas.attr("width",Qt.width*Qe).attr("height",Qt.height*Qe).style("width",Qt.width+"px").style("height",Qt.height+"px");var rt=Qt._glcanvas.data()[0].regl;if(rt&&(Math.floor(Qt.width*Qe)!==rt._gl.drawingBufferWidth||Math.floor(Qt.height*Qe)!==rt._gl.drawingBufferHeight)){var $e="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(cn)T.error($e);else return T.log($e+" Clearing graph and plotting again."),f.cleanPlot([],{},ke._fullData,Qt),f.supplyDefaults(ke),Qt=ke._fullLayout,f.doCalcdata(ke),cn++,Jr()}}return Qt.modebar.orientation==="h"?Qt._modebardiv.style("height",null).style("width","100%"):Qt._modebardiv.style("width",null).style("height",Qt.height+"px"),f.previousPromises(ke)}function ot(){if(f.clearAutoMarginIds(ke),s.drawMarginPushers(ke),o.allowAutoMargin(ke),Qt._has("pie"))for(var Ne=ke._fullData,We=0;We<Ne.length;We++){var Qe=Ne[We];Qe.type==="pie"&&Qe.automargin&&f.allowAutoMargin(ke,"pie."+Qe.uid+".automargin")}return f.doAutoMargin(ke),f.previousPromises(ke)}function Vt(){if(!!f.didMarginChange(Wr,Qt._size))return T.syncOrAsync([ot,s.layoutStyles],ke)}function jt(){if(!qt){Ut();return}return T.syncOrAsync([r.getComponentMethod("shapes","calcAutorange"),r.getComponentMethod("annotations","calcAutorange"),Ut],ke)}function Ut(){ke._transitioning||(s.doAutoRangeAndConstraints(ke),Ot&&o.saveRangeInitial(ke),r.getComponentMethod("rangeslider","calcAutorange")(ke))}function yr(){return o.draw(ke,Ot?"":"redraw")}var nt=[f.previousPromises,$t,Jr,ot,Vt];tr&&nt.push(jt),nt.push(s.layoutStyles),tr&&nt.push(yr,function(We){We._fullLayout._insideTickLabelsAutorange&&ae(We,We._fullLayout._insideTickLabelsAutorange).then(function(){We._fullLayout._insideTickLabelsAutorange=void 0})}),nt.push(s.drawData,s.finalDraw,p,f.addLinks,f.rehover,f.redrag,f.doAutoMargin,_e,f.previousPromises);function _e(Ne){Ne._fullLayout._insideTickLabelsAutorange&&Ot&&o.saveRangeInitial(Ne,!0)}var Me=T.syncOrAsync(nt,ke);return(!Me||!Me.then)&&(Me=Promise.resolve()),Me.then(function(){return L(ke),ke})}function L(ke){var Ye=ke._fullLayout;Ye._redrawFromAutoMarginCount?Ye._redrawFromAutoMarginCount--:ke.emit("plotly_afterplot")}function S(ke){return T.extendFlat(m,ke)}function k(ke,Ye){try{ke._fullLayout._paper.style("background",Ye)}catch(Ke){T.error(Ke)}}function P(ke,Ye){var Ke=g.combine(Ye,"white");k(ke,Ke)}function z(ke,Ye){if(!ke._context){ke._context=T.extendDeep({},m);var Ke=w.select("base");ke._context._baseUrl=Ke.size()&&Ke.attr("href")?window.location.href.split("#")[0]:""}var st=ke._context,Et,bt,zt;if(Ye){for(bt=Object.keys(Ye),Et=0;Et<bt.length;Et++)zt=bt[Et],!(zt==="editable"||zt==="edits")&&zt in st&&(zt==="setBackground"&&Ye[zt]==="opaque"?st[zt]=P:st[zt]=Ye[zt]);Ye.plot3dPixelRatio&&!st.plotGlPixelRatio&&(st.plotGlPixelRatio=st.plot3dPixelRatio);var $t=Ye.editable;if($t!==void 0)for(st.editable=$t,bt=Object.keys(st.edits),Et=0;Et<bt.length;Et++)st.edits[bt[Et]]=$t;if(Ye.edits)for(bt=Object.keys(Ye.edits),Et=0;Et<bt.length;Et++)zt=bt[Et],zt in st.edits&&(st.edits[zt]=Ye.edits[zt]);st._exportedPlot=Ye._exportedPlot}st.staticPlot&&(st.editable=!1,st.edits={},st.autosizable=!1,st.scrollZoom=!1,st.doubleClick=!1,st.showTips=!1,st.showLink=!1,st.displayModeBar=!1),st.displayModeBar==="hover"&&!M&&(st.displayModeBar=!0),(st.setBackground==="transparent"||typeof st.setBackground!="function")&&(st.setBackground=k),st._hasZeroHeight=st._hasZeroHeight||ke.clientHeight===0,st._hasZeroWidth=st._hasZeroWidth||ke.clientWidth===0;var Ot=st.scrollZoom,Qt=st._scrollZoom={};if(Ot===!0)Qt.cartesian=1,Qt.gl3d=1,Qt.geo=1,Qt.mapbox=1;else if(typeof Ot=="string"){var tr=Ot.split("+");for(Et=0;Et<tr.length;Et++)Qt[tr[Et]]=1}else Ot!==!1&&(Qt.gl3d=1,Qt.geo=1,Qt.mapbox=1)}function I(ke){if(ke=T.getGraphDiv(ke),!T.isPlotDiv(ke))throw new Error("This element is not a Plotly plot: "+ke);return _.cleanData(ke.data),_.cleanLayout(ke.layout),ke.calcdata=void 0,ne._doPlot(ke).then(function(){return ke.emit("plotly_redraw"),ke})}function D(ke,Ye,Ke,st){return ke=T.getGraphDiv(ke),f.cleanPlot([],{},ke._fullData||[],ke._fullLayout||{}),f.purge(ke),ne._doPlot(ke,Ye,Ke,st)}function R(ke,Ye){var Ke=Ye+1,st=[],Et,bt;for(Et=0;Et<ke.length;Et++)bt=ke[Et],bt<0?st.push(Ke+bt):st.push(bt);return st}function B(ke,Ye,Ke){var st,Et;for(st=0;st<Ye.length;st++){if(Et=Ye[st],Et!==parseInt(Et,10))throw new Error("all values in "+Ke+" must be integers");if(Et>=ke.data.length||Et<-ke.data.length)throw new Error(Ke+" must be valid indices for gd.data.");if(Ye.indexOf(Et,st+1)>-1||Et>=0&&Ye.indexOf(-ke.data.length+Et)>-1||Et<0&&Ye.indexOf(ke.data.length+Et)>-1)throw new Error("each index in "+Ke+" must be unique.")}}function F(ke,Ye,Ke){if(!Array.isArray(ke.data))throw new Error("gd.data must be an array.");if(typeof Ye=="undefined")throw new Error("currentIndices is a required argument.");if(Array.isArray(Ye)||(Ye=[Ye]),B(ke,Ye,"currentIndices"),typeof Ke!="undefined"&&!Array.isArray(Ke)&&(Ke=[Ke]),typeof Ke!="undefined"&&B(ke,Ke,"newIndices"),typeof Ke!="undefined"&&Ye.length!==Ke.length)throw new Error("current and new indices must be of equal length.")}function V(ke,Ye,Ke){var st,Et;if(!Array.isArray(ke.data))throw new Error("gd.data must be an array.");if(typeof Ye=="undefined")throw new Error("traces must be defined.");for(Array.isArray(Ye)||(Ye=[Ye]),st=0;st<Ye.length;st++)if(Et=Ye[st],typeof Et!="object"||Array.isArray(Et)||Et===null)throw new Error("all values in traces array must be non-array objects");if(typeof Ke!="undefined"&&!Array.isArray(Ke)&&(Ke=[Ke]),typeof Ke!="undefined"&&Ke.length!==Ye.length)throw new Error("if indices is specified, traces.length must equal indices.length")}function G(ke,Ye,Ke,st){var Et=T.isPlainObject(st);if(!Array.isArray(ke.data))throw new Error("gd.data must be an array");if(!T.isPlainObject(Ye))throw new Error("update must be a key:value object");if(typeof Ke=="undefined")throw new Error("indices must be an integer or array of integers");B(ke,Ke,"indices");for(var bt in Ye){if(!Array.isArray(Ye[bt])||Ye[bt].length!==Ke.length)throw new Error("attribute "+bt+" must be an array of length equal to indices array length");if(Et&&(!(bt in st)||!Array.isArray(st[bt])||st[bt].length!==Ye[bt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}function J(ke,Ye,Ke,st){var Et=T.isPlainObject(st),bt=[],zt,$t,Ot,Qt,tr;Array.isArray(Ke)||(Ke=[Ke]),Ke=R(Ke,ke.data.length-1);for(var qt in Ye)for(var lr=0;lr<Ke.length;lr++){if(zt=ke.data[Ke[lr]],Ot=e(zt,qt),$t=Ot.get(),Qt=Ye[qt][lr],!T.isArrayOrTypedArray(Qt))throw new Error("attribute: "+qt+" index: "+lr+" must be an array");if(!T.isArrayOrTypedArray($t))throw new Error("cannot extend missing or non-array attribute: "+qt);if($t.constructor!==Qt.constructor)throw new Error("cannot extend array with an array of a different type: "+qt);tr=Et?st[qt][lr]:st,c(tr)||(tr=-1),bt.push({prop:Ot,target:$t,insert:Qt,maxp:Math.floor(tr)})}return bt}function j(ke,Ye,Ke,st,Et){G(ke,Ye,Ke,st);for(var bt=J(ke,Ye,Ke,st),zt={},$t={},Ot=0;Ot<bt.length;Ot++){var Qt=bt[Ot].prop,tr=bt[Ot].maxp,qt=Et(bt[Ot].target,bt[Ot].insert,tr);Qt.set(qt[0]),Array.isArray(zt[Qt.astr])||(zt[Qt.astr]=[]),zt[Qt.astr].push(qt[1]),Array.isArray($t[Qt.astr])||($t[Qt.astr]=[]),$t[Qt.astr].push(bt[Ot].target.length)}return{update:zt,maxPoints:$t}}function Y(ke,Ye){var Ke=new ke.constructor(ke.length+Ye.length);return Ke.set(ke),Ke.set(Ye,ke.length),Ke}function X(ke,Ye,Ke,st){ke=T.getGraphDiv(ke);function Et(Ot,Qt,tr){var qt,lr;if(T.isTypedArray(Ot))if(tr<0){var Wr=new Ot.constructor(0),cn=Y(Ot,Qt);tr<0?(qt=cn,lr=Wr):(qt=Wr,lr=cn)}else if(qt=new Ot.constructor(tr),lr=new Ot.constructor(Ot.length+Qt.length-tr),tr===Qt.length)qt.set(Qt),lr.set(Ot);else if(tr<Qt.length){var Jr=Qt.length-tr;qt.set(Qt.subarray(Jr)),lr.set(Ot),lr.set(Qt.subarray(0,Jr),Ot.length)}else{var ot=tr-Qt.length,Vt=Ot.length-ot;qt.set(Ot.subarray(Vt)),qt.set(Qt,ot),lr.set(Ot.subarray(0,Vt))}else qt=Ot.concat(Qt),lr=tr>=0&&tr<qt.length?qt.splice(0,qt.length-tr):[];return[qt,lr]}var bt=j(ke,Ye,Ke,st,Et),zt=ne.redraw(ke),$t=[ke,bt.update,Ke,bt.maxPoints];return n.add(ke,ne.prependTraces,$t,X,arguments),zt}function oe(ke,Ye,Ke,st){ke=T.getGraphDiv(ke);function Et(Ot,Qt,tr){var qt,lr;if(T.isTypedArray(Ot))if(tr<=0){var Wr=new Ot.constructor(0),cn=Y(Qt,Ot);tr<0?(qt=cn,lr=Wr):(qt=Wr,lr=cn)}else if(qt=new Ot.constructor(tr),lr=new Ot.constructor(Ot.length+Qt.length-tr),tr===Qt.length)qt.set(Qt),lr.set(Ot);else if(tr<Qt.length){var Jr=Qt.length-tr;qt.set(Qt.subarray(0,Jr)),lr.set(Qt.subarray(Jr)),lr.set(Ot,Jr)}else{var ot=tr-Qt.length;qt.set(Qt),qt.set(Ot.subarray(0,ot),Qt.length),lr.set(Ot.subarray(ot))}else qt=Qt.concat(Ot),lr=tr>=0&&tr<qt.length?qt.splice(tr,qt.length):[];return[qt,lr]}var bt=j(ke,Ye,Ke,st,Et),zt=ne.redraw(ke),$t=[ke,bt.update,Ke,bt.maxPoints];return n.add(ke,ne.extendTraces,$t,oe,arguments),zt}function se(ke,Ye,Ke){ke=T.getGraphDiv(ke);var st=[],Et=ne.deleteTraces,bt=se,zt=[ke,st],$t=[ke,Ye],Ot,Qt;for(V(ke,Ye,Ke),Array.isArray(Ye)||(Ye=[Ye]),Ye=Ye.map(function(tr){return T.extendFlat({},tr)}),_.cleanData(Ye),Ot=0;Ot<Ye.length;Ot++)ke.data.push(Ye[Ot]);for(Ot=0;Ot<Ye.length;Ot++)st.push(-Ye.length+Ot);if(typeof Ke=="undefined")return Qt=ne.redraw(ke),n.add(ke,Et,zt,bt,$t),Qt;Array.isArray(Ke)||(Ke=[Ke]);try{F(ke,st,Ke)}catch(tr){throw ke.data.splice(ke.data.length-Ye.length,Ye.length),tr}return n.startSequence(ke),n.add(ke,Et,zt,bt,$t),Qt=ne.moveTraces(ke,st,Ke),n.stopSequence(ke),Qt}function ie(ke,Ye){ke=T.getGraphDiv(ke);var Ke=[],st=ne.addTraces,Et=ie,bt=[ke,Ke,Ye],zt=[ke,Ye],$t,Ot;if(typeof Ye=="undefined")throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Ye)||(Ye=[Ye]),B(ke,Ye,"indices"),Ye=R(Ye,ke.data.length-1),Ye.sort(T.sorterDes),$t=0;$t<Ye.length;$t+=1)Ot=ke.data.splice(Ye[$t],1)[0],Ke.push(Ot);var Qt=ne.redraw(ke);return n.add(ke,st,bt,Et,zt),Qt}function N(ke,Ye,Ke){ke=T.getGraphDiv(ke);var st=[],Et=[],bt=N,zt=N,$t=[ke,Ke,Ye],Ot=[ke,Ye,Ke],Qt;if(F(ke,Ye,Ke),Ye=Array.isArray(Ye)?Ye:[Ye],typeof Ke=="undefined")for(Ke=[],Qt=0;Qt<Ye.length;Qt++)Ke.push(-Ye.length+Qt);for(Ke=Array.isArray(Ke)?Ke:[Ke],Ye=R(Ye,ke.data.length-1),Ke=R(Ke,ke.data.length-1),Qt=0;Qt<ke.data.length;Qt++)Ye.indexOf(Qt)===-1&&st.push(ke.data[Qt]);for(Qt=0;Qt<Ye.length;Qt++)Et.push({newIndex:Ke[Qt],trace:ke.data[Ye[Qt]]});for(Et.sort(function(qt,lr){return qt.newIndex-lr.newIndex}),Qt=0;Qt<Et.length;Qt+=1)st.splice(Et[Qt].newIndex,0,Et[Qt].trace);ke.data=st;var tr=ne.redraw(ke);return n.add(ke,bt,$t,zt,Ot),tr}function U(ke,Ye,Ke,st){ke=T.getGraphDiv(ke),_.clearPromiseQueue(ke);var Et={};if(typeof Ye=="string")Et[Ye]=Ke;else if(T.isPlainObject(Ye))Et=T.extendFlat({},Ye),st===void 0&&(st=Ke);else return T.warn("Restyle fail.",Ye,Ke,st),Promise.reject();Object.keys(Et).length&&(ke.changed=!0);var bt=_.coerceTraceIndices(ke,st),zt=ee(ke,Et,bt),$t=zt.flags;$t.calc&&(ke.calcdata=void 0),$t.clearAxisTypes&&_.clearAxisTypes(ke,bt,{});var Ot=[];$t.fullReplot?Ot.push(ne._doPlot):(Ot.push(f.previousPromises),f.supplyDefaults(ke),$t.markerSize&&(f.doCalcdata(ke),ye(Ot)),$t.style&&Ot.push(s.doTraceStyle),$t.colorbars&&Ot.push(s.doColorBars),Ot.push(L)),Ot.push(f.rehover,f.redrag),n.add(ke,U,[ke,zt.undoit,zt.traces],U,[ke,zt.redoit,zt.traces]);var Qt=T.syncOrAsync(Ot,ke);return(!Qt||!Qt.then)&&(Qt=Promise.resolve()),Qt.then(function(){return ke.emit("plotly_restyle",zt.eventData),ke})}function q(ke){return ke===void 0?null:ke}function Q(ke,Ye){return Ye?function(Ke,st,Et){var bt=e(Ke,st),zt=bt.set;return bt.set=function($t){var Ot=(Et||"")+st;W(Ot,bt.get(),$t,ke),zt($t)},bt}:e}function W(ke,Ye,Ke,st){if(Array.isArray(Ye)||Array.isArray(Ke))for(var Et=Array.isArray(Ye)?Ye:[],bt=Array.isArray(Ke)?Ke:[],zt=Math.max(Et.length,bt.length),$t=0;$t<zt;$t++)W(ke+"["+$t+"]",Et[$t],bt[$t],st);else if(T.isPlainObject(Ye)||T.isPlainObject(Ke)){var Ot=T.isPlainObject(Ye)?Ye:{},Qt=T.isPlainObject(Ke)?Ke:{},tr=T.extendFlat({},Ot,Qt);for(var qt in tr)W(ke+"."+qt,Ot[qt],Qt[qt],st)}else st[ke]===void 0&&(st[ke]=q(Ye))}function Z(ke,Ye,Ke){for(var st in Ke){var Et=e(ke,st);W(st,Et.get(),Ke[st],Ye)}}function ee(ke,Ye,Ke){var st=ke._fullLayout,Et=ke._fullData,bt=ke.data,zt=st._guiEditing,$t=Q(st._preGUI,zt),Ot=T.extendDeepAll({},Ye),Qt;te(Ye);var tr=A.traceFlags(),qt={},lr={},Wr;function cn(){return Ke.map(function(){})}function Jr(Zt){var ur=o.id2name(Zt);Wr.indexOf(ur)===-1&&Wr.push(ur)}function ot(Zt){return"LAYOUT"+Zt+".autorange"}function Vt(Zt){return"LAYOUT"+Zt+".range"}function jt(Zt){for(var ur=Zt;ur<Et.length;ur++)if(Et[ur]._input===bt[Zt])return Et[ur]}function Ut(Zt,ur,Lr){if(Array.isArray(Zt)){Zt.forEach(function(jr){Ut(jr,ur,Lr)});return}if(!(Zt in Ye||_.hasParent(Ye,Zt))){var Br;if(Zt.substr(0,6)==="LAYOUT")Br=$t(ke.layout,Zt.replace("LAYOUT",""));else{var Pr=Ke[Lr],Tr=st._tracePreGUI[jt(Pr)._fullInput.uid];Br=Q(Tr,zt)(bt[Pr],Zt)}Zt in lr||(lr[Zt]=cn()),lr[Zt][Lr]===void 0&&(lr[Zt][Lr]=q(Br.get())),ur!==void 0&&Br.set(ur)}}function yr(Zt){return function(ur){return Et[ur][Zt]}}function nt(Zt){return function(ur,Lr){return ur===!1?Et[Ke[Lr]][Zt]:null}}for(var _e in Ye){if(_.hasParent(Ye,_e))throw new Error("cannot set "+_e+" and a parent attribute simultaneously");var Me=Ye[_e],Ne,We,Qe,rt,$e,ht;if((_e==="autobinx"||_e==="autobiny")&&(_e=_e.charAt(_e.length-1)+"bins",Array.isArray(Me)?Me=Me.map(nt(_e)):Me===!1?Me=Ke.map(yr(_e)):Me=null),qt[_e]=Me,_e.substr(0,6)==="LAYOUT"){Qe=$t(ke.layout,_e.replace("LAYOUT","")),lr[_e]=[q(Qe.get())],Qe.set(Array.isArray(Me)?Me[0]:Me),tr.calc=!0;continue}for(lr[_e]=cn(),Qt=0;Qt<Ke.length;Qt++){Ne=bt[Ke[Qt]],We=jt(Ke[Qt]);var xt=st._tracePreGUI[We._fullInput.uid];if(Qe=Q(xt,zt)(Ne,_e),rt=Qe.get(),$e=Array.isArray(Me)?Me[Qt%Me.length]:Me,$e!==void 0){var kt=Qe.parts[Qe.parts.length-1],Wt=_e.substr(0,_e.length-kt.length-1),Ft=Wt?Wt+".":"",ir=Wt?e(We,Wt).get():We;if(ht=t.getTraceValObject(We,Qe.parts),ht&&ht.impliedEdits&&$e!==null)for(var hr in ht.impliedEdits)Ut(T.relativeAttr(_e,hr),ht.impliedEdits[hr],Qt);else if((kt==="thicknessmode"||kt==="lenmode")&&rt!==$e&&($e==="fraction"||$e==="pixels")&&ir){var _r=st._size,an=ir.orient,Rr=an==="top"||an==="bottom";if(kt==="thicknessmode"){var Vr=Rr?_r.h:_r.w;Ut(Ft+"thickness",ir.thickness*($e==="fraction"?1/Vr:Vr),Qt)}else{var fn=Rr?_r.w:_r.h;Ut(Ft+"len",ir.len*($e==="fraction"?1/fn:fn),Qt)}}else if(_e==="type"&&($e==="pie"!=(rt==="pie")||$e==="funnelarea"!=(rt==="funnelarea"))){var xr="x",mr="y";($e==="bar"||rt==="bar")&&Ne.orientation==="h"&&(xr="y",mr="x"),T.swapAttrs(Ne,["?","?src"],"labels",xr),T.swapAttrs(Ne,["d?","?0"],"label",xr),T.swapAttrs(Ne,["?","?src"],"values",mr),rt==="pie"||rt==="funnelarea"?(e(Ne,"marker.color").set(e(Ne,"marker.colors").get()),st._pielayer.selectAll("g.trace").remove()):r.traceIs(Ne,"cartesian")&&e(Ne,"marker.colors").set(e(Ne,"marker.color").get())}lr[_e][Qt]=q(rt);var Fr=["swapxy","swapxyaxes","orientation","orientationaxes"];if(Fr.indexOf(_e)!==-1){if(_e==="orientation"){Qe.set($e);var Ir=Ne.x&&!Ne.y?"h":"v";if((Qe.get()||Ir)===We.orientation)continue}else _e==="orientationaxes"&&(Ne.orientation={v:"h",h:"v"}[We.orientation]);_.swapXYData(Ne),tr.calc=tr.clearAxisTypes=!0}else f.dataArrayContainers.indexOf(Qe.parts[0])!==-1?(_.manageArrayContainers(Qe,$e,lr),tr.calc=!0):(ht?ht.arrayOk&&!r.traceIs(We,"regl")&&(T.isArrayOrTypedArray($e)||T.isArrayOrTypedArray(rt))?tr.calc=!0:A.update(tr,ht):tr.calc=!0,Qe.set($e))}}if(["swapxyaxes","orientationaxes"].indexOf(_e)!==-1&&o.swap(ke,Ke),_e==="orientationaxes"){var Sr=e(ke.layout,"hovermode"),tt=Sr.get();tt==="x"?Sr.set("y"):tt==="y"?Sr.set("x"):tt==="x unified"?Sr.set("y unified"):tt==="y unified"&&Sr.set("x unified")}if(["orientation","type"].indexOf(_e)!==-1){for(Wr=[],Qt=0;Qt<Ke.length;Qt++){var Ct=bt[Ke[Qt]];r.traceIs(Ct,"cartesian")&&(Jr(Ct.xaxis||"x"),Jr(Ct.yaxis||"y"))}Ut(Wr.map(ot),!0,0),Ut(Wr.map(Vt),[0,1],0)}}return(tr.calc||tr.plot)&&(tr.fullReplot=!0),{flags:tr,undoit:lr,redoit:qt,traces:Ke,eventData:T.extendDeepNoArrays([],[Ot,Ke])}}function te(ke){var Ye=T.counterRegex("axis",".title",!1,!1),Ke=/colorbar\.title$/,st=Object.keys(ke),Et,bt,zt;for(Et=0;Et<st.length;Et++)bt=st[Et],zt=ke[bt],(bt==="title"||Ye.test(bt)||Ke.test(bt))&&(typeof zt=="string"||typeof zt=="number")?$t(bt,bt.replace("title","title.text")):bt.indexOf("titlefont")>-1&&bt.indexOf("grouptitlefont")===-1?$t(bt,bt.replace("titlefont","title.font")):bt.indexOf("titleposition")>-1?$t(bt,bt.replace("titleposition","title.position")):bt.indexOf("titleside")>-1?$t(bt,bt.replace("titleside","title.side")):bt.indexOf("titleoffset")>-1&&$t(bt,bt.replace("titleoffset","title.offset"));function $t(Ot,Qt){ke[Qt]=ke[Ot],delete ke[Ot]}}function ae(ke,Ye,Ke){ke=T.getGraphDiv(ke),_.clearPromiseQueue(ke);var st={};if(typeof Ye=="string")st[Ye]=Ke;else if(T.isPlainObject(Ye))st=T.extendFlat({},Ye);else return T.warn("Relayout fail.",Ye,Ke),Promise.reject();Object.keys(st).length&&(ke.changed=!0);var Et=Ae(ke,st),bt=Et.flags;bt.calc&&(ke.calcdata=void 0);var zt=[f.previousPromises];bt.layoutReplot?zt.push(s.layoutReplot):Object.keys(st).length&&(le(ke,bt,Et)||f.supplyDefaults(ke),bt.legend&&zt.push(s.doLegend),bt.layoutstyle&&zt.push(s.layoutStyles),bt.axrange&&ye(zt,Et.rangesAltered),bt.ticks&&zt.push(s.doTicksRelayout),bt.modebar&&zt.push(s.doModeBar),bt.camera&&zt.push(s.doCamera),bt.colorbars&&zt.push(s.doColorBars),zt.push(L)),zt.push(f.rehover,f.redrag),n.add(ke,ae,[ke,Et.undoit],ae,[ke,Et.redoit]);var $t=T.syncOrAsync(zt,ke);return(!$t||!$t.then)&&($t=Promise.resolve(ke)),$t.then(function(){return ke.emit("plotly_relayout",Et.eventData),ke})}function le(ke,Ye,Ke){var st=ke._fullLayout;if(!Ye.axrange)return!1;for(var Et in Ye)if(Et!=="axrange"&&Ye[Et])return!1;for(var bt in Ke.rangesAltered){var zt=o.id2name(bt),$t=ke.layout[zt],Ot=st[zt];if(Ot.autorange=$t.autorange,$t.range&&(Ot.range=$t.range.slice()),Ot.cleanRange(),Ot._matchGroup){for(var Qt in Ot._matchGroup)if(Qt!==bt){var tr=st[o.id2name(Qt)];tr.autorange=Ot.autorange,tr.range=Ot.range.slice(),tr._input.range=Ot.range.slice()}}}return!0}function ye(ke,Ye){var Ke=Ye?function(st){var Et=[],bt=!0;for(var zt in Ye){var $t=o.getFromId(st,zt);if(Et.push(zt),($t.ticklabelposition||"").indexOf("inside")!==-1&&$t._anchorAxis&&Et.push($t._anchorAxis._id),$t._matchGroup)for(var Ot in $t._matchGroup)Ye[Ot]||Et.push(Ot);$t.automargin&&(bt=!1)}return o.draw(st,Et,{skipTitle:bt})}:function(st){return o.draw(st,"redraw")};ke.push(h,s.doAutoRangeAndConstraints,Ke,s.drawData,s.finalDraw)}var fe=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,pe=/^[xyz]axis[0-9]*\.autorange$/,ge=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function Ae(ke,Ye){var Ke=ke.layout,st=ke._fullLayout,Et=st._guiEditing,bt=Q(st._preGUI,Et),zt=Object.keys(Ye),$t=o.list(ke),Ot=T.extendDeepAll({},Ye),Qt={},tr,qt,lr;for(te(Ye),zt=Object.keys(Ye),qt=0;qt<zt.length;qt++)if(zt[qt].indexOf("allaxes")===0){for(lr=0;lr<$t.length;lr++){var Wr=$t[lr]._id.substr(1),cn=Wr.indexOf("scene")!==-1?Wr+".":"",Jr=zt[qt].replace("allaxes",cn+$t[lr]._name);Ye[Jr]||(Ye[Jr]=Ye[zt[qt]])}delete Ye[zt[qt]]}var ot=A.layoutFlags(),Vt={},jt={};function Ut(Pr,Tr){if(Array.isArray(Pr)){Pr.forEach(function(Pn){Ut(Pn,Tr)});return}if(!(Pr in Ye||_.hasParent(Ye,Pr))){var jr=bt(Ke,Pr);Pr in jt||(jt[Pr]=q(jr.get())),Tr!==void 0&&jr.set(Tr)}}var yr={},nt;function _e(Pr){var Tr=o.name2id(Pr.split(".")[0]);return yr[Tr]=1,Tr}for(var Me in Ye){if(_.hasParent(Ye,Me))throw new Error("cannot set "+Me+" and a parent attribute simultaneously");for(var Ne=bt(Ke,Me),We=Ye[Me],Qe=Ne.parts.length,rt=Qe-1;rt>0&&typeof Ne.parts[rt]!="string";)rt--;var $e=Ne.parts[rt],ht=Ne.parts[rt-1]+"."+$e,xt=Ne.parts.slice(0,rt).join("."),kt=e(ke.layout,xt).get(),Wt=e(st,xt).get(),Ft=Ne.get();if(We!==void 0){Vt[Me]=We,jt[Me]=$e==="reverse"?We:q(Ft);var ir=t.getLayoutValObject(st,Ne.parts);if(ir&&ir.impliedEdits&&We!==null)for(var hr in ir.impliedEdits)Ut(T.relativeAttr(Me,hr),ir.impliedEdits[hr]);if(["width","height"].indexOf(Me)!==-1)if(We){Ut("autosize",null);var _r=Me==="height"?"width":"height";Ut(_r,st[_r])}else st[Me]=ke._initialAutoSize[Me];else if(Me==="autosize")Ut("width",We?null:st.width),Ut("height",We?null:st.height);else if(ht.match(fe))_e(ht),e(st,xt+"._inputRange").set(null);else if(ht.match(pe)){_e(ht),e(st,xt+"._inputRange").set(null);var an=e(st,xt).get();an._inputDomain&&(an._input.domain=an._inputDomain.slice())}else ht.match(ge)&&e(st,xt+"._inputDomain").set(null);if($e==="type"){nt=kt;var Rr=Wt.type==="linear"&&We==="log",Vr=Wt.type==="log"&&We==="linear";if(Rr||Vr){if(!nt||!nt.range)Ut(xt+".autorange",!0);else if(Wt.autorange)Rr&&(nt.range=nt.range[1]>nt.range[0]?[1,2]:[2,1]);else{var fn=nt.range[0],xr=nt.range[1];Rr?(fn<=0&&xr<=0&&Ut(xt+".autorange",!0),fn<=0?fn=xr/1e6:xr<=0&&(xr=fn/1e6),Ut(xt+".range[0]",Math.log(fn)/Math.LN10),Ut(xt+".range[1]",Math.log(xr)/Math.LN10)):(Ut(xt+".range[0]",Math.pow(10,fn)),Ut(xt+".range[1]",Math.pow(10,xr)))}Array.isArray(st._subplots.polar)&&st._subplots.polar.length&&st[Ne.parts[0]]&&Ne.parts[1]==="radialaxis"&&delete st[Ne.parts[0]]._subplot.viewInitial["radialaxis.range"],r.getComponentMethod("annotations","convertCoords")(ke,Wt,We,Ut),r.getComponentMethod("images","convertCoords")(ke,Wt,We,Ut)}else Ut(xt+".autorange",!0),Ut(xt+".range",null);e(st,xt+"._inputRange").set(null)}else if($e.match(x)){var mr=e(st,Me).get(),Fr=(We||{}).type;(!Fr||Fr==="-")&&(Fr="linear"),r.getComponentMethod("annotations","convertCoords")(ke,mr,Fr,Ut),r.getComponentMethod("images","convertCoords")(ke,mr,Fr,Ut)}var Ir=u.containerArrayMatch(Me);if(Ir){tr=Ir.array,qt=Ir.index;var Sr=Ir.property,tt=ir||{editType:"calc"};qt!==""&&Sr===""&&(u.isAddVal(We)?jt[Me]=null:u.isRemoveVal(We)?jt[Me]=(e(Ke,tr).get()||[])[qt]:T.warn("unrecognized full object value",Ye)),A.update(ot,tt),Qt[tr]||(Qt[tr]={});var Ct=Qt[tr][qt];Ct||(Ct=Qt[tr][qt]={}),Ct[Sr]=We,delete Ye[Me]}else $e==="reverse"?(kt.range?kt.range.reverse():(Ut(xt+".autorange",!0),kt.range=[1,0]),Wt.autorange?ot.calc=!0:ot.plot=!0):(st._has("scatter-like")&&st._has("regl")&&Me==="dragmode"&&(We==="lasso"||We==="select")&&!(Ft==="lasso"||Ft==="select")||st._has("gl2d")?ot.plot=!0:ir?A.update(ot,ir):ot.calc=!0,Ne.set(We))}}for(tr in Qt){var Zt=u.applyContainerArrayChanges(ke,bt(Ke,tr),Qt[tr],ot,bt);Zt||(ot.plot=!0)}for(var ur in yr){nt=o.getFromId(ke,ur);var Lr=nt&&nt._constraintGroup;if(Lr){ot.calc=!0;for(var Br in Lr)yr[Br]||(o.getFromId(ke,Br)._constraintShrinkable=!0)}}return(we(ke)||Ye.height||Ye.width)&&(ot.plot=!0),(ot.plot||ot.calc)&&(ot.layoutReplot=!0),{flags:ot,rangesAltered:yr,undoit:jt,redoit:Vt,eventData:Ot}}function we(ke){var Ye=ke._fullLayout,Ke=Ye.width,st=Ye.height;return ke.layout.autosize&&f.plotAutoSize(ke,ke.layout,Ye),Ye.width!==Ke||Ye.height!==st}function De(ke,Ye,Ke,st){ke=T.getGraphDiv(ke),_.clearPromiseQueue(ke),T.isPlainObject(Ye)||(Ye={}),T.isPlainObject(Ke)||(Ke={}),Object.keys(Ye).length&&(ke.changed=!0),Object.keys(Ke).length&&(ke.changed=!0);var Et=_.coerceTraceIndices(ke,st),bt=ee(ke,T.extendFlat({},Ye),Et),zt=bt.flags,$t=Ae(ke,T.extendFlat({},Ke)),Ot=$t.flags;(zt.calc||Ot.calc)&&(ke.calcdata=void 0),zt.clearAxisTypes&&_.clearAxisTypes(ke,Et,Ke);var Qt=[];Ot.layoutReplot?Qt.push(s.layoutReplot):zt.fullReplot?Qt.push(ne._doPlot):(Qt.push(f.previousPromises),le(ke,Ot,$t)||f.supplyDefaults(ke),zt.style&&Qt.push(s.doTraceStyle),(zt.colorbars||Ot.colorbars)&&Qt.push(s.doColorBars),Ot.legend&&Qt.push(s.doLegend),Ot.layoutstyle&&Qt.push(s.layoutStyles),Ot.axrange&&ye(Qt,$t.rangesAltered),Ot.ticks&&Qt.push(s.doTicksRelayout),Ot.modebar&&Qt.push(s.doModeBar),Ot.camera&&Qt.push(s.doCamera),Qt.push(L)),Qt.push(f.rehover,f.redrag),n.add(ke,De,[ke,bt.undoit,$t.undoit,bt.traces],De,[ke,bt.redoit,$t.redoit,bt.traces]);var tr=T.syncOrAsync(Qt,ke);return(!tr||!tr.then)&&(tr=Promise.resolve(ke)),tr.then(function(){return ke.emit("plotly_update",{data:bt.eventData,layout:$t.eventData}),ke})}function Be(ke){return function(Ke){Ke._fullLayout._guiEditing=!0;var st=ke.apply(null,arguments);return Ke._fullLayout._guiEditing=!1,st}}var Ve=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],xe=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function Le(ke,Ye){for(var Ke=0;Ke<Ye.length;Ke++){var st=Ye[Ke],Et=ke.match(st.pattern);if(Et){var bt=Et[1]||"";return{head:bt,tail:ke.substr(bt.length+1),attr:st.attr}}}}function He(ke,Ye){var Ke=e(Ye,ke).get();if(Ke!==void 0)return Ke;var st=ke.split(".");for(st.pop();st.length>1;)if(st.pop(),Ke=e(Ye,st.join(".")+".uirevision").get(),Ke!==void 0)return Ke;return Ye.uirevision}function Je(ke,Ye){for(var Ke=0;Ke<Ye.length;Ke++)if(Ye[Ke]._fullInput.uid===ke)return Ke;return-1}function Oe(ke,Ye,Ke){for(var st=0;st<Ye.length;st++)if(Ye[st].uid===ke)return st;return!Ye[Ke]||Ye[Ke].uid?-1:Ke}function Pe(ke,Ye){var Ke=T.isPlainObject(ke),st=Array.isArray(ke);return Ke||st?(Ke&&T.isPlainObject(Ye)||st&&Array.isArray(Ye))&&JSON.stringify(ke)===JSON.stringify(Ye):ke===Ye}function Ue(ke,Ye,Ke,st){var Et=st._preGUI,bt,zt,$t,Ot,Qt,tr,qt,lr,Wr,cn,Jr=[],ot={},Vt={};for(bt in Et){if(Qt=Le(bt,Ve),Qt){if(Wr=Qt.head,cn=Qt.tail,zt=Qt.attr||Wr+".uirevision",$t=e(st,zt).get(),Ot=$t&&He(zt,Ye),Ot&&Ot===$t){if(tr=Et[bt],tr===null&&(tr=void 0),qt=e(Ye,bt),lr=qt.get(),Pe(lr,tr)){lr===void 0&&cn==="autorange"&&Jr.push(Wr),qt.set(q(e(st,bt).get()));continue}else if(cn==="autorange"||cn.substr(0,6)==="range["){var jt=Et[Wr+".range[0]"],Ut=Et[Wr+".range[1]"],yr=Et[Wr+".autorange"];if(yr||yr===null&&jt===null&&Ut===null){if(!(Wr in ot)){var nt=e(Ye,Wr).get();ot[Wr]=nt&&(nt.autorange||nt.autorange!==!1&&(!nt.range||nt.range.length!==2))}if(ot[Wr]){qt.set(q(e(st,bt).get()));continue}}}}}else T.warn("unrecognized GUI edit: "+bt);delete Et[bt],Qt&&Qt.tail.substr(0,6)==="range["&&(Vt[Qt.head]=1)}for(var _e=0;_e<Jr.length;_e++){var Me=Jr[_e];if(Vt[Me]){var Ne=e(Ye,Me).get();Ne&&delete Ne.autorange}}var We=st._tracePreGUI;for(var Qe in We){var rt=We[Qe],$e=null,ht;for(bt in rt){if(!$e){var xt=Je(Qe,Ke);if(xt<0){delete We[Qe];break}var kt=Ke[xt];ht=kt._fullInput;var Wt=Oe(Qe,ke,ht.index);if(Wt<0){delete We[Qe];break}$e=ke[Wt]}if(Qt=Le(bt,xe),Qt){if(Qt.attr?($t=e(st,Qt.attr).get(),Ot=$t&&He(Qt.attr,Ye)):($t=ht.uirevision,Ot=$e.uirevision,Ot===void 0&&(Ot=Ye.uirevision)),Ot&&Ot===$t&&(tr=rt[bt],tr===null&&(tr=void 0),qt=e($e,bt),lr=qt.get(),Pe(lr,tr))){qt.set(q(e(ht,bt).get()));continue}}else T.warn("unrecognized GUI edit: "+bt+" in trace uid "+Qe);delete rt[bt]}}}function vt(ke,Ye,Ke,st){var Et,bt;function zt(){return ne.addFrames(ke,Et)}ke=T.getGraphDiv(ke),_.clearPromiseQueue(ke);var $t=ke._fullData,Ot=ke._fullLayout;if(!T.isPlotDiv(ke)||!$t||!Ot)bt=ne.newPlot(ke,Ye,Ke,st);else{if(T.isPlainObject(Ye)){var Qt=Ye;Ye=Qt.data,Ke=Qt.layout,st=Qt.config,Et=Qt.frames}var tr=!1;if(st){var qt=T.extendDeep({},ke._context);ke._context=void 0,z(ke,st),tr=Rt(qt,ke._context)}ke.data=Ye||[],_.cleanData(ke.data),ke.layout=Ke||{},_.cleanLayout(ke.layout),Ue(ke.data,ke.layout,$t,Ot),f.supplyDefaults(ke,{skipUpdateCalc:!0});var lr=ke._fullData,Wr=ke._fullLayout,cn=Wr.datarevision===void 0,Jr=Wr.transition,ot=Yt(ke,Ot,Wr,cn,Jr),Vt=ot.newDataRevision,jt=Lt(ke,$t,lr,cn,Jr,Vt);if(we(ke)&&(ot.layoutReplot=!0),jt.calc||ot.calc){ke.calcdata=void 0;for(var Ut=Object.getOwnPropertyNames(Wr),yr=0;yr<Ut.length;yr++){var nt=Ut[yr],_e=nt.substring(0,5);if(_e==="xaxis"||_e==="yaxis"){var Me=Wr[nt]._emptyCategories;Me&&Me()}}}else f.supplyDefaultsUpdateCalc(ke.calcdata,lr);var Ne=[];if(Et&&(ke._transitionData={},f.createTransitionData(ke),Ne.push(zt)),Wr.transition&&!tr&&(jt.anim||ot.anim))ot.ticks&&Ne.push(s.doTicksRelayout),f.doCalcdata(ke),s.doAutoRangeAndConstraints(ke),Ne.push(function(){return f.transitionFromReact(ke,jt,ot,Ot)});else if(jt.fullReplot||ot.layoutReplot||tr)ke._fullLayout._skipDefaults=!0,Ne.push(ne._doPlot);else{for(var We in ot.arrays){var Qe=ot.arrays[We];if(Qe.length){var rt=r.getComponentMethod(We,"drawOne");if(rt!==T.noop)for(var $e=0;$e<Qe.length;$e++)rt(ke,Qe[$e]);else{var ht=r.getComponentMethod(We,"draw");if(ht===T.noop)throw new Error("cannot draw components: "+We);ht(ke)}}}Ne.push(f.previousPromises),jt.style&&Ne.push(s.doTraceStyle),(jt.colorbars||ot.colorbars)&&Ne.push(s.doColorBars),ot.legend&&Ne.push(s.doLegend),ot.layoutstyle&&Ne.push(s.layoutStyles),ot.axrange&&ye(Ne),ot.ticks&&Ne.push(s.doTicksRelayout),ot.modebar&&Ne.push(s.doModeBar),ot.camera&&Ne.push(s.doCamera),Ne.push(L)}Ne.push(f.rehover,f.redrag),bt=T.syncOrAsync(Ne,ke),(!bt||!bt.then)&&(bt=Promise.resolve(ke))}return bt.then(function(){return ke.emit("plotly_react",{data:Ye,layout:Ke}),ke})}function Lt(ke,Ye,Ke,st,Et,bt){var zt=Ye.length===Ke.length;if(!Et&&!zt)return{fullReplot:!0,calc:!0};var $t=A.traceFlags();$t.arrays={},$t.nChanges=0,$t.nChangesAnim=0;var Ot,Qt;function tr(Wr){var cn=t.getTraceValObject(Qt,Wr);return!Qt._module.animatable&&cn.anim&&(cn.anim=!1),cn}var qt={getValObject:tr,flags:$t,immutable:st,transition:Et,newDataRevision:bt,gd:ke},lr={};for(Ot=0;Ot<Ye.length;Ot++)if(Ke[Ot]){if(Qt=Ke[Ot]._fullInput,f.hasMakesDataTransform(Qt)&&(Qt=Ke[Ot]),lr[Qt.uid])continue;lr[Qt.uid]=1,At(Ye[Ot]._fullInput,Qt,[],qt)}return($t.calc||$t.plot)&&($t.fullReplot=!0),Et&&$t.nChanges&&$t.nChangesAnim&&($t.anim=$t.nChanges===$t.nChangesAnim&&zt?"all":"some"),$t}function Yt(ke,Ye,Ke,st,Et){var bt=A.layoutFlags();bt.arrays={},bt.rangesAltered={},bt.nChanges=0,bt.nChangesAnim=0;function zt(Ot){return t.getLayoutValObject(Ke,Ot)}var $t={getValObject:zt,flags:bt,immutable:st,transition:Et,gd:ke};return At(Ye,Ke,[],$t),(bt.plot||bt.calc)&&(bt.layoutReplot=!0),Et&&bt.nChanges&&bt.nChangesAnim&&(bt.anim=bt.nChanges===bt.nChangesAnim?"all":"some"),bt}function At(ke,Ye,Ke,st){var Et,bt,zt,$t=st.getValObject,Ot=st.flags,Qt=st.immutable,tr=st.inArray,qt=st.arrayIndex;function lr(){var xt=Et.editType;if(tr&&xt.indexOf("arraydraw")!==-1){T.pushUnique(Ot.arrays[tr],qt);return}A.update(Ot,Et),xt!=="none"&&Ot.nChanges++,st.transition&&Et.anim&&Ot.nChangesAnim++,(fe.test(zt)||pe.test(zt))&&(Ot.rangesAltered[Ke[0]]=1),ge.test(zt)&&e(Ye,"_inputDomain").set(null),bt==="datarevision"&&(Ot.newDataRevision=1)}function Wr(xt){return xt.valType==="data_array"||xt.arrayOk}for(bt in ke){if(Ot.calc&&!st.transition)return;var cn=ke[bt],Jr=Ye[bt],ot=Ke.concat(bt);if(zt=ot.join("."),!(bt.charAt(0)==="_"||typeof cn=="function"||cn===Jr)){if((bt==="tick0"||bt==="dtick")&&Ke[0]!=="geo"){var Vt=Ye.tickmode;if(Vt==="auto"||Vt==="array"||!Vt)continue}if(!(bt==="range"&&Ye.autorange)&&!((bt==="zmin"||bt==="zmax")&&Ye.type==="contourcarpet")&&(Et=$t(ot),!!Et&&!(Et._compareAsJSON&&JSON.stringify(cn)===JSON.stringify(Jr)))){var jt=Et.valType,Ut,yr=Wr(Et),nt=Array.isArray(cn),_e=Array.isArray(Jr);if(nt&&_e){var Me="_input_"+bt,Ne=ke[Me],We=Ye[Me];if(Array.isArray(Ne)&&Ne===We)continue}if(Jr===void 0)yr&&nt?Ot.calc=!0:lr();else if(Et._isLinkedToArray){var Qe=[],rt=!1;tr||(Ot.arrays[bt]=Qe);var $e=Math.min(cn.length,Jr.length),ht=Math.max(cn.length,Jr.length);if($e!==ht)if(Et.editType==="arraydraw")rt=!0;else{lr();continue}for(Ut=0;Ut<$e;Ut++)At(cn[Ut],Jr[Ut],ot.concat(Ut),T.extendFlat({inArray:bt,arrayIndex:Ut},st));if(rt)for(Ut=$e;Ut<ht;Ut++)Qe.push(Ut)}else!jt&&T.isPlainObject(cn)?At(cn,Jr,ot,st):yr?nt&&_e?(Qt&&(Ot.calc=!0),(Qt||st.newDataRevision)&&lr()):nt!==_e?Ot.calc=!0:lr():nt&&_e?(cn.length!==Jr.length||String(cn)!==String(Jr))&&lr():lr()}}}for(bt in Ye)if(!(bt in ke||bt.charAt(0)==="_"||typeof Ye[bt]=="function"))if(Et=$t(Ke.concat(bt)),Wr(Et)&&Array.isArray(Ye[bt])){Ot.calc=!0;return}else lr()}function Rt(ke,Ye){var Ke;for(Ke in ke)if(Ke.charAt(0)!=="_"){var st=ke[Ke],Et=Ye[Ke];if(st!==Et)if(T.isPlainObject(st)&&T.isPlainObject(Et)){if(Rt(st,Et))return!0}else if(Array.isArray(st)&&Array.isArray(Et)){if(st.length!==Et.length)return!0;for(var bt=0;bt<st.length;bt++)if(st[bt]!==Et[bt])if(T.isPlainObject(st[bt])&&T.isPlainObject(Et[bt])){if(Rt(st[bt],Et[bt]))return!0}else return!0}else return!0}}function Bt(ke,Ye,Ke){if(ke=T.getGraphDiv(ke),!T.isPlotDiv(ke))throw new Error("This element is not a Plotly plot: "+ke+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var st=ke._transitionData;st._frameQueue||(st._frameQueue=[]),Ke=f.supplyAnimationDefaults(Ke);var Et=Ke.transition,bt=Ke.frame;st._frameWaitingCnt===void 0&&(st._frameWaitingCnt=0);function zt(Qt){return Array.isArray(Et)?Qt>=Et.length?Et[0]:Et[Qt]:Et}function $t(Qt){return Array.isArray(bt)?Qt>=bt.length?bt[0]:bt[Qt]:bt}function Ot(Qt,tr){var qt=0;return function(){if(Qt&&++qt===tr)return Qt()}}return new Promise(function(Qt,tr){function qt(){if(st._frameQueue.length!==0){for(;st._frameQueue.length;){var $e=st._frameQueue.pop();$e.onInterrupt&&$e.onInterrupt()}ke.emit("plotly_animationinterrupted",[])}}function lr($e){if($e.length!==0){for(var ht=0;ht<$e.length;ht++){var xt;$e[ht].type==="byname"?xt=f.computeFrame(ke,$e[ht].name):xt=$e[ht].data;var kt=$t(ht),Wt=zt(ht);Wt.duration=Math.min(Wt.duration,kt.duration);var Ft={frame:xt,name:$e[ht].name,frameOpts:kt,transitionOpts:Wt};ht===$e.length-1&&(Ft.onComplete=Ot(Qt,2),Ft.onInterrupt=tr),st._frameQueue.push(Ft)}Ke.mode==="immediate"&&(st._lastFrameAt=-1/0),st._animationRaf||Jr()}}function Wr(){ke.emit("plotly_animated"),window.cancelAnimationFrame(st._animationRaf),st._animationRaf=null}function cn(){st._currentFrame&&st._currentFrame.onComplete&&st._currentFrame.onComplete();var $e=st._currentFrame=st._frameQueue.shift();if($e){var ht=$e.name?$e.name.toString():null;ke._fullLayout._currentFrame=ht,st._lastFrameAt=Date.now(),st._timeToNext=$e.frameOpts.duration,f.transition(ke,$e.frame.data,$e.frame.layout,_.coerceTraceIndices(ke,$e.frame.traces),$e.frameOpts,$e.transitionOpts).then(function(){$e.onComplete&&$e.onComplete()}),ke.emit("plotly_animatingframe",{name:ht,frame:$e.frame,animation:{frame:$e.frameOpts,transition:$e.transitionOpts}})}else Wr()}function Jr(){ke.emit("plotly_animating"),st._lastFrameAt=-1/0,st._timeToNext=0,st._runningTransitions=0,st._currentFrame=null;var $e=function(){st._animationRaf=window.requestAnimationFrame($e),Date.now()-st._lastFrameAt>st._timeToNext&&cn()};$e()}var ot=0;function Vt($e){return Array.isArray(Et)?ot>=Et.length?$e.transitionOpts=Et[ot]:$e.transitionOpts=Et[0]:$e.transitionOpts=Et,ot++,$e}var jt,Ut,yr=[],nt=Ye==null,_e=Array.isArray(Ye),Me=!nt&&!_e&&T.isPlainObject(Ye);if(Me)yr.push({type:"object",data:Vt(T.extendFlat({},Ye))});else if(nt||["string","number"].indexOf(typeof Ye)!==-1)for(jt=0;jt<st._frames.length;jt++)Ut=st._frames[jt],!!Ut&&(nt||String(Ut.group)===String(Ye))&&yr.push({type:"byname",name:String(Ut.name),data:Vt({name:Ut.name})});else if(_e)for(jt=0;jt<Ye.length;jt++){var Ne=Ye[jt];["number","string"].indexOf(typeof Ne)!==-1?(Ne=String(Ne),yr.push({type:"byname",name:Ne,data:Vt({name:Ne})})):T.isPlainObject(Ne)&&yr.push({type:"object",data:Vt(T.extendFlat({},Ne))})}for(jt=0;jt<yr.length;jt++)if(Ut=yr[jt],Ut.type==="byname"&&!st._frameHash[Ut.data.name]){T.warn('animate failure: frame not found: "'+Ut.data.name+'"'),tr();return}["next","immediate"].indexOf(Ke.mode)!==-1&&qt(),Ke.direction==="reverse"&&yr.reverse();var We=ke._fullLayout._currentFrame;if(We&&Ke.fromcurrent){var Qe=-1;for(jt=0;jt<yr.length;jt++)if(Ut=yr[jt],Ut.type==="byname"&&Ut.name===We){Qe=jt;break}if(Qe>0&&Qe<yr.length-1){var rt=[];for(jt=0;jt<yr.length;jt++)Ut=yr[jt],(yr[jt].type!=="byname"||jt>Qe)&&rt.push(Ut);yr=rt}}yr.length>0?lr(yr):(ke.emit("plotly_animated"),Qt())})}function Mt(ke,Ye,Ke){if(ke=T.getGraphDiv(ke),Ye==null)return Promise.resolve();if(!T.isPlotDiv(ke))throw new Error("This element is not a Plotly plot: "+ke+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var st,Et,bt,zt,$t=ke._transitionData._frames,Ot=ke._transitionData._frameHash;if(!Array.isArray(Ye))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+Ye);var Qt=$t.length+Ye.length*2,tr=[],qt={};for(st=Ye.length-1;st>=0;st--)if(!!T.isPlainObject(Ye[st])){var lr=Ye[st].name,Wr=(Ot[lr]||qt[lr]||{}).name,cn=Ye[st].name,Jr=Ot[Wr]||qt[Wr];Wr&&cn&&typeof cn=="number"&&Jr&&v<b&&(v++,T.warn('addFrames: overwriting frame "'+(Ot[Wr]||qt[Wr]).name+'" with a frame whose name of type "number" also equates to "'+Wr+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),v===b&&T.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),qt[lr]={name:lr},tr.push({frame:f.supplyFrameDefaults(Ye[st]),index:Ke&&Ke[st]!==void 0&&Ke[st]!==null?Ke[st]:Qt+st})}tr.sort(function(Me,Ne){return Me.index>Ne.index?-1:Me.index<Ne.index?1:0});var ot=[],Vt=[],jt=$t.length;for(st=tr.length-1;st>=0;st--){if(Et=tr[st].frame,typeof Et.name=="number"&&T.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!Et.name)for(;Ot[Et.name="frame "+ke._transitionData._counter++];);if(Ot[Et.name]){for(bt=0;bt<$t.length&&($t[bt]||{}).name!==Et.name;bt++);ot.push({type:"replace",index:bt,value:Et}),Vt.unshift({type:"replace",index:bt,value:$t[bt]})}else zt=Math.max(0,Math.min(tr[st].index,jt)),ot.push({type:"insert",index:zt,value:Et}),Vt.unshift({type:"delete",index:zt}),jt++}var Ut=f.modifyFrames,yr=f.modifyFrames,nt=[ke,Vt],_e=[ke,ot];return n&&n.add(ke,Ut,nt,yr,_e),f.modifyFrames(ke,ot)}function Tt(ke,Ye){if(ke=T.getGraphDiv(ke),!T.isPlotDiv(ke))throw new Error("This element is not a Plotly plot: "+ke);var Ke,st,Et=ke._transitionData._frames,bt=[],zt=[];if(!Ye)for(Ye=[],Ke=0;Ke<Et.length;Ke++)Ye.push(Ke);for(Ye=Ye.slice(),Ye.sort(),Ke=Ye.length-1;Ke>=0;Ke--)st=Ye[Ke],bt.push({type:"delete",index:st}),zt.unshift({type:"insert",index:st,value:Et[st]});var $t=f.modifyFrames,Ot=f.modifyFrames,Qt=[ke,zt],tr=[ke,bt];return n&&n.add(ke,$t,Qt,Ot,tr),f.modifyFrames(ke,bt)}function at(ke){ke=T.getGraphDiv(ke);var Ye=ke._fullLayout||{},Ke=ke._fullData||[];return f.cleanPlot([],{},Ke,Ye),f.purge(ke),a.purge(ke),Ye._container&&Ye._container.remove(),delete ke._context,ke}function ct(ke){var Ye=ke._fullLayout,Ke=ke.getBoundingClientRect();if(!T.equalDomRects(Ke,Ye._lastBBox)){var st=Ye._invTransform=T.inverseTransformMatrix(T.getFullTransformMatrix(ke));Ye._invScaleX=Math.sqrt(st[0][0]*st[0][0]+st[0][1]*st[0][1]+st[0][2]*st[0][2]),Ye._invScaleY=Math.sqrt(st[1][0]*st[1][0]+st[1][1]*st[1][1]+st[1][2]*st[1][2]),Ye._lastBBox=Ke}}function je(ke){var Ye=w.select(ke),Ke=ke._fullLayout;if(Ke._calcInverseTransform=ct,Ke._calcInverseTransform(ke),Ke._container=Ye.selectAll(".plot-container").data([0]),Ke._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Ke._paperdiv=Ke._container.selectAll(".svg-container").data([0]),Ke._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Ke._glcontainer=Ke._paperdiv.selectAll(".gl-container").data([{}]),Ke._glcontainer.enter().append("div").classed("gl-container",!0),Ke._paperdiv.selectAll(".main-svg").remove(),Ke._paperdiv.select(".modebar-container").remove(),Ke._paper=Ke._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Ke._toppaper=Ke._paperdiv.append("svg").classed("main-svg",!0),Ke._modebardiv=Ke._paperdiv.append("div"),delete Ke._modeBar,Ke._hoverpaper=Ke._paperdiv.append("svg").classed("main-svg",!0),!Ke._uid){var st={};w.selectAll("defs").each(function(){this.id&&(st[this.id.split("-")[1]]=1)}),Ke._uid=T.randstr(st)}Ke._paperdiv.selectAll(".main-svg").attr(y.svgAttrs),Ke._defs=Ke._paper.append("defs").attr("id","defs-"+Ke._uid),Ke._clips=Ke._defs.append("g").classed("clips",!0),Ke._topdefs=Ke._toppaper.append("defs").attr("id","topdefs-"+Ke._uid),Ke._topclips=Ke._topdefs.append("g").classed("clips",!0),Ke._bgLayer=Ke._paper.append("g").classed("bglayer",!0),Ke._draggers=Ke._paper.append("g").classed("draglayer",!0);var Et=Ke._paper.append("g").classed("layer-below",!0);Ke._imageLowerLayer=Et.append("g").classed("imagelayer",!0),Ke._shapeLowerLayer=Et.append("g").classed("shapelayer",!0),Ke._cartesianlayer=Ke._paper.append("g").classed("cartesianlayer",!0),Ke._polarlayer=Ke._paper.append("g").classed("polarlayer",!0),Ke._smithlayer=Ke._paper.append("g").classed("smithlayer",!0),Ke._ternarylayer=Ke._paper.append("g").classed("ternarylayer",!0),Ke._geolayer=Ke._paper.append("g").classed("geolayer",!0),Ke._funnelarealayer=Ke._paper.append("g").classed("funnelarealayer",!0),Ke._pielayer=Ke._paper.append("g").classed("pielayer",!0),Ke._iciclelayer=Ke._paper.append("g").classed("iciclelayer",!0),Ke._treemaplayer=Ke._paper.append("g").classed("treemaplayer",!0),Ke._sunburstlayer=Ke._paper.append("g").classed("sunburstlayer",!0),Ke._indicatorlayer=Ke._toppaper.append("g").classed("indicatorlayer",!0),Ke._glimages=Ke._paper.append("g").classed("glimages",!0);var bt=Ke._toppaper.append("g").classed("layer-above",!0);Ke._imageUpperLayer=bt.append("g").classed("imagelayer",!0),Ke._shapeUpperLayer=bt.append("g").classed("shapelayer",!0),Ke._infolayer=Ke._toppaper.append("g").classed("infolayer",!0),Ke._menulayer=Ke._toppaper.append("g").classed("menulayer",!0),Ke._zoomlayer=Ke._toppaper.append("g").classed("zoomlayer",!0),Ke._hoverlayer=Ke._hoverpaper.append("g").classed("hoverlayer",!0),Ke._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),ke.emit("plotly_framework")}ne.animate=Bt,ne.addFrames=Mt,ne.deleteFrames=Tt,ne.addTraces=se,ne.deleteTraces=ie,ne.extendTraces=X,ne.moveTraces=N,ne.prependTraces=oe,ne.newPlot=D,ne._doPlot=l,ne.purge=at,ne.react=vt,ne.redraw=I,ne.relayout=ae,ne.restyle=U,ne.setPlotConfig=S,ne.update=De,ne._guiRelayout=Be(ae),ne._guiRestyle=Be(U),ne._guiUpdate=Be(De),ne._storeDirectGUIEdit=Z},{"../components/color":366,"../components/drawing":388,"../constants/xmlns_namespaces":480,"../lib":503,"../lib/events":492,"../lib/queue":519,"../plots/cartesian/axes":554,"../plots/cartesian/constants":561,"../plots/cartesian/graph_interact":564,"../plots/cartesian/select":575,"../plots/plots":619,"../registry":638,"./edit_types":536,"./helpers":537,"./manage_arrays":539,"./plot_config":541,"./plot_schema":542,"./subroutines":544,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],541:[function(d,re,ne){var w={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},c={};function M(T,e){for(var a in T){var n=T[a];n.valType?e[a]=n.dflt:(e[a]||(e[a]={}),M(n,e[a]))}}M(w,c),re.exports={configAttributes:w,dfltConfig:c}},{}],542:[function(d,re,ne){var w=d("../registry"),c=d("../lib"),M=d("../plots/attributes"),T=d("../plots/layout_attributes"),e=d("../plots/frame_attributes"),a=d("../plots/animation_attributes"),n=d("./plot_config").configAttributes,r=d("./edit_types"),t=c.extendDeepAll,f=c.isPlainObject,o=c.isArrayOrTypedArray,i=c.nestedProperty,g=c.valObjectMeta,p="_isSubplotObj",y="_isLinkedToArray",h="_arrayAttrRegexps",m="_deprecated",u=[p,y,h,m];ne.IS_SUBPLOT_OBJ=p,ne.IS_LINKED_TO_ARRAY=y,ne.DEPRECATED=m,ne.UNDERSCORE_ATTRS=u,ne.get=function(){var D={};w.allTypes.forEach(function(B){D[B]=x(B)});var R={};return Object.keys(w.transformsRegistry).forEach(function(B){R[B]=b(B)}),{defs:{valObjects:g,metaKeys:u.concat(["description","role","editType","impliedEdits"]),editType:{traces:r.traces,layout:r.layout},impliedEdits:{}},traces:D,layout:v(),transforms:R,frames:l(),animation:L(a),config:L(n)}},ne.crawl=function(D,R,B,F){var V=B||0;F=F||"",Object.keys(D).forEach(function(G){var J=D[G];if(u.indexOf(G)===-1){var j=(F?F+".":"")+G;R(J,G,D,V,j),!ne.isValObject(J)&&f(J)&&G!=="impliedEdits"&&ne.crawl(J,R,V+1,j)}})},ne.isValObject=function(D){return D&&D.valType!==void 0},ne.findArrayAttributes=function(D){var R=[],B=[],F=[],V,G;function J(ie,N,U,q){B=B.slice(0,q).concat([N]),F=F.slice(0,q).concat([ie&&ie._isLinkedToArray]);var Q=ie&&(ie.valType==="data_array"||ie.arrayOk===!0)&&!(B[q-1]==="colorbar"&&(N==="ticktext"||N==="tickvals"));!Q||j(V,0,"")}function j(ie,N,U){var q=ie[B[N]],Q=U+B[N];if(N===B.length-1)o(q)&&R.push(G+Q);else if(F[N]){if(Array.isArray(q))for(var W=0;W<q.length;W++)f(q[W])&&j(q[W],N+1,Q+"["+W+"].")}else f(q)&&j(q,N+1,Q+".")}V=D,G="",ne.crawl(M,J),D._module&&D._module.attributes&&ne.crawl(D._module.attributes,J);var Y=D.transforms;if(Y)for(var X=0;X<Y.length;X++){var oe=Y[X],se=oe._module;se&&(G="transforms["+X+"].",V=oe,ne.crawl(se.attributes,J))}return R},ne.getTraceValObject=function(D,R){var B=R[0],F=1,V,G;if(B==="transforms"){if(R.length===1)return M.transforms;var J=D.transforms;if(!Array.isArray(J)||!J.length)return!1;var j=R[1];if(!A(j)||j>=J.length)return!1;V=(w.transformsRegistry[J[j].type]||{}).attributes,G=V&&V[R[2]],F=3}else{var Y=D._module;if(Y||(Y=(w.modules[D.type||M.type.dflt]||{})._module),!Y)return!1;if(V=Y.attributes,G=V&&V[B],!G){var X=Y.basePlotModule;X&&X.attributes&&(G=X.attributes[B])}G||(G=M[B])}return s(G,R,F)},ne.getLayoutValObject=function(D,R){var B=_(D,R[0]);return s(B,R,1)};function _(D,R){var B,F,V,G,J=D._basePlotModules;if(J){var j;for(B=0;B<J.length;B++){if(V=J[B],V.attrRegex&&V.attrRegex.test(R)){if(V.layoutAttrOverrides)return V.layoutAttrOverrides;!j&&V.layoutAttributes&&(j=V.layoutAttributes)}var Y=V.baseLayoutAttrOverrides;if(Y&&R in Y)return Y[R]}if(j)return j}var X=D._modules;if(X){for(B=0;B<X.length;B++)if(G=X[B].layoutAttributes,G&&R in G)return G[R]}for(F in w.componentsRegistry){if(V=w.componentsRegistry[F],V.name==="colorscale"&&R.indexOf("coloraxis")===0)return V.layoutAttributes[R];if(!V.schema&&R===V.name)return V.layoutAttributes}return R in T?T[R]:!1}function s(D,R,B){if(!D)return!1;if(D._isLinkedToArray){if(A(R[B]))B++;else if(B<R.length)return!1}for(;B<R.length;B++){var F=D[R[B]];if(f(F))D=F;else break;if(B===R.length-1)break;if(D._isLinkedToArray){if(B++,!A(R[B]))return!1}else if(D.valType==="info_array"){B++;var V=R[B];if(!A(V))return!1;var G=D.items;if(Array.isArray(G)){if(V>=G.length)return!1;if(D.dimensions===2){if(B++,R.length===B)return D;var J=R[B];if(!A(J))return!1;D=G[V][J]}else D=G[V]}else D=G}}return D}function A(D){return D===Math.round(D)&&D>=0}function x(D){var R,B;R=w.modules[D]._module,B=R.basePlotModule;var F={};F.type=null;var V=t({},M),G=t({},R.attributes);ne.crawl(G,function(Y,X,oe,se,ie){i(V,ie).set(void 0),Y===void 0&&i(G,ie).set(void 0)}),t(F,V),w.traceIs(D,"noOpacity")&&delete F.opacity,w.traceIs(D,"showLegend")||(delete F.showlegend,delete F.legendgroup),w.traceIs(D,"noHover")&&(delete F.hoverinfo,delete F.hoverlabel),R.selectPoints||delete F.selectedpoints,t(F,G),B.attributes&&t(F,B.attributes),F.type=D;var J={meta:R.meta||{},categories:R.categories||{},animatable:Boolean(R.animatable),type:D,attributes:L(F)};if(R.layoutAttributes){var j={};t(j,R.layoutAttributes),J.layoutAttributes=L(j)}return R.animatable||ne.crawl(J,function(Y){ne.isValObject(Y)&&"anim"in Y&&delete Y.anim}),J}function v(){var D={},R,B;t(D,T);for(R in w.subplotsRegistry)if(B=w.subplotsRegistry[R],!!B.layoutAttributes)if(Array.isArray(B.attr))for(var F=0;F<B.attr.length;F++)z(D,B,B.attr[F]);else{var V=B.attr==="subplot"?B.name:B.attr;z(D,B,V)}for(R in w.componentsRegistry){B=w.componentsRegistry[R];var G=B.schema;if(G&&(G.subplots||G.layout)){var J=G.subplots;if(J&&J.xaxis&&!J.yaxis)for(var j in J.xaxis)delete D.yaxis[j]}else B.name==="colorscale"?t(D,B.layoutAttributes):B.layoutAttributes&&I(D,B.layoutAttributes,B.name)}return{layoutAttributes:L(D)}}function b(D){var R=w.transformsRegistry[D],B=t({},R.attributes);return Object.keys(w.componentsRegistry).forEach(function(F){var V=w.componentsRegistry[F];V.schema&&V.schema.transforms&&V.schema.transforms[D]&&Object.keys(V.schema.transforms[D]).forEach(function(G){I(B,V.schema.transforms[D][G],G)})}),{attributes:L(B)}}function l(){var D={frames:t({},e)};return L(D),D.frames}function L(D){return S(D),k(D),P(D),D}function S(D){function R(F){return{valType:"string",editType:"none"}}function B(F,V,G){ne.isValObject(F)?(F.arrayOk===!0||F.valType==="data_array")&&(G[V+"src"]=R()):f(F)&&(F.role="object")}ne.crawl(D,B)}function k(D){function R(B,F,V){if(!!B){var G=B[y];!G||(delete B[y],V[F]={items:{}},V[F].items[G]=B,V[F].role="object")}}ne.crawl(D,R)}function P(D){function R(B){for(var F in B)if(f(B[F]))R(B[F]);else if(Array.isArray(B[F]))for(var V=0;V<B[F].length;V++)R(B[F][V]);else B[F]instanceof RegExp&&(B[F]=B[F].toString())}R(D)}function z(D,R,B){var F=i(D,B),V=t({},R.layoutAttributes);V[p]=!0,F.set(V)}function I(D,R,B){var F=i(D,B);F.set(t(F.get()||{},R))}},{"../lib":503,"../plots/animation_attributes":548,"../plots/attributes":550,"../plots/frame_attributes":586,"../plots/layout_attributes":610,"../registry":638,"./edit_types":536,"./plot_config":541}],543:[function(d,re,ne){var w=d("../lib"),c=d("../plots/attributes"),M="templateitemname",T={name:{valType:"string",editType:"none"}};T[M]={valType:"string",editType:"calc"},ne.templatedArray=function(n,r){return r._isLinkedToArray=n,r.name=T.name,r[M]=T[M],r},ne.traceTemplater=function(n){var r={},t,f;for(t in n)f=n[t],Array.isArray(f)&&f.length&&(r[t]=0);function o(i){t=w.coerce(i,{},c,"type");var g={type:t,_template:null};if(t in r){f=n[t];var p=r[t]%f.length;r[t]++,g._template=f[p]}return g}return{newTrace:o}},ne.newContainer=function(n,r,t){var f=n._template,o=f&&(f[r]||t&&f[t]);w.isPlainObject(o)||(o=null);var i=n[r]={_template:o};return i},ne.arrayTemplater=function(n,r,t){var f=n._template,o=f&&f[a(r)],i=f&&f[r];(!Array.isArray(i)||!i.length)&&(i=[]);var g={};function p(h){var m={name:h.name,_input:h},u=m[M]=h[M];if(!e(u))return m._template=o,m;for(var _=0;_<i.length;_++){var s=i[_];if(s.name===u)return g[u]=1,m._template=s,m}return m[t]=h[t]||!1,m._template=!1,m}function y(){for(var h=[],m=0;m<i.length;m++){var u=i[m],_=u.name;if(e(_)&&!g[_]){var s={_template:u,name:_,_input:{_templateitemname:_}};s[M]=u[M],h.push(s),g[_]=1}}return h}return{newItem:p,defaultItems:y}};function e(n){return n&&typeof n=="string"}function a(n){var r=n.length-1;return n.charAt(r)!=="s"&&w.warn("bad argument to arrayDefaultKey: "+n),n.substr(0,n.length-1)+"defaults"}ne.arrayDefaultKey=a,ne.arrayEditor=function(n,r,t){var f=(w.nestedProperty(n,r).get()||[]).length,o=t._index,i=o>=f&&(t._input||{})._templateitemname;i&&(o=f);var g=r+"["+o+"]",p;function y(){p={},i&&(p[g]={},p[g][M]=i)}y();function h(s,A){p[s]=A}function m(s,A){i?w.nestedProperty(p[g],s).set(A):p[g+"."+s]=A}function u(){var s=p;return y(),s}function _(s,A){s&&m(s,A);var x=u();for(var v in x)w.nestedProperty(n,v).set(x[v])}return{modifyBase:h,modifyItem:m,getUpdateObj:u,applyUpdate:_}}},{"../lib":503,"../plots/attributes":550}],544:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../registry"),M=d("../plots/plots"),T=d("../lib"),e=d("../lib/clear_gl_canvases"),a=d("../components/color"),n=d("../components/drawing"),r=d("../components/titles"),t=d("../components/modebar"),f=d("../plots/cartesian/axes"),o=d("../constants/alignment"),i=d("../plots/cartesian/constraints"),g=i.enforce,p=i.clean,y=d("../plots/cartesian/autorange").doAutoRange,h="start",m="middle",u="end";ne.layoutStyles=function(k){return T.syncOrAsync([M.doAutoMargin,s],k)};function _(k,P,z){for(var I=0;I<z.length;I++){var D=z[I][0],R=z[I][1];if(!(D[0]>=k[1]||D[1]<=k[0])&&R[0]<P[1]&&R[1]>P[0])return!0}return!1}function s(k){var P=k._fullLayout,z=P._size,I=z.p,D=f.list(k,"",!0),R,B,F,V,G,J;if(P._paperdiv.style({width:k._context.responsive&&P.autosize&&!k._context._hasZeroWidth&&!k.layout.width?"100%":P.width+"px",height:k._context.responsive&&P.autosize&&!k._context._hasZeroHeight&&!k.layout.height?"100%":P.height+"px"}).selectAll(".main-svg").call(n.setSize,P.width,P.height),k._context.setBackground(k,P.paper_bgcolor),ne.drawMainTitle(k),t.manage(k),!P._has("cartesian"))return M.previousPromises(k);function j(Rt,Bt,Mt){var Tt=Rt._lw/2;if(Rt._id.charAt(0)==="x"){if(Bt){if(Mt==="top")return Bt._offset-I-Tt}else return z.t+z.h*(1-(Rt.position||0))+Tt%1;return Bt._offset+Bt._length+I+Tt}if(Bt){if(Mt==="right")return Bt._offset+Bt._length+I+Tt}else return z.l+z.w*(Rt.position||0)+Tt%1;return Bt._offset-I-Tt}for(R=0;R<D.length;R++){V=D[R];var Y=V._anchorAxis;V._linepositions={},V._lw=n.crispRound(k,V.linewidth,1),V._mainLinePosition=j(V,Y,V.side),V._mainMirrorPosition=V.mirror&&Y?j(V,Y,o.OPPOSITE_SIDE[V.side]):null}var X=[],oe=[],se=[],ie=a.opacity(P.paper_bgcolor)===1&&a.opacity(P.plot_bgcolor)===1&&P.paper_bgcolor===P.plot_bgcolor;for(B in P._plots)if(F=P._plots[B],F.mainplot)F.bg&&F.bg.remove(),F.bg=void 0;else{var N=F.xaxis.domain,U=F.yaxis.domain,q=F.plotgroup;if(_(N,U,se)){var Q=q.node(),W=F.bg=T.ensureSingle(q,"rect","bg");Q.insertBefore(W.node(),Q.childNodes[0]),oe.push(B)}else q.select("rect.bg").remove(),se.push([N,U]),ie||(X.push(B),oe.push(B))}var Z=P._bgLayer.selectAll(".bg").data(X);for(Z.enter().append("rect").classed("bg",!0),Z.exit().remove(),Z.each(function(Rt){P._plots[Rt].bg=w.select(this)}),R=0;R<oe.length;R++)F=P._plots[oe[R]],G=F.xaxis,J=F.yaxis,F.bg&&G._offset!==void 0&&J._offset!==void 0&&F.bg.call(n.setRect,G._offset-I,J._offset-I,G._length+2*I,J._length+2*I).call(a.fill,P.plot_bgcolor).style("stroke-width",0);if(!P._hasOnlyLargeSploms)for(B in P._plots){F=P._plots[B],G=F.xaxis,J=F.yaxis;var ee=F.clipId="clip"+P._uid+B+"plot",te=T.ensureSingleById(P._clips,"clipPath",ee,function(Rt){Rt.classed("plotclip",!0).append("rect")});F.clipRect=te.select("rect").attr({width:G._length,height:J._length}),n.setTranslate(F.plot,G._offset,J._offset);var ae,le;F._hasClipOnAxisFalse?(ae=null,le=ee):(ae=ee,le=null),n.setClipUrl(F.plot,ae,k),F.layerClipId=le}var ye,fe,pe,ge,Ae,we,De,Be,Ve,xe,Le,He,Je;function Oe(Rt){return"M"+ye+","+Rt+"H"+fe}function Pe(Rt){return"M"+G._offset+","+Rt+"h"+G._length}function Ue(Rt){return"M"+Rt+","+Be+"V"+De}function vt(Rt){return"M"+Rt+","+J._offset+"v"+J._length}function Lt(Rt,Bt,Mt){if(!Rt.showline||B!==Rt._mainSubplot)return"";if(!Rt._anchorAxis)return Mt(Rt._mainLinePosition);var Tt=Bt(Rt._mainLinePosition);return Rt.mirror&&(Tt+=Bt(Rt._mainMirrorPosition)),Tt}for(B in P._plots){F=P._plots[B],G=F.xaxis,J=F.yaxis;var Yt="M0,0";A(G,B)&&(Ae=v(G,"left",J,D),ye=G._offset-(Ae?I+Ae:0),we=v(G,"right",J,D),fe=G._offset+G._length+(we?I+we:0),pe=j(G,J,"bottom"),ge=j(G,J,"top"),Je=!G._anchorAxis||B!==G._mainSubplot,Je&&(G.mirror==="allticks"||G.mirror==="all")&&(G._linepositions[B]=[pe,ge]),Yt=Lt(G,Oe,Pe),Je&&G.showline&&(G.mirror==="all"||G.mirror==="allticks")&&(Yt+=Oe(pe)+Oe(ge)),F.xlines.style("stroke-width",G._lw+"px").call(a.stroke,G.showline?G.linecolor:"rgba(0,0,0,0)")),F.xlines.attr("d",Yt);var At="M0,0";A(J,B)&&(Le=v(J,"bottom",G,D),De=J._offset+J._length+(Le?I:0),He=v(J,"top",G,D),Be=J._offset-(He?I:0),Ve=j(J,G,"left"),xe=j(J,G,"right"),Je=!J._anchorAxis||B!==J._mainSubplot,Je&&(J.mirror==="allticks"||J.mirror==="all")&&(J._linepositions[B]=[Ve,xe]),At=Lt(J,Ue,vt),Je&&J.showline&&(J.mirror==="all"||J.mirror==="allticks")&&(At+=Ue(Ve)+Ue(xe)),F.ylines.style("stroke-width",J._lw+"px").call(a.stroke,J.showline?J.linecolor:"rgba(0,0,0,0)")),F.ylines.attr("d",At)}return f.makeClipPaths(k),M.previousPromises(k)}function A(k,P){return(k.ticks||k.showline)&&(P===k._mainSubplot||k.mirror==="all"||k.mirror==="allticks")}function x(k,P,z){if(!z.showline||!z._lw)return!1;if(z.mirror==="all"||z.mirror==="allticks")return!0;var I=z._anchorAxis;if(!I)return!1;var D=o.FROM_BL[P];return z.side===P?I.domain[D]===k.domain[D]:z.mirror&&I.domain[1-D]===k.domain[1-D]}function v(k,P,z,I){if(x(k,P,z))return z._lw;for(var D=0;D<I.length;D++){var R=I[D];if(R._mainAxis===z._mainAxis&&x(k,P,R))return R._lw}return 0}ne.drawMainTitle=function(k){var P=k._fullLayout,z=L(P),I=S(P);r.draw(k,"gtitle",{propContainer:P,propName:"title.text",placeholder:P._dfltTitle.plot,attributes:{x:b(P,z),y:l(P,I),"text-anchor":z,dy:I}})};function b(k,P){var z=k.title,I=k._size,D=0;switch(P===h?D=z.pad.l:P===u&&(D=-z.pad.r),z.xref){case"paper":return I.l+I.w*z.x+D;case"container":default:return k.width*z.x+D}}function l(k,P){var z=k.title,I=k._size,D=0;if(P==="0em"||!P?D=-z.pad.b:P===o.CAP_SHIFT+"em"&&(D=z.pad.t),z.y==="auto")return I.t/2;switch(z.yref){case"paper":return I.t+I.h-I.h*z.y+D;case"container":default:return k.height-k.height*z.y+D}}function L(k){var P=k.title,z=m;return T.isRightAnchor(P)?z=u:T.isLeftAnchor(P)&&(z=h),z}function S(k){var P=k.title,z="0em";return T.isTopAnchor(P)?z=o.CAP_SHIFT+"em":T.isMiddleAnchor(P)&&(z=o.MID_SHIFT+"em"),z}ne.doTraceStyle=function(k){var P=k.calcdata,z=[],I;for(I=0;I<P.length;I++){var D=P[I],R=D[0]||{},B=R.trace||{},F=B._module||{},V=F.arraysToCalcdata;V&&V(D,B);var G=F.editStyle;G&&z.push({fn:G,cd0:R})}if(z.length){for(I=0;I<z.length;I++){var J=z[I];J.fn(k,J.cd0)}e(k),ne.redrawReglTraces(k)}return M.style(k),c.getComponentMethod("legend","draw")(k),M.previousPromises(k)},ne.doColorBars=function(k){return c.getComponentMethod("colorbar","draw")(k),M.previousPromises(k)},ne.layoutReplot=function(k){var P=k.layout;return k.layout=void 0,c.call("_doPlot",k,"",P)},ne.doLegend=function(k){return c.getComponentMethod("legend","draw")(k),M.previousPromises(k)},ne.doTicksRelayout=function(k){return f.draw(k,"redraw"),k._fullLayout._hasOnlyLargeSploms&&(c.subplotsRegistry.splom.updateGrid(k),e(k),ne.redrawReglTraces(k)),ne.drawMainTitle(k),M.previousPromises(k)},ne.doModeBar=function(k){var P=k._fullLayout;t.manage(k);for(var z=0;z<P._basePlotModules.length;z++){var I=P._basePlotModules[z].updateFx;I&&I(k)}return M.previousPromises(k)},ne.doCamera=function(k){for(var P=k._fullLayout,z=P._subplots.gl3d,I=0;I<z.length;I++){var D=P[z[I]],R=D._scene;R.setViewport(D)}},ne.drawData=function(k){var P=k._fullLayout;e(k);for(var z=P._basePlotModules,I=0;I<z.length;I++)z[I].plot(k);return ne.redrawReglTraces(k),M.style(k),c.getComponentMethod("shapes","draw")(k),c.getComponentMethod("annotations","draw")(k),c.getComponentMethod("images","draw")(k),P._replotting=!1,M.previousPromises(k)},ne.redrawReglTraces=function(k){var P=k._fullLayout;if(P._has("regl")){var z=k._fullData,I=[],D=[],R,B;for(P._hasOnlyLargeSploms&&P._splomGrid.draw(),R=0;R<z.length;R++){var F=z[R];F.visible===!0&&F._length!==0&&(F.type==="splom"?P._splomScenes[F.uid].draw():F.type==="scattergl"?T.pushUnique(I,F.xaxis+F.yaxis):F.type==="scatterpolargl"&&T.pushUnique(D,F.subplot))}for(R=0;R<I.length;R++)B=P._plots[I[R]],B._scene&&B._scene.draw();for(R=0;R<D.length;R++)B=P[D[R]]._subplot,B._scene&&B._scene.draw()}},ne.doAutoRangeAndConstraints=function(k){for(var P=f.list(k,"",!0),z,I={},D=0;D<P.length;D++)if(z=P[D],!I[z._id]){I[z._id]=1,p(k,z),y(k,z);var R=z._matchGroup;if(R)for(var B in R){var F=f.getFromId(k,B);y(k,F,z.range),I[B]=1}}g(k)},ne.finalDraw=function(k){c.getComponentMethod("rangeslider","draw")(k),c.getComponentMethod("rangeselector","draw")(k)},ne.drawMarginPushers=function(k){c.getComponentMethod("legend","draw")(k),c.getComponentMethod("rangeselector","draw")(k),c.getComponentMethod("sliders","draw")(k),c.getComponentMethod("updatemenus","draw")(k),c.getComponentMethod("colorbar","draw")(k)}},{"../components/color":366,"../components/drawing":388,"../components/modebar":429,"../components/titles":464,"../constants/alignment":471,"../lib":503,"../lib/clear_gl_canvases":487,"../plots/cartesian/autorange":553,"../plots/cartesian/axes":554,"../plots/cartesian/constraints":562,"../plots/plots":619,"../registry":638,"@plotly/d3":58}],545:[function(d,re,ne){var w=d("../lib"),c=w.isPlainObject,M=d("./plot_schema"),T=d("../plots/plots"),e=d("../plots/attributes"),a=d("./plot_template"),n=d("./plot_config").dfltConfig;ne.makeTemplate=function(h){h=w.isPlainObject(h)?h:w.getGraphDiv(h),h=w.extendDeep({_context:n},{data:h.data,layout:h.layout}),T.supplyDefaults(h);var m=h.data||[],u=h.layout||{};u._basePlotModules=h._fullLayout._basePlotModules,u._modules=h._fullLayout._modules;var _={data:{},layout:{}};m.forEach(function(P){var z={};f(P,z,i.bind(null,P));var I=w.coerce(P,{},e,"type"),D=_.data[I];D||(D=_.data[I]=[]),D.push(z)}),f(u,_.layout,o.bind(null,u)),delete _.layout.template;var s=u.template;if(c(s)){var A=s.layout,x,v,b,l,L,S;c(A)&&r(A,_.layout);var k=s.data;if(c(k)){for(v in _.data)if(b=k[v],Array.isArray(b)){for(L=_.data[v],S=L.length,l=b.length,x=0;x<S;x++)r(b[x%l],L[x]);for(x=S;x<l;x++)L.push(w.extendDeep({},b[x]))}for(v in k)v in _.data||(_.data[v]=w.extendDeep([],k[v]))}}return _};function r(h,m){h=w.extendDeep({},h);var u=Object.keys(h).sort(),_,s;function A(L,S,k){if(c(S)&&c(L))r(L,S);else if(Array.isArray(S)&&Array.isArray(L)){var P=a.arrayTemplater({_template:h},k);for(s=0;s<S.length;s++){var z=S[s],I=P.newItem(z)._template;I&&r(I,z)}var D=P.defaultItems();for(s=0;s<D.length;s++)S.push(D[s]._template);for(s=0;s<S.length;s++)delete S[s].templateitemname}}for(_=0;_<u.length;_++){var x=u[_],v=h[x];if(x in m?A(v,m[x],x):m[x]=v,t(x)===x)for(var b in m){var l=t(b);b!==l&&l===x&&!(b in h)&&A(v,m[b],x)}}}function t(h){return h.replace(/[0-9]+$/,"")}function f(h,m,u,_,s){var A=s&&u(s);for(var x in h){var v=h[x],b=g(h,x,_),l=g(h,x,s),L=u(l);if(!L){var S=t(x);S!==x&&(l=g(h,S,s),L=u(l))}if(!(A&&A===L)&&!(!L||L._noTemplating||L.valType==="data_array"||L.arrayOk&&Array.isArray(v)))if(!L.valType&&c(v))f(v,m,u,b,l);else if(L._isLinkedToArray&&Array.isArray(v))for(var k=!1,P=0,z={},I=0;I<v.length;I++){var D=v[I];if(c(D)){var R=D.name;if(R)z[R]||(f(D,m,u,g(v,P,b),g(v,P,l)),P++,z[R]=1);else if(!k){var B=a.arrayDefaultKey(x),F=g(h,B,_),V=g(v,P,b);f(D,m,u,V,g(v,P,l));var G=w.nestedProperty(m,V),J=w.nestedProperty(m,F);J.set(G.get()),G.set(null),k=!0}}}else{var j=w.nestedProperty(m,b);j.set(v)}}}function o(h,m){return M.getLayoutValObject(h,w.nestedProperty({},m).parts)}function i(h,m){return M.getTraceValObject(h,w.nestedProperty({},m).parts)}function g(h,m,u){var _;return u?Array.isArray(h)?_=u+"["+m+"]":_=u+"."+m:_=m,_}ne.validateTemplate=function(h,m){var u=w.extendDeep({},{_context:n,data:h.data,layout:h.layout}),_=u.layout||{};c(m)||(m=_.template||{});var s=m.layout,A=m.data,x=[];u.layout=_,u.layout.template=m,T.supplyDefaults(u);var v=u._fullLayout,b=u._fullData,l={};function L(F,V){for(var G in F)if(G.charAt(0)!=="_"&&c(F[G])){var J=t(G),j=[],Y;for(Y=0;Y<V.length;Y++)j.push(g(F,G,V[Y])),J!==G&&j.push(g(F,J,V[Y]));for(Y=0;Y<j.length;Y++)l[j[Y]]=1;L(F[G],j)}}function S(F,V){for(var G in F)if(G.indexOf("defaults")===-1&&c(F[G])){var J=g(F,G,V);l[J]?S(F[G],J):x.push({code:"unused",path:J})}}if(c(s)?(L(v,["layout"]),S(s,"layout")):x.push({code:"layout"}),!c(A))x.push({code:"data"});else{for(var k={},P,z=0;z<b.length;z++){var I=b[z];P=I.type,k[P]=(k[P]||0)+1,I._fullInput._template||x.push({code:"missing",index:I._fullInput.index,traceType:P})}for(P in A){var D=A[P].length,R=k[P]||0;D>R?x.push({code:"unused",traceType:P,templateCount:D,dataCount:R}):R>D&&x.push({code:"reused",traceType:P,templateCount:D,dataCount:R})}}function B(F,V){for(var G in F)if(G.charAt(0)!=="_"){var J=F[G],j=g(F,G,V);c(J)?(Array.isArray(F)&&J._template===!1&&J.templateitemname&&x.push({code:"missing",path:j,templateitemname:J.templateitemname}),B(J,j)):Array.isArray(J)&&p(J)&&B(J,j)}}if(B({data:b,layout:v},""),x.length)return x.map(y)};function p(h){for(var m=0;m<h.length;m++)if(c(h[m]))return!0}function y(h){var m;switch(h.code){case"data":m="The template has no key data.";break;case"layout":m="The template has no key layout.";break;case"missing":h.path?m="There are no templates for item "+h.path+" with name "+h.templateitemname:m="There are no templates for trace "+h.index+", of type "+h.traceType+".";break;case"unused":h.path?m="The template item at "+h.path+" was not used in constructing the plot.":h.dataCount?m="Some of the templates of type "+h.traceType+" were not used. The template has "+h.templateCount+" traces, the data only has "+h.dataCount+" of this type.":m="The template has "+h.templateCount+" traces of type "+h.traceType+" but there are none in the data.";break;case"reused":m="Some of the templates of type "+h.traceType+" were used more than once. The template has "+h.templateCount+" traces, the data has "+h.dataCount+" of this type.";break}return h.msg=m,h}},{"../lib":503,"../plots/attributes":550,"../plots/plots":619,"./plot_config":541,"./plot_schema":542,"./plot_template":543}],546:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("./plot_api"),M=d("../plots/plots"),T=d("../lib"),e=d("../snapshot/helpers"),a=d("../snapshot/tosvg"),n=d("../snapshot/svgtoimg"),r=d("../version").version,t={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};function f(o,i){i=i||{};var g,p,y,h;T.isPlainObject(o)?(g=o.data||[],p=o.layout||{},y=o.config||{},h={}):(o=T.getGraphDiv(o),g=T.extendDeep([],o.data),p=T.extendDeep({},o.layout),y=o._context,h=o._fullLayout||{});function m(R){return!(R in i)||T.validate(i[R],t[R])}if(!m("width")&&i.width!==null||!m("height")&&i.height!==null)throw new Error("Height and width should be pixel values.");if(!m("format"))throw new Error("Export format is not "+T.join2(t.format.values,", "," or ")+".");var u={};function _(R,B){return T.coerce(i,u,t,R,B)}var s=_("format"),A=_("width"),x=_("height"),v=_("scale"),b=_("setBackground"),l=_("imageDataOnly"),L=document.createElement("div");L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);var S=T.extendFlat({},p);A?S.width=A:i.width===null&&w(h.width)&&(S.width=h.width),x?S.height=x:i.height===null&&w(h.height)&&(S.height=h.height);var k=T.extendFlat({},y,{_exportedPlot:!0,staticPlot:!0,setBackground:b}),P=e.getRedrawFunc(L);function z(){return new Promise(function(R){setTimeout(R,e.getDelay(L._fullLayout))})}function I(){return new Promise(function(R,B){var F=a(L,s,v),V=L._fullLayout.width,G=L._fullLayout.height;function J(){c.purge(L),document.body.removeChild(L)}if(s==="full-json"){var j=M.graphJson(L,!1,"keepdata","object",!0,!0);return j.version=r,j=JSON.stringify(j),J(),R(l?j:e.encodeJSON(j))}if(J(),s==="svg")return R(l?F:e.encodeSVG(F));var Y=document.createElement("canvas");Y.id=T.randstr(),n({format:s,width:V,height:G,scale:v,canvas:Y,svg:F,promise:!0}).then(R).catch(B)})}function D(R){return l?R.replace(e.IMAGE_URL_PREFIX,""):R}return new Promise(function(R,B){c.newPlot(L,g,S,k).then(P).then(z).then(I).then(function(F){R(D(F))}).catch(function(F){B(F)})})}re.exports=f},{"../lib":503,"../plots/plots":619,"../snapshot/helpers":642,"../snapshot/svgtoimg":644,"../snapshot/tosvg":646,"../version":1123,"./plot_api":540,"fast-isnumeric":190}],547:[function(d,re,ne){var w=d("../lib"),c=d("../plots/plots"),M=d("./plot_schema"),T=d("./plot_config").dfltConfig,e=w.isPlainObject,a=Array.isArray,n=w.isArrayOrTypedArray;re.exports=function(_,s){_===void 0&&(_=[]),s===void 0&&(s={});var A=M.get(),x=[],v={_context:w.extendFlat({},T)},b,l;a(_)?(v.data=w.extendDeep([],_),b=_):(v.data=[],b=[],x.push(i("array","data"))),e(s)?(v.layout=w.extendDeep({},s),l=s):(v.layout={},l={},arguments.length>1&&x.push(i("object","layout"))),c.supplyDefaults(v);for(var L=v._fullData,S=b.length,k=0;k<S;k++){var P=b[k],z=["data",k];if(!e(P)){x.push(i("object",z));continue}var I=L[k],D=I.type,R=A.traces[D].attributes;R.type={valType:"enumerated",values:[D]},I.visible===!1&&P.visible!==!1&&x.push(i("invisible",z)),r(P,I,R,x,z);var B=P.transforms,F=I.transforms;if(B){a(B)||x.push(i("array",z,["transforms"])),z.push("transforms");for(var V=0;V<B.length;V++){var G=["transforms",V],J=B[V].type;if(!e(B[V])){x.push(i("object",z,G));continue}var j=A.transforms[J]?A.transforms[J].attributes:{};j.type={valType:"enumerated",values:Object.keys(A.transforms)},r(B[V],F[V],j,x,z,G)}}}var Y=v._fullLayout,X=t(A,L);return r(l,Y,X,x,"layout"),x.length===0?void 0:x};function r(u,_,s,A,x,v){v=v||[];for(var b=Object.keys(u),l=0;l<b.length;l++){var L=b[l];if(L!=="transforms"){var S=v.slice();S.push(L);var k=u[L],P=_[L],z=p(s,L),I=(z||{}).valType,D=I==="info_array",R=I==="colorscale",B=(z||{}).items;if(!g(s,L))A.push(i("schema",x,S));else if(e(k)&&e(P)&&I!=="any")r(k,P,z,A,x,S);else if(D&&a(k)){k.length>P.length&&A.push(i("unused",x,S.concat(P.length)));var F=P.length,V=Array.isArray(B);V&&(F=Math.min(F,B.length));var G,J,j,Y,X;if(z.dimensions===2)for(J=0;J<F;J++)if(a(k[J])){k[J].length>P[J].length&&A.push(i("unused",x,S.concat(J,P[J].length)));var oe=P[J].length;for(G=0;G<(V?Math.min(oe,B[J].length):oe);G++)j=V?B[J][G]:B,Y=k[J][G],X=P[J][G],w.validate(Y,j)?X!==Y&&X!==+Y&&A.push(i("dynamic",x,S.concat(J,G),Y,X)):A.push(i("value",x,S.concat(J,G),Y))}else A.push(i("array",x,S.concat(J),k[J]));else for(J=0;J<F;J++)j=V?B[J]:B,Y=k[J],X=P[J],w.validate(Y,j)?X!==Y&&X!==+Y&&A.push(i("dynamic",x,S.concat(J),Y,X)):A.push(i("value",x,S.concat(J),Y))}else if(z.items&&!D&&a(k)){var se=B[Object.keys(B)[0]],ie=[],N,U;for(N=0;N<P.length;N++){var q=P[N]._index||N;if(U=S.slice(),U.push(q),e(k[q])&&e(P[N])){ie.push(q);var Q=k[q],W=P[N];e(Q)&&Q.visible!==!1&&W.visible===!1?A.push(i("invisible",x,U)):r(Q,W,se,A,x,U)}}for(N=0;N<k.length;N++)U=S.slice(),U.push(N),e(k[N])?ie.indexOf(N)===-1&&A.push(i("unused",x,U)):A.push(i("object",x,U,k[N]))}else!e(k)&&e(P)?A.push(i("object",x,S,k)):!n(k)&&n(P)&&!D&&!R?A.push(i("array",x,S,k)):L in _?w.validate(k,z)?z.valType==="enumerated"&&(z.coerceNumber&&k!==+P||k!==P)&&A.push(i("dynamic",x,S,k,P)):A.push(i("value",x,S,k)):A.push(i("unused",x,S,k))}}return A}function t(u,_){for(var s=u.layout.layoutAttributes,A=0;A<_.length;A++){var x=_[A],v=u.traces[x.type],b=v.layoutAttributes;b&&(x.subplot?w.extendFlat(s[v.attributes.subplot.dflt],b):w.extendFlat(s,b))}return s}var f={object:function(u,_){var s;return u==="layout"&&_===""?s="The layout argument":u[0]==="data"&&_===""?s="Trace "+u[1]+" in the data argument":s=o(u)+"key "+_,s+" must be linked to an object container"},array:function(u,_){var s;return u==="data"?s="The data argument":s=o(u)+"key "+_,s+" must be linked to an array container"},schema:function(u,_){return o(u)+"key "+_+" is not part of the schema"},unused:function(u,_,s){var A=e(s)?"container":"key";return o(u)+A+" "+_+" did not get coerced"},dynamic:function(u,_,s,A){return[o(u)+"key",_,"(set to '"+s+"')","got reset to","'"+A+"'","during defaults."].join(" ")},invisible:function(u,_){return(_?o(u)+"item "+_:"Trace "+u[1])+" got defaulted to be not visible"},value:function(u,_,s){return[o(u)+"key "+_,"is set to an invalid value ("+s+")"].join(" ")}};function o(u){return a(u)?"In data trace "+u[1]+", ":"In "+u+", "}function i(u,_,s,A,x){s=s||"";var v,b;a(_)?(v=_[0],b=_[1]):(v=_,b=null);var l=m(s),L=f[u](_,l,A,x);return w.log(L),{code:u,container:v,trace:b,path:s,astr:l,msg:L}}function g(u,_){var s=h(_),A=s.keyMinusId,x=s.id;return A in u&&u[A]._isSubplotObj&&x?!0:_ in u}function p(u,_){if(_ in u)return u[_];var s=h(_);return u[s.keyMinusId]}var y=w.counterRegex("([a-z]+)");function h(u){var _=u.match(y);return{keyMinusId:_&&_[1],id:_&&_[2]}}function m(u){if(!a(u))return String(u);for(var _="",s=0;s<u.length;s++){var A=u[s];typeof A=="number"?_=_.substr(0,_.length-1)+"["+A+"]":_+=A,s<u.length-1&&(_+=".")}return _}},{"../lib":503,"../plots/plots":619,"./plot_config":541,"./plot_schema":542}],548:[function(d,re,ne){re.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],549:[function(d,re,ne){var w=d("../lib"),c=d("../plot_api/plot_template");re.exports=function(T,e,a){var n=a.name,r=a.inclusionAttr||"visible",t=e[n],f=w.isArrayOrTypedArray(T[n])?T[n]:[],o=e[n]=[],i=c.arrayTemplater(e,n,r),g,p;for(g=0;g<f.length;g++){var y=f[g];w.isPlainObject(y)?p=i.newItem(y):(p=i.newItem({}),p[r]=!1),p._index=g,p[r]!==!1&&a.handleItemDefaults(y,p,e,a),o.push(p)}var h=i.defaultItems();for(g=0;g<h.length;g++)p=h[g],p._index=o.length,a.handleItemDefaults({},p,e,a,{}),o.push(p);if(w.isArrayOrTypedArray(t)){var m=Math.min(t.length,o.length);for(g=0;g<m;g++)w.relinkPrivateKeys(o[g],t[g])}return o}},{"../lib":503,"../plot_api/plot_template":543}],550:[function(d,re,ne){var w=d("./font_attributes"),c=d("../components/fx/attributes");re.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:w({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:c.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":397,"./font_attributes":585}],551:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=c.dateTime2ms,T=c.incrementMonth,e=d("../../constants/numerical"),a=e.ONEAVGMONTH;re.exports=function(r,t,f,o){if(t.type!=="date")return{vals:o};var i=r[f+"periodalignment"];if(!i)return{vals:o};var g=r[f+"period"],p;if(w(g)){if(g=+g,g<=0)return{vals:o}}else if(typeof g=="string"&&g.charAt(0)==="M"){var y=+g.substring(1);if(y>0&&Math.round(y)===y)p=y;else return{vals:o}}for(var h=t.calendar,m=i==="start",u=i==="end",_=r[f+"period0"],s=M(_,h)||0,A=[],x=[],v=[],b=o.length,l=0;l<b;l++){var L=o[l],S,k,P;if(p){for(S=Math.round((L-s)/(p*a)),P=T(s,p*S,h);P>L;)P=T(P,-p,h);for(;P<=L;)P=T(P,p,h);k=T(P,-p,h)}else{for(S=Math.round((L-s)/g),P=s+S*g;P>L;)P-=g;for(;P<=L;)P+=g;k=P-g}A[l]=m?k:u?P:(k+P)/2,x[l]=k,v[l]=P}return{vals:A,starts:x,ends:v}}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],552:[function(d,re,ne){re.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],553:[function(d,re,ne){var w=d("@plotly/d3"),c=d("fast-isnumeric"),M=d("../../lib"),T=d("../../constants/numerical").FP_SAFE,e=d("../../registry"),a=d("../../components/drawing"),n=d("./axis_ids"),r=n.getFromId,t=n.isLinked;re.exports={getAutoRange:f,makePadFn:i,doAutoRange:h,findExtremes:m,concatExtremes:y};function f(b,l){var L,S,k=[],P=b._fullLayout,z=i(P,l,0),I=i(P,l,1),D=y(b,l),R=D.min,B=D.max;if(R.length===0||B.length===0)return M.simpleMap(l.range,l.r2l);var F=R[0].val,V=B[0].val;for(L=1;L<R.length&&F===V;L++)F=Math.min(F,R[L].val);for(L=1;L<B.length&&F===V;L++)V=Math.max(V,B[L].val);var G=!1;if(l.range){var J=M.simpleMap(l.range,l.r2l);G=J[1]<J[0]}l.autorange==="reversed"&&(G=!0,l.autorange=!0);var j=l.rangemode,Y=j==="tozero",X=j==="nonnegative",oe=l._length,se=oe/10,ie=0,N,U,q,Q,W,Z;for(L=0;L<R.length;L++)for(N=R[L],S=0;S<B.length;S++)U=B[S],Z=U.val-N.val-o(l,N.val,U.val),Z>0&&(W=oe-z(N)-I(U),W>se?Z/W>ie&&(q=N,Q=U,ie=Z/W):Z/oe>ie&&(q={val:N.val,nopad:1},Q={val:U.val,nopad:1},ie=Z/oe));function ee(fe,pe){return Math.max(fe,I(pe))}if(F===V){var te=F-1,ae=F+1;if(Y)if(F===0)k=[0,1];else{var le=(F>0?B:R).reduce(ee,0),ye=F/(1-Math.min(.5,le/oe));k=F>0?[0,ye]:[ye,0]}else X?k=[Math.max(0,te),Math.max(1,ae)]:k=[te,ae]}else Y?(q.val>=0&&(q={val:0,nopad:1}),Q.val<=0&&(Q={val:0,nopad:1})):X&&(q.val-ie*z(q)<0&&(q={val:0,nopad:1}),Q.val<=0&&(Q={val:1,nopad:1})),ie=(Q.val-q.val-o(l,N.val,U.val))/(oe-z(q)-I(Q)),k=[q.val-ie*z(q),Q.val+ie*I(Q)];return G&&k.reverse(),M.simpleMap(k,l.l2r||Number)}function o(b,l,L){var S=0;if(b.rangebreaks)for(var k=b.locateBreaks(l,L),P=0;P<k.length;P++){var z=k[P];S+=z.max-z.min}return S}function i(b,l,L){var S=.05*l._length,k=l._anchorAxis||{};if((l.ticklabelposition||"").indexOf("inside")!==-1||(k.ticklabelposition||"").indexOf("inside")!==-1){var P=l.autorange==="reversed";if(!P){var z=M.simpleMap(l.range,l.r2l);P=z[1]<z[0]}P&&(L=!L)}var I=0;return t(b,l._id)||(I=p(b,l,L)),S=Math.max(I,S),l.constrain==="domain"&&l._inputDomain&&(S*=(l._inputDomain[1]-l._inputDomain[0])/(l.domain[1]-l.domain[0])),function(R){return R.nopad?0:R.pad+(R.extrapad?S:I)}}var g=3;function p(b,l,L){var S=0,k=l._id.charAt(0)==="x";for(var P in b._plots){var z=b._plots[P];if(!(l._id!==z.xaxis._id&&l._id!==z.yaxis._id)){var I=(k?z.yaxis:z.xaxis)||{};if((I.ticklabelposition||"").indexOf("inside")!==-1&&(!L&&(I.side==="left"||I.side==="bottom")||L&&(I.side==="top"||I.side==="right"))){if(I._vals){var D=M.deg2rad(I._tickAngles[I._id+"tick"]||0),R=Math.abs(Math.cos(D)),B=Math.abs(Math.sin(D));if(!I._vals[0].bb){var F=I._id+"tick",V=I._selections[F];V.each(function(oe){var se=w.select(this),ie=se.select(".text-math-group");ie.empty()&&(oe.bb=a.bBox(se.node()))})}for(var G=0;G<I._vals.length;G++){var J=I._vals[G],j=J.bb;if(j){var Y=2*g+j.width,X=2*g+j.height;S=Math.max(S,k?Math.max(Y*R,X*B):Math.max(X*R,Y*B))}}}I.ticks==="inside"&&I.ticklabelposition==="inside"&&(S+=I.ticklen||0)}}}return S}function y(b,l,L){var S=l._id,k=b._fullData,P=b._fullLayout,z=[],I=[],D,R,B;function F(Y,X){for(D=0;D<X.length;D++){var oe=Y[X[D]],se=(oe._extremes||{})[S];if(oe.visible===!0&&se){for(R=0;R<se.min.length;R++)B=se.min[R],u(z,B.val,B.pad,{extrapad:B.extrapad});for(R=0;R<se.max.length;R++)B=se.max[R],_(I,B.val,B.pad,{extrapad:B.extrapad})}}}if(F(k,l._traceIndices),F(P.annotations||[],l._annIndices||[]),F(P.shapes||[],l._shapeIndices||[]),l._matchGroup&&!L){for(var V in l._matchGroup)if(V!==l._id){var G=r(b,V),J=y(b,G,!0),j=l._length/G._length;for(R=0;R<J.min.length;R++)B=J.min[R],u(z,B.val,B.pad*j,{extrapad:B.extrapad});for(R=0;R<J.max.length;R++)B=J.max[R],_(I,B.val,B.pad*j,{extrapad:B.extrapad})}}return{min:z,max:I}}function h(b,l,L){if(l.setScale(),l.autorange){l.range=L?L.slice():f(b,l),l._r=l.range.slice(),l._rl=M.simpleMap(l._r,l.r2l);var S=l._input,k={};k[l._attr+".range"]=l.range,k[l._attr+".autorange"]=l.autorange,e.call("_storeDirectGUIEdit",b.layout,b._fullLayout._preGUI,k),S.range=l.range.slice(),S.autorange=l.autorange}var P=l._anchorAxis;if(P&&P.rangeslider){var z=P.rangeslider[l._name];z&&z.rangemode==="auto"&&(z.range=f(b,l)),P._input.rangeslider[l._name]=M.extendFlat({},z)}}function m(b,l,L){L||(L={}),b._m||b.setScale();var S=[],k=[],P=l.length,z=L.padded||!1,I=L.tozero&&(b.type==="linear"||b.type==="-"),D=b.type==="log",R=!1,B=L.vpadLinearized||!1,F,V,G,J,j,Y,X,oe,se;function ie(te){if(Array.isArray(te))return R=!0,function(le){return Math.max(Number(te[le]||0),0)};var ae=Math.max(Number(te||0),0);return function(){return ae}}var N=ie((b._m>0?L.ppadplus:L.ppadminus)||L.ppad||0),U=ie((b._m>0?L.ppadminus:L.ppadplus)||L.ppad||0),q=ie(L.vpadplus||L.vpad),Q=ie(L.vpadminus||L.vpad);if(!R){if(oe=1/0,se=-1/0,D)for(F=0;F<P;F++)V=l[F],V<oe&&V>0&&(oe=V),V>se&&V<T&&(se=V);else for(F=0;F<P;F++)V=l[F],V<oe&&V>-T&&(oe=V),V>se&&V<T&&(se=V);l=[oe,se],P=2}var W={tozero:I,extrapad:z};function Z(te){G=l[te],c(G)&&(Y=N(te),X=U(te),B?(J=b.c2l(G)-Q(te),j=b.c2l(G)+q(te)):(oe=G-Q(te),se=G+q(te),D&&oe<se/10&&(oe=se/10),J=b.c2l(oe),j=b.c2l(se)),I&&(J=Math.min(0,J),j=Math.max(0,j)),A(J)&&u(S,J,X,W),A(j)&&_(k,j,Y,W))}var ee=Math.min(6,P);for(F=0;F<ee;F++)Z(F);for(F=P-1;F>=ee;F--)Z(F);return{min:S,max:k,opts:L}}function u(b,l,L,S){s(b,l,L,S,x)}function _(b,l,L,S){s(b,l,L,S,v)}function s(b,l,L,S,k){for(var P=S.tozero,z=S.extrapad,I=!0,D=0;D<b.length&&I;D++){var R=b[D];if(k(R.val,l)&&R.pad>=L&&(R.extrapad||!z)){I=!1;break}else k(l,R.val)&&R.pad<=L&&(z||!R.extrapad)&&(b.splice(D,1),D--)}if(I){var B=P&&l===0;b.push({val:l,pad:B?0:L,extrapad:B?!1:z})}}function A(b){return c(b)&&Math.abs(b)<T}function x(b,l){return b<=l}function v(b,l){return b>=l}},{"../../components/drawing":388,"../../constants/numerical":479,"../../lib":503,"../../registry":638,"./axis_ids":558,"@plotly/d3":58,"fast-isnumeric":190}],554:[function(d,re,ne){var w=d("@plotly/d3"),c=d("fast-isnumeric"),M=d("../../plots/plots"),T=d("../../registry"),e=d("../../lib"),a=e.strTranslate,n=d("../../lib/svg_text_utils"),r=d("../../components/titles"),t=d("../../components/color"),f=d("../../components/drawing"),o=d("./layout_attributes"),i=d("./clean_ticks"),g=d("../../constants/numerical"),p=g.ONEMAXYEAR,y=g.ONEAVGYEAR,h=g.ONEMINYEAR,m=g.ONEMAXQUARTER,u=g.ONEAVGQUARTER,_=g.ONEMINQUARTER,s=g.ONEMAXMONTH,A=g.ONEAVGMONTH,x=g.ONEMINMONTH,v=g.ONEWEEK,b=g.ONEDAY,l=b/2,L=g.ONEHOUR,S=g.ONEMIN,k=g.ONESEC,P=g.MINUS_SIGN,z=g.BADNUM,I={K:"zeroline"},D={K:"gridline",L:"path"},R={K:"tick",L:"path"},B={K:"tick",L:"text"},F=d("../../constants/alignment"),V=F.MID_SHIFT,G=F.CAP_SHIFT,J=F.LINE_SPACING,j=F.OPPOSITE_SIDE,Y=3,X=re.exports={};X.setConvert=d("./set_convert");var oe=d("./axis_autotype"),se=d("./axis_ids"),ie=se.idSort,N=se.isLinked;X.id2name=se.id2name,X.name2id=se.name2id,X.cleanId=se.cleanId,X.list=se.list,X.listIds=se.listIds,X.getFromId=se.getFromId,X.getFromTrace=se.getFromTrace;var U=d("./autorange");X.getAutoRange=U.getAutoRange,X.findExtremes=U.findExtremes;var q=1e-4;function Q(_e){var Me=(_e[1]-_e[0])*q;return[_e[0]-Me,_e[1]+Me]}X.coerceRef=function(_e,Me,Ne,We,Qe,rt){var $e=We.charAt(We.length-1),ht=Ne._fullLayout._subplots[$e+"axis"],xt=We+"ref",kt={};return Qe||(Qe=ht[0]||(typeof rt=="string"?rt:rt[0])),rt||(rt=Qe),ht=ht.concat(ht.map(function(Wt){return Wt+" domain"})),kt[xt]={valType:"enumerated",values:ht.concat(rt?typeof rt=="string"?[rt]:rt:[]),dflt:Qe},e.coerce(_e,Me,kt,xt)},X.getRefType=function(_e){return _e===void 0?_e:_e==="paper"?"paper":_e==="pixel"?"pixel":/( domain)$/.test(_e)?"domain":"range"},X.coercePosition=function(_e,Me,Ne,We,Qe,rt){var $e,ht,xt=X.getRefType(We);if(xt!=="range")$e=e.ensureNumber,ht=Ne(Qe,rt);else{var kt=X.getFromId(Me,We);rt=kt.fraction2r(rt),ht=Ne(Qe,rt),$e=kt.cleanPos}_e[Qe]=$e(ht)},X.cleanPosition=function(_e,Me,Ne){var We=Ne==="paper"||Ne==="pixel"?e.ensureNumber:X.getFromId(Me,Ne).cleanPos;return We(_e)},X.redrawComponents=function(_e,Me){Me=Me||X.listIds(_e);var Ne=_e._fullLayout;function We(Qe,rt,$e,ht){for(var xt=T.getComponentMethod(Qe,rt),kt={},Wt=0;Wt<Me.length;Wt++)for(var Ft=Ne[X.id2name(Me[Wt])],ir=Ft[$e],hr=0;hr<ir.length;hr++){var _r=ir[hr];if(!kt[_r]&&(xt(_e,_r),kt[_r]=1,ht))return}}We("annotations","drawOne","_annIndices"),We("shapes","drawOne","_shapeIndices"),We("images","draw","_imgIndices",!0)};var W=X.getDataConversions=function(_e,Me,Ne,We){var Qe,rt=Ne==="x"||Ne==="y"||Ne==="z"?Ne:We;if(Array.isArray(rt)){if(Qe={type:oe(We,void 0,{autotypenumbers:_e._fullLayout.autotypenumbers}),_categories:[]},X.setConvert(Qe),Qe.type==="category")for(var $e=0;$e<We.length;$e++)Qe.d2c(We[$e])}else Qe=X.getFromTrace(_e,Me,rt);return Qe?{d2c:Qe.d2c,c2d:Qe.c2d}:rt==="ids"?{d2c:ee,c2d:ee}:{d2c:Z,c2d:Z}};function Z(_e){return+_e}function ee(_e){return String(_e)}X.getDataToCoordFunc=function(_e,Me,Ne,We){return W(_e,Me,Ne,We).d2c},X.counterLetter=function(_e){var Me=_e.charAt(0);if(Me==="x")return"y";if(Me==="y")return"x"},X.minDtick=function(_e,Me,Ne,We){["log","category","multicategory"].indexOf(_e.type)!==-1||!We?_e._minDtick=0:_e._minDtick===void 0?(_e._minDtick=Me,_e._forceTick0=Ne):_e._minDtick&&((_e._minDtick/Me+1e-6)%1<2e-6&&((Ne-_e._forceTick0)/Me%1+1.000001)%1<2e-6?(_e._minDtick=Me,_e._forceTick0=Ne):((Me/_e._minDtick+1e-6)%1>2e-6||((Ne-_e._forceTick0)/_e._minDtick%1+1.000001)%1>2e-6)&&(_e._minDtick=0))},X.saveRangeInitial=function(_e,Me){for(var Ne=X.list(_e,"",!0),We=!1,Qe=0;Qe<Ne.length;Qe++){var rt=Ne[Qe],$e=rt._rangeInitial===void 0,ht=$e||!(rt.range[0]===rt._rangeInitial[0]&&rt.range[1]===rt._rangeInitial[1]);($e&&rt.autorange===!1||Me&&ht)&&(rt._rangeInitial=rt.range.slice(),We=!0)}return We},X.saveShowSpikeInitial=function(_e,Me){for(var Ne=X.list(_e,"",!0),We=!1,Qe="on",rt=0;rt<Ne.length;rt++){var $e=Ne[rt],ht=$e._showSpikeInitial===void 0,xt=ht||$e.showspikes!==$e._showspikes;(ht||Me&&xt)&&($e._showSpikeInitial=$e.showspikes,We=!0),Qe==="on"&&!$e.showspikes&&(Qe="off")}return _e._fullLayout._cartesianSpikesEnabled=Qe,We},X.autoBin=function(_e,Me,Ne,We,Qe,rt){var $e=e.aggNums(Math.min,null,_e),ht=e.aggNums(Math.max,null,_e);if(Me.type==="category"||Me.type==="multicategory")return{start:$e-.5,end:ht+.5,size:Math.max(1,Math.round(rt)||1),_dataSpan:ht-$e};Qe||(Qe=Me.calendar);var xt;if(Me.type==="log"?xt={type:"linear",range:[$e,ht]}:xt={type:Me.type,range:e.simpleMap([$e,ht],Me.c2r,0,Qe),calendar:Qe},X.setConvert(xt),rt=rt&&i.dtick(rt,xt.type),rt)xt.dtick=rt,xt.tick0=i.tick0(void 0,xt.type,Qe);else{var kt;if(Ne)kt=(ht-$e)/Ne;else{var Wt=e.distinctVals(_e),Ft=Math.pow(10,Math.floor(Math.log(Wt.minDiff)/Math.LN10)),ir=Ft*e.roundUp(Wt.minDiff/Ft,[.9,1.9,4.9,9.9],!0);kt=Math.max(ir,2*e.stdev(_e)/Math.pow(_e.length,We?.25:.4)),c(kt)||(kt=1)}X.autoTicks(xt,kt)}var hr=xt.dtick,_r=X.tickIncrement(X.tickFirst(xt),hr,"reverse",Qe),an,Rr;if(typeof hr=="number")_r=te(_r,_e,xt,$e,ht),Rr=1+Math.floor((ht-_r)/hr),an=_r+Rr*hr;else for(xt.dtick.charAt(0)==="M"&&(_r=ae(_r,_e,hr,$e,Qe)),an=_r,Rr=0;an<=ht;)an=X.tickIncrement(an,hr,!1,Qe),Rr++;return{start:Me.c2r(_r,0,Qe),end:Me.c2r(an,0,Qe),size:hr,_dataSpan:ht-$e}};function te(_e,Me,Ne,We,Qe){var rt=0,$e=0,ht=0,xt=0;function kt(hr){return(1+(hr-_e)*100/Ne.dtick)%100<2}for(var Wt=0;Wt<Me.length;Wt++)Me[Wt]%1===0?ht++:c(Me[Wt])||xt++,kt(Me[Wt])&&rt++,kt(Me[Wt]+Ne.dtick/2)&&$e++;var Ft=Me.length-xt;if(ht===Ft&&Ne.type!=="date")Ne.dtick<1?_e=We-.5*Ne.dtick:(_e-=.5,_e+Ne.dtick<We&&(_e+=Ne.dtick));else if($e<Ft*.1&&(rt>Ft*.3||kt(We)||kt(Qe))){var ir=Ne.dtick/2;_e+=_e+ir<We?ir:-ir}return _e}function ae(_e,Me,Ne,We,Qe){var rt=e.findExactDates(Me,Qe),$e=.8;if(rt.exactDays>$e){var ht=Number(Ne.substr(1));rt.exactYears>$e&&ht%12===0?_e=X.tickIncrement(_e,"M6","reverse")+b*1.5:rt.exactMonths>$e?_e=X.tickIncrement(_e,"M1","reverse")+b*15.5:_e-=l;var xt=X.tickIncrement(_e,Ne);if(xt<=We)return xt}return _e}X.prepTicks=function(_e,Me){var Ne=e.simpleMap(_e.range,_e.r2l,void 0,void 0,Me);if(_e._dtickInit=_e.dtick,_e._tick0Init=_e.tick0,_e.tickmode==="auto"||!_e.dtick){var We=_e.nticks,Qe;We||(_e.type==="category"||_e.type==="multicategory"?(Qe=_e.tickfont?e.bigFont(_e.tickfont.size||12):15,We=_e._length/Qe):(Qe=_e._id.charAt(0)==="y"?40:80,We=e.constrain(_e._length/Qe,4,9)+1),_e._name==="radialaxis"&&(We*=2)),_e.tickmode==="array"&&(We*=100),_e._roughDTick=Math.abs(Ne[1]-Ne[0])/We,X.autoTicks(_e,_e._roughDTick),_e._minDtick>0&&_e.dtick<_e._minDtick*2&&(_e.dtick=_e._minDtick,_e.tick0=_e.l2r(_e._forceTick0))}_e.ticklabelmode==="period"&&ye(_e),_e.tick0||(_e.tick0=_e.type==="date"?"2000-01-01":0),_e.type==="date"&&_e.dtick<.1&&(_e.dtick=.1),He(_e)};function le(_e){return+_e.substring(1)}function ye(_e){var Me;function Ne(){return!(c(_e.dtick)||_e.dtick.charAt(0)!=="M")}var We=Ne(),Qe=X.getTickFormat(_e);if(Qe){var rt=_e._dtickInit!==_e.dtick;/%[fLQsSMX]/.test(Qe)||(/%[HI]/.test(Qe)?(Me=L,rt&&!We&&_e.dtick<L&&(_e.dtick=L)):/%p/.test(Qe)?(Me=l,rt&&!We&&_e.dtick<l&&(_e.dtick=l)):/%[Aadejuwx]/.test(Qe)?(Me=b,rt&&!We&&_e.dtick<b&&(_e.dtick=b)):/%[UVW]/.test(Qe)?(Me=v,rt&&!We&&_e.dtick<v&&(_e.dtick=v)):/%[Bbm]/.test(Qe)?(Me=A,rt&&(We?le(_e.dtick)<1:_e.dtick<x)&&(_e.dtick="M1")):/%[q]/.test(Qe)?(Me=u,rt&&(We?le(_e.dtick)<3:_e.dtick<_)&&(_e.dtick="M3")):/%[Yy]/.test(Qe)&&(Me=y,rt&&(We?le(_e.dtick)<12:_e.dtick<h)&&(_e.dtick="M12")))}We=Ne(),We&&_e.tick0===_e._dowTick0&&(_e.tick0=_e._rawTick0),_e._definedDelta=Me}function fe(_e,Me,Ne){for(var We=0;We<_e.length;We++){var Qe=_e[We].value,rt=We,$e=We+1;We<_e.length-1?(rt=We,$e=We+1):We>0?(rt=We-1,$e=We):(rt=We,$e=We);var ht=_e[rt].value,xt=_e[$e].value,kt=Math.abs(xt-ht),Wt=Ne||kt,Ft=0;Wt>=h?kt>=h&&kt<=p?Ft=kt:Ft=y:Ne===u&&Wt>=_?kt>=_&&kt<=m?Ft=kt:Ft=u:Wt>=x?kt>=x&&kt<=s?Ft=kt:Ft=A:Ne===v&&Wt>=v?Ft=v:Wt>=b?Ft=b:Ne===l&&Wt>=l?Ft=l:Ne===L&&Wt>=L&&(Ft=L);var ir;Ft>=kt&&(Ft=kt,ir=!0);var hr=Qe+Ft;if(Me.rangebreaks&&Ft>0){for(var _r=84,an=0,Rr=0;Rr<_r;Rr++){var Vr=(Rr+.5)/_r;Me.maskBreaks(Qe*(1-Vr)+Vr*hr)!==z&&an++}Ft*=an/_r,Ft||(_e[We].drop=!0),ir&&kt>v&&(Ft=kt)}(Ft>0||We===0)&&(_e[We].periodX=Qe+Ft/2)}}X.calcTicks=function(Me,Ne){X.prepTicks(Me,Ne);var We=e.simpleMap(Me.range,Me.r2l,void 0,void 0,Ne);if(Me.tickmode==="array")return pe(Me);var Qe=Q(We),rt=Qe[0],$e=Qe[1],ht=We[1]<We[0],xt=Math.min(We[0],We[1]),kt=Math.max(We[0],We[1]),Wt=c(Me.dtick),Ft=Me.type==="log"&&!(Wt||Me.dtick.charAt(0)==="L"),ir=Me.ticklabelmode==="period";if(Me._tmin=X.tickFirst(Me,Ne),Me._tmin<rt!==ht)return[];(Me.type==="category"||Me.type==="multicategory")&&($e=ht?Math.max(-.5,$e):Math.min(Me._categories.length-.5,$e));var hr=Me._tmin;Me.rangebreaks&&Me._tick0Init!==Me.tick0&&(hr=Ut(hr,Me),ht||(hr=X.tickIncrement(hr,Me.dtick,!ht,Me.calendar))),ir&&(hr=X.tickIncrement(hr,Me.dtick,!ht,Me.calendar));var _r=Me.ticklabelstep,an=Math.max(1e3,Me._length||0),Rr=[],Vr=null,fn;Wt?fn=Me.dtick:Me.type==="date"?typeof Me.dtick=="string"&&Me.dtick.charAt(0)==="M"&&(fn=A*Me.dtick.substring(1)):fn=Me._roughDTick;for(var xr=Math.round((Me.r2l(hr)-Me.r2l(Me.tick0))/fn)-1;ht?hr>=$e:hr<=$e;hr=X.tickIncrement(hr,Me.dtick,ht,Me.calendar)){if(xr++,Me.rangebreaks&&!ht){if(hr<rt)continue;if(Me.maskBreaks(hr)===z&&Ut(hr,Me)>=kt)break}if(Rr.length>an||hr===Vr)break;Vr=hr;var mr=!1;Ft&&hr!==(hr|0)&&(mr=!0);var Fr={minor:mr,value:hr};_r>1&&xr%_r&&(Fr.skipLabel=!0),Rr.push(Fr)}ir&&fe(Rr,Me,Me._definedDelta);var Ir;if(Me.rangebreaks){var Sr=Me._id.charAt(0)==="y",tt=1;Me.tickmode==="auto"&&(tt=Me.tickfont?Me.tickfont.size:12);var Ct=NaN;for(Ir=Rr.length-1;Ir>-1;Ir--){if(Rr[Ir].drop){Rr.splice(Ir,1);continue}Rr[Ir].value=Ut(Rr[Ir].value,Me);var Zt=Me.c2p(Rr[Ir].value);(Sr?Ct>Zt-tt:Ct<Zt+tt)?Rr.splice(ht?Ir+1:Ir,1):Ct=Zt}}jt(Me)&&Math.abs(We[1]-We[0])===360&&Rr.pop(),Me._tmax=(Rr[Rr.length-1]||{}).value,Me._prevDateHead="",Me._inCalcTicks=!0;var ur,Lr=function(An){An.text=" ",Me._prevDateHead=ur},Br=[],Pr,Tr;for(Ir=0;Ir<Rr.length;Ir++){var jr=Rr[Ir].minor,Pn=Rr[Ir].value;ur=Me._prevDateHead,Pr=X.tickText(Me,Pn,!1,jr),Tr=Rr[Ir].periodX,Tr!==void 0&&(Pr.periodX=Tr,(Tr>kt||Tr<xt)&&(Tr>kt&&(Pr.periodX=kt),Tr<xt&&(Pr.periodX=xt),Lr(Pr))),Rr[Ir].skipLabel&&Lr(Pr),Br.push(Pr)}return Me._inCalcTicks=!1,Br};function pe(_e){var Me=_e.tickvals,Ne=_e.ticktext,We=new Array(Me.length),Qe=e.simpleMap(_e.range,_e.r2l),rt=Q(Qe),$e=Math.min(rt[0],rt[1]),ht=Math.max(rt[0],rt[1]),xt=0;Array.isArray(Ne)||(Ne=[]);var kt=_e.type==="category"?_e.d2l_noadd:_e.d2l;_e.type==="log"&&String(_e.dtick).charAt(0)!=="L"&&(_e.dtick="L"+Math.pow(10,Math.floor(Math.min(_e.range[0],_e.range[1]))-1));for(var Wt=0;Wt<Me.length;Wt++){var Ft=kt(Me[Wt]);Ft>$e&&Ft<ht&&(Ne[Wt]===void 0?We[xt]=X.tickText(_e,Ft):We[xt]=Je(_e,Ft,String(Ne[Wt])),xt++)}return xt<Me.length&&We.splice(xt,Me.length-xt),_e.rangebreaks&&(We=We.filter(function(ir){return _e.maskBreaks(ir.x)!==z})),We}var ge=[2,5,10],Ae=[1,2,3,6,12],we=[1,2,5,10,15,30],De=[1,2,3,7,14],Be=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],Ve=[-.301,0,.301,.699,1],xe=[15,30,45,90,180];function Le(_e,Me,Ne){return Me*e.roundUp(_e/Me,Ne)}X.autoTicks=function(_e,Me){var Ne;function We(Wt){return Math.pow(Wt,Math.floor(Math.log(Me)/Math.LN10))}if(_e.type==="date"){_e.tick0=e.dateTick0(_e.calendar,0);var Qe=2*Me;if(Qe>y)Me/=y,Ne=We(10),_e.dtick="M"+12*Le(Me,Ne,ge);else if(Qe>A)Me/=A,_e.dtick="M"+Le(Me,1,Ae);else if(Qe>b){_e.dtick=Le(Me,b,_e._hasDayOfWeekBreaks?[1,2,7,14]:De);var rt=X.getTickFormat(_e),$e=_e.ticklabelmode==="period";$e&&(_e._rawTick0=_e.tick0),/%[uVW]/.test(rt)?_e.tick0=e.dateTick0(_e.calendar,2):_e.tick0=e.dateTick0(_e.calendar,1),$e&&(_e._dowTick0=_e.tick0)}else Qe>L?_e.dtick=Le(Me,L,Ae):Qe>S?_e.dtick=Le(Me,S,we):Qe>k?_e.dtick=Le(Me,k,we):(Ne=We(10),_e.dtick=Le(Me,Ne,ge))}else if(_e.type==="log"){_e.tick0=0;var ht=e.simpleMap(_e.range,_e.r2l);if(Me>.7)_e.dtick=Math.ceil(Me);else if(Math.abs(ht[1]-ht[0])<1){var xt=1.5*Math.abs((ht[1]-ht[0])/Me);Me=Math.abs(Math.pow(10,ht[1])-Math.pow(10,ht[0]))/xt,Ne=We(10),_e.dtick="L"+Le(Me,Ne,ge)}else _e.dtick=Me>.3?"D2":"D1"}else _e.type==="category"||_e.type==="multicategory"?(_e.tick0=0,_e.dtick=Math.ceil(Math.max(Me,1))):jt(_e)?(_e.tick0=0,Ne=1,_e.dtick=Le(Me,Ne,xe)):(_e.tick0=0,Ne=We(10),_e.dtick=Le(Me,Ne,ge));if(_e.dtick===0&&(_e.dtick=1),!c(_e.dtick)&&typeof _e.dtick!="string"){var kt=_e.dtick;throw _e.dtick=1,"ax.dtick error: "+String(kt)}};function He(_e){var Me=_e.dtick;if(_e._tickexponent=0,!c(Me)&&typeof Me!="string"&&(Me=1),(_e.type==="category"||_e.type==="multicategory")&&(_e._tickround=null),_e.type==="date"){var Ne=_e.r2l(_e.tick0),We=_e.l2r(Ne).replace(/(^-|i)/g,""),Qe=We.length;if(String(Me).charAt(0)==="M")Qe>10||We.substr(5)!=="01-01"?_e._tickround="d":_e._tickround=+Me.substr(1)%12===0?"y":"m";else if(Me>=b&&Qe<=10||Me>=b*15)_e._tickround="d";else if(Me>=S&&Qe<=16||Me>=L)_e._tickround="M";else if(Me>=k&&Qe<=19||Me>=S)_e._tickround="S";else{var rt=_e.l2r(Ne+Me).replace(/^-/,"").length;_e._tickround=Math.max(Qe,rt)-20,_e._tickround<0&&(_e._tickround=4)}}else if(c(Me)||Me.charAt(0)==="L"){var $e=_e.range.map(_e.r2d||Number);c(Me)||(Me=Number(Me.substr(1))),_e._tickround=2-Math.floor(Math.log(Me)/Math.LN10+.01);var ht=Math.max(Math.abs($e[0]),Math.abs($e[1])),xt=Math.floor(Math.log(ht)/Math.LN10+.01),kt=_e.minexponent===void 0?3:_e.minexponent;Math.abs(xt)>kt&&(Bt(_e.exponentformat)&&!Mt(xt)?_e._tickexponent=3*Math.round((xt-1)/3):_e._tickexponent=xt)}else _e._tickround=null}X.tickIncrement=function(_e,Me,Ne,We){var Qe=Ne?-1:1;if(c(Me))return e.increment(_e,Qe*Me);var rt=Me.charAt(0),$e=Qe*Number(Me.substr(1));if(rt==="M")return e.incrementMonth(_e,$e,We);if(rt==="L")return Math.log(Math.pow(10,_e)+$e)/Math.LN10;if(rt==="D"){var ht=Me==="D2"?Ve:Be,xt=_e+Qe*.01,kt=e.roundUp(e.mod(xt,1),ht,Ne);return Math.floor(xt)+Math.log(w.round(Math.pow(10,kt),1))/Math.LN10}throw"unrecognized dtick "+String(Me)},X.tickFirst=function(_e,Me){var Ne=_e.r2l||Number,We=e.simpleMap(_e.range,Ne,void 0,void 0,Me),Qe=We[1]<We[0],rt=Qe?Math.floor:Math.ceil,$e=Q(We)[0],ht=_e.dtick,xt=Ne(_e.tick0);if(c(ht)){var kt=rt(($e-xt)/ht)*ht+xt;return(_e.type==="category"||_e.type==="multicategory")&&(kt=e.constrain(kt,0,_e._categories.length-1)),kt}var Wt=ht.charAt(0),Ft=Number(ht.substr(1));if(Wt==="M"){for(var ir=0,hr=xt,_r,an,Rr;ir<10;){if(_r=X.tickIncrement(hr,ht,Qe,_e.calendar),(_r-$e)*(hr-$e)<=0)return Qe?Math.min(hr,_r):Math.max(hr,_r);an=($e-(hr+_r)/2)/(_r-hr),Rr=Wt+(Math.abs(Math.round(an))||1)*Ft,hr=X.tickIncrement(hr,Rr,an<0?!Qe:Qe,_e.calendar),ir++}return e.error("tickFirst did not converge",_e),hr}else{if(Wt==="L")return Math.log(rt((Math.pow(10,$e)-xt)/Ft)*Ft+xt)/Math.LN10;if(Wt==="D"){var Vr=ht==="D2"?Ve:Be,fn=e.roundUp(e.mod($e,1),Vr,Qe);return Math.floor($e)+Math.log(w.round(Math.pow(10,fn),1))/Math.LN10}else throw"unrecognized dtick "+String(ht)}},X.tickText=function(_e,Me,Ne,We){var Qe=Je(_e,Me),rt=_e.tickmode==="array",$e=Ne||rt,ht=_e.type,xt=ht==="category"?_e.d2l_noadd:_e.d2l,kt;if(rt&&Array.isArray(_e.ticktext)){var Wt=e.simpleMap(_e.range,_e.r2l),Ft=(Math.abs(Wt[1]-Wt[0])-(_e._lBreaks||0))/1e4;for(kt=0;kt<_e.ticktext.length&&!(Math.abs(Me-xt(_e.tickvals[kt]))<Ft);kt++);if(kt<_e.ticktext.length)return Qe.text=String(_e.ticktext[kt]),Qe}function ir(an){if(an===void 0)return!0;if(Ne)return an==="none";var Rr={first:_e._tmin,last:_e._tmax}[an];return an!=="all"&&Me!==Rr}var hr=Ne?"never":_e.exponentformat!=="none"&&ir(_e.showexponent)?"hide":"";if(ht==="date"?Oe(_e,Qe,Ne,$e):ht==="log"?Pe(_e,Qe,Ne,$e,hr):ht==="category"?Ue(_e,Qe):ht==="multicategory"?vt(_e,Qe,Ne):jt(_e)?Yt(_e,Qe,Ne,$e,hr):Lt(_e,Qe,Ne,$e,hr),We||(_e.tickprefix&&!ir(_e.showtickprefix)&&(Qe.text=_e.tickprefix+Qe.text),_e.ticksuffix&&!ir(_e.showticksuffix)&&(Qe.text+=_e.ticksuffix)),_e.tickson==="boundaries"||_e.showdividers){var _r=function(an){var Rr=_e.l2p(an);return Rr>=0&&Rr<=_e._length?an:null};Qe.xbnd=[_r(Qe.x-.5),_r(Qe.x+_e.dtick-.5)]}return Qe},X.hoverLabelText=function(_e,Me,Ne){Ne&&(_e=e.extendFlat({},_e,{hoverformat:Ne}));var We=Array.isArray(Me)?Me[0]:Me,Qe=Array.isArray(Me)?Me[1]:void 0;if(Qe!==void 0&&Qe!==We)return X.hoverLabelText(_e,We,Ne)+" - "+X.hoverLabelText(_e,Qe,Ne);var rt=_e.type==="log"&&We<=0,$e=X.tickText(_e,_e.c2l(rt?-We:We),"hover").text;return rt?We===0?"0":P+$e:$e};function Je(_e,Me,Ne){var We=_e.tickfont||{};return{x:Me,dx:0,dy:0,text:Ne||"",fontSize:We.size,font:We.family,fontColor:We.color}}function Oe(_e,Me,Ne,We){var Qe=_e._tickround,rt=Ne&&_e.hoverformat||X.getTickFormat(_e);We&&(c(Qe)?Qe=4:Qe={y:"m",m:"d",d:"M",M:"S",S:4}[Qe]);var $e=e.formatDate(Me.x,rt,Qe,_e._dateFormat,_e.calendar,_e._extraFormat),ht,xt=$e.indexOf(`
`);if(xt!==-1&&(ht=$e.substr(xt+1),$e=$e.substr(0,xt)),We&&($e==="00:00:00"||$e==="00:00"?($e=ht,ht=""):$e.length===8&&($e=$e.replace(/:00$/,""))),ht)if(Ne)Qe==="d"?$e+=", "+ht:$e=ht+($e?", "+$e:"");else if(!_e._inCalcTicks||_e._prevDateHead!==ht)_e._prevDateHead=ht,$e+="<br>"+ht;else{var kt=yr(_e),Wt=_e._trueSide||_e.side;(!kt&&Wt==="top"||kt&&Wt==="bottom")&&($e+="<br> ")}Me.text=$e}function Pe(_e,Me,Ne,We,Qe){var rt=_e.dtick,$e=Me.x,ht=_e.tickformat,xt=typeof rt=="string"&&rt.charAt(0);if(Qe==="never"&&(Qe=""),We&&xt!=="L"&&(rt="L3",xt="L"),ht||xt==="L")Me.text=Tt(Math.pow(10,$e),_e,Qe,We);else if(c(rt)||xt==="D"&&e.mod($e+.01,1)<.1){var kt=Math.round($e),Wt=Math.abs(kt),Ft=_e.exponentformat;Ft==="power"||Bt(Ft)&&Mt(kt)?(kt===0?Me.text=1:kt===1?Me.text="10":Me.text="10<sup>"+(kt>1?"":P)+Wt+"</sup>",Me.fontSize*=1.25):(Ft==="e"||Ft==="E")&&Wt>2?Me.text="1"+Ft+(kt>0?"+":P)+Wt:(Me.text=Tt(Math.pow(10,$e),_e,"","fakehover"),rt==="D1"&&_e._id.charAt(0)==="y"&&(Me.dy-=Me.fontSize/6))}else if(xt==="D")Me.text=String(Math.round(Math.pow(10,e.mod($e,1)))),Me.fontSize*=.75;else throw"unrecognized dtick "+String(rt);if(_e.dtick==="D1"){var ir=String(Me.text).charAt(0);(ir==="0"||ir==="1")&&(_e._id.charAt(0)==="y"?Me.dx-=Me.fontSize/4:(Me.dy+=Me.fontSize/2,Me.dx+=(_e.range[1]>_e.range[0]?1:-1)*Me.fontSize*($e<0?.5:.25)))}}function Ue(_e,Me){var Ne=_e._categories[Math.round(Me.x)];Ne===void 0&&(Ne=""),Me.text=String(Ne)}function vt(_e,Me,Ne){var We=Math.round(Me.x),Qe=_e._categories[We]||[],rt=Qe[1]===void 0?"":String(Qe[1]),$e=Qe[0]===void 0?"":String(Qe[0]);Ne?Me.text=$e+" - "+rt:(Me.text=rt,Me.text2=$e)}function Lt(_e,Me,Ne,We,Qe){Qe==="never"?Qe="":_e.showexponent==="all"&&Math.abs(Me.x/_e.dtick)<1e-6&&(Qe="hide"),Me.text=Tt(Me.x,_e,Qe,We)}function Yt(_e,Me,Ne,We,Qe){if(_e.thetaunit==="radians"&&!Ne){var rt=Me.x/180;if(rt===0)Me.text="0";else{var $e=At(rt);if($e[1]>=100)Me.text=Tt(e.deg2rad(Me.x),_e,Qe,We);else{var ht=Me.x<0;$e[1]===1?$e[0]===1?Me.text="\u03C0":Me.text=$e[0]+"\u03C0":Me.text=["<sup>",$e[0],"</sup>","\u2044","<sub>",$e[1],"</sub>","\u03C0"].join(""),ht&&(Me.text=P+Me.text)}}}else Me.text=Tt(Me.x,_e,Qe,We)}function At(_e){function Me(ht,xt){return Math.abs(ht-xt)<=1e-6}function Ne(ht,xt){return Me(xt,0)?ht:Ne(xt,ht%xt)}function We(ht){for(var xt=1;!Me(Math.round(ht*xt)/xt,ht);)xt*=10;return xt}var Qe=We(_e),rt=_e*Qe,$e=Math.abs(Ne(rt,Qe));return[Math.round(rt/$e),Math.round(Qe/$e)]}var Rt=["f","p","n","\u03BC","m","","k","M","G","T"];function Bt(_e){return _e==="SI"||_e==="B"}function Mt(_e){return _e>14||_e<-15}function Tt(_e,Me,Ne,We){var Qe=_e<0,rt=Me._tickround,$e=Ne||Me.exponentformat||"B",ht=Me._tickexponent,xt=X.getTickFormat(Me),kt=Me.separatethousands;if(We){var Wt={exponentformat:$e,minexponent:Me.minexponent,dtick:Me.showexponent==="none"?Me.dtick:c(_e)&&Math.abs(_e)||1,range:Me.showexponent==="none"?Me.range.map(Me.r2d):[0,_e||1]};He(Wt),rt=(Number(Wt._tickround)||0)+4,ht=Wt._tickexponent,Me.hoverformat&&(xt=Me.hoverformat)}if(xt)return Me._numFormat(xt)(_e).replace(/-/g,P);var Ft=Math.pow(10,-rt)/2;if($e==="none"&&(ht=0),_e=Math.abs(_e),_e<Ft)_e="0",Qe=!1;else{if(_e+=Ft,ht&&(_e*=Math.pow(10,-ht),rt+=ht),rt===0)_e=String(Math.floor(_e));else if(rt<0){_e=String(Math.round(_e)),_e=_e.substr(0,_e.length+rt);for(var ir=rt;ir<0;ir++)_e+="0"}else{_e=String(_e);var hr=_e.indexOf(".")+1;hr&&(_e=_e.substr(0,hr+rt).replace(/\.?0+$/,""))}_e=e.numSeparate(_e,Me._separators,kt)}if(ht&&$e!=="hide"){Bt($e)&&Mt(ht)&&($e="power");var _r;ht<0?_r=P+-ht:$e!=="power"?_r="+"+ht:_r=String(ht),$e==="e"||$e==="E"?_e+=$e+_r:$e==="power"?_e+="\xD710<sup>"+_r+"</sup>":$e==="B"&&ht===9?_e+="B":Bt($e)&&(_e+=Rt[ht/3+5])}return Qe?P+_e:_e}X.getTickFormat=function(_e){var Me;function Ne(xt){return typeof xt!="string"?xt:Number(xt.replace("M",""))*A}function We(xt,kt){var Wt=["L","D"];if(typeof xt==typeof kt){if(typeof xt=="number")return xt-kt;var Ft=Wt.indexOf(xt.charAt(0)),ir=Wt.indexOf(kt.charAt(0));return Ft===ir?Number(xt.replace(/(L|D)/g,""))-Number(kt.replace(/(L|D)/g,"")):Ft-ir}else return typeof xt=="number"?1:-1}function Qe(xt,kt,Wt){var Ft=Wt||function(_r){return _r},ir=kt[0],hr=kt[1];return(!ir&&typeof ir!="number"||Ft(ir)<=Ft(xt))&&(!hr&&typeof hr!="number"||Ft(hr)>=Ft(xt))}function rt(xt,kt){var Wt=kt[0]===null,Ft=kt[1]===null,ir=We(xt,kt[0])>=0,hr=We(xt,kt[1])<=0;return(Wt||ir)&&(Ft||hr)}var $e,ht;if(_e.tickformatstops&&_e.tickformatstops.length>0)switch(_e.type){case"date":case"linear":{for(Me=0;Me<_e.tickformatstops.length;Me++)if(ht=_e.tickformatstops[Me],ht.enabled&&Qe(_e.dtick,ht.dtickrange,Ne)){$e=ht;break}break}case"log":{for(Me=0;Me<_e.tickformatstops.length;Me++)if(ht=_e.tickformatstops[Me],ht.enabled&&rt(_e.dtick,ht.dtickrange)){$e=ht;break}break}}return $e?$e.value:_e.tickformat},X.getSubplots=function(_e,Me){var Ne=_e._fullLayout._subplots,We=Ne.cartesian.concat(Ne.gl2d||[]),Qe=Me?X.findSubplotsWithAxis(We,Me):We;return Qe.sort(function(rt,$e){var ht=rt.substr(1).split("y"),xt=$e.substr(1).split("y");return ht[0]===xt[0]?+ht[1]-+xt[1]:+ht[0]-+xt[0]}),Qe},X.findSubplotsWithAxis=function(_e,Me){for(var Ne=new RegExp(Me._id.charAt(0)==="x"?"^"+Me._id+"y":Me._id+"$"),We=[],Qe=0;Qe<_e.length;Qe++){var rt=_e[Qe];Ne.test(rt)&&We.push(rt)}return We},X.makeClipPaths=function(_e){var Me=_e._fullLayout;if(!Me._hasOnlyLargeSploms){var Ne={_offset:0,_length:Me.width,_id:""},We={_offset:0,_length:Me.height,_id:""},Qe=X.list(_e,"x",!0),rt=X.list(_e,"y",!0),$e=[],ht,xt;for(ht=0;ht<Qe.length;ht++)for($e.push({x:Qe[ht],y:We}),xt=0;xt<rt.length;xt++)ht===0&&$e.push({x:Ne,y:rt[xt]}),$e.push({x:Qe[ht],y:rt[xt]});var kt=Me._clips.selectAll(".axesclip").data($e,function(Wt){return Wt.x._id+Wt.y._id});kt.enter().append("clipPath").classed("axesclip",!0).attr("id",function(Wt){return"clip"+Me._uid+Wt.x._id+Wt.y._id}).append("rect"),kt.exit().remove(),kt.each(function(Wt){w.select(this).select("rect").attr({x:Wt.x._offset||0,y:Wt.y._offset||0,width:Wt.x._length||1,height:Wt.y._length||1})})}},X.draw=function(_e,Me,Ne){var We=_e._fullLayout;Me==="redraw"&&We._paper.selectAll("g.subplot").each(function(rt){var $e=rt[0],ht=We._plots[$e];if(ht){var xt=ht.xaxis,kt=ht.yaxis;ht.xaxislayer.selectAll("."+xt._id+"tick").remove(),ht.yaxislayer.selectAll("."+kt._id+"tick").remove(),ht.xaxislayer.selectAll("."+xt._id+"tick2").remove(),ht.yaxislayer.selectAll("."+kt._id+"tick2").remove(),ht.xaxislayer.selectAll("."+xt._id+"divider").remove(),ht.yaxislayer.selectAll("."+kt._id+"divider").remove(),ht.gridlayer&&ht.gridlayer.selectAll("path").remove(),ht.zerolinelayer&&ht.zerolinelayer.selectAll("path").remove(),We._infolayer.select(".g-"+xt._id+"title").remove(),We._infolayer.select(".g-"+kt._id+"title").remove()}});var Qe=!Me||Me==="redraw"?X.listIds(_e):Me;return e.syncOrAsync(Qe.map(function(rt){return function(){if(!!rt){var $e=X.getFromId(_e,rt),ht=X.drawOne(_e,$e,Ne);return $e._r=$e.range.slice(),$e._rl=e.simpleMap($e._r,$e.r2l),ht}}}))},X.drawOne=function(_e,Me,Ne){Ne=Ne||{};var We,Qe,rt;Me.setScale();var $e=_e._fullLayout,ht=Me._id,xt=ht.charAt(0),kt=X.counterLetter(ht),Wt=$e._plots[Me._mainSubplot];if(!Wt)return;var Ft=Wt[xt+"axislayer"],ir=Me._mainLinePosition,hr=Me._mainMirrorPosition,_r=Me._vals=X.calcTicks(Me),an=[Me.mirror,ir,hr].join("_");for(We=0;We<_r.length;We++)_r[We].axInfo=an;Me._selections={},Me._tickAngles&&(Me._prevTickAngles=Me._tickAngles),Me._tickAngles={},Me._depth=null;var Rr={};function Vr(Ga){var wr=ht+(Ga||"tick");return Rr[wr]||(Rr[wr]=ke(Me,wr)),Rr[wr]}if(!!Me.visible){var fn=X.makeTransTickFn(Me),xr=X.makeTransTickLabelFn(Me),mr,Fr,Ir=Me.ticks==="inside",Sr=Me.ticks==="outside";if(Me.tickson==="boundaries"){var tt=at(Me,_r);Fr=X.clipEnds(Me,tt),mr=Ir?Fr:tt}else Fr=X.clipEnds(Me,_r),mr=Ir&&Me.ticklabelmode!=="period"?Fr:_r;var Ct=Me._gridVals=Fr,Zt=je(Me,_r);if(!$e._hasOnlyLargeSploms){var ur=Me._subplotsWith,Lr={};for(We=0;We<ur.length;We++){Qe=ur[We],rt=$e._plots[Qe];var Br=rt[kt+"axis"],Pr=Br._mainAxis._id;if(!Lr[Pr]){Lr[Pr]=1;var Tr=xt==="x"?"M0,"+Br._offset+"v"+Br._length:"M"+Br._offset+",0h"+Br._length;X.drawGrid(_e,Me,{vals:Ct,counterAxis:Br,layer:rt.gridlayer.select("."+ht),path:Tr,transFn:fn}),X.drawZeroLine(_e,Me,{counterAxis:Br,layer:rt.zerolinelayer,path:Tr,transFn:fn})}}}var jr=X.getTickSigns(Me),Pn=[];if(Me.ticks){var An=X.makeTickPath(Me,ir,jr[2]),$n,zn;Me._anchorAxis&&Me.mirror&&Me.mirror!==!0?($n=X.makeTickPath(Me,hr,jr[3]),zn=An+$n):($n="",zn=An);var Yn;if(Me.showdividers&&Sr&&Me.tickson==="boundaries"){var Kn={};for(We=0;We<Zt.length;We++)Kn[Zt[We].x]=1;Yn=function(Ga){return Kn[Ga.x]?$n:zn}}else Yn=zn;X.drawTicks(_e,Me,{vals:mr,layer:Ft,path:Yn,transFn:fn}),Me.mirror==="allticks"&&(Pn=Object.keys(Me._linepositions||{}))}for(We=0;We<Pn.length;We++){Qe=Pn[We],rt=$e._plots[Qe];var Aa=Me._linepositions[Qe]||[],Ua=X.makeTickPath(Me,Aa[0],jr[0])+X.makeTickPath(Me,Aa[1],jr[1]);X.drawTicks(_e,Me,{vals:mr,layer:rt[xt+"axislayer"],path:Ua,transFn:fn})}var vi=[];if(vi.push(function(){return X.drawLabels(_e,Me,{vals:_r,layer:Ft,plotinfo:rt,transFn:xr,labelFns:X.makeLabelFns(Me,ir)})}),Me.type==="multicategory"){var ci={x:2,y:10}[xt];vi.push(function(){var Ga={x:"height",y:"width"}[xt],wr=Vr()[Ga]+ci+(Me._tickAngles[ht+"tick"]?Me.tickfont.size*J:0);return X.drawLabels(_e,Me,{vals:ct(Me,_r),layer:Ft,cls:ht+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:fn,labelFns:X.makeLabelFns(Me,ir+wr*jr[4])})}),vi.push(function(){return Me._depth=jr[4]*(Vr("tick2")[Me.side]-ir),Et(_e,Me,{vals:Zt,layer:Ft,path:X.makeTickPath(Me,ir,jr[4],Me._depth),transFn:fn})})}else Me.title.hasOwnProperty("standoff")&&vi.push(function(){Me._depth=jr[4]*(Vr()[Me.side]-ir)});var ui=T.getComponentMethod("rangeslider","isVisible")(Me);return vi.push(function(){var Ga=Me.side.charAt(0),wr=j[Me.side].charAt(0),vn=X.getPxPosition(_e,Me),on=Sr?Me.ticklen:0,_n,Bn,sa,ra;if((Me.automargin||ui)&&(Me.type==="multicategory"?_n=Vr("tick2"):(_n=Vr(),xt==="x"&&Ga==="b"&&(Me._depth=Math.max(_n.width>0?_n.bottom-vn:0,on)))),Me.automargin){Bn={x:0,y:0,r:0,l:0,t:0,b:0};var In=[0,1];if(xt==="x"){if(Ga==="b"?Bn[Ga]=Me._depth:(Bn[Ga]=Me._depth=Math.max(_n.width>0?vn-_n.top:0,on),In.reverse()),_n.width>0){var ea=_n.right-(Me._offset+Me._length);ea>0&&(Bn.xr=1,Bn.r=ea);var Va=Me._offset-_n.left;Va>0&&(Bn.xl=0,Bn.l=Va)}}else if(Ga==="l"?Bn[Ga]=Me._depth=Math.max(_n.height>0?vn-_n.left:0,on):(Bn[Ga]=Me._depth=Math.max(_n.height>0?_n.right-vn:0,on),In.reverse()),_n.height>0){var hi=_n.bottom-(Me._offset+Me._length);hi>0&&(Bn.yb=0,Bn.b=hi);var It=Me._offset-_n.top;It>0&&(Bn.yt=1,Bn.t=It)}Bn[kt]=Me.anchor==="free"?Me.position:Me._anchorAxis.domain[In[0]],Me.title.text!==$e._dfltTitle[xt]&&(Bn[Ga]+=bt(Me)+(Me.title.standoff||0)),Me.mirror&&Me.anchor!=="free"&&(sa={x:0,y:0,r:0,l:0,t:0,b:0},sa[wr]=Me.linewidth,Me.mirror&&Me.mirror!==!0&&(sa[wr]+=on),Me.mirror===!0||Me.mirror==="ticks"?sa[kt]=Me._anchorAxis.domain[In[1]]:(Me.mirror==="all"||Me.mirror==="allticks")&&(sa[kt]=[Me._counterDomainMin,Me._counterDomainMax][In[1]]))}ui&&(ra=T.getComponentMethod("rangeslider","autoMarginOpts")(_e,Me)),M.autoMargin(_e,qt(Me),Bn),M.autoMargin(_e,lr(Me),sa),M.autoMargin(_e,Wr(Me),ra)}),!Ne.skipTitle&&!(ui&&Me.side==="bottom")&&vi.push(function(){return zt(_e,Me)}),e.syncOrAsync(vi)}};function at(_e,Me){var Ne=[],We,Qe=function(rt,$e){var ht=rt.xbnd[$e];ht!==null&&Ne.push(e.extendFlat({},rt,{x:ht}))};if(Me.length){for(We=0;We<Me.length;We++)Qe(Me[We],0);Qe(Me[We-1],1)}return Ne}function ct(_e,Me){for(var Ne=[],We={},Qe=0;Qe<Me.length;Qe++){var rt=Me[Qe];We[rt.text2]?We[rt.text2].push(rt.x):We[rt.text2]=[rt.x]}for(var $e in We)Ne.push(Je(_e,e.interp(We[$e],.5),$e));return Ne}function je(_e,Me){var Ne=[],We,Qe,rt=Me.length&&Me[Me.length-1].x<Me[0].x,$e=function(xt,kt){var Wt=xt.xbnd[kt];Wt!==null&&Ne.push(e.extendFlat({},xt,{x:Wt}))};if(_e.showdividers&&Me.length){for(We=0;We<Me.length;We++){var ht=Me[We];ht.text2!==Qe&&$e(ht,rt?1:0),Qe=ht.text2}$e(Me[We-1],rt?0:1)}return Ne}function ke(_e,Me){var Ne,We,Qe,rt;return _e._selections[Me].size()?(Ne=1/0,We=-1/0,Qe=1/0,rt=-1/0,_e._selections[Me].each(function(){var $e=tr(this),ht=f.bBox($e.node().parentNode);Ne=Math.min(Ne,ht.top),We=Math.max(We,ht.bottom),Qe=Math.min(Qe,ht.left),rt=Math.max(rt,ht.right)})):(Ne=0,We=0,Qe=0,rt=0),{top:Ne,bottom:We,left:Qe,right:rt,height:We-Ne,width:rt-Qe}}X.getTickSigns=function(_e){var Me=_e._id.charAt(0),Ne={x:"top",y:"right"}[Me],We=_e.side===Ne?1:-1,Qe=[-1,1,We,-We];return _e.ticks!=="inside"==(Me==="x")&&(Qe=Qe.map(function(rt){return-rt})),_e.side&&Qe.push({l:-1,t:-1,r:1,b:1}[_e.side.charAt(0)]),Qe},X.makeTransTickFn=function(_e){return _e._id.charAt(0)==="x"?function(Me){return a(_e._offset+_e.l2p(Me.x),0)}:function(Me){return a(0,_e._offset+_e.l2p(Me.x))}},X.makeTransTickLabelFn=function(_e){var Me=Ke(_e),Ne=Me[0],We=Me[1];return _e._id.charAt(0)==="x"?function(Qe){return a(Ne+_e._offset+_e.l2p(Ye(Qe)),We)}:function(Qe){return a(We,Ne+_e._offset+_e.l2p(Ye(Qe)))}};function Ye(_e){return _e.periodX!==void 0?_e.periodX:_e.x}function Ke(_e){var Me=_e.ticklabelposition||"",Ne=function(hr){return Me.indexOf(hr)!==-1},We=Ne("top"),Qe=Ne("left"),rt=Ne("right"),$e=Ne("bottom"),ht=Ne("inside"),xt=$e||Qe||We||rt;if(!xt&&!ht)return[0,0];var kt=_e.side,Wt=xt?(_e.tickwidth||0)/2:0,Ft=Y,ir=_e.tickfont?_e.tickfont.size:12;return($e||We)&&(Wt+=ir*G,Ft+=(_e.linewidth||0)/2),(Qe||rt)&&(Wt+=(_e.linewidth||0)/2,Ft+=Y),ht&&kt==="top"&&(Ft-=ir*(1-G)),(Qe||We)&&(Wt=-Wt),(kt==="bottom"||kt==="right")&&(Ft=-Ft),[xt?Wt:0,ht?Ft:0]}X.makeTickPath=function(_e,Me,Ne,We){We=We!==void 0?We:_e.ticklen;var Qe=_e._id.charAt(0),rt=(_e.linewidth||1)/2;return Qe==="x"?"M0,"+(Me+rt*Ne)+"v"+We*Ne:"M"+(Me+rt*Ne)+",0h"+We*Ne},X.makeLabelFns=function(_e,Me,Ne){var We=_e.ticklabelposition||"",Qe=function(Lr){return We.indexOf(Lr)!==-1},rt=Qe("top"),$e=Qe("left"),ht=Qe("right"),xt=Qe("bottom"),kt=xt||$e||rt||ht,Wt=Qe("inside"),Ft=We==="inside"&&_e.ticks==="inside"||!Wt&&_e.ticks==="outside"&&_e.tickson!=="boundaries",ir=0,hr=0,_r=Ft?_e.ticklen:0;if(Wt?_r*=-1:kt&&(_r=0),Ft&&(ir+=_r,Ne)){var an=e.deg2rad(Ne);ir=_r*Math.cos(an)+1,hr=_r*Math.sin(an)}_e.showticklabels&&(Ft||_e.showline)&&(ir+=.2*_e.tickfont.size),ir+=(_e.linewidth||1)/2*(Wt?-1:1);var Rr={labelStandoff:ir,labelShift:hr},Vr,fn,xr,mr,Fr=0,Ir=_e.side,Sr=_e._id.charAt(0),tt=_e.tickangle,Ct;if(Sr==="x")Ct=!Wt&&Ir==="bottom"||Wt&&Ir==="top",mr=Ct?1:-1,Wt&&(mr*=-1),Vr=hr*mr,fn=Me+ir*mr,xr=Ct?1:-.2,Math.abs(tt)===90&&(Wt?xr+=V:tt===-90&&Ir==="bottom"?xr=G:tt===90&&Ir==="top"?xr=V:xr=.5,Fr=V/2*(tt/90)),Rr.xFn=function(Lr){return Lr.dx+Vr+Fr*Lr.fontSize},Rr.yFn=function(Lr){return Lr.dy+fn+Lr.fontSize*xr},Rr.anchorFn=function(Lr,Br){if(kt){if($e)return"end";if(ht)return"start"}return!c(Br)||Br===0||Br===180?"middle":Br*mr<0!==Wt?"end":"start"},Rr.heightFn=function(Lr,Br,Pr){return Br<-60||Br>60?-.5*Pr:_e.side==="top"!==Wt?-Pr:0};else if(Sr==="y"){if(Ct=!Wt&&Ir==="left"||Wt&&Ir==="right",mr=Ct?1:-1,Wt&&(mr*=-1),Vr=ir,fn=hr*mr,xr=0,!Wt&&Math.abs(tt)===90&&(tt===-90&&Ir==="left"||tt===90&&Ir==="right"?xr=G:xr=.5),Wt){var Zt=c(tt)?+tt:0;if(Zt!==0){var ur=e.deg2rad(Zt);Fr=Math.abs(Math.sin(ur))*G*mr,xr=0}}Rr.xFn=function(Lr){return Lr.dx+Me-(Vr+Lr.fontSize*xr)*mr+Fr*Lr.fontSize},Rr.yFn=function(Lr){return Lr.dy+fn+Lr.fontSize*V},Rr.anchorFn=function(Lr,Br){return c(Br)&&Math.abs(Br)===90?"middle":Ct?"end":"start"},Rr.heightFn=function(Lr,Br,Pr){return _e.side==="right"&&(Br*=-1),Br<-30?-Pr:Br<30?-.5*Pr:0}}return Rr};function st(_e){return[_e.text,_e.x,_e.axInfo,_e.font,_e.fontSize,_e.fontColor].join("_")}X.drawTicks=function(_e,Me,Ne){Ne=Ne||{};var We=Me._id+"tick",Qe=Ne.vals;Me.ticklabelmode==="period"&&(Qe=Qe.slice(),Qe.shift());var rt=Ne.layer.selectAll("path."+We).data(Me.ticks?Qe:[],st);rt.exit().remove(),rt.enter().append("path").classed(We,1).classed("ticks",1).classed("crisp",Ne.crisp!==!1).call(t.stroke,Me.tickcolor).style("stroke-width",f.crispRound(_e,Me.tickwidth,1)+"px").attr("d",Ne.path).style("display",null),nt(Me,[R]),rt.attr("transform",Ne.transFn)},X.drawGrid=function(_e,Me,Ne){Ne=Ne||{};var We=Me._id+"grid",Qe=Ne.vals,rt=Ne.counterAxis;if(Me.showgrid===!1)Qe=[];else if(rt&&X.shouldShowZeroLine(_e,Me,rt))for(var $e=Me.tickmode==="array",ht=0;ht<Qe.length;ht++){var xt=Qe[ht].x;if($e?!xt:Math.abs(xt)<Me.dtick/100)if(Qe=Qe.slice(0,ht).concat(Qe.slice(ht+1)),$e)ht--;else break}var kt=Ne.layer.selectAll("path."+We).data(Qe,st);kt.exit().remove(),kt.enter().append("path").classed(We,1).classed("crisp",Ne.crisp!==!1),Me._gw=f.crispRound(_e,Me.gridwidth,1),kt.attr("transform",Ne.transFn).attr("d",Ne.path).call(t.stroke,Me.gridcolor||"#ddd").style("stroke-width",Me._gw+"px").style("display",null),nt(Me,[D]),typeof Ne.path=="function"&&kt.attr("d",Ne.path)},X.drawZeroLine=function(_e,Me,Ne){Ne=Ne||Ne;var We=Me._id+"zl",Qe=X.shouldShowZeroLine(_e,Me,Ne.counterAxis),rt=Ne.layer.selectAll("path."+We).data(Qe?[{x:0,id:Me._id}]:[]);rt.exit().remove(),rt.enter().append("path").classed(We,1).classed("zl",1).classed("crisp",Ne.crisp!==!1).each(function(){Ne.layer.selectAll("path").sort(function($e,ht){return ie($e.id,ht.id)})}),rt.attr("transform",Ne.transFn).attr("d",Ne.path).call(t.stroke,Me.zerolinecolor||t.defaultLine).style("stroke-width",f.crispRound(_e,Me.zerolinewidth,Me._gw||1)+"px").style("display",null),nt(Me,[I])},X.drawLabels=function(_e,Me,Ne){Ne=Ne||{};var We=_e._fullLayout,Qe=Me._id,rt=Qe.charAt(0),$e=Ne.cls||Qe+"tick",ht=Ne.vals,xt=Ne.labelFns,kt=Ne.secondary?0:Me.tickangle,Wt=(Me._prevTickAngles||{})[$e],Ft=Ne.layer.selectAll("g."+$e).data(Me.showticklabels?ht:[],st),ir=[];Ft.enter().append("g").classed($e,1).append("text").attr("text-anchor","middle").each(function(mr){var Fr=w.select(this),Ir=_e._promises.length;Fr.call(n.positionText,xt.xFn(mr),xt.yFn(mr)).call(f.font,mr.font,mr.fontSize,mr.fontColor).text(mr.text).call(n.convertToTspans,_e),_e._promises[Ir]?ir.push(_e._promises.pop().then(function(){hr(Fr,kt)})):hr(Fr,kt)}),nt(Me,[B]),Ft.exit().remove(),Ne.repositionOnUpdate&&Ft.each(function(mr){w.select(this).select("text").call(n.positionText,xt.xFn(mr),xt.yFn(mr))});function hr(mr,Fr){mr.each(function(Ir){var Sr=w.select(this),tt=Sr.select(".text-math-group"),Ct=xt.anchorFn(Ir,Fr),Zt=Ne.transFn.call(Sr.node(),Ir)+(c(Fr)&&+Fr!=0?" rotate("+Fr+","+xt.xFn(Ir)+","+(xt.yFn(Ir)-Ir.fontSize/2)+")":""),ur=n.lineCount(Sr),Lr=J*Ir.fontSize,Br=xt.heightFn(Ir,c(Fr)?+Fr:0,(ur-1)*Lr);if(Br&&(Zt+=a(0,Br)),tt.empty()){var Pr=Sr.select("text");Pr.attr({transform:Zt,"text-anchor":Ct}),Pr.style("opacity",1),Me._adjustTickLabelsOverflow&&Me._adjustTickLabelsOverflow()}else{var Tr=f.bBox(tt.node()).width,jr=Tr*{end:-.5,start:.5}[Ct];tt.attr("transform",Zt+a(jr,0))}})}Me._adjustTickLabelsOverflow=function(){var mr=Me.ticklabeloverflow;if(!(!mr||mr==="allow")){var Fr=mr.indexOf("hide")!==-1,Ir=Me._id.charAt(0)==="x",Sr=0,tt=Ir?_e._fullLayout.width:_e._fullLayout.height;if(mr.indexOf("domain")!==-1){var Ct=e.simpleMap(Me.range,Me.r2l);Sr=Me.l2p(Ct[0])+Me._offset,tt=Me.l2p(Ct[1])+Me._offset}var Zt=Math.min(Sr,tt),ur=Math.max(Sr,tt),Lr=Me.side,Br=1/0,Pr=-1/0;Ft.each(function(An){var $n=w.select(this),zn=$n.select(".text-math-group");if(zn.empty()){var Yn=f.bBox($n.node()),Kn=0;Ir?(Yn.right>ur||Yn.left<Zt)&&(Kn=1):(Yn.bottom>ur||Yn.top+(Me.tickangle?0:An.fontSize/4)<Zt)&&(Kn=1);var Aa=$n.select("text");Kn?Fr&&Aa.style("opacity",0):(Aa.style("opacity",1),Lr==="bottom"||Lr==="right"?Br=Math.min(Br,Ir?Yn.top:Yn.left):Br=-1/0,Lr==="top"||Lr==="left"?Pr=Math.max(Pr,Ir?Yn.bottom:Yn.right):Pr=1/0)}});for(var Tr in We._plots){var jr=We._plots[Tr];if(!(Me._id!==jr.xaxis._id&&Me._id!==jr.yaxis._id)){var Pn=Ir?jr.yaxis:jr.xaxis;Pn&&(Pn["_visibleLabelMin_"+Me._id]=Br,Pn["_visibleLabelMax_"+Me._id]=Pr)}}}},Me._hideCounterAxisInsideTickLabels=function(mr){var Fr=Me._id.charAt(0)==="x",Ir=[];for(var Sr in We._plots){var tt=We._plots[Sr];Me._id!==tt.xaxis._id&&Me._id!==tt.yaxis._id||Ir.push(Fr?tt.yaxis:tt.xaxis)}Ir.forEach(function(Ct,Zt){Ct&&yr(Ct)&&(mr||[I,D,R,B]).forEach(function(ur){var Lr=ur.K==="tick"&&ur.L==="text"&&Me.ticklabelmode==="period",Br=We._plots[Me._mainSubplot],Pr;ur.K===I.K?Pr=Br.zerolinelayer.selectAll("."+Me._id+"zl"):ur.K===D.K?Pr=Br.gridlayer.selectAll("."+Me._id):Pr=Br[Me._id.charAt(0)+"axislayer"],Pr.each(function(){var Tr=w.select(this);ur.L&&(Tr=Tr.selectAll(ur.L)),Tr.each(function(jr){var Pn=Me.l2p(Lr?Ye(jr):jr.x)+Me._offset,An=w.select(this);Pn<Me["_visibleLabelMax_"+Ct._id]&&Pn>Me["_visibleLabelMin_"+Ct._id]?An.style("display","none"):ur.K==="tick"&&!Zt&&An.style("display",null)})})})})},hr(Ft,Wt+1?Wt:kt);function _r(){return ir.length&&Promise.all(ir)}var an=null;function Rr(){if(hr(Ft,kt),ht.length&&rt==="x"&&!c(kt)&&(Me.type!=="log"||String(Me.dtick).charAt(0)!=="D")){an=0;var mr=0,Fr=[],Ir;if(Ft.each(function(Yn){mr=Math.max(mr,Yn.fontSize);var Kn=Me.l2p(Yn.x),Aa=tr(this),Ua=f.bBox(Aa.node());Fr.push({top:0,bottom:10,height:10,left:Kn-Ua.width/2,right:Kn+Ua.width/2+2,width:Ua.width+2})}),(Me.tickson==="boundaries"||Me.showdividers)&&!Ne.secondary){var Sr=2;for(Me.ticks&&(Sr+=Me.tickwidth/2),Ir=0;Ir<Fr.length;Ir++){var tt=ht[Ir].xbnd,Ct=Fr[Ir];if(tt[0]!==null&&Ct.left-Me.l2p(tt[0])<Sr||tt[1]!==null&&Me.l2p(tt[1])-Ct.right<Sr){an=90;break}}}else{var Zt=ht.length,ur=Math.abs((ht[Zt-1].x-ht[0].x)*Me._m)/(Zt-1),Lr=Me.ticklabelposition||"",Br=function(Yn){return Lr.indexOf(Yn)!==-1},Pr=Br("top"),Tr=Br("left"),jr=Br("right"),Pn=Br("bottom"),An=Pn||Tr||Pr||jr,$n=An?(Me.tickwidth||0)+2*Y:0,zn=ur<mr*2.5||Me.type==="multicategory"||Me._name==="realaxis";for(Ir=0;Ir<Fr.length-1;Ir++)if(e.bBoxIntersect(Fr[Ir],Fr[Ir+1],$n)){an=zn?90:30;break}}an&&hr(Ft,an)}}Me._selections&&(Me._selections[$e]=Ft);var Vr=[_r];Me.automargin&&We._redrawFromAutoMarginCount&&Wt===90?(an=90,Vr.push(function(){hr(Ft,Wt)})):Vr.push(Rr),Me._tickAngles&&Vr.push(function(){Me._tickAngles[$e]=an===null?c(kt)?kt:0:an});var fn=Me._anchorAxis;fn&&fn.autorange&&yr(Me)&&!N(We,Me._id)&&(We._insideTickLabelsAutorange||(We._insideTickLabelsAutorange={}),We._insideTickLabelsAutorange[fn._name+".autorange"]=fn.autorange,Vr.push(function(){Ft.each(function(Fr,Ir){var Sr=tr(this),tt=Sr.select(".text-math-group");tt.empty()&&(Me._vals[Ir].bb=f.bBox(Sr.node()))})}));var xr=e.syncOrAsync(Vr);return xr&&xr.then&&_e._promises.push(xr),xr};function Et(_e,Me,Ne){var We=Me._id+"divider",Qe=Ne.vals,rt=Ne.layer.selectAll("path."+We).data(Qe,st);rt.exit().remove(),rt.enter().insert("path",":first-child").classed(We,1).classed("crisp",1).call(t.stroke,Me.dividercolor).style("stroke-width",f.crispRound(_e,Me.dividerwidth,1)+"px"),rt.attr("transform",Ne.transFn).attr("d",Ne.path)}X.getPxPosition=function(_e,Me){var Ne=_e._fullLayout._size,We=Me._id.charAt(0),Qe=Me.side,rt;if(Me.anchor!=="free"?rt=Me._anchorAxis:We==="x"?rt={_offset:Ne.t+(1-(Me.position||0))*Ne.h,_length:0}:We==="y"&&(rt={_offset:Ne.l+(Me.position||0)*Ne.w,_length:0}),Qe==="top"||Qe==="left")return rt._offset;if(Qe==="bottom"||Qe==="right")return rt._offset+rt._length};function bt(_e){var Me=_e.title.font.size,Ne=(_e.title.text.match(n.BR_TAG_ALL)||[]).length;return _e.title.hasOwnProperty("standoff")?Ne?Me*(G+Ne*J):Me*G:Ne?Me*(Ne+1)*J:Me}function zt(_e,Me){var Ne=_e._fullLayout,We=Me._id,Qe=We.charAt(0),rt=Me.title.font.size,$e;if(Me.title.hasOwnProperty("standoff"))$e=Me._depth+Me.title.standoff+bt(Me);else{var ht=yr(Me);if(Me.type==="multicategory")$e=Me._depth;else{var xt=1.5*rt;ht&&(xt=.5*rt,Me.ticks==="outside"&&(xt+=Me.ticklen)),$e=10+xt+(Me.linewidth?Me.linewidth-1:0)}ht||(Qe==="x"?$e+=Me.side==="top"?rt*(Me.showticklabels?1:0):rt*(Me.showticklabels?1.5:.5):$e+=Me.side==="right"?rt*(Me.showticklabels?1:.5):rt*(Me.showticklabels?.5:0))}var kt=X.getPxPosition(_e,Me),Wt,Ft,ir;Qe==="x"?(Ft=Me._offset+Me._length/2,ir=Me.side==="top"?kt-$e:kt+$e):(ir=Me._offset+Me._length/2,Ft=Me.side==="right"?kt+$e:kt-$e,Wt={rotate:"-90",offset:0});var hr;if(Me.type!=="multicategory"){var _r=Me._selections[Me._id+"tick"];if(hr={selection:_r,side:Me.side},_r&&_r.node()&&_r.node().parentNode){var an=f.getTranslate(_r.node().parentNode);hr.offsetLeft=an.x,hr.offsetTop=an.y}Me.title.hasOwnProperty("standoff")&&(hr.pad=0)}return r.draw(_e,We+"title",{propContainer:Me,propName:Me._name+".title.text",placeholder:Ne._dfltTitle[Qe],avoid:hr,transform:Wt,attributes:{x:Ft,y:ir,"text-anchor":"middle"}})}X.shouldShowZeroLine=function(_e,Me,Ne){var We=e.simpleMap(Me.range,Me.r2l);return We[0]*We[1]<=0&&Me.zeroline&&(Me.type==="linear"||Me.type==="-")&&!(Me.rangebreaks&&Me.maskBreaks(0)===z)&&($t(Me,0)||!Ot(_e,Me,Ne,We)||Qt(_e,Me))},X.clipEnds=function(_e,Me){return Me.filter(function(Ne){return $t(_e,Ne.x)})};function $t(_e,Me){var Ne=_e.l2p(Me);return Ne>1&&Ne<_e._length-1}function Ot(_e,Me,Ne,We){var Qe=Ne._mainAxis;if(!Qe)return;var rt=_e._fullLayout,$e=Me._id.charAt(0),ht=X.counterLetter(Me._id),xt=Me._offset+(Math.abs(We[0])<Math.abs(We[1])==($e==="x")?0:Me._length);function kt(_r){if(!_r.showline||!_r.linewidth)return!1;var an=Math.max((_r.linewidth+Me.zerolinewidth)/2,1);function Rr(xr){return typeof xr=="number"&&Math.abs(xr-xt)<an}if(Rr(_r._mainLinePosition)||Rr(_r._mainMirrorPosition))return!0;var Vr=_r._linepositions||{};for(var fn in Vr)if(Rr(Vr[fn][0])||Rr(Vr[fn][1]))return!0}var Wt=rt._plots[Ne._mainSubplot];if(!(Wt.mainplotinfo||Wt).overlays.length)return kt(Ne);for(var Ft=X.list(_e,ht),ir=0;ir<Ft.length;ir++){var hr=Ft[ir];if(hr._mainAxis===Qe&&kt(hr))return!0}}function Qt(_e,Me){for(var Ne=_e._fullData,We=Me._mainSubplot,Qe=Me._id.charAt(0),rt=0;rt<Ne.length;rt++){var $e=Ne[rt];if($e.visible===!0&&$e.xaxis+$e.yaxis===We&&(T.traceIs($e,"bar-like")&&$e.orientation==={x:"h",y:"v"}[Qe]||$e.fill&&$e.fill.charAt($e.fill.length-1)===Qe))return!0}return!1}function tr(_e){var Me=w.select(_e),Ne=Me.select(".text-math-group");return Ne.empty()?Me.select("text"):Ne}X.allowAutoMargin=function(_e){for(var Me=X.list(_e,"",!0),Ne=0;Ne<Me.length;Ne++){var We=Me[Ne];We.automargin&&(M.allowAutoMargin(_e,qt(We)),We.mirror&&M.allowAutoMargin(_e,lr(We))),T.getComponentMethod("rangeslider","isVisible")(We)&&M.allowAutoMargin(_e,Wr(We))}};function qt(_e){return _e._id+".automargin"}function lr(_e){return qt(_e)+".mirror"}function Wr(_e){return _e._id+".rangeslider"}X.swap=function(_e,Me){for(var Ne=cn(_e,Me),We=0;We<Ne.length;We++)ot(_e,Ne[We].x,Ne[We].y)};function cn(_e,Me){var Ne=[],We,Qe;for(We=0;We<Me.length;We++){var rt=[],$e=_e._fullData[Me[We]].xaxis,ht=_e._fullData[Me[We]].yaxis;if(!(!$e||!ht)){for(Qe=0;Qe<Ne.length;Qe++)(Ne[Qe].x.indexOf($e)!==-1||Ne[Qe].y.indexOf(ht)!==-1)&&rt.push(Qe);if(!rt.length){Ne.push({x:[$e],y:[ht]});continue}var xt=Ne[rt[0]],kt;if(rt.length>1)for(Qe=1;Qe<rt.length;Qe++)kt=Ne[rt[Qe]],Jr(xt.x,kt.x),Jr(xt.y,kt.y);Jr(xt.x,[$e]),Jr(xt.y,[ht])}}return Ne}function Jr(_e,Me){for(var Ne=0;Ne<Me.length;Ne++)_e.indexOf(Me[Ne])===-1&&_e.push(Me[Ne])}function ot(_e,Me,Ne){var We=[],Qe=[],rt=_e.layout,$e,ht;for($e=0;$e<Me.length;$e++)We.push(X.getFromId(_e,Me[$e]));for($e=0;$e<Ne.length;$e++)Qe.push(X.getFromId(_e,Ne[$e]));var xt=Object.keys(o),kt=["anchor","domain","overlaying","position","side","tickangle","editType"],Wt=["linear","log"];for($e=0;$e<xt.length;$e++){var Ft=xt[$e],ir=We[0][Ft],hr=Qe[0][Ft],_r=!0,an=!1,Rr=!1;if(!(Ft.charAt(0)==="_"||typeof ir=="function"||kt.indexOf(Ft)!==-1)){for(ht=1;ht<We.length&&_r;ht++){var Vr=We[ht][Ft];Ft==="type"&&Wt.indexOf(ir)!==-1&&Wt.indexOf(Vr)!==-1&&ir!==Vr?an=!0:Vr!==ir&&(_r=!1)}for(ht=1;ht<Qe.length&&_r;ht++){var fn=Qe[ht][Ft];Ft==="type"&&Wt.indexOf(hr)!==-1&&Wt.indexOf(fn)!==-1&&hr!==fn?Rr=!0:Qe[ht][Ft]!==hr&&(_r=!1)}_r&&(an&&(rt[We[0]._name].type="linear"),Rr&&(rt[Qe[0]._name].type="linear"),Vt(rt,Ft,We,Qe,_e._fullLayout._dfltTitle))}}for($e=0;$e<_e._fullLayout.annotations.length;$e++){var xr=_e._fullLayout.annotations[$e];Me.indexOf(xr.xref)!==-1&&Ne.indexOf(xr.yref)!==-1&&e.swapAttrs(rt.annotations[$e],["?"])}}function Vt(_e,Me,Ne,We,Qe){var rt=e.nestedProperty,$e=rt(_e[Ne[0]._name],Me).get(),ht=rt(_e[We[0]._name],Me).get(),xt;for(Me==="title"&&($e&&$e.text===Qe.x&&($e.text=Qe.y),ht&&ht.text===Qe.y&&(ht.text=Qe.x)),xt=0;xt<Ne.length;xt++)rt(_e,Ne[xt]._name+"."+Me).set(ht);for(xt=0;xt<We.length;xt++)rt(_e,We[xt]._name+"."+Me).set($e)}function jt(_e){return _e._id==="angularaxis"}function Ut(_e,Me){for(var Ne=Me._rangebreaks.length,We=0;We<Ne;We++){var Qe=Me._rangebreaks[We];if(_e>=Qe.min&&_e<Qe.max)return Qe.max}return _e}function yr(_e){return(_e.ticklabelposition||"").indexOf("inside")!==-1}function nt(_e,Me){yr(_e._anchorAxis||{})&&_e._hideCounterAxisInsideTickLabels&&_e._hideCounterAxisInsideTickLabels(Me)}},{"../../components/color":366,"../../components/drawing":388,"../../components/titles":464,"../../constants/alignment":471,"../../constants/numerical":479,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../../registry":638,"./autorange":553,"./axis_autotype":555,"./axis_ids":558,"./clean_ticks":560,"./layout_attributes":569,"./set_convert":576,"@plotly/d3":58,"fast-isnumeric":190}],555:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("../../constants/numerical").BADNUM,T=c.isArrayOrTypedArray,e=c.isDateTime,a=c.cleanNumber,n=Math.round;re.exports=function(y,h,m){var u=y,_=m.noMultiCategory;if(T(u)&&!u.length)return"-";if(!_&&g(u))return"multicategory";if(_&&Array.isArray(u[0])){for(var s=[],A=0;A<u.length;A++)if(T(u[A]))for(var x=0;x<u[A].length;x++)s.push(u[A][x]);u=s}if(f(u,h))return"date";var v=m.autotypenumbers!=="strict";return i(u,v)?"category":t(u,v)?"linear":"-"};function r(p,y){return y?w(p):typeof p=="number"}function t(p,y){for(var h=p.length,m=0;m<h;m++)if(r(p[m],y))return!0;return!1}function f(p,y){for(var h=p.length,m=o(h),u=0,_=0,s={},A=0;A<h;A+=m){var x=n(A),v=p[x],b=String(v);s[b]||(s[b]=1,e(v,y)&&u++,w(v)&&_++)}return u>_*2}function o(p){return Math.max(1,(p-1)/1e3)}function i(p,y){for(var h=p.length,m=o(h),u=0,_=0,s={},A=0;A<h;A+=m){var x=n(A),v=p[x],b=String(v);if(!s[b]){s[b]=1;var l=typeof v;l==="boolean"?_++:(y?a(v)!==M:l==="number")?u++:l==="string"&&_++}}return _>u*2}function g(p){return T(p[0])&&T(p[1])}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],556:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../registry"),M=d("../../lib"),T=d("../array_container_defaults"),e=d("./layout_attributes"),a=d("./tick_value_defaults"),n=d("./tick_mark_defaults"),r=d("./tick_label_defaults"),t=d("./prefix_suffix_defaults"),f=d("./category_order_defaults"),o=d("./line_grid_defaults"),i=d("./set_convert"),g=d("./constants").WEEKDAY_PATTERN,p=d("./constants").HOUR_PATTERN;re.exports=function(_,s,A,x,v){var b=x.letter,l=x.font||{},L=x.splomStash||{},S=A("visible",!x.visibleDflt),k=s._template||{},P=s.type||k.type||"-",z;if(P==="date"){var I=c.getComponentMethod("calendars","handleDefaults");I(_,s,"calendar",x.calendar),x.noTicklabelmode||(z=A("ticklabelmode"))}var D="";(!x.noTicklabelposition||P==="multicategory")&&(D=M.coerce(_,s,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:z==="period"?["outside","inside"]:b==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),x.noTicklabeloverflow||A("ticklabeloverflow",D.indexOf("inside")!==-1?"hide past domain":P==="category"||P==="multicategory"?"allow":"hide past div"),i(s,v);var R=!s.isValidRange(_.range);R&&x.reverseDflt&&(R="reversed");var B=A("autorange",R);B&&(P==="linear"||P==="-")&&A("rangemode"),A("range"),s.cleanRange(),f(_,s,A,x),P!=="category"&&!x.noHover&&A("hoverformat");var F=A("color"),V=F!==e.color.dflt?F:l.color,G=L.label||v._dfltTitle[b];if(t(_,s,A,P,x),!S)return s;A("title.text",G),M.coerceFont(A,"title.font",{family:l.family,size:M.bigFont(l.size),color:V}),a(_,s,A,P),r(_,s,A,P,x),n(_,s,A,x),o(_,s,A,{dfltColor:F,bgColor:x.bgColor,showGrid:x.showGrid,attributes:e}),(s.showline||s.ticks)&&A("mirror"),x.automargin&&A("automargin");var J=P==="multicategory";if(!x.noTickson&&(P==="category"||J)&&(s.ticks||s.showgrid)){var j;J&&(j="boundaries");var Y=A("tickson",j);Y==="boundaries"&&delete s.ticklabelposition}if(J){var X=A("showdividers");X&&(A("dividercolor"),A("dividerwidth"))}if(P==="date")if(T(_,s,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:y}),!s.rangebreaks.length)delete s.rangebreaks;else{for(var oe=0;oe<s.rangebreaks.length;oe++)if(s.rangebreaks[oe].pattern===g){s._hasDayOfWeekBreaks=!0;break}if(i(s,v),v._has("scattergl")||v._has("splom"))for(var se=0;se<x.data.length;se++){var ie=x.data[se];(ie.type==="scattergl"||ie.type==="splom")&&(ie.visible=!1,M.warn(ie.type+" traces do not work on axes with rangebreaks. Setting trace "+ie.index+" to `visible: false`."))}}return s};function y(u,_,s){function A(z,I){return M.coerce(u,_,e.rangebreaks,z,I)}var x=A("enabled");if(x){var v=A("bounds");if(v&&v.length>=2){var b="",l,L;if(v.length===2){for(l=0;l<2;l++)if(L=m(v[l]),L){b=g;break}}var S=A("pattern",b);if(S===g)for(l=0;l<2;l++)L=m(v[l]),L&&(_.bounds[l]=v[l]=L-1);if(S)for(l=0;l<2;l++)switch(L=v[l],S){case g:if(!w(L)){_.enabled=!1;return}if(L=+L,L!==Math.floor(L)||L<0||L>=7){_.enabled=!1;return}_.bounds[l]=v[l]=L;break;case p:if(!w(L)){_.enabled=!1;return}if(L=+L,L<0||L>24){_.enabled=!1;return}_.bounds[l]=v[l]=L;break}if(s.autorange===!1){var k=s.range;if(k[0]<k[1]){if(v[0]<k[0]&&v[1]>k[1]){_.enabled=!1;return}}else if(v[0]>k[0]&&v[1]<k[1]){_.enabled=!1;return}}}else{var P=A("values");if(P&&P.length)A("dvalue");else{_.enabled=!1;return}}}}var h={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function m(u){if(typeof u=="string")return h[u.substr(0,3).toLowerCase()]}},{"../../lib":503,"../../registry":638,"../array_container_defaults":549,"./category_order_defaults":559,"./constants":561,"./layout_attributes":569,"./line_grid_defaults":571,"./prefix_suffix_defaults":573,"./set_convert":576,"./tick_label_defaults":578,"./tick_mark_defaults":579,"./tick_value_defaults":580,"fast-isnumeric":190}],557:[function(d,re,ne){var w=d("../../constants/docs"),c=w.FORMAT_LINK,M=w.DATE_FORMAT_LINK;function T(n,r){return{valType:"string",dflt:"",editType:"none",description:(r?e:a)("hover text",n)+["By default the values are formatted using "+(r?"generic number format":"`"+n+"axis.hoverformat`")+"."].join(" ")}}function e(n,r){return["Sets the "+n+" formatting rule"+(r?"for `"+r+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+c+"."].join(" ")}function a(n,r){return e(n,r)+[" And for dates see: "+M+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}re.exports={axisHoverFormat:T,descriptionOnlyNumbers:e,descriptionWithDates:a}},{"../../constants/docs":474}],558:[function(d,re,ne){var w=d("../../registry"),c=d("./constants");ne.id2name=function(e){if(!(typeof e!="string"||!e.match(c.AX_ID_PATTERN))){var a=e.split(" ")[0].substr(1);return a==="1"&&(a=""),e.charAt(0)+"axis"+a}},ne.name2id=function(e){if(!!e.match(c.AX_NAME_PATTERN)){var a=e.substr(5);return a==="1"&&(a=""),e.charAt(0)+a}},ne.cleanId=function(e,a,n){var r=/( domain)$/.test(e);if(!(typeof e!="string"||!e.match(c.AX_ID_PATTERN))&&!(a&&e.charAt(0)!==a)&&!(r&&!n)){var t=e.split(" ")[0].substr(1).replace(/^0+/,"");return t==="1"&&(t=""),e.charAt(0)+t+(r&&n?" domain":"")}},ne.list=function(T,e,a){var n=T._fullLayout;if(!n)return[];var r=ne.listIds(T,e),t=new Array(r.length),f;for(f=0;f<r.length;f++){var o=r[f];t[f]=n[o.charAt(0)+"axis"+o.substr(1)]}if(!a){var i=n._subplots.gl3d||[];for(f=0;f<i.length;f++){var g=n[i[f]];e?t.push(g[e+"axis"]):t.push(g.xaxis,g.yaxis,g.zaxis)}}return t},ne.listIds=function(T,e){var a=T._fullLayout;if(!a)return[];var n=a._subplots;return e?n[e+"axis"]:n.xaxis.concat(n.yaxis)},ne.getFromId=function(T,e,a){var n=T._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),a==="x"?e=e.replace(/y[0-9]*/,""):a==="y"&&(e=e.replace(/x[0-9]*/,"")),n[ne.id2name(e)]},ne.getFromTrace=function(T,e,a){var n=T._fullLayout,r=null;if(w.traceIs(e,"gl3d")){var t=e.scene;t.substr(0,5)==="scene"&&(r=n[t][a+"axis"])}else r=ne.getFromId(T,e[a+"axis"]||a);return r},ne.idSort=function(T,e){var a=T.charAt(0),n=e.charAt(0);return a!==n?a>n?1:-1:+(T.substr(1)||1)-+(e.substr(1)||1)},ne.ref2id=function(T){return/^[xyz]/.test(T)?T.split(" ")[0]:!1};function M(T,e){if(e&&e.length){for(var a=0;a<e.length;a++)if(e[a][T])return!0}return!1}ne.isLinked=function(T,e){return M(e,T._axisMatchGroups)||M(e,T._axisConstraintGroups)}},{"../../registry":638,"./constants":561}],559:[function(d,re,ne){function w(c,M){var T=M.dataAttr||c._id.charAt(0),e={},a,n,r;if(M.axData)a=M.axData;else for(a=[],n=0;n<M.data.length;n++){var t=M.data[n];t[T+"axis"]===c._id&&a.push(t)}for(n=0;n<a.length;n++){var f=a[n][T];for(r=0;r<f.length;r++){var o=f[r];o!=null&&(e[o]=1)}}return Object.keys(e)}re.exports=function(M,T,e,a){if(T.type==="category"){var n=M.categoryarray,r=Array.isArray(n)&&n.length>0,t;r&&(t="array");var f=e("categoryorder",t),o;f==="array"&&(o=e("categoryarray")),!r&&f==="array"&&(f=T.categoryorder="trace"),f==="trace"?T._initialCategories=[]:f==="array"?T._initialCategories=o.slice():(o=w(T,a).sort(),f==="category ascending"?T._initialCategories=o:f==="category descending"&&(T._initialCategories=o.reverse()))}}},{}],560:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("../../constants/numerical"),T=M.ONEDAY,e=M.ONEWEEK;ne.dtick=function(a,n){var r=n==="log",t=n==="date",f=n==="category",o=t?T:1;if(!a)return o;if(w(a))return a=Number(a),a<=0?o:f?Math.max(1,Math.round(a)):t?Math.max(.1,a):a;if(typeof a!="string"||!(t||r))return o;var i=a.charAt(0),g=a.substr(1);return g=w(g)?Number(g):0,g<=0||!(t&&i==="M"&&g===Math.round(g)||r&&i==="L"||r&&i==="D"&&(g===1||g===2))?o:a},ne.tick0=function(a,n,r,t){if(n==="date")return c.cleanDate(a,c.dateTick0(r,t%e===0?1:0));if(!(t==="D1"||t==="D2"))return w(a)?Number(a):0}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],561:[function(d,re,ne){var w=d("../../lib/regex").counter;re.exports={idRegex:{x:w("x","( domain)?"),y:w("y","( domain)?")},attrRegex:w("[xy]axis"),xAxisMatch:w("xaxis"),yAxisMatch:w("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":520}],562:[function(d,re,ne){var w=d("../../lib"),c=d("./autorange"),M=d("./axis_ids").id2name,T=d("./layout_attributes"),e=d("./scale_zoom"),a=d("./set_convert"),n=d("../../constants/numerical").ALMOST_EQUAL,r=d("../../constants/alignment").FROM_BL;ne.handleDefaults=function(h,m,u){var _=u.axIds,s=u.axHasImage,A=m._axisConstraintGroups=[],x=m._axisMatchGroups=[],v,b,l,L,S,k,P,z;for(v=0;v<_.length;v++)L=M(_[v]),S=h[L],k=m[L],t(S,k,{axIds:_,layoutOut:m,hasImage:s[L]});function I(Y,X){for(v=0;v<Y.length;v++){b=Y[v];for(l in b)m[M(l)][X]=b}}for(I(x,"_matchGroup"),v=0;v<A.length;v++){b=A[v];for(l in b)if(k=m[M(l)],k.fixedrange){for(var D in b){var R=M(D);(h[R]||{}).fixedrange===!1&&w.warn("fixedrange was specified as false for axis "+R+" but was overridden because another axis in its constraint group has fixedrange true"),m[R].fixedrange=!0}break}}for(v=0;v<A.length;){b=A[v];for(l in b){k=m[M(l)],k._matchGroup&&Object.keys(k._matchGroup).length===Object.keys(b).length&&(A.splice(v,1),v--);break}v++}I(A,"_constraintGroup");var B=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],F=!1,V=!1;function G(){z=k[P],P==="rangebreaks"&&(V=k._hasDayOfWeekBreaks)}for(v=0;v<x.length;v++){b=x[v];for(var J=0;J<B.length;J++){P=B[J],z=null;var j;for(l in b)if(L=M(l),S=h[L],k=m[L],P in k){if(!k.matches&&(j=k,P in S)){G();break}z===null&&P in S&&G()}if(P==="range"&&z&&(F=!0),P==="autorange"&&z===null&&F&&(z=!1),z===null&&P in j&&(z=j[P]),z!==null)for(l in b)k=m[M(l)],k[P]=P==="range"?z.slice():z,P==="rangebreaks"&&(k._hasDayOfWeekBreaks=V,a(k,m))}}};function t(h,m,u){var _=u.axIds,s=u.layoutOut,A=u.hasImage,x=s._axisConstraintGroups,v=s._axisMatchGroups,b=m._id,l=b.charAt(0),L=((s._splomAxes||{})[l]||{})[b]||{},S=m._id,k=S.charAt(0)==="x";m._matchGroup=null,m._constraintGroup=null;function P(ie,N){return w.coerce(h,m,T,ie,N)}P("constrain",A?"domain":"range"),w.coerce(h,m,{constraintoward:{valType:"enumerated",values:k?["left","center","right"]:["bottom","middle","top"],dflt:k?"center":"middle"}},"constraintoward");var z=m.type,I,D,R=[];for(I=0;I<_.length;I++)if(D=_[I],D!==S){var B=s[M(D)];B.type===z&&R.push(D)}var F=o(x,S);if(F){var V=[];for(I=0;I<R.length;I++)D=R[I],F[D]||V.push(D);R=V}var G=R.length,J,j;G&&(h.matches||L.matches)&&(J=w.coerce(h,m,{matches:{valType:"enumerated",values:R,dflt:R.indexOf(L.matches)!==-1?L.matches:void 0}},"matches"));var Y=A&&!k?m.anchor:void 0;if(G&&!J&&(h.scaleanchor||Y)&&(j=w.coerce(h,m,{scaleanchor:{valType:"enumerated",values:R}},"scaleanchor",Y)),J){m._matchGroup=i(v,S,J,1);var X=s[M(J)],oe=f(s,m)/f(s,X);k!==(J.charAt(0)==="x")&&(oe=(k?"x":"y")+oe),i(x,S,J,oe)}else h.matches&&_.indexOf(h.matches)!==-1&&w.warn("ignored "+m._name+'.matches: "'+h.matches+'" to avoid an infinite loop');if(j){var se=P("scaleratio");se||(se=m.scaleratio=1),i(x,S,j,se)}else h.scaleanchor&&_.indexOf(h.scaleanchor)!==-1&&w.warn("ignored "+m._name+'.scaleanchor: "'+h.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function f(h,m){var u=m.domain;return u||(u=h[M(m.overlaying)].domain),u[1]-u[0]}function o(h,m){for(var u=0;u<h.length;u++)if(h[u][m])return h[u];return null}function i(h,m,u,_){var s,A,x,v,b,l=o(h,m);l===null?(l={},l[m]=1,b=h.length,h.push(l)):b=h.indexOf(l);var L=Object.keys(l);for(s=0;s<h.length;s++)if(x=h[s],s!==b&&x[u]){var S=x[u];for(A=0;A<L.length;A++)v=L[A],x[v]=g(S,g(_,l[v]));h.splice(b,1);return}if(_!==1)for(A=0;A<L.length;A++){var k=L[A];l[k]=g(_,l[k])}l[u]=1}function g(h,m){var u="",_="",s,A;typeof h=="string"&&(u=h.match(/^[xy]*/)[0],s=u.length,h=+h.substr(s)),typeof m=="string"&&(_=m.match(/^[xy]*/)[0],A=_.length,m=+m.substr(A));var x=h*m;return!s&&!A?x:!s||!A||u.charAt(0)===_.charAt(0)?u+_+h*m:s===A?x:(s>A?u.substr(A):_.substr(s))+x}function p(h,m){for(var u=m._size,_=u.h/u.w,s={},A=Object.keys(h),x=0;x<A.length;x++){var v=A[x],b=h[v];if(typeof b=="string"){var l=b.match(/^[xy]*/)[0],L=l.length;b=+b.substr(L);for(var S=l.charAt(0)==="y"?_:1/_,k=0;k<L;k++)b*=S}s[v]=b}return s}ne.enforce=function(m){var u=m._fullLayout,_=u._axisConstraintGroups||[],s,A,x,v,b,l,L,S;for(s=0;s<_.length;s++){x=p(_[s],u);var k=Object.keys(x),P=1/0,z=0,I=1/0,D={},R={},B=!1;for(A=0;A<k.length;A++)v=k[A],R[v]=b=u[M(v)],b._inputDomain?b.domain=b._inputDomain.slice():b._inputDomain=b.domain.slice(),b._inputRange||(b._inputRange=b.range.slice()),b.setScale(),D[v]=l=Math.abs(b._m)/x[v],P=Math.min(P,l),(b.constrain==="domain"||!b._constraintShrinkable)&&(I=Math.min(I,l)),delete b._constraintShrinkable,z=Math.max(z,l),b.constrain==="domain"&&(B=!0);if(!(P>n*z&&!B)){for(A=0;A<k.length;A++)if(v=k[A],l=D[v],b=R[v],L=b.constrain,l!==I||L==="domain")if(S=l/I,L==="range")e(b,S);else{var F=b._inputDomain,V=(b.domain[1]-b.domain[0])/(F[1]-F[0]),G=(b.r2l(b.range[1])-b.r2l(b.range[0]))/(b.r2l(b._inputRange[1])-b.r2l(b._inputRange[0]));if(S/=V,S*G<1){b.domain=b._input.domain=F.slice(),e(b,S);continue}if(G<1&&(b.range=b._input.range=b._inputRange.slice(),S*=G),b.autorange){var J=b.r2l(b.range[0]),j=b.r2l(b.range[1]),Y=(J+j)/2,X=Y,oe=Y,se=Math.abs(j-Y),ie=Y-se*S*1.0001,N=Y+se*S*1.0001,U=c.makePadFn(u,b,0),q=c.makePadFn(u,b,1);y(b,S);var Q=Math.abs(b._m),W=c.concatExtremes(m,b),Z=W.min,ee=W.max,te,ae;for(ae=0;ae<Z.length;ae++)te=Z[ae].val-U(Z[ae])/Q,te>ie&&te<X&&(X=te);for(ae=0;ae<ee.length;ae++)te=ee[ae].val+q(ee[ae])/Q,te<N&&te>oe&&(oe=te);var le=(oe-X)/(2*se);S/=le,X=b.l2r(X),oe=b.l2r(oe),b.range=b._input.range=J<j?[X,oe]:[oe,X]}y(b,S)}}}},ne.getAxisGroup=function(m,u){for(var _=m._axisMatchGroups,s=0;s<_.length;s++){var A=_[s];if(A[u])return"g"+s}return u},ne.clean=function(m,u){if(u._inputDomain){for(var _=!1,s=u._id,A=m._fullLayout._axisConstraintGroups,x=0;x<A.length;x++)if(A[x][s]){_=!0;break}(!_||u.constrain!=="domain")&&(u._input.domain=u.domain=u._inputDomain,delete u._inputDomain)}};function y(h,m){var u=h._inputDomain,_=r[h.constraintoward],s=u[0]+(u[1]-u[0])*_;h.domain=h._input.domain=[s+(u[0]-s)/m,s+(u[1]-s)/m],h.setScale()}},{"../../constants/alignment":471,"../../constants/numerical":479,"../../lib":503,"./autorange":553,"./axis_ids":558,"./layout_attributes":569,"./scale_zoom":574,"./set_convert":576}],563:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=c.numberFormat,T=d("tinycolor2"),e=d("has-passive-events"),a=d("../../registry"),n=c.strTranslate,r=d("../../lib/svg_text_utils"),t=d("../../components/color"),f=d("../../components/drawing"),o=d("../../components/fx"),i=d("./axes"),g=d("../../lib/setcursor"),p=d("../../components/dragelement"),y=d("../../components/dragelement/helpers"),h=y.selectingOrDrawing,m=y.freeMode,u=d("../../constants/alignment").FROM_TL,_=d("../../lib/clear_gl_canvases"),s=d("../../plot_api/subroutines").redrawReglTraces,A=d("../plots"),x=d("./axis_ids").getFromId,v=d("./select").prepSelect,b=d("./select").clearSelect,l=d("./select").selectOnClick,L=d("./scale_zoom"),S=d("./constants"),k=S.MINDRAG,P=S.MINZOOM,z=!0;function I(te,ae,le,ye,fe,pe,ge,Ae){var we=te._fullLayout._zoomlayer,De=ge+Ae==="nsew",Be=(ge+Ae).length===1,Ve,xe,Le,He,Je,Oe,Pe,Ue,vt,Lt,Yt,At,Rt,Bt,Mt,Tt,at,ct,je,ke,Ye,Ke,st;function Et(){if(Ve=ae.xaxis,xe=ae.yaxis,vt=Ve._length,Lt=xe._length,Pe=Ve._offset,Ue=xe._offset,Le={},Le[Ve._id]=Ve,He={},He[xe._id]=xe,ge&&Ae)for(var Rr=ae.overlays,Vr=0;Vr<Rr.length;Vr++){var fn=Rr[Vr].xaxis;Le[fn._id]=fn;var xr=Rr[Vr].yaxis;He[xr._id]=xr}Je=ee(Le),Oe=ee(He),Rt=B(Je,Ae),Bt=B(Oe,ge),Mt=!Bt&&!Rt,At=W(te,te._fullLayout._axisMatchGroups,Le,He),Yt=W(te,te._fullLayout._axisConstraintGroups,Le,He,At);var mr=Yt.isSubplotConstrained||At.isSubplotConstrained;Tt=Ae||mr,at=ge||mr;var Fr=te._fullLayout;ct=Fr._has("scattergl"),je=Fr._has("splom"),ke=Fr._has("svg")}Et();var bt=j(Bt+Rt,te._fullLayout.dragmode,De),zt=R(ae,ge+Ae+"drag",bt,le,ye,fe,pe);if(Mt&&!De)return zt.onmousedown=null,zt.style.pointerEvents="none",zt;var $t={element:zt,gd:te,plotinfo:ae};$t.prepFn=function(Rr,Vr,fn){var xr=$t.dragmode,mr=te._fullLayout.dragmode;mr!==xr&&($t.dragmode=mr),Et(),Ke=te._fullLayout._invScaleX,st=te._fullLayout._invScaleY,Mt||(De?Rr.shiftKey?mr==="pan"?mr="zoom":h(mr)||(mr="pan"):Rr.ctrlKey&&(mr="pan"):mr="pan"),m(mr)?$t.minDrag=1:$t.minDrag=void 0,h(mr)?($t.xaxes=Je,$t.yaxes=Oe,v(Rr,Vr,fn,$t,mr)):($t.clickFn=Qt,h(xr)&&Ot(),Mt||(mr==="zoom"?($t.moveFn=nt,$t.doneFn=Me,$t.minDrag=1,yr(Rr,Vr,fn)):mr==="pan"&&($t.moveFn=ht,$t.doneFn=Ft))),te._fullLayout._redrag=function(){var Fr=te._dragdata;if(Fr&&Fr.element===zt){var Ir=te._fullLayout.dragmode;h(Ir)||(Et(),ir([0,0,vt,Lt]),$t.moveFn(Fr.dx,Fr.dy))}}};function Ot(){$t.plotinfo.selection=!1,b(te)}function Qt(Rr,Vr){var fn=$t.gd;if(fn._fullLayout._activeShapeIndex>=0){fn._fullLayout._deactivateShape(fn);return}var xr=fn._fullLayout.clickmode;if(ie(fn),Rr===2&&!Be&&Wt(),De)xr.indexOf("select")>-1&&l(Vr,fn,Je,Oe,ae.id,$t),xr.indexOf("event")>-1&&o.click(fn,Vr,ae.id);else if(Rr===1&&Be){var mr=ge?xe:Ve,Fr=ge==="s"||Ae==="w"?0:1,Ir=mr._name+".range["+Fr+"]",Sr=F(mr,Fr),tt="left",Ct="middle";if(mr.fixedrange)return;ge?(Ct=ge==="n"?"top":"bottom",mr.side==="right"&&(tt="right")):Ae==="e"&&(tt="right"),fn._context.showAxisRangeEntryBoxes&&w.select(zt).call(r.makeEditable,{gd:fn,immediate:!0,background:fn._fullLayout.paper_bgcolor,text:String(Sr),fill:mr.tickfont?mr.tickfont.color:"#444",horizontalAlign:tt,verticalAlign:Ct}).on("edit",function(Zt){var ur=mr.d2r(Zt);ur!==void 0&&a.call("_guiRelayout",fn,Ir,ur)})}}p.init($t);var tr,qt,lr,Wr,cn,Jr,ot,Vt,jt,Ut;function yr(Rr,Vr,fn){var xr=zt.getBoundingClientRect();tr=Vr-xr.left,qt=fn-xr.top,te._fullLayout._calcInverseTransform(te);var mr=c.apply3DTransform(te._fullLayout._invTransform)(tr,qt);tr=mr[0],qt=mr[1],lr={l:tr,r:tr,w:0,t:qt,b:qt,h:0},Wr=te._hmpixcount?te._hmlumcount/te._hmpixcount:T(te._fullLayout.plot_bgcolor).getLuminance(),cn="M0,0H"+vt+"V"+Lt+"H0V0",Jr=!1,ot="xy",Ut=!1,Vt=Y(we,Wr,Pe,Ue,cn),jt=X(we,Pe,Ue)}function nt(Rr,Vr){if(te._transitioningWithDuration)return!1;var fn=Math.max(0,Math.min(vt,Ke*Rr+tr)),xr=Math.max(0,Math.min(Lt,st*Vr+qt)),mr=Math.abs(fn-tr),Fr=Math.abs(xr-qt);lr.l=Math.min(tr,fn),lr.r=Math.max(tr,fn),lr.t=Math.min(qt,xr),lr.b=Math.max(qt,xr);function Ir(){ot="",lr.r=lr.l,lr.t=lr.b,jt.attr("d","M0,0Z")}if(Yt.isSubplotConstrained)mr>P||Fr>P?(ot="xy",mr/vt>Fr/Lt?(Fr=mr*Lt/vt,qt>xr?lr.t=qt-Fr:lr.b=qt+Fr):(mr=Fr*vt/Lt,tr>fn?lr.l=tr-mr:lr.r=tr+mr),jt.attr("d",Q(lr))):Ir();else if(At.isSubplotConstrained)if(mr>P||Fr>P){ot="xy";var Sr=Math.min(lr.l/vt,(Lt-lr.b)/Lt),tt=Math.max(lr.r/vt,(Lt-lr.t)/Lt);lr.l=Sr*vt,lr.r=tt*vt,lr.b=(1-Sr)*Lt,lr.t=(1-tt)*Lt,jt.attr("d",Q(lr))}else Ir();else!Bt||Fr<Math.min(Math.max(mr*.6,k),P)?mr<k||!Rt?Ir():(lr.t=0,lr.b=Lt,ot="x",jt.attr("d",U(lr,qt))):!Rt||mr<Math.min(Fr*.6,P)?(lr.l=0,lr.r=vt,ot="y",jt.attr("d",q(lr,tr))):(ot="xy",jt.attr("d",Q(lr)));lr.w=lr.r-lr.l,lr.h=lr.b-lr.t,ot&&(Ut=!0),te._dragged=Ut,oe(Vt,jt,lr,cn,Jr,Wr),_e(),te.emit("plotly_relayouting",Ye),Jr=!0}function _e(){Ye={},(ot==="xy"||ot==="x")&&(V(Je,lr.l/vt,lr.r/vt,Ye,Yt.xaxes),xt("x",Ye)),(ot==="xy"||ot==="y")&&(V(Oe,(Lt-lr.b)/Lt,(Lt-lr.t)/Lt,Ye,Yt.yaxes),xt("y",Ye))}function Me(){_e(),ie(te),Ft(),N(te)}var Ne=[0,0,vt,Lt],We=null,Qe=S.REDRAWDELAY,rt=ae.mainplot?te._fullLayout._plots[ae.mainplot]:ae;function $e(Rr){if(!te._context._scrollZoom.cartesian&&!te._fullLayout._enablescrollzoom)return;if(Ot(),te._transitioningWithDuration){Rr.preventDefault(),Rr.stopPropagation();return}Et(),clearTimeout(We);var Vr=-Rr.deltaY;if(isFinite(Vr)||(Vr=Rr.wheelDelta/10),!isFinite(Vr)){c.log("Did not find wheel motion attributes: ",Rr);return}var fn=Math.exp(-Math.min(Math.max(Vr,-20),20)/200),xr=rt.draglayer.select(".nsewdrag").node().getBoundingClientRect(),mr=(Rr.clientX-xr.left)/xr.width,Fr=(xr.bottom-Rr.clientY)/xr.height,Ir;function Sr(tt,Ct,Zt){if(tt.fixedrange)return;var ur=c.simpleMap(tt.range,tt.r2l),Lr=ur[0]+(ur[1]-ur[0])*Ct;function Br(Pr){return tt.l2r(Lr+(Pr-Lr)*Zt)}tt.range=ur.map(Br)}if(Tt){for(Ae||(mr=.5),Ir=0;Ir<Je.length;Ir++)Sr(Je[Ir],mr,fn);xt("x"),Ne[2]*=fn,Ne[0]+=Ne[2]*mr*(1/fn-1)}if(at){for(ge||(Fr=.5),Ir=0;Ir<Oe.length;Ir++)Sr(Oe[Ir],Fr,fn);xt("y"),Ne[3]*=fn,Ne[1]+=Ne[3]*(1-Fr)*(1/fn-1)}ir(Ne),kt(),te.emit("plotly_relayouting",Ye),We=setTimeout(function(){!te._fullLayout||(Ne=[0,0,vt,Lt],Ft())},Qe),Rr.preventDefault()}ge.length*Ae.length!==1&&Z(zt,$e);function ht(Rr,Vr){if(Rr=Rr*Ke,Vr=Vr*st,te._transitioningWithDuration)return;if(te._fullLayout._replotting=!0,Rt==="ew"||Bt==="ns"){var fn=Rt?-Rr:0,xr=Bt?-Vr:0;if(At.isSubplotConstrained){if(Rt&&Bt){var mr=(Rr/vt-Vr/Lt)/2;Rr=mr*vt,Vr=-mr*Lt,fn=-Rr,xr=-Vr}Bt?fn=-xr*vt/Lt:xr=-fn*Lt/vt}Rt&&(G(Je,Rr),xt("x")),Bt&&(G(Oe,Vr),xt("y")),ir([fn,xr,vt,Lt]),kt(),te.emit("plotly_relayouting",Ye);return}function Fr(Br,Pr,Tr){for(var jr=1-Pr,Pn,An,$n=0;$n<Br.length;$n++){var zn=Br[$n];if(!zn.fixedrange){Pn=zn,An=zn._rl[jr]+(zn._rl[Pr]-zn._rl[jr])/J(Tr/zn._length);var Yn=zn.l2r(An);Yn!==!1&&Yn!==void 0&&(zn.range[Pr]=Yn)}}return Pn._length*(Pn._rl[Pr]-An)/(Pn._rl[Pr]-Pn._rl[jr])}var Ir=Rt==="w"==(Bt==="n")?1:-1;if(Rt&&Bt&&(Yt.isSubplotConstrained||At.isSubplotConstrained)){var Sr=(Rr/vt+Ir*Vr/Lt)/2;Rr=Sr*vt,Vr=Ir*Sr*Lt}var tt,Ct;if(Rt==="w"?Rr=Fr(Je,0,Rr):Rt==="e"?Rr=Fr(Je,1,-Rr):Rt||(Rr=0),Bt==="n"?Vr=Fr(Oe,1,Vr):Bt==="s"?Vr=Fr(Oe,0,-Vr):Bt||(Vr=0),tt=Rt==="w"?Rr:0,Ct=Bt==="n"?Vr:0,Yt.isSubplotConstrained&&!At.isSubplotConstrained||At.isSubplotConstrained&&Rt&&Bt&&Ir>0){var Zt;if(At.isSubplotConstrained||!Rt&&Bt.length===1){for(Zt=0;Zt<Je.length;Zt++)Je[Zt].range=Je[Zt]._r.slice(),L(Je[Zt],1-Vr/Lt);Rr=Vr*vt/Lt,tt=Rr/2}if(At.isSubplotConstrained||!Bt&&Rt.length===1){for(Zt=0;Zt<Oe.length;Zt++)Oe[Zt].range=Oe[Zt]._r.slice(),L(Oe[Zt],1-Rr/vt);Vr=Rr*Lt/vt,Ct=Vr/2}}(!At.isSubplotConstrained||!Bt)&&xt("x"),(!At.isSubplotConstrained||!Rt)&&xt("y");var ur=vt-Rr,Lr=Lt-Vr;At.isSubplotConstrained&&!(Rt&&Bt)&&(Rt?(Ct=tt?0:Rr*Lt/vt,Lr=ur*Lt/vt):(tt=Ct?0:Vr*vt/Lt,ur=Lr*vt/Lt)),ir([tt,Ct,ur,Lr]),kt(),te.emit("plotly_relayouting",Ye)}function xt(Rr,Vr){for(var fn=At.isSubplotConstrained?{x:Oe,y:Je}[Rr]:At[Rr+"axes"],xr=At.isSubplotConstrained?{x:Je,y:Oe}[Rr]:[],mr=0;mr<fn.length;mr++){var Fr=fn[mr],Ir=Fr._id,Sr=At.xLinks[Ir]||At.yLinks[Ir],tt=xr[0]||Le[Sr]||He[Sr];tt&&(Vr?(Vr[Fr._name+".range[0]"]=Vr[tt._name+".range[0]"],Vr[Fr._name+".range[1]"]=Vr[tt._name+".range[1]"]):Fr.range=tt.range.slice())}}function kt(){var Rr=[],Vr;function fn(Fr){for(Vr=0;Vr<Fr.length;Vr++)Fr[Vr].fixedrange||Rr.push(Fr[Vr]._id)}for(Tt&&(fn(Je),fn(Yt.xaxes),fn(At.xaxes)),at&&(fn(Oe),fn(Yt.yaxes),fn(At.yaxes)),Ye={},Vr=0;Vr<Rr.length;Vr++){var xr=Rr[Vr],mr=x(te,xr);i.drawOne(te,mr,{skipTitle:!0}),Ye[mr._name+".range[0]"]=mr.range[0],Ye[mr._name+".range[1]"]=mr.range[1]}i.redrawComponents(te,Rr)}function Wt(){if(!te._transitioningWithDuration){var Rr=te._context.doubleClick,Vr=[];Rt&&(Vr=Vr.concat(Je)),Bt&&(Vr=Vr.concat(Oe)),At.xaxes&&(Vr=Vr.concat(At.xaxes)),At.yaxes&&(Vr=Vr.concat(At.yaxes));var fn={},xr,mr,Fr;if(Rr==="reset+autosize"){for(Rr="autosize",mr=0;mr<Vr.length;mr++)if(xr=Vr[mr],xr._rangeInitial&&(xr.range[0]!==xr._rangeInitial[0]||xr.range[1]!==xr._rangeInitial[1])||!xr._rangeInitial&&!xr.autorange){Rr="reset";break}}if(Rr==="autosize")for(mr=0;mr<Vr.length;mr++)xr=Vr[mr],xr.fixedrange||(fn[xr._name+".autorange"]=!0);else if(Rr==="reset")for((Rt||Yt.isSubplotConstrained)&&(Vr=Vr.concat(Yt.xaxes)),Bt&&!Yt.isSubplotConstrained&&(Vr=Vr.concat(Yt.yaxes)),Yt.isSubplotConstrained&&(Rt?Bt||(Vr=Vr.concat(Oe)):Vr=Vr.concat(Je)),mr=0;mr<Vr.length;mr++)xr=Vr[mr],xr.fixedrange||(xr._rangeInitial?(Fr=xr._rangeInitial,fn[xr._name+".range[0]"]=Fr[0],fn[xr._name+".range[1]"]=Fr[1]):fn[xr._name+".autorange"]=!0);te.emit("plotly_doubleclick",null),a.call("_guiRelayout",te,fn)}}function Ft(){ir([0,0,vt,Lt]),c.syncOrAsync([A.previousPromises,function(){te._fullLayout._replotting=!1,a.call("_guiRelayout",te,Ye)}],te)}function ir(Rr){var Vr=te._fullLayout,fn=Vr._plots,xr=Vr._subplots.cartesian,mr,Fr,Ir,Sr;if(je&&a.subplotsRegistry.splom.drag(te),ct){for(mr=0;mr<xr.length;mr++)if(Fr=fn[xr[mr]],Ir=Fr.xaxis,Sr=Fr.yaxis,Fr._scene){var tt=c.simpleMap(Ir.range,Ir.r2l),Ct=c.simpleMap(Sr.range,Sr.r2l);Fr._scene.update({range:[tt[0],Ct[0],tt[1],Ct[1]]})}}if((je||ct)&&(_(te),s(te)),ke){var Zt=Rr[2]/Ve._length,ur=Rr[3]/xe._length;for(mr=0;mr<xr.length;mr++){Fr=fn[xr[mr]],Ir=Fr.xaxis,Sr=Fr.yaxis;var Lr=(Tt||At.isSubplotConstrained)&&!Ir.fixedrange&&Le[Ir._id],Br=(at||At.isSubplotConstrained)&&!Sr.fixedrange&&He[Sr._id],Pr,Tr,jr,Pn;if(Lr?(Pr=Zt,jr=Ae||At.isSubplotConstrained?Rr[0]:an(Ir,Pr)):At.xaHash[Ir._id]?(Pr=Zt,jr=Rr[0]*Ir._length/Ve._length):At.yaHash[Ir._id]?(Pr=ur,jr=Bt==="ns"?-Rr[1]*Ir._length/xe._length:an(Ir,Pr,{n:"top",s:"bottom"}[Bt])):(Pr=hr(Ir,Zt,ur),jr=_r(Ir,Pr)),Br?(Tr=ur,Pn=ge||At.isSubplotConstrained?Rr[1]:an(Sr,Tr)):At.yaHash[Sr._id]?(Tr=ur,Pn=Rr[1]*Sr._length/xe._length):At.xaHash[Sr._id]?(Tr=Zt,Pn=Rt==="ew"?-Rr[0]*Sr._length/Ve._length:an(Sr,Tr,{e:"right",w:"left"}[Rt])):(Tr=hr(Sr,Zt,ur),Pn=_r(Sr,Tr)),!(!Pr&&!Tr)){Pr||(Pr=1),Tr||(Tr=1);var An=Ir._offset-jr/Pr,$n=Sr._offset-Pn/Tr;Fr.clipRect.call(f.setTranslate,jr,Pn).call(f.setScale,Pr,Tr),Fr.plot.call(f.setTranslate,An,$n).call(f.setScale,1/Pr,1/Tr),(Pr!==Fr.xScaleFactor||Tr!==Fr.yScaleFactor)&&(f.setPointGroupScale(Fr.zoomScalePts,Pr,Tr),f.setTextPointsScale(Fr.zoomScaleTxt,Pr,Tr)),f.hideOutsideRangePoints(Fr.clipOnAxisFalseTraces,Fr),Fr.xScaleFactor=Pr,Fr.yScaleFactor=Tr}}}}function hr(Rr,Vr,fn){return Rr.fixedrange?0:Tt&&Yt.xaHash[Rr._id]?Vr:at&&(Yt.isSubplotConstrained?Yt.xaHash:Yt.yaHash)[Rr._id]?fn:0}function _r(Rr,Vr){return Vr?(Rr.range=Rr._r.slice(),L(Rr,Vr),an(Rr,Vr)):0}function an(Rr,Vr,fn){return Rr._length*(1-Vr)*u[fn||Rr.constraintoward||"middle"]}return zt}function D(te,ae,le,ye){var fe=c.ensureSingle(te.draglayer,ae,le,function(pe){pe.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",te.id)});return fe.call(g,ye),fe.node()}function R(te,ae,le,ye,fe,pe,ge){var Ae=D(te,"rect",ae,le);return w.select(Ae).call(f.setRect,ye,fe,pe,ge),Ae}function B(te,ae){for(var le=0;le<te.length;le++)if(!te[le].fixedrange)return ae;return""}function F(te,ae){var le=te.range[ae],ye=Math.abs(le-te.range[1-ae]),fe;return te.type==="date"?le:te.type==="log"?(fe=Math.ceil(Math.max(0,-Math.log(ye)/Math.LN10))+3,M("."+fe+"g")(Math.pow(10,le))):(fe=Math.floor(Math.log(Math.abs(le))/Math.LN10)-Math.floor(Math.log(ye)/Math.LN10)+4,M("."+String(fe)+"g")(le))}function V(te,ae,le,ye,fe){for(var pe=0;pe<te.length;pe++){var ge=te[pe];if(!ge.fixedrange)if(ge.rangebreaks){var Ae=ge._id.charAt(0)==="y",we=Ae?1-ae:ae,De=Ae?1-le:le;ye[ge._name+".range[0]"]=ge.l2r(ge.p2l(we*ge._length)),ye[ge._name+".range[1]"]=ge.l2r(ge.p2l(De*ge._length))}else{var Be=ge._rl[0],Ve=ge._rl[1]-Be;ye[ge._name+".range[0]"]=ge.l2r(Be+Ve*ae),ye[ge._name+".range[1]"]=ge.l2r(Be+Ve*le)}}if(fe&&fe.length){var xe=(ae+(1-le))/2;V(fe,xe,1-xe,ye,[])}}function G(te,ae){for(var le=0;le<te.length;le++){var ye=te[le];if(!ye.fixedrange)if(ye.rangebreaks){var fe=0,pe=ye._length,ge=ye.p2l(fe+ae)-ye.p2l(fe),Ae=ye.p2l(pe+ae)-ye.p2l(pe),we=(ge+Ae)/2;ye.range=[ye.l2r(ye._rl[0]-we),ye.l2r(ye._rl[1]-we)]}else ye.range=[ye.l2r(ye._rl[0]-ae/ye._m),ye.l2r(ye._rl[1]-ae/ye._m)]}}function J(te){return 1-(te>=0?Math.min(te,.9):1/(1/Math.max(te,-.3)+3.222))}function j(te,ae,le){return te?te==="nsew"?le?"":ae==="pan"?"move":"crosshair":te.toLowerCase()+"-resize":"pointer"}function Y(te,ae,le,ye,fe){return te.append("path").attr("class","zoombox").style({fill:ae>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",n(le,ye)).attr("d",fe+"Z")}function X(te,ae,le){return te.append("path").attr("class","zoombox-corners").style({fill:t.background,stroke:t.defaultLine,"stroke-width":1,opacity:0}).attr("transform",n(ae,le)).attr("d","M0,0Z")}function oe(te,ae,le,ye,fe,pe){te.attr("d",ye+"M"+le.l+","+le.t+"v"+le.h+"h"+le.w+"v-"+le.h+"h-"+le.w+"Z"),se(te,ae,fe,pe)}function se(te,ae,le,ye){le||(te.transition().style("fill",ye>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ae.transition().style("opacity",1).duration(200))}function ie(te){w.select(te).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function N(te){z&&te.data&&te._context.showTips&&(c.notifier(c._(te,"Double-click to zoom back out"),"long"),z=!1)}function U(te,ae){return"M"+(te.l-.5)+","+(ae-P-.5)+"h-3v"+(2*P+1)+"h3ZM"+(te.r+.5)+","+(ae-P-.5)+"h3v"+(2*P+1)+"h-3Z"}function q(te,ae){return"M"+(ae-P-.5)+","+(te.t-.5)+"v-3h"+(2*P+1)+"v3ZM"+(ae-P-.5)+","+(te.b+.5)+"v3h"+(2*P+1)+"v-3Z"}function Q(te){var ae=Math.floor(Math.min(te.b-te.t,te.r-te.l,P)/2);return"M"+(te.l-3.5)+","+(te.t-.5+ae)+"h3v"+-ae+"h"+ae+"v-3h-"+(ae+3)+"ZM"+(te.r+3.5)+","+(te.t-.5+ae)+"h-3v"+-ae+"h"+-ae+"v-3h"+(ae+3)+"ZM"+(te.r+3.5)+","+(te.b+.5-ae)+"h-3v"+ae+"h"+-ae+"v3h"+(ae+3)+"ZM"+(te.l-3.5)+","+(te.b+.5-ae)+"h3v"+ae+"h"+ae+"v3h-"+(ae+3)+"Z"}function W(te,ae,le,ye,fe){for(var pe=!1,ge={},Ae={},we,De,Be,Ve,xe=(fe||{}).xaHash,Le=(fe||{}).yaHash,He=0;He<ae.length;He++){var Je=ae[He];for(we in le)if(Je[we]){for(Be in Je)!(fe&&(xe[Be]||Le[Be]))&&!(Be.charAt(0)==="x"?le:ye)[Be]&&(ge[Be]=we);for(De in ye)!(fe&&(xe[De]||Le[De]))&&Je[De]&&(pe=!0)}for(De in ye)if(Je[De])for(Ve in Je)!(fe&&(xe[Ve]||Le[Ve]))&&!(Ve.charAt(0)==="x"?le:ye)[Ve]&&(Ae[Ve]=De)}pe&&(c.extendFlat(ge,Ae),Ae={});var Oe={},Pe=[];for(Be in ge){var Ue=x(te,Be);Pe.push(Ue),Oe[Ue._id]=Ue}var vt={},Lt=[];for(Ve in Ae){var Yt=x(te,Ve);Lt.push(Yt),vt[Yt._id]=Yt}return{xaHash:Oe,yaHash:vt,xaxes:Pe,yaxes:Lt,xLinks:ge,yLinks:Ae,isSubplotConstrained:pe}}function Z(te,ae){if(!e)te.onwheel!==void 0?te.onwheel=ae:te.onmousewheel!==void 0?te.onmousewheel=ae:te.isAddedWheelEvent||(te.isAddedWheelEvent=!0,te.addEventListener("wheel",ae,{passive:!1}));else{var le=te.onwheel!==void 0?"wheel":"mousewheel";te._onwheel&&te.removeEventListener(le,te._onwheel),te._onwheel=ae,te.addEventListener(le,ae,{passive:!1})}}function ee(te){var ae=[];for(var le in te)ae.push(te[le]);return ae}re.exports={makeDragBox:I,makeDragger:D,makeRectDragger:R,makeZoombox:Y,makeCorners:X,updateZoombox:oe,xyCorners:Q,transitionZoombox:se,removeZoombox:ie,showDoubleClickNotifier:N,attachWheelEventHandler:Z}},{"../../components/color":366,"../../components/dragelement":385,"../../components/dragelement/helpers":384,"../../components/drawing":388,"../../components/fx":406,"../../constants/alignment":471,"../../lib":503,"../../lib/clear_gl_canvases":487,"../../lib/setcursor":524,"../../lib/svg_text_utils":529,"../../plot_api/subroutines":544,"../../registry":638,"../plots":619,"./axes":554,"./axis_ids":558,"./constants":561,"./scale_zoom":574,"./select":575,"@plotly/d3":58,"has-passive-events":229,tinycolor2:312}],564:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/fx"),M=d("../../components/dragelement"),T=d("../../lib/setcursor"),e=d("./dragbox").makeDragBox,a=d("./constants").DRAGGERSIZE;ne.initInteractions=function(r){var t=r._fullLayout;if(r._context.staticPlot){w.select(r).selectAll(".drag").remove();return}if(!(!t._has("cartesian")&&!t._has("splom"))){var f=Object.keys(t._plots||{}).sort(function(i,g){if((t._plots[i].mainplot&&!0)===(t._plots[g].mainplot&&!0)){var p=i.split("y"),y=g.split("y");return p[0]===y[0]?Number(p[1]||1)-Number(y[1]||1):Number(p[0]||1)-Number(y[0]||1)}return t._plots[i].mainplot?1:-1});f.forEach(function(i){var g=t._plots[i],p=g.xaxis,y=g.yaxis;if(!g.mainplot){var h=e(r,g,p._offset,y._offset,p._length,y._length,"ns","ew");h.onmousemove=function(_){r._fullLayout._rehover=function(){r._fullLayout._hoversubplot===i&&r._fullLayout._plots[i]&&c.hover(r,_,i)},c.hover(r,_,i),r._fullLayout._lasthover=h,r._fullLayout._hoversubplot=i},h.onmouseout=function(_){r._dragging||(r._fullLayout._hoversubplot=null,M.unhover(r,_))},r._context.showAxisDragHandles&&(e(r,g,p._offset-a,y._offset-a,a,a,"n","w"),e(r,g,p._offset+p._length,y._offset-a,a,a,"n","e"),e(r,g,p._offset-a,y._offset+y._length,a,a,"s","w"),e(r,g,p._offset+p._length,y._offset+y._length,a,a,"s","e"))}if(r._context.showAxisDragHandles){if(i===p._mainSubplot){var m=p._mainLinePosition;p.side==="top"&&(m-=a),e(r,g,p._offset+p._length*.1,m,p._length*.8,a,"","ew"),e(r,g,p._offset,m,p._length*.1,a,"","w"),e(r,g,p._offset+p._length*.9,m,p._length*.1,a,"","e")}if(i===y._mainSubplot){var u=y._mainLinePosition;y.side!=="right"&&(u-=a),e(r,g,u,y._offset+y._length*.1,a,y._length*.8,"ns",""),e(r,g,u,y._offset+y._length*.9,a,y._length*.1,"s",""),e(r,g,u,y._offset,a,y._length*.1,"n","")}}});var o=t._hoverlayer.node();o.onmousemove=function(i){i.target=r._fullLayout._lasthover,c.hover(r,i,t._hoversubplot)},o.onclick=function(i){i.target=r._fullLayout._lasthover,c.click(r,i)},o.onmousedown=function(i){r._fullLayout._lasthover.onmousedown(i)},ne.updateFx(r)}},ne.updateFx=function(n){var r=n._fullLayout,t=r.dragmode==="pan"?"move":"crosshair";T(r._draggers,t)}},{"../../components/dragelement":385,"../../components/fx":406,"../../lib/setcursor":524,"./constants":561,"./dragbox":563,"@plotly/d3":58}],565:[function(d,re,ne){function w(M){var T=M._fullLayout._zoomlayer;T&&T.selectAll(".outline-controllers").remove()}function c(M){var T=M._fullLayout._zoomlayer;T&&T.selectAll(".select-outline").remove(),M._fullLayout._drawing=!1}re.exports={clearOutlineControllers:w,clearSelect:c}},{}],566:[function(d,re,ne){var w=d("../../lib").strTranslate;function c(a,n){switch(a.type){case"log":return a.p2d(n);case"date":return a.p2r(n,0,a.calendar);default:return a.p2r(n)}}function M(a,n){switch(a.type){case"log":return a.d2p(n);case"date":return a.r2p(n,0,a.calendar);default:return a.r2p(n)}}function T(a){var n=a._id.charAt(0)==="y"?1:0;return function(r){return c(a,r[n])}}function e(a){return w(a.xaxis._offset,a.yaxis._offset)}re.exports={p2r:c,r2p:M,axValue:T,getTransform:e}},{"../../lib":503}],567:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib"),M=d("./axis_ids");re.exports=function(e){return function(n,r){var t=n[e];if(!!Array.isArray(t))for(var f=w.subplotsRegistry.cartesian,o=f.idRegex,i=r._subplots,g=i.xaxis,p=i.yaxis,y=i.cartesian,h=r._has("cartesian")||r._has("gl2d"),m=0;m<t.length;m++){var u=t[m];if(!!c.isPlainObject(u)){var _=M.cleanId(u.xref,"x",!1),s=M.cleanId(u.yref,"y",!1),A=o.x.test(_),x=o.y.test(s);if(A||x){h||c.pushUnique(r._basePlotModules,f);var v=!1;A&&g.indexOf(_)===-1&&(g.push(_),v=!0),x&&p.indexOf(s)===-1&&(p.push(s),v=!0),v&&A&&x&&y.push(_+s)}}}}}},{"../../lib":503,"../../registry":638,"./axis_ids":558}],568:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../registry"),M=d("../../lib"),T=d("../plots"),e=d("../../components/drawing"),a=d("../get_data").getModuleCalcData,n=d("./axis_ids"),r=d("./constants"),t=d("../../constants/xmlns_namespaces"),f=M.ensureSingle;function o(m,u,_){return M.ensureSingle(m,u,_,function(s){s.datum(_)})}ne.name="cartesian",ne.attr=["xaxis","yaxis"],ne.idRoot=["x","y"],ne.idRegex=r.idRegex,ne.attrRegex=r.attrRegex,ne.attributes=d("./attributes"),ne.layoutAttributes=d("./layout_attributes"),ne.supplyLayoutDefaults=d("./layout_defaults"),ne.transitionAxes=d("./transition_axes"),ne.finalizeSubplots=function(m,u){var _=u._subplots,s=_.xaxis,A=_.yaxis,x=_.cartesian,v=x.concat(_.gl2d||[]),b={},l={},L,S,k;for(L=0;L<v.length;L++){var P=v[L].split("y");b[P[0]]=1,l["y"+P[1]]=1}for(L=0;L<s.length;L++)S=s[L],b[S]||(k=(m[n.id2name(S)]||{}).anchor,r.idRegex.y.test(k)||(k="y"),x.push(S+k),v.push(S+k),l[k]||(l[k]=1,M.pushUnique(A,k)));for(L=0;L<A.length;L++)k=A[L],l[k]||(S=(m[n.id2name(k)]||{}).anchor,r.idRegex.x.test(S)||(S="x"),x.push(S+k),v.push(S+k),b[S]||(b[S]=1,M.pushUnique(s,S)));if(!v.length){S="",k="";for(var z in m)if(r.attrRegex.test(z)){var I=z.charAt(0);I==="x"?(!S||+z.substr(5)<+S.substr(5))&&(S=z):(!k||+z.substr(5)<+k.substr(5))&&(k=z)}S=S?n.name2id(S):"x",k=k?n.name2id(k):"y",s.push(S),A.push(k),x.push(S+k)}},ne.plot=function(m,u,_,s){var A=m._fullLayout,x=A._subplots.cartesian,v=m.calcdata,b;if(!Array.isArray(u))for(u=[],b=0;b<v.length;b++)u.push(b);for(b=0;b<x.length;b++){for(var l=x[b],L=A._plots[l],S=[],k,P=0;P<v.length;P++){var z=v[P],I=z[0].trace;I.xaxis+I.yaxis===l&&((u.indexOf(I.index)!==-1||I.carpet)&&(k&&k[0].trace.xaxis+k[0].trace.yaxis===l&&["tonextx","tonexty","tonext"].indexOf(I.fill)!==-1&&S.indexOf(k)===-1&&S.push(k),S.push(z)),k=z)}i(m,L,S,_,s)}};function i(m,u,_,s,A){for(var x=r.traceLayerClasses,v=m._fullLayout,b=v._modules,l,L,S,k=[],P=[],z=0;z<b.length;z++){l=b[z];var I=l.name,D=c.modules[I].categories;if(D.svg){var R=l.layerName||I+"layer",B=l.plot;L=a(_,B),S=L[0],_=L[1],S.length&&k.push({i:x.indexOf(R),className:R,plotMethod:B,cdModule:S}),D.zoomScale&&P.push("."+R)}}k.sort(function(G,J){return G.i-J.i});var F=u.plot.selectAll("g.mlayer").data(k,function(G){return G.className});if(F.enter().append("g").attr("class",function(G){return G.className}).classed("mlayer",!0).classed("rangeplot",u.isRangePlot),F.exit().remove(),F.order(),F.each(function(G){var J=w.select(this),j=G.className;G.plotMethod(m,u,G.cdModule,J,s,A),r.clipOnAxisFalseQuery.indexOf("."+j)===-1&&e.setClipUrl(J,u.layerClipId,m)}),v._has("scattergl")&&(l=c.getModule("scattergl"),S=a(_,l)[0],l.plot(m,u,S)),!m._context.staticPlot&&(u._hasClipOnAxisFalse&&(u.clipOnAxisFalseTraces=u.plot.selectAll(r.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),P.length)){var V=u.plot.selectAll(P.join(",")).selectAll(".trace");u.zoomScalePts=V.selectAll("path.point"),u.zoomScaleTxt=V.selectAll(".textpoint")}}ne.clean=function(m,u,_,s){var A=s._plots||{},x=u._plots||{},v=s._subplots||{},b,l,L;if(s._hasOnlyLargeSploms&&!u._hasOnlyLargeSploms)for(L in A)b=A[L],b.plotgroup&&b.plotgroup.remove();var S=s._has&&s._has("gl"),k=u._has&&u._has("gl");if(S&&!k)for(L in A)b=A[L],b._scene&&b._scene.destroy();if(v.xaxis&&v.yaxis){var P=n.listIds({_fullLayout:s});for(l=0;l<P.length;l++){var z=P[l];u[n.id2name(z)]||s._infolayer.selectAll(".g-"+z+"title").remove()}}var I=s._has&&s._has("cartesian"),D=u._has&&u._has("cartesian");if(I&&!D)y(s._cartesianlayer.selectAll(".subplot"),s),s._defs.selectAll(".axesclip").remove(),delete s._axisConstraintGroups,delete s._axisMatchGroups;else if(v.cartesian)for(l=0;l<v.cartesian.length;l++){var R=v.cartesian[l];if(!x[R]){var B="."+R+",."+R+"-x,."+R+"-y";s._cartesianlayer.selectAll(B).remove(),h(R,s)}}},ne.drawFramework=function(m){var u=m._fullLayout,_=g(m),s=u._cartesianlayer.selectAll(".subplot").data(_,String);s.enter().append("g").attr("class",function(A){return"subplot "+A[0]}),s.order(),s.exit().call(y,u),s.each(function(A){var x=A[0],v=u._plots[x];v.plotgroup=w.select(this),p(m,v),v.draglayer=f(u._draggers,"g",x)})},ne.rangePlot=function(m,u,_){p(m,u),i(m,u,_),T.style(m)};function g(m){var u=m._fullLayout,_=u._subplots.cartesian,s=_.length,A,x,v,b,l,L,S=[],k=[];for(A=0;A<s;A++){v=_[A],b=u._plots[v],l=b.xaxis,L=b.yaxis;var P=l._mainAxis,z=L._mainAxis,I=P._id+z._id,D=u._plots[I];b.overlays=[],I!==v&&D?(b.mainplot=I,b.mainplotinfo=D,k.push(v)):(b.mainplot=void 0,b.mainplotinfo=void 0,S.push(v))}for(A=0;A<k.length;A++)v=k[A],b=u._plots[v],b.mainplotinfo.overlays.push(b);var R=S.concat(k),B=new Array(s);for(A=0;A<s;A++){v=R[A],b=u._plots[v],l=b.xaxis,L=b.yaxis;var F=[v,l.layer,L.layer,l.overlaying||"",L.overlaying||""];for(x=0;x<b.overlays.length;x++)F.push(b.overlays[x].id);B[A]=F}return B}function p(m,u){var _=u.plotgroup,s=u.id,A=r.layerValue2layerClass[u.xaxis.layer],x=r.layerValue2layerClass[u.yaxis.layer],v=m._fullLayout._hasOnlyLargeSploms;if(u.mainplot){var l=u.mainplotinfo,L=l.plotgroup,S=s+"-x",k=s+"-y";u.gridlayer=l.gridlayer,u.zerolinelayer=l.zerolinelayer,f(l.overlinesBelow,"path",S),f(l.overlinesBelow,"path",k),f(l.overaxesBelow,"g",S),f(l.overaxesBelow,"g",k),u.plot=f(l.overplot,"g",s),f(l.overlinesAbove,"path",S),f(l.overlinesAbove,"path",k),f(l.overaxesAbove,"g",S),f(l.overaxesAbove,"g",k),u.xlines=L.select(".overlines-"+A).select("."+S),u.ylines=L.select(".overlines-"+x).select("."+k),u.xaxislayer=L.select(".overaxes-"+A).select("."+S),u.yaxislayer=L.select(".overaxes-"+x).select("."+k)}else if(v)u.xlines=f(_,"path","xlines-above"),u.ylines=f(_,"path","ylines-above"),u.xaxislayer=f(_,"g","xaxislayer-above"),u.yaxislayer=f(_,"g","yaxislayer-above");else{var b=f(_,"g","layer-subplot");u.shapelayer=f(b,"g","shapelayer"),u.imagelayer=f(b,"g","imagelayer"),u.gridlayer=f(_,"g","gridlayer"),u.zerolinelayer=f(_,"g","zerolinelayer"),f(_,"path","xlines-below"),f(_,"path","ylines-below"),u.overlinesBelow=f(_,"g","overlines-below"),f(_,"g","xaxislayer-below"),f(_,"g","yaxislayer-below"),u.overaxesBelow=f(_,"g","overaxes-below"),u.plot=f(_,"g","plot"),u.overplot=f(_,"g","overplot"),u.xlines=f(_,"path","xlines-above"),u.ylines=f(_,"path","ylines-above"),u.overlinesAbove=f(_,"g","overlines-above"),f(_,"g","xaxislayer-above"),f(_,"g","yaxislayer-above"),u.overaxesAbove=f(_,"g","overaxes-above"),u.xlines=_.select(".xlines-"+A),u.ylines=_.select(".ylines-"+x),u.xaxislayer=_.select(".xaxislayer-"+A),u.yaxislayer=_.select(".yaxislayer-"+x)}v||(o(u.gridlayer,"g",u.xaxis._id),o(u.gridlayer,"g",u.yaxis._id),u.gridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort)),u.xlines.style("fill","none").classed("crisp",!0),u.ylines.style("fill","none").classed("crisp",!0)}function y(m,u){if(!!m){var _={};m.each(function(l){var L=l[0],S=w.select(this);S.remove(),h(L,u),_[L]=!0});for(var s in u._plots)for(var A=u._plots[s],x=A.overlays||[],v=0;v<x.length;v++){var b=x[v];_[b.id]&&b.plot.selectAll(".trace").remove()}}}function h(m,u){u._draggers.selectAll("g."+m).remove(),u._defs.select("#clip"+u._uid+m+"plot").remove()}ne.toSVG=function(m){var u=m._fullLayout._glimages,_=w.select(m).selectAll(".svg-container"),s=_.filter(function(x,v){return v===_.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function A(){var x=this,v=x.toDataURL("image/png"),b=u.append("svg:image");b.attr({xmlns:t.svg,"xlink:href":v,preserveAspectRatio:"none",x:0,y:0,width:x.style.width,height:x.style.height})}s.each(A)},ne.updateFx=d("./graph_interact").updateFx},{"../../components/drawing":388,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../registry":638,"../get_data":593,"../plots":619,"./attributes":552,"./axis_ids":558,"./constants":561,"./graph_interact":564,"./layout_attributes":569,"./layout_defaults":570,"./transition_axes":581,"@plotly/d3":58}],569:[function(d,re,ne){var w=d("../font_attributes"),c=d("../../components/color/attributes"),M=d("../../components/drawing/attributes").dash,T=d("../../lib/extend").extendFlat,e=d("../../plot_api/plot_template").templatedArray,a=d("../../plots/cartesian/axis_format_attributes").descriptionWithDates,n=d("../../constants/numerical").ONEDAY,r=d("./constants"),t=r.HOUR_PATTERN,f=r.WEEKDAY_PATTERN;re.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:c.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:w({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[f,t,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:n},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:c.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:T({},M,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:w({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:a("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:a("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:c.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:c.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:c.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:c.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",r.idRegex.x.toString(),r.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:w({editType:"ticks"})}}},{"../../components/color/attributes":365,"../../components/drawing/attributes":387,"../../constants/numerical":479,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_format_attributes":557,"../font_attributes":585,"./constants":561}],570:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/color"),M=d("../../components/fx/helpers").isUnifiedHover,T=d("../../components/fx/hovermode_defaults"),e=d("../../plot_api/plot_template"),a=d("../layout_attributes"),n=d("./layout_attributes"),r=d("./type_defaults"),t=d("./axis_defaults"),f=d("./constraints"),o=d("./position_defaults"),i=d("./axis_ids"),g=i.id2name,p=i.name2id,y=d("./constants").AX_ID_PATTERN,h=d("../../registry"),m=h.traceIs,u=h.getComponentMethod;function _(s,A,x){Array.isArray(s[A])?s[A].push(x):s[A]=[x]}re.exports=function(A,x,v){var b=x.autotypenumbers,l={},L={},S={},k={},P={},z={},I={},D={},R={},B={},F,V;for(F=0;F<v.length;F++){var G=v[F];if(!(!m(G,"cartesian")&&!m(G,"gl2d"))){var J;if(G.xaxis)J=g(G.xaxis),_(l,J,G);else if(G.xaxes)for(V=0;V<G.xaxes.length;V++)_(l,g(G.xaxes[V]),G);var j;if(G.yaxis)j=g(G.yaxis),_(l,j,G);else if(G.yaxes)for(V=0;V<G.yaxes.length;V++)_(l,g(G.yaxes[V]),G);if(G.type==="funnel"?G.orientation==="h"?(J&&(L[J]=!0),j&&(I[j]=!0)):j&&(S[j]=!0):G.type==="image"?(j&&(D[j]=!0),J&&(D[J]=!0)):(j&&(P[j]=!0,z[j]=!0),(!m(G,"carpet")||G.type==="carpet"&&!G._cheater)&&J&&(k[J]=!0)),G.type==="carpet"&&G._cheater&&J&&(L[J]=!0),m(G,"2dMap")&&(R[J]=!0,R[j]=!0),m(G,"oriented")){var Y=G.orientation==="h"?j:J;B[Y]=!0}}}var X=x._subplots,oe=X.xaxis,se=X.yaxis,ie=w.simpleMap(oe,g),N=w.simpleMap(se,g),U=ie.concat(N),q=c.background;oe.length&&se.length&&(q=w.coerce(A,x,a,"plot_bgcolor"));var Q=c.combine(q,x.paper_bgcolor),W,Z,ee,te,ae;function le(){var je=l[W]||[];ae._traceIndices=je.map(function(ke){return ke._expandedIndex}),ae._annIndices=[],ae._shapeIndices=[],ae._imgIndices=[],ae._subplotsWith=[],ae._counterAxes=[],ae._name=ae._attr=W,ae._id=Z}function ye(je,ke){return w.coerce(te,ae,n,je,ke)}function fe(je,ke){return w.coerce2(te,ae,n,je,ke)}function pe(je){return je==="x"?se:oe}function ge(je,ke){for(var Ye=je==="x"?ie:N,Ke=[],st=0;st<Ye.length;st++){var Et=Ye[st];Et!==ke&&!(A[Et]||{}).overlaying&&Ke.push(p(Et))}return Ke}var Ae={x:pe("x"),y:pe("y")},we=Ae.x.concat(Ae.y),De={},Be=[];function Ve(){var je=te.matches;y.test(je)&&we.indexOf(je)===-1&&(De[je]=te.type,Be=Object.keys(De))}var xe=T(A,x),Le=M(xe);for(F=0;F<U.length;F++){W=U[F],Z=p(W),ee=W.charAt(0),w.isPlainObject(A[W])||(A[W]={}),te=A[W],ae=e.newContainer(x,W,ee+"axis"),le();var He=ee==="x"&&!k[W]&&L[W]||ee==="y"&&!P[W]&&S[W],Je=ee==="y"&&(!z[W]&&I[W]||D[W]),Oe={letter:ee,font:x.font,outerTicks:R[W],showGrid:!B[W],data:l[W]||[],bgColor:Q,calendar:x.calendar,automargin:!0,visibleDflt:He,reverseDflt:Je,autotypenumbersDflt:b,splomStash:((x._splomAxes||{})[ee]||{})[Z]};ye("uirevision",x.uirevision),r(te,ae,ye,Oe),t(te,ae,ye,Oe,x);var Pe=Le&&ee===xe.charAt(0),Ue=fe("spikecolor",Le?ae.color:void 0),vt=fe("spikethickness",Le?1.5:void 0),Lt=fe("spikedash",Le?"dot":void 0),Yt=fe("spikemode",Le?"across":void 0),At=fe("spikesnap"),Rt=ye("showspikes",!!Pe||!!Ue||!!vt||!!Lt||!!Yt||!!At);Rt||(delete ae.spikecolor,delete ae.spikethickness,delete ae.spikedash,delete ae.spikemode,delete ae.spikesnap),o(te,ae,ye,{letter:ee,counterAxes:Ae[ee],overlayableAxes:ge(ee,W),grid:x.grid}),ye("title.standoff"),Ve(),ae._input=te}for(F=0;F<Be.length;){Z=Be[F++],W=g(Z),ee=W.charAt(0),w.isPlainObject(A[W])||(A[W]={}),te=A[W],ae=e.newContainer(x,W,ee+"axis"),le();var Bt={letter:ee,font:x.font,outerTicks:R[W],showGrid:!B[W],data:[],bgColor:Q,calendar:x.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:b,splomStash:((x._splomAxes||{})[ee]||{})[Z]};ye("uirevision",x.uirevision),ae.type=De[Z]||"linear",t(te,ae,ye,Bt,x),o(te,ae,ye,{letter:ee,counterAxes:Ae[ee],overlayableAxes:ge(ee,W),grid:x.grid}),ye("fixedrange"),Ve(),ae._input=te}var Mt=u("rangeslider","handleDefaults"),Tt=u("rangeselector","handleDefaults");for(F=0;F<ie.length;F++)W=ie[F],te=A[W],ae=x[W],Mt(A,x,W),ae.type==="date"&&Tt(te,ae,x,N,ae.calendar),ye("fixedrange");for(F=0;F<N.length;F++){W=N[F],te=A[W],ae=x[W];var at=x[g(ae.anchor)],ct=u("rangeslider","isVisible")(at);ye("fixedrange",ct)}f.handleDefaults(A,x,{axIds:we.concat(Be).sort(i.idSort),axHasImage:D})}},{"../../components/color":366,"../../components/fx/helpers":402,"../../components/fx/hovermode_defaults":405,"../../lib":503,"../../plot_api/plot_template":543,"../../registry":638,"../layout_attributes":610,"./axis_defaults":556,"./axis_ids":558,"./constants":561,"./constraints":562,"./layout_attributes":569,"./position_defaults":572,"./type_defaults":582}],571:[function(d,re,ne){var w=d("tinycolor2").mix,c=d("../../components/color/attributes").lightFraction,M=d("../../lib");re.exports=function(e,a,n,r){r=r||{};var t=r.dfltColor;function f(A,x){return M.coerce2(e,a,r.attributes,A,x)}var o=f("linecolor",t),i=f("linewidth"),g=n("showline",r.showLine||!!o||!!i);g||(delete a.linecolor,delete a.linewidth);var p=w(t,r.bgColor,r.blend||c).toRgbString(),y=f("gridcolor",p),h=f("gridwidth"),m=n("showgrid",r.showGrid||!!y||!!h);if(m||(delete a.gridcolor,delete a.gridwidth),!r.noZeroLine){var u=f("zerolinecolor",t),_=f("zerolinewidth"),s=n("zeroline",r.showGrid||!!u||!!_);s||(delete a.zerolinecolor,delete a.zerolinewidth)}}},{"../../components/color/attributes":365,"../../lib":503,tinycolor2:312}],572:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib");re.exports=function(T,e,a,n){var r=n.counterAxes||[],t=n.overlayableAxes||[],f=n.letter,o=n.grid,i,g,p,y;o&&(g=o._domains[f][o._axisMap[e._id]],i=o._anchors[e._id],g&&(p=o[f+"side"].split(" ")[0],y=o.domain[f][p==="right"||p==="top"?1:0])),g=g||[0,1],i=i||(w(T.position)?"free":r[0]||"free"),p=p||(f==="x"?"bottom":"left"),y=y||0;var h=c.coerce(T,e,{anchor:{valType:"enumerated",values:["free"].concat(r),dflt:i}},"anchor");h==="free"&&a("position",y),c.coerce(T,e,{side:{valType:"enumerated",values:f==="x"?["bottom","top"]:["left","right"],dflt:p}},"side");var m=!1;if(t.length&&(m=c.coerce(T,e,{overlaying:{valType:"enumerated",values:[!1].concat(t),dflt:!1}},"overlaying")),!m){var u=a("domain",g);u[0]>u[1]-1/4096&&(e.domain=g),c.noneOrAll(T.domain,e.domain,g)}return a("layer"),e}},{"../../lib":503,"fast-isnumeric":190}],573:[function(d,re,ne){var w=d("./show_dflt");re.exports=function(M,T,e,a,n){n||(n={});var r=n.tickSuffixDflt,t=w(M),f=e("tickprefix");f&&e("showtickprefix",t);var o=e("ticksuffix",r);o&&e("showticksuffix",t)}},{"./show_dflt":577}],574:[function(d,re,ne){var w=d("../../constants/alignment").FROM_BL;re.exports=function(M,T,e){e===void 0&&(e=w[M.constraintoward||"center"]);var a=[M.r2l(M.range[0]),M.r2l(M.range[1])],n=a[0]+(a[1]-a[0])*e;M.range=M._input.range=[M.l2r(n+(a[0]-n)*T),M.l2r(n+(a[1]-n)*T)],M.setScale()}},{"../../constants/alignment":471}],575:[function(d,re,ne){var w=d("polybooljs"),c=d("../../registry"),M=d("../../components/drawing").dashStyle,T=d("../../components/color"),e=d("../../components/fx"),a=d("../../components/fx/helpers").makeEventData,n=d("../../components/dragelement/helpers"),r=n.freeMode,t=n.rectMode,f=n.drawMode,o=n.openMode,i=n.selectMode,g=d("../../components/shapes/draw_newshape/display_outlines"),p=d("../../components/shapes/draw_newshape/helpers").handleEllipse,y=d("../../components/shapes/draw_newshape/newshapes"),h=d("../../lib"),m=d("../../lib/polygon"),u=d("../../lib/throttle"),_=d("./axis_ids").getFromId,s=d("../../lib/clear_gl_canvases"),A=d("../../plot_api/subroutines").redrawReglTraces,x=d("./constants"),v=x.MINSELECT,b=m.filter,l=m.tester,L=d("./handle_outline").clearSelect,S=d("./helpers"),k=S.p2r,P=S.axValue,z=S.getTransform;function I(W,Z,ee,te,ae){var le=r(ae),ye=t(ae),fe=o(ae),pe=f(ae),ge=i(ae),Ae=ae==="drawline",we=ae==="drawcircle",De=Ae||we,Be=te.gd,Ve=Be._fullLayout,xe=Ve._zoomlayer,Le=te.element.getBoundingClientRect(),He=te.plotinfo,Je=z(He),Oe=Z-Le.left,Pe=ee-Le.top;Ve._calcInverseTransform(Be);var Ue=h.apply3DTransform(Ve._invTransform)(Oe,Pe);Oe=Ue[0],Pe=Ue[1];var vt=Ve._invScaleX,Lt=Ve._invScaleY,Yt=Oe,At=Pe,Rt="M"+Oe+","+Pe,Bt=te.xaxes[0]._length,Mt=te.yaxes[0]._length,Tt=te.xaxes.concat(te.yaxes),at=W.altKey&&!(f(ae)&&fe),ct,je,ke,Ye,Ke,st,Et;G(W,Be,te),le&&(ct=b([[Oe,Pe]],x.BENDPX));var bt=xe.selectAll("path.select-outline-"+He.id).data(pe?[0]:[1,2]),zt=Ve.newshape;bt.enter().append("path").attr("class",function(Wr){return"select-outline select-outline-"+Wr+" select-outline-"+He.id}).style(pe?{opacity:zt.opacity/2,fill:fe?void 0:zt.fillcolor,stroke:zt.line.color,"stroke-dasharray":M(zt.line.dash,zt.line.width),"stroke-width":zt.line.width+"px"}:{}).attr("fill-rule",zt.fillrule).classed("cursor-move",!!pe).attr("transform",Je).attr("d",Rt+"Z");var $t=xe.append("path").attr("class","zoombox-corners").style({fill:T.background,stroke:T.defaultLine,"stroke-width":1}).attr("transform",Je).attr("d","M0,0Z"),Ot=Ve._uid+x.SELECTID,Qt=[],tr=j(Be,te.xaxes,te.yaxes,te.subplot);function qt(Wr,cn){return Wr-cn}var lr;He.fillRangeItems?lr=He.fillRangeItems:ye?lr=function(Wr,cn){var Jr=Wr.range={};for(Ke=0;Ke<Tt.length;Ke++){var ot=Tt[Ke],Vt=ot._id.charAt(0);Jr[ot._id]=[k(ot,cn[Vt+"min"]),k(ot,cn[Vt+"max"])].sort(qt)}}:lr=function(Wr,cn,Jr){var ot=Wr.lassoPoints={};for(Ke=0;Ke<Tt.length;Ke++){var Vt=Tt[Ke];ot[Vt._id]=Jr.filtered.map(P(Vt))}},te.moveFn=function(Wr,cn){Yt=Math.max(0,Math.min(Bt,vt*Wr+Oe)),At=Math.max(0,Math.min(Mt,Lt*cn+Pe));var Jr=Math.abs(Yt-Oe),ot=Math.abs(At-Pe);if(ye){var Vt,jt,Ut;if(ge){var yr=Ve.selectdirection;switch(yr==="any"?ot<Math.min(Jr*.6,v)?Vt="h":Jr<Math.min(ot*.6,v)?Vt="v":Vt="d":Vt=yr,Vt){case"h":jt=we?Mt/2:0,Ut=Mt;break;case"v":jt=we?Bt/2:0,Ut=Bt;break}}if(pe)switch(Ve.newshape.drawdirection){case"vertical":Vt="h",jt=we?Mt/2:0,Ut=Mt;break;case"horizontal":Vt="v",jt=we?Bt/2:0,Ut=Bt;break;case"ortho":Jr<ot?(Vt="h",jt=Pe,Ut=At):(Vt="v",jt=Oe,Ut=Yt);break;default:Vt="d"}Vt==="h"?(Ye=De?p(we,[Yt,jt],[Yt,Ut]):[[Oe,jt],[Oe,Ut],[Yt,Ut],[Yt,jt]],Ye.xmin=De?Yt:Math.min(Oe,Yt),Ye.xmax=De?Yt:Math.max(Oe,Yt),Ye.ymin=Math.min(jt,Ut),Ye.ymax=Math.max(jt,Ut),$t.attr("d","M"+Ye.xmin+","+(Pe-v)+"h-4v"+2*v+"h4ZM"+(Ye.xmax-1)+","+(Pe-v)+"h4v"+2*v+"h-4Z")):Vt==="v"?(Ye=De?p(we,[jt,At],[Ut,At]):[[jt,Pe],[jt,At],[Ut,At],[Ut,Pe]],Ye.xmin=Math.min(jt,Ut),Ye.xmax=Math.max(jt,Ut),Ye.ymin=De?At:Math.min(Pe,At),Ye.ymax=De?At:Math.max(Pe,At),$t.attr("d","M"+(Oe-v)+","+Ye.ymin+"v-4h"+2*v+"v4ZM"+(Oe-v)+","+(Ye.ymax-1)+"v4h"+2*v+"v-4Z")):Vt==="d"&&(Ye=De?p(we,[Oe,Pe],[Yt,At]):[[Oe,Pe],[Oe,At],[Yt,At],[Yt,Pe]],Ye.xmin=Math.min(Oe,Yt),Ye.xmax=Math.max(Oe,Yt),Ye.ymin=Math.min(Pe,At),Ye.ymax=Math.max(Pe,At),$t.attr("d","M0,0Z"))}else le&&(ct.addPt([Yt,At]),Ye=ct.filtered);te.selectionDefs&&te.selectionDefs.length?(ke=U(te.mergedPolygons,Ye,at),Ye.subtract=at,je=V(te.selectionDefs.concat([Ye]))):(ke=[Ye],je=l(Ye)),g(Q(ke,fe),bt,te),ge&&u.throttle(Ot,x.SELECTDELAY,function(){Qt=[];var nt,_e;for(Ke=0;Ke<tr.length;Ke++)if(st=tr[Ke],_e=st._module.selectPoints(st,je),nt=q(_e,st),Qt.length)for(var Me=0;Me<nt.length;Me++)Qt.push(nt[Me]);else Qt=nt;Et={points:Qt},N(Be,tr,Et),lr(Et,Ye,ct),te.gd.emit("plotly_selecting",Et)})},te.clickFn=function(Wr,cn){if($t.remove(),Be._fullLayout._activeShapeIndex>=0){Be._fullLayout._deactivateShape(Be);return}if(!pe){var Jr=Ve.clickmode;u.done(Ot).then(function(){if(u.clear(Ot),Wr===2){for(bt.remove(),Ke=0;Ke<tr.length;Ke++)st=tr[Ke],st._module.selectPoints(st,!1);N(Be,tr),J(te),Be.emit("plotly_deselect",null)}else Jr.indexOf("select")>-1&&D(cn,Be,te.xaxes,te.yaxes,te.subplot,te,bt),Jr==="event"&&Be.emit("plotly_selected",void 0);e.click(Be,cn)}).catch(h.error)}},te.doneFn=function(){$t.remove(),u.done(Ot).then(function(){u.clear(Ot),te.gd.emit("plotly_selected",Et),Ye&&te.selectionDefs&&(Ye.subtract=at,te.selectionDefs.push(Ye),te.mergedPolygons.length=0,[].push.apply(te.mergedPolygons,ke)),te.doneFnCompleted&&te.doneFnCompleted(Qt)}).catch(h.error),pe&&J(te)}}function D(W,Z,ee,te,ae,le,ye){var fe=Z._hoverdata,pe=Z._fullLayout,ge=pe.clickmode,Ae=ge.indexOf("event")>-1,we=[],De,Be,Ve,xe,Le,He,Je,Oe,Pe,Ue;if(Y(fe)){G(W,Z,le),De=j(Z,ee,te,ae);var vt=X(fe,De),Lt=vt.pointNumbers.length>0;if(Lt?se(De,vt):ie(De)&&(Je=oe(vt))){for(ye&&ye.remove(),Ue=0;Ue<De.length;Ue++)Be=De[Ue],Be._module.selectPoints(Be,!1);N(Z,De),J(le),Ae&&Z.emit("plotly_deselect",null)}else{Oe=W.shiftKey&&(Je!==void 0?Je:oe(vt)),Ve=R(vt.pointNumber,vt.searchInfo,Oe);var Yt=le.selectionDefs.concat([Ve]);for(xe=V(Yt),Ue=0;Ue<De.length;Ue++)if(Le=De[Ue]._module.selectPoints(De[Ue],xe),He=q(Le,De[Ue]),we.length)for(var At=0;At<He.length;At++)we.push(He[At]);else we=He;if(Pe={points:we},N(Z,De,Pe),Ve&&le&&le.selectionDefs.push(Ve),ye){var Rt=le.mergedPolygons,Bt=o(le.dragmode);g(Q(Rt,Bt),ye,le)}Ae&&Z.emit("plotly_selected",Pe)}}}function R(W,Z,ee){return{pointNumber:W,searchInfo:Z,subtract:ee}}function B(W){return"pointNumber"in W&&"searchInfo"in W}function F(W){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(Z,ee,te,ae){var le=W.searchInfo.cd[0].trace._expandedIndex,ye=ae.cd[0].trace._expandedIndex;return ye===le&&te===W.pointNumber},isRect:!1,degenerate:!1,subtract:W.subtract}}function V(W){for(var Z=[],ee=B(W[0])?0:W[0][0][0],te=ee,ae=B(W[0])?0:W[0][0][1],le=ae,ye=0;ye<W.length;ye++)if(B(W[ye]))Z.push(F(W[ye]));else{var fe=m.tester(W[ye]);fe.subtract=W[ye].subtract,Z.push(fe),ee=Math.min(ee,fe.xmin),te=Math.max(te,fe.xmax),ae=Math.min(ae,fe.ymin),le=Math.max(le,fe.ymax)}function pe(ge,Ae,we,De){for(var Be=!1,Ve=0;Ve<Z.length;Ve++)Z[Ve].contains(ge,Ae,we,De)&&(Be=Z[Ve].subtract===!1);return Be}return{xmin:ee,xmax:te,ymin:ae,ymax:le,pts:[],contains:pe,isRect:!1,degenerate:!1}}function G(W,Z,ee){Z._fullLayout._drawing=!1;var te=Z._fullLayout,ae=ee.plotinfo,le=ee.dragmode,ye=te._lastSelectedSubplot&&te._lastSelectedSubplot===ae.id,fe=(W.shiftKey||W.altKey)&&!(f(le)&&o(le));ye&&fe&&ae.selection&&ae.selection.selectionDefs&&!ee.selectionDefs?(ee.selectionDefs=ae.selection.selectionDefs,ee.mergedPolygons=ae.selection.mergedPolygons):(!fe||!ae.selection)&&J(ee),ye||(L(Z),te._lastSelectedSubplot=ae.id)}function J(W){var Z=W.dragmode,ee=W.plotinfo,te=W.gd;if(te._fullLayout._activeShapeIndex>=0&&te._fullLayout._deactivateShape(te),f(Z)){var ae=te._fullLayout,le=ae._zoomlayer,ye=le.selectAll(".select-outline-"+ee.id);if(ye&&te._fullLayout._drawing){var fe=y(ye,W);fe&&c.call("_guiRelayout",te,{shapes:fe}),te._fullLayout._drawing=!1}}ee.selection={},ee.selection.selectionDefs=W.selectionDefs=[],ee.selection.mergedPolygons=W.mergedPolygons=[]}function j(W,Z,ee,te){var ae=[],le=Z.map(function(Be){return Be._id}),ye=ee.map(function(Be){return Be._id}),fe,pe,ge;for(ge=0;ge<W.calcdata.length;ge++)if(fe=W.calcdata[ge],pe=fe[0].trace,!(pe.visible!==!0||!pe._module||!pe._module.selectPoints))if(te&&(pe.subplot===te||pe.geo===te))ae.push(De(pe._module,fe,Z[0],ee[0]));else if(pe.type==="splom"&&pe._xaxes[le[0]]&&pe._yaxes[ye[0]]){var Ae=De(pe._module,fe,Z[0],ee[0]);Ae.scene=W._fullLayout._splomScenes[pe.uid],ae.push(Ae)}else if(pe.type==="sankey"){var we=De(pe._module,fe,Z[0],ee[0]);ae.push(we)}else{if(le.indexOf(pe.xaxis)===-1||ye.indexOf(pe.yaxis)===-1)continue;ae.push(De(pe._module,fe,_(W,pe.xaxis),_(W,pe.yaxis)))}return ae;function De(Be,Ve,xe,Le){return{_module:Be,cd:Ve,xaxis:xe,yaxis:Le}}}function Y(W){return W&&Array.isArray(W)&&W[0].hoverOnBox!==!0}function X(W,Z){var ee=W[0],te=-1,ae=[],le,ye;for(ye=0;ye<Z.length;ye++)if(le=Z[ye],ee.fullData._expandedIndex===le.cd[0].trace._expandedIndex){if(ee.hoverOnBox===!0)break;ee.pointNumber!==void 0?te=ee.pointNumber:ee.binNumber!==void 0&&(te=ee.binNumber,ae=ee.pointNumbers);break}return{pointNumber:te,pointNumbers:ae,searchInfo:le}}function oe(W){var Z=W.searchInfo.cd[0].trace,ee=W.pointNumber,te=W.pointNumbers,ae=te.length>0,le=ae?te[0]:ee;return Z.selectedpoints?Z.selectedpoints.indexOf(le)>-1:!1}function se(W,Z){var ee=[],te,ae,le,ye;for(ye=0;ye<W.length;ye++)te=W[ye],te.cd[0].trace.selectedpoints&&te.cd[0].trace.selectedpoints.length>0&&ee.push(te);if(ee.length===1&&(le=ee[0]===Z.searchInfo,le&&(ae=Z.searchInfo.cd[0].trace,ae.selectedpoints.length===Z.pointNumbers.length))){for(ye=0;ye<Z.pointNumbers.length;ye++)if(ae.selectedpoints.indexOf(Z.pointNumbers[ye])<0)return!1;return!0}return!1}function ie(W){var Z=0,ee,te,ae;for(ae=0;ae<W.length;ae++)if(ee=W[ae],te=ee.cd[0].trace,te.selectedpoints&&(te.selectedpoints.length>1||(Z+=te.selectedpoints.length,Z>1)))return!1;return Z===1}function N(W,Z,ee){var te,ae,le,ye;for(te=0;te<Z.length;te++){var fe=Z[te].cd[0].trace._fullInput,pe=W._fullLayout._tracePreGUI[fe.uid]||{};pe.selectedpoints===void 0&&(pe.selectedpoints=fe._input.selectedpoints||null)}if(ee){var ge=ee.points||[];for(te=0;te<Z.length;te++)ye=Z[te].cd[0].trace,ye._input.selectedpoints=ye._fullInput.selectedpoints=[],ye._fullInput!==ye&&(ye.selectedpoints=[]);for(te=0;te<ge.length;te++){var Ae=ge[te],we=Ae.data,De=Ae.fullData;Ae.pointIndices?([].push.apply(we.selectedpoints,Ae.pointIndices),ye._fullInput!==ye&&[].push.apply(De.selectedpoints,Ae.pointIndices)):(we.selectedpoints.push(Ae.pointIndex),ye._fullInput!==ye&&De.selectedpoints.push(Ae.pointIndex))}}else for(te=0;te<Z.length;te++)ye=Z[te].cd[0].trace,delete ye.selectedpoints,delete ye._input.selectedpoints,ye._fullInput!==ye&&delete ye._fullInput.selectedpoints;var Be=!1;for(te=0;te<Z.length;te++){ae=Z[te],le=ae.cd,ye=le[0].trace,c.traceIs(ye,"regl")&&(Be=!0);var Ve=ae._module,xe=Ve.styleOnSelect||Ve.style;xe&&(xe(W,le,le[0].node3),le[0].nodeRangePlot3&&xe(W,le,le[0].nodeRangePlot3))}Be&&(s(W),A(W))}function U(W,Z,ee){var te;return ee?(te=w.difference({regions:W,inverted:!1},{regions:[Z],inverted:!1}),te.regions):(te=w.union({regions:W,inverted:!1},{regions:[Z],inverted:!1}),te.regions)}function q(W,Z){if(Array.isArray(W))for(var ee=Z.cd,te=Z.cd[0].trace,ae=0;ae<W.length;ae++)W[ae]=a(W[ae],te,ee);return W}function Q(W,Z){for(var ee=[],te=0;te<W.length;te++){ee[te]=[];for(var ae=0;ae<W[te].length;ae++){ee[te][ae]=[],ee[te][ae][0]=ae?"L":"M";for(var le=0;le<W[te][ae].length;le++)ee[te][ae].push(W[te][ae][le])}Z||ee[te].push(["Z",ee[te][0][1],ee[te][0][2]])}return ee}re.exports={prepSelect:I,clearSelect:L,clearSelectionsCache:J,selectOnClick:D}},{"../../components/color":366,"../../components/dragelement/helpers":384,"../../components/drawing":388,"../../components/fx":406,"../../components/fx/helpers":402,"../../components/shapes/draw_newshape/display_outlines":454,"../../components/shapes/draw_newshape/helpers":455,"../../components/shapes/draw_newshape/newshapes":456,"../../lib":503,"../../lib/clear_gl_canvases":487,"../../lib/polygon":515,"../../lib/throttle":530,"../../plot_api/subroutines":544,"../../registry":638,"./axis_ids":558,"./constants":561,"./handle_outline":565,"./helpers":566,polybooljs:254}],576:[function(d,re,ne){var w=d("@plotly/d3"),c=d("d3-time-format").utcFormat,M=d("../../lib"),T=M.numberFormat,e=d("fast-isnumeric"),a=M.cleanNumber,n=M.ms2DateTime,r=M.dateTime2ms,t=M.ensureNumber,f=M.isArrayOrTypedArray,o=d("../../constants/numerical"),i=o.FP_SAFE,g=o.BADNUM,p=o.LOG_CLIP,y=o.ONEWEEK,h=o.ONEDAY,m=o.ONEHOUR,u=o.ONEMIN,_=o.ONESEC,s=d("./axis_ids"),A=d("./constants"),x=A.HOUR_PATTERN,v=A.WEEKDAY_PATTERN;function b(L){return Math.pow(10,L)}function l(L){return L!=null}re.exports=function(S,k){k=k||{};var P=S._id||"x",z=P.charAt(0);function I(U,q){if(U>0)return Math.log(U)/Math.LN10;if(U<=0&&q&&S.range&&S.range.length===2){var Q=S.range[0],W=S.range[1];return .5*(Q+W-2*p*Math.abs(Q-W))}else return g}function D(U,q,Q,W){if((W||{}).msUTC&&e(U))return+U;var Z=r(U,Q||S.calendar);if(Z===g)if(e(U)){U=+U;var ee=Math.floor(M.mod(U+.05,1)*10),te=Math.round(U-ee/10);Z=r(new Date(te))+ee/10}else return g;return Z}function R(U,q,Q){return n(U,q,Q||S.calendar)}function B(U){return S._categories[Math.round(U)]}function F(U){if(l(U)){if(S._categoriesMap===void 0&&(S._categoriesMap={}),S._categoriesMap[U]!==void 0)return S._categoriesMap[U];S._categories.push(typeof U=="number"?String(U):U);var q=S._categories.length-1;return S._categoriesMap[U]=q,q}return g}function V(U,q){for(var Q=new Array(q),W=0;W<q;W++){var Z=(U[0]||[])[W],ee=(U[1]||[])[W];Q[W]=G([Z,ee])}return Q}function G(U){if(S._categoriesMap)return S._categoriesMap[U]}function J(U){var q=G(U);if(q!==void 0)return q;if(e(U))return+U}function j(U){return e(U)?+U:G(U)}function Y(U,q,Q){return w.round(Q+q*U,2)}function X(U,q,Q){return(U-Q)/q}var oe=function(q){return e(q)?Y(q,S._m,S._b):g},se=function(U){return X(U,S._m,S._b)};if(S.rangebreaks){var ie=z==="y";oe=function(U){if(!e(U))return g;var q=S._rangebreaks.length;if(!q)return Y(U,S._m,S._b);var Q=ie;S.range[0]>S.range[1]&&(Q=!Q);for(var W=Q?-1:1,Z=W*U,ee=0,te=0;te<q;te++){var ae=W*S._rangebreaks[te].min,le=W*S._rangebreaks[te].max;if(Z<ae)break;if(Z>le)ee=te+1;else{ee=Z<(ae+le)/2?te:te+1;break}}var ye=S._B[ee]||0;return isFinite(ye)?Y(U,S._m2,ye):0},se=function(U){var q=S._rangebreaks.length;if(!q)return X(U,S._m,S._b);for(var Q=0,W=0;W<q&&!(U<S._rangebreaks[W].pmin);W++)U>S._rangebreaks[W].pmax&&(Q=W+1);return X(U,S._m2,S._B[Q])}}S.c2l=S.type==="log"?I:t,S.l2c=S.type==="log"?b:t,S.l2p=oe,S.p2l=se,S.c2p=S.type==="log"?function(U,q){return oe(I(U,q))}:oe,S.p2c=S.type==="log"?function(U){return b(se(U))}:se,["linear","-"].indexOf(S.type)!==-1?(S.d2r=S.r2d=S.d2c=S.r2c=S.d2l=S.r2l=a,S.c2d=S.c2r=S.l2d=S.l2r=t,S.d2p=S.r2p=function(U){return S.l2p(a(U))},S.p2d=S.p2r=se,S.cleanPos=t):S.type==="log"?(S.d2r=S.d2l=function(U,q){return I(a(U),q)},S.r2d=S.r2c=function(U){return b(a(U))},S.d2c=S.r2l=a,S.c2d=S.l2r=t,S.c2r=I,S.l2d=b,S.d2p=function(U,q){return S.l2p(S.d2r(U,q))},S.p2d=function(U){return b(se(U))},S.r2p=function(U){return S.l2p(a(U))},S.p2r=se,S.cleanPos=t):S.type==="date"?(S.d2r=S.r2d=M.identity,S.d2c=S.r2c=S.d2l=S.r2l=D,S.c2d=S.c2r=S.l2d=S.l2r=R,S.d2p=S.r2p=function(U,q,Q){return S.l2p(D(U,0,Q))},S.p2d=S.p2r=function(U,q,Q){return R(se(U),q,Q)},S.cleanPos=function(U){return M.cleanDate(U,g,S.calendar)}):S.type==="category"?(S.d2c=S.d2l=F,S.r2d=S.c2d=S.l2d=B,S.d2r=S.d2l_noadd=J,S.r2c=function(U){var q=j(U);return q!==void 0?q:S.fraction2r(.5)},S.l2r=S.c2r=t,S.r2l=j,S.d2p=function(U){return S.l2p(S.r2c(U))},S.p2d=function(U){return B(se(U))},S.r2p=S.d2p,S.p2r=se,S.cleanPos=function(U){return typeof U=="string"&&U!==""?U:t(U)}):S.type==="multicategory"&&(S.r2d=S.c2d=S.l2d=B,S.d2r=S.d2l_noadd=J,S.r2c=function(U){var q=J(U);return q!==void 0?q:S.fraction2r(.5)},S.r2c_just_indices=G,S.l2r=S.c2r=t,S.r2l=J,S.d2p=function(U){return S.l2p(S.r2c(U))},S.p2d=function(U){return B(se(U))},S.r2p=S.d2p,S.p2r=se,S.cleanPos=function(U){return Array.isArray(U)||typeof U=="string"&&U!==""?U:t(U)},S.setupMultiCategory=function(U){var q=S._traceIndices,Q,W,Z=S._matchGroup;if(Z&&S._categories.length===0){for(var ee in Z)if(ee!==P){var te=k[s.id2name(ee)];q=q.concat(te._traceIndices)}}var ae=[[0,{}],[0,{}]],le=[];for(Q=0;Q<q.length;Q++){var ye=U[q[Q]];if(z in ye){var fe=ye[z],pe=ye._length||M.minRowLength(fe);if(f(fe[0])&&f(fe[1]))for(W=0;W<pe;W++){var ge=fe[0][W],Ae=fe[1][W];l(ge)&&l(Ae)&&(le.push([ge,Ae]),ge in ae[0][1]||(ae[0][1][ge]=ae[0][0]++),Ae in ae[1][1]||(ae[1][1][Ae]=ae[1][0]++))}}}for(le.sort(function(we,De){var Be=ae[0][1],Ve=Be[we[0]]-Be[De[0]];if(Ve)return Ve;var xe=ae[1][1];return xe[we[1]]-xe[De[1]]}),Q=0;Q<le.length;Q++)F(le[Q])}),S.fraction2r=function(U){var q=S.r2l(S.range[0]),Q=S.r2l(S.range[1]);return S.l2r(q+U*(Q-q))},S.r2fraction=function(U){var q=S.r2l(S.range[0]),Q=S.r2l(S.range[1]);return(S.r2l(U)-q)/(Q-q)},S.cleanRange=function(U,q){q||(q={}),U||(U="range");var Q=M.nestedProperty(S,U).get(),W,Z;if(S.type==="date"?Z=M.dfltRange(S.calendar):z==="y"?Z=A.DFLTRANGEY:S._name==="realaxis"?Z=[0,1]:Z=q.dfltRange||A.DFLTRANGEX,Z=Z.slice(),(S.rangemode==="tozero"||S.rangemode==="nonnegative")&&(Z[0]=0),!Q||Q.length!==2){M.nestedProperty(S,U).set(Z);return}for(S.type==="date"&&!S.autorange&&(Q[0]=M.cleanDate(Q[0],g,S.calendar),Q[1]=M.cleanDate(Q[1],g,S.calendar)),W=0;W<2;W++)if(S.type==="date"){if(!M.isDateTime(Q[W],S.calendar)){S[U]=Z;break}if(S.r2l(Q[0])===S.r2l(Q[1])){var ee=M.constrain(S.r2l(Q[0]),M.MIN_MS+1e3,M.MAX_MS-1e3);Q[0]=S.l2r(ee-1e3),Q[1]=S.l2r(ee+1e3);break}}else{if(!e(Q[W]))if(e(Q[1-W]))Q[W]=Q[1-W]*(W?10:.1);else{S[U]=Z;break}if(Q[W]<-i?Q[W]=-i:Q[W]>i&&(Q[W]=i),Q[0]===Q[1]){var te=Math.max(1,Math.abs(Q[0]*1e-6));Q[0]-=te,Q[1]+=te}}},S.setScale=function(U){var q=k._size;if(S.overlaying){var Q=s.getFromId({_fullLayout:k},S.overlaying);S.domain=Q.domain}var W=U&&S._r?"_r":"range",Z=S.calendar;S.cleanRange(W);var ee=S.r2l(S[W][0],Z),te=S.r2l(S[W][1],Z),ae=z==="y";if(ae?(S._offset=q.t+(1-S.domain[1])*q.h,S._length=q.h*(S.domain[1]-S.domain[0]),S._m=S._length/(ee-te),S._b=-S._m*te):(S._offset=q.l+S.domain[0]*q.w,S._length=q.w*(S.domain[1]-S.domain[0]),S._m=S._length/(te-ee),S._b=-S._m*ee),S._rangebreaks=[],S._lBreaks=0,S._m2=0,S._B=[],S.rangebreaks){var le,ye;if(S._rangebreaks=S.locateBreaks(Math.min(ee,te),Math.max(ee,te)),S._rangebreaks.length){for(le=0;le<S._rangebreaks.length;le++)ye=S._rangebreaks[le],S._lBreaks+=Math.abs(ye.max-ye.min);var fe=ae;ee>te&&(fe=!fe),fe&&S._rangebreaks.reverse();var pe=fe?-1:1;for(S._m2=pe*S._length/(Math.abs(te-ee)-S._lBreaks),S._B.push(-S._m2*(ae?te:ee)),le=0;le<S._rangebreaks.length;le++)ye=S._rangebreaks[le],S._B.push(S._B[S._B.length-1]-pe*S._m2*(ye.max-ye.min));for(le=0;le<S._rangebreaks.length;le++)ye=S._rangebreaks[le],ye.pmin=oe(ye.min),ye.pmax=oe(ye.max)}}if(!isFinite(S._m)||!isFinite(S._b)||S._length<0)throw k._replotting=!1,new Error("Something went wrong with axis scaling")},S.maskBreaks=function(U){var q=S.rangebreaks||[],Q,W,Z,ee,te;q._cachedPatterns||(q._cachedPatterns=q.map(function(Be){return Be.enabled&&Be.bounds?M.simpleMap(Be.bounds,Be.pattern?a:S.d2c):null})),q._cachedValues||(q._cachedValues=q.map(function(Be){return Be.enabled&&Be.values?M.simpleMap(Be.values,S.d2c).sort(M.sorterAsc):null}));for(var ae=0;ae<q.length;ae++){var le=q[ae];if(le.enabled){if(le.bounds){var ye=le.pattern;switch(Q=q._cachedPatterns[ae],W=Q[0],Z=Q[1],ye){case v:te=new Date(U),ee=te.getUTCDay(),W>Z&&(Z+=7,ee<W&&(ee+=7));break;case x:te=new Date(U);var fe=te.getUTCHours(),pe=te.getUTCMinutes(),ge=te.getUTCSeconds(),Ae=te.getUTCMilliseconds();ee=fe+(pe/60+ge/3600+Ae/36e5),W>Z&&(Z+=24,ee<W&&(ee+=24));break;case"":ee=U;break}if(ee>=W&&ee<Z)return g}else for(var we=q._cachedValues[ae],De=0;De<we.length;De++)if(W=we[De],Z=W+le.dvalue,U>=W&&U<Z)return g}}return U},S.locateBreaks=function(U,q){var Q,W,Z,ee,te=[];if(!S.rangebreaks)return te;var ae=S.rangebreaks.slice().sort(function(xe,Le){return xe.pattern===v&&Le.pattern===x?-1:Le.pattern===v&&xe.pattern===x?1:0}),le=function(xe,Le){if(xe=M.constrain(xe,U,q),Le=M.constrain(Le,U,q),xe!==Le){for(var He=!0,Je=0;Je<te.length;Je++){var Oe=te[Je];xe<Oe.max&&Le>=Oe.min&&(xe<Oe.min&&(Oe.min=xe),Le>Oe.max&&(Oe.max=Le),He=!1)}He&&te.push({min:xe,max:Le})}};for(Q=0;Q<ae.length;Q++){var ye=ae[Q];if(ye.enabled)if(ye.bounds){var fe=U,pe=q;ye.pattern&&(fe=Math.floor(fe)),W=M.simpleMap(ye.bounds,ye.pattern?a:S.r2l),Z=W[0],ee=W[1];var ge=new Date(fe),Ae,we;switch(ye.pattern){case v:we=y,Ae=((ee<Z?7:0)+(ee-Z))*h,fe+=Z*h-(ge.getUTCDay()*h+ge.getUTCHours()*m+ge.getUTCMinutes()*u+ge.getUTCSeconds()*_+ge.getUTCMilliseconds());break;case x:we=h,Ae=((ee<Z?24:0)+(ee-Z))*m,fe+=Z*m-(ge.getUTCHours()*m+ge.getUTCMinutes()*u+ge.getUTCSeconds()*_+ge.getUTCMilliseconds());break;default:fe=Math.min(W[0],W[1]),pe=Math.max(W[0],W[1]),we=pe-fe,Ae=we}for(var De=fe;De<pe;De+=we)le(De,De+Ae)}else for(var Be=M.simpleMap(ye.values,S.d2c),Ve=0;Ve<Be.length;Ve++)Z=Be[Ve],ee=Z+ye.dvalue,le(Z,ee)}return te.sort(function(xe,Le){return xe.min-Le.min}),te},S.makeCalcdata=function(U,q,Q){var W,Z,ee,te,ae=S.type,le=ae==="date"&&U[q+"calendar"];if(q in U){if(W=U[q],te=U._length||M.minRowLength(W),M.isTypedArray(W)&&(ae==="linear"||ae==="log")){if(te===W.length)return W;if(W.subarray)return W.subarray(0,te)}if(ae==="multicategory")return V(W,te);for(Z=new Array(te),ee=0;ee<te;ee++)Z[ee]=S.d2c(W[ee],0,le,Q)}else{var ye=q+"0"in U?S.d2c(U[q+"0"],0,le):0,fe=U["d"+q]?Number(U["d"+q]):1;for(W=U[{x:"y",y:"x"}[q]],te=U._length||W.length,Z=new Array(te),ee=0;ee<te;ee++)Z[ee]=ye+ee*fe}if(S.rangebreaks)for(ee=0;ee<te;ee++)Z[ee]=S.maskBreaks(Z[ee]);return Z},S.isValidRange=function(U){return Array.isArray(U)&&U.length===2&&e(S.r2l(U[0]))&&e(S.r2l(U[1]))},S.isPtWithinRange=function(U,q){var Q=S.c2l(U[z],null,q),W=S.r2l(S.range[0]),Z=S.r2l(S.range[1]);return W<Z?W<=Q&&Q<=Z:Z<=Q&&Q<=W},S._emptyCategories=function(){S._categories=[],S._categoriesMap={}},S.clearCalc=function(){var U=S._matchGroup;if(U){var q=null,Q=null;for(var W in U){var Z=k[s.id2name(W)];if(Z._categories){q=Z._categories,Q=Z._categoriesMap;break}}q&&Q?(S._categories=q,S._categoriesMap=Q):S._emptyCategories()}else S._emptyCategories();if(S._initialCategories)for(var ee=0;ee<S._initialCategories.length;ee++)F(S._initialCategories[ee])},S.sortByInitialCategories=function(){var U=[];if(S._emptyCategories(),S._initialCategories)for(var q=0;q<S._initialCategories.length;q++)F(S._initialCategories[q]);U=U.concat(S._traceIndices);var Q=S._matchGroup;for(var W in Q)if(P!==W){var Z=k[s.id2name(W)];Z._categories=S._categories,Z._categoriesMap=S._categoriesMap,U=U.concat(Z._traceIndices)}return U};var N=k._d3locale;S.type==="date"&&(S._dateFormat=N?N.timeFormat:c,S._extraFormat=k._extraFormat),S._separators=k.separators,S._numFormat=N?N.numberFormat:T,delete S._minDtick,delete S._forceTick0}},{"../../constants/numerical":479,"../../lib":503,"./axis_ids":558,"./constants":561,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],577:[function(d,re,ne){re.exports=function(c){var M=["showexponent","showtickprefix","showticksuffix"],T=M.filter(function(a){return c[a]!==void 0}),e=function(a){return c[a]===c[T[0]]};if(T.every(e)||T.length===1)return c[T[0]]}},{}],578:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/color").contrast,M=d("./layout_attributes"),T=d("./show_dflt"),e=d("../array_container_defaults");re.exports=function(r,t,f,o,i){i||(i={});var g=T(r),p=f("showticklabels");if(p){var y=i.font||{},h=t.color,m=t.ticklabelposition||"",u=m.indexOf("inside")!==-1?c(i.bgColor):h&&h!==M.color.dflt?h:y.color;if(w.coerceFont(f,"tickfont",{family:y.family,size:y.size,color:u}),!i.noTicklabelstep&&o!=="multicategory"&&o!=="log"&&f("ticklabelstep"),i.noAng||f("tickangle"),o!=="category"){var _=f("tickformat");e(r,t,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:a}),t.tickformatstops.length||delete t.tickformatstops,!i.noExp&&!_&&o!=="date"&&(f("showexponent",g),f("exponentformat"),f("minexponent"),f("separatethousands"))}}};function a(n,r){function t(o,i){return w.coerce(n,r,M.tickformatstops,o,i)}var f=t("enabled");f&&(t("dtickrange"),t("value"))}},{"../../components/color":366,"../../lib":503,"../array_container_defaults":549,"./layout_attributes":569,"./show_dflt":577}],579:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes");re.exports=function(T,e,a,n){var r=w.coerce2(T,e,c,"ticklen"),t=w.coerce2(T,e,c,"tickwidth"),f=w.coerce2(T,e,c,"tickcolor",e.color),o=a("ticks",n.outerTicks||r||t||f?"outside":"");o||(delete e.ticklen,delete e.tickwidth,delete e.tickcolor)}},{"../../lib":503,"./layout_attributes":569}],580:[function(d,re,ne){var w=d("./clean_ticks"),c=d("../../lib").isArrayOrTypedArray;re.exports=function(T,e,a,n){function r(h){var m=T[h];return m!==void 0?m:(e._template||{})[h]}var t=r("tick0"),f=r("dtick"),o=r("tickvals"),i=c(o)?"array":f?"linear":"auto",g=a("tickmode",i);if(g==="auto")a("nticks");else if(g==="linear"){var p=e.dtick=w.dtick(f,n);e.tick0=w.tick0(t,n,e.calendar,p)}else if(n!=="multicategory"){var y=a("tickvals");y===void 0?e.tickmode="auto":a("ticktext")}}},{"../../lib":503,"./clean_ticks":560}],581:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../registry"),M=d("../../lib"),T=d("../../components/drawing"),e=d("./axes");re.exports=function(n,r,t,f){var o=n._fullLayout;if(r.length===0){e.redrawComponents(n);return}function i(x){var v=x.xaxis,b=x.yaxis;o._defs.select("#"+x.clipId+"> rect").call(T.setTranslate,0,0).call(T.setScale,1,1),x.plot.call(T.setTranslate,v._offset,b._offset).call(T.setScale,1,1);var l=x.plot.selectAll(".scatterlayer .trace");l.selectAll(".point").call(T.setPointGroupScale,1,1),l.selectAll(".textpoint").call(T.setTextPointsScale,1,1),l.call(T.hideOutsideRangePoints,x)}function g(x,v){var b=x.plotinfo,l=b.xaxis,L=b.yaxis,S=l._length,k=L._length,P=!!x.xr1,z=!!x.yr1,I=[];if(P){var D=M.simpleMap(x.xr0,l.r2l),R=M.simpleMap(x.xr1,l.r2l),B=D[1]-D[0],F=R[1]-R[0];I[0]=(D[0]*(1-v)+v*R[0]-D[0])/(D[1]-D[0])*S,I[2]=S*(1-v+v*F/B),l.range[0]=l.l2r(D[0]*(1-v)+v*R[0]),l.range[1]=l.l2r(D[1]*(1-v)+v*R[1])}else I[0]=0,I[2]=S;if(z){var V=M.simpleMap(x.yr0,L.r2l),G=M.simpleMap(x.yr1,L.r2l),J=V[1]-V[0],j=G[1]-G[0];I[1]=(V[1]*(1-v)+v*G[1]-V[1])/(V[0]-V[1])*k,I[3]=k*(1-v+v*j/J),L.range[0]=l.l2r(V[0]*(1-v)+v*G[0]),L.range[1]=L.l2r(V[1]*(1-v)+v*G[1])}else I[1]=0,I[3]=k;e.drawOne(n,l,{skipTitle:!0}),e.drawOne(n,L,{skipTitle:!0}),e.redrawComponents(n,[l._id,L._id]);var Y=P?S/I[2]:1,X=z?k/I[3]:1,oe=P?I[0]:0,se=z?I[1]:0,ie=P?I[0]/I[2]*S:0,N=z?I[1]/I[3]*k:0,U=l._offset-ie,q=L._offset-N;b.clipRect.call(T.setTranslate,oe,se).call(T.setScale,1/Y,1/X),b.plot.call(T.setTranslate,U,q).call(T.setScale,Y,X),T.setPointGroupScale(b.zoomScalePts,1/Y,1/X),T.setTextPointsScale(b.zoomScaleTxt,1/Y,1/X)}var p;f&&(p=f());function y(){for(var x={},v=0;v<r.length;v++){var b=r[v],l=b.plotinfo.xaxis,L=b.plotinfo.yaxis;b.xr1&&(x[l._name+".range"]=b.xr1.slice()),b.yr1&&(x[L._name+".range"]=b.yr1.slice())}return p&&p(),c.call("relayout",n,x).then(function(){for(var S=0;S<r.length;S++)i(r[S].plotinfo)})}function h(){for(var x={},v=0;v<r.length;v++){var b=r[v],l=b.plotinfo.xaxis,L=b.plotinfo.yaxis;b.xr0&&(x[l._name+".range"]=b.xr0.slice()),b.yr0&&(x[L._name+".range"]=b.yr0.slice())}return c.call("relayout",n,x).then(function(){for(var S=0;S<r.length;S++)i(r[S].plotinfo)})}var m,u,_,s=w.ease(t.easing);n._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(_),_=null,h()});function A(){u=Date.now();for(var x=Math.min(1,(u-m)/t.duration),v=s(x),b=0;b<r.length;b++)g(r[b],v);u-m>t.duration?(y(),_=window.cancelAnimationFrame(A)):_=window.requestAnimationFrame(A)}return m=Date.now(),_=window.requestAnimationFrame(A),Promise.resolve()}},{"../../components/drawing":388,"../../lib":503,"../../registry":638,"./axes":554,"@plotly/d3":58}],582:[function(d,re,ne){var w=d("../../registry").traceIs,c=d("./axis_autotype");re.exports=function(r,t,f,o){f("autotypenumbers",o.autotypenumbersDflt);var i=f("type",(o.splomStash||{}).type);i==="-"&&(M(t,o.data),t.type==="-"?t.type="linear":r.type=t.type)};function M(n,r){if(n.type==="-"){var t=n._id,f=t.charAt(0),o;t.indexOf("scene")!==-1&&(t=f);var i=T(r,t,f);if(!!i){if(i.type==="histogram"&&f==={v:"y",h:"x"}[i.orientation||"v"]){n.type="linear";return}var g=f+"calendar",p=i[g],y={noMultiCategory:!w(i,"cartesian")||w(i,"noMultiCategory")};if(i.type==="box"&&i._hasPreCompStats&&f==={h:"x",v:"y"}[i.orientation||"v"]&&(y.noMultiCategory=!0),y.autotypenumbers=n.autotypenumbers,a(i,f)){var h=e(i),m=[];for(o=0;o<r.length;o++){var u=r[o];!w(u,"box-violin")||(u[f+"axis"]||f)!==t||(u[h]!==void 0?m.push(u[h][0]):u.name!==void 0?m.push(u.name):m.push("text"),u[g]!==p&&(p=void 0))}n.type=c(m,p,y)}else if(i.type==="splom"){var _=i.dimensions,s=_[i._axesDim[t]];s.visible&&(n.type=c(s.values,p,y))}else n.type=c(i[f]||[i[f+"0"]],p,y)}}}function T(n,r,t){for(var f=0;f<n.length;f++){var o=n[f];if(o.type==="splom"&&o._length>0&&(o["_"+t+"axes"]||{})[r])return o;if((o[t+"axis"]||t)===r){if(a(o,t))return o;if((o[t]||[]).length||o[t+"0"])return o}}}function e(n){return{v:"x",h:"y"}[n.orientation||"v"]}function a(n,r){var t=e(n),f=w(n,"box-violin"),o=w(n._fullInput||{},"candlestick");return f&&!o&&r===t&&n[t]===void 0&&n[t+"0"]===void 0}},{"../../registry":638,"./axis_autotype":555}],583:[function(d,re,ne){var w=d("../registry"),c=d("../lib");ne.manageCommandObserver=function(r,t,f,o){var i={},g=!0;t&&t._commandObserver&&(i=t._commandObserver),i.cache||(i.cache={}),i.lookupTable={};var p=ne.hasSimpleAPICommandBindings(r,f,i.lookupTable);if(t&&t._commandObserver){if(p)return i;if(t._commandObserver.remove)return t._commandObserver.remove(),t._commandObserver=null,i}if(p){M(r,p,i.cache),i.check=function(){if(!!g){var u=M(r,p,i.cache);return u.changed&&o&&i.lookupTable[u.value]!==void 0&&(i.disable(),Promise.resolve(o({value:u.value,type:p.type,prop:p.prop,traces:p.traces,index:i.lookupTable[u.value]})).then(i.enable,i.enable)),u.changed}};for(var y=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],h=0;h<y.length;h++)r._internalOn(y[h],i.check);i.remove=function(){for(var m=0;m<y.length;m++)r._removeInternalListener(y[m],i.check)}}else c.log("Unable to automatically bind plot updates to API command"),i.lookupTable={},i.remove=function(){};return i.disable=function(){g=!1},i.enable=function(){g=!0},t&&(t._commandObserver=i),i},ne.hasSimpleAPICommandBindings=function(r,t,f){var o,i=t.length,g;for(o=0;o<i;o++){var p,y=t[o],h=y.method,m=y.args;if(Array.isArray(m)||(m=[]),!h)return!1;var u=ne.computeAPICommandBindings(r,h,m);if(u.length!==1)return!1;if(!g)g=u[0],Array.isArray(g.traces)&&g.traces.sort();else{if(p=u[0],p.type!==g.type||p.prop!==g.prop)return!1;if(Array.isArray(g.traces))if(Array.isArray(p.traces)){p.traces.sort();for(var _=0;_<g.traces.length;_++)if(g.traces[_]!==p.traces[_])return!1}else return!1;else if(p.prop!==g.prop)return!1}p=u[0];var s=p.value;if(Array.isArray(s))if(s.length===1)s=s[0];else return!1;f&&(f[s]=o)}return g};function M(r,t,f){var o,i,g,p=!1;if(t.type==="data")o=r._fullData[t.traces!==null?t.traces[0]:0];else if(t.type==="layout")o=r._fullLayout;else return!1;return i=c.nestedProperty(o,t.prop).get(),g=f[t.type]=f[t.type]||{},g.hasOwnProperty(t.prop)&&g[t.prop]!==i&&(p=!0),g[t.prop]=i,{changed:p,value:i}}ne.executeAPICommand=function(r,t,f){if(t==="skip")return Promise.resolve();var o=w.apiMethodRegistry[t],i=[r];Array.isArray(f)||(f=[]);for(var g=0;g<f.length;g++)i.push(f[g]);return o.apply(null,i).catch(function(p){return c.warn("API call to Plotly."+t+" rejected.",p),Promise.reject(p)})},ne.computeAPICommandBindings=function(r,t,f){var o;switch(Array.isArray(f)||(f=[]),t){case"restyle":o=a(r,f);break;case"relayout":o=e(r,f);break;case"update":o=a(r,[f[0],f[2]]).concat(e(r,[f[1]]));break;case"animate":o=T(r,f);break;default:o=[]}return o};function T(r,t){return Array.isArray(t[0])&&t[0].length===1&&["string","number"].indexOf(typeof t[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]:[]}function e(r,t){var f=[],o=t[0],i={};if(typeof o=="string")i[o]=t[1];else if(c.isPlainObject(o))i=o;else return f;return n(i,function(g,p,y){f.push({type:"layout",prop:g,value:y})},"",0),f}function a(r,t){var f,o,i,g,p=[];if(o=t[0],i=t[1],f=t[2],g={},typeof o=="string")g[o]=i;else if(c.isPlainObject(o))g=o,f===void 0&&(f=i);else return p;return f===void 0&&(f=null),n(g,function(y,h,m){var u,_;if(Array.isArray(m)){_=m.slice();var s=Math.min(_.length,r.data.length);f&&(s=Math.min(s,f.length)),u=[];for(var A=0;A<s;A++)u[A]=f?f[A]:A}else _=m,u=f?f.slice():null;if(u===null)Array.isArray(_)&&(_=_[0]);else if(Array.isArray(u)){if(!Array.isArray(_)){var x=_;_=[];for(var v=0;v<u.length;v++)_[v]=x}_.length=Math.min(u.length,_.length)}p.push({type:"data",prop:y,traces:u,value:_})},"",0),p}function n(r,t,f,o){Object.keys(r).forEach(function(i){var g=r[i];if(i[0]!=="_"){var p=f+(o>0?".":"")+i;c.isPlainObject(g)?n(g,t,p,o+1):t(p,i,g)}})}},{"../lib":503,"../registry":638}],584:[function(d,re,ne){var w=d("../lib/extend").extendFlat;ne.attributes=function(c,M){c=c||{},M=M||{};var T={valType:"info_array",editType:c.editType,items:[{valType:"number",min:0,max:1,editType:c.editType},{valType:"number",min:0,max:1,editType:c.editType}],dflt:[0,1]};c.name&&c.name+"",c.trace,M.description&&""+M.description;var e={x:w({},T,{}),y:w({},T,{}),editType:c.editType};return c.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:c.editType},e.column={valType:"integer",min:0,dflt:0,editType:c.editType}),e},ne.defaults=function(c,M,T,e){var a=e&&e.x||[0,1],n=e&&e.y||[0,1],r=M.grid;if(r){var t=T("domain.column");t!==void 0&&(t<r.columns?a=r._domains.x[t]:delete c.domain.column);var f=T("domain.row");f!==void 0&&(f<r.rows?n=r._domains.y[f]:delete c.domain.row)}var o=T("domain.x",a),i=T("domain.y",n);o[0]<o[1]||(c.domain.x=a.slice()),i[0]<i[1]||(c.domain.y=n.slice())}},{"../lib/extend":493}],585:[function(d,re,ne){re.exports=function(w){var c=w.editType,M=w.colorEditType;M===void 0&&(M=c);var T={family:{valType:"string",noBlank:!0,strict:!0,editType:c},size:{valType:"number",min:1,editType:c},color:{valType:"color",editType:M},editType:c};return w.autoSize&&(T.size.dflt="auto"),w.autoColor&&(T.color.dflt="auto"),w.arrayOk&&(T.family.arrayOk=!0,T.size.arrayOk=!0,T.color.arrayOk=!0),T}},{}],586:[function(d,re,ne){re.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],587:[function(d,re,ne){ne.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},ne.axesNames=["lonaxis","lataxis"],ne.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},ne.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},ne.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},ne.clipPad=.001,ne.precision=.1,ne.landColor="#F0DC82",ne.waterColor="#3399FF",ne.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},ne.sphereSVG={type:"Sphere"},ne.fillLayers={ocean:1,land:1,lakes:1},ne.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},ne.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],ne.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],ne.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],588:[function(d,re,ne){var w=d("@plotly/d3"),c=d("d3-geo"),M=c.geoPath,T=c.geoDistance,e=d("d3-geo-projection"),a=d("../../registry"),n=d("../../lib"),r=n.strTranslate,t=d("../../components/color"),f=d("../../components/drawing"),o=d("../../components/fx"),i=d("../plots"),g=d("../cartesian/axes"),p=d("../cartesian/autorange").getAutoRange,y=d("../../components/dragelement"),h=d("../cartesian/select").prepSelect,m=d("../cartesian/select").clearSelect,u=d("../cartesian/select").selectOnClick,_=d("./zoom"),s=d("./constants"),A=d("../../lib/geo_location_utils"),x=d("../../lib/topojson_utils"),v=d("topojson-client").feature;function b(P){this.id=P.id,this.graphDiv=P.graphDiv,this.container=P.container,this.topojsonURL=P.topojsonURL,this.isStatic=P.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var l=b.prototype;re.exports=function(z){return new b(z)},l.plot=function(P,z,I){var D=this,R=z[this.id],B=[],F=!1;for(var V in s.layerNameToAdjective)if(V!=="frame"&&R["show"+V]){F=!0;break}for(var G=0;G<P.length;G++)if(P[0][0].trace.locationmode){F=!0;break}if(F){var J=x.getTopojsonName(R);(D.topojson===null||J!==D.topojsonName)&&(D.topojsonName=J,PlotlyGeoAssets.topojson[D.topojsonName]===void 0&&B.push(D.fetchTopojson()))}B=B.concat(A.fetchTraceGeoData(P)),I.push(new Promise(function(j,Y){Promise.all(B).then(function(){D.topojson=PlotlyGeoAssets.topojson[D.topojsonName],D.update(P,z),j()}).catch(Y)}))},l.fetchTopojson=function(){var P=this,z=x.getTopojsonPath(P.topojsonURL,P.topojsonName);return new Promise(function(I,D){w.json(z,function(R,B){if(R)return R.status===404?D(new Error(["plotly.js could not find topojson file at",z,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):D(new Error(["unexpected error while fetching topojson file at",z].join(" ")));PlotlyGeoAssets.topojson[P.topojsonName]=B,I()})})},l.update=function(P,z){var I=z[this.id];this.hasChoropleth=!1;for(var D=0;D<P.length;D++){var R=P[D],B=R[0].trace;B.type==="choropleth"&&(this.hasChoropleth=!0),B.visible===!0&&B._length>0&&B._module.calcGeoJSON(R,z)}var F=this.updateProjection(P,z);if(!F){(!this.viewInitial||this.scope!==I.scope)&&this.saveViewInitial(I),this.scope=I.scope,this.updateBaseLayers(z,I),this.updateDims(z,I),this.updateFx(z,I),i.generalUpdatePerTraceModule(this.graphDiv,this,P,I);var V=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=V.selectAll(".point"),this.dataPoints.text=V.selectAll("text"),this.dataPaths.line=V.selectAll(".js-line");var G=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=G.selectAll("path"),this.render()}},l.updateProjection=function(P,z){var I=this.graphDiv,D=z[this.id],R=z._size,B=D.domain,F=D.projection,V=D.lonaxis,G=D.lataxis,J=V._ax,j=G._ax,Y=this.projection=L(D),X=[[R.l+R.w*B.x[0],R.t+R.h*(1-B.y[1])],[R.l+R.w*B.x[1],R.t+R.h*(1-B.y[0])]],oe=D.center||{},se=F.rotation||{},ie=V.range||[],N=G.range||[];if(D.fitbounds){J._length=X[1][0]-X[0][0],j._length=X[1][1]-X[0][1],J.range=p(I,J),j.range=p(I,j);var U=(J.range[0]+J.range[1])/2,q=(j.range[0]+j.range[1])/2;if(D._isScoped)oe={lon:U,lat:q};else if(D._isClipped){oe={lon:U,lat:q},se={lon:U,lat:q,roll:se.roll};var Q=F.type,W=s.lonaxisSpan[Q]/2||180,Z=s.lataxisSpan[Q]/2||90;ie=[U-W,U+W],N=[q-Z,q+Z]}else oe={lon:U,lat:q},se={lon:U,lat:se.lat,roll:se.roll}}Y.center([oe.lon-se.lon,oe.lat-se.lat]).rotate([-se.lon,-se.lat,se.roll]).parallels(F.parallels);var ee=k(ie,N);Y.fitExtent(X,ee);var te=this.bounds=Y.getBounds(ee),ae=this.fitScale=Y.scale(),le=Y.translate();if(D.fitbounds){var ye=Y.getBounds(k(J.range,j.range)),fe=Math.min((te[1][0]-te[0][0])/(ye[1][0]-ye[0][0]),(te[1][1]-te[0][1])/(ye[1][1]-ye[0][1]));isFinite(fe)?Y.scale(fe*ae):n.warn("Something went wrong during"+this.id+"fitbounds computations.")}else Y.scale(F.scale*ae);var pe=this.midPt=[(te[0][0]+te[1][0])/2,(te[0][1]+te[1][1])/2];if(Y.translate([le[0]+(pe[0]-le[0]),le[1]+(pe[1]-le[1])]).clipExtent(te),D._isAlbersUsa){var ge=Y([oe.lon,oe.lat]),Ae=Y.translate();Y.translate([Ae[0]-(ge[0]-Ae[0]),Ae[1]-(ge[1]-Ae[1])])}},l.updateBaseLayers=function(P,z){var I=this,D=I.topojson,R=I.layers,B=I.basePaths;function F(X){return X==="lonaxis"||X==="lataxis"}function V(X){return Boolean(s.lineLayers[X])}function G(X){return Boolean(s.fillLayers[X])}var J=this.hasChoropleth?s.layersForChoropleth:s.layers,j=J.filter(function(X){return V(X)||G(X)?z["show"+X]:F(X)?z[X].showgrid:!0}),Y=I.framework.selectAll(".layer").data(j,String);Y.exit().each(function(X){delete R[X],delete B[X],w.select(this).remove()}),Y.enter().append("g").attr("class",function(X){return"layer "+X}).each(function(X){var oe=R[X]=w.select(this);X==="bg"?I.bgRect=oe.append("rect").style("pointer-events","all"):F(X)?B[X]=oe.append("path").style("fill","none"):X==="backplot"?oe.append("g").classed("choroplethlayer",!0):X==="frontplot"?oe.append("g").classed("scatterlayer",!0):V(X)?B[X]=oe.append("path").style("fill","none").style("stroke-miterlimit",2):G(X)&&(B[X]=oe.append("path").style("stroke","none"))}),Y.order(),Y.each(function(X){var oe=B[X],se=s.layerNameToAdjective[X];X==="frame"?oe.datum(s.sphereSVG):V(X)||G(X)?oe.datum(v(D,D.objects[X])):F(X)&&oe.datum(S(X,z,P)).call(t.stroke,z[X].gridcolor).call(f.dashLine,"",z[X].gridwidth),V(X)?oe.call(t.stroke,z[se+"color"]).call(f.dashLine,"",z[se+"width"]):G(X)&&oe.call(t.fill,z[se+"color"])})},l.updateDims=function(P,z){var I=this.bounds,D=(z.framewidth||0)/2,R=I[0][0]-D,B=I[0][1]-D,F=I[1][0]-R+D,V=I[1][1]-B+D;f.setRect(this.clipRect,R,B,F,V),this.bgRect.call(f.setRect,R,B,F,V).call(t.fill,z.bgcolor),this.xaxis._offset=R,this.xaxis._length=F,this.yaxis._offset=B,this.yaxis._length=V},l.updateFx=function(P,z){var I=this,D=I.graphDiv,R=I.bgRect,B=P.dragmode,F=P.clickmode;if(I.isStatic)return;function V(){var Y=I.viewInitial,X={};for(var oe in Y)X[I.id+"."+oe]=Y[oe];a.call("_guiRelayout",D,X),D.emit("plotly_doubleclick",null)}function G(Y){return I.projection.invert([Y[0]+I.xaxis._offset,Y[1]+I.yaxis._offset])}var J;B==="select"?J=function(Y,X){var oe=Y.range={};oe[I.id]=[G([X.xmin,X.ymin]),G([X.xmax,X.ymax])]}:B==="lasso"&&(J=function(Y,X,oe){var se=Y.lassoPoints={};se[I.id]=oe.filtered.map(G)});var j={element:I.bgRect.node(),gd:D,plotinfo:{id:I.id,xaxis:I.xaxis,yaxis:I.yaxis,fillRangeItems:J},xaxes:[I.xaxis],yaxes:[I.yaxis],subplot:I.id,clickFn:function(Y){Y===2&&m(D)}};B==="pan"?(R.node().onmousedown=null,R.call(_(I,z)),R.on("dblclick.zoom",V),D._context._scrollZoom.geo||R.on("wheel.zoom",null)):(B==="select"||B==="lasso")&&(R.on(".zoom",null),j.prepFn=function(Y,X,oe){h(Y,X,oe,j,B)},y.init(j)),R.on("mousemove",function(){var Y=I.projection.invert(n.getPositionFromD3Event());if(!Y)return y.unhover(D,w.event);I.xaxis.p2c=function(){return Y[0]},I.yaxis.p2c=function(){return Y[1]},o.hover(D,w.event,I.id)}),R.on("mouseout",function(){D._dragging||y.unhover(D,w.event)}),R.on("click",function(){B!=="select"&&B!=="lasso"&&(F.indexOf("select")>-1&&u(w.event,D,[I.xaxis],[I.yaxis],I.id,j),F.indexOf("event")>-1&&o.click(D,w.event))})},l.makeFramework=function(){var P=this,z=P.graphDiv,I=z._fullLayout,D="clip"+I._uid+P.id;P.clipDef=I._clips.append("clipPath").attr("id",D),P.clipRect=P.clipDef.append("rect"),P.framework=w.select(P.container).append("g").attr("class","geo "+P.id).call(f.setClipUrl,D,z),P.project=function(R){var B=P.projection(R);return B?[B[0]-P.xaxis._offset,B[1]-P.yaxis._offset]:[null,null]},P.xaxis={_id:"x",c2p:function(R){return P.project(R)[0]}},P.yaxis={_id:"y",c2p:function(R){return P.project(R)[1]}},P.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},g.setConvert(P.mockAxis,I)},l.saveViewInitial=function(P){var z=P.center||{},I=P.projection,D=I.rotation||{};this.viewInitial={fitbounds:P.fitbounds,"projection.scale":I.scale};var R;P._isScoped?R={"center.lon":z.lon,"center.lat":z.lat}:P._isClipped?R={"projection.rotation.lon":D.lon,"projection.rotation.lat":D.lat}:R={"center.lon":z.lon,"center.lat":z.lat,"projection.rotation.lon":D.lon},n.extendFlat(this.viewInitial,R)},l.render=function(){var P=this.projection,z=P.getPath(),I;function D(B){var F=P(B.lonlat);return F?r(F[0],F[1]):null}function R(B){return P.isLonLatOverEdges(B.lonlat)?"none":null}for(I in this.basePaths)this.basePaths[I].attr("d",z);for(I in this.dataPaths)this.dataPaths[I].attr("d",function(B){return z(B.geojson)});for(I in this.dataPoints)this.dataPoints[I].attr("display",R).attr("transform",D)};function L(P){var z=P.projection,I=z.type,D=s.projNames[I];D="geo"+n.titleCase(D);for(var R=c[D]||e[D],B=R(),F=P._isSatellite?Math.acos(1/z.distance)*180/Math.PI:P._isClipped?s.lonaxisSpan[I]/2:null,V=["center","rotate","parallels","clipExtent"],G=function(Y){return Y?B:[]},J=0;J<V.length;J++){var j=V[J];typeof B[j]!="function"&&(B[j]=G)}return B.isLonLatOverEdges=function(Y){if(B(Y)===null)return!0;if(F){var X=B.rotate(),oe=T(Y,[-X[0],-X[1]]),se=F*Math.PI/180;return oe>se}else return!1},B.getPath=function(){return M().projection(B)},B.getBounds=function(Y){return B.getPath().bounds(Y)},B.precision(s.precision),P._isSatellite&&B.tilt(z.tilt).distance(z.distance),F&&B.clipAngle(F-s.clipPad),B}function S(P,z,I){var D=1e-6,R=2.5,B=z[P],F=s.scopeDefaults[z.scope],V,G,J;P==="lonaxis"?(V=F.lonaxisRange,G=F.lataxisRange,J=function(q,Q){return[q,Q]}):P==="lataxis"&&(V=F.lataxisRange,G=F.lonaxisRange,J=function(q,Q){return[Q,q]});var j={type:"linear",range:[V[0],V[1]-D],tick0:B.tick0,dtick:B.dtick};g.setConvert(j,I);var Y=g.calcTicks(j);!z.isScoped&&P==="lonaxis"&&Y.pop();for(var X=Y.length,oe=new Array(X),se=0;se<X;se++)for(var ie=Y[se].x,N=oe[se]=[],U=G[0];U<G[1]+R;U+=R)N.push(J(ie,U));return{type:"MultiLineString",coordinates:oe}}function k(P,z){var I=s.clipPad,D=P[0]+I,R=P[1]-I,B=z[0]+I,F=z[1]-I;D>0&&R<0&&(R+=360);var V=(R-D)/4;return{type:"Polygon",coordinates:[[[D,B],[D,F],[D+V,F],[D+2*V,F],[D+3*V,F],[R,F],[R,B],[R-V,B],[R-2*V,B],[R-3*V,B],[D,B]]]}}},{"../../components/color":366,"../../components/dragelement":385,"../../components/drawing":388,"../../components/fx":406,"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/topojson_utils":532,"../../registry":638,"../cartesian/autorange":553,"../cartesian/axes":554,"../cartesian/select":575,"../plots":619,"./constants":587,"./zoom":592,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":315}],589:[function(d,re,ne){var w=d("../../plots/get_data").getSubplotCalcData,c=d("../../lib").counterRegex,M=d("./geo"),T="geo",e=c(T),a={};a[T]={valType:"subplotid",dflt:T,editType:"calc"};function n(f){for(var o=f._fullLayout,i=f.calcdata,g=o._subplots[T],p=0;p<g.length;p++){var y=g[p],h=w(i,T,y),m=o[y],u=m._subplot;u||(u=M({id:y,graphDiv:f,container:o._geolayer.node(),topojsonURL:f._context.topojsonURL,staticPlot:f._context.staticPlot}),o[y]._subplot=u),u.plot(h,o,f._promises)}}function r(f,o,i,g){for(var p=g._subplots[T]||[],y=0;y<p.length;y++){var h=p[y],m=g[h]._subplot;!o[h]&&!!m&&(m.framework.remove(),m.clipDef.remove())}}function t(f){for(var o=f._fullLayout,i=o._subplots[T],g=0;g<i.length;g++){var p=o[i[g]],y=p._subplot;y.updateFx(o,p)}}re.exports={attr:T,name:T,idRoot:T,idRegex:e,attrRegex:e,attributes:a,layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),plot:n,updateFx:t,clean:r}},{"../../lib":503,"../../plots/get_data":593,"./geo":588,"./layout_attributes":590,"./layout_defaults":591}],590:[function(d,re,ne){var w=d("../../components/color/attributes"),c=d("../domain").attributes,M=d("./constants"),T=d("../../plot_api/edit_types").overrideAll,e=d("../../lib/sort_object_keys"),a={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:w.lightLine},gridwidth:{valType:"number",min:0,dflt:1}},n=re.exports=T({domain:c({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:e(M.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:e(M.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:w.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:M.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:M.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:M.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:M.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:w.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:w.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:w.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:w.background},lonaxis:a,lataxis:a},"plot","from-root");n.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":365,"../../lib/sort_object_keys":526,"../../plot_api/edit_types":536,"../domain":584,"./constants":587}],591:[function(d,re,ne){var w=d("../../lib"),c=d("../subplot_defaults"),M=d("../get_data").getSubplotData,T=d("./constants"),e=d("./layout_attributes"),a=T.axesNames;re.exports=function(t,f,o){c(t,f,o,{type:"geo",attributes:e,handleDefaults:n,fullData:o,partition:"y"})};function n(r,t,f,o){var i=M(o.fullData,"geo",o.id),g=i.map(function(N){return N._expandedIndex}),p=f("resolution"),y=f("scope"),h=T.scopeDefaults[y],m=f("projection.type",h.projType),u=t._isAlbersUsa=m==="albers usa";u&&(y=t.scope="usa");var _=t._isScoped=y!=="world",s=t._isSatellite=m==="satellite",A=t._isConic=m.indexOf("conic")!==-1||m==="albers",x=t._isClipped=!!T.lonaxisSpan[m];if(r.visible===!1){var v=w.extendDeep({},t._template);v.showcoastlines=!1,v.showcountries=!1,v.showframe=!1,v.showlakes=!1,v.showland=!1,v.showocean=!1,v.showrivers=!1,v.showsubunits=!1,v.lonaxis&&(v.lonaxis.showgrid=!1),v.lataxis&&(v.lataxis.showgrid=!1),t._template=v}for(var b=f("visible"),l,L=0;L<a.length;L++){var S=a[L],k=[30,10][L],P;if(_)P=h[S+"Range"];else{var z=T[S+"Span"],I=(z[m]||z["*"])/2,D=f("projection.rotation."+S.substr(0,3),h.projRotate[L]);P=[D-I,D+I]}var R=f(S+".range",P);f(S+".tick0"),f(S+".dtick",k),l=f(S+".showgrid",b?void 0:!1),l&&(f(S+".gridcolor"),f(S+".gridwidth")),t[S]._ax={type:"linear",_id:S.slice(0,3),_traceIndices:g,setScale:w.identity,c2l:w.identity,r2l:w.identity,autorange:!0,range:R.slice(),_m:1,_input:{}}}var B=t.lonaxis.range,F=t.lataxis.range,V=B[0],G=B[1];V>0&&G<0&&(G+=360);var J=(V+G)/2,j;if(!u){var Y=_?h.projRotate:[J,0,0];j=f("projection.rotation.lon",Y[0]),f("projection.rotation.lat",Y[1]),f("projection.rotation.roll",Y[2]),l=f("showcoastlines",!_&&b),l&&(f("coastlinecolor"),f("coastlinewidth")),l=f("showocean",b?void 0:!1),l&&f("oceancolor")}var X,oe;if(u?(X=-96.6,oe=38.7):(X=_?J:j,oe=(F[0]+F[1])/2),f("center.lon",X),f("center.lat",oe),s&&(f("projection.tilt"),f("projection.distance")),A){var se=h.projParallels||[0,60];f("projection.parallels",se)}f("projection.scale"),l=f("showland",b?void 0:!1),l&&f("landcolor"),l=f("showlakes",b?void 0:!1),l&&f("lakecolor"),l=f("showrivers",b?void 0:!1),l&&(f("rivercolor"),f("riverwidth")),l=f("showcountries",_&&y!=="usa"&&b),l&&(f("countrycolor"),f("countrywidth")),(y==="usa"||y==="north america"&&p===50)&&(f("showsubunits",b),f("subunitcolor"),f("subunitwidth")),_||(l=f("showframe",b),l&&(f("framecolor"),f("framewidth"))),f("bgcolor");var ie=f("fitbounds");ie&&(delete t.projection.scale,_?(delete t.center.lon,delete t.center.lat):x?(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon,delete t.projection.rotation.lat,delete t.lonaxis.range,delete t.lataxis.range):(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon))}},{"../../lib":503,"../get_data":593,"../subplot_defaults":632,"./constants":587,"./layout_attributes":590}],592:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../registry"),T=Math.PI/180,e=180/Math.PI,a={cursor:"pointer"},n={cursor:"auto"};function r(S,k){var P=S.projection,z;return k._isScoped?z=o:k._isClipped?z=g:z=i,z(S,P)}re.exports=r;function t(S,k){return w.behavior.zoom().translate(k.translate()).scale(k.scale())}function f(S,k,P){var z=S.id,I=S.graphDiv,D=I.layout,R=D[z],B=I._fullLayout,F=B[z],V={},G={};function J(j,Y){V[z+"."+j]=c.nestedProperty(R,j).get(),M.call("_storeDirectGUIEdit",D,B._preGUI,V);var X=c.nestedProperty(F,j);X.get()!==Y&&(X.set(Y),c.nestedProperty(R,j).set(Y),G[z+"."+j]=Y)}P(J),J("projection.scale",k.scale()/S.fitScale),J("fitbounds",!1),I.emit("plotly_relayout",G)}function o(S,k){var P=t(S,k);function z(){w.select(this).style(a)}function I(){k.scale(w.event.scale).translate(w.event.translate),S.render();var B=k.invert(S.midPt);S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/S.fitScale,"geo.center.lon":B[0],"geo.center.lat":B[1]})}function D(B){var F=k.invert(S.midPt);B("center.lon",F[0]),B("center.lat",F[1])}function R(){w.select(this).style(n),f(S,k,D)}return P.on("zoomstart",z).on("zoom",I).on("zoomend",R),P}function i(S,k){var P=t(S,k),z=2,I,D,R,B,F,V,G,J,j;function Y(U){return k.invert(U)}function X(U){var q=Y(U);if(!q)return!0;var Q=k(q);return Math.abs(Q[0]-U[0])>z||Math.abs(Q[1]-U[1])>z}function oe(){w.select(this).style(a),I=w.mouse(this),D=k.rotate(),R=k.translate(),B=D,F=Y(I)}function se(){if(V=w.mouse(this),X(I)){P.scale(k.scale()),P.translate(k.translate());return}k.scale(w.event.scale),k.translate([R[0],w.event.translate[1]]),F?Y(V)&&(J=Y(V),G=[B[0]+(J[0]-F[0]),D[1],D[2]],k.rotate(G),B=G):(I=V,F=Y(I)),j=!0,S.render();var U=k.rotate(),q=k.invert(S.midPt);S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/S.fitScale,"geo.center.lon":q[0],"geo.center.lat":q[1],"geo.projection.rotation.lon":-U[0]})}function ie(){w.select(this).style(n),j&&f(S,k,N)}function N(U){var q=k.rotate(),Q=k.invert(S.midPt);U("projection.rotation.lon",-q[0]),U("center.lon",Q[0]),U("center.lat",Q[1])}return P.on("zoomstart",oe).on("zoom",se).on("zoomend",ie),P}function g(S,k){k.rotate(),k.scale();var P=t(S,k),z=L(P,"zoomstart","zoom","zoomend"),I=0,D=P.on,R;P.on("zoomstart",function(){w.select(this).style(a);var J=w.mouse(this),j=k.rotate(),Y=j,X=k.translate(),oe=y(j);R=p(k,J),D.call(P,"zoom",function(){var se=w.mouse(this);if(k.scale(w.event.scale),!R)J=se,R=p(k,J);else if(p(k,se)){k.rotate(j).translate(X);var ie=p(k,se),N=m(R,ie),U=x(h(oe,N)),q=u(U,R,Y);(!isFinite(q[0])||!isFinite(q[1])||!isFinite(q[2]))&&(q=Y),k.rotate(q),Y=q}F(z.of(this,arguments))}),B(z.of(this,arguments))}).on("zoomend",function(){w.select(this).style(n),D.call(P,"zoom",null),V(z.of(this,arguments)),f(S,k,G)}).on("zoom.redraw",function(){S.render();var J=k.rotate();S.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/S.fitScale,"geo.projection.rotation.lon":-J[0],"geo.projection.rotation.lat":-J[1]})});function B(J){I++||J({type:"zoomstart"})}function F(J){J({type:"zoom"})}function V(J){--I||J({type:"zoomend"})}function G(J){var j=k.rotate();J("projection.rotation.lon",-j[0]),J("projection.rotation.lat",-j[1])}return w.rebind(P,z,"on")}function p(S,k){var P=S.invert(k);return P&&isFinite(P[0])&&isFinite(P[1])&&v(P)}function y(S){var k=.5*S[0]*T,P=.5*S[1]*T,z=.5*S[2]*T,I=Math.sin(k),D=Math.cos(k),R=Math.sin(P),B=Math.cos(P),F=Math.sin(z),V=Math.cos(z);return[D*B*V+I*R*F,I*B*V-D*R*F,D*R*V+I*B*F,D*B*F-I*R*V]}function h(S,k){var P=S[0],z=S[1],I=S[2],D=S[3],R=k[0],B=k[1],F=k[2],V=k[3];return[P*R-z*B-I*F-D*V,P*B+z*R+I*V-D*F,P*F-z*V+I*R+D*B,P*V+z*F-I*B+D*R]}function m(S,k){if(!(!S||!k)){var P=l(S,k),z=Math.sqrt(b(P,P)),I=.5*Math.acos(Math.max(-1,Math.min(1,b(S,k)))),D=Math.sin(I)/z;return z&&[Math.cos(I),P[2]*D,-P[1]*D,P[0]*D]}}function u(S,k,P){var z=A(k,2,S[0]);z=A(z,1,S[1]),z=A(z,0,S[2]-P[2]);var I=k[0],D=k[1],R=k[2],B=z[0],F=z[1],V=z[2],G=Math.atan2(D,I)*e,J=Math.sqrt(I*I+D*D),j,Y;Math.abs(F)>J?(Y=(F>0?90:-90)-G,j=0):(Y=Math.asin(F/J)*e-G,j=Math.sqrt(J*J-F*F));var X=180-Y-2*G,oe=(Math.atan2(V,B)-Math.atan2(R,j))*e,se=(Math.atan2(V,B)-Math.atan2(R,-j))*e,ie=_(P[0],P[1],Y,oe),N=_(P[0],P[1],X,se);return ie<=N?[Y,oe,P[2]]:[X,se,P[2]]}function _(S,k,P,z){var I=s(P-S),D=s(z-k);return Math.sqrt(I*I+D*D)}function s(S){return(S%360+540)%360-180}function A(S,k,P){var z=P*T,I=S.slice(),D=k===0?1:0,R=k===2?1:2,B=Math.cos(z),F=Math.sin(z);return I[D]=S[D]*B-S[R]*F,I[R]=S[R]*B+S[D]*F,I}function x(S){return[Math.atan2(2*(S[0]*S[1]+S[2]*S[3]),1-2*(S[1]*S[1]+S[2]*S[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(S[0]*S[2]-S[3]*S[1]))))*e,Math.atan2(2*(S[0]*S[3]+S[1]*S[2]),1-2*(S[2]*S[2]+S[3]*S[3]))*e]}function v(S){var k=S[0]*T,P=S[1]*T,z=Math.cos(P);return[z*Math.cos(k),z*Math.sin(k),Math.sin(P)]}function b(S,k){for(var P=0,z=0,I=S.length;z<I;++z)P+=S[z]*k[z];return P}function l(S,k){return[S[1]*k[2]-S[2]*k[1],S[2]*k[0]-S[0]*k[2],S[0]*k[1]-S[1]*k[0]]}function L(S){for(var k=0,P=arguments.length,z=[];++k<P;)z.push(arguments[k]);var I=w.dispatch.apply(null,z);return I.of=function(D,R){return function(B){var F;try{F=B.sourceEvent=w.event,B.target=S,w.event=B,I[B.type].apply(D,R)}finally{w.event=F}}},I}},{"../../lib":503,"../../registry":638,"@plotly/d3":58}],593:[function(d,re,ne){var w=d("../registry"),c=d("./cartesian/constants").SUBPLOT_PATTERN;ne.getSubplotCalcData=function(M,T,e){var a=w.subplotsRegistry[T];if(!a)return[];for(var n=a.attr,r=[],t=0;t<M.length;t++){var f=M[t],o=f[0].trace;o[n]===e&&r.push(f)}return r},ne.getModuleCalcData=function(M,T){var e=[],a=[],n;if(typeof T=="string"?n=w.getModule(T).plot:typeof T=="function"?n=T:n=T.plot,!n)return[e,M];for(var r=0;r<M.length;r++){var t=M[r],f=t[0].trace;f.visible!==!0||f._length===0||(f._module.plot===n?e.push(t):a.push(t))}return[e,a]},ne.getSubplotData=function(T,e,a){if(!w.subplotsRegistry[e])return[];var n=w.subplotsRegistry[e].attr,r=[],t,f,o;if(e==="gl2d"){var i=a.match(c);f="x"+i[1],o="y"+i[2]}for(var g=0;g<T.length;g++)t=T[g],e==="gl2d"&&w.traceIs(t,"gl2d")?t[n[0]]===f&&t[n[1]]===o&&r.push(t):t[n]===a&&r.push(t);return r}},{"../registry":638,"./cartesian/constants":561}],594:[function(d,re,ne){var w=d("mouse-change"),c=d("mouse-wheel"),M=d("mouse-event-offset"),T=d("../cartesian/constants"),e=d("has-passive-events");re.exports=n;function a(r,t){this.element=r,this.plot=t,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}function n(r){var t=r.mouseContainer,f=r.glplot,o=new a(t,f);function i(){r.xaxis.autorange=!1,r.yaxis.autorange=!1}function g(){for(var y=r.graphDiv._fullLayout._axisConstraintGroups,h=r.xaxis._id,m=r.yaxis._id,u=0;u<y.length;u++)if(y[u][h]!==-1){if(y[u][m]!==-1)return!0;break}return!1}o.mouseListener=w(t,p),t.addEventListener("touchstart",function(y){var h=M(y.changedTouches[0],t);p(0,h[0],h[1]),p(1,h[0],h[1]),y.preventDefault()},e?{passive:!1}:!1),t.addEventListener("touchmove",function(y){y.preventDefault();var h=M(y.changedTouches[0],t);p(1,h[0],h[1]),y.preventDefault()},e?{passive:!1}:!1),t.addEventListener("touchend",function(y){p(0,o.lastPos[0],o.lastPos[1]),y.preventDefault()},e?{passive:!1}:!1);function p(y,h,m){var u=r.calcDataBox(),_=f.viewBox,s=o.lastPos[0],A=o.lastPos[1],x=T.MINDRAG*f.pixelRatio,v=T.MINZOOM*f.pixelRatio,b,l;h*=f.pixelRatio,m*=f.pixelRatio,m=_[3]-_[1]-m;function L(D,R,B){var F=Math.min(R,B),V=Math.max(R,B);F!==V?(u[D]=F,u[D+2]=V,o.dataBox=u,r.setRanges(u)):(r.selectBox.selectBox=[0,0,1,1],r.glplot.setDirty())}switch(r.fullLayout.dragmode){case"zoom":if(y){var S=h/(_[2]-_[0])*(u[2]-u[0])+u[0],k=m/(_[3]-_[1])*(u[3]-u[1])+u[1];o.boxInited||(o.boxStart[0]=S,o.boxStart[1]=k,o.dragStart[0]=h,o.dragStart[1]=m),o.boxEnd[0]=S,o.boxEnd[1]=k,o.boxInited=!0,!o.boxEnabled&&(o.boxStart[0]!==o.boxEnd[0]||o.boxStart[1]!==o.boxEnd[1])&&(o.boxEnabled=!0);var P=Math.abs(o.dragStart[0]-h)<v,z=Math.abs(o.dragStart[1]-m)<v;if(g()&&!(P&&z)){b=o.boxEnd[0]-o.boxStart[0],l=o.boxEnd[1]-o.boxStart[1];var I=(u[3]-u[1])/(u[2]-u[0]);Math.abs(b*I)>Math.abs(l)?(o.boxEnd[1]=o.boxStart[1]+Math.abs(b)*I*(l>=0?1:-1),o.boxEnd[1]<u[1]?(o.boxEnd[1]=u[1],o.boxEnd[0]=o.boxStart[0]+(u[1]-o.boxStart[1])/Math.abs(I)):o.boxEnd[1]>u[3]&&(o.boxEnd[1]=u[3],o.boxEnd[0]=o.boxStart[0]+(u[3]-o.boxStart[1])/Math.abs(I))):(o.boxEnd[0]=o.boxStart[0]+Math.abs(l)/I*(b>=0?1:-1),o.boxEnd[0]<u[0]?(o.boxEnd[0]=u[0],o.boxEnd[1]=o.boxStart[1]+(u[0]-o.boxStart[0])*Math.abs(I)):o.boxEnd[0]>u[2]&&(o.boxEnd[0]=u[2],o.boxEnd[1]=o.boxStart[1]+(u[2]-o.boxStart[0])*Math.abs(I)))}else P&&(o.boxEnd[0]=o.boxStart[0]),z&&(o.boxEnd[1]=o.boxStart[1])}else o.boxEnabled?(b=o.boxStart[0]!==o.boxEnd[0],l=o.boxStart[1]!==o.boxEnd[1],b||l?(b&&(L(0,o.boxStart[0],o.boxEnd[0]),r.xaxis.autorange=!1),l&&(L(1,o.boxStart[1],o.boxEnd[1]),r.yaxis.autorange=!1),r.relayoutCallback()):r.glplot.setDirty(),o.boxEnabled=!1,o.boxInited=!1):o.boxInited&&(o.boxInited=!1);break;case"pan":o.boxEnabled=!1,o.boxInited=!1,y?(o.panning||(o.dragStart[0]=h,o.dragStart[1]=m),Math.abs(o.dragStart[0]-h)<x&&(h=o.dragStart[0]),Math.abs(o.dragStart[1]-m)<x&&(m=o.dragStart[1]),b=(s-h)*(u[2]-u[0])/(f.viewBox[2]-f.viewBox[0]),l=(A-m)*(u[3]-u[1])/(f.viewBox[3]-f.viewBox[1]),u[0]+=b,u[2]+=b,u[1]+=l,u[3]+=l,r.setRanges(u),o.panning=!0,o.lastInputTime=Date.now(),i(),r.cameraChanged(),r.handleAnnotations()):o.panning&&(o.panning=!1,r.relayoutCallback());break}o.lastPos[0]=h,o.lastPos[1]=m}return o.wheelListener=c(t,function(y,h){if(!r.scrollZoom)return!1;var m=r.calcDataBox(),u=f.viewBox,_=o.lastPos[0],s=o.lastPos[1],A=Math.exp(5*h/(u[3]-u[1])),x=_/(u[2]-u[0])*(m[2]-m[0])+m[0],v=s/(u[3]-u[1])*(m[3]-m[1])+m[1];return m[0]=(m[0]-x)*A+x,m[2]=(m[2]-x)*A+x,m[1]=(m[1]-v)*A+v,m[3]=(m[3]-v)*A+v,r.setRanges(m),o.lastInputTime=Date.now(),i(),r.cameraChanged(),r.handleAnnotations(),r.relayoutCallback(),!0},!0),o}},{"../cartesian/constants":561,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],595:[function(d,re,ne){var w=d("../cartesian/axes"),c=d("../../lib/str2rgbarray");function M(n){this.scene=n,this.gl=n.gl,this.pixelRatio=n.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var T=M.prototype,e=["xaxis","yaxis"];T.merge=function(n){this.titleEnable=!1,this.backgroundColor=c(n.plot_bgcolor);var r,t,f,o,i,g,p,y,h,m,u;for(m=0;m<2;++m){r=e[m];var _=r.charAt(0);for(t=n[this.scene[r]._name],f=t.title.text===this.scene.fullLayout._dfltTitle[_]?"":t.title.text,u=0;u<=2;u+=2)this.labelEnable[m+u]=!1,this.labels[m+u]=f,this.labelColor[m+u]=c(t.title.font.color),this.labelFont[m+u]=t.title.font.family,this.labelSize[m+u]=t.title.font.size,this.labelPad[m+u]=this.getLabelPad(r,t),this.tickEnable[m+u]=!1,this.tickColor[m+u]=c((t.tickfont||{}).color),this.tickAngle[m+u]=t.tickangle==="auto"?0:Math.PI*-t.tickangle/180,this.tickPad[m+u]=this.getTickPad(t),this.tickMarkLength[m+u]=0,this.tickMarkWidth[m+u]=t.tickwidth||0,this.tickMarkColor[m+u]=c(t.tickcolor),this.borderLineEnable[m+u]=!1,this.borderLineColor[m+u]=c(t.linecolor),this.borderLineWidth[m+u]=t.linewidth||0;p=this.hasSharedAxis(t),i=this.hasAxisInDfltPos(r,t)&&!p,g=this.hasAxisInAltrPos(r,t)&&!p,o=t.mirror||!1,y=p?String(o).indexOf("all")!==-1:!!o,h=p?o==="allticks":String(o).indexOf("ticks")!==-1,i?this.labelEnable[m]=!0:g&&(this.labelEnable[m+2]=!0),i?this.tickEnable[m]=t.showticklabels:g&&(this.tickEnable[m+2]=t.showticklabels),(i||y)&&(this.borderLineEnable[m]=t.showline),(g||y)&&(this.borderLineEnable[m+2]=t.showline),(i||h)&&(this.tickMarkLength[m]=this.getTickMarkLength(t)),(g||h)&&(this.tickMarkLength[m+2]=this.getTickMarkLength(t)),this.gridLineEnable[m]=t.showgrid,this.gridLineColor[m]=c(t.gridcolor),this.gridLineWidth[m]=t.gridwidth,this.zeroLineEnable[m]=t.zeroline,this.zeroLineColor[m]=c(t.zerolinecolor),this.zeroLineWidth[m]=t.zerolinewidth}},T.hasSharedAxis=function(n){var r=this.scene,t=r.fullLayout._subplots.gl2d,f=w.findSubplotsWithAxis(t,n);return f.indexOf(r.id)!==0},T.hasAxisInDfltPos=function(n,r){var t=r.side;if(n==="xaxis")return t==="bottom";if(n==="yaxis")return t==="left"},T.hasAxisInAltrPos=function(n,r){var t=r.side;if(n==="xaxis")return t==="top";if(n==="yaxis")return t==="right"},T.getLabelPad=function(n,r){var t=1.5,f=r.title.font.size,o=r.showticklabels;if(n==="xaxis")return r.side==="top"?-10+f*(t+(o?1:0)):-10+f*(t+(o?.5:0));if(n==="yaxis")return r.side==="right"?10+f*(t+(o?1:.5)):10+f*(t+(o?.5:0))},T.getTickPad=function(n){return n.ticks==="outside"?10+n.ticklen:15},T.getTickMarkLength=function(n){if(!n.ticks)return 0;var r=n.ticklen;return n.ticks==="inside"?-r:r};function a(n){return new M(n)}re.exports=a},{"../../lib/str2rgbarray":528,"../cartesian/axes":554}],596:[function(d,re,ne){var w=d("../../plot_api/edit_types").overrideAll,c=d("./scene2d"),M=d("../layout_attributes"),T=d("../../constants/xmlns_namespaces"),e=d("../cartesian/constants"),a=d("../cartesian"),n=d("../../components/fx/layout_attributes"),r=d("../get_data").getSubplotData;ne.name="gl2d",ne.attr=["xaxis","yaxis"],ne.idRoot=["x","y"],ne.idRegex=e.idRegex,ne.attrRegex=e.attrRegex,ne.attributes=d("../cartesian/attributes"),ne.supplyLayoutDefaults=function(t,f,o){f._has("cartesian")||a.supplyLayoutDefaults(t,f,o)},ne.layoutAttrOverrides=w(a.layoutAttributes,"plot","from-root"),ne.baseLayoutAttrOverrides=w({plot_bgcolor:M.plot_bgcolor,hoverlabel:n.hoverlabel},"plot","nested"),ne.plot=function(f){for(var o=f._fullLayout,i=f._fullData,g=o._subplots.gl2d,p=0;p<g.length;p++){var y=g[p],h=o._plots[y],m=r(i,"gl2d",y),u=h._scene2d;u===void 0&&(u=new c({id:y,graphDiv:f,container:f.querySelector(".gl-container"),staticPlot:f._context.staticPlot,plotGlPixelRatio:f._context.plotGlPixelRatio},o),h._scene2d=u),u.plot(m,f.calcdata,o,f.layout)}},ne.clean=function(t,f,o,i){for(var g=i._subplots.gl2d||[],p=0;p<g.length;p++){var y=g[p],h=i._plots[y];if(!!h._scene2d){var m=r(t,"gl2d",y);m.length===0&&(h._scene2d.destroy(),delete i._plots[y])}}a.clean.apply(this,arguments)},ne.drawFramework=function(t){t._context.staticPlot||a.drawFramework(t)},ne.toSVG=function(t){for(var f=t._fullLayout,o=f._subplots.gl2d,i=0;i<o.length;i++){var g=f._plots[o[i]],p=g._scene2d,y=p.toImage("png"),h=f._glimages.append("svg:image");h.attr({xmlns:T.svg,"xlink:href":y,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),p.destroy()}},ne.updateFx=function(t){for(var f=t._fullLayout,o=f._subplots.gl2d,i=0;i<o.length;i++){var g=f._plots[o[i]]._scene2d;g.updateFx(f.dragmode)}}},{"../../components/fx/layout_attributes":407,"../../constants/xmlns_namespaces":480,"../../plot_api/edit_types":536,"../cartesian":568,"../cartesian/attributes":552,"../cartesian/constants":561,"../get_data":593,"../layout_attributes":610,"./scene2d":597}],597:[function(d,re,ne){var w=d("../../registry"),c=d("../../plots/cartesian/axes"),M=d("../../components/fx"),T=d("../../../stackgl_modules").gl_plot2d,e=d("../../../stackgl_modules").gl_spikes2d,a=d("../../../stackgl_modules").gl_select_box,n=d("webgl-context"),r=d("./convert"),t=d("./camera"),f=d("../../lib/show_no_webgl_msg"),o=d("../cartesian/constraints"),i=o.enforce,g=o.clean,p=d("../cartesian/autorange").doAutoRange,y=d("../../components/dragelement/helpers"),h=y.drawMode,m=y.selectMode,u=["xaxis","yaxis"],_,s,A=d("../cartesian/constants").SUBPLOT_PATTERN;function x(l,L){this.container=l.container,this.graphDiv=l.graphDiv,this.pixelRatio=l.plotGlPixelRatio||window.devicePixelRatio,this.id=l.id,this.staticPlot=!!l.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(L),this.makeFramework(),!this.stopped&&(this.glplotOptions=r(this),this.glplotOptions.merge(L),this.glplot=T(this.glplotOptions),this.camera=t(this),this.traces={},this.spikes=e(this.glplot),this.selectBox=a(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}re.exports=x;var v=x.prototype;v.makeFramework=function(){if(this.staticPlot){if(!s&&(_=document.createElement("canvas"),s=n({canvas:_,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}),!s))throw new Error("Error creating static canvas/context for image server");this.canvas=_,this.gl=s}else{var l=this.container.querySelector(".gl-canvas-focus"),L=n({canvas:l,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!L){f(this),this.stopped=!0;return}this.canvas=l,this.gl=L}var S=this.canvas;S.style.width="100%",S.style.height="100%",S.style.position="absolute",S.style.top="0px",S.style.left="0px",S.style["pointer-events"]="none",this.updateSize(S);var k=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");k.style.position="absolute",k.style.top=k.style.left="0px",k.style.width=k.style.height="100%",k.style["z-index"]=20,k.style["pointer-events"]="none";var P=this.mouseContainer=document.createElement("div");P.style.position="absolute",P.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var z=this.container;z.appendChild(k),z.appendChild(P);var I=this;P.addEventListener("mouseout",function(){I.isMouseOver=!1,I.unhover()}),P.addEventListener("mouseover",function(){I.isMouseOver=!0})},v.toImage=function(l){l||(l="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(_),this.updateSize(this.canvas);var L=this.glplot.gl,S=L.drawingBufferWidth,k=L.drawingBufferHeight;L.clearColor(1,1,1,0),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(S*k*4);L.readPixels(0,0,S,k,L.RGBA,L.UNSIGNED_BYTE,P);for(var z=0,I=k-1;z<I;++z,--I)for(var D=0;D<S;++D)for(var R=0;R<4;++R){var B=P[4*(S*z+D)+R];P[4*(S*z+D)+R]=P[4*(S*I+D)+R],P[4*(S*I+D)+R]=B}var F=document.createElement("canvas");F.width=S,F.height=k;var V=F.getContext("2d"),G=V.createImageData(S,k);G.data.set(P),V.putImageData(G,0,0);var J;switch(l){case"jpeg":J=F.toDataURL("image/jpeg");break;case"webp":J=F.toDataURL("image/webp");break;default:J=F.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(_),J},v.updateSize=function(l){l||(l=this.canvas);var L=this.pixelRatio,S=this.fullLayout,k=S.width,P=S.height,z=Math.ceil(L*k)|0,I=Math.ceil(L*P)|0;return(l.width!==z||l.height!==I)&&(l.width=z,l.height=I),l},v.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var l=[c.calcTicks(this.xaxis),c.calcTicks(this.yaxis)],L=0;L<2;++L)for(var S=0;S<l[L].length;++S)l[L][S].text=l[L][S].text+"";return l};function b(l,L){for(var S=0;S<2;++S){var k=l[S],P=L[S];if(k.length!==P.length)return!0;for(var z=0;z<k.length;++z)if(k[z].x!==P[z].x)return!0}return!1}v.updateRefs=function(l){this.fullLayout=l;var L=this.id.match(A),S="xaxis"+L[1],k="yaxis"+L[2];this.xaxis=this.fullLayout[S],this.yaxis=this.fullLayout[k]},v.relayoutCallback=function(){var l=this.graphDiv,L=this.xaxis,S=this.yaxis,k=l.layout,P={},z=P[L._name+".range"]=L.range.slice(),I=P[S._name+".range"]=S.range.slice();P[L._name+".autorange"]=L.autorange,P[S._name+".autorange"]=S.autorange,w.call("_storeDirectGUIEdit",l.layout,l._fullLayout._preGUI,P);var D=k[L._name];D.range=z,D.autorange=L.autorange;var R=k[S._name];R.range=I,R.autorange=S.autorange,P.lastInputTime=this.camera.lastInputTime,l.emit("plotly_relayout",P)},v.cameraChanged=function(){var l=this.camera;this.glplot.setDataBox(this.calcDataBox());var L=this.computeTickMarks(),S=this.glplotOptions.ticks;b(L,S)&&(this.glplotOptions.ticks=L,this.glplotOptions.dataBox=l.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},v.handleAnnotations=function(){for(var l=this.graphDiv,L=this.fullLayout.annotations,S=0;S<L.length;S++){var k=L[S];k.xref===this.xaxis._id&&k.yref===this.yaxis._id&&w.getComponentMethod("annotations","drawOne")(l,S)}},v.destroy=function(){if(!!this.glplot){var l=this.traces;l&&Object.keys(l).map(function(L){l[L].dispose(),delete l[L]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},v.plot=function(l,L,S){var k=this.glplot;this.updateRefs(S),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(l,L),this.updateFx(S.dragmode);var P=S.width,z=S.height;this.updateSize(this.canvas);var I=this.glplotOptions;I.merge(S),I.screenBox=[0,0,P,z];var D={_fullLayout:{_axisConstraintGroups:S._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:S._size}};g(D,this.xaxis),g(D,this.yaxis);var R=S._size,B=this.xaxis.domain,F=this.yaxis.domain;I.viewBox=[R.l+B[0]*R.w,R.b+F[0]*R.h,P-R.r-(1-B[1])*R.w,z-R.t-(1-F[1])*R.h],this.mouseContainer.style.width=R.w*(B[1]-B[0])+"px",this.mouseContainer.style.height=R.h*(F[1]-F[0])+"px",this.mouseContainer.height=R.h*(F[1]-F[0]),this.mouseContainer.style.left=R.l+B[0]*R.w+"px",this.mouseContainer.style.top=R.t+(1-F[1])*R.h+"px";var V,G;for(G=0;G<2;++G)V=this[u[G]],V._length=I.viewBox[G+2]-I.viewBox[G],p(this.graphDiv,V),V.setScale();i(D),I.ticks=this.computeTickMarks(),I.dataBox=this.calcDataBox(),I.merge(S),k.update(I),this.glplot.draw()},v.calcDataBox=function(){var l=this.xaxis,L=this.yaxis,S=l.range,k=L.range,P=l.r2l,z=L.r2l;return[P(S[0]),z(k[0]),P(S[1]),z(k[1])]},v.setRanges=function(l){var L=this.xaxis,S=this.yaxis,k=L.l2r,P=S.l2r;L.range=[k(l[0]),k(l[2])],S.range=[P(l[1]),P(l[3])]},v.updateTraces=function(l,L){var S=Object.keys(this.traces),k,P,z;this.fullData=l;e:for(k=0;k<S.length;k++){var I=S[k],D=this.traces[I];for(P=0;P<l.length;P++)if(z=l[P],z.uid===I&&z.type===D.type)continue e;D.dispose(),delete this.traces[I]}for(k=0;k<l.length;k++){z=l[k];var R=L[k],B=this.traces[z.uid];B?B.update(z,R):(B=z._module.plot(this,z,R),this.traces[z.uid]=B)}this.glplot.objects.sort(function(F,V){return F._trace.index-V._trace.index})},v.updateFx=function(l){m(l)||h(l)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),l==="pan"?this.mouseContainer.style.cursor="move":l==="zoom"?this.mouseContainer.style.cursor="crosshair":this.mouseContainer.style.cursor=null},v.emitPointAction=function(l,L){for(var S=l.trace.uid,k=l.pointIndex,P,z=0;z<this.fullData.length;z++)this.fullData[z].uid===S&&(P=this.fullData[z]);var I={x:l.traceCoord[0],y:l.traceCoord[1],curveNumber:P.index,pointNumber:k,data:P._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};M.appendArrayPointValue(I,P,k),this.graphDiv.emit(L,{points:[I]})},v.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var l=this.glplot,L=this.camera,S=L.mouseListener,k=this.lastButtonState===1&&S.buttons===0,P=this.fullLayout;this.lastButtonState=S.buttons,this.cameraChanged();var z=S.x*l.pixelRatio,I=this.canvas.height-l.pixelRatio*S.y,D;if(L.boxEnabled&&P.dragmode==="zoom"){this.selectBox.enabled=!0;for(var R=this.selectBox.selectBox=[Math.min(L.boxStart[0],L.boxEnd[0]),Math.min(L.boxStart[1],L.boxEnd[1]),Math.max(L.boxStart[0],L.boxEnd[0]),Math.max(L.boxStart[1],L.boxEnd[1])],B=0;B<2;B++)L.boxStart[B]===L.boxEnd[B]&&(R[B]=l.dataBox[B],R[B+2]=l.dataBox[B+2]);l.setDirty()}else if(!L.panning&&this.isMouseOver){this.selectBox.enabled=!1;var F=P._size,V=this.xaxis.domain,G=this.yaxis.domain;D=l.pick(z/l.pixelRatio+F.l+V[0]*F.w,I/l.pixelRatio-(F.t+(1-G[1])*F.h));var J=D&&D.object._trace.handlePick(D);if(J&&k&&this.emitPointAction(J,"plotly_click"),D&&D.object._trace.hoverinfo!=="skip"&&P.hovermode&&J&&(!this.lastPickResult||this.lastPickResult.traceUid!==J.trace.uid||this.lastPickResult.dataCoord[0]!==J.dataCoord[0]||this.lastPickResult.dataCoord[1]!==J.dataCoord[1])){var j=J;this.lastPickResult={traceUid:J.trace?J.trace.uid:null,dataCoord:J.dataCoord.slice()},this.spikes.update({center:D.dataCoord}),j.screenCoord=[((l.viewBox[2]-l.viewBox[0])*(D.dataCoord[0]-l.dataBox[0])/(l.dataBox[2]-l.dataBox[0])+l.viewBox[0])/l.pixelRatio,(this.canvas.height-(l.viewBox[3]-l.viewBox[1])*(D.dataCoord[1]-l.dataBox[1])/(l.dataBox[3]-l.dataBox[1])-l.viewBox[1])/l.pixelRatio],this.emitPointAction(J,"plotly_hover");var Y=this.fullData[j.trace.index]||{},X=j.pointIndex,oe=M.castHoverinfo(Y,P,X);if(oe&&oe!=="all"){var se=oe.split("+");se.indexOf("x")===-1&&(j.traceCoord[0]=void 0),se.indexOf("y")===-1&&(j.traceCoord[1]=void 0),se.indexOf("z")===-1&&(j.traceCoord[2]=void 0),se.indexOf("text")===-1&&(j.textLabel=void 0),se.indexOf("name")===-1&&(j.name=void 0)}M.loneHover({x:j.screenCoord[0],y:j.screenCoord[1],xLabel:this.hoverFormatter("xaxis",j.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",j.traceCoord[1]),zLabel:j.traceCoord[2],text:j.textLabel,name:j.name,color:M.castHoverOption(Y,X,"bgcolor")||j.color,borderColor:M.castHoverOption(Y,X,"bordercolor"),fontFamily:M.castHoverOption(Y,X,"font.family"),fontSize:M.castHoverOption(Y,X,"font.size"),fontColor:M.castHoverOption(Y,X,"font.color"),nameLength:M.castHoverOption(Y,X,"namelength"),textAlign:M.castHoverOption(Y,X,"align")},{container:this.svgContainer,gd:this.graphDiv})}}D||this.unhover(),l.draw()}},v.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),M.loneUnhover(this.svgContainer))},v.hoverFormatter=function(l,L){if(L!==void 0){var S=this[l];return c.tickText(S,S.c2l(L),"hover").text}}},{"../../../stackgl_modules":1124,"../../components/dragelement/helpers":384,"../../components/fx":406,"../../lib/show_no_webgl_msg":525,"../../plots/cartesian/axes":554,"../../registry":638,"../cartesian/autorange":553,"../cartesian/constants":561,"../cartesian/constraints":562,"./camera":594,"./convert":595,"webgl-context":331}],598:[function(d,re,ne){var w=d("../../plot_api/edit_types").overrideAll,c=d("../../components/fx/layout_attributes"),M=d("./scene"),T=d("../get_data").getSubplotData,e=d("../../lib"),a=d("../../constants/xmlns_namespaces"),n="gl3d",r="scene";ne.name=n,ne.attr=r,ne.idRoot=r,ne.idRegex=ne.attrRegex=e.counterRegex("scene"),ne.attributes=d("./layout/attributes"),ne.layoutAttributes=d("./layout/layout_attributes"),ne.baseLayoutAttrOverrides=w({hoverlabel:c.hoverlabel},"plot","nested"),ne.supplyLayoutDefaults=d("./layout/defaults"),ne.plot=function(f){for(var o=f._fullLayout,i=f._fullData,g=o._subplots[n],p=0;p<g.length;p++){var y=g[p],h=T(i,n,y),m=o[y],u=m.camera,_=m._scene;_||(_=new M({id:y,graphDiv:f,container:f.querySelector(".gl-container"),staticPlot:f._context.staticPlot,plotGlPixelRatio:f._context.plotGlPixelRatio,camera:u},o),m._scene=_),_.viewInitial||(_.viewInitial={up:{x:u.up.x,y:u.up.y,z:u.up.z},eye:{x:u.eye.x,y:u.eye.y,z:u.eye.z},center:{x:u.center.x,y:u.center.y,z:u.center.z}}),_.plot(h,o,f.layout)}},ne.clean=function(t,f,o,i){for(var g=i._subplots[n]||[],p=0;p<g.length;p++){var y=g[p];!f[y]&&!!i[y]._scene&&(i[y]._scene.destroy(),i._infolayer&&i._infolayer.selectAll(".annotation-"+y).remove())}},ne.toSVG=function(t){for(var f=t._fullLayout,o=f._subplots[n],i=f._size,g=0;g<o.length;g++){var p=f[o[g]],y=p.domain,h=p._scene,m=h.toImage("png"),u=f._glimages.append("svg:image");u.attr({xmlns:a.svg,"xlink:href":m,x:i.l+i.w*y.x[0],y:i.t+i.h*(1-y.y[1]),width:i.w*(y.x[1]-y.x[0]),height:i.h*(y.y[1]-y.y[0]),preserveAspectRatio:"none"}),h.destroy()}},ne.cleanId=function(f){if(!!f.match(/^scene[0-9]*$/)){var o=f.substr(5);return o==="1"&&(o=""),r+o}},ne.updateFx=function(t){for(var f=t._fullLayout,o=f._subplots[n],i=0;i<o.length;i++){var g=f[o[i]]._scene;g.updateFx(f.dragmode,f.hovermode)}}},{"../../components/fx/layout_attributes":407,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../plot_api/edit_types":536,"../get_data":593,"./layout/attributes":599,"./layout/defaults":603,"./layout/layout_attributes":604,"./scene":608}],599:[function(d,re,ne){re.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],600:[function(d,re,ne){var w=d("../../../components/color"),c=d("../../cartesian/layout_attributes"),M=d("../../../lib/extend").extendFlat,T=d("../../../plot_api/edit_types").overrideAll;re.exports=T({visible:c.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:w.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:c.color,categoryorder:c.categoryorder,categoryarray:c.categoryarray,title:{text:c.title.text,font:c.title.font},type:M({},c.type,{values:["-","linear","log","date","category"]}),autotypenumbers:c.autotypenumbers,autorange:c.autorange,rangemode:c.rangemode,range:M({},c.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:c.tickmode,nticks:c.nticks,tick0:c.tick0,dtick:c.dtick,tickvals:c.tickvals,ticktext:c.ticktext,ticks:c.ticks,mirror:c.mirror,ticklen:c.ticklen,tickwidth:c.tickwidth,tickcolor:c.tickcolor,showticklabels:c.showticklabels,tickfont:c.tickfont,tickangle:c.tickangle,tickprefix:c.tickprefix,showtickprefix:c.showtickprefix,ticksuffix:c.ticksuffix,showticksuffix:c.showticksuffix,showexponent:c.showexponent,exponentformat:c.exponentformat,minexponent:c.minexponent,separatethousands:c.separatethousands,tickformat:c.tickformat,tickformatstops:c.tickformatstops,hoverformat:c.hoverformat,showline:c.showline,linecolor:c.linecolor,linewidth:c.linewidth,showgrid:c.showgrid,gridcolor:M({},c.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:c.gridwidth,zeroline:c.zeroline,zerolinecolor:c.zerolinecolor,zerolinewidth:c.zerolinewidth,_deprecated:{title:c._deprecated.title,titlefont:c._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":366,"../../../lib/extend":493,"../../../plot_api/edit_types":536,"../../cartesian/layout_attributes":569}],601:[function(d,re,ne){var w=d("tinycolor2").mix,c=d("../../../lib"),M=d("../../../plot_api/plot_template"),T=d("./axis_attributes"),e=d("../../cartesian/type_defaults"),a=d("../../cartesian/axis_defaults"),n=["xaxis","yaxis","zaxis"],r=100*(204-68)/(255-68);re.exports=function(f,o,i){var g,p;function y(u,_){return c.coerce(g,p,T,u,_)}for(var h=0;h<n.length;h++){var m=n[h];g=f[m]||{},p=M.newContainer(o,m),p._id=m[0]+i.scene,p._name=m,e(g,p,y,i),a(g,p,y,{font:i.font,letter:m[0],data:i.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:i.bgColor,calendar:i.calendar},i.fullLayout),y("gridcolor",w(p.color,i.bgColor,r).toRgbString()),y("title.text",m[0]),p.setScale=c.noop,y("showspikes")&&(y("spikesides"),y("spikethickness"),y("spikecolor",p.color)),y("showaxeslabels"),y("showbackground")&&y("backgroundcolor")}}},{"../../../lib":503,"../../../plot_api/plot_template":543,"../../cartesian/axis_defaults":556,"../../cartesian/type_defaults":582,"./axis_attributes":600,tinycolor2:312}],602:[function(d,re,ne){var w=d("../../../lib/str2rgbarray"),c=d("../../../lib"),M=["xaxis","yaxis","zaxis"];function T(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}var e=T.prototype;e.merge=function(n,r){for(var t=this,f=0;f<3;++f){var o=r[M[f]];if(!o.visible){t.tickEnable[f]=!1,t.labelEnable[f]=!1,t.lineEnable[f]=!1,t.lineTickEnable[f]=!1,t.gridEnable[f]=!1,t.zeroEnable[f]=!1,t.backgroundEnable[f]=!1;continue}t.labels[f]=n._meta?c.templateString(o.title.text,n._meta):o.title.text,"font"in o.title&&(o.title.font.color&&(t.labelColor[f]=w(o.title.font.color)),o.title.font.family&&(t.labelFont[f]=o.title.font.family),o.title.font.size&&(t.labelSize[f]=o.title.font.size)),"showline"in o&&(t.lineEnable[f]=o.showline),"linecolor"in o&&(t.lineColor[f]=w(o.linecolor)),"linewidth"in o&&(t.lineWidth[f]=o.linewidth),"showgrid"in o&&(t.gridEnable[f]=o.showgrid),"gridcolor"in o&&(t.gridColor[f]=w(o.gridcolor)),"gridwidth"in o&&(t.gridWidth[f]=o.gridwidth),o.type==="log"?t.zeroEnable[f]=!1:"zeroline"in o&&(t.zeroEnable[f]=o.zeroline),"zerolinecolor"in o&&(t.zeroLineColor[f]=w(o.zerolinecolor)),"zerolinewidth"in o&&(t.zeroLineWidth[f]=o.zerolinewidth),"ticks"in o&&!!o.ticks?t.lineTickEnable[f]=!0:t.lineTickEnable[f]=!1,"ticklen"in o&&(t.lineTickLength[f]=t._defaultLineTickLength[f]=o.ticklen),"tickcolor"in o&&(t.lineTickColor[f]=w(o.tickcolor)),"tickwidth"in o&&(t.lineTickWidth[f]=o.tickwidth),"tickangle"in o&&(t.tickAngle[f]=o.tickangle==="auto"?-3600:Math.PI*-o.tickangle/180),"showticklabels"in o&&(t.tickEnable[f]=o.showticklabels),"tickfont"in o&&(o.tickfont.color&&(t.tickColor[f]=w(o.tickfont.color)),o.tickfont.family&&(t.tickFont[f]=o.tickfont.family),o.tickfont.size&&(t.tickSize[f]=o.tickfont.size)),"mirror"in o?["ticks","all","allticks"].indexOf(o.mirror)!==-1?(t.lineTickMirror[f]=!0,t.lineMirror[f]=!0):o.mirror===!0?(t.lineTickMirror[f]=!1,t.lineMirror[f]=!0):(t.lineTickMirror[f]=!1,t.lineMirror[f]=!1):t.lineMirror[f]=!1,"showbackground"in o&&o.showbackground!==!1?(t.backgroundEnable[f]=!0,t.backgroundColor[f]=w(o.backgroundcolor)):t.backgroundEnable[f]=!1}};function a(n,r){var t=new T;return t.merge(n,r),t}re.exports=a},{"../../../lib":503,"../../../lib/str2rgbarray":528}],603:[function(d,re,ne){var w=d("../../../lib"),c=d("../../../components/color"),M=d("../../../registry"),T=d("../../subplot_defaults"),e=d("./axis_defaults"),a=d("./layout_attributes"),n=d("../../get_data").getSubplotData,r="gl3d";re.exports=function(o,i,g){var p=i._basePlotModules.length>1;function y(h){if(!p){var m=w.validate(o[h],a[h]);if(m)return o[h]}}T(o,i,g,{type:r,attributes:a,handleDefaults:t,fullLayout:i,font:i.font,fullData:g,getDfltFromLayout:y,autotypenumbersDflt:i.autotypenumbers,paper_bgcolor:i.paper_bgcolor,calendar:i.calendar})};function t(f,o,i,g){for(var p=i("bgcolor"),y=c.combine(p,g.paper_bgcolor),h=["up","center","eye"],m=0;m<h.length;m++)i("camera."+h[m]+".x"),i("camera."+h[m]+".y"),i("camera."+h[m]+".z");i("camera.projection.type");var u=!!i("aspectratio.x")&&!!i("aspectratio.y")&&!!i("aspectratio.z"),_=u?"manual":"auto",s=i("aspectmode",_);u||(f.aspectratio=o.aspectratio={x:1,y:1,z:1},s==="manual"&&(o.aspectmode="auto"),f.aspectmode=o.aspectmode);var A=n(g.fullData,r,g.id);e(f,o,{font:g.font,scene:g.id,data:A,bgColor:y,calendar:g.calendar,autotypenumbersDflt:g.autotypenumbersDflt,fullLayout:g.fullLayout}),M.getComponentMethod("annotations3d","handleDefaults")(f,o,g);var x=g.getDfltFromLayout("dragmode");if(x!==!1&&!x)if(x="orbit",f.camera&&f.camera.up){var v=f.camera.up.x,b=f.camera.up.y,l=f.camera.up.z;l!==0&&(!v||!b||!l||l/Math.sqrt(v*v+b*b+l*l)>.999)&&(x="turntable")}else x="turntable";i("dragmode",x),i("hovermode",g.getDfltFromLayout("hovermode"))}},{"../../../components/color":366,"../../../lib":503,"../../../registry":638,"../../get_data":593,"../../subplot_defaults":632,"./axis_defaults":601,"./layout_attributes":604}],604:[function(d,re,ne){var w=d("./axis_attributes"),c=d("../../domain").attributes,M=d("../../../lib/extend").extendFlat,T=d("../../../lib").counterRegex;function e(a,n,r){return{x:{valType:"number",dflt:a,editType:"camera"},y:{valType:"number",dflt:n,editType:"camera"},z:{valType:"number",dflt:r,editType:"camera"},editType:"camera"}}re.exports={_arrayAttrRegexps:[T("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:M(e(0,0,1),{}),center:M(e(0,0,0),{}),eye:M(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:c({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:w,yaxis:w,zaxis:w,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":503,"../../../lib/extend":493,"../../domain":584,"./axis_attributes":600}],605:[function(d,re,ne){var w=d("../../../lib/str2rgbarray"),c=["xaxis","yaxis","zaxis"];function M(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}var T=M.prototype;T.merge=function(a){for(var n=0;n<3;++n){var r=a[c[n]];if(!r.visible){this.enabled[n]=!1,this.drawSides[n]=!1;continue}this.enabled[n]=r.showspikes,this.colors[n]=w(r.spikecolor),this.drawSides[n]=r.spikesides,this.lineWidth[n]=r.spikethickness}};function e(a){var n=new M;return n.merge(a),n}re.exports=e},{"../../../lib/str2rgbarray":528}],606:[function(d,re,ne){re.exports=a;var w=d("../../cartesian/axes"),c=d("../../../lib"),M=["xaxis","yaxis","zaxis"],T=[0,0,0];function e(n){for(var r=new Array(3),t=0;t<3;++t){for(var f=n[t],o=new Array(f.length),i=0;i<f.length;++i)o[i]=f[i].x;r[t]=o}return r}function a(n){for(var r=n.axesOptions,t=n.glplot.axesPixels,f=n.fullSceneLayout,o=[[],[],[]],i=0;i<3;++i){var g=f[M[i]];if(g._length=(t[i].hi-t[i].lo)*t[i].pixelsPerDataUnit/n.dataScale[i],Math.abs(g._length)===1/0||isNaN(g._length))o[i]=[];else{g._input_range=g.range.slice(),g.range[0]=t[i].lo/n.dataScale[i],g.range[1]=t[i].hi/n.dataScale[i],g._m=1/(n.dataScale[i]*t[i].pixelsPerDataUnit),g.range[0]===g.range[1]&&(g.range[0]-=1,g.range[1]+=1);var p=g.tickmode;if(g.tickmode==="auto"){g.tickmode="linear";var y=g.nticks||c.constrain(g._length/40,4,9);w.autoTicks(g,Math.abs(g.range[1]-g.range[0])/y)}for(var h=w.calcTicks(g,{msUTC:!0}),m=0;m<h.length;++m)h[m].x=h[m].x*n.dataScale[i],g.type==="date"&&(h[m].text=h[m].text.replace(/\<br\>/g," "));o[i]=h,g.tickmode=p}}r.ticks=o;for(var i=0;i<3;++i){T[i]=.5*(n.glplot.bounds[0][i]+n.glplot.bounds[1][i]);for(var m=0;m<2;++m)r.bounds[m][i]=n.glplot.bounds[m][i]}n.contourLevels=e(o)}},{"../../../lib":503,"../../cartesian/axes":554}],607:[function(d,re,ne){function w(M,T){var e=[0,0,0,0],a,n;for(a=0;a<4;++a)for(n=0;n<4;++n)e[n]+=M[4*a+n]*T[a];return e}function c(M,T){var e=w(M.projection,w(M.view,w(M.model,[T[0],T[1],T[2],1])));return e}re.exports=c},{}],608:[function(d,re,ne){var w=d("../../../stackgl_modules").gl_plot3d,c=w.createCamera,M=w.createScene,T=d("webgl-context"),e=d("has-passive-events"),a=d("../../registry"),n=d("../../lib"),r=n.preserveDrawingBuffer(),t=d("../../plots/cartesian/axes"),f=d("../../components/fx"),o=d("../../lib/str2rgbarray"),i=d("../../lib/show_no_webgl_msg"),g=d("./project"),p=d("./layout/convert"),y=d("./layout/spikes"),h=d("./layout/tick_marks"),m,u;function _(P,z){var I=document.createElement("div"),D=P.container;this.graphDiv=P.graphDiv;var R=document.createElementNS("http://www.w3.org/2000/svg","svg");R.style.position="absolute",R.style.top=R.style.left="0px",R.style.width=R.style.height="100%",R.style["z-index"]=20,R.style["pointer-events"]="none",I.appendChild(R),this.svgContainer=R,I.id=P.id,I.style.position="absolute",I.style.top=I.style.left="0px",I.style.width=I.style.height="100%",D.appendChild(I),this.fullLayout=z,this.id=P.id||"scene",this.fullSceneLayout=z[this.id],this.plotArgs=[[],{},{}],this.axesOptions=p(z,z[this.id]),this.spikeOptions=y(z[this.id]),this.container=I,this.staticMode=!!P.staticPlot,this.pixelRatio=this.pixelRatio||P.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=a.getComponentMethod("annotations3d","convert"),this.drawAnnotations=a.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var s=_.prototype;s.prepareOptions=function(){var P=this,z={canvas:P.canvas,gl:P.gl,glOptions:{preserveDrawingBuffer:r,premultipliedAlpha:!0,antialias:!0},container:P.container,axes:P.axesOptions,spikes:P.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:P.camera,pixelRatio:P.pixelRatio};if(P.staticMode){if(!u&&(m=document.createElement("canvas"),u=T({canvas:m,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}),!u))throw new Error("error creating static canvas/context for image server");z.gl=u,z.canvas=m}return z};var A=!0;s.tryCreatePlot=function(){var P=this,z=P.prepareOptions(),I=!0;try{P.glplot=M(z)}catch{if(P.staticMode||!A||r)I=!1;else{n.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{r=z.glOptions.preserveDrawingBuffer=!0,P.glplot=M(z)}catch{r=z.glOptions.preserveDrawingBuffer=!1,I=!1}}}return A=!1,I},s.initializeGLCamera=function(){var P=this,z=P.fullSceneLayout.camera,I=z.projection.type==="orthographic";P.camera=c(P.container,{center:[z.center.x,z.center.y,z.center.z],eye:[z.eye.x,z.eye.y,z.eye.z],up:[z.up.x,z.up.y,z.up.z],_ortho:I,zoomMin:.01,zoomMax:100,mode:"orbit"})},s.initializeGLPlot=function(){var P=this;P.initializeGLCamera();var z=P.tryCreatePlot();if(!z)return i(P);P.traces={},P.make4thDimension();var I=P.graphDiv,D=I.layout,R=function(){var F={};return P.isCameraChanged(D)&&(F[P.id+".camera"]=P.getCamera()),P.isAspectChanged(D)&&(F[P.id+".aspectratio"]=P.glplot.getAspectratio(),D[P.id].aspectmode!=="manual"&&(P.fullSceneLayout.aspectmode=D[P.id].aspectmode=F[P.id+".aspectmode"]="manual")),F},B=function(F){if(F.fullSceneLayout.dragmode!==!1){var V=R();F.saveLayout(D),F.graphDiv.emit("plotly_relayout",V)}};return P.glplot.canvas&&(P.glplot.canvas.addEventListener("mouseup",function(){B(P)}),P.glplot.canvas.addEventListener("wheel",function(F){if(I._context._scrollZoom.gl3d){if(P.camera._ortho){var V=F.deltaX>F.deltaY?1.1:.9090909090909091,G=P.glplot.getAspectratio();P.glplot.setAspectratio({x:V*G.x,y:V*G.y,z:V*G.z})}B(P)}},e?{passive:!1}:!1),P.glplot.canvas.addEventListener("mousemove",function(){if(P.fullSceneLayout.dragmode!==!1&&P.camera.mouseListener.buttons!==0){var F=R();P.graphDiv.emit("plotly_relayouting",F)}}),P.staticMode||P.glplot.canvas.addEventListener("webglcontextlost",function(F){I&&I.emit&&I.emit("plotly_webglcontextlost",{event:F,layer:P.id})},!1)),P.glplot.oncontextloss=function(){P.recoverContext()},P.glplot.onrender=function(){P.render()},!0},s.render=function(){var P=this,z=P.graphDiv,I,D=P.svgContainer,R=P.container.getBoundingClientRect();z._fullLayout._calcInverseTransform(z);var B=z._fullLayout._invScaleX,F=z._fullLayout._invScaleY,V=R.width*B,G=R.height*F;D.setAttributeNS(null,"viewBox","0 0 "+V+" "+G),D.setAttributeNS(null,"width",V),D.setAttributeNS(null,"height",G),h(P),P.glplot.axes.update(P.axesOptions);for(var J=Object.keys(P.traces),j=null,Y=P.glplot.selection,X=0;X<J.length;++X)I=P.traces[J[X]],I.data.hoverinfo!=="skip"&&I.handlePick(Y)&&(j=I),I.setContourLevels&&I.setContourLevels();function oe(ye,fe,pe){var ge=P.fullSceneLayout[ye+"axis"];return ge.type!=="log"&&(fe=ge.d2l(fe)),t.hoverLabelText(ge,fe,pe)}if(j!==null){var se=g(P.glplot.cameraParams,Y.dataCoordinate);I=j.data;var ie=z._fullData[I.index],N=Y.index,U={xLabel:oe("x",Y.traceCoordinate[0],I.xhoverformat),yLabel:oe("y",Y.traceCoordinate[1],I.yhoverformat),zLabel:oe("z",Y.traceCoordinate[2],I.zhoverformat)},q=f.castHoverinfo(ie,P.fullLayout,N),Q=(q||"").split("+"),W=q&&q==="all";!ie.hovertemplate&&!W&&(Q.indexOf("x")===-1&&(U.xLabel=void 0),Q.indexOf("y")===-1&&(U.yLabel=void 0),Q.indexOf("z")===-1&&(U.zLabel=void 0),Q.indexOf("text")===-1&&(Y.textLabel=void 0),Q.indexOf("name")===-1&&(j.name=void 0));var Z,ee=[];I.type==="cone"||I.type==="streamtube"?(U.uLabel=oe("x",Y.traceCoordinate[3],I.uhoverformat),(W||Q.indexOf("u")!==-1)&&ee.push("u: "+U.uLabel),U.vLabel=oe("y",Y.traceCoordinate[4],I.vhoverformat),(W||Q.indexOf("v")!==-1)&&ee.push("v: "+U.vLabel),U.wLabel=oe("z",Y.traceCoordinate[5],I.whoverformat),(W||Q.indexOf("w")!==-1)&&ee.push("w: "+U.wLabel),U.normLabel=Y.traceCoordinate[6].toPrecision(3),(W||Q.indexOf("norm")!==-1)&&ee.push("norm: "+U.normLabel),I.type==="streamtube"&&(U.divergenceLabel=Y.traceCoordinate[7].toPrecision(3),(W||Q.indexOf("divergence")!==-1)&&ee.push("divergence: "+U.divergenceLabel)),Y.textLabel&&ee.push(Y.textLabel),Z=ee.join("<br>")):I.type==="isosurface"||I.type==="volume"?(U.valueLabel=t.hoverLabelText(P._mockAxis,P._mockAxis.d2l(Y.traceCoordinate[3]),I.valuehoverformat),ee.push("value: "+U.valueLabel),Y.textLabel&&ee.push(Y.textLabel),Z=ee.join("<br>")):Z=Y.textLabel;var te={x:Y.traceCoordinate[0],y:Y.traceCoordinate[1],z:Y.traceCoordinate[2],data:ie._input,fullData:ie,curveNumber:ie.index,pointNumber:N};f.appendArrayPointValue(te,ie,N),I._module.eventData&&(te=ie._module.eventData(te,Y,ie,{},N));var ae={points:[te]};if(P.fullSceneLayout.hovermode){var le=[];f.loneHover({trace:ie,x:(.5+.5*se[0]/se[3])*V,y:(.5-.5*se[1]/se[3])*G,xLabel:U.xLabel,yLabel:U.yLabel,zLabel:U.zLabel,text:Z,name:j.name,color:f.castHoverOption(ie,N,"bgcolor")||j.color,borderColor:f.castHoverOption(ie,N,"bordercolor"),fontFamily:f.castHoverOption(ie,N,"font.family"),fontSize:f.castHoverOption(ie,N,"font.size"),fontColor:f.castHoverOption(ie,N,"font.color"),nameLength:f.castHoverOption(ie,N,"namelength"),textAlign:f.castHoverOption(ie,N,"align"),hovertemplate:n.castOption(ie,N,"hovertemplate"),hovertemplateLabels:n.extendFlat({},te,U),eventData:[te]},{container:D,gd:z,inOut_bbox:le}),te.bbox=le[0]}Y.buttons&&Y.distance<5?z.emit("plotly_click",ae):z.emit("plotly_hover",ae),this.oldEventData=ae}else f.loneUnhover(D),this.oldEventData&&z.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;P.drawAnnotations(P)},s.recoverContext=function(){var P=this;P.glplot.dispose();var z=function(){if(P.glplot.gl.isContextLost()){requestAnimationFrame(z);return}if(!P.initializeGLPlot()){n.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}P.plot.apply(P,P.plotArgs)};requestAnimationFrame(z)};var x=["xaxis","yaxis","zaxis"];function v(P,z,I){for(var D=P.fullSceneLayout,R=0;R<3;R++){var B=x[R],F=B.charAt(0),V=D[B],G=z[F],J=z[F+"calendar"],j=z["_"+F+"length"];if(!n.isArrayOrTypedArray(G))I[0][R]=Math.min(I[0][R],0),I[1][R]=Math.max(I[1][R],j-1);else for(var Y,X=0;X<(j||G.length);X++)if(n.isArrayOrTypedArray(G[X]))for(var oe=0;oe<G[X].length;++oe)Y=V.d2l(G[X][oe],0,J),!isNaN(Y)&&isFinite(Y)&&(I[0][R]=Math.min(I[0][R],Y),I[1][R]=Math.max(I[1][R],Y));else Y=V.d2l(G[X],0,J),!isNaN(Y)&&isFinite(Y)&&(I[0][R]=Math.min(I[0][R],Y),I[1][R]=Math.max(I[1][R],Y))}}function b(P,z){for(var I=P.fullSceneLayout,D=I.annotations||[],R=0;R<3;R++)for(var B=x[R],F=B.charAt(0),V=I[B],G=0;G<D.length;G++){var J=D[G];if(J.visible){var j=V.r2l(J[F]);!isNaN(j)&&isFinite(j)&&(z[0][R]=Math.min(z[0][R],j),z[1][R]=Math.max(z[1][R],j))}}}s.plot=function(P,z,I){var D=this;if(D.plotArgs=[P,z,I],D.glplot.contextLost)return;var R,B,F,V,G,J,j=z[D.id],Y=I[D.id];D.fullLayout=z,D.fullSceneLayout=j,D.axesOptions.merge(z,j),D.spikeOptions.merge(j),D.setViewport(j),D.updateFx(j.dragmode,j.hovermode),D.camera.enableWheel=D.graphDiv._context._scrollZoom.gl3d,D.glplot.setClearColor(o(j.bgcolor)),D.setConvert(G),P?Array.isArray(P)||(P=[P]):P=[];var X=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(F=0;F<P.length;++F)R=P[F],!(R.visible!==!0||R._length===0)&&v(this,R,X);b(this,X);var oe=[1,1,1];for(V=0;V<3;++V)X[1][V]===X[0][V]?oe[V]=1:oe[V]=1/(X[1][V]-X[0][V]);for(D.dataScale=oe,D.convertAnnotations(this),F=0;F<P.length;++F)R=P[F],!(R.visible!==!0||R._length===0)&&(B=D.traces[R.uid],B?B.data.type===R.type?B.update(R):(B.dispose(),B=R._module.plot(this,R),D.traces[R.uid]=B):(B=R._module.plot(this,R),D.traces[R.uid]=B),B.name=R.name);var se=Object.keys(D.traces);e:for(F=0;F<se.length;++F){for(V=0;V<P.length;++V)if(P[V].uid===se[F]&&P[V].visible===!0&&P[V]._length!==0)continue e;B=D.traces[se[F]],B.dispose(),delete D.traces[se[F]]}D.glplot.objects.sort(function(He,Je){return He._trace.data.index-Je._trace.data.index});var ie=[[0,0,0],[0,0,0]],N=[],U={};for(F=0;F<3;++F){if(G=j[x[F]],J=G.type,J in U?(U[J].acc*=oe[F],U[J].count+=1):U[J]={acc:oe[F],count:1},G.autorange){ie[0][F]=1/0,ie[1][F]=-1/0;var q=D.glplot.objects,Q=D.fullSceneLayout.annotations||[],W=G._name.charAt(0);for(V=0;V<q.length;V++){var Z=q[V],ee=Z.bounds,te=Z._trace.data._pad||0;Z.constructor.name==="ErrorBars"&&G._lowerLogErrorBound?ie[0][F]=Math.min(ie[0][F],G._lowerLogErrorBound):ie[0][F]=Math.min(ie[0][F],ee[0][F]/oe[F]-te),ie[1][F]=Math.max(ie[1][F],ee[1][F]/oe[F]+te)}for(V=0;V<Q.length;V++){var ae=Q[V];if(ae.visible){var le=G.r2l(ae[W]);ie[0][F]=Math.min(ie[0][F],le),ie[1][F]=Math.max(ie[1][F],le)}}if("rangemode"in G&&G.rangemode==="tozero"&&(ie[0][F]=Math.min(ie[0][F],0),ie[1][F]=Math.max(ie[1][F],0)),ie[0][F]>ie[1][F])ie[0][F]=-1,ie[1][F]=1;else{var ye=ie[1][F]-ie[0][F];ie[0][F]-=ye/32,ie[1][F]+=ye/32}if(G.autorange==="reversed"){var fe=ie[0][F];ie[0][F]=ie[1][F],ie[1][F]=fe}}else{var pe=G.range;ie[0][F]=G.r2l(pe[0]),ie[1][F]=G.r2l(pe[1])}ie[0][F]===ie[1][F]&&(ie[0][F]-=1,ie[1][F]+=1),N[F]=ie[1][F]-ie[0][F],D.glplot.setBounds(F,{min:ie[0][F]*oe[F],max:ie[1][F]*oe[F]})}var ge,Ae=j.aspectmode;if(Ae==="cube")ge=[1,1,1];else if(Ae==="manual"){var we=j.aspectratio;ge=[we.x,we.y,we.z]}else if(Ae==="auto"||Ae==="data"){var De=[1,1,1];for(F=0;F<3;++F){G=j[x[F]],J=G.type;var Be=U[J];De[F]=Math.pow(Be.acc,1/Be.count)/oe[F]}Ae==="data"||Math.max.apply(null,De)/Math.min.apply(null,De)<=4?ge=De:ge=[1,1,1]}else throw new Error("scene.js aspectRatio was not one of the enumerated types");j.aspectratio.x=Y.aspectratio.x=ge[0],j.aspectratio.y=Y.aspectratio.y=ge[1],j.aspectratio.z=Y.aspectratio.z=ge[2],D.glplot.setAspectratio(j.aspectratio),D.viewInitial.aspectratio||(D.viewInitial.aspectratio={x:j.aspectratio.x,y:j.aspectratio.y,z:j.aspectratio.z}),D.viewInitial.aspectmode||(D.viewInitial.aspectmode=j.aspectmode);var Ve=j.domain||null,xe=z._size||null;if(Ve&&xe){var Le=D.container.style;Le.position="absolute",Le.left=xe.l+Ve.x[0]*xe.w+"px",Le.top=xe.t+(1-Ve.y[1])*xe.h+"px",Le.width=xe.w*(Ve.x[1]-Ve.x[0])+"px",Le.height=xe.h*(Ve.y[1]-Ve.y[0])+"px"}D.glplot.redraw()},s.destroy=function(){var P=this;!P.glplot||(P.camera.mouseListener.enabled=!1,P.container.removeEventListener("wheel",P.camera.wheelListener),P.camera=null,P.glplot.dispose(),P.container.parentNode.removeChild(P.container),P.glplot=null)};function l(P){return[[P.eye.x,P.eye.y,P.eye.z],[P.center.x,P.center.y,P.center.z],[P.up.x,P.up.y,P.up.z]]}function L(P){return{up:{x:P.up[0],y:P.up[1],z:P.up[2]},center:{x:P.center[0],y:P.center[1],z:P.center[2]},eye:{x:P.eye[0],y:P.eye[1],z:P.eye[2]},projection:{type:P._ortho===!0?"orthographic":"perspective"}}}s.getCamera=function(){var P=this;return P.camera.view.recalcMatrix(P.camera.view.lastT()),L(P.camera)},s.setViewport=function(P){var z=this,I=P.camera;z.camera.lookAt.apply(this,l(I)),z.glplot.setAspectratio(P.aspectratio);var D=I.projection.type==="orthographic",R=z.camera._ortho;D!==R&&(z.glplot.redraw(),z.glplot.clearRGBA(),z.glplot.dispose(),z.initializeGLPlot())},s.isCameraChanged=function(P){var z=this,I=z.getCamera(),D=n.nestedProperty(P,z.id+".camera"),R=D.get();function B(J,j,Y,X){var oe=["up","center","eye"],se=["x","y","z"];return j[oe[Y]]&&J[oe[Y]][se[X]]===j[oe[Y]][se[X]]}var F=!1;if(R===void 0)F=!0;else{for(var V=0;V<3;V++)for(var G=0;G<3;G++)if(!B(I,R,V,G)){F=!0;break}(!R.projection||I.projection&&I.projection.type!==R.projection.type)&&(F=!0)}return F},s.isAspectChanged=function(P){var z=this,I=z.glplot.getAspectratio(),D=n.nestedProperty(P,z.id+".aspectratio"),R=D.get();return R===void 0||R.x!==I.x||R.y!==I.y||R.z!==I.z},s.saveLayout=function(P){var z=this,I=z.fullLayout,D,R,B,F,V,G,J=z.isCameraChanged(P),j=z.isAspectChanged(P),Y=J||j;if(Y){var X={};if(J&&(D=z.getCamera(),R=n.nestedProperty(P,z.id+".camera"),B=R.get(),X[z.id+".camera"]=B),j&&(F=z.glplot.getAspectratio(),V=n.nestedProperty(P,z.id+".aspectratio"),G=V.get(),X[z.id+".aspectratio"]=G),a.call("_storeDirectGUIEdit",P,I._preGUI,X),J){R.set(D);var oe=n.nestedProperty(I,z.id+".camera");oe.set(D)}if(j){V.set(F);var se=n.nestedProperty(I,z.id+".aspectratio");se.set(F),z.glplot.redraw()}}return Y},s.updateFx=function(P,z){var I=this,D=I.camera;if(D)if(P==="orbit")D.mode="orbit",D.keyBindingMode="rotate";else if(P==="turntable"){D.up=[0,0,1],D.mode="turntable",D.keyBindingMode="rotate";var R=I.graphDiv,B=R._fullLayout,F=I.fullSceneLayout.camera,V=F.up.x,G=F.up.y,J=F.up.z;if(J/Math.sqrt(V*V+G*G+J*J)<.999){var j=I.id+".camera.up",Y={x:0,y:0,z:1},X={};X[j]=Y;var oe=R.layout;a.call("_storeDirectGUIEdit",oe,B._preGUI,X),F.up=Y,n.nestedProperty(oe,j).set(Y)}}else D.keyBindingMode=P;I.fullSceneLayout.hovermode=z};function S(P,z,I){for(var D=0,R=I-1;D<R;++D,--R)for(var B=0;B<z;++B)for(var F=0;F<4;++F){var V=4*(z*D+B)+F,G=4*(z*R+B)+F,J=P[V];P[V]=P[G],P[G]=J}}function k(P,z,I){for(var D=0;D<I;++D)for(var R=0;R<z;++R){var B=4*(z*D+R),F=P[B+3];if(F>0)for(var V=255/F,G=0;G<3;++G)P[B+G]=Math.min(V*P[B+G],255)}}s.toImage=function(P){var z=this;P||(P="png"),z.staticMode&&z.container.appendChild(m),z.glplot.redraw();var I=z.glplot.gl,D=I.drawingBufferWidth,R=I.drawingBufferHeight;I.bindFramebuffer(I.FRAMEBUFFER,null);var B=new Uint8Array(D*R*4);I.readPixels(0,0,D,R,I.RGBA,I.UNSIGNED_BYTE,B),S(B,D,R),k(B,D,R);var F=document.createElement("canvas");F.width=D,F.height=R;var V=F.getContext("2d"),G=V.createImageData(D,R);G.data.set(B),V.putImageData(G,0,0);var J;switch(P){case"jpeg":J=F.toDataURL("image/jpeg");break;case"webp":J=F.toDataURL("image/webp");break;default:J=F.toDataURL("image/png")}return z.staticMode&&z.container.removeChild(m),J},s.setConvert=function(){for(var P=this,z=0;z<3;z++){var I=P.fullSceneLayout[x[z]];t.setConvert(I,P.fullLayout),I.setScale=n.noop}},s.make4thDimension=function(){var P=this,z=P.graphDiv,I=z._fullLayout;P._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},t.setConvert(P._mockAxis,I)},re.exports=_},{"../../../stackgl_modules":1124,"../../components/fx":406,"../../lib":503,"../../lib/show_no_webgl_msg":525,"../../lib/str2rgbarray":528,"../../plots/cartesian/axes":554,"../../registry":638,"./layout/convert":602,"./layout/spikes":605,"./layout/tick_marks":606,"./project":607,"has-passive-events":229,"webgl-context":331}],609:[function(d,re,ne){re.exports=function(c,M,T,e){e=e||c.length;for(var a=new Array(e),n=0;n<e;n++)a[n]=[c[n],M[n],T[n]];return a}},{}],610:[function(d,re,ne){var w=d("./font_attributes"),c=d("./animation_attributes"),M=d("../components/color/attributes"),T=d("../components/shapes/draw_newshape/attributes"),e=d("./pad_attributes"),a=d("../lib/extend").extendFlat,n=w({editType:"calc"});n.family.dflt='"Open Sans", verdana, arial, sans-serif',n.size.dflt=12,n.color.dflt=M.defaultLine,re.exports={font:n,title:{text:{valType:"string",editType:"layoutstyle"},font:w({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:a(e({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:M.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:M.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:M.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:T.newshape,activeshape:T.activeshape,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:a({},c.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:w({editType:"layoutstyle"})}}},{"../components/color/attributes":365,"../components/shapes/draw_newshape/attributes":451,"../lib/extend":493,"./animation_attributes":548,"./font_attributes":585,"./pad_attributes":618}],611:[function(d,re,ne){var w=d("../../lib/sort_object_keys"),c="1.10.1",M='\xA9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',T=['\xA9 <a target="_blank" href="https://carto.com/">Carto</a>',M].join(" "),e=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),a=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),n={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:M,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:T,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:T,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:a,tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},r=w(n);re.exports={requiredVersion:c,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:n,styleValuesNonMapbox:r,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+c+"."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",r.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":526}],612:[function(d,re,ne){var w=d("../../lib");re.exports=function(M,T){var e=M.split(" "),a=e[0],n=e[1],r=w.isArrayOrTypedArray(T)?w.mean(T):T,t=.5+r/100,f=1.5+r/100,o=["",""],i=[0,0];switch(a){case"top":o[0]="top",i[1]=-f;break;case"bottom":o[0]="bottom",i[1]=f;break}switch(n){case"left":o[1]="right",i[0]=-t;break;case"right":o[1]="left",i[0]=t;break}var g;return o[0]&&o[1]?g=o.join("-"):o[0]?g=o[0]:o[1]?g=o[1]:g="center",{anchor:g,offset:i}}},{"../../lib":503}],613:[function(d,re,ne){var w=d("mapbox-gl/dist/mapbox-gl-unminified"),c=d("../../lib"),M=c.strTranslate,T=c.strScale,e=d("../../plots/get_data").getSubplotCalcData,a=d("../../constants/xmlns_namespaces"),n=d("@plotly/d3"),r=d("../../components/drawing"),t=d("../../lib/svg_text_utils"),f=d("./mapbox"),o="mapbox",i=ne.constants=d("./constants");ne.name=o,ne.attr="subplot",ne.idRoot=o,ne.idRegex=ne.attrRegex=c.counterRegex(o),ne.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},ne.layoutAttributes=d("./layout_attributes"),ne.supplyLayoutDefaults=d("./layout_defaults"),ne.plot=function(h){var m=h._fullLayout,u=h.calcdata,_=m._subplots[o];if(w.version!==i.requiredVersion)throw new Error(i.wrongVersionErrorMsg);var s=g(h,_);w.accessToken=s;for(var A=0;A<_.length;A++){var x=_[A],v=e(u,o,x),b=m[x],l=b._subplot;l||(l=new f(h,x),m[x]._subplot=l),l.viewInitial||(l.viewInitial={center:c.extendFlat({},b.center),zoom:b.zoom,bearing:b.bearing,pitch:b.pitch}),l.plot(v,m,h._promises)}},ne.clean=function(y,h,m,u){for(var _=u._subplots[o]||[],s=0;s<_.length;s++){var A=_[s];!h[A]&&!!u[A]._subplot&&u[A]._subplot.destroy()}},ne.toSVG=function(y){for(var h=y._fullLayout,m=h._subplots[o],u=h._size,_=0;_<m.length;_++){var s=h[m[_]],A=s.domain,x=s._subplot,v=x.toImage("png"),b=h._glimages.append("svg:image");b.attr({xmlns:a.svg,"xlink:href":v,x:u.l+u.w*A.x[0],y:u.t+u.h*(1-A.y[1]),width:u.w*(A.x[1]-A.x[0]),height:u.h*(A.y[1]-A.y[0]),preserveAspectRatio:"none"});var l=n.select(s._subplot.div),L=l.select(".mapboxgl-ctrl-logo").node().offsetParent===null;if(!L){var S=h._glimages.append("g");S.attr("transform",M(u.l+u.w*A.x[0]+10,u.t+u.h*(1-A.y[0])-31)),S.append("path").attr("d",i.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),S.append("path").attr("d",i.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),S.append("path").attr("d",i.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),S.append("polygon").attr("points",i.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var k=l.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),P=h._glimages.append("g"),z=P.append("text");z.text(k).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":k});var I=r.bBox(z.node()),D=u.w*(A.x[1]-A.x[0]);if(I.width>D/2){var R=k.split("|").join("<br>");z.text(R).attr("data-unformatted",R).call(t.convertToTspans,y),I=r.bBox(z.node())}z.attr("transform",M(-3,-I.height+8)),P.insert("rect",".static-attribution").attr({x:-I.width-6,y:-I.height-3,width:I.width+6,height:I.height+3,fill:"rgba(255, 255, 255, 0.75)"});var B=1;I.width+6>D&&(B=D/(I.width+6));var F=[u.l+u.w*A.x[1],u.t+u.h*(1-A.y[0])];P.attr("transform",M(F[0],F[1])+T(B))}};function g(y,h){var m=y._fullLayout,u=y._context;if(u.mapboxAccessToken==="")return"";for(var _=[],s=[],A=!1,x=!1,v=0;v<h.length;v++){var b=m[h[v]],l=b.accesstoken;p(b.style)&&(l?c.pushUnique(_,l):(p(b._input.style)&&(c.error("Uses Mapbox map style, but did not set an access token."),A=!0),x=!0)),l&&c.pushUnique(s,l)}if(x){var L=A?i.noAccessTokenErrorMsg:i.missingStyleErrorMsg;throw c.error(L),new Error(L)}return _.length?(_.length>1&&c.warn(i.multipleTokensErrorMsg),_[0]):(s.length&&c.log(["Listed mapbox access token(s)",s.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}function p(y){return typeof y=="string"&&(i.styleValuesMapbox.indexOf(y)!==-1||y.indexOf("mapbox://")===0)}ne.updateFx=function(y){for(var h=y._fullLayout,m=h._subplots[o],u=0;u<m.length;u++){var _=h[m[u]]._subplot;_.updateFx(h)}}},{"../../components/drawing":388,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/get_data":593,"./constants":611,"./layout_attributes":615,"./layout_defaults":616,"./mapbox":617,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],614:[function(d,re,ne){var w=d("../../lib"),c=d("../../lib/svg_text_utils").sanitizeHTML,M=d("./convert_text_opts"),T=d("./constants");function e(f,o){this.subplot=f,this.uid=f.uid+"-"+o,this.index=o,this.idSource="source-"+this.uid,this.idLayer=T.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var a=e.prototype;a.update=function(o){this.visible?this.needsNewImage(o)?this.updateImage(o):this.needsNewSource(o)?(this.removeLayer(),this.updateSource(o),this.updateLayer(o)):this.needsNewLayer(o)?this.updateLayer(o):this.updateStyle(o):(this.updateSource(o),this.updateLayer(o)),this.visible=n(o)},a.needsNewImage=function(f){var o=this.subplot.map;return o.getSource(this.idSource)&&this.sourceType==="image"&&f.sourcetype==="image"&&(this.source!==f.source||JSON.stringify(this.coordinates)!==JSON.stringify(f.coordinates))},a.needsNewSource=function(f){return this.sourceType!==f.sourcetype||JSON.stringify(this.source)!==JSON.stringify(f.source)||this.layerType!==f.type},a.needsNewLayer=function(f){return this.layerType!==f.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},a.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},a.updateImage=function(f){var o=this.subplot.map;o.getSource(this.idSource).updateImage({url:f.source,coordinates:f.coordinates});var i=this.findFollowingMapboxLayerId(this.lookupBelow());i!==null&&this.subplot.map.moveLayer(this.idLayer,i)},a.updateSource=function(f){var o=this.subplot.map;if(o.getSource(this.idSource)&&o.removeSource(this.idSource),this.sourceType=f.sourcetype,this.source=f.source,!!n(f)){var i=t(f);o.addSource(this.idSource,i)}},a.findFollowingMapboxLayerId=function(f){if(f==="traces")for(var o=this.subplot.getMapLayers(),i=0;i<o.length;i++){var g=o[i].id;if(typeof g=="string"&&g.indexOf(T.traceLayerPrefix)===0){f=g;break}}return f},a.updateLayer=function(f){var o=this.subplot,i=r(f),g=this.lookupBelow(),p=this.findFollowingMapboxLayerId(g);this.removeLayer(),n(f)&&o.addLayer({id:this.idLayer,source:this.idSource,"source-layer":f.sourcelayer||"",type:f.type,minzoom:f.minzoom,maxzoom:f.maxzoom,layout:i.layout,paint:i.paint},p),this.layerType=f.type,this.below=g},a.updateStyle=function(f){if(n(f)){var o=r(f);this.subplot.setOptions(this.idLayer,"setLayoutProperty",o.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",o.paint)}},a.removeLayer=function(){var f=this.subplot.map;f.getLayer(this.idLayer)&&f.removeLayer(this.idLayer)},a.dispose=function(){var f=this.subplot.map;f.getLayer(this.idLayer)&&f.removeLayer(this.idLayer),f.getSource(this.idSource)&&f.removeSource(this.idSource)};function n(f){if(!f.visible)return!1;var o=f.source;if(Array.isArray(o)&&o.length>0){for(var i=0;i<o.length;i++)if(typeof o[i]!="string"||o[i].length===0)return!1;return!0}return w.isPlainObject(o)||typeof o=="string"&&o.length>0}function r(f){var o={},i={};switch(f.type){case"circle":w.extendFlat(i,{"circle-radius":f.circle.radius,"circle-color":f.color,"circle-opacity":f.opacity});break;case"line":w.extendFlat(i,{"line-width":f.line.width,"line-color":f.color,"line-opacity":f.opacity,"line-dasharray":f.line.dash});break;case"fill":w.extendFlat(i,{"fill-color":f.color,"fill-outline-color":f.fill.outlinecolor,"fill-opacity":f.opacity});break;case"symbol":var g=f.symbol,p=M(g.textposition,g.iconsize);w.extendFlat(o,{"icon-image":g.icon+"-15","icon-size":g.iconsize/10,"text-field":g.text,"text-size":g.textfont.size,"text-anchor":p.anchor,"text-offset":p.offset,"symbol-placement":g.placement}),w.extendFlat(i,{"icon-color":f.color,"text-color":g.textfont.color,"text-opacity":f.opacity});break;case"raster":w.extendFlat(i,{"raster-fade-duration":0,"raster-opacity":f.opacity});break}return{layout:o,paint:i}}function t(f){var o=f.sourcetype,i=f.source,g={type:o},p;return o==="geojson"?p="data":o==="vector"?p=typeof i=="string"?"url":"tiles":o==="raster"?(p="tiles",g.tileSize=256):o==="image"&&(p="url",g.coordinates=f.coordinates),g[p]=i,f.sourceattribution&&(g.attribution=c(f.sourceattribution)),g}re.exports=function(o,i,g){var p=new e(o,i);return p.update(g),p}},{"../../lib":503,"../../lib/svg_text_utils":529,"./constants":611,"./convert_text_opts":612}],615:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/color").defaultLine,M=d("../domain").attributes,T=d("../font_attributes"),e=d("../../traces/scatter/attributes").textposition,a=d("../../plot_api/edit_types").overrideAll,n=d("../../plot_api/plot_template").templatedArray,r=d("./constants"),t=T({});t.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var f=re.exports=a({_arrayAttrRegexps:[w.counterRegex("mapbox",".layers",!0)],domain:M({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:r.styleValuesMapbox.concat(r.styleValuesNonMapbox),dflt:r.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:n("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:c},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:c}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:t,textposition:w.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root");f.uirevision={valType:"any",editType:"none"}},{"../../components/color":366,"../../lib":503,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../traces/scatter/attributes":927,"../domain":584,"../font_attributes":585,"./constants":611}],616:[function(d,re,ne){var w=d("../../lib"),c=d("../subplot_defaults"),M=d("../array_container_defaults"),T=d("./layout_attributes");re.exports=function(r,t,f){c(r,t,f,{type:"mapbox",attributes:T,handleDefaults:e,partition:"y",accessToken:t._mapboxAccessToken})};function e(n,r,t,f){t("accesstoken",f.accessToken),t("style"),t("center.lon"),t("center.lat"),t("zoom"),t("bearing"),t("pitch"),M(n,r,{name:"layers",handleItemDefaults:a}),r._input=n}function a(n,r){function t(y,h){return w.coerce(n,r,T.layers,y,h)}var f=t("visible");if(f){var o=t("sourcetype"),i=o==="raster"||o==="image";t("source"),t("sourceattribution"),o==="vector"&&t("sourcelayer"),o==="image"&&t("coordinates");var g;i&&(g="raster");var p=t("type",g);i&&p!=="raster"&&(p=r.type="raster",w.log("Source types *raster* and *image* must drawn *raster* layer type.")),t("below"),t("color"),t("opacity"),t("minzoom"),t("maxzoom"),p==="circle"&&t("circle.radius"),p==="line"&&(t("line.width"),t("line.dash")),p==="fill"&&t("fill.outlinecolor"),p==="symbol"&&(t("symbol.icon"),t("symbol.iconsize"),t("symbol.text"),w.coerceFont(t,"symbol.textfont"),t("symbol.textposition"),t("symbol.placement"))}}},{"../../lib":503,"../array_container_defaults":549,"../subplot_defaults":632,"./layout_attributes":615}],617:[function(d,re,ne){var w=d("mapbox-gl/dist/mapbox-gl-unminified"),c=d("../../lib"),M=d("../../lib/geo_location_utils"),T=d("../../registry"),e=d("../cartesian/axes"),a=d("../../components/dragelement"),n=d("../../components/fx"),r=d("../../components/dragelement/helpers"),t=r.rectMode,f=r.drawMode,o=r.selectMode,i=d("../cartesian/select").prepSelect,g=d("../cartesian/select").clearSelect,p=d("../cartesian/select").clearSelectionsCache,y=d("../cartesian/select").selectOnClick,h=d("./constants"),m=d("./layers");function u(b,l){this.id=l,this.gd=b;var L=b._fullLayout,S=b._context;this.container=L._glcontainer.node(),this.isStatic=S.staticPlot,this.uid=L._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(L),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var _=u.prototype;_.plot=function(b,l,L){var S=this,k=l[S.id];S.map&&k.accesstoken!==S.accessToken&&(S.map.remove(),S.map=null,S.styleObj=null,S.traceHash={},S.layerList=[]);var P;S.map?P=new Promise(function(z,I){S.updateMap(b,l,z,I)}):P=new Promise(function(z,I){S.createMap(b,l,z,I)}),L.push(P)},_.createMap=function(b,l,L,S){var k=this,P=l[k.id],z=k.styleObj=A(P.style);k.accessToken=P.accesstoken;var I=k.map=new w.Map({container:k.div,style:z.style,center:v(P.center),zoom:P.zoom,bearing:P.bearing,pitch:P.pitch,interactive:!k.isStatic,preserveDrawingBuffer:k.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new w.AttributionControl({compact:!0}));I._canvas.style.left="0px",I._canvas.style.top="0px",k.rejectOnError(S),k.isStatic||k.initFx(b,l);var D=[];D.push(new Promise(function(R){I.once("load",R)})),D=D.concat(M.fetchTraceGeoData(b)),Promise.all(D).then(function(){k.fillBelowLookup(b,l),k.updateData(b),k.updateLayout(l),k.resolveOnRender(L)}).catch(S)},_.updateMap=function(b,l,L,S){var k=this,P=k.map,z=l[this.id];k.rejectOnError(S);var I=[],D=A(z.style);JSON.stringify(k.styleObj)!==JSON.stringify(D)&&(k.styleObj=D,P.setStyle(D.style),k.traceHash={},I.push(new Promise(function(R){P.once("styledata",R)}))),I=I.concat(M.fetchTraceGeoData(b)),Promise.all(I).then(function(){k.fillBelowLookup(b,l),k.updateData(b),k.updateLayout(l),k.resolveOnRender(L)}).catch(S)},_.fillBelowLookup=function(b,l){var L=l[this.id],S=L.layers,k,P,z=this.belowLookup={},I=!1;for(k=0;k<b.length;k++){var D=b[k][0].trace,R=D._module;typeof D.below=="string"?P=D.below:R.getBelow&&(P=R.getBelow(D,this)),P===""&&(I=!0),z["trace-"+D.uid]=P||""}for(k=0;k<S.length;k++){var B=S[k];typeof B.below=="string"?P=B.below:I?P="traces":P="",z["layout-"+k]=P}var F={},V,G;for(V in z)P=z[V],F[P]?F[P].push(V):F[P]=[V];for(P in F){var J=F[P];if(J.length>1)for(k=0;k<J.length;k++)V=J[k],V.indexOf("trace-")===0?(G=V.split("trace-")[1],this.traceHash[G]&&(this.traceHash[G].below=null)):V.indexOf("layout-")===0&&(G=V.split("layout-")[1],this.layerList[G]&&(this.layerList[G].below=null))}};var s={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};_.updateData=function(b){var l=this.traceHash,L,S,k,P,z=b.slice().sort(function(F,V){return s[F[0].trace.type]-s[V[0].trace.type]});for(k=0;k<z.length;k++){var I=z[k];S=I[0].trace,L=l[S.uid];var D=!1;L&&(L.type===S.type?(L.update(I),D=!0):L.dispose()),!D&&S._module&&(l[S.uid]=S._module.plot(this,I))}var R=Object.keys(l);e:for(k=0;k<R.length;k++){var B=R[k];for(P=0;P<b.length;P++)if(S=b[P][0].trace,B===S.uid)continue e;L=l[B],L.dispose(),delete l[B]}},_.updateLayout=function(b){var l=this.map,L=b[this.id];!this.dragging&&!this.wheeling&&(l.setCenter(v(L.center)),l.setZoom(L.zoom),l.setBearing(L.bearing),l.setPitch(L.pitch)),this.updateLayers(b),this.updateFramework(b),this.updateFx(b),this.map.resize(),this.gd._context._scrollZoom.mapbox?l.scrollZoom.enable():l.scrollZoom.disable()},_.resolveOnRender=function(b){var l=this.map;l.on("render",function L(){l.loaded()&&(l.off("render",L),setTimeout(b,10))})},_.rejectOnError=function(b){var l=this.map;function L(){b(new Error(h.mapOnErrorMsg))}l.once("error",L),l.once("style.error",L),l.once("source.error",L),l.once("tile.error",L),l.once("layer.error",L)},_.createFramework=function(b){var l=this,L=l.div=document.createElement("div");L.id=l.uid,L.style.position="absolute",l.container.appendChild(L),l.xaxis={_id:"x",c2p:function(S){return l.project(S).x}},l.yaxis={_id:"y",c2p:function(S){return l.project(S).y}},l.updateFramework(b),l.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(l.mockAxis,b)},_.initFx=function(b,l){var L=this,S=L.gd,k=L.map;k.on("moveend",function(I){if(!!L.map){var D=S._fullLayout;if(I.originalEvent||L.wheeling){var R=D[L.id];T.call("_storeDirectGUIEdit",S.layout,D._preGUI,L.getViewEdits(R));var B=L.getView();R._input.center=R.center=B.center,R._input.zoom=R.zoom=B.zoom,R._input.bearing=R.bearing=B.bearing,R._input.pitch=R.pitch=B.pitch,S.emit("plotly_relayout",L.getViewEditsWithDerived(B))}I.originalEvent&&I.originalEvent.type==="mouseup"?L.dragging=!1:L.wheeling&&(L.wheeling=!1),D._rehover&&D._rehover()}}),k.on("wheel",function(){L.wheeling=!0}),k.on("mousemove",function(I){var D=L.div.getBoundingClientRect(),R=[I.originalEvent.offsetX,I.originalEvent.offsetY];I.target.getBoundingClientRect=function(){return D},L.xaxis.p2c=function(){return k.unproject(R).lng},L.yaxis.p2c=function(){return k.unproject(R).lat},S._fullLayout._rehover=function(){S._fullLayout._hoversubplot===L.id&&S._fullLayout[L.id]&&n.hover(S,I,L.id)},n.hover(S,I,L.id),S._fullLayout._hoversubplot=L.id});function P(){n.loneUnhover(l._hoverlayer)}k.on("dragstart",function(){L.dragging=!0,P()}),k.on("zoomstart",P),k.on("mouseout",function(){S._fullLayout._hoversubplot=null});function z(){var I=L.getView();S.emit("plotly_relayouting",L.getViewEditsWithDerived(I))}k.on("drag",z),k.on("zoom",z),k.on("dblclick",function(){var I=S._fullLayout[L.id];T.call("_storeDirectGUIEdit",S.layout,S._fullLayout._preGUI,L.getViewEdits(I));var D=L.viewInitial;k.setCenter(v(D.center)),k.setZoom(D.zoom),k.setBearing(D.bearing),k.setPitch(D.pitch);var R=L.getView();I._input.center=I.center=R.center,I._input.zoom=I.zoom=R.zoom,I._input.bearing=I.bearing=R.bearing,I._input.pitch=I.pitch=R.pitch,S.emit("plotly_doubleclick",null),S.emit("plotly_relayout",L.getViewEditsWithDerived(R))}),L.clearSelect=function(){p(L.dragOptions),g(L.dragOptions.gd)},L.onClickInPanFn=function(I){return function(D){var R=S._fullLayout.clickmode;R.indexOf("select")>-1&&y(D.originalEvent,S,[L.xaxis],[L.yaxis],L.id,I),R.indexOf("event")>-1&&n.click(S,D.originalEvent)}}},_.updateFx=function(b){var l=this,L=l.map,S=l.gd;if(l.isStatic)return;function k(D){var R=l.map.unproject(D);return[R.lng,R.lat]}var P=b.dragmode,z;t(P)?z=function(D,R){var B=D.range={};B[l.id]=[k([R.xmin,R.ymin]),k([R.xmax,R.ymax])]}:z=function(D,R,B){var F=D.lassoPoints={};F[l.id]=B.filtered.map(k)};var I=l.dragOptions;l.dragOptions=c.extendDeep(I||{},{dragmode:b.dragmode,element:l.div,gd:S,plotinfo:{id:l.id,domain:b[l.id].domain,xaxis:l.xaxis,yaxis:l.yaxis,fillRangeItems:z},xaxes:[l.xaxis],yaxes:[l.yaxis],subplot:l.id}),L.off("click",l.onClickInPanHandler),o(P)||f(P)?(L.dragPan.disable(),L.on("zoomstart",l.clearSelect),l.dragOptions.prepFn=function(D,R,B){i(D,R,B,l.dragOptions,P)},a.init(l.dragOptions)):(L.dragPan.enable(),L.off("zoomstart",l.clearSelect),l.div.onmousedown=null,l.onClickInPanHandler=l.onClickInPanFn(l.dragOptions),L.on("click",l.onClickInPanHandler))},_.updateFramework=function(b){var l=b[this.id].domain,L=b._size,S=this.div.style;S.width=L.w*(l.x[1]-l.x[0])+"px",S.height=L.h*(l.y[1]-l.y[0])+"px",S.left=L.l+l.x[0]*L.w+"px",S.top=L.t+(1-l.y[1])*L.h+"px",this.xaxis._offset=L.l+l.x[0]*L.w,this.xaxis._length=L.w*(l.x[1]-l.x[0]),this.yaxis._offset=L.t+(1-l.y[1])*L.h,this.yaxis._length=L.h*(l.y[1]-l.y[0])},_.updateLayers=function(b){var l=b[this.id],L=l.layers,S=this.layerList,k;if(L.length!==S.length){for(k=0;k<S.length;k++)S[k].dispose();for(S=this.layerList=[],k=0;k<L.length;k++)S.push(m(this,k,L[k]))}else for(k=0;k<L.length;k++)S[k].update(L[k])},_.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},_.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},_.setOptions=function(b,l,L){for(var S in L)this.map[l](b,S,L[S])},_.getMapLayers=function(){return this.map.getStyle().layers},_.addLayer=function(b,l){var L=this.map;if(typeof l=="string"){if(l===""){L.addLayer(b,l);return}for(var S=this.getMapLayers(),k=0;k<S.length;k++)if(l===S[k].id){L.addLayer(b,l);return}c.warn(["Trying to add layer with *below* value",l,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}L.addLayer(b)},_.project=function(b){return this.map.project(new w.LngLat(b[0],b[1]))},_.getView=function(){var b=this.map,l=b.getCenter(),L=l.lng,S=l.lat,k={lon:L,lat:S},P=b.getCanvas(),z=parseInt(P.style.width),I=parseInt(P.style.height);return{center:k,zoom:b.getZoom(),bearing:b.getBearing(),pitch:b.getPitch(),_derived:{coordinates:[b.unproject([0,0]).toArray(),b.unproject([z,0]).toArray(),b.unproject([z,I]).toArray(),b.unproject([0,I]).toArray()]}}},_.getViewEdits=function(b){for(var l=this.id,L=["center","zoom","bearing","pitch"],S={},k=0;k<L.length;k++){var P=L[k];S[l+"."+P]=b[P]}return S},_.getViewEditsWithDerived=function(b){var l=this.id,L=this.getViewEdits(b);return L[l+"._derived"]=b._derived,L};function A(b){var l={};return c.isPlainObject(b)?(l.id=b.id,l.style=b):typeof b=="string"?(l.id=b,h.styleValuesMapbox.indexOf(b)!==-1?l.style=x(b):h.stylesNonMapbox[b]?l.style=h.stylesNonMapbox[b]:l.style=b):(l.id=h.styleValueDflt,l.style=x(h.styleValueDflt)),l.transition={duration:0,delay:0},l}function x(b){return h.styleUrlPrefix+b+"-"+h.styleUrlSuffix}function v(b){return[b.lon,b.lat]}re.exports=u},{"../../components/dragelement":385,"../../components/dragelement/helpers":384,"../../components/fx":406,"../../lib":503,"../../lib/geo_location_utils":496,"../../registry":638,"../cartesian/axes":554,"../cartesian/select":575,"./constants":611,"./layers":614,"mapbox-gl/dist/mapbox-gl-unminified":239}],618:[function(d,re,ne){re.exports=function(w){var c=w.editType;return{t:{valType:"number",dflt:0,editType:c},r:{valType:"number",dflt:0,editType:c},b:{valType:"number",dflt:0,editType:c},l:{valType:"number",dflt:0,editType:c},editType:c}}},{}],619:[function(d,re,ne){var w=d("@plotly/d3"),c=d("d3-time-format").timeFormatLocale,M=d("d3-format").formatLocale,T=d("fast-isnumeric"),e=d("../registry"),a=d("../plot_api/plot_schema"),n=d("../plot_api/plot_template"),r=d("../lib"),t=d("../components/color"),f=d("../constants/numerical").BADNUM,o=d("./cartesian/axis_ids"),i=d("./cartesian/handle_outline").clearSelect,g=d("./animation_attributes"),p=d("./frame_attributes"),y=d("../plots/get_data").getModuleCalcData,h=r.relinkPrivateKeys,m=r._,u=re.exports={};r.extendFlat(u,e),u.attributes=d("./attributes"),u.attributes.type.values=u.allTypes,u.fontAttrs=d("./font_attributes"),u.layoutAttributes=d("./layout_attributes"),u.fontWeight="normal";var _=u.transformsRegistry,s=d("./command");u.executeAPICommand=s.executeAPICommand,u.computeAPICommandBindings=s.computeAPICommandBindings,u.manageCommandObserver=s.manageCommandObserver,u.hasSimpleAPICommandBindings=s.hasSimpleAPICommandBindings,u.redrawText=function(N){return N=r.getGraphDiv(N),new Promise(function(U){setTimeout(function(){!N._fullLayout||(e.getComponentMethod("annotations","draw")(N),e.getComponentMethod("legend","draw")(N),e.getComponentMethod("colorbar","draw")(N),U(u.previousPromises(N)))},300)})},u.resize=function(N){N=r.getGraphDiv(N);var U,q=new Promise(function(Q,W){(!N||r.isHidden(N))&&W(new Error("Resize must be passed a displayed plot div element.")),N._redrawTimer&&clearTimeout(N._redrawTimer),N._resolveResize&&(U=N._resolveResize),N._resolveResize=Q,N._redrawTimer=setTimeout(function(){if(!N.layout||N.layout.width&&N.layout.height||r.isHidden(N)){Q(N);return}delete N.layout.width,delete N.layout.height;var Z=N.changed;N.autoplay=!0,e.call("relayout",N,{autosize:!0}).then(function(){N.changed=Z,N._resolveResize===Q&&(delete N._resolveResize,Q(N))})},100)});return U&&U(q),q},u.previousPromises=function(N){if((N._promises||[]).length)return Promise.all(N._promises).then(function(){N._promises=[]})},u.addLinks=function(N){if(!(!N._context.showLink&&!N._context.showSources)){var U=N._fullLayout,q=r.ensureSingle(U._paper,"text","js-plot-link-container",function(ae){ae.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:t.defaultLine,"pointer-events":"all"}).each(function(){var le=w.select(this);le.append("tspan").classed("js-link-to-tool",!0),le.append("tspan").classed("js-link-spacer",!0),le.append("tspan").classed("js-sourcelinks",!0)})}),Q=q.node(),W={y:U._paper.attr("height")-9};document.body.contains(Q)&&Q.getComputedTextLength()>=U.width-20?(W["text-anchor"]="start",W.x=5):(W["text-anchor"]="end",W.x=U._paper.attr("width")-7),q.attr(W);var Z=q.select(".js-link-to-tool"),ee=q.select(".js-link-spacer"),te=q.select(".js-sourcelinks");N._context.showSources&&N._context.showSources(N),N._context.showLink&&A(N,Z),ee.text(Z.text()&&te.text()?" - ":"")}};function A(N,U){U.text("");var q=U.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(N._context.linkText+" "+String.fromCharCode(187));if(N._context.sendData)q.on("click",function(){u.sendDataToCloud(N)});else{var Q=window.location.pathname.split("/"),W=window.location.search;q.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+Q[2].split(".")[0]+"/"+Q[1]+W})}}u.sendDataToCloud=function(N){var U=(window.PLOTLYENV||{}).BASE_URL||N._context.plotlyServerURL;if(!!U){N.emit("plotly_beforeexport");var q=w.select(N).append("div").attr("id","hiddenform").style("display","none"),Q=q.append("form").attr({action:U+"/external",method:"post",target:"_blank"}),W=Q.append("input").attr({type:"text",name:"data"});return W.node().value=u.graphJson(N,!1,"keepdata"),Q.node().submit(),q.remove(),N.emit("plotly_afterexport"),!1}};var x=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],v=["year","month","dayMonth","dayMonthYear"];u.supplyDefaults=function(N,U){var q=U&&U.skipUpdateCalc,Q=N._fullLayout||{};if(Q._skipDefaults){delete Q._skipDefaults;return}var W=N._fullLayout={},Z=N.layout||{},ee=N._fullData||[],te=N._fullData=[],ae=N.data||[],le=N.calcdata||[],ye=N._context||{},fe;N._transitionData||u.createTransitionData(N),W._dfltTitle={plot:m(N,"Click to enter Plot title"),x:m(N,"Click to enter X axis title"),y:m(N,"Click to enter Y axis title"),colorbar:m(N,"Click to enter Colorscale title"),annotation:m(N,"new text")},W._traceWord=m(N,"trace");var pe=L(N,x);if(W._mapboxAccessToken=ye.mapboxAccessToken,Q._initialAutoSizeIsDone){var ge=Q.width,Ae=Q.height;u.supplyLayoutGlobalDefaults(Z,W,pe),Z.width||(W.width=ge),Z.height||(W.height=Ae),u.sanitizeMargins(W)}else{u.supplyLayoutGlobalDefaults(Z,W,pe);var we=!Z.width||!Z.height,De=W.autosize,Be=ye.autosizable,Ve=we&&(De||Be);Ve?u.plotAutoSize(N,Z,W):we&&u.sanitizeMargins(W),!De&&we&&(Z.width=W.width,Z.height=W.height)}W._d3locale=S(pe,W.separators),W._extraFormat=L(N,v),W._initialAutoSizeIsDone=!0,W._dataLength=ae.length,W._modules=[],W._visibleModules=[],W._basePlotModules=[];var xe=W._subplots=l(),Le=W._splomAxes={x:{},y:{}},He=W._splomSubplots={};W._splomGridDflt={},W._scatterStackOpts={},W._firstScatter={},W._alignmentOpts={},W._colorAxes={},W._requestRangeslider={},W._traceUids=b(ee,ae),W._globalTransforms=(N._context||{}).globalTransforms,u.supplyDataDefaults(ae,te,Z,W);var Je=Object.keys(Le.x),Oe=Object.keys(Le.y);if(Je.length>1&&Oe.length>1){for(e.getComponentMethod("grid","sizeDefaults")(Z,W),fe=0;fe<Je.length;fe++)r.pushUnique(xe.xaxis,Je[fe]);for(fe=0;fe<Oe.length;fe++)r.pushUnique(xe.yaxis,Oe[fe]);for(var Pe in He)r.pushUnique(xe.cartesian,Pe)}if(W._has=u._hasPlotType.bind(W),ee.length===te.length)for(fe=0;fe<te.length;fe++)h(te[fe],ee[fe]);u.supplyLayoutModuleDefaults(Z,W,te,N._transitionData);var Ue=W._visibleModules,vt=[];for(fe=0;fe<Ue.length;fe++){var Lt=Ue[fe].crossTraceDefaults;Lt&&r.pushUnique(vt,Lt)}for(fe=0;fe<vt.length;fe++)vt[fe](te,W);W._hasOnlyLargeSploms=W._basePlotModules.length===1&&W._basePlotModules[0].name==="splom"&&Je.length>15&&Oe.length>15&&W.shapes.length===0&&W.images.length===0,u.linkSubplots(te,W,ee,Q),u.cleanPlot(te,W,ee,Q);var Yt=!!(Q._has&&Q._has("gl2d")),At=!!(W._has&&W._has("gl2d")),Rt=!!(Q._has&&Q._has("cartesian")),Bt=!!(W._has&&W._has("cartesian")),Mt=Rt||Yt,Tt=Bt||At;Mt&&!Tt?Q._bgLayer.remove():Tt&&!Mt&&(W._shouldCreateBgLayer=!0),Q._zoomlayer&&!N._dragging&&i({_fullLayout:Q}),k(te,W),h(W,Q),e.getComponentMethod("colorscale","crossTraceDefaults")(te,W),W._preGUI||(W._preGUI={}),W._tracePreGUI||(W._tracePreGUI={});var at=W._tracePreGUI,ct={},je;for(je in at)ct[je]="old";for(fe=0;fe<te.length;fe++)je=te[fe]._fullInput.uid,ct[je]||(at[je]={}),ct[je]="new";for(je in ct)ct[je]==="old"&&delete at[je];R(W),e.getComponentMethod("rangeslider","makeData")(W),!q&&le.length===te.length&&u.supplyDefaultsUpdateCalc(le,te)},u.supplyDefaultsUpdateCalc=function(N,U){for(var q=0;q<U.length;q++){var Q=U[q],W=(N[q]||[])[0];if(W&&W.trace){var Z=W.trace;if(Z._hasCalcTransform){var ee=Z._arrayAttrs,te,ae,le;for(te=0;te<ee.length;te++)ae=ee[te],le=r.nestedProperty(Z,ae).get().slice(),r.nestedProperty(Q,ae).set(le)}W.trace=Q}}};function b(N,U){var q=U.length,Q=[],W,Z;for(W=0;W<N.length;W++){var ee=N[W]._fullInput;ee!==Z&&Q.push(ee),Z=ee}var te=Q.length,ae=new Array(q),le={};function ye(ge,Ae){ae[Ae]=ge,le[ge]=1}function fe(ge,Ae){if(ge&&typeof ge=="string"&&!le[ge])return ye(ge,Ae),!0}for(W=0;W<q;W++){var pe=U[W].uid;typeof pe=="number"&&(pe=String(pe)),!fe(pe,W)&&(W<te&&fe(Q[W].uid,W)||ye(r.randstr(le),W))}return ae}function l(){var N=e.collectableSubplotTypes,U={},q,Q;if(!N){N=[];var W=e.subplotsRegistry;for(var Z in W){var ee=W[Z],te=ee.attr;if(te&&(N.push(Z),Array.isArray(te)))for(Q=0;Q<te.length;Q++)r.pushUnique(N,te[Q])}}for(q=0;q<N.length;q++)U[N[q]]=[];return U}function L(N,U){var q=N._context.locale;q||(q="en-US");var Q=!1,W={};function Z(fe){for(var pe=!0,ge=0;ge<U.length;ge++){var Ae=U[ge];W[Ae]||(fe[Ae]?W[Ae]=fe[Ae]:pe=!1)}pe&&(Q=!0)}for(var ee=0;ee<2;ee++){for(var te=N._context.locales,ae=0;ae<2;ae++){var le=(te[q]||{}).format;if(le&&(Z(le),Q))break;te=e.localeRegistry}var ye=q.split("-")[0];if(Q||ye===q)break;q=ye}return Q||Z(e.localeRegistry.en.format),W}function S(N,U){return N.decimal=U.charAt(0),N.thousands=U.charAt(1),{numberFormat:function(q){try{q=M(N).format(r.adjustFormat(q))}catch{return r.warnBadFormat(q),r.noFormat}return q},timeFormat:c(N).utcFormat}}function k(N,U){var q,Q=[];U.meta&&(q=U._meta={meta:U.meta,layout:{meta:U.meta}});for(var W=0;W<N.length;W++){var Z=N[W];Z.meta?Q[Z.index]=Z._meta={meta:Z.meta}:U.meta&&(Z._meta={meta:U.meta}),U.meta&&(Z._meta.layout={meta:U.meta})}Q.length&&(q||(q=U._meta={}),q.data=Q)}u.createTransitionData=function(N){N._transitionData||(N._transitionData={}),N._transitionData._frames||(N._transitionData._frames=[]),N._transitionData._frameHash||(N._transitionData._frameHash={}),N._transitionData._counter||(N._transitionData._counter=0),N._transitionData._interruptCallbacks||(N._transitionData._interruptCallbacks=[])},u._hasPlotType=function(N){var U,q=this._basePlotModules||[];for(U=0;U<q.length;U++)if(q[U].name===N)return!0;var Q=this._modules||[];for(U=0;U<Q.length;U++){var W=Q[U].name;if(W===N)return!0;var Z=e.modules[W];if(Z&&Z.categories[N])return!0}return!1},u.cleanPlot=function(N,U,q,Q){var W,Z,ee=Q._basePlotModules||[];for(W=0;W<ee.length;W++){var te=ee[W];te.clean&&te.clean(N,U,q,Q)}var ae=Q._has&&Q._has("gl"),le=U._has&&U._has("gl");ae&&!le&&Q._glcontainer!==void 0&&(Q._glcontainer.selectAll(".gl-canvas").remove(),Q._glcontainer.selectAll(".no-webgl").remove(),Q._glcanvas=null);var ye=!!Q._infolayer;e:for(W=0;W<q.length;W++){var fe=q[W],pe=fe.uid;for(Z=0;Z<N.length;Z++){var ge=N[Z];if(pe===ge.uid)continue e}ye&&Q._infolayer.select(".cb"+pe).remove()}},u.linkSubplots=function(N,U,q,Q){var W,Z,ee=Q._plots||{},te=U._plots={},ae=U._subplots,le={_fullData:N,_fullLayout:U},ye=ae.cartesian.concat(ae.gl2d||[]);for(W=0;W<ye.length;W++){var fe=ye[W],pe=ee[fe],ge=o.getFromId(le,fe,"x"),Ae=o.getFromId(le,fe,"y"),we;for(pe?we=te[fe]=pe:(we=te[fe]={},we.id=fe),ge._counterAxes.push(Ae._id),Ae._counterAxes.push(ge._id),ge._subplotsWith.push(fe),Ae._subplotsWith.push(fe),we.xaxis=ge,we.yaxis=Ae,we._hasClipOnAxisFalse=!1,Z=0;Z<N.length;Z++){var De=N[Z];if(De.xaxis===we.xaxis._id&&De.yaxis===we.yaxis._id&&De.cliponaxis===!1){we._hasClipOnAxisFalse=!0;break}}}var Be=o.list(le,null,!0),Ve;for(W=0;W<Be.length;W++){Ve=Be[W];var xe=null;Ve.overlaying&&(xe=o.getFromId(le,Ve.overlaying),xe&&xe.overlaying&&(Ve.overlaying=!1,xe=null)),Ve._mainAxis=xe||Ve,xe&&(Ve.domain=xe.domain.slice()),Ve._anchorAxis=Ve.anchor==="free"?null:o.getFromId(le,Ve.anchor)}for(W=0;W<Be.length;W++)if(Ve=Be[W],Ve._counterAxes.sort(o.idSort),Ve._subplotsWith.sort(r.subplotSort),Ve._mainSubplot=P(Ve,U),Ve._counterAxes.length&&(Ve.spikemode&&Ve.spikemode.indexOf("across")!==-1||Ve.automargin&&Ve.mirror&&Ve.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(Ve))){var Le=1,He=0;for(Z=0;Z<Ve._counterAxes.length;Z++){var Je=o.getFromId(le,Ve._counterAxes[Z]);Le=Math.min(Le,Je.domain[0]),He=Math.max(He,Je.domain[1])}Le<He&&(Ve._counterDomainMin=Le,Ve._counterDomainMax=He)}};function P(N,U){var q={_fullLayout:U},Q=N._id.charAt(0)==="x",W=N._mainAxis._anchorAxis,Z="",ee="",te="";if(W&&(te=W._mainAxis._id,Z=Q?N._id+te:te+N._id),!Z||!U._plots[Z]){Z="";for(var ae=N._counterAxes,le=0;le<ae.length;le++){var ye=ae[le],fe=Q?N._id+ye:ye+N._id;ee||(ee=fe);var pe=o.getFromId(q,ye);if(te&&pe.overlaying===te){Z=fe;break}}}return Z||ee}u.clearExpandedTraceDefaultColors=function(N){var U,q,Q;function W(ee,te,ae,le){q[le]=te,q.length=le+1,ee.valType==="color"&&ee.dflt===void 0&&U.push(q.join("."))}for(q=[],U=N._module._colorAttrs,U||(N._module._colorAttrs=U=[],a.crawl(N._module.attributes,W)),Q=0;Q<U.length;Q++){var Z=r.nestedProperty(N,"_input."+U[Q]);Z.get()||r.nestedProperty(N,U[Q]).set(null)}},u.supplyDataDefaults=function(N,U,q,Q){var W=Q._modules,Z=Q._visibleModules,ee=Q._basePlotModules,te=0,ae=0,le,ye,fe;Q._transformModules=[];function pe(Oe){U.push(Oe);var Pe=Oe._module;!Pe||(r.pushUnique(W,Pe),Oe.visible===!0&&r.pushUnique(Z,Pe),r.pushUnique(ee,Oe._module.basePlotModule),te++,Oe._input.visible!==!1&&ae++)}var ge={},Ae=[],we=(q.template||{}).data||{},De=n.traceTemplater(we);for(le=0;le<N.length;le++){if(fe=N[le],ye=De.newTrace(fe),ye.uid=Q._traceUids[le],u.supplyTraceDefaults(fe,ye,ae,Q,le),ye.index=le,ye._input=fe,ye._expandedIndex=te,ye.transforms&&ye.transforms.length)for(var Be=fe.visible!==!1&&ye.visible===!1,Ve=I(ye,U,q,Q),xe=0;xe<Ve.length;xe++){var Le=Ve[xe],He={_template:ye._template,type:ye.type,uid:ye.uid+xe};Be&&Le.visible===!1&&delete Le.visible,u.supplyTraceDefaults(Le,He,te,Q,le),h(He,Le),He.index=le,He._input=fe,He._fullInput=ye,He._expandedIndex=te,He._expandedInput=Le,pe(He)}else ye._fullInput=ye,ye._expandedInput=ye,pe(ye);e.traceIs(ye,"carpetAxis")&&(ge[ye.carpet]=ye),e.traceIs(ye,"carpetDependent")&&Ae.push(le)}for(le=0;le<Ae.length;le++)if(ye=U[Ae[le]],!!ye.visible){var Je=ge[ye.carpet];if(ye._carpet=Je,!Je||!Je.visible){ye.visible=!1;continue}ye.xaxis=Je.xaxis,ye.yaxis=Je.yaxis}},u.supplyAnimationDefaults=function(N){N=N||{};var U,q={};function Q(W,Z){return r.coerce(N||{},q,g,W,Z)}if(Q("mode"),Q("direction"),Q("fromcurrent"),Array.isArray(N.frame))for(q.frame=[],U=0;U<N.frame.length;U++)q.frame[U]=u.supplyAnimationFrameDefaults(N.frame[U]||{});else q.frame=u.supplyAnimationFrameDefaults(N.frame||{});if(Array.isArray(N.transition))for(q.transition=[],U=0;U<N.transition.length;U++)q.transition[U]=u.supplyAnimationTransitionDefaults(N.transition[U]||{});else q.transition=u.supplyAnimationTransitionDefaults(N.transition||{});return q},u.supplyAnimationFrameDefaults=function(N){var U={};function q(Q,W){return r.coerce(N||{},U,g.frame,Q,W)}return q("duration"),q("redraw"),U},u.supplyAnimationTransitionDefaults=function(N){var U={};function q(Q,W){return r.coerce(N||{},U,g.transition,Q,W)}return q("duration"),q("easing"),U},u.supplyFrameDefaults=function(N){var U={};function q(Q,W){return r.coerce(N,U,p,Q,W)}return q("group"),q("name"),q("traces"),q("baseframe"),q("data"),q("layout"),U},u.supplyTraceDefaults=function(N,U,q,Q,W){var Z=Q.colorway||t.defaults,ee=Z[q%Z.length],te;function ae(Ve,xe){return r.coerce(N,U,u.attributes,Ve,xe)}var le=ae("visible");ae("type"),ae("name",Q._traceWord+" "+W),ae("uirevision",Q.uirevision);var ye=u.getModule(U);if(U._module=ye,ye){var fe=ye.basePlotModule,pe=fe.attr,ge=fe.attributes;if(pe&&ge){var Ae=Q._subplots,we="";if(le||fe.name!=="gl2d"){if(Array.isArray(pe))for(te=0;te<pe.length;te++){var De=pe[te],Be=r.coerce(N,U,ge,De);Ae[De]&&r.pushUnique(Ae[De],Be),we+=Be}else we=r.coerce(N,U,ge,pe);Ae[fe.name]&&r.pushUnique(Ae[fe.name],we)}}}return le&&(ae("customdata"),ae("ids"),ae("meta"),e.traceIs(U,"showLegend")?(r.coerce(N,U,ye.attributes.showlegend?ye.attributes:u.attributes,"showlegend"),ae("legendgroup"),ae("legendgrouptitle.text"),ae("legendrank"),U._dfltShowLegend=!0):U._dfltShowLegend=!1,ye&&ye.supplyDefaults(N,U,ee,Q),e.traceIs(U,"noOpacity")||ae("opacity"),e.traceIs(U,"notLegendIsolatable")&&(U.visible=!!U.visible),e.traceIs(U,"noHover")||(U.hovertemplate||r.coerceHoverinfo(N,U,Q),U.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(N,U,ee,Q)),ye&&ye.selectPoints&&ae("selectedpoints"),u.supplyTransformDefaults(N,U,Q)),U};function z(N){var U=N.transforms;if(Array.isArray(U)&&U.length)for(var q=0;q<U.length;q++){var Q=U[q],W=Q._module||_[Q.type];if(W&&W.makesData)return!0}return!1}u.hasMakesDataTransform=z,u.supplyTransformDefaults=function(N,U,q){if(!!(U._length||z(N))){var Q=q._globalTransforms||[],W=q._transformModules||[];if(!(!Array.isArray(N.transforms)&&Q.length===0))for(var Z=N.transforms||[],ee=Q.concat(Z),te=U.transforms=[],ae=0;ae<ee.length;ae++){var le=ee[ae],ye=le.type,fe=_[ye],pe,ge=!(le._module&&le._module===fe),Ae=fe&&typeof fe.transform=="function";fe||r.warn("Unrecognized transform type "+ye+"."),fe&&fe.supplyDefaults&&(ge||Ae)?(pe=fe.supplyDefaults(le,U,q,N),pe.type=ye,pe._module=fe,r.pushUnique(W,fe)):pe=r.extendFlat({},le),te.push(pe)}}};function I(N,U,q,Q){for(var W=N.transforms,Z=[N],ee=0;ee<W.length;ee++){var te=W[ee],ae=_[te.type];ae&&ae.transform&&(Z=ae.transform(Z,{transform:te,fullTrace:N,fullData:U,layout:q,fullLayout:Q,transformIndex:ee}))}return Z}u.supplyLayoutGlobalDefaults=function(N,U,q){function Q(le,ye){return r.coerce(N,U,u.layoutAttributes,le,ye)}var W=N.template;r.isPlainObject(W)&&(U.template=W,U._template=W.layout,U._dataTemplate=W.data),Q("autotypenumbers");var Z=r.coerceFont(Q,"font"),ee=Z.size;r.coerceFont(Q,"title.font",r.extendFlat({},Z,{size:Math.round(ee*1.4)})),Q("title.text",U._dfltTitle.plot),Q("title.xref"),Q("title.yref"),Q("title.x"),Q("title.y"),Q("title.xanchor"),Q("title.yanchor"),Q("title.pad.t"),Q("title.pad.r"),Q("title.pad.b"),Q("title.pad.l");var te=Q("uniformtext.mode");te&&Q("uniformtext.minsize"),Q("autosize",!(N.width&&N.height)),Q("width"),Q("height"),Q("margin.l"),Q("margin.r"),Q("margin.t"),Q("margin.b"),Q("margin.pad"),Q("margin.autoexpand"),N.width&&N.height&&u.sanitizeMargins(U),e.getComponentMethod("grid","sizeDefaults")(N,U),Q("paper_bgcolor"),Q("separators",q.decimal+q.thousands),Q("hidesources"),Q("colorway"),Q("datarevision");var ae=Q("uirevision");Q("editrevision",ae),Q("selectionrevision",ae),e.getComponentMethod("modebar","supplyLayoutDefaults")(N,U),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(N,U,Q),Q("meta"),r.isPlainObject(N.transition)&&(Q("transition.duration"),Q("transition.easing"),Q("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(N,U,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(N,U,Q)};function D(N){return typeof N=="string"&&N.substr(N.length-2)==="px"&&parseFloat(N)}u.plotAutoSize=function(U,q,Q){var W=U._context||{},Z=W.frameMargins,ee,te,ae=r.isPlotDiv(U);if(ae&&U.emit("plotly_autosize"),W.fillFrame)ee=window.innerWidth,te=window.innerHeight,document.body.style.overflow="hidden";else{var le=ae?window.getComputedStyle(U):{};if(ee=D(le.width)||D(le.maxWidth)||Q.width,te=D(le.height)||D(le.maxHeight)||Q.height,T(Z)&&Z>0){var ye=1-2*Z;ee=Math.round(ye*ee),te=Math.round(ye*te)}}var fe=u.layoutAttributes.width.min,pe=u.layoutAttributes.height.min;ee<fe&&(ee=fe),te<pe&&(te=pe);var ge=!q.width&&Math.abs(Q.width-ee)>1,Ae=!q.height&&Math.abs(Q.height-te)>1;(Ae||ge)&&(ge&&(Q.width=ee),Ae&&(Q.height=te)),U._initialAutoSize||(U._initialAutoSize={width:ee,height:te}),u.sanitizeMargins(Q)},u.supplyLayoutModuleDefaults=function(N,U,q,Q){var W=e.componentsRegistry,Z=U._basePlotModules,ee,te,ae,le=e.subplotsRegistry.cartesian;for(ee in W)ae=W[ee],ae.includeBasePlot&&ae.includeBasePlot(N,U);Z.length||Z.push(le),U._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(N,U),le.finalizeSubplots(N,U));for(var ye in U._subplots)U._subplots[ye].sort(r.subplotSort);for(te=0;te<Z.length;te++)ae=Z[te],ae.supplyLayoutDefaults&&ae.supplyLayoutDefaults(N,U,q);var fe=U._modules;for(te=0;te<fe.length;te++)ae=fe[te],ae.supplyLayoutDefaults&&ae.supplyLayoutDefaults(N,U,q);var pe=U._transformModules;for(te=0;te<pe.length;te++)ae=pe[te],ae.supplyLayoutDefaults&&ae.supplyLayoutDefaults(N,U,q,Q);for(ee in W)ae=W[ee],ae.supplyLayoutDefaults&&ae.supplyLayoutDefaults(N,U,q)},u.purge=function(N){var U=N._fullLayout||{};U._glcontainer!==void 0&&(U._glcontainer.selectAll(".gl-canvas").remove(),U._glcontainer.remove(),U._glcanvas=null),U._modeBar&&U._modeBar.destroy(),N._transitionData&&(N._transitionData._interruptCallbacks&&(N._transitionData._interruptCallbacks.length=0),N._transitionData._animationRaf&&window.cancelAnimationFrame(N._transitionData._animationRaf)),r.clearThrottle(),r.clearResponsive(N),delete N.data,delete N.layout,delete N._fullData,delete N._fullLayout,delete N.calcdata,delete N.empty,delete N.fid,delete N.undoqueue,delete N.undonum,delete N.autoplay,delete N.changed,delete N._promises,delete N._redrawTimer,delete N._hmlumcount,delete N._hmpixcount,delete N._transitionData,delete N._transitioning,delete N._initialAutoSize,delete N._transitioningWithDuration,delete N._dragging,delete N._dragged,delete N._dragdata,delete N._hoverdata,delete N._snapshotInProgress,delete N._editing,delete N._mouseDownTime,delete N._legendMouseDownTime,N.removeAllListeners&&N.removeAllListeners()},u.style=function(N){var U=N._fullLayout._visibleModules,q=[],Q;for(Q=0;Q<U.length;Q++){var W=U[Q];W.style&&r.pushUnique(q,W.style)}for(Q=0;Q<q.length;Q++)q[Q](N)},u.sanitizeMargins=function(N){if(!(!N||!N.margin)){var U=N.width,q=N.height,Q=N.margin,W=U-(Q.l+Q.r),Z=q-(Q.t+Q.b),ee;W<0&&(ee=(U-1)/(Q.l+Q.r),Q.l=Math.floor(ee*Q.l),Q.r=Math.floor(ee*Q.r)),Z<0&&(ee=(q-1)/(Q.t+Q.b),Q.t=Math.floor(ee*Q.t),Q.b=Math.floor(ee*Q.b))}},u.clearAutoMarginIds=function(N){N._fullLayout._pushmarginIds={}},u.allowAutoMargin=function(N,U){N._fullLayout._pushmarginIds[U]=1};function R(N){var U=N.margin;if(!N._size){var q=N._size={l:Math.round(U.l),r:Math.round(U.r),t:Math.round(U.t),b:Math.round(U.b),p:Math.round(U.pad)};q.w=Math.round(N.width)-q.l-q.r,q.h=Math.round(N.height)-q.t-q.b}N._pushmargin||(N._pushmargin={}),N._pushmarginIds||(N._pushmarginIds={})}var B=2,F=2,V=64,G=64;u.autoMargin=function(N,U,q){var Q=N._fullLayout,W=Q.width,Z=Q.height,ee=Q.margin,te=r.constrain(W-ee.l-ee.r,B,V),ae=r.constrain(Z-ee.t-ee.b,F,G),le=Math.max(0,W-te),ye=Math.max(0,Z-ae),fe=Q._pushmargin,pe=Q._pushmarginIds;if(ee.autoexpand!==!1){if(!q)delete fe[U],delete pe[U];else{var ge=q.pad;if(ge===void 0&&(ge=Math.min(12,ee.l,ee.r,ee.t,ee.b)),le){var Ae=(q.l+q.r)/le;Ae>1&&(q.l/=Ae,q.r/=Ae)}if(ye){var we=(q.t+q.b)/ye;we>1&&(q.t/=we,q.b/=we)}var De=q.xl!==void 0?q.xl:q.x,Be=q.xr!==void 0?q.xr:q.x,Ve=q.yt!==void 0?q.yt:q.y,xe=q.yb!==void 0?q.yb:q.y;fe[U]={l:{val:De,size:q.l+ge},r:{val:Be,size:q.r+ge},b:{val:xe,size:q.b+ge},t:{val:Ve,size:q.t+ge}},pe[U]=1}if(!Q._replotting)return u.doAutoMargin(N)}},u.doAutoMargin=function(N){var U=N._fullLayout,q=U.width,Q=U.height;U._size||(U._size={}),R(U);var W=U._size,Z=U.margin,ee=r.extendFlat({},W),te=Z.l,ae=Z.r,le=Z.t,ye=Z.b,fe=U._pushmargin,pe=U._pushmarginIds;if(U.margin.autoexpand!==!1){for(var ge in fe)pe[ge]||delete fe[ge];fe.base={l:{val:0,size:te},r:{val:1,size:ae},t:{val:1,size:le},b:{val:0,size:ye}};for(var Ae in fe){var we=fe[Ae].l||{},De=fe[Ae].b||{},Be=we.val,Ve=we.size,xe=De.val,Le=De.size;for(var He in fe){if(T(Ve)&&fe[He].r){var Je=fe[He].r.val,Oe=fe[He].r.size;if(Je>Be){var Pe=(Ve*Je+(Oe-q)*Be)/(Je-Be),Ue=(Oe*(1-Be)+(Ve-q)*(1-Je))/(Je-Be);Pe+Ue>te+ae&&(te=Pe,ae=Ue)}}if(T(Le)&&fe[He].t){var vt=fe[He].t.val,Lt=fe[He].t.size;if(vt>xe){var Yt=(Le*vt+(Lt-Q)*xe)/(vt-xe),At=(Lt*(1-xe)+(Le-Q)*(1-vt))/(vt-xe);Yt+At>ye+le&&(ye=Yt,le=At)}}}}}var Rt=r.constrain(q-Z.l-Z.r,B,V),Bt=r.constrain(Q-Z.t-Z.b,F,G),Mt=Math.max(0,q-Rt),Tt=Math.max(0,Q-Bt);if(Mt){var at=(te+ae)/Mt;at>1&&(te/=at,ae/=at)}if(Tt){var ct=(ye+le)/Tt;ct>1&&(ye/=ct,le/=ct)}if(W.l=Math.round(te),W.r=Math.round(ae),W.t=Math.round(le),W.b=Math.round(ye),W.p=Math.round(Z.pad),W.w=Math.round(q)-W.l-W.r,W.h=Math.round(Q)-W.t-W.b,!U._replotting&&u.didMarginChange(ee,W)){"_redrawFromAutoMarginCount"in U?U._redrawFromAutoMarginCount++:U._redrawFromAutoMarginCount=1;var je=3*(1+Object.keys(pe).length);if(U._redrawFromAutoMarginCount<je)return e.call("_doPlot",N);U._size=ee,r.warn("Too many auto-margin redraws.")}J(N)};function J(N){var U=o.list(N,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(q){for(var Q=0;Q<U.length;Q++){var W=U[Q][q];W&&W()}})}var j=["l","r","t","b","p","w","h"];u.didMarginChange=function(N,U){for(var q=0;q<j.length;q++){var Q=j[q],W=N[Q],Z=U[Q];if(!T(W)||Math.abs(Z-W)>1)return!0}return!1},u.graphJson=function(N,U,q,Q,W,Z){(W&&U&&!N._fullData||W&&!U&&!N._fullLayout)&&u.supplyDefaults(N);var ee=W?N._fullData:N.data,te=W?N._fullLayout:N.layout,ae=(N._transitionData||{})._frames;function le(pe,ge){if(typeof pe=="function")return ge?"_function_":null;if(r.isPlainObject(pe)){var Ae={},we;return Object.keys(pe).sort().forEach(function(De){if(["_","["].indexOf(De.charAt(0))===-1){if(typeof pe[De]=="function"){ge&&(Ae[De]="_function");return}if(q==="keepdata"){if(De.substr(De.length-3)==="src")return}else if(q==="keepstream"){if(we=pe[De+"src"],typeof we=="string"&&we.indexOf(":")>0&&!r.isPlainObject(pe.stream))return}else if(q!=="keepall"&&(we=pe[De+"src"],typeof we=="string"&&we.indexOf(":")>0))return;Ae[De]=le(pe[De],ge)}}),Ae}return Array.isArray(pe)?pe.map(function(De){return le(De,ge)}):r.isTypedArray(pe)?r.simpleMap(pe,r.identity):r.isJSDate(pe)?r.ms2DateTimeLocal(+pe):pe}var ye={data:(ee||[]).map(function(pe){var ge=le(pe);return U&&delete ge.fit,ge})};if(!U&&(ye.layout=le(te),W)){var fe=te._size;ye.layout.computed={margin:{b:fe.b,l:fe.l,r:fe.r,t:fe.t}}}return ae&&(ye.frames=le(ae)),Z&&(ye.config=le(N._context,!0)),Q==="object"?ye:JSON.stringify(ye)},u.modifyFrames=function(N,U){var q,Q,W,Z=N._transitionData._frames,ee=N._transitionData._frameHash;for(q=0;q<U.length;q++)switch(Q=U[q],Q.type){case"replace":W=Q.value;var te=(Z[Q.index]||{}).name,ae=W.name;Z[Q.index]=ee[ae]=W,ae!==te&&(delete ee[te],ee[ae]=W);break;case"insert":W=Q.value,ee[W.name]=W,Z.splice(Q.index,0,W);break;case"delete":W=Z[Q.index],delete ee[W.name],Z.splice(Q.index,1);break}return Promise.resolve()},u.computeFrame=function(N,U){var q=N._transitionData._frameHash,Q,W,Z,ee;if(!U)throw new Error("computeFrame must be given a string frame name");var te=q[U.toString()];if(!te)return!1;for(var ae=[te],le=[te.name];te.baseframe&&(te=q[te.baseframe.toString()])&&le.indexOf(te.name)===-1;)ae.push(te),le.push(te.name);for(var ye={};te=ae.pop();)if(te.layout&&(ye.layout=u.extendLayout(ye.layout,te.layout)),te.data){if(ye.data||(ye.data=[]),W=te.traces,!W)for(W=[],Q=0;Q<te.data.length;Q++)W[Q]=Q;for(ye.traces||(ye.traces=[]),Q=0;Q<te.data.length;Q++)Z=W[Q],Z!=null&&(ee=ye.traces.indexOf(Z),ee===-1&&(ee=ye.data.length,ye.traces[ee]=Z),ye.data[ee]=u.extendTrace(ye.data[ee],te.data[Q]))}return ye},u.recomputeFrameHash=function(N){for(var U=N._transitionData._frameHash={},q=N._transitionData._frames,Q=0;Q<q.length;Q++){var W=q[Q];W&&W.name&&(U[W.name]=W)}},u.extendObjectWithContainers=function(N,U,q){var Q,W,Z,ee,te,ae,le,ye,fe=r.extendDeepNoArrays({},U||{}),pe=r.expandObjectPaths(fe),ge={};if(q&&q.length)for(Z=0;Z<q.length;Z++)Q=r.nestedProperty(pe,q[Z]),W=Q.get(),W===void 0?r.nestedProperty(ge,q[Z]).set(null):(Q.set(null),r.nestedProperty(ge,q[Z]).set(W));if(N=r.extendDeepNoArrays(N||{},pe),q&&q.length){for(Z=0;Z<q.length;Z++)if(te=r.nestedProperty(ge,q[Z]),le=te.get(),!!le){for(ae=r.nestedProperty(N,q[Z]),ye=ae.get(),Array.isArray(ye)||(ye=[],ae.set(ye)),ee=0;ee<le.length;ee++){var Ae=le[ee];Ae===null?ye[ee]=null:ye[ee]=u.extendObjectWithContainers(ye[ee],Ae)}ae.set(ye)}}return N},u.dataArrayContainers=["transforms","dimensions"],u.layoutArrayContainers=e.layoutArrayContainers,u.extendTrace=function(N,U){return u.extendObjectWithContainers(N,U,u.dataArrayContainers)},u.extendLayout=function(N,U){return u.extendObjectWithContainers(N,U,u.layoutArrayContainers)},u.transition=function(N,U,q,Q,W,Z){var ee={redraw:W.redraw},te={},ae=[];return ee.prepareFn=function(){for(var le=Array.isArray(U)?U.length:0,ye=Q.slice(0,le),fe=0;fe<ye.length;fe++){var pe=ye[fe],ge=N._fullData[pe],Ae=ge._module;if(!!Ae){if(Ae.animatable){var we=Ae.basePlotModule.name;te[we]||(te[we]=[]),te[we].push(pe)}N.data[ye[fe]]=u.extendTrace(N.data[ye[fe]],U[fe])}}var De=r.expandObjectPaths(r.extendDeepNoArrays({},q)),Be=/^[xy]axis[0-9]*$/;for(var Ve in De)!Be.test(Ve)||delete De[Ve].range;u.extendLayout(N.layout,De),delete N.calcdata,u.supplyDefaults(N),u.doCalcdata(N);var xe=r.expandObjectPaths(q);if(xe){var Le=N._fullLayout._plots;for(var He in Le){var Je=Le[He],Oe=Je.xaxis,Pe=Je.yaxis,Ue=Oe.range.slice(),vt=Pe.range.slice(),Lt=null,Yt=null,At=null,Rt=null;Array.isArray(xe[Oe._name+".range"])?Lt=xe[Oe._name+".range"].slice():Array.isArray((xe[Oe._name]||{}).range)&&(Lt=xe[Oe._name].range.slice()),Array.isArray(xe[Pe._name+".range"])?Yt=xe[Pe._name+".range"].slice():Array.isArray((xe[Pe._name]||{}).range)&&(Yt=xe[Pe._name].range.slice()),Ue&&Lt&&(Oe.r2l(Ue[0])!==Oe.r2l(Lt[0])||Oe.r2l(Ue[1])!==Oe.r2l(Lt[1]))&&(At={xr0:Ue,xr1:Lt}),vt&&Yt&&(Pe.r2l(vt[0])!==Pe.r2l(Yt[0])||Pe.r2l(vt[1])!==Pe.r2l(Yt[1]))&&(Rt={yr0:vt,yr1:Yt}),(At||Rt)&&ae.push(r.extendFlat({plotinfo:Je},At,Rt))}}return Promise.resolve()},ee.runFn=function(le){var ye,fe=N._fullLayout._basePlotModules,pe=ae.length,ge;if(q)for(ge=0;ge<fe.length;ge++)fe[ge].transitionAxes&&fe[ge].transitionAxes(N,ae,Z,le);pe?(ye=r.extendFlat({},Z),ye.duration=0,delete te.cartesian):ye=Z;for(var Ae in te){var we=te[Ae],De=N._fullData[we[0]]._module;De.basePlotModule.plot(N,we,ye,le)}},Y(N,Z,ee)},u.transitionFromReact=function(N,U,q,Q){var W=N._fullLayout,Z=W.transition,ee={},te=[];return ee.prepareFn=function(){var ae=W._plots;ee.redraw=!1,U.anim==="some"&&(ee.redraw=!0),q.anim==="some"&&(ee.redraw=!0);for(var le in ae){var ye=ae[le],fe=ye.xaxis,pe=ye.yaxis,ge=Q[fe._name].range.slice(),Ae=Q[pe._name].range.slice(),we=fe.range.slice(),De=pe.range.slice();fe.setScale(),pe.setScale();var Be=null,Ve=null;(fe.r2l(ge[0])!==fe.r2l(we[0])||fe.r2l(ge[1])!==fe.r2l(we[1]))&&(Be={xr0:ge,xr1:we}),(pe.r2l(Ae[0])!==pe.r2l(De[0])||pe.r2l(Ae[1])!==pe.r2l(De[1]))&&(Ve={yr0:Ae,yr1:De}),(Be||Ve)&&te.push(r.extendFlat({plotinfo:ye},Be,Ve))}return Promise.resolve()},ee.runFn=function(ae){for(var le=N._fullData,ye=N._fullLayout,fe=ye._basePlotModules,pe,ge,Ae,we=[],De=0;De<le.length;De++)we.push(De);function Be(){if(!!N._fullLayout)for(var xe=0;xe<fe.length;xe++)fe[xe].transitionAxes&&fe[xe].transitionAxes(N,te,pe,ae)}function Ve(){if(!!N._fullLayout)for(var xe=0;xe<fe.length;xe++)fe[xe].plot(N,Ae,ge,ae)}te.length&&U.anim?Z.ordering==="traces first"?(pe=r.extendFlat({},Z,{duration:0}),Ae=we,ge=Z,setTimeout(Be,Z.duration),Ve()):(pe=Z,Ae=null,ge=r.extendFlat({},Z,{duration:0}),setTimeout(Ve,pe.duration),Be()):te.length?(pe=Z,Be()):U.anim&&(Ae=we,ge=Z,Ve())},Y(N,Z,ee)};function Y(N,U,q){var Q=!1;function W(fe){var pe=Promise.resolve();if(!fe)return pe;for(;fe.length;)pe=pe.then(fe.shift());return pe}function Z(fe){if(!!fe)for(;fe.length;)fe.shift()}function ee(){return N.emit("plotly_transitioning",[]),new Promise(function(fe){N._transitioning=!0,U.duration>0&&(N._transitioningWithDuration=!0),N._transitionData._interruptCallbacks.push(function(){Q=!0}),q.redraw&&N._transitionData._interruptCallbacks.push(function(){return e.call("redraw",N)}),N._transitionData._interruptCallbacks.push(function(){N.emit("plotly_transitioninterrupted",[])});var pe=0,ge=0;function Ae(){return pe++,function(){ge++,!Q&&ge===pe&&te(fe)}}q.runFn(Ae),setTimeout(Ae())})}function te(fe){if(!!N._transitionData)return Z(N._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(q.redraw)return e.call("redraw",N)}).then(function(){N._transitioning=!1,N._transitioningWithDuration=!1,N.emit("plotly_transitioned",[])}).then(fe)}function ae(){if(!!N._transitionData)return N._transitioning=!1,W(N._transitionData._interruptCallbacks)}var le=[u.previousPromises,ae,q.prepareFn,u.rehover,ee],ye=r.syncOrAsync(le,N);return(!ye||!ye.then)&&(ye=Promise.resolve()),ye.then(function(){return N})}u.doCalcdata=function(N,U){var q=o.list(N),Q=N._fullData,W=N._fullLayout,Z,ee,te,ae,le=new Array(Q.length),ye=(N.calcdata||[]).slice();for(N.calcdata=le,W._numBoxes=0,W._numViolins=0,W._violinScaleGroupStats={},N._hmpixcount=0,N._hmlumcount=0,W._piecolormap={},W._sunburstcolormap={},W._treemapcolormap={},W._iciclecolormap={},W._funnelareacolormap={},te=0;te<Q.length;te++)if(Array.isArray(U)&&U.indexOf(te)===-1){le[te]=ye[te];continue}for(te=0;te<Q.length;te++)Z=Q[te],Z._arrayAttrs=a.findArrayAttributes(Z),Z._extremes={};var fe=W._subplots.polar||[];for(te=0;te<fe.length;te++)q.push(W[fe[te]].radialaxis,W[fe[te]].angularaxis);for(var pe in W._colorAxes){var ge=W[pe];ge.cauto!==!1&&(delete ge.cmin,delete ge.cmax)}var Ae=!1;function we(Ve){if(Z=Q[Ve],ee=Z._module,Z.visible===!0&&Z.transforms){if(ee&&ee.calc){var xe=ee.calc(N,Z);xe[0]&&xe[0].t&&xe[0].t._scene&&delete xe[0].t._scene.dirty}for(ae=0;ae<Z.transforms.length;ae++){var Le=Z.transforms[ae];ee=_[Le.type],ee&&ee.calcTransform&&(Z._hasCalcTransform=!0,Ae=!0,ee.calcTransform(N,Z,Le))}}}function De(Ve,xe){if(Z=Q[Ve],ee=Z._module,!!ee.isContainer===xe){var Le=[];if(Z.visible===!0&&Z._length!==0){delete Z._indexToPoints;var He=Z.transforms||[];for(ae=He.length-1;ae>=0;ae--)if(He[ae].enabled){Z._indexToPoints=He[ae]._indexToPoints;break}ee&&ee.calc&&(Le=ee.calc(N,Z))}(!Array.isArray(Le)||!Le[0])&&(Le=[{x:f,y:f}]),Le[0].t||(Le[0].t={}),Le[0].trace=Z,le[Ve]=Le}}for(se(q,Q,W),te=0;te<Q.length;te++)De(te,!0);for(te=0;te<Q.length;te++)we(te);for(Ae&&se(q,Q,W),te=0;te<Q.length;te++)De(te,!0);for(te=0;te<Q.length;te++)De(te,!1);ie(N);var Be=oe(q,N);if(Be.length){for(W._numBoxes=0,W._numViolins=0,te=0;te<Be.length;te++)De(Be[te],!0);for(te=0;te<Be.length;te++)De(Be[te],!1);ie(N)}e.getComponentMethod("fx","calc")(N),e.getComponentMethod("errorbars","calc")(N)};var X=/(total|sum|min|max|mean|median) (ascending|descending)/;function oe(N,U){var q=[],Q,W,Z,ee,te;function ae(Mt,Tt,at){var ct=Tt._id.charAt(0);if(Mt==="histogram2dcontour"){var je=Tt._counterAxes[0],ke=o.getFromId(U,je),Ye=ct==="x"||je==="x"&&ke.type==="category",Ke=ct==="y"||je==="y"&&ke.type==="category";return function(st,Et){return st===0||Et===0||Ye&&st===at[Et].length-1||Ke&&Et===at.length-1?-1:(ct==="y"?Et:st)-1}}else return function(st,Et){return ct==="y"?Et:st}}var le={min:function(Mt){return r.aggNums(Math.min,null,Mt)},max:function(Mt){return r.aggNums(Math.max,null,Mt)},sum:function(Mt){return r.aggNums(function(Tt,at){return Tt+at},null,Mt)},total:function(Mt){return r.aggNums(function(Tt,at){return Tt+at},null,Mt)},mean:function(Mt){return r.mean(Mt)},median:function(Mt){return r.median(Mt)}};for(Q=0;Q<N.length;Q++){var ye=N[Q];if(ye.type==="category"){var fe=ye.categoryorder.match(X);if(fe){var pe=fe[1],ge=fe[2],Ae=ye._id.charAt(0),we=Ae==="x",De=[];for(W=0;W<ye._categories.length;W++)De.push([ye._categories[W],[]]);for(W=0;W<ye._traceIndices.length;W++){var Be=ye._traceIndices[W],Ve=U._fullData[Be];if(Ve.visible===!0){var xe=Ve.type;e.traceIs(Ve,"histogram")&&(delete Ve._xautoBinFinished,delete Ve._yautoBinFinished);var Le=xe==="splom",He=xe==="scattergl",Je=U.calcdata[Be];for(Z=0;Z<Je.length;Z++){var Oe=Je[Z],Pe,Ue;if(Le){var vt=Ve._axesDim[ye._id];if(!we){var Lt=Ve._diag[vt][0];Lt&&(ye=U._fullLayout[o.id2name(Lt)])}var Yt=Oe.trace.dimensions[vt].values;for(ee=0;ee<Yt.length;ee++)for(Pe=ye._categoriesMap[Yt[ee]],te=0;te<Oe.trace.dimensions.length;te++)if(te!==vt){var At=Oe.trace.dimensions[te];De[Pe][1].push(At.values[ee])}}else if(He){for(ee=0;ee<Oe.t.x.length;ee++)we?(Pe=Oe.t.x[ee],Ue=Oe.t.y[ee]):(Pe=Oe.t.y[ee],Ue=Oe.t.x[ee]),De[Pe][1].push(Ue);Oe.t&&Oe.t._scene&&delete Oe.t._scene.dirty}else if(Oe.hasOwnProperty("z")){Ue=Oe.z;var Rt=ae(Ve.type,ye,Ue);for(ee=0;ee<Ue.length;ee++)for(te=0;te<Ue[ee].length;te++)Pe=Rt(te,ee),Pe+1&&De[Pe][1].push(Ue[ee][te])}else for(Pe=Oe.p,Pe===void 0&&(Pe=Oe[Ae]),Ue=Oe.s,Ue===void 0&&(Ue=Oe.v),Ue===void 0&&(Ue=we?Oe.y:Oe.x),Array.isArray(Ue)||(Ue===void 0?Ue=[]:Ue=[Ue]),ee=0;ee<Ue.length;ee++)De[Pe][1].push(Ue[ee])}}}ye._categoriesValue=De;var Bt=[];for(W=0;W<De.length;W++)Bt.push([De[W][0],le[pe](De[W][1])]);Bt.sort(function(Mt,Tt){return Mt[1]-Tt[1]}),ye._categoriesAggregatedValue=Bt,ye._initialCategories=Bt.map(function(Mt){return Mt[0]}),ge==="descending"&&ye._initialCategories.reverse(),q=q.concat(ye.sortByInitialCategories())}}}return q}function se(N,U,q){var Q={};function W(ae){ae.clearCalc(),ae.type==="multicategory"&&ae.setupMultiCategory(U),Q[ae._id]=1}r.simpleMap(N,W);for(var Z=q._axisMatchGroups||[],ee=0;ee<Z.length;ee++)for(var te in Z[ee])Q[te]||W(q[o.id2name(te)])}function ie(N){var U=N._fullLayout,q=U._visibleModules,Q={},W,Z,ee;for(Z=0;Z<q.length;Z++){var te=q[Z],ae=te.crossTraceCalc;if(ae){var le=te.basePlotModule.name;Q[le]?r.pushUnique(Q[le],ae):Q[le]=[ae]}}for(ee in Q){var ye=Q[ee],fe=U._subplots[ee];if(Array.isArray(fe))for(W=0;W<fe.length;W++){var pe=fe[W],ge=ee==="cartesian"?U._plots[pe]:U[pe];for(Z=0;Z<ye.length;Z++)ye[Z](N,ge,pe)}else for(Z=0;Z<ye.length;Z++)ye[Z](N)}}u.rehover=function(N){N._fullLayout._rehover&&N._fullLayout._rehover()},u.redrag=function(N){N._fullLayout._redrag&&N._fullLayout._redrag()},u.generalUpdatePerTraceModule=function(N,U,q,Q){var W=U.traceHash,Z={},ee;for(ee=0;ee<q.length;ee++){var te=q[ee],ae=te[0].trace;ae.visible&&(Z[ae.type]=Z[ae.type]||[],Z[ae.type].push(te))}for(var le in W)if(!Z[le]){var ye=W[le][0],fe=ye[0].trace;fe.visible=!1,Z[le]=[ye]}for(var pe in Z){var ge=Z[pe],Ae=ge[0][0].trace._module;Ae.plot(N,U,r.filterVisible(ge),Q)}U.traceHash=Z},u.plotBasePlot=function(N,U,q,Q,W){var Z=e.getModule(N),ee=y(U.calcdata,Z)[0];Z.plot(U,ee,Q,W)},u.cleanBasePlot=function(N,U,q,Q,W){var Z=W._has&&W._has(N),ee=q._has&&q._has(N);Z&&!ee&&W["_"+N+"layer"].selectAll("g.trace").remove()}},{"../components/color":366,"../constants/numerical":479,"../lib":503,"../plot_api/plot_schema":542,"../plot_api/plot_template":543,"../plots/get_data":593,"../registry":638,"./animation_attributes":548,"./attributes":550,"./cartesian/axis_ids":558,"./cartesian/handle_outline":565,"./command":583,"./font_attributes":585,"./frame_attributes":586,"./layout_attributes":610,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],620:[function(d,re,ne){re.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],621:[function(d,re,ne){var w=d("../../lib"),c=d("../../lib/polygon").tester,M=w.findIndexOfMin,T=w.isAngleInsideSector,e=w.angleDelta,a=w.angleDist;function n(_,s,A,x,v){if(!T(s,x))return!1;var b,l;A[0]<A[1]?(b=A[0],l=A[1]):(b=A[1],l=A[0]);var L=c(i(b,x[0],x[1],v)),S=c(i(l,x[0],x[1],v)),k=[_*Math.cos(s),_*Math.sin(s)];return S.contains(k)&&!L.contains(k)}function r(_,s,A,x){var v,b,l=x[0],L=x[1],S=y(Math.sin(s)-Math.sin(_)),k=y(Math.cos(s)-Math.cos(_)),P=Math.tan(A),z=y(1/P),I=S/k,D=L-I*l;return z?S&&k?(v=D/(P-I),b=P*v):k?(v=L*z,b=L):(v=l,b=l*P):S&&k?(v=0,b=D):k?(v=0,b=L):v=b=NaN,[v,b]}function t(_,s,A,x){var v=-s*A,b=s*s+1,l=2*(s*v-A),L=v*v+A*A-_*_,S=Math.sqrt(l*l-4*b*L),k=(-l+S)/(2*b),P=(-l-S)/(2*b);return[[k,s*k+v+x],[P,s*P+v+x]]}function f(_,s){var A=s.length,x=new Array(A+1),v;for(v=0;v<A;v++){var b=s[v];x[v]=[_*Math.cos(b),_*Math.sin(b)]}return x[v]=x[0].slice(),x}function o(_,s,A,x){var v=x.length,b=[],l,L;function S(V){return[_*Math.cos(V),_*Math.sin(V)]}function k(V,G,J){return r(V,G,J,S(V))}function P(V){return w.mod(V,v)}function z(V){return T(V,[s,A])}var I=M(x,function(V){return z(V)?a(V,s):1/0}),D=k(x[I],x[P(I-1)],s);for(b.push(D),l=I,L=0;L<v;l++,L++){var R=x[P(l)];if(!z(R))break;b.push(S(R))}var B=M(x,function(V){return z(V)?a(V,A):1/0}),F=k(x[B],x[P(B+1)],A);return b.push(F),b.push([0,0]),b.push(b[0].slice()),b}function i(_,s,A,x){return w.isFullCircle([s,A])?f(_,x):o(_,s,A,x)}function g(_,s,A,x){for(var v=1/0,b=1/0,l=i(_,s,A,x),L=0;L<l.length;L++){var S=l[L];v=Math.min(v,S[0]),b=Math.min(b,-S[1])}return[v,b]}function p(_,s){var A=function(b){var l=e(b,_);return l>0?l:1/0},x=M(s,A),v=w.mod(x+1,s.length);return[s[x],s[v]]}function y(_){return Math.abs(_)>1e-10?_:0}function h(_,s,A){s=s||0,A=A||0;for(var x=_.length,v=new Array(x),b=0;b<x;b++){var l=_[b];v[b]=[s+l[0],A-l[1]]}return v}function m(_,s,A,x,v,b){var l=i(_,s,A,x);return"M"+h(l,v,b).join("L")}function u(_,s,A,x,v,b,l){var L,S;_<s?(L=_,S=s):(L=s,S=_);var k=h(i(L,A,x,v),b,l),P=h(i(S,A,x,v),b,l);return"M"+P.reverse().join("L")+"M"+k.join("L")}re.exports={isPtInsidePolygon:n,findPolygonOffset:g,findEnclosingVertexAngles:p,findIntersectionXY:r,findXYatLength:t,clampTiny:y,pathPolygon:m,pathPolygonAnnulus:u}},{"../../lib":503,"../../lib/polygon":515}],622:[function(d,re,ne){var w=d("../get_data").getSubplotCalcData,c=d("../../lib").counterRegex,M=d("./polar"),T=d("./constants"),e=T.attr,a=T.name,n=c(a),r={};r[e]={valType:"subplotid",dflt:a,editType:"calc"};function t(o){for(var i=o._fullLayout,g=o.calcdata,p=i._subplots[a],y=0;y<p.length;y++){var h=p[y],m=w(g,a,h),u=i[h]._subplot;u||(u=M(o,h),i[h]._subplot=u),u.plot(m,i,o._promises)}}function f(o,i,g,p){for(var y=p._subplots[a]||[],h=p._has&&p._has("gl"),m=i._has&&i._has("gl"),u=h&&!m,_=0;_<y.length;_++){var s=y[_],A=p[s]._subplot;if(!i[s]&&!!A){A.framework.remove(),A.layers["radial-axis-title"].remove();for(var x in A.clipPaths)A.clipPaths[x].remove()}u&&A._scene&&(A._scene.destroy(),A._scene=null)}}re.exports={attr:e,name:a,idRoot:a,idRegex:n,attrRegex:n,attributes:r,layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),plot:t,clean:f,toSVG:d("../cartesian").toSVG}},{"../../lib":503,"../cartesian":568,"../get_data":593,"./constants":620,"./layout_attributes":623,"./layout_defaults":624,"./polar":625}],623:[function(d,re,ne){var w=d("../../components/color/attributes"),c=d("../cartesian/layout_attributes"),M=d("../domain").attributes,T=d("../../lib").extendFlat,e=d("../../plot_api/edit_types").overrideAll,a=e({color:c.color,showline:T({},c.showline,{dflt:!0}),linecolor:c.linecolor,linewidth:c.linewidth,showgrid:T({},c.showgrid,{dflt:!0}),gridcolor:c.gridcolor,gridwidth:c.gridwidth},"plot","from-root"),n=e({tickmode:c.tickmode,nticks:c.nticks,tick0:c.tick0,dtick:c.dtick,tickvals:c.tickvals,ticktext:c.ticktext,ticks:c.ticks,ticklen:c.ticklen,tickwidth:c.tickwidth,tickcolor:c.tickcolor,ticklabelstep:c.ticklabelstep,showticklabels:c.showticklabels,showtickprefix:c.showtickprefix,tickprefix:c.tickprefix,showticksuffix:c.showticksuffix,ticksuffix:c.ticksuffix,showexponent:c.showexponent,exponentformat:c.exponentformat,minexponent:c.minexponent,separatethousands:c.separatethousands,tickfont:c.tickfont,tickangle:c.tickangle,tickformat:c.tickformat,tickformatstops:c.tickformatstops,layer:c.layer},"plot","from-root"),r={visible:T({},c.visible,{dflt:!0}),type:T({},c.type,{values:["-","linear","log","date","category"]}),autotypenumbers:c.autotypenumbers,autorange:T({},c.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:T({},c.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:c.categoryorder,categoryarray:c.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:T({},c.title.text,{editType:"plot",dflt:""}),font:T({},c.title.font,{editType:"plot"}),editType:"plot"},hoverformat:c.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:c._deprecated.title,titlefont:c._deprecated.titlefont}};T(r,a,n);var t={visible:T({},c.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:c.autotypenumbers,categoryorder:c.categoryorder,categoryarray:c.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:c.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};T(t,a,n),re.exports={domain:M({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:w.background},radialaxis:r,angularaxis:t,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":365,"../../lib":503,"../../plot_api/edit_types":536,"../cartesian/layout_attributes":569,"../domain":584}],624:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/color"),M=d("../../plot_api/plot_template"),T=d("../subplot_defaults"),e=d("../get_data").getSubplotData,a=d("../cartesian/tick_value_defaults"),n=d("../cartesian/tick_mark_defaults"),r=d("../cartesian/tick_label_defaults"),t=d("../cartesian/prefix_suffix_defaults"),f=d("../cartesian/category_order_defaults"),o=d("../cartesian/line_grid_defaults"),i=d("../cartesian/axis_autotype"),g=d("./layout_attributes"),p=d("./set_convert"),y=d("./constants"),h=y.axisNames;function m(_,s,A,x){var v=A("bgcolor");x.bgColor=c.combine(v,x.paper_bgcolor);var b=A("sector");A("hole");var l=e(x.fullData,y.name,x.id),L=x.layoutOut,S;function k(se,ie){return A(S+"."+se,ie)}for(var P=0;P<h.length;P++){S=h[P],w.isPlainObject(_[S])||(_[S]={});var z=_[S],I=M.newContainer(s,S);I._id=I._name=S,I._attr=x.id+"."+S,I._traceIndices=l.map(function(se){return se._expandedIndex});var D=y.axisName2dataArray[S],R=u(z,I,k,l,D,x);f(z,I,k,{axData:l,dataAttr:D});var B=k("visible");switch(p(I,s,L),k("uirevision",s.uirevision),I._m=1,S){case"radialaxis":var F=k("autorange",!I.isValidRange(z.range));z.autorange=F,F&&(R==="linear"||R==="-")&&k("rangemode"),F==="reversed"&&(I._m=-1),k("range"),I.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if(R==="date"){w.log("Polar plots do not support date angular axes yet.");for(var V=0;V<l.length;V++)l[V].visible=!1;R=z.type=I.type="linear"}k(R==="linear"?"thetaunit":"period");var G=k("direction");k("rotation",{counterclockwise:0,clockwise:90}[G]);break}if(t(z,I,k,I.type,{tickSuffixDflt:I.thetaunit==="degrees"?"\xB0":void 0}),B){var J,j,Y,X,oe=x.font||{};J=k("color"),j=J===z.color?J:oe.color,Y=oe.size,X=oe.family,a(z,I,k,I.type),r(z,I,k,I.type,{font:{color:j,size:Y,family:X}}),n(z,I,k,{outerTicks:!0}),o(z,I,k,{dfltColor:J,bgColor:x.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:g[S]}),k("layer"),S==="radialaxis"&&(k("side"),k("angle",b[0]),k("title.text"),w.coerceFont(k,"title.font",{color:j,size:w.bigFont(Y),family:X}))}R!=="category"&&k("hoverformat"),I._input=z}s.angularaxis.type==="category"&&A("gridshape")}function u(_,s,A,x,v,b){var l=A("autotypenumbers",b.autotypenumbersDflt),L=A("type");if(L==="-"){for(var S,k=0;k<x.length;k++)if(x[k].visible){S=x[k];break}S&&S[v]&&(s.type=i(S[v],"gregorian",{noMultiCategory:!0,autotypenumbers:l})),s.type==="-"?s.type="linear":_.type=s.type}return s.type}re.exports=function(s,A,x){T(s,A,x,{type:y.name,attributes:g,handleDefaults:m,font:A.font,autotypenumbersDflt:A.autotypenumbers,paper_bgcolor:A.paper_bgcolor,fullData:x,layoutOut:A})}},{"../../components/color":366,"../../lib":503,"../../plot_api/plot_template":543,"../cartesian/axis_autotype":555,"../cartesian/category_order_defaults":559,"../cartesian/line_grid_defaults":571,"../cartesian/prefix_suffix_defaults":573,"../cartesian/tick_label_defaults":578,"../cartesian/tick_mark_defaults":579,"../cartesian/tick_value_defaults":580,"../get_data":593,"../subplot_defaults":632,"./constants":620,"./layout_attributes":623,"./set_convert":626}],625:[function(d,re,ne){var w=d("@plotly/d3"),c=d("tinycolor2"),M=d("../../registry"),T=d("../../lib"),e=T.strRotate,a=T.strTranslate,n=d("../../components/color"),r=d("../../components/drawing"),t=d("../plots"),f=d("../../plots/cartesian/axes"),o=d("../cartesian/set_convert"),i=d("./set_convert"),g=d("../cartesian/autorange").doAutoRange,p=d("../cartesian/dragbox"),y=d("../../components/dragelement"),h=d("../../components/fx"),m=d("../../components/titles"),u=d("../cartesian/select").prepSelect,_=d("../cartesian/select").selectOnClick,s=d("../cartesian/select").clearSelect,A=d("../../lib/setcursor"),x=d("../../lib/clear_gl_canvases"),v=d("../../plot_api/subroutines").redrawReglTraces,b=d("../../constants/alignment").MID_SHIFT,l=d("./constants"),L=d("./helpers"),S=d("../smith/helpers"),k=S.smith,P=S.reactanceArc,z=S.resistanceArc,I=S.smithTransform,D=T._,R=T.mod,B=T.deg2rad,F=T.rad2deg;function V(oe,se,ie){this.isSmith=ie||!1,this.id=se,this.gd=oe,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var N=oe._fullLayout,U="clip"+N._uid+se;this.clipIds.forTraces=U+"-for-traces",this.clipPaths.forTraces=N._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=N["_"+(ie?"smith":"polar")+"layer"].append("g").attr("class",se),this.getHole=function(q){return this.isSmith?0:q.hole},this.getSector=function(q){return this.isSmith?[0,360]:q.sector},this.getRadial=function(q){return this.isSmith?q.realaxis:q.radialaxis},this.getAngular=function(q){return this.isSmith?q.imaginaryaxis:q.angularaxis},ie||(this.radialTickLayout=null,this.angularTickLayout=null)}var G=V.prototype;re.exports=function(se,ie,N){return new V(se,ie,N)},G.plot=function(oe,se){for(var ie=this,N=se[ie.id],U=!1,q=0;q<oe.length;q++){var Q=oe[q][0].trace;if(Q.cliponaxis===!1){U=!0;break}}ie._hasClipOnAxisFalse=U,ie.updateLayers(se,N),ie.updateLayout(se,N),t.generalUpdatePerTraceModule(ie.gd,ie,oe,N),ie.updateFx(se,N),ie.isSmith&&(delete N.realaxis.range,delete N.imaginaryaxis.range)},G.updateLayers=function(oe,se){var ie=this,N=ie.isSmith,U=ie.layers,q=ie.getRadial(se),Q=ie.getAngular(se),W=l.layerNames,Z=W.indexOf("frontplot"),ee=W.slice(0,Z),te=Q.layer==="below traces",ae=q.layer==="below traces";te&&ee.push("angular-line"),ae&&ee.push("radial-line"),te&&ee.push("angular-axis"),ae&&ee.push("radial-axis"),ee.push("frontplot"),te||ee.push("angular-line"),ae||ee.push("radial-line"),te||ee.push("angular-axis"),ae||ee.push("radial-axis");var le=(N?"smith":"polar")+"sublayer",ye=ie.framework.selectAll("."+le).data(ee,String);ye.enter().append("g").attr("class",function(fe){return le+" "+fe}).each(function(fe){var pe=U[fe]=w.select(this);switch(fe){case"frontplot":N||pe.append("g").classed("barlayer",!0),pe.append("g").classed("scatterlayer",!0);break;case"backplot":pe.append("g").classed("maplayer",!0);break;case"plotbg":U.bg=pe.append("path");break;case"radial-grid":pe.style("fill","none");break;case"angular-grid":pe.style("fill","none");break;case"radial-line":pe.append("line").style("fill","none");break;case"angular-line":pe.append("path").style("fill","none");break}}),ye.order()},G.updateLayout=function(oe,se){var ie=this,N=ie.layers,U=oe._size,q=ie.getRadial(se),Q=ie.getAngular(se),W=se.domain.x,Z=se.domain.y;ie.xOffset=U.l+U.w*W[0],ie.yOffset=U.t+U.h*(1-Z[1]);var ee=ie.xLength=U.w*(W[1]-W[0]),te=ie.yLength=U.h*(Z[1]-Z[0]),ae=ie.getSector(se);ie.sectorInRad=ae.map(B);var le=ie.sectorBBox=j(ae),ye=le[2]-le[0],fe=le[3]-le[1],pe=te/ee,ge=Math.abs(fe/ye),Ae,we,De,Be,Ve;pe>ge?(Ae=ee,we=ee*ge,Ve=(te-we)/U.h/2,De=[W[0],W[1]],Be=[Z[0]+Ve,Z[1]-Ve]):(Ae=te/ge,we=te,Ve=(ee-Ae)/U.w/2,De=[W[0]+Ve,W[1]-Ve],Be=[Z[0],Z[1]]),ie.xLength2=Ae,ie.yLength2=we,ie.xDomain2=De,ie.yDomain2=Be;var xe=ie.xOffset2=U.l+U.w*De[0],Le=ie.yOffset2=U.t+U.h*(1-Be[1]),He=ie.radius=Ae/ye,Je=ie.innerRadius=ie.getHole(se)*He,Oe=ie.cx=xe-He*le[0],Pe=ie.cy=Le+He*le[3],Ue=ie.cxx=Oe-xe,vt=ie.cyy=Pe-Le,Lt=q.side,Yt;Lt==="counterclockwise"?(Yt=Lt,Lt="top"):Lt==="clockwise"&&(Yt=Lt,Lt="bottom"),ie.radialAxis=ie.mockAxis(oe,se,q,{_id:"x",side:Lt,_trueSide:Yt,domain:[Je/U.w,He/U.w]}),ie.angularAxis=ie.mockAxis(oe,se,Q,{side:"right",domain:[0,Math.PI],autorange:!1}),ie.doAutoRange(oe,se),ie.updateAngularAxis(oe,se),ie.updateRadialAxis(oe,se),ie.updateRadialAxisTitle(oe,se),ie.xaxis=ie.mockCartesianAxis(oe,se,{_id:"x",domain:De}),ie.yaxis=ie.mockCartesianAxis(oe,se,{_id:"y",domain:Be});var At=ie.pathSubplot();ie.clipPaths.forTraces.select("path").attr("d",At).attr("transform",a(Ue,vt)),N.frontplot.attr("transform",a(xe,Le)).call(r.setClipUrl,ie._hasClipOnAxisFalse?null:ie.clipIds.forTraces,ie.gd),N.bg.attr("d",At).attr("transform",a(Oe,Pe)).call(n.fill,se.bgcolor)},G.mockAxis=function(oe,se,ie,N){var U=T.extendFlat({},ie,N);return i(U,se,oe),U},G.mockCartesianAxis=function(oe,se,ie){var N=this,U=N.isSmith,q=ie._id,Q=T.extendFlat({type:"linear"},ie);o(Q,oe);var W={x:[0,2],y:[1,3]};return Q.setRange=function(){var Z=N.sectorBBox,ee=W[q],te=N.radialAxis._rl,ae=(te[1]-te[0])/(1-N.getHole(se));Q.range=[Z[ee[0]]*ae,Z[ee[1]]*ae]},Q.isPtWithinRange=q==="x"&&!U?function(Z){return N.isPtInside(Z)}:function(){return!0},Q.setRange(),Q.setScale(),Q},G.doAutoRange=function(oe,se){var ie=this,N=ie.gd,U=ie.radialAxis,q=ie.getRadial(se);g(N,U);var Q=U.range;q.range=Q.slice(),q._input.range=Q.slice(),U._rl=[U.r2l(Q[0],null,"gregorian"),U.r2l(Q[1],null,"gregorian")]},G.updateRadialAxis=function(oe,se){var ie=this,N=ie.gd,U=ie.layers,q=ie.radius,Q=ie.innerRadius,W=ie.cx,Z=ie.cy,ee=ie.getRadial(se),te=R(ie.getSector(se)[0],360),ae=ie.radialAxis,le=Q<q,ye=ie.isSmith;ye||(ie.fillViewInitialKey("radialaxis.angle",ee.angle),ie.fillViewInitialKey("radialaxis.range",ae.range.slice()),ae.setGeometry()),ae.tickangle==="auto"&&te>90&&te<=270&&(ae.tickangle=180);var fe=ye?function(He){var Je=I(ie,k([He.x,0]));return a(Je[0]-W,Je[1]-Z)}:function(He){return a(ae.l2p(He.x)+Q,0)},pe=ye?function(He){return z(ie,He.x,-1/0,1/0)}:function(He){return ie.pathArc(ae.r2p(He.x)+Q)},ge=J(ee);if(ie.radialTickLayout!==ge&&(U["radial-axis"].selectAll(".xtick").remove(),ie.radialTickLayout=ge),le){ae.setScale();var Ae=0,we=ye?(ae.tickvals||[]).filter(function(He){return He>=0}).map(function(He){return f.tickText(ae,He,!0,!1)}):f.calcTicks(ae),De=ye?we:f.clipEnds(ae,we),Be=f.getTickSigns(ae)[2];ye&&((ae.ticks==="top"&&ae.side==="bottom"||ae.ticks==="bottom"&&ae.side==="top")&&(Be=-Be),ae.ticks==="top"&&ae.side==="top"&&(Ae=-ae.ticklen),ae.ticks==="bottom"&&ae.side==="bottom"&&(Ae=ae.ticklen)),f.drawTicks(N,ae,{vals:we,layer:U["radial-axis"],path:f.makeTickPath(ae,0,Be),transFn:fe,crisp:!1}),f.drawGrid(N,ae,{vals:De,layer:U["radial-grid"],path:pe,transFn:T.noop,crisp:!1}),f.drawLabels(N,ae,{vals:we,layer:U["radial-axis"],transFn:fe,labelFns:f.makeLabelFns(ae,Ae)})}var Ve=ie.radialAxisAngle=ie.vangles?F(Y(B(ee.angle),ie.vangles)):ee.angle,xe=a(W,Z),Le=xe+e(-Ve);X(U["radial-axis"],le&&(ee.showticklabels||ee.ticks),{transform:Le}),X(U["radial-grid"],le&&ee.showgrid,{transform:ye?"":xe}),X(U["radial-line"].select("line"),le&&ee.showline,{x1:ye?-q:Q,y1:0,x2:q,y2:0,transform:Le}).attr("stroke-width",ee.linewidth).call(n.stroke,ee.linecolor)},G.updateRadialAxisTitle=function(oe,se,ie){if(!this.isSmith){var N=this,U=N.gd,q=N.radius,Q=N.cx,W=N.cy,Z=N.getRadial(se),ee=N.id+"title",te=0;if(Z.title){var ae=r.bBox(N.layers["radial-axis"].node()).height,le=Z.title.font.size,ye=Z.side;te=ye==="top"?le:ye==="counterclockwise"?-(ae+le*.4):ae+le*.8}var fe=ie!==void 0?ie:N.radialAxisAngle,pe=B(fe),ge=Math.cos(pe),Ae=Math.sin(pe),we=Q+q/2*ge+te*Ae,De=W-q/2*Ae+te*ge;N.layers["radial-axis-title"]=m.draw(U,ee,{propContainer:Z,propName:N.id+".radialaxis.title",placeholder:D(U,"Click to enter radial axis title"),attributes:{x:we,y:De,"text-anchor":"middle"},transform:{rotate:-fe}})}},G.updateAngularAxis=function(oe,se){var ie=this,N=ie.gd,U=ie.layers,q=ie.radius,Q=ie.innerRadius,W=ie.cx,Z=ie.cy,ee=ie.getAngular(se),te=ie.angularAxis,ae=ie.isSmith;ae||(ie.fillViewInitialKey("angularaxis.rotation",ee.rotation),te.setGeometry(),te.setScale());var le=ae?function(Je){var Oe=I(ie,k([0,Je.x]));return Math.atan2(Oe[0]-W,Oe[1]-Z)-Math.PI/2}:function(Je){return te.t2g(Je.x)};te.type==="linear"&&te.thetaunit==="radians"&&(te.tick0=F(te.tick0),te.dtick=F(te.dtick));var ye=function(Je){return a(W+q*Math.cos(Je),Z-q*Math.sin(Je))},fe=ae?function(Je){var Oe=I(ie,k([0,Je.x]));return a(Oe[0],Oe[1])}:function(Je){return ye(le(Je))},pe=ae?function(Je){var Oe=I(ie,k([0,Je.x])),Pe=Math.atan2(Oe[0]-W,Oe[1]-Z)-Math.PI/2;return a(Oe[0],Oe[1])+e(-F(Pe))}:function(Je){var Oe=le(Je);return ye(Oe)+e(-F(Oe))},ge=ae?function(Je){return P(ie,Je.x,0,1/0)}:function(Je){var Oe=le(Je),Pe=Math.cos(Oe),Ue=Math.sin(Oe);return"M"+[W+Q*Pe,Z-Q*Ue]+"L"+[W+q*Pe,Z-q*Ue]},Ae=f.makeLabelFns(te,0),we=Ae.labelStandoff,De={};De.xFn=function(Je){var Oe=le(Je);return Math.cos(Oe)*we},De.yFn=function(Je){var Oe=le(Je),Pe=Math.sin(Oe)>0?.2:1;return-Math.sin(Oe)*(we+Je.fontSize*Pe)+Math.abs(Math.cos(Oe))*(Je.fontSize*b)},De.anchorFn=function(Je){var Oe=le(Je),Pe=Math.cos(Oe);return Math.abs(Pe)<.1?"middle":Pe>0?"start":"end"},De.heightFn=function(Je,Oe,Pe){var Ue=le(Je);return-.5*(1+Math.sin(Ue))*Pe};var Be=J(ee);ie.angularTickLayout!==Be&&(U["angular-axis"].selectAll("."+te._id+"tick").remove(),ie.angularTickLayout=Be);var Ve=ae?[1/0].concat(te.tickvals||[]).map(function(Je){return f.tickText(te,Je,!0,!1)}):f.calcTicks(te);ae&&(Ve[0].text="\u221E",Ve[0].fontSize*=1.75);var xe;if(se.gridshape==="linear"?(xe=Ve.map(le),T.angleDelta(xe[0],xe[1])<0&&(xe=xe.slice().reverse())):xe=null,ie.vangles=xe,te.type==="category"&&(Ve=Ve.filter(function(Je){return T.isAngleInsideSector(le(Je),ie.sectorInRad)})),te.visible){var Le=te.ticks==="inside"?-1:1,He=(te.linewidth||1)/2;f.drawTicks(N,te,{vals:Ve,layer:U["angular-axis"],path:"M"+Le*He+",0h"+Le*te.ticklen,transFn:pe,crisp:!1}),f.drawGrid(N,te,{vals:Ve,layer:U["angular-grid"],path:ge,transFn:T.noop,crisp:!1}),f.drawLabels(N,te,{vals:Ve,layer:U["angular-axis"],repositionOnUpdate:!0,transFn:fe,labelFns:De})}X(U["angular-line"].select("path"),ee.showline,{d:ie.pathSubplot(),transform:a(W,Z)}).attr("stroke-width",ee.linewidth).call(n.stroke,ee.linecolor)},G.updateFx=function(oe,se){if(!this.gd._context.staticPlot){var ie=!this.isSmith;ie&&(this.updateAngularDrag(oe),this.updateRadialDrag(oe,se,0),this.updateRadialDrag(oe,se,1)),this.updateHoverAndMainDrag(oe)}},G.updateHoverAndMainDrag=function(oe){var se=this,ie=se.isSmith,N=se.gd,U=se.layers,q=oe._zoomlayer,Q=l.MINZOOM,W=l.OFFEDGE,Z=se.radius,ee=se.innerRadius,te=se.cx,ae=se.cy,le=se.cxx,ye=se.cyy,fe=se.sectorInRad,pe=se.vangles,ge=se.radialAxis,Ae=L.clampTiny,we=L.findXYatLength,De=L.findEnclosingVertexAngles,Be=l.cornerHalfWidth,Ve=l.cornerLen/2,xe,Le,He=p.makeDragger(U,"path","maindrag","crosshair");w.select(He).attr("d",se.pathSubplot()).attr("transform",a(te,ae)),He.onmousemove=function(tr){h.hover(N,tr,se.id),N._fullLayout._lasthover=He,N._fullLayout._hoversubplot=se.id},He.onmouseout=function(tr){N._dragging||y.unhover(N,tr)};var Je={element:He,gd:N,subplot:se.id,plotinfo:{id:se.id,xaxis:se.xaxis,yaxis:se.yaxis},xaxes:[se.xaxis],yaxes:[se.yaxis]},Oe,Pe,Ue,vt,Lt,Yt,At,Rt,Bt;function Mt(tr,qt){return Math.sqrt(tr*tr+qt*qt)}function Tt(tr,qt){return Mt(tr-le,qt-ye)}function at(tr,qt){return Math.atan2(ye-qt,tr-le)}function ct(tr,qt){return[tr*Math.cos(qt),tr*Math.sin(-qt)]}function je(tr,qt){if(tr===0)return se.pathSector(2*Be);var lr=Ve/tr,Wr=qt-lr,cn=qt+lr,Jr=Math.max(0,Math.min(tr,Z)),ot=Jr-Be,Vt=Jr+Be;return"M"+ct(ot,Wr)+"A"+[ot,ot]+" 0,0,0 "+ct(ot,cn)+"L"+ct(Vt,cn)+"A"+[Vt,Vt]+" 0,0,1 "+ct(Vt,Wr)+"Z"}function ke(tr,qt,lr){if(tr===0)return se.pathSector(2*Be);var Wr=ct(tr,qt),cn=ct(tr,lr),Jr=Ae((Wr[0]+cn[0])/2),ot=Ae((Wr[1]+cn[1])/2),Vt,jt;if(Jr&&ot){var Ut=ot/Jr,yr=-1/Ut,nt=we(Be,Ut,Jr,ot);Vt=we(Ve,yr,nt[0][0],nt[0][1]),jt=we(Ve,yr,nt[1][0],nt[1][1])}else{var _e,Me;ot?(_e=Ve,Me=Be):(_e=Be,Me=Ve),Vt=[[Jr-_e,ot-Me],[Jr+_e,ot-Me]],jt=[[Jr-_e,ot+Me],[Jr+_e,ot+Me]]}return"M"+Vt.join("L")+"L"+jt.reverse().join("L")+"Z"}function Ye(){Ue=null,vt=null,Lt=se.pathSubplot(),Yt=!1;var tr=N._fullLayout[se.id];At=c(tr.bgcolor).getLuminance(),Rt=p.makeZoombox(q,At,te,ae,Lt),Rt.attr("fill-rule","evenodd"),Bt=p.makeCorners(q,te,ae),s(N)}function Ke(tr,qt){return qt=Math.max(Math.min(qt,Z),ee),tr<W?tr=0:Z-tr<W?tr=Z:qt<W?qt=0:Z-qt<W&&(qt=Z),Math.abs(qt-tr)>Q?(tr<qt?(Ue=tr,vt=qt):(Ue=qt,vt=tr),!0):(Ue=null,vt=null,!1)}function st(tr,qt){tr=tr||Lt,qt=qt||"M0,0Z",Rt.attr("d",tr),Bt.attr("d",qt),p.transitionZoombox(Rt,Bt,Yt,At),Yt=!0;var lr={};Ot(lr),N.emit("plotly_relayouting",lr)}function Et(tr,qt){tr=tr*xe,qt=qt*Le;var lr=Oe+tr,Wr=Pe+qt,cn=Tt(Oe,Pe),Jr=Math.min(Tt(lr,Wr),Z),ot=at(Oe,Pe),Vt,jt;Ke(cn,Jr)&&(Vt=Lt+se.pathSector(vt),Ue&&(Vt+=se.pathSector(Ue)),jt=je(Ue,ot)+je(vt,ot)),st(Vt,jt)}function bt(tr,qt,lr,Wr){var cn=L.findIntersectionXY(lr,Wr,lr,[tr-le,ye-qt]);return Mt(cn[0],cn[1])}function zt(tr,qt){var lr=Oe+tr,Wr=Pe+qt,cn=at(Oe,Pe),Jr=at(lr,Wr),ot=De(cn,pe),Vt=De(Jr,pe),jt=bt(Oe,Pe,ot[0],ot[1]),Ut=Math.min(bt(lr,Wr,Vt[0],Vt[1]),Z),yr,nt;Ke(jt,Ut)&&(yr=Lt+se.pathSector(vt),Ue&&(yr+=se.pathSector(Ue)),nt=[ke(Ue,ot[0],ot[1]),ke(vt,ot[0],ot[1])].join(" ")),st(yr,nt)}function $t(){if(p.removeZoombox(N),!(Ue===null||vt===null)){var tr={};Ot(tr),p.showDoubleClickNotifier(N),M.call("_guiRelayout",N,tr)}}function Ot(tr){var qt=ge._rl,lr=(qt[1]-qt[0])/(1-ee/Z)/Z,Wr=[qt[0]+(Ue-ee)*lr,qt[0]+(vt-ee)*lr];tr[se.id+".radialaxis.range"]=Wr}function Qt(tr,qt){var lr=N._fullLayout.clickmode;if(p.removeZoombox(N),tr===2){var Wr={};for(var cn in se.viewInitial)Wr[se.id+"."+cn]=se.viewInitial[cn];N.emit("plotly_doubleclick",null),M.call("_guiRelayout",N,Wr)}lr.indexOf("select")>-1&&tr===1&&_(qt,N,[se.xaxis],[se.yaxis],se.id,Je),lr.indexOf("event")>-1&&h.click(N,qt,se.id)}Je.prepFn=function(tr,qt,lr){var Wr=N._fullLayout.dragmode,cn=He.getBoundingClientRect();N._fullLayout._calcInverseTransform(N);var Jr=N._fullLayout._invTransform;xe=N._fullLayout._invScaleX,Le=N._fullLayout._invScaleY;var ot=T.apply3DTransform(Jr)(qt-cn.left,lr-cn.top);if(Oe=ot[0],Pe=ot[1],pe){var Vt=L.findPolygonOffset(Z,fe[0],fe[1],pe);Oe+=le+Vt[0],Pe+=ye+Vt[1]}switch(Wr){case"zoom":Je.clickFn=Qt,ie||(pe?Je.moveFn=zt:Je.moveFn=Et,Je.doneFn=$t,Ye());break;case"select":case"lasso":u(tr,qt,lr,Je,Wr);break}},y.init(Je)},G.updateRadialDrag=function(oe,se,ie){var N=this,U=N.gd,q=N.layers,Q=N.radius,W=N.innerRadius,Z=N.cx,ee=N.cy,te=N.radialAxis,ae=l.radialDragBoxSize,le=ae/2;if(!te.visible)return;var ye=B(N.radialAxisAngle),fe=te._rl,pe=fe[0],ge=fe[1],Ae=fe[ie],we=.75*(fe[1]-fe[0])/(1-N.getHole(se))/Q,De,Be,Ve;ie?(De=Z+(Q+le)*Math.cos(ye),Be=ee-(Q+le)*Math.sin(ye),Ve="radialdrag"):(De=Z+(W-le)*Math.cos(ye),Be=ee-(W-le)*Math.sin(ye),Ve="radialdrag-inner");var xe=p.makeRectDragger(q,Ve,"crosshair",-le,-le,ae,ae),Le={element:xe,gd:U};X(w.select(xe),te.visible&&W<Q,{transform:a(De,Be)});var He,Je,Oe;function Pe(At,Rt){if(He)He(At,Rt);else{var Bt=[At,-Rt],Mt=[Math.cos(ye),Math.sin(ye)],Tt=Math.abs(T.dot(Bt,Mt)/Math.sqrt(T.dot(Bt,Bt)));isNaN(Tt)||(He=Tt<.5?Lt:Yt)}var at={};Ue(at),U.emit("plotly_relayouting",at)}function Ue(At){Je!==null?At[N.id+".radialaxis.angle"]=Je:Oe!==null&&(At[N.id+".radialaxis.range["+ie+"]"]=Oe)}function vt(){Je!==null?M.call("_guiRelayout",U,N.id+".radialaxis.angle",Je):Oe!==null&&M.call("_guiRelayout",U,N.id+".radialaxis.range["+ie+"]",Oe)}function Lt(At,Rt){if(ie!==0){var Bt=De+At,Mt=Be+Rt;Je=Math.atan2(ee-Mt,Bt-Z),N.vangles&&(Je=Y(Je,N.vangles)),Je=F(Je);var Tt=a(Z,ee)+e(-Je);q["radial-axis"].attr("transform",Tt),q["radial-line"].select("line").attr("transform",Tt);var at=N.gd._fullLayout,ct=at[N.id];N.updateRadialAxisTitle(at,ct,Je)}}function Yt(At,Rt){var Bt=T.dot([At,-Rt],[Math.cos(ye),Math.sin(ye)]);if(Oe=Ae-we*Bt,we>0!=(ie?Oe>pe:Oe<ge)){Oe=null;return}var Mt=U._fullLayout,Tt=Mt[N.id];te.range[ie]=Oe,te._rl[ie]=Oe,N.updateRadialAxis(Mt,Tt),N.xaxis.setRange(),N.xaxis.setScale(),N.yaxis.setRange(),N.yaxis.setScale();var at=!1;for(var ct in N.traceHash){var je=N.traceHash[ct],ke=T.filterVisible(je),Ye=je[0][0].trace._module;Ye.plot(U,N,ke,Tt),M.traceIs(ct,"gl")&&ke.length&&(at=!0)}at&&(x(U),v(U))}Le.prepFn=function(){He=null,Je=null,Oe=null,Le.moveFn=Pe,Le.doneFn=vt,s(U)},Le.clampFn=function(At,Rt){return Math.sqrt(At*At+Rt*Rt)<l.MINDRAG&&(At=0,Rt=0),[At,Rt]},y.init(Le)},G.updateAngularDrag=function(oe){var se=this,ie=se.gd,N=se.layers,U=se.radius,q=se.angularAxis,Q=se.cx,W=se.cy,Z=se.cxx,ee=se.cyy,te=l.angularDragBoxSize,ae=p.makeDragger(N,"path","angulardrag","move"),le={element:ae,gd:ie};w.select(ae).attr("d",se.pathAnnulus(U,U+te)).attr("transform",a(Q,W)).call(A,"move");function ye(Oe,Pe){return Math.atan2(ee+te-Pe,Oe-Z-te)}var fe=N.frontplot.select(".scatterlayer").selectAll(".trace"),pe=fe.selectAll(".point"),ge=fe.selectAll(".textpoint"),Ae,we,De,Be,Ve,xe;function Le(Oe,Pe){var Ue=se.gd._fullLayout,vt=Ue[se.id],Lt=Ae+Oe*oe._invScaleX,Yt=we+Pe*oe._invScaleY,At=ye(Lt,Yt),Rt=F(At-xe);if(Be=De+Rt,N.frontplot.attr("transform",a(se.xOffset2,se.yOffset2)+e([-Rt,Z,ee])),se.vangles){Ve=se.radialAxisAngle+Rt;var Bt=a(Q,W)+e(-Rt),Mt=a(Q,W)+e(-Ve);N.bg.attr("transform",Bt),N["radial-grid"].attr("transform",Bt),N["radial-axis"].attr("transform",Mt),N["radial-line"].select("line").attr("transform",Mt),se.updateRadialAxisTitle(Ue,vt,Ve)}else se.clipPaths.forTraces.select("path").attr("transform",a(Z,ee)+e(Rt));pe.each(function(){var Ke=w.select(this),st=r.getTranslate(Ke);Ke.attr("transform",a(st.x,st.y)+e([Rt]))}),ge.each(function(){var Ke=w.select(this),st=Ke.select("text"),Et=r.getTranslate(Ke);Ke.attr("transform",e([Rt,st.attr("x"),st.attr("y")])+a(Et.x,Et.y))}),q.rotation=T.modHalf(Be,360),se.updateAngularAxis(Ue,vt),se._hasClipOnAxisFalse&&!T.isFullCircle(se.sectorInRad)&&fe.call(r.hideOutsideRangePoints,se);var Tt=!1;for(var at in se.traceHash)if(M.traceIs(at,"gl")){var ct=se.traceHash[at],je=T.filterVisible(ct),ke=ct[0][0].trace._module;ke.plot(ie,se,je,vt),je.length&&(Tt=!0)}Tt&&(x(ie),v(ie));var Ye={};He(Ye),ie.emit("plotly_relayouting",Ye)}function He(Oe){Oe[se.id+".angularaxis.rotation"]=Be,se.vangles&&(Oe[se.id+".radialaxis.angle"]=Ve)}function Je(){ge.select("text").attr("transform",null);var Oe={};He(Oe),M.call("_guiRelayout",ie,Oe)}le.prepFn=function(Oe,Pe,Ue){var vt=oe[se.id];De=vt.angularaxis.rotation;var Lt=ae.getBoundingClientRect();Ae=Pe-Lt.left,we=Ue-Lt.top,ie._fullLayout._calcInverseTransform(ie);var Yt=T.apply3DTransform(oe._invTransform)(Ae,we);Ae=Yt[0],we=Yt[1],xe=ye(Ae,we),le.moveFn=Le,le.doneFn=Je,s(ie)},se.vangles&&!T.isFullCircle(se.sectorInRad)&&(le.prepFn=T.noop,A(w.select(ae),null)),y.init(le)},G.isPtInside=function(oe){if(this.isSmith)return!0;var se=this.sectorInRad,ie=this.vangles,N=this.angularAxis.c2g(oe.theta),U=this.radialAxis,q=U.c2l(oe.r),Q=U._rl,W=ie?L.isPtInsidePolygon:T.isPtInsideSector;return W(q,N,Q,se,ie)},G.pathArc=function(oe){var se=this.sectorInRad,ie=this.vangles,N=ie?L.pathPolygon:T.pathArc;return N(oe,se[0],se[1],ie)},G.pathSector=function(oe){var se=this.sectorInRad,ie=this.vangles,N=ie?L.pathPolygon:T.pathSector;return N(oe,se[0],se[1],ie)},G.pathAnnulus=function(oe,se){var ie=this.sectorInRad,N=this.vangles,U=N?L.pathPolygonAnnulus:T.pathAnnulus;return U(oe,se,ie[0],ie[1],N)},G.pathSubplot=function(){var oe=this.innerRadius,se=this.radius;return oe?this.pathAnnulus(oe,se):this.pathSector(se)},G.fillViewInitialKey=function(oe,se){oe in this.viewInitial||(this.viewInitial[oe]=se)};function J(oe){var se=oe.ticks+String(oe.ticklen)+String(oe.showticklabels);return"side"in oe&&(se+=oe.side),se}function j(oe){var se=oe[0],ie=oe[1],N=ie-se,U=R(se,360),q=U+N,Q=Math.cos(B(U)),W=Math.sin(B(U)),Z=Math.cos(B(q)),ee=Math.sin(B(q)),te,ae,le,ye;return U<=90&&q>=90||U>90&&q>=450?ye=1:W<=0&&ee<=0?ye=0:ye=Math.max(W,ee),U<=180&&q>=180||U>180&&q>=540?te=-1:Q>=0&&Z>=0?te=0:te=Math.min(Q,Z),U<=270&&q>=270||U>270&&q>=630?ae=-1:W>=0&&ee>=0?ae=0:ae=Math.min(W,ee),q>=360?le=1:Q<=0&&Z<=0?le=0:le=Math.max(Q,Z),[te,ae,le,ye]}function Y(oe,se){var ie=function(U){return T.angleDist(oe,U)},N=T.findIndexOfMin(se,ie);return se[N]}function X(oe,se,ie){return se?(oe.attr("display",null),oe.attr(ie)):oe&&oe.attr("display","none"),oe}},{"../../components/color":366,"../../components/dragelement":385,"../../components/drawing":388,"../../components/fx":406,"../../components/titles":464,"../../constants/alignment":471,"../../lib":503,"../../lib/clear_gl_canvases":487,"../../lib/setcursor":524,"../../plot_api/subroutines":544,"../../plots/cartesian/axes":554,"../../registry":638,"../cartesian/autorange":553,"../cartesian/dragbox":563,"../cartesian/select":575,"../cartesian/set_convert":576,"../plots":619,"../smith/helpers":628,"./constants":620,"./helpers":621,"./set_convert":626,"@plotly/d3":58,tinycolor2:312}],626:[function(d,re,ne){var w=d("../../lib"),c=d("../cartesian/set_convert"),M=w.deg2rad,T=w.rad2deg;re.exports=function(f,o,i){switch(c(f,i),f._id){case"x":case"radialaxis":e(f,o);break;case"angularaxis":r(f,o);break}};function e(t,f){var o=f._subplot;t.setGeometry=function(){var i=t._rl[0],g=t._rl[1],p=o.innerRadius,y=(o.radius-p)/(g-i),h=p/y,m=i>g?function(u){return u<=0}:function(u){return u>=0};t.c2g=function(u){var _=t.c2l(u)-i;return(m(_)?_:0)+h},t.g2c=function(u){return t.l2c(u+i-h)},t.g2p=function(u){return u*y},t.c2p=function(u){return t.g2p(t.c2g(u))}}}function a(t,f){return f==="degrees"?M(t):t}function n(t,f){return f==="degrees"?T(t):t}function r(t,f){var o=t.type;if(o==="linear"){var i=t.d2c,g=t.c2d;t.d2c=function(p,y){return a(i(p),y)},t.c2d=function(p,y){return g(n(p,y))}}t.makeCalcdata=function(p,y){var h=p[y],m=p._length,u,_,s=function(l){return t.d2c(l,p.thetaunit)};if(h){if(w.isTypedArray(h)&&o==="linear"){if(m===h.length)return h;if(h.subarray)return h.subarray(0,m)}for(u=new Array(m),_=0;_<m;_++)u[_]=s(h[_])}else{var A=y+"0",x="d"+y,v=A in p?s(p[A]):0,b=p[x]?s(p[x]):(t.period||2*Math.PI)/m;for(u=new Array(m),_=0;_<m;_++)u[_]=v+_*b}return u},t.setGeometry=function(){var p=f.sector,y=p.map(M),h={clockwise:-1,counterclockwise:1}[t.direction],m=M(t.rotation),u=function(L){return h*L+m},_=function(L){return(L-m)/h},s,A,x,v;switch(o){case"linear":A=s=w.identity,v=M,x=T,t.range=w.isFullCircle(y)?[p[0],p[0]+360]:y.map(_).map(T);break;case"category":var b=t._categories.length,l=t.period?Math.max(t.period,b):b;l===0&&(l=1),A=v=function(L){return L*2*Math.PI/l},s=x=function(L){return L*l/Math.PI/2},t.range=[0,l];break}t.c2g=function(L){return u(A(L))},t.g2c=function(L){return s(_(L))},t.t2g=function(L){return u(v(L))},t.g2t=function(L){return x(_(L))}}}},{"../../lib":503,"../cartesian/set_convert":576}],627:[function(d,re,ne){re.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],628:[function(d,re,ne){function w(n){return n<0?-1:n>0?1:0}function c(n){var r=n[0],t=n[1];if(!isFinite(r)||!isFinite(t))return[1,0];var f=(r+1)*(r+1)+t*t;return[(r*r+t*t-1)/f,2*t/f]}function M(n,r){var t=r[0],f=r[1];return[t*n.radius+n.cx,-f*n.radius+n.cy]}function T(n,r){return r*n.radius}function e(n,r,t,f){var o=M(n,c([t,r])),i=o[0],g=o[1],p=M(n,c([f,r])),y=p[0],h=p[1];if(r===0)return["M"+i+","+g,"L"+y+","+h].join(" ");var m=T(n,1/Math.abs(r));return["M"+i+","+g,"A"+m+","+m+" 0 0,"+(r<0?1:0)+" "+y+","+h].join(" ")}function a(n,r,t,f){var o=T(n,1/(r+1)),i=M(n,c([r,t])),g=i[0],p=i[1],y=M(n,c([r,f])),h=y[0],m=y[1];if(w(t)!==w(f)){var u=M(n,c([r,0])),_=u[0],s=u[1];return["M"+g+","+p,"A"+o+","+o+" 0 0,"+(0<t?0:1)+" "+_+","+s,"A"+o+","+o+" 0 0,"+(f<0?0:1)+h+","+m].join(" ")}return["M"+g+","+p,"A"+o+","+o+" 0 0,"+(f<t?0:1)+" "+h+","+m].join(" ")}re.exports={smith:c,reactanceArc:e,resistanceArc:a,smithTransform:M}},{}],629:[function(d,re,ne){var w=d("../get_data").getSubplotCalcData,c=d("../../lib").counterRegex,M=d("../polar/polar"),T=d("./constants"),e=T.attr,a=T.name,n=c(a),r={};r[e]={valType:"subplotid",dflt:a,editType:"calc"};function t(o){for(var i=o._fullLayout,g=o.calcdata,p=i._subplots[a],y=0;y<p.length;y++){var h=p[y],m=w(g,a,h),u=i[h]._subplot;u||(u=M(o,h,!0),i[h]._subplot=u),u.plot(m,i,o._promises)}}function f(o,i,g,p){for(var y=p._subplots[a]||[],h=0;h<y.length;h++){var m=y[h],u=p[m]._subplot;if(!i[m]&&!!u){u.framework.remove();for(var _ in u.clipPaths)u.clipPaths[_].remove()}}}re.exports={attr:e,name:a,idRoot:a,idRegex:n,attrRegex:n,attributes:r,layoutAttributes:d("./layout_attributes"),supplyLayoutDefaults:d("./layout_defaults"),plot:t,clean:f,toSVG:d("../cartesian").toSVG}},{"../../lib":503,"../cartesian":568,"../get_data":593,"../polar/polar":625,"./constants":627,"./layout_attributes":630,"./layout_defaults":631}],630:[function(d,re,ne){var w=d("../../components/color/attributes"),c=d("../cartesian/layout_attributes"),M=d("../domain").attributes,T=d("../../lib").extendFlat,e=d("../../plot_api/edit_types").overrideAll,a=e({color:c.color,showline:T({},c.showline,{dflt:!0}),linecolor:c.linecolor,linewidth:c.linewidth,showgrid:T({},c.showgrid,{dflt:!0}),gridcolor:c.gridcolor,gridwidth:c.gridwidth},"plot","from-root"),n=e({ticklen:c.ticklen,tickwidth:T({},c.tickwidth,{dflt:2}),tickcolor:c.tickcolor,showticklabels:c.showticklabels,showtickprefix:c.showtickprefix,tickprefix:c.tickprefix,showticksuffix:c.showticksuffix,ticksuffix:c.ticksuffix,tickfont:c.tickfont,tickformat:c.tickformat,hoverformat:c.hoverformat,layer:c.layer},"plot","from-root"),r=T({visible:T({},c.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:T({},c.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},a,n),t=T({visible:T({},c.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:c.ticks,editType:"calc"},a,n);re.exports={domain:M({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:w.background},realaxis:r,imaginaryaxis:t,editType:"calc"}},{"../../components/color/attributes":365,"../../lib":503,"../../plot_api/edit_types":536,"../cartesian/layout_attributes":569,"../domain":584}],631:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/color"),M=d("../../plot_api/plot_template"),T=d("../subplot_defaults"),e=d("../get_data").getSubplotData,a=d("../cartesian/prefix_suffix_defaults"),n=d("../cartesian/tick_label_defaults"),r=d("../cartesian/line_grid_defaults"),t=d("../cartesian/set_convert"),f=d("./layout_attributes"),o=d("./constants"),i=o.axisNames,g=y(function(h){return h.slice().reverse().map(function(m){return-m}).concat([0]).concat(h)},String);function p(h,m,u,_){var s=u("bgcolor");_.bgColor=c.combine(s,_.paper_bgcolor);var A=e(_.fullData,o.name,_.id),x=_.layoutOut,v;function b(G,J){return u(v+"."+G,J)}for(var l=0;l<i.length;l++){v=i[l],w.isPlainObject(h[v])||(h[v]={});var L=h[v],S=M.newContainer(m,v);S._id=S._name=v,S._attr=_.id+"."+v,S._traceIndices=A.map(function(G){return G._expandedIndex});var k=b("visible");if(S.type="linear",t(S,x),a(L,S,b,S.type),k){var P=v==="realaxis";if(P&&b("side"),P)b("tickvals");else{var z=g(m.realaxis.tickvals||f.realaxis.tickvals.dflt);b("tickvals",z)}var I,D,R,B,F=_.font||{};k&&(I=b("color"),D=I===L.color?I:F.color,R=F.size,B=F.family),n(L,S,b,S.type,{noTicklabelstep:!0,noAng:!P,noExp:!0,font:{color:D,size:R,family:B}}),w.coerce2(h,m,f,v+".ticklen"),w.coerce2(h,m,f,v+".tickwidth"),w.coerce2(h,m,f,v+".tickcolor",m.color);var V=b("ticks");V||(delete m[v].ticklen,delete m[v].tickwidth,delete m[v].tickcolor),r(L,S,b,{dfltColor:I,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:f[v]}),b("layer")}b("hoverformat"),delete S.type,S._input=L}}re.exports=function(m,u,_){T(m,u,_,{noUirevision:!0,type:o.name,attributes:f,handleDefaults:p,font:u.font,paper_bgcolor:u.paper_bgcolor,fullData:_,layoutOut:u})};function y(h,m){var u={};return function(_){var s=m?m(_):_;if(s in u)return u[s];var A=h(_);return u[s]=A,A}}},{"../../components/color":366,"../../lib":503,"../../plot_api/plot_template":543,"../cartesian/line_grid_defaults":571,"../cartesian/prefix_suffix_defaults":573,"../cartesian/set_convert":576,"../cartesian/tick_label_defaults":578,"../get_data":593,"../subplot_defaults":632,"./constants":627,"./layout_attributes":630}],632:[function(d,re,ne){var w=d("../lib"),c=d("../plot_api/plot_template"),M=d("./domain").defaults;re.exports=function(e,a,n,r){var t=r.type,f=r.attributes,o=r.handleDefaults,i=r.partition||"x",g=a._subplots[t],p=g.length,y=p&&g[0].replace(/\d+$/,""),h,m;function u(x,v){return w.coerce(h,m,f,x,v)}for(var _=0;_<p;_++){var s=g[_];e[s]?h=e[s]:h=e[s]={},m=c.newContainer(a,s,y),r.noUirevision||u("uirevision",a.uirevision);var A={};A[i]=[_/p,(_+1)/p],M(m,a,u,A),r.id=s,o(h,m,u,r)}}},{"../lib":503,"../plot_api/plot_template":543,"./domain":584}],633:[function(d,re,ne){var w=d("../constants/docs");w.FORMAT_LINK,w.DATE_FORMAT_LINK;function c(M){var T=M.description?" "+M.description:"",e=M.keys||[];if(e.length>0){for(var a=[],n=0;n<e.length;n++)a[n]="`"+e[n]+"`";T=T+"Finally, the template string has access to ",e.length===1?T="variable "+a[0]:T="variables "+a.slice(0,-1).join(", ")+" and "+a.slice(-1)+"."}return T}ne.hovertemplateAttrs=function(M,T){M=M||{},T=T||{},c(T);var e={valType:"string",dflt:"",editType:M.editType||"none"};return M.arrayOk!==!1&&(e.arrayOk=!0),e},ne.texttemplateAttrs=function(M,T){M=M||{},T=T||{},c(T);var e={valType:"string",dflt:"",editType:M.editType||"calc"};return M.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":474}],634:[function(d,re,ne){var w=d("./ternary"),c=d("../../plots/get_data").getSubplotCalcData,M=d("../../lib").counterRegex,T="ternary";ne.name=T;var e=ne.attr="subplot";ne.idRoot=T,ne.idRegex=ne.attrRegex=M(T);var a=ne.attributes={};a[e]={valType:"subplotid",dflt:"ternary",editType:"calc"},ne.layoutAttributes=d("./layout_attributes"),ne.supplyLayoutDefaults=d("./layout_defaults"),ne.plot=function(r){for(var t=r._fullLayout,f=r.calcdata,o=t._subplots[T],i=0;i<o.length;i++){var g=o[i],p=c(f,T,g),y=t[g]._subplot;y||(y=new w({id:g,graphDiv:r,container:t._ternarylayer.node()},t),t[g]._subplot=y),y.plot(p,t,r._promises)}},ne.clean=function(n,r,t,f){for(var o=f._subplots[T]||[],i=0;i<o.length;i++){var g=o[i],p=f[g]._subplot;!r[g]&&!!p&&(p.plotContainer.remove(),p.clipDef.remove(),p.clipDefRelative.remove(),p.layers["a-title"].remove(),p.layers["b-title"].remove(),p.layers["c-title"].remove())}}},{"../../lib":503,"../../plots/get_data":593,"./layout_attributes":635,"./layout_defaults":636,"./ternary":637}],635:[function(d,re,ne){var w=d("../../components/color/attributes"),c=d("../domain").attributes,M=d("../cartesian/layout_attributes"),T=d("../../plot_api/edit_types").overrideAll,e=d("../../lib/extend").extendFlat,a={title:{text:M.title.text,font:M.title.font},color:M.color,tickmode:M.tickmode,nticks:e({},M.nticks,{dflt:6,min:1}),tick0:M.tick0,dtick:M.dtick,tickvals:M.tickvals,ticktext:M.ticktext,ticks:M.ticks,ticklen:M.ticklen,tickwidth:M.tickwidth,tickcolor:M.tickcolor,ticklabelstep:M.ticklabelstep,showticklabels:M.showticklabels,showtickprefix:M.showtickprefix,tickprefix:M.tickprefix,showticksuffix:M.showticksuffix,ticksuffix:M.ticksuffix,showexponent:M.showexponent,exponentformat:M.exponentformat,minexponent:M.minexponent,separatethousands:M.separatethousands,tickfont:M.tickfont,tickangle:M.tickangle,tickformat:M.tickformat,tickformatstops:M.tickformatstops,hoverformat:M.hoverformat,showline:e({},M.showline,{dflt:!0}),linecolor:M.linecolor,linewidth:M.linewidth,showgrid:e({},M.showgrid,{dflt:!0}),gridcolor:M.gridcolor,gridwidth:M.gridwidth,layer:M.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:M._deprecated.title,titlefont:M._deprecated.titlefont}},n=re.exports=T({domain:c({name:"ternary"}),bgcolor:{valType:"color",dflt:w.background},sum:{valType:"number",dflt:1,min:0},aaxis:a,baxis:a,caxis:a},"plot","from-root");n.uirevision={valType:"any",editType:"none"},n.aaxis.uirevision=n.baxis.uirevision=n.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":365,"../../lib/extend":493,"../../plot_api/edit_types":536,"../cartesian/layout_attributes":569,"../domain":584}],636:[function(d,re,ne){var w=d("../../components/color"),c=d("../../plot_api/plot_template"),M=d("../../lib"),T=d("../subplot_defaults"),e=d("../cartesian/tick_label_defaults"),a=d("../cartesian/prefix_suffix_defaults"),n=d("../cartesian/tick_mark_defaults"),r=d("../cartesian/tick_value_defaults"),t=d("../cartesian/line_grid_defaults"),f=d("./layout_attributes"),o=["aaxis","baxis","caxis"];re.exports=function(y,h,m){T(y,h,m,{type:"ternary",attributes:f,handleDefaults:i,font:h.font,paper_bgcolor:h.paper_bgcolor})};function i(p,y,h,m){var u=h("bgcolor"),_=h("sum");m.bgColor=w.combine(u,m.paper_bgcolor);for(var s,A,x,v=0;v<o.length;v++)s=o[v],A=p[s]||{},x=c.newContainer(y,s),x._name=s,g(A,x,m,y);var b=y.aaxis,l=y.baxis,L=y.caxis;b.min+l.min+L.min>=_&&(b.min=0,l.min=0,L.min=0,p.aaxis&&delete p.aaxis.min,p.baxis&&delete p.baxis.min,p.caxis&&delete p.caxis.min)}function g(p,y,h,m){var u=f[y._name];function _(S,k){return M.coerce(p,y,u,S,k)}_("uirevision",m.uirevision),y.type="linear";var s=_("color"),A=s!==u.color.dflt?s:h.font.color,x=y._name,v=x.charAt(0).toUpperCase(),b="Component "+v,l=_("title.text",b);y._hovertitle=l===b?l:v,M.coerceFont(_,"title.font",{family:h.font.family,size:M.bigFont(h.font.size),color:A}),_("min"),r(p,y,_,"linear"),a(p,y,_,"linear"),e(p,y,_,"linear"),n(p,y,_,{outerTicks:!0});var L=_("showticklabels");L&&(M.coerceFont(_,"tickfont",{family:h.font.family,size:h.font.size,color:A}),_("tickangle"),_("tickformat")),t(p,y,_,{dfltColor:s,bgColor:h.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:u}),_("hoverformat"),_("layer")}},{"../../components/color":366,"../../lib":503,"../../plot_api/plot_template":543,"../cartesian/line_grid_defaults":571,"../cartesian/prefix_suffix_defaults":573,"../cartesian/tick_label_defaults":578,"../cartesian/tick_mark_defaults":579,"../cartesian/tick_value_defaults":580,"../subplot_defaults":632,"./layout_attributes":635}],637:[function(d,re,ne){var w=d("@plotly/d3"),c=d("tinycolor2"),M=d("../../registry"),T=d("../../lib"),e=T.strTranslate,a=T._,n=d("../../components/color"),r=d("../../components/drawing"),t=d("../cartesian/set_convert"),f=d("../../lib/extend").extendFlat,o=d("../plots"),i=d("../cartesian/axes"),g=d("../../components/dragelement"),p=d("../../components/fx"),y=d("../../components/dragelement/helpers"),h=y.freeMode,m=y.rectMode,u=d("../../components/titles"),_=d("../cartesian/select").prepSelect,s=d("../cartesian/select").selectOnClick,A=d("../cartesian/select").clearSelect,x=d("../cartesian/select").clearSelectionsCache,v=d("../cartesian/constants");function b(F,V){this.id=F.id,this.graphDiv=F.graphDiv,this.init(V),this.makeFramework(V),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}re.exports=b;var l=b.prototype;l.init=function(F){this.container=F._ternarylayer,this.defs=F._defs,this.layoutId=F._uid,this.traceHash={},this.layers={}},l.plot=function(F,V){var G=this,J=V[G.id],j=V._size;G._hasClipOnAxisFalse=!1;for(var Y=0;Y<F.length;Y++){var X=F[Y][0].trace;if(X.cliponaxis===!1){G._hasClipOnAxisFalse=!0;break}}G.updateLayers(J),G.adjustLayout(J,j),o.generalUpdatePerTraceModule(G.graphDiv,G,F,J),G.layers.plotbg.select("path").call(n.fill,J.bgcolor)},l.makeFramework=function(F){var V=this,G=V.graphDiv,J=F[V.id],j=V.clipId="clip"+V.layoutId+V.id,Y=V.clipIdRelative="clip-relative"+V.layoutId+V.id;V.clipDef=T.ensureSingleById(F._clips,"clipPath",j,function(X){X.append("path").attr("d","M0,0Z")}),V.clipDefRelative=T.ensureSingleById(F._clips,"clipPath",Y,function(X){X.append("path").attr("d","M0,0Z")}),V.plotContainer=T.ensureSingle(V.container,"g",V.id),V.updateLayers(J),r.setClipUrl(V.layers.backplot,j,G),r.setClipUrl(V.layers.grids,j,G)},l.updateLayers=function(F){var V=this,G=V.layers,J=["draglayer","plotbg","backplot","grids"];F.aaxis.layer==="below traces"&&J.push("aaxis","aline"),F.baxis.layer==="below traces"&&J.push("baxis","bline"),F.caxis.layer==="below traces"&&J.push("caxis","cline"),J.push("frontplot"),F.aaxis.layer==="above traces"&&J.push("aaxis","aline"),F.baxis.layer==="above traces"&&J.push("baxis","bline"),F.caxis.layer==="above traces"&&J.push("caxis","cline");var j=V.plotContainer.selectAll("g.toplevel").data(J,String),Y=["agrid","bgrid","cgrid"];j.enter().append("g").attr("class",function(X){return"toplevel "+X}).each(function(X){var oe=w.select(this);G[X]=oe,X==="frontplot"?oe.append("g").classed("scatterlayer",!0):X==="backplot"?oe.append("g").classed("maplayer",!0):X==="plotbg"?oe.append("path").attr("d","M0,0Z"):X==="aline"||X==="bline"||X==="cline"?oe.append("path"):X==="grids"&&Y.forEach(function(se){G[se]=oe.append("g").classed("grid "+se,!0)})}),j.order()};var L=Math.sqrt(4/3);l.adjustLayout=function(F,V){var G=this,J=F.domain,j=(J.x[0]+J.x[1])/2,Y=(J.y[0]+J.y[1])/2,X=J.x[1]-J.x[0],oe=J.y[1]-J.y[0],se=X*V.w,ie=oe*V.h,N=F.sum,U=F.aaxis.min,q=F.baxis.min,Q=F.caxis.min,W,Z,ee,te,ae,le;se>L*ie?(te=ie,ee=te*L):(ee=se,te=ee/L),ae=X*ee/se,le=oe*te/ie,W=V.l+V.w*j-ee/2,Z=V.t+V.h*(1-Y)-te/2,G.x0=W,G.y0=Z,G.w=ee,G.h=te,G.sum=N,G.xaxis={type:"linear",range:[U+2*Q-N,N-U-2*q],domain:[j-ae/2,j+ae/2],_id:"x"},t(G.xaxis,G.graphDiv._fullLayout),G.xaxis.setScale(),G.xaxis.isPtWithinRange=function(Le){return Le.a>=G.aaxis.range[0]&&Le.a<=G.aaxis.range[1]&&Le.b>=G.baxis.range[1]&&Le.b<=G.baxis.range[0]&&Le.c>=G.caxis.range[1]&&Le.c<=G.caxis.range[0]},G.yaxis={type:"linear",range:[U,N-q-Q],domain:[Y-le/2,Y+le/2],_id:"y"},t(G.yaxis,G.graphDiv._fullLayout),G.yaxis.setScale(),G.yaxis.isPtWithinRange=function(){return!0};var ye=G.yaxis.domain[0],fe=G.aaxis=f({},F.aaxis,{range:[U,N-q-Q],side:"left",tickangle:(+F.aaxis.tickangle||0)-30,domain:[ye,ye+le*L],anchor:"free",position:0,_id:"y",_length:ee});t(fe,G.graphDiv._fullLayout),fe.setScale();var pe=G.baxis=f({},F.baxis,{range:[N-U-Q,q],side:"bottom",domain:G.xaxis.domain,anchor:"free",position:0,_id:"x",_length:ee});t(pe,G.graphDiv._fullLayout),pe.setScale();var ge=G.caxis=f({},F.caxis,{range:[N-U-q,Q],side:"right",tickangle:(+F.caxis.tickangle||0)+30,domain:[ye,ye+le*L],anchor:"free",position:0,_id:"y",_length:ee});t(ge,G.graphDiv._fullLayout),ge.setScale();var Ae="M"+W+","+(Z+te)+"h"+ee+"l-"+ee/2+",-"+te+"Z";G.clipDef.select("path").attr("d",Ae),G.layers.plotbg.select("path").attr("d",Ae);var we="M0,"+te+"h"+ee+"l-"+ee/2+",-"+te+"Z";G.clipDefRelative.select("path").attr("d",we);var De=e(W,Z);G.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",De),G.clipDefRelative.select("path").attr("transform",null);var Be=e(W-pe._offset,Z+te);G.layers.baxis.attr("transform",Be),G.layers.bgrid.attr("transform",Be);var Ve=e(W+ee/2,Z)+"rotate(30)"+e(0,-fe._offset);G.layers.aaxis.attr("transform",Ve),G.layers.agrid.attr("transform",Ve);var xe=e(W+ee/2,Z)+"rotate(-30)"+e(0,-ge._offset);G.layers.caxis.attr("transform",xe),G.layers.cgrid.attr("transform",xe),G.drawAxes(!0),G.layers.aline.select("path").attr("d",fe.showline?"M"+W+","+(Z+te)+"l"+ee/2+",-"+te:"M0,0").call(n.stroke,fe.linecolor||"#000").style("stroke-width",(fe.linewidth||0)+"px"),G.layers.bline.select("path").attr("d",pe.showline?"M"+W+","+(Z+te)+"h"+ee:"M0,0").call(n.stroke,pe.linecolor||"#000").style("stroke-width",(pe.linewidth||0)+"px"),G.layers.cline.select("path").attr("d",ge.showline?"M"+(W+ee/2)+","+Z+"l"+ee/2+","+te:"M0,0").call(n.stroke,ge.linecolor||"#000").style("stroke-width",(ge.linewidth||0)+"px"),G.graphDiv._context.staticPlot||G.initInteractions(),r.setClipUrl(G.layers.frontplot,G._hasClipOnAxisFalse?null:G.clipId,G.graphDiv)},l.drawAxes=function(F){var V=this,G=V.graphDiv,J=V.id.substr(7)+"title",j=V.layers,Y=V.aaxis,X=V.baxis,oe=V.caxis;if(V.drawAx(Y),V.drawAx(X),V.drawAx(oe),F){var se=Math.max(Y.showticklabels?Y.tickfont.size/2:0,(oe.showticklabels?oe.tickfont.size*.75:0)+(oe.ticks==="outside"?oe.ticklen*.87:0)),ie=(X.showticklabels?X.tickfont.size:0)+(X.ticks==="outside"?X.ticklen:0)+3;j["a-title"]=u.draw(G,"a"+J,{propContainer:Y,propName:V.id+".aaxis.title",placeholder:a(G,"Click to enter Component A title"),attributes:{x:V.x0+V.w/2,y:V.y0-Y.title.font.size/3-se,"text-anchor":"middle"}}),j["b-title"]=u.draw(G,"b"+J,{propContainer:X,propName:V.id+".baxis.title",placeholder:a(G,"Click to enter Component B title"),attributes:{x:V.x0-ie,y:V.y0+V.h+X.title.font.size*.83+ie,"text-anchor":"middle"}}),j["c-title"]=u.draw(G,"c"+J,{propContainer:oe,propName:V.id+".caxis.title",placeholder:a(G,"Click to enter Component C title"),attributes:{x:V.x0+V.w+ie,y:V.y0+V.h+oe.title.font.size*.83+ie,"text-anchor":"middle"}})}},l.drawAx=function(F){var V=this,G=V.graphDiv,J=F._name,j=J.charAt(0),Y=F._id,X=V.layers[J],oe=30,se=j+"tickLayout",ie=S(F);V[se]!==ie&&(X.selectAll("."+Y+"tick").remove(),V[se]=ie),F.setScale();var N=i.calcTicks(F),U=i.clipEnds(F,N),q=i.makeTransTickFn(F),Q=i.getTickSigns(F)[2],W=T.deg2rad(oe),Z=Q*(F.linewidth||1)/2,ee=Q*F.ticklen,te=V.w,ae=V.h,le=j==="b"?"M0,"+Z+"l"+Math.sin(W)*ee+","+Math.cos(W)*ee:"M"+Z+",0l"+Math.cos(W)*ee+","+-Math.sin(W)*ee,ye={a:"M0,0l"+ae+",-"+te/2,b:"M0,0l-"+te/2+",-"+ae,c:"M0,0l-"+ae+","+te/2}[j];i.drawTicks(G,F,{vals:F.ticks==="inside"?U:N,layer:X,path:le,transFn:q,crisp:!1}),i.drawGrid(G,F,{vals:U,layer:V.layers[j+"grid"],path:ye,transFn:q,crisp:!1}),i.drawLabels(G,F,{vals:N,layer:X,transFn:q,labelFns:i.makeLabelFns(F,0,oe)})};function S(F){return F.ticks+String(F.ticklen)+String(F.showticklabels)}var k=v.MINZOOM/2+.87,P="m-0.87,.5h"+k+"v3h-"+(k+5.2)+"l"+(k/2+2.6)+",-"+(k*.87+4.5)+"l2.6,1.5l-"+k/2+","+k*.87+"Z",z="m0.87,.5h-"+k+"v3h"+(k+5.2)+"l-"+(k/2+2.6)+",-"+(k*.87+4.5)+"l-2.6,1.5l"+k/2+","+k*.87+"Z",I="m0,1l"+k/2+","+k*.87+"l2.6,-1.5l-"+(k/2+2.6)+",-"+(k*.87+4.5)+"l-"+(k/2+2.6)+","+(k*.87+4.5)+"l2.6,1.5l"+k/2+",-"+k*.87+"Z",D="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z",R=!0;l.clearSelect=function(){x(this.dragOptions),A(this.dragOptions.gd)},l.initInteractions=function(){var F=this,V=F.layers.plotbg.select("path").node(),G=F.graphDiv,J=G._fullLayout._zoomlayer,j,Y;this.dragOptions={element:V,gd:G,plotinfo:{id:F.id,domain:G._fullLayout[F.id].domain,xaxis:F.xaxis,yaxis:F.yaxis},subplot:F.id,prepFn:function(Be,Ve,xe){F.dragOptions.xaxes=[F.xaxis],F.dragOptions.yaxes=[F.yaxis],j=G._fullLayout._invScaleX,Y=G._fullLayout._invScaleY;var Le=F.dragOptions.dragmode=G._fullLayout.dragmode;h(Le)?F.dragOptions.minDrag=1:F.dragOptions.minDrag=void 0,Le==="zoom"?(F.dragOptions.moveFn=pe,F.dragOptions.clickFn=te,F.dragOptions.doneFn=ge,ae(Be,Ve,xe)):Le==="pan"?(F.dragOptions.moveFn=we,F.dragOptions.clickFn=te,F.dragOptions.doneFn=De,Ae(),F.clearSelect(G)):(m(Le)||h(Le))&&_(Be,Ve,xe,F.dragOptions,Le)}};var X,oe,se,ie,N,U,q,Q,W,Z;function ee(Be){var Ve={};return Ve[F.id+".aaxis.min"]=Be.a,Ve[F.id+".baxis.min"]=Be.b,Ve[F.id+".caxis.min"]=Be.c,Ve}function te(Be,Ve){var xe=G._fullLayout.clickmode;B(G),Be===2&&(G.emit("plotly_doubleclick",null),M.call("_guiRelayout",G,ee({a:0,b:0,c:0}))),xe.indexOf("select")>-1&&Be===1&&s(Ve,G,[F.xaxis],[F.yaxis],F.id,F.dragOptions),xe.indexOf("event")>-1&&p.click(G,Ve,F.id)}function ae(Be,Ve,xe){var Le=V.getBoundingClientRect();X=Ve-Le.left,oe=xe-Le.top,G._fullLayout._calcInverseTransform(G);var He=G._fullLayout._invTransform,Je=T.apply3DTransform(He)(X,oe);X=Je[0],oe=Je[1],se={a:F.aaxis.range[0],b:F.baxis.range[1],c:F.caxis.range[1]},N=se,ie=F.aaxis.range[1]-se.a,U=c(F.graphDiv._fullLayout[F.id].bgcolor).getLuminance(),q="M0,"+F.h+"L"+F.w/2+", 0L"+F.w+","+F.h+"Z",Q=!1,W=J.append("path").attr("class","zoombox").attr("transform",e(F.x0,F.y0)).style({fill:U>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",q),Z=J.append("path").attr("class","zoombox-corners").attr("transform",e(F.x0,F.y0)).style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),F.clearSelect(G)}function le(Be,Ve){return 1-Ve/F.h}function ye(Be,Ve){return 1-(Be+(F.h-Ve)/Math.sqrt(3))/F.w}function fe(Be,Ve){return(Be-(F.h-Ve)/Math.sqrt(3))/F.w}function pe(Be,Ve){var xe=X+Be*j,Le=oe+Ve*Y,He=Math.max(0,Math.min(1,le(X,oe),le(xe,Le))),Je=Math.max(0,Math.min(1,ye(X,oe),ye(xe,Le))),Oe=Math.max(0,Math.min(1,fe(X,oe),fe(xe,Le))),Pe=(He/2+Oe)*F.w,Ue=(1-He/2-Je)*F.w,vt=(Pe+Ue)/2,Lt=Ue-Pe,Yt=(1-He)*F.h,At=Yt-Lt/L;Lt<v.MINZOOM?(N=se,W.attr("d",q),Z.attr("d","M0,0Z")):(N={a:se.a+He*ie,b:se.b+Je*ie,c:se.c+Oe*ie},W.attr("d",q+"M"+Pe+","+Yt+"H"+Ue+"L"+vt+","+At+"L"+Pe+","+Yt+"Z"),Z.attr("d","M"+X+","+oe+D+"M"+Pe+","+Yt+P+"M"+Ue+","+Yt+z+"M"+vt+","+At+I)),Q||(W.transition().style("fill",U>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),Z.transition().style("opacity",1).duration(200),Q=!0),G.emit("plotly_relayouting",ee(N))}function ge(){B(G),N!==se&&(M.call("_guiRelayout",G,ee(N)),R&&G.data&&G._context.showTips&&(T.notifier(a(G,"Double-click to zoom back out"),"long"),R=!1))}function Ae(){se={a:F.aaxis.range[0],b:F.baxis.range[1],c:F.caxis.range[1]},N=se}function we(Be,Ve){var xe=Be/F.xaxis._m,Le=Ve/F.yaxis._m;N={a:se.a-Le,b:se.b+(xe+Le)/2,c:se.c-(xe-Le)/2};var He=[N.a,N.b,N.c].sort(T.sorterAsc),Je={a:He.indexOf(N.a),b:He.indexOf(N.b),c:He.indexOf(N.c)};He[0]<0&&(He[1]+He[0]/2<0?(He[2]+=He[0]+He[1],He[0]=He[1]=0):(He[2]+=He[0]/2,He[1]+=He[0]/2,He[0]=0),N={a:He[Je.a],b:He[Je.b],c:He[Je.c]},Ve=(se.a-N.a)*F.yaxis._m,Be=(se.c-N.c-se.b+N.b)*F.xaxis._m);var Oe=e(F.x0+Be,F.y0+Ve);F.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Oe);var Pe=e(-Be,-Ve);F.clipDefRelative.select("path").attr("transform",Pe),F.aaxis.range=[N.a,F.sum-N.b-N.c],F.baxis.range=[F.sum-N.a-N.c,N.b],F.caxis.range=[F.sum-N.a-N.b,N.c],F.drawAxes(!1),F._hasClipOnAxisFalse&&F.plotContainer.select(".scatterlayer").selectAll(".trace").call(r.hideOutsideRangePoints,F),G.emit("plotly_relayouting",ee(N))}function De(){M.call("_guiRelayout",G,ee(N))}V.onmousemove=function(Be){p.hover(G,Be,F.id),G._fullLayout._lasthover=V,G._fullLayout._hoversubplot=F.id},V.onmouseout=function(Be){G._dragging||g.unhover(G,Be)},g.init(this.dragOptions)};function B(F){w.select(F).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}},{"../../components/color":366,"../../components/dragelement":385,"../../components/dragelement/helpers":384,"../../components/drawing":388,"../../components/fx":406,"../../components/titles":464,"../../lib":503,"../../lib/extend":493,"../../registry":638,"../cartesian/axes":554,"../cartesian/constants":561,"../cartesian/select":575,"../cartesian/set_convert":576,"../plots":619,"@plotly/d3":58,tinycolor2:312}],638:[function(d,re,ne){var w=d("./lib/loggers"),c=d("./lib/noop"),M=d("./lib/push_unique"),T=d("./lib/is_plain_object"),e=d("./lib/dom").addStyleRule,a=d("./lib/extend"),n=d("./plots/attributes"),r=d("./plots/layout_attributes"),t=a.extendFlat,f=a.extendDeepAll;ne.modules={},ne.allCategories={},ne.allTypes=[],ne.subplotsRegistry={},ne.transformsRegistry={},ne.componentsRegistry={},ne.layoutArrayContainers=[],ne.layoutArrayRegexes=[],ne.traceLayoutAttributes={},ne.localeRegistry={},ne.apiMethodRegistry={},ne.collectableSubplotTypes=null,ne.register=function(x){if(ne.collectableSubplotTypes=null,x)x&&!Array.isArray(x)&&(x=[x]);else throw new Error("No argument passed to Plotly.register.");for(var v=0;v<x.length;v++){var b=x[v];if(!b)throw new Error("Invalid module was attempted to be registered!");switch(b.moduleType){case"trace":o(b);break;case"transform":p(b);break;case"component":g(b);break;case"locale":y(b);break;case"apiMethod":var l=b.name;ne.apiMethodRegistry[l]=b.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},ne.getModule=function(A){var x=ne.modules[s(A)];return x?x._module:!1},ne.traceIs=function(A,x){if(A=s(A),A==="various")return!1;var v=ne.modules[A];return v||(A&&w.log("Unrecognized trace type "+A+"."),v=ne.modules[n.type.dflt]),!!v.categories[x]},ne.getTransformIndices=function(A,x){for(var v=[],b=A.transforms||[],l=0;l<b.length;l++)b[l].type===x&&v.push(l);return v},ne.hasTransform=function(A,x){for(var v=A.transforms||[],b=0;b<v.length;b++)if(v[b].type===x)return!0;return!1},ne.getComponentMethod=function(A,x){var v=ne.componentsRegistry[A];return v&&v[x]||c},ne.call=function(){var A=arguments[0],x=[].slice.call(arguments,1);return ne.apiMethodRegistry[A].apply(null,x)};function o(A){var x=A.name,v=A.categories,b=A.meta;if(ne.modules[x]){w.log("Type "+x+" already registered");return}ne.subplotsRegistry[A.basePlotModule.name]||i(A.basePlotModule);for(var l={},L=0;L<v.length;L++)l[v[L]]=!0,ne.allCategories[v[L]]=!0;ne.modules[x]={_module:A,categories:l},b&&Object.keys(b).length&&(ne.modules[x].meta=b),ne.allTypes.push(x);for(var S in ne.componentsRegistry)m(S,x);A.layoutAttributes&&t(ne.traceLayoutAttributes,A.layoutAttributes);var k=A.basePlotModule,P=k.name;if(P==="mapbox"){var z=k.constants.styleRules;for(var I in z)e(".js-plotly-plot .plotly .mapboxgl-"+I,z[I])}(P==="geo"||P==="mapbox")&&typeof window!==void 0&&window.PlotlyGeoAssets===void 0&&(window.PlotlyGeoAssets={topojson:{}})}function i(A){var x=A.name;if(ne.subplotsRegistry[x]){w.log("Plot type "+x+" already registered.");return}h(A),ne.subplotsRegistry[x]=A;for(var v in ne.componentsRegistry)_(v,A.name)}function g(A){if(typeof A.name!="string")throw new Error("Component module *name* must be a string.");var x=A.name;ne.componentsRegistry[x]=A,A.layoutAttributes&&(A.layoutAttributes._isLinkedToArray&&M(ne.layoutArrayContainers,x),h(A));for(var v in ne.modules)m(x,v);for(var b in ne.subplotsRegistry)_(x,b);for(var l in ne.transformsRegistry)u(x,l);A.schema&&A.schema.layout&&f(r,A.schema.layout)}function p(A){if(typeof A.name!="string")throw new Error("Transform module *name* must be a string.");var x="Transform module "+A.name,v=typeof A.transform=="function",b=typeof A.calcTransform=="function";if(!v&&!b)throw new Error(x+" is missing a *transform* or *calcTransform* method.");v&&b&&w.log([x+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),T(A.attributes)||w.log(x+" registered without an *attributes* object."),typeof A.supplyDefaults!="function"&&w.log(x+" registered without a *supplyDefaults* method."),ne.transformsRegistry[A.name]=A;for(var l in ne.componentsRegistry)u(l,A.name)}function y(A){var x=A.name,v=x.split("-")[0],b=A.dictionary,l=A.format,L=b&&Object.keys(b).length,S=l&&Object.keys(l).length,k=ne.localeRegistry,P=k[x];if(P||(k[x]=P={}),v!==x){var z=k[v];z||(k[v]=z={}),L&&z.dictionary===P.dictionary&&(z.dictionary=b),S&&z.format===P.format&&(z.format=l)}L&&(P.dictionary=b),S&&(P.format=l)}function h(A){if(A.layoutAttributes){var x=A.layoutAttributes._arrayAttrRegexps;if(x)for(var v=0;v<x.length;v++)M(ne.layoutArrayRegexes,x[v])}}function m(A,x){var v=ne.componentsRegistry[A].schema;if(!(!v||!v.traces)){var b=v.traces[x];b&&f(ne.modules[x]._module.attributes,b)}}function u(A,x){var v=ne.componentsRegistry[A].schema;if(!(!v||!v.transforms)){var b=v.transforms[x];b&&f(ne.transformsRegistry[x].attributes,b)}}function _(A,x){var v=ne.componentsRegistry[A].schema;if(!(!v||!v.subplots)){var b=ne.subplotsRegistry[x],l=b.layoutAttributes,L=b.attr==="subplot"?b.name:b.attr;Array.isArray(L)&&(L=L[0]);var S=v.subplots[L];l&&S&&f(l,S)}}function s(A){return typeof A=="object"&&(A=A.type),A}},{"./lib/dom":491,"./lib/extend":493,"./lib/is_plain_object":504,"./lib/loggers":507,"./lib/noop":512,"./lib/push_unique":518,"./plots/attributes":550,"./plots/layout_attributes":610}],639:[function(d,re,ne){var w=d("../registry"),c=d("../lib"),M=c.extendFlat,T=c.extendDeep;function e(n){var r;switch(n){case"themes__thumb":r={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":r={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:r={}}return r}function a(n){var r=["xaxis","yaxis","zaxis"];return r.indexOf(n.slice(0,5))>-1}re.exports=function(r,t){var f,o=r.data,i=r.layout,g=T([],o),p=T({},i,e(t.tileClass)),y=r._context||{};if(t.width&&(p.width=t.width),t.height&&(p.height=t.height),t.tileClass==="thumbnail"||t.tileClass==="themes__thumb"){p.annotations=[];var h=Object.keys(p);for(f=0;f<h.length;f++)a(h[f])&&(p[h[f]].title={text:""});for(f=0;f<g.length;f++){var m=g[f];m.showscale=!1,m.marker&&(m.marker.showscale=!1),w.traceIs(m,"pie-like")&&(m.textposition="none")}}if(Array.isArray(t.annotations))for(f=0;f<t.annotations.length;f++)p.annotations.push(t.annotations[f]);var u=Object.keys(p).filter(function(v){return v.match(/^scene\d*$/)});if(u.length){var _={};for(t.tileClass==="thumbnail"&&(_={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),f=0;f<u.length;f++){var s=p[u[f]];s.xaxis||(s.xaxis={}),s.yaxis||(s.yaxis={}),s.zaxis||(s.zaxis={}),M(s.xaxis,_),M(s.yaxis,_),M(s.zaxis,_),s._scene=null}}var A=document.createElement("div");t.tileClass&&(A.className=t.tileClass);var x={gd:A,td:A,layout:p,data:g,config:{staticPlot:t.staticPlot===void 0?!0:t.staticPlot,plotGlPixelRatio:t.plotGlPixelRatio===void 0?2:t.plotGlPixelRatio,displaylogo:t.displaylogo||!1,showLink:t.showLink||!1,showTips:t.showTips||!1,mapboxAccessToken:y.mapboxAccessToken}};return t.setBackground!=="transparent"&&(x.config.setBackground=t.setBackground||"opaque"),x.gd.defaultLayout=e(t.tileClass),x}},{"../lib":503,"../registry":638}],640:[function(d,re,ne){var w=d("../lib"),c=d("../plot_api/to_image"),M=d("./filesaver"),T=d("./helpers");function e(a,n){var r;return w.isPlainObject(a)||(r=w.getGraphDiv(a)),n=n||{},n.format=n.format||"png",n.width=n.width||null,n.height=n.height||null,n.imageDataOnly=!0,new Promise(function(t,f){r&&r._snapshotInProgress&&f(new Error("Snapshotting already in progress.")),w.isIE()&&n.format!=="svg"&&f(new Error(T.MSG_IE_BAD_FORMAT)),r&&(r._snapshotInProgress=!0);var o=c(a,n),i=n.filename||a.fn||"newplot";i+="."+n.format.replace("-","."),o.then(function(g){return r&&(r._snapshotInProgress=!1),M(g,i,n.format)}).then(function(g){t(g)}).catch(function(g){r&&(r._snapshotInProgress=!1),f(g)})})}re.exports=e},{"../lib":503,"../plot_api/to_image":546,"./filesaver":641,"./helpers":642}],641:[function(d,re,ne){var w=d("../lib"),c=d("./helpers");function M(T,e,a){var n=document.createElement("a"),r="download"in n,t=new Promise(function(f,o){var i,g;if(w.isIE())return i=c.createBlob(T,"svg"),window.navigator.msSaveBlob(i,e),i=null,f(e);if(r)return i=c.createBlob(T,a),g=c.createObjectURL(i),n.href=g,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),c.revokeObjectURL(g),i=null,f(e);if(w.isSafari()){var p=a==="svg"?",":";base64,";return c.octetStream(p+encodeURIComponent(T)),f(e)}o(new Error("download error"))});return t}re.exports=M},{"../lib":503,"./helpers":642}],642:[function(d,re,ne){var w=d("../registry");ne.getDelay=function(T){return T._has&&(T._has("gl3d")||T._has("gl2d")||T._has("mapbox"))?500:0},ne.getRedrawFunc=function(T){return function(){w.getComponentMethod("colorbar","draw")(T)}},ne.encodeSVG=function(T){return"data:image/svg+xml,"+encodeURIComponent(T)},ne.encodeJSON=function(T){return"data:application/json,"+encodeURIComponent(T)};var c=window.URL||window.webkitURL;ne.createObjectURL=function(T){return c.createObjectURL(T)},ne.revokeObjectURL=function(T){return c.revokeObjectURL(T)},ne.createBlob=function(T,e){if(e==="svg")return new window.Blob([T],{type:"image/svg+xml;charset=utf-8"});if(e==="full-json")return new window.Blob([T],{type:"application/json;charset=utf-8"});var a=M(window.atob(T));return new window.Blob([a],{type:"image/"+e})},ne.octetStream=function(T){document.location.href="data:application/octet-stream"+T};function M(T){for(var e=T.length,a=new ArrayBuffer(e),n=new Uint8Array(a),r=0;r<e;r++)n[r]=T.charCodeAt(r);return a}ne.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,ne.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":638}],643:[function(d,re,ne){var w=d("./helpers"),c={getDelay:w.getDelay,getRedrawFunc:w.getRedrawFunc,clone:d("./cloneplot"),toSVG:d("./tosvg"),svgToImg:d("./svgtoimg"),toImage:d("./toimage"),downloadImage:d("./download")};re.exports=c},{"./cloneplot":639,"./download":640,"./helpers":642,"./svgtoimg":644,"./toimage":645,"./tosvg":646}],644:[function(d,re,ne){var w=d("../lib"),c=d("events").EventEmitter,M=d("./helpers");function T(e){var a=e.emitter||new c,n=new Promise(function(r,t){var f=window.Image,o=e.svg,i=e.format||"png";if(w.isIE()&&i!=="svg"){var g=new Error(M.MSG_IE_BAD_FORMAT);return t(g),e.promise?n:a.emit("error",g)}var p=e.canvas,y=e.scale||1,h=e.width||300,m=e.height||150,u=y*h,_=y*m,s=p.getContext("2d"),A=new f,x,v;i==="svg"||w.isSafari()?v=M.encodeSVG(o):(x=M.createBlob(o,"svg"),v=M.createObjectURL(x)),p.width=u,p.height=_,A.onload=function(){var b;switch(x=null,M.revokeObjectURL(v),i!=="svg"&&s.drawImage(A,0,0,u,_),i){case"jpeg":b=p.toDataURL("image/jpeg");break;case"png":b=p.toDataURL("image/png");break;case"webp":b=p.toDataURL("image/webp");break;case"svg":b=v;break;default:var l="Image format is not jpeg, png, svg or webp.";if(t(new Error(l)),!e.promise)return a.emit("error",l)}r(b),e.promise||a.emit("success",b)},A.onerror=function(b){if(x=null,M.revokeObjectURL(v),t(b),!e.promise)return a.emit("error",b)},A.src=v});return e.promise?n:a}re.exports=T},{"../lib":503,"./helpers":642,events:84}],645:[function(d,re,ne){var w=d("events").EventEmitter,c=d("../registry"),M=d("../lib"),T=d("./helpers"),e=d("./cloneplot"),a=d("./tosvg"),n=d("./svgtoimg");function r(t,f){var o=new w,i=e(t,{format:"png"}),g=i.gd;g.style.position="absolute",g.style.left="-5000px",document.body.appendChild(g);function p(){var h=T.getDelay(g._fullLayout);setTimeout(function(){var m=a(g),u=document.createElement("canvas");u.id=M.randstr(),o=n({format:f.format,width:g._fullLayout.width,height:g._fullLayout.height,canvas:u,emitter:o,svg:m}),o.clean=function(){g&&document.body.removeChild(g)}},h)}var y=T.getRedrawFunc(g);return c.call("_doPlot",g,i.data,i.layout,i.config).then(y).then(p).catch(function(h){o.emit("error",h)}),o}re.exports=r},{"../lib":503,"../registry":638,"./cloneplot":639,"./helpers":642,"./svgtoimg":644,"./tosvg":646,events:84}],646:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../lib"),M=d("../components/drawing"),T=d("../components/color"),e=d("../constants/xmlns_namespaces"),a=/"/g,n="TOBESTRIPPED",r=new RegExp('("'+n+")|("+n+'")',"g");function t(o){var i=w.select("body").append("div").style({display:"none"}).html(""),g=o.replace(/(&[^;]*;)/gi,function(p){return p==="&lt;"?"&#60;":p==="&rt;"?"&#62;":p.indexOf("<")!==-1||p.indexOf(">")!==-1?"":i.html(p).text()});return i.remove(),g}function f(o){return o.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}re.exports=function(i,g,p){var y=i._fullLayout,h=y._paper,m=y._toppaper,u=y.width,_=y.height,s;h.insert("rect",":first-child").call(M.setRect,0,0,u,_).call(T.fill,y.paper_bgcolor);var A=y._basePlotModules||[];for(s=0;s<A.length;s++){var x=A[s];x.toSVG&&x.toSVG(i)}if(m){var v=m.node().childNodes,b=Array.prototype.slice.call(v);for(s=0;s<b.length;s++){var l=b[s];l.childNodes.length&&h.node().appendChild(l)}}y._draggers&&y._draggers.remove(),h.node().style.background="",h.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var S=w.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){S.remove();return}else S.style({visibility:null,display:null});var k=this.style.fontFamily;k&&k.indexOf('"')!==-1&&S.style("font-family",k.replace(a,n))}),h.selectAll(".gradient_filled,.pattern_filled").each(function(){var S=w.select(this),k=this.style.fill;k&&k.indexOf("url(")!==-1&&S.style("fill",k.replace(a,n));var P=this.style.stroke;P&&P.indexOf("url(")!==-1&&S.style("stroke",P.replace(a,n))}),(g==="pdf"||g==="eps")&&h.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),h.node().setAttributeNS(e.xmlns,"xmlns",e.svg),h.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),g==="svg"&&p&&(h.attr("width",p*u),h.attr("height",p*_),h.attr("viewBox","0 0 "+u+" "+_));var L=new window.XMLSerializer().serializeToString(h.node());return L=t(L),L=f(L),L=L.replace(r,"'"),c.isIE()&&(L=L.replace(/"/gi,"'"),L=L.replace(/(\('#)([^']*)('\))/gi,'("#$2")'),L=L.replace(/(\\')/gi,'"')),L}},{"../components/color":366,"../components/drawing":388,"../constants/xmlns_namespaces":480,"../lib":503,"@plotly/d3":58}],647:[function(d,re,ne){var w=d("../../lib");re.exports=function(M,T){for(var e=0;e<M.length;e++)M[e].i=e;w.mergeArray(T.text,M,"tx"),w.mergeArray(T.hovertext,M,"htx");var a=T.marker;if(a){w.mergeArray(a.opacity,M,"mo",!0),w.mergeArray(a.color,M,"mc");var n=a.line;n&&(w.mergeArray(n.color,M,"mlc"),w.mergeArrayCastPositive(n.width,M,"mlw"))}}},{"../../lib":503}],648:[function(d,re,ne){var w=d("../scatter/attributes"),c=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,T=d("../../plots/template_attributes").texttemplateAttrs,e=d("../../components/colorscale/attributes"),a=d("../../plots/font_attributes"),n=d("./constants"),r=d("../../components/drawing/attributes").pattern,t=d("../../lib/extend").extendFlat,f=a({editType:"calc",arrayOk:!0,colorEditType:"style"}),o=w.marker,i=o.line,g=t({},i.width,{dflt:0}),p=t({width:g,editType:"calc"},e("marker.line")),y=t({line:p,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:r});re.exports={x:w.x,x0:w.x0,dx:w.dx,y:w.y,y0:w.y0,dy:w.dy,xperiod:w.xperiod,yperiod:w.yperiod,xperiod0:w.xperiod0,yperiod0:w.yperiod0,xperiodalignment:w.xperiodalignment,yperiodalignment:w.yperiodalignment,xhoverformat:c("x"),yhoverformat:c("y"),text:w.text,texttemplate:T({editType:"plot"},{keys:n.eventDataKeys}),hovertext:w.hovertext,hovertemplate:M({},{keys:n.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:t({},f,{}),insidetextfont:t({},f,{}),outsidetextfont:t({},f,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:t({},w.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:y,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:w.selected.marker.opacity,color:w.selected.marker.color,editType:"style"},textfont:w.selected.textfont,editType:"style"},unselected:{marker:{opacity:w.unselected.marker.opacity,color:w.unselected.marker.color,editType:"style"},textfont:w.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"../scatter/attributes":927,"./constants":650}],649:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("../../plots/cartesian/align_period"),M=d("../../components/colorscale/helpers").hasColorscale,T=d("../../components/colorscale/calc"),e=d("./arrays_to_calcdata"),a=d("../scatter/calc_selection");re.exports=function(r,t){var f=w.getFromId(r,t.xaxis||"x"),o=w.getFromId(r,t.yaxis||"y"),i,g,p,y,h,m,u={msUTC:!!(t.base||t.base===0)};t.orientation==="h"?(i=f.makeCalcdata(t,"x",u),p=o.makeCalcdata(t,"y"),y=c(t,o,"y",p),h=!!t.yperiodalignment,m="y"):(i=o.makeCalcdata(t,"y",u),p=f.makeCalcdata(t,"x"),y=c(t,f,"x",p),h=!!t.xperiodalignment,m="x"),g=y.vals;for(var _=Math.min(g.length,i.length),s=new Array(_),A=0;A<_;A++)s[A]={p:g[A],s:i[A]},h&&(s[A].orig_p=p[A],s[A][m+"End"]=y.ends[A],s[A][m+"Start"]=y.starts[A]),t.ids&&(s[A].id=String(t.ids[A]));return M(t,"marker")&&T(r,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),M(t,"marker.line")&&T(r,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(s,t),a(s,t),s}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../scatter/calc_selection":929,"./arrays_to_calcdata":647}],650:[function(d,re,ne){re.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],651:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib").isArrayOrTypedArray,M=d("../../constants/numerical").BADNUM,T=d("../../registry"),e=d("../../plots/cartesian/axes"),a=d("../../plots/cartesian/constraints").getAxisGroup,n=d("./sieve.js");function r(L,S){for(var k=S.xaxis,P=S.yaxis,z=L._fullLayout,I=L._fullData,D=L.calcdata,R=[],B=[],F=0;F<I.length;F++){var V=I[F];if(V.visible===!0&&T.traceIs(V,"bar")&&V.xaxis===k._id&&V.yaxis===P._id&&(V.orientation==="h"?R.push(D[F]):B.push(D[F]),V._computePh))for(var G=L.calcdata[F],J=0;J<G.length;J++)typeof G[J].ph0=="function"&&(G[J].ph0=G[J].ph0()),typeof G[J].ph1=="function"&&(G[J].ph1=G[J].ph1())}var j={xCat:k.type==="category"||k.type==="multicategory",yCat:P.type==="category"||P.type==="multicategory",mode:z.barmode,norm:z.barnorm,gap:z.bargap,groupgap:z.bargroupgap};t(L,k,P,B,j),t(L,P,k,R,j)}function t(L,S,k,P,z){if(!!P.length){var I,D,R,B,F;switch(f(k,P),z.mode){case"overlay":o(S,k,P,z);break;case"group":for(I=[],D=[],R=0;R<P.length;R++)B=P[R],F=B[0].trace,F.offset===void 0?D.push(B):I.push(B);D.length&&i(L,S,k,D,z),I.length&&o(S,k,I,z);break;case"stack":case"relative":for(I=[],D=[],R=0;R<P.length;R++)B=P[R],F=B[0].trace,F.base===void 0?D.push(B):I.push(B);D.length&&g(L,S,k,D,z),I.length&&o(S,k,I,z);break}b(P,S)}}function f(L,S){var k,P;for(k=0;k<S.length;k++){var z=S[k],I=z[0].trace,D=I.type==="funnel"?I._base:I.base,R,B=I.orientation==="h"?I.xcalendar:I.ycalendar,F=L.type==="category"||L.type==="multicategory"?function(){return null}:L.d2c;if(c(D)){for(P=0;P<Math.min(D.length,z.length);P++)R=F(D[P],0,B),w(R)?(z[P].b=+R,z[P].hasB=1):z[P].b=0;for(;P<z.length;P++)z[P].b=0}else{R=F(D,0,B);var V=w(R);for(R=V?R:0,P=0;P<z.length;P++)z[P].b=R,V&&(z[P].hasB=1)}}}function o(L,S,k,P){for(var z=0;z<k.length;z++){var I=k[z],D=new n([I],{posAxis:L,sepNegVal:!1,overlapNoMerge:!P.norm});p(L,D,P),P.norm?(A(D),v(S,D,P)):_(S,D)}}function i(L,S,k,P,z){var I=new n(P,{posAxis:S,sepNegVal:!1,overlapNoMerge:!z.norm});y(L,S,I,z),x(I,S),z.norm?(A(I),v(k,I,z)):_(k,I)}function g(L,S,k,P,z){var I=new n(P,{posAxis:S,sepNegVal:z.mode==="relative",overlapNoMerge:!(z.norm||z.mode==="stack"||z.mode==="relative")});p(S,I,z),s(k,I,z);for(var D=0;D<P.length;D++)for(var R=P[D],B=0;B<R.length;B++){var F=R[B];if(F.s!==M){var V=F.b+F.s===I.get(F.p,F.s);V&&(F._outmost=!0)}}z.norm&&v(k,I,z)}function p(L,S,k){for(var P=S.minDiff,z=S.traces,I=P*(1-k.gap),D=I,R=D*(1-(k.groupgap||0)),B=-R/2,F=0;F<z.length;F++){var V=z[F],G=V[0].t;G.barwidth=R,G.poffset=B,G.bargroupwidth=I,G.bardelta=P}S.binWidth=z[0][0].t.barwidth/100,h(S),m(L,S),u(L,S)}function y(L,S,k,P){for(var z=L._fullLayout,I=k.positions,D=k.distinctPositions,R=k.minDiff,B=k.traces,F=B.length,V=I.length!==D.length,G=R*(1-P.gap),J=a(z,S._id)+B[0][0].trace.orientation,j=z._alignmentOpts[J]||{},Y=0;Y<F;Y++){var X=B[Y],oe=X[0].trace,se=j[oe.alignmentgroup]||{},ie=Object.keys(se.offsetGroups||{}).length,N;ie?N=G/ie:N=V?G/F:G;var U=N*(1-(P.groupgap||0)),q;ie?q=((2*oe._offsetIndex+1-ie)*N-U)/2:q=V?((2*Y+1-F)*N-U)/2:-U/2;var Q=X[0].t;Q.barwidth=U,Q.poffset=q,Q.bargroupwidth=G,Q.bardelta=R}k.binWidth=B[0][0].t.barwidth/100,h(k),m(S,k),u(S,k,V)}function h(L){var S=L.traces,k,P;for(k=0;k<S.length;k++){var z=S[k],I=z[0],D=I.trace,R=I.t,B=D._offset||D.offset,F=R.poffset,V;if(c(B)){for(V=Array.prototype.slice.call(B,0,z.length),P=0;P<V.length;P++)w(V[P])||(V[P]=F);for(P=V.length;P<z.length;P++)V.push(F);R.poffset=V}else B!==void 0&&(R.poffset=B);var G=D._width||D.width,J=R.barwidth;if(c(G)){var j=Array.prototype.slice.call(G,0,z.length);for(P=0;P<j.length;P++)w(j[P])||(j[P]=J);for(P=j.length;P<z.length;P++)j.push(J);if(R.barwidth=j,B===void 0){for(V=[],P=0;P<z.length;P++)V.push(F+(J-j[P])/2);R.poffset=V}}else G!==void 0&&(R.barwidth=G,B===void 0&&(R.poffset=F+(J-G)/2))}}function m(L,S){for(var k=S.traces,P=l(L),z=0;z<k.length;z++)for(var I=k[z],D=I[0].t,R=D.poffset,B=Array.isArray(R),F=D.barwidth,V=Array.isArray(F),G=0;G<I.length;G++){var J=I[G],j=J.w=V?F[G]:F;J[P]=J.p+(B?R[G]:R)+j/2}}function u(L,S,k){var P=S.traces,z=S.minDiff,I=z/2;e.minDtick(L,S.minDiff,S.distinctPositions[0],k);for(var D=0;D<P.length;D++){var R=P[D],B=R[0],F=B.trace,V=[],G,J,j,Y;for(Y=0;Y<R.length;Y++)G=R[Y],J=G.p-I,j=G.p+I,V.push(J,j);if(F.width||F.offset){var X=B.t,oe=X.poffset,se=X.barwidth,ie=Array.isArray(oe),N=Array.isArray(se);for(Y=0;Y<R.length;Y++){G=R[Y];var U=ie?oe[Y]:oe,q=N?se[Y]:se;J=G.p+U,j=J+q,V.push(J,j)}}F._extremes[L._id]=e.findExtremes(L,V,{padded:!1})}}function _(L,S){for(var k=S.traces,P=l(L),z=0;z<k.length;z++){for(var I=k[z],D=I[0].trace,R=[],B=!1,F=0;F<I.length;F++){var V=I[F],G=V.b,J=G+V.s;V[P]=J,R.push(J),V.hasB&&R.push(G),(!V.hasB||!V.b)&&(B=!0)}D._extremes[L._id]=e.findExtremes(L,R,{tozero:B,padded:!0})}}function s(L,S,k){var P=l(L),z=S.traces,I,D,R,B,F,V;for(B=0;B<z.length;B++)if(I=z[B],D=I[0].trace,D.type==="funnel")for(F=0;F<I.length;F++)V=I[F],V.s!==M&&S.put(V.p,-.5*V.s);for(B=0;B<z.length;B++){I=z[B],D=I[0].trace,R=D.type==="funnel";var G=[];for(F=0;F<I.length;F++)if(V=I[F],V.s!==M){var J;R?J=V.s:J=V.s+V.b;var j=S.put(V.p,J),Y=j+J;V.b=j,V[P]=Y,k.norm||(G.push(Y),V.hasB&&G.push(j))}k.norm||(D._extremes[L._id]=e.findExtremes(L,G,{tozero:!0,padded:!0}))}}function A(L){for(var S=L.traces,k=0;k<S.length;k++)for(var P=S[k],z=0;z<P.length;z++){var I=P[z];I.s!==M&&L.put(I.p,I.b+I.s)}}function x(L,S){for(var k=L.traces,P=0;P<k.length;P++){var z=k[P],I=z[0].trace;if(I.base===void 0)for(var D=new n([z],{posAxis:S,sepNegVal:!0,overlapNoMerge:!0}),R=0;R<z.length;R++){var B=z[R];if(B.p!==M){var F=D.put(B.p,B.b+B.s);F&&(B.b=F)}}}}function v(L,S,k){var P=S.traces,z=l(L),I=k.norm==="fraction"?1:100,D=I/1e9,R=L.l2c(L.c2l(0)),B=k.mode==="stack"?I:R;function F(q){return w(L.c2l(q))&&(q<R-D||q>B+D||!w(R))}for(var V=0;V<P.length;V++){for(var G=P[V],J=G[0].trace,j=[],Y=!1,X=!1,oe=0;oe<G.length;oe++){var se=G[oe];if(se.s!==M){var ie=Math.abs(I/S.get(se.p,se.s));se.b*=ie,se.s*=ie;var N=se.b,U=N+se.s;se[z]=U,j.push(U),X=X||F(U),se.hasB&&(j.push(N),X=X||F(N)),(!se.hasB||!se.b)&&(Y=!0)}}J._extremes[L._id]=e.findExtremes(L,j,{tozero:Y,padded:X})}}function b(L,S){var k=l(S),P={},z,I,D,R=1/0,B=-1/0;for(z=0;z<L.length;z++)for(D=L[z],I=0;I<D.length;I++){var F=D[I].p;w(F)&&(R=Math.min(R,F),B=Math.max(B,F))}var V=1e4/(B-R),G=P.round=function(ie){return String(Math.round(V*(ie-R)))};for(z=0;z<L.length;z++){D=L[z],D[0].t.extents=P;var J=D[0].t.poffset,j=Array.isArray(J);for(I=0;I<D.length;I++){var Y=D[I],X=Y[k]-Y.w/2;if(w(X)){var oe=Y[k]+Y.w/2,se=G(Y.p);P[se]?P[se]=[Math.min(X,P[se][0]),Math.max(oe,P[se][1])]:P[se]=[X,oe]}Y.p0=Y.p+(j?J[I]:J),Y.p1=Y.p0+Y.w,Y.s0=Y.b,Y.s1=Y.s0+Y.s}}}function l(L){return L._id.charAt(0)}re.exports={crossTraceCalc:r,setGroupPositions:t}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axes":554,"../../plots/cartesian/constraints":562,"../../registry":638,"./sieve.js":661,"fast-isnumeric":190}],652:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/color"),M=d("../../registry"),T=d("../scatter/xy_defaults"),e=d("../scatter/period_defaults"),a=d("./style_defaults"),n=d("../../plots/cartesian/constraints").getAxisGroup,r=d("./attributes"),t=w.coerceFont;function f(p,y,h,m){function u(v,b){return w.coerce(p,y,r,v,b)}var _=T(p,y,m,u);if(!_){y.visible=!1;return}e(p,y,m,u),u("xhoverformat"),u("yhoverformat"),u("orientation",y.x&&!y.y?"h":"v"),u("base"),u("offset"),u("width"),u("text"),u("hovertext"),u("hovertemplate");var s=u("textposition");g(p,y,m,u,s,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),a(p,y,u,h,m);var A=(y.marker.line||{}).color,x=M.getComponentMethod("errorbars","supplyDefaults");x(p,y,A||c.defaultLine,{axis:"y"}),x(p,y,A||c.defaultLine,{axis:"x",inherit:"y"}),w.coerceSelectionMarkerOpacity(y,u)}function o(p,y,h,m){var u=y.orientation,_=y[{v:"x",h:"y"}[u]+"axis"],s=n(h,_)+u,A=h._alignmentOpts||{},x=m("alignmentgroup"),v=A[s];v||(v=A[s]={});var b=v[x];b?b.traces.push(y):b=v[x]={traces:[y],alignmentIndex:Object.keys(v).length,offsetGroups:{}};var l=m("offsetgroup"),L=b.offsetGroups,S=L[l];l&&(S||(S=L[l]={offsetIndex:Object.keys(L).length}),y._offsetIndex=S.offsetIndex)}function i(p,y){var h,m;function u(s){return w.coerce(m._input,m,r,s)}if(y.barmode==="group")for(var _=0;_<p.length;_++)m=p[_],m.type==="bar"&&(h=m._input,o(h,m,y,u))}function g(p,y,h,m,u,_){_=_||{};var s=_.moduleHasSelected!==!1,A=_.moduleHasUnselected!==!1,x=_.moduleHasConstrain!==!1,v=_.moduleHasCliponaxis!==!1,b=_.moduleHasTextangle!==!1,l=_.moduleHasInsideanchor!==!1,L=!!_.hasPathbar,S=Array.isArray(u)||u==="auto",k=S||u==="inside",P=S||u==="outside";if(k||P){var z=t(m,"textfont",h.font),I=w.extendFlat({},z),D=p.textfont&&p.textfont.color,R=!D;if(R&&delete I.color,t(m,"insidetextfont",I),L){var B=w.extendFlat({},z);R&&delete B.color,t(m,"pathbar.textfont",B)}P&&t(m,"outsidetextfont",z),s&&m("selected.textfont.color"),A&&m("unselected.textfont.color"),x&&m("constraintext"),v&&m("cliponaxis"),b&&m("textangle"),m("texttemplate")}k&&l&&m("insidetextanchor")}re.exports={supplyDefaults:f,crossTraceDefaults:i,handleGroupingDefaults:o,handleText:g}},{"../../components/color":366,"../../lib":503,"../../plots/cartesian/constraints":562,"../../registry":638,"../scatter/period_defaults":947,"../scatter/xy_defaults":954,"./attributes":648,"./style_defaults":663}],653:[function(d,re,ne){re.exports=function(c,M,T){return c.x="xVal"in M?M.xVal:M.x,c.y="yVal"in M?M.yVal:M.y,M.xa&&(c.xaxis=M.xa),M.ya&&(c.yaxis=M.ya),T.orientation==="h"?(c.label=c.y,c.value=c.x):(c.label=c.x,c.value=c.y),c}},{}],654:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("tinycolor2"),M=d("../../lib").isArrayOrTypedArray;ne.coerceString=function(T,e,a){if(typeof e=="string"){if(e||!T.noBlank)return e}else if((typeof e=="number"||e===!0)&&!T.strict)return String(e);return a!==void 0?a:T.dflt},ne.coerceNumber=function(T,e,a){if(w(e)){e=+e;var n=T.min,r=T.max,t=n!==void 0&&e<n||r!==void 0&&e>r;if(!t)return e}return a!==void 0?a:T.dflt},ne.coerceColor=function(T,e,a){return c(e).isValid()?e:a!==void 0?a:T.dflt},ne.coerceEnumerated=function(T,e,a){return T.coerceNumber&&(e=+e),T.values.indexOf(e)!==-1?e:a!==void 0?a:T.dflt},ne.getValue=function(T,e){var a;return Array.isArray(T)?e<T.length&&(a=T[e]):a=T,a},ne.getLineWidth=function(T,e){var a=0<e.mlw?e.mlw:M(T.marker.line.width)?0:T.marker.line.width;return a}},{"../../lib":503,"fast-isnumeric":190,tinycolor2:312}],655:[function(d,re,ne){var w=d("../../components/fx"),c=d("../../registry"),M=d("../../components/color"),T=d("../../lib").fillText,e=d("./helpers").getLineWidth,a=d("../../plots/cartesian/axes").hoverLabelText,n=d("../../constants/numerical").BADNUM;function r(o,i,g,p,y){var h=t(o,i,g,p,y);if(h){var m=h.cd,u=m[0].trace,_=m[h.index];return h.color=f(u,_),c.getComponentMethod("errorbars","hoverInfo")(_,u,h),[h]}}function t(o,i,g,p,y){var h=o.cd,m=h[0].trace,u=h[0].t,_=p==="closest",s=m.type==="waterfall",A=o.maxHoverDistance,x=o.maxSpikeDistance,v,b,l,L,S,k,P;m.orientation==="h"?(v=g,b=i,l="y",L="x",S=oe,k=j):(v=i,b=g,l="x",L="y",k=oe,S=j);var z=m[l+"period"],I=_||z;function D(ae){return B(ae,-1)}function R(ae){return B(ae,1)}function B(ae,le){var ye=ae.w;return ae[l]+le*ye/2}function F(ae){return ae[l+"End"]-ae[l+"Start"]}var V=_?D:z?function(ae){return ae.p-F(ae)/2}:function(ae){return Math.min(D(ae),ae.p-u.bardelta/2)},G=_?R:z?function(ae){return ae.p+F(ae)/2}:function(ae){return Math.max(R(ae),ae.p+u.bardelta/2)};function J(ae,le,ye){return y.finiteRange&&(ye=0),w.inbox(ae-v,le-v,ye+Math.min(1,Math.abs(le-ae)/P)-1)}function j(ae){return J(V(ae),G(ae),A)}function Y(ae){return J(D(ae),R(ae),x)}function X(ae){var le=ae[L];if(s){var ye=Math.abs(ae.rawS)||0;b>0?le+=ye:b<0&&(le-=ye)}return le}function oe(ae){var le=b,ye=ae.b,fe=X(ae);return w.inbox(ye-le,fe-le,A+(fe-le)/(fe-ye)-1)}function se(ae){var le=b,ye=ae.b,fe=X(ae);return w.inbox(ye-le,fe-le,x+(fe-le)/(fe-ye)-1)}var ie=o[l+"a"],N=o[L+"a"];P=Math.abs(ie.r2c(ie.range[1])-ie.r2c(ie.range[0]));function U(ae){return(S(ae)+k(ae))/2}var q=w.getDistanceFunction(p,S,k,U);if(w.getClosest(h,q,o),o.index!==!1&&h[o.index].p!==n){I||(V=function(ae){return Math.min(D(ae),ae.p-u.bargroupwidth/2)},G=function(ae){return Math.max(R(ae),ae.p+u.bargroupwidth/2)});var Q=o.index,W=h[Q],Z=m.base?W.b+W.s:W.s;o[L+"0"]=o[L+"1"]=N.c2p(W[L],!0),o[L+"LabelVal"]=Z;var ee=u.extents[u.extents.round(W.p)];o[l+"0"]=ie.c2p(_?V(W):ee[0],!0),o[l+"1"]=ie.c2p(_?G(W):ee[1],!0);var te=W.orig_p!==void 0;return o[l+"LabelVal"]=te?W.orig_p:W.p,o.labelLabel=a(ie,o[l+"LabelVal"],m[l+"hoverformat"]),o.valueLabel=a(N,o[L+"LabelVal"],m[L+"hoverformat"]),o.baseLabel=a(N,W.b,m[L+"hoverformat"]),o.spikeDistance=(se(W)+Y(W))/2,o[l+"Spike"]=ie.c2p(W.p,!0),T(W,m,o),o.hovertemplate=m.hovertemplate,o}}function f(o,i){var g=i.mcc||o.marker.color,p=i.mlcc||o.marker.line.color,y=e(o,i);if(M.opacity(g))return g;if(M.opacity(p)&&y)return p}re.exports={hoverPoints:r,hoverOnBars:t,getTraceColor:f}},{"../../components/color":366,"../../components/fx":406,"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"./helpers":654}],656:[function(d,re,ne){re.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc").crossTraceCalc,colorbar:d("../scatter/marker_colorbar"),arraysToCalcdata:d("./arrays_to_calcdata"),plot:d("./plot").plot,style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"bar",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":568,"../scatter/marker_colorbar":945,"./arrays_to_calcdata":647,"./attributes":648,"./calc":649,"./cross_trace_calc":651,"./defaults":652,"./event_data":653,"./hover":655,"./layout_attributes":657,"./layout_defaults":658,"./plot":659,"./select":660,"./style":662}],657:[function(d,re,ne){re.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],658:[function(d,re,ne){var w=d("../../registry"),c=d("../../plots/cartesian/axes"),M=d("../../lib"),T=d("./layout_attributes");re.exports=function(e,a,n){function r(u,_){return M.coerce(e,a,T,u,_)}for(var t=!1,f=!1,o=!1,i={},g=r("barmode"),p=0;p<n.length;p++){var y=n[p];if(w.traceIs(y,"bar")&&y.visible)t=!0;else continue;if(g==="group"){var h=y.xaxis+y.yaxis;i[h]&&(o=!0),i[h]=!0}if(y.visible&&y.type==="histogram"){var m=c.getFromId({_fullLayout:a},y[y.orientation==="v"?"xaxis":"yaxis"]);m.type!=="category"&&(f=!0)}}if(!t){delete a.barmode;return}g!=="overlay"&&r("barnorm"),r("bargap",f&&!o?0:.2),r("bargroupgap")}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"./layout_attributes":657}],659:[function(d,re,ne){var w=d("@plotly/d3"),c=d("fast-isnumeric"),M=d("../../lib"),T=d("../../lib/svg_text_utils"),e=d("../../components/color"),a=d("../../components/drawing"),n=d("../../registry"),r=d("../../plots/cartesian/axes").tickText,t=d("./uniform_text"),f=t.recordMinTextSize,o=t.clearMinTextSize,i=d("./style"),g=d("./helpers"),p=d("./constants"),y=d("./attributes"),h=y.text,m=y.textposition,u=d("../../components/fx/helpers").appendArrayPointValue,_=p.TEXTPAD;function s(V){return V.id}function A(V){if(V.ids)return s}function x(V,G){return V<G?1:-1}function v(V,G,J,j){var Y=[],X=[],oe=j?G:J,se=j?J:G;return Y[0]=oe.c2p(V.s0,!0),X[0]=se.c2p(V.p0,!0),Y[1]=oe.c2p(V.s1,!0),X[1]=se.c2p(V.p1,!0),j?[Y,X]:[X,Y]}function b(V,G,J,j){if(!G.uniformtext.mode&&l(J)){var Y;return j&&(Y=j()),V.transition().duration(J.duration).ease(J.easing).each("end",function(){Y&&Y()}).each("interrupt",function(){Y&&Y()})}else return V}function l(V){return V&&V.duration>0}function L(V,G,J,j,Y,X){var oe=G.xaxis,se=G.yaxis,ie=V._fullLayout;Y||(Y={mode:ie.barmode,norm:ie.barmode,gap:ie.bargap,groupgap:ie.bargroupgap},o("bar",ie));var N=M.makeTraceGroups(j,J,"trace bars").each(function(U){var q=w.select(this),Q=U[0].trace,W=Q.type==="waterfall",Z=Q.type==="funnel",ee=Q.type==="bar",te=ee||Z,ae=0;W&&Q.connector.visible&&Q.connector.mode==="between"&&(ae=Q.connector.line.width/2);var le=Q.orientation==="h",ye=l(Y),fe=M.ensureSingle(q,"g","points"),pe=A(Q),ge=fe.selectAll("g.point").data(M.identity,pe);ge.enter().append("g").classed("point",!0),ge.exit().remove(),ge.each(function(we,De){var Be=w.select(this),Ve=v(we,oe,se,le),xe=Ve[0][0],Le=Ve[0][1],He=Ve[1][0],Je=Ve[1][1],Oe=(le?Le-xe:Je-He)===0;Oe&&te&&g.getLineWidth(Q,we)&&(Oe=!1),Oe||(Oe=!c(xe)||!c(Le)||!c(He)||!c(Je)),we.isBlank=Oe,Oe&&(le?Le=xe:Je=He),ae&&!Oe&&(le?(xe-=x(xe,Le)*ae,Le+=x(xe,Le)*ae):(He-=x(He,Je)*ae,Je+=x(He,Je)*ae));var Pe,Ue;if(Q.type==="waterfall"){if(!Oe){var vt=Q[we.dir].marker;Pe=vt.line.width,Ue=vt.color}}else Pe=g.getLineWidth(Q,we),Ue=we.mc||Q.marker.color;function Lt(Tt){var at=w.round(Pe/2%1,2);return Y.gap===0&&Y.groupgap===0?w.round(Math.round(Tt)-at,2):Tt}function Yt(Tt,at,ct){return ct&&Tt===at?Tt:Math.abs(Tt-at)>=2?Lt(Tt):Tt>at?Math.ceil(Tt):Math.floor(Tt)}if(!V._context.staticPlot){var At=e.opacity(Ue),Rt=At<1||Pe>.01?Lt:Yt;xe=Rt(xe,Le,le),Le=Rt(Le,xe,le),He=Rt(He,Je,!le),Je=Rt(Je,He,!le)}var Bt=b(M.ensureSingle(Be,"path"),ie,Y,X);if(Bt.style("vector-effect","non-scaling-stroke").attr("d",isNaN((Le-xe)*(Je-He))||Oe&&V._context.staticPlot?"M0,0Z":"M"+xe+","+He+"V"+Je+"H"+Le+"V"+He+"Z").call(a.setClipUrl,G.layerClipId,V),!ie.uniformtext.mode&&ye){var Mt=a.makePointStyleFns(Q);a.singlePointStyle(we,Bt,Q,Mt,V)}S(V,G,Be,U,De,xe,Le,He,Je,Y,X),G.layerClipId&&a.hideOutsideRangePoint(we,Be.select("text"),oe,se,Q.xcalendar,Q.ycalendar)});var Ae=Q.cliponaxis===!1;a.setClipUrl(q,Ae?null:G.layerClipId,V)});n.getComponentMethod("errorbars","plot")(V,N,G,Y)}function S(V,G,J,j,Y,X,oe,se,ie,N,U){var q=G.xaxis,Q=G.yaxis,W=V._fullLayout,Z;function ee(Tt,at,ct){var je=M.ensureSingle(Tt,"text").text(at).attr({class:"bartext bartext-"+Z,"text-anchor":"middle","data-notex":1}).call(a.font,ct).call(T.convertToTspans,V);return je}var te=j[0].trace,ae=te.orientation==="h",le=D(W,j,Y,q,Q);Z=R(te,Y);var ye=N.mode==="stack"||N.mode==="relative",fe=j[Y],pe=!ye||fe._outmost;if(!le||Z==="none"||(fe.isBlank||X===oe||se===ie)&&(Z==="auto"||Z==="inside")){J.select("text").remove();return}var ge=W.font,Ae=i.getBarColor(j[Y],te),we=i.getInsideTextFont(te,Y,ge,Ae),De=i.getOutsideTextFont(te,Y,ge),Be=J.datum();ae?q.type==="log"&&Be.s0<=0&&(q.range[0]<q.range[1]?X=0:X=q._length):Q.type==="log"&&Be.s0<=0&&(Q.range[0]<Q.range[1]?se=Q._length:se=0);var Ve=Math.abs(oe-X)-2*_,xe=Math.abs(ie-se)-2*_,Le,He,Je,Oe,Pe;if(Z==="outside"&&!pe&&!fe.hasB&&(Z="inside"),Z==="auto")if(pe){Z="inside",Pe=M.ensureUniformFontSize(V,we),Le=ee(J,le,Pe),He=a.bBox(Le.node()),Je=He.width,Oe=He.height;var Ue=Je>0&&Oe>0,vt=Je<=Ve&&Oe<=xe,Lt=Je<=xe&&Oe<=Ve,Yt=ae?Ve>=Je*(xe/Oe):xe>=Oe*(Ve/Je);Ue&&(vt||Lt||Yt)?Z="inside":(Z="outside",Le.remove(),Le=null)}else Z="inside";if(!Le){Pe=M.ensureUniformFontSize(V,Z==="outside"?De:we),Le=ee(J,le,Pe);var At=Le.attr("transform");if(Le.attr("transform",""),He=a.bBox(Le.node()),Je=He.width,Oe=He.height,Le.attr("transform",At),Je<=0||Oe<=0){Le.remove();return}}var Rt=te.textangle,Bt,Mt;Z==="outside"?(Mt=te.constraintext==="both"||te.constraintext==="outside",Bt=I(X,oe,se,ie,He,{isHorizontal:ae,constrained:Mt,angle:Rt})):(Mt=te.constraintext==="both"||te.constraintext==="inside",Bt=z(X,oe,se,ie,He,{isHorizontal:ae,constrained:Mt,angle:Rt,anchor:te.insidetextanchor})),Bt.fontSize=Pe.size,f(te.type==="histogram"?"bar":te.type,Bt,W),fe.transform=Bt,b(Le,W,N,U).attr("transform",M.getTextTransform(Bt))}function k(V){return V==="auto"?0:V}function P(V,G){var J=Math.PI/180*G,j=Math.abs(Math.sin(J)),Y=Math.abs(Math.cos(J));return{x:V.width*Y+V.height*j,y:V.width*j+V.height*Y}}function z(V,G,J,j,Y,X){var oe=!!X.isHorizontal,se=!!X.constrained,ie=X.angle||0,N=X.anchor||"end",U=N==="end",q=N==="start",Q=X.leftToRight||0,W=(Q+1)/2,Z=1-W,ee=Y.width,te=Y.height,ae=Math.abs(G-V),le=Math.abs(j-J),ye=ae>2*_&&le>2*_?_:0;ae-=2*ye,le-=2*ye;var fe=k(ie);ie==="auto"&&!(ee<=ae&&te<=le)&&(ee>ae||te>le)&&(!(ee>le||te>ae)||ee<te!=ae<le)&&(fe+=90);var pe=P(Y,fe),ge=1;se&&(ge=Math.min(1,ae/pe.x,le/pe.y));var Ae=Y.left*Z+Y.right*W,we=(Y.top+Y.bottom)/2,De=(V+_)*Z+(G-_)*W,Be=(J+j)/2,Ve=0,xe=0;if(q||U){var Le=(oe?pe.x:pe.y)/2,He=oe?x(V,G):x(J,j);oe?q?(De=V+He*ye,Ve=-He*Le):(De=G-He*ye,Ve=He*Le):q?(Be=J+He*ye,xe=-He*Le):(Be=j-He*ye,xe=He*Le)}return{textX:Ae,textY:we,targetX:De,targetY:Be,anchorX:Ve,anchorY:xe,scale:ge,rotate:fe}}function I(V,G,J,j,Y,X){var oe=!!X.isHorizontal,se=!!X.constrained,ie=X.angle||0,N=Y.width,U=Y.height,q=Math.abs(G-V),Q=Math.abs(j-J),W;oe?W=Q>2*_?_:0:W=q>2*_?_:0;var Z=1;se&&(Z=oe?Math.min(1,Q/U):Math.min(1,q/N));var ee=k(ie),te=P(Y,ee),ae=(oe?te.x:te.y)/2,le=(Y.left+Y.right)/2,ye=(Y.top+Y.bottom)/2,fe=(V+G)/2,pe=(J+j)/2,ge=0,Ae=0,we=oe?x(G,V):x(J,j);return oe?(fe=G-we*W,ge=we*ae):(pe=j+we*W,Ae=-we*ae),{textX:le,textY:ye,targetX:fe,targetY:pe,anchorX:ge,anchorY:Ae,scale:Z,rotate:ee}}function D(V,G,J,j,Y){var X=G[0].trace,oe=X.texttemplate,se;return oe?se=B(V,G,J,j,Y):X.textinfo?se=F(G,J,j,Y):se=g.getValue(X.text,J),g.coerceString(h,se)}function R(V,G){var J=g.getValue(V.textposition,G);return g.coerceEnumerated(m,J)}function B(V,G,J,j,Y){var X=G[0].trace,oe=M.castOption(X,J,"texttemplate");if(!oe)return"";var se=X.type==="histogram",ie=X.type==="waterfall",N=X.type==="funnel",U=X.orientation==="h",q,Q,W,Z;U?(q="y",Q=Y,W="x",Z=j):(q="x",Q=j,W="y",Z=Y);function ee(ge){return r(Q,Q.c2l(ge),!0).text}function te(ge){return r(Z,Z.c2l(ge),!0).text}var ae=G[J],le={};le.label=ae.p,le.labelLabel=le[q+"Label"]=ee(ae.p);var ye=M.castOption(X,ae.i,"text");(ye===0||ye)&&(le.text=ye),le.value=ae.s,le.valueLabel=le[W+"Label"]=te(ae.s);var fe={};u(fe,X,ae.i),(se||fe.x===void 0)&&(fe.x=U?le.value:le.label),(se||fe.y===void 0)&&(fe.y=U?le.label:le.value),(se||fe.xLabel===void 0)&&(fe.xLabel=U?le.valueLabel:le.labelLabel),(se||fe.yLabel===void 0)&&(fe.yLabel=U?le.labelLabel:le.valueLabel),ie&&(le.delta=+ae.rawS||ae.s,le.deltaLabel=te(le.delta),le.final=ae.v,le.finalLabel=te(le.final),le.initial=le.final-le.delta,le.initialLabel=te(le.initial)),N&&(le.value=ae.s,le.valueLabel=te(le.value),le.percentInitial=ae.begR,le.percentInitialLabel=M.formatPercent(ae.begR),le.percentPrevious=ae.difR,le.percentPreviousLabel=M.formatPercent(ae.difR),le.percentTotal=ae.sumR,le.percenTotalLabel=M.formatPercent(ae.sumR));var pe=M.castOption(X,ae.i,"customdata");return pe&&(le.customdata=pe),M.texttemplateString(oe,le,V._d3locale,fe,le,X._meta||{})}function F(V,G,J,j){var Y=V[0].trace,X=Y.orientation==="h",oe=Y.type==="waterfall",se=Y.type==="funnel";function ie(pe){var ge=X?j:J;return r(ge,pe,!0).text}function N(pe){var ge=X?J:j;return r(ge,+pe,!0).text}var U=Y.textinfo,q=V[G],Q=U.split("+"),W=[],Z,ee=function(pe){return Q.indexOf(pe)!==-1};if(ee("label")&&W.push(ie(V[G].p)),ee("text")&&(Z=M.castOption(Y,q.i,"text"),(Z===0||Z)&&W.push(Z)),oe){var te=+q.rawS||q.s,ae=q.v,le=ae-te;ee("initial")&&W.push(N(le)),ee("delta")&&W.push(N(te)),ee("final")&&W.push(N(ae))}if(se){ee("value")&&W.push(N(q.s));var ye=0;ee("percent initial")&&ye++,ee("percent previous")&&ye++,ee("percent total")&&ye++;var fe=ye>1;ee("percent initial")&&(Z=M.formatPercent(q.begR),fe&&(Z+=" of initial"),W.push(Z)),ee("percent previous")&&(Z=M.formatPercent(q.difR),fe&&(Z+=" of previous"),W.push(Z)),ee("percent total")&&(Z=M.formatPercent(q.sumR),fe&&(Z+=" of total"),W.push(Z))}return W.join("<br>")}re.exports={plot:L,toMoveInsideBar:z}},{"../../components/color":366,"../../components/drawing":388,"../../components/fx/helpers":402,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../registry":638,"./attributes":648,"./constants":650,"./helpers":654,"./style":662,"./uniform_text":664,"@plotly/d3":58,"fast-isnumeric":190}],660:[function(d,re,ne){re.exports=function(M,T){var e=M.cd,a=M.xaxis,n=M.yaxis,r=e[0].trace,t=r.type==="funnel",f=r.orientation==="h",o=[],i;if(T===!1)for(i=0;i<e.length;i++)e[i].selected=0;else for(i=0;i<e.length;i++){var g=e[i],p="ct"in g?g.ct:w(g,a,n,f,t);T.contains(p,!1,i,M)?(o.push({pointNumber:i,x:a.c2d(g.x),y:n.c2d(g.y)}),g.selected=1):g.selected=0}return o};function w(c,M,T,e,a){var n=M.c2p(e?c.s0:c.p0,!0),r=M.c2p(e?c.s1:c.p1,!0),t=T.c2p(e?c.p0:c.s0,!0),f=T.c2p(e?c.p1:c.s1,!0);return a?[(n+r)/2,(t+f)/2]:e?[r,(t+f)/2]:[(n+r)/2,f]}},{}],661:[function(d,re,ne){re.exports=M;var w=d("../../lib").distinctVals,c=d("../../constants/numerical").BADNUM;function M(T,e){this.traces=T,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var a=1/0,n=[],r=0;r<T.length;r++){for(var t=T[r],f=0;f<t.length;f++){var o=t[f];o.p!==c&&n.push(o.p)}t[0]&&t[0].width1&&(a=Math.min(t[0].width1,a))}this.positions=n;var i=w(n);this.distinctPositions=i.vals,i.vals.length===1&&a!==1/0?this.minDiff=a:this.minDiff=Math.min(i.minDiff,a);var g=(e.posAxis||{}).type;(g==="category"||g==="multicategory")&&(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}M.prototype.put=function(e,a){var n=this.getLabel(e,a),r=this.bins[n]||0;return this.bins[n]=r+a,r},M.prototype.get=function(e,a){var n=this.getLabel(e,a);return this.bins[n]||0},M.prototype.getLabel=function(e,a){var n=a<0&&this.sepNegVal?"v":"^",r=this.overlapNoMerge?e:Math.round(e/this.binWidth);return n+r}},{"../../constants/numerical":479,"../../lib":503}],662:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/color"),M=d("../../components/drawing"),T=d("../../lib"),e=d("../../registry"),a=d("./uniform_text").resizeText,n=d("./attributes"),r=n.textfont,t=n.insidetextfont,f=n.outsidetextfont,o=d("./helpers");function i(b){var l=w.select(b).selectAll("g.barlayer").selectAll("g.trace");a(b,l,"bar");var L=l.size(),S=b._fullLayout;l.style("opacity",function(k){return k[0].trace.opacity}).each(function(k){(S.barmode==="stack"&&L>1||S.bargap===0&&S.bargroupgap===0&&!k[0].trace.marker.line.width)&&w.select(this).attr("shape-rendering","crispEdges")}),l.selectAll("g.points").each(function(k){var P=w.select(this),z=k[0].trace;g(P,z,b)}),e.getComponentMethod("errorbars","style")(l)}function g(b,l,L){M.pointStyle(b.selectAll("path"),l,L),p(b,l,L)}function p(b,l,L){b.selectAll("text").each(function(S){var k=w.select(this),P=T.ensureUniformFontSize(L,u(k,S,l,L));M.font(k,P)})}function y(b,l,L){var S=l[0].trace;S.selectedpoints?h(L,S,b):(g(L,S,b),e.getComponentMethod("errorbars","style")(L))}function h(b,l,L){M.selectedPointStyle(b.selectAll("path"),l),m(b.selectAll("text"),l,L)}function m(b,l,L){b.each(function(S){var k=w.select(this),P;if(S.selected){P=T.ensureUniformFontSize(L,u(k,S,l,L));var z=l.selected.textfont&&l.selected.textfont.color;z&&(P.color=z),M.font(k,P)}else M.selectedTextStyle(k,l)})}function u(b,l,L,S){var k=S._fullLayout.font,P=L.textfont;if(b.classed("bartext-inside")){var z=v(l,L);P=s(L,l.i,k,z)}else b.classed("bartext-outside")&&(P=A(L,l.i,k));return P}function _(b,l,L){return x(r,b.textfont,l,L)}function s(b,l,L,S){var k=_(b,l,L),P=b._input.textfont===void 0||b._input.textfont.color===void 0||Array.isArray(b.textfont.color)&&b.textfont.color[l]===void 0;return P&&(k={color:c.contrast(S),family:k.family,size:k.size}),x(t,b.insidetextfont,l,k)}function A(b,l,L){var S=_(b,l,L);return x(f,b.outsidetextfont,l,S)}function x(b,l,L,S){l=l||{};var k=o.getValue(l.family,L),P=o.getValue(l.size,L),z=o.getValue(l.color,L);return{family:o.coerceString(b.family,k,S.family),size:o.coerceNumber(b.size,P,S.size),color:o.coerceColor(b.color,z,S.color)}}function v(b,l){return l.type==="waterfall"?l[b.dir].marker.color:b.mcc||b.mc||l.marker.color}re.exports={style:i,styleTextPoints:p,styleOnSelect:y,getInsideTextFont:s,getOutsideTextFont:A,getBarColor:v,resizeText:a}},{"../../components/color":366,"../../components/drawing":388,"../../lib":503,"../../registry":638,"./attributes":648,"./helpers":654,"./uniform_text":664,"@plotly/d3":58}],663:[function(d,re,ne){var w=d("../../components/color"),c=d("../../components/colorscale/helpers").hasColorscale,M=d("../../components/colorscale/defaults"),T=d("../../lib").coercePattern;re.exports=function(a,n,r,t,f){var o=r("marker.color",t),i=c(a,"marker");i&&M(a,n,f,r,{prefix:"marker.",cLetter:"c"}),r("marker.line.color",w.defaultLine),c(a,"marker.line")&&M(a,n,f,r,{prefix:"marker.line.",cLetter:"c"}),r("marker.line.width"),r("marker.opacity"),T(r,"marker.pattern",o,i),r("selected.marker.color"),r("unselected.marker.color")}},{"../../components/color":366,"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503}],664:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib");function M(n,r,t){var f=n._fullLayout,o=f["_"+t+"Text_minsize"];if(o){var i=f.uniformtext.mode==="hide",g;switch(t){case"funnelarea":case"pie":case"sunburst":g="g.slice";break;case"treemap":case"icicle":g="g.slice, g.pathbar";break;default:g="g.points > g.point"}r.selectAll(g).each(function(p){var y=p.transform;if(y){y.scale=i&&y.hide?0:o/y.fontSize;var h=w.select(this).select("text");h.attr("transform",c.getTextTransform(y))}})}}function T(n,r,t){if(t.uniformtext.mode){var f=a(n),o=t.uniformtext.minsize,i=r.scale*r.fontSize;r.hide=i<o,t[f]=t[f]||1/0,r.hide||(t[f]=Math.min(t[f],Math.max(i,o)))}}function e(n,r){var t=a(n);r[t]=void 0}function a(n){return"_"+n+"Text_minsize"}re.exports={recordMinTextSize:T,clearMinTextSize:e,resizeText:M}},{"../../lib":503,"@plotly/d3":58}],665:[function(d,re,ne){var w=d("../../plots/template_attributes").hovertemplateAttrs,c=d("../../lib/extend").extendFlat,M=d("../scatterpolar/attributes"),T=d("../bar/attributes");re.exports={r:M.r,theta:M.theta,r0:M.r0,dr:M.dr,theta0:M.theta0,dtheta:M.dtheta,thetaunit:M.thetaunit,base:c({},T.base,{}),offset:c({},T.offset,{}),width:c({},T.width,{}),text:c({},T.text,{}),hovertext:c({},T.hovertext,{}),marker:T.marker,hoverinfo:M.hoverinfo,hovertemplate:w(),selected:T.selected,unselected:T.unselected}},{"../../lib/extend":493,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatterpolar/attributes":1002}],666:[function(d,re,ne){var w=d("../../components/colorscale/helpers").hasColorscale,c=d("../../components/colorscale/calc"),M=d("../bar/arrays_to_calcdata"),T=d("../bar/cross_trace_calc").setGroupPositions,e=d("../scatter/calc_selection"),a=d("../../registry").traceIs,n=d("../../lib").extendFlat;function r(f,o){for(var i=f._fullLayout,g=o.subplot,p=i[g].radialaxis,y=i[g].angularaxis,h=p.makeCalcdata(o,"r"),m=y.makeCalcdata(o,"theta"),u=o._length,_=new Array(u),s=h,A=m,x=0;x<u;x++)_[x]={p:A[x],s:s[x]};function v(b){var l=o[b];l!==void 0&&(o["_"+b]=Array.isArray(l)?y.makeCalcdata(o,b):y.d2c(l,o.thetaunit))}return y.type==="linear"&&(v("width"),v("offset")),w(o,"marker")&&c(f,o,{vals:o.marker.color,containerStr:"marker",cLetter:"c"}),w(o,"marker.line")&&c(f,o,{vals:o.marker.line.color,containerStr:"marker.line",cLetter:"c"}),M(_,o),e(_,o),_}function t(f,o,i){for(var g=f.calcdata,p=[],y=0;y<g.length;y++){var h=g[y],m=h[0].trace;m.visible===!0&&a(m,"bar")&&m.subplot===i&&p.push(h)}var u=n({},o.radialaxis,{_id:"x"}),_=o.angularaxis;T(f,_,u,p,{mode:o.barmode,norm:o.barnorm,gap:o.bargap,groupgap:o.bargroupgap})}re.exports={calc:r,crossTraceCalc:t}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"../../lib":503,"../../registry":638,"../bar/arrays_to_calcdata":647,"../bar/cross_trace_calc":651,"../scatter/calc_selection":929}],667:[function(d,re,ne){var w=d("../../lib"),c=d("../scatterpolar/defaults").handleRThetaDefaults,M=d("../bar/style_defaults"),T=d("./attributes");re.exports=function(a,n,r,t){function f(i,g){return w.coerce(a,n,T,i,g)}var o=c(a,n,t,f);if(!o){n.visible=!1;return}f("thetaunit"),f("base"),f("offset"),f("width"),f("text"),f("hovertext"),f("hovertemplate"),M(a,n,f,r,t),w.coerceSelectionMarkerOpacity(n,f)}},{"../../lib":503,"../bar/style_defaults":663,"../scatterpolar/defaults":1004,"./attributes":665}],668:[function(d,re,ne){var w=d("../../components/fx"),c=d("../../lib"),M=d("../bar/hover").getTraceColor,T=c.fillText,e=d("../scatterpolar/hover").makeHoverPointText,a=d("../../plots/polar/helpers").isPtInsidePolygon;re.exports=function(r,t,f){var o=r.cd,i=o[0].trace,g=r.subplot,p=g.radialAxis,y=g.angularAxis,h=g.vangles,m=h?a:c.isPtInsideSector,u=r.maxHoverDistance,_=y._period||2*Math.PI,s=Math.abs(p.g2p(Math.sqrt(t*t+f*f))),A=Math.atan2(f,t);p.range[0]>p.range[1]&&(A+=Math.PI);var x=function(L){return m(s,A,[L.rp0,L.rp1],[L.thetag0,L.thetag1],h)?u+Math.min(1,Math.abs(L.thetag1-L.thetag0)/_)-1+(L.rp1-s)/(L.rp1-L.rp0)-1:1/0};if(w.getClosest(o,x,r),r.index!==!1){var v=r.index,b=o[v];r.x0=r.x1=b.ct[0],r.y0=r.y1=b.ct[1];var l=c.extendFlat({},b,{r:b.s,theta:b.p});return T(b,i,r),e(l,i,g,r),r.hovertemplate=i.hovertemplate,r.color=M(i,b),r.xLabelVal=r.yLabelVal=void 0,b.s<0&&(r.idealAlign="left"),[r]}}},{"../../components/fx":406,"../../lib":503,"../../plots/polar/helpers":621,"../bar/hover":655,"../scatterpolar/hover":1006}],669:[function(d,re,ne){re.exports={moduleType:"trace",name:"barpolar",basePlotModule:d("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("../scatterpolar/format_labels"),style:d("../bar/style").style,styleOnSelect:d("../bar/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../bar/select"),meta:{}}},{"../../plots/polar":622,"../bar/select":660,"../bar/style":662,"../scatter/marker_colorbar":945,"../scatterpolar/format_labels":1005,"./attributes":665,"./calc":666,"./defaults":667,"./hover":668,"./layout_attributes":670,"./layout_defaults":671,"./plot":672}],670:[function(d,re,ne){re.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],671:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes");re.exports=function(M,T,e){var a={},n;function r(o,i){return w.coerce(M[n]||{},T[n],c,o,i)}for(var t=0;t<e.length;t++){var f=e[t];f.type==="barpolar"&&f.visible===!0&&(n=f.subplot,a[n]||(r("barmode"),r("bargap"),a[n]=1))}}},{"../../lib":503,"./layout_attributes":670}],672:[function(d,re,ne){var w=d("@plotly/d3"),c=d("fast-isnumeric"),M=d("../../lib"),T=d("../../components/drawing"),e=d("../../plots/polar/helpers");re.exports=function(r,t,f){var o=t.xaxis,i=t.yaxis,g=t.radialAxis,p=t.angularAxis,y=a(t),h=t.layers.frontplot.select("g.barlayer");M.makeTraceGroups(h,f,"trace bars").each(function(){var m=w.select(this),u=M.ensureSingle(m,"g","points"),_=u.selectAll("g.point").data(M.identity);_.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),_.exit().remove(),_.each(function(s){var A=w.select(this),x=s.rp0=g.c2p(s.s0),v=s.rp1=g.c2p(s.s1),b=s.thetag0=p.c2g(s.p0),l=s.thetag1=p.c2g(s.p1),L;if(!c(x)||!c(v)||!c(b)||!c(l)||x===v||b===l)L="M0,0Z";else{var S=g.c2g(s.s1),k=(b+l)/2;s.ct=[o.c2p(S*Math.cos(k)),i.c2p(S*Math.sin(k))],L=y(x,v,b,l)}M.ensureSingle(A,"path").attr("d",L)}),T.setClipUrl(m,t._hasClipOnAxisFalse?t.clipIds.forTraces:null,r)})};function a(n){var r=n.cxx,t=n.cyy;return n.vangles?function(f,o,i,g){var p,y;M.angleDelta(i,g)>0?(p=i,y=g):(p=g,y=i);var h=e.findEnclosingVertexAngles(p,n.vangles)[0],m=e.findEnclosingVertexAngles(y,n.vangles)[1],u=[h,(p+y)/2,m];return e.pathPolygonAnnulus(f,o,p,y,u,r,t)}:function(f,o,i,g){return M.pathAnnulus(f,o,i,g,r,t)}}},{"../../components/drawing":388,"../../lib":503,"../../plots/polar/helpers":621,"@plotly/d3":58,"fast-isnumeric":190}],673:[function(d,re,ne){var w=d("../scatter/attributes"),c=d("../bar/attributes"),M=d("../../components/color/attributes"),T=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../lib/extend").extendFlat,n=w.marker,r=n.line;re.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:w.xperiod,yperiod:w.yperiod,xperiod0:w.xperiod0,yperiod0:w.yperiod0,xperiodalignment:w.xperiodalignment,yperiodalignment:w.yperiodalignment,xhoverformat:T("x"),yhoverformat:T("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:a({},n.symbol,{arrayOk:!1,editType:"plot"}),opacity:a({},n.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:a({},n.size,{arrayOk:!1,editType:"calc"}),color:a({},n.color,{arrayOk:!1,editType:"style"}),line:{color:a({},r.color,{arrayOk:!1,dflt:M.defaultLine,editType:"style"}),width:a({},r.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:w.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:c.offsetgroup,alignmentgroup:c.alignmentgroup,selected:{marker:w.selected.marker,editType:"style"},unselected:{marker:w.unselected.marker,editType:"style"},text:a({},w.text,{}),hovertext:a({},w.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":365,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatter/attributes":927}],674:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../plots/cartesian/axes"),M=d("../../plots/cartesian/align_period"),T=d("../../lib"),e=d("../../constants/numerical").BADNUM,a=T._;re.exports=function(A,x){var v=A._fullLayout,b=c.getFromId(A,x.xaxis||"x"),l=c.getFromId(A,x.yaxis||"y"),L=[],S=x.type==="violin"?"_numViolins":"_numBoxes",k,P,z,I,D,R,B;x.orientation==="h"?(z=b,I="x",D=l,R="y",B=!!x.yperiodalignment):(z=l,I="y",D=b,R="x",B=!!x.xperiodalignment);var F=n(x,R,D,v[S]),V=F[0],G=F[1],J=T.distinctVals(V,D),j=J.vals,Y=J.minDiff/2,X,oe,se,ie,N,U,q=(x.boxpoints||x.points)==="all"?T.identity:function(At){return At.v<X.lf||At.v>X.uf};if(x._hasPreCompStats){var Q=x[I],W=function(At){return z.d2c((x[At]||[])[k])},Z=1/0,ee=-1/0;for(k=0;k<x._length;k++){var te=V[k];if(!!w(te)){if(X={},X.pos=X[R]=te,B&&G&&(X.orig_p=G[k]),X.q1=W("q1"),X.med=W("median"),X.q3=W("q3"),oe=[],Q&&T.isArrayOrTypedArray(Q[k]))for(P=0;P<Q[k].length;P++)U=z.d2c(Q[k][P]),U!==e&&(N={v:U,i:[k,P]},o(N,x,[k,P]),oe.push(N));if(X.pts=oe.sort(g),se=X[I]=oe.map(p),ie=se.length,X.med!==e&&X.q1!==e&&X.q3!==e&&X.med>=X.q1&&X.q3>=X.med){var ae=W("lowerfence");X.lf=ae!==e&&ae<=X.q1?ae:y(X,se,ie);var le=W("upperfence");X.uf=le!==e&&le>=X.q3?le:h(X,se,ie);var ye=W("mean");X.mean=ye!==e?ye:ie?T.mean(se,ie):(X.q1+X.q3)/2;var fe=W("sd");X.sd=ye!==e&&fe>=0?fe:ie?T.stdev(se,ie,X.mean):X.q3-X.q1,X.lo=m(X),X.uo=u(X);var pe=W("notchspan");pe=pe!==e&&pe>0?pe:_(X,ie),X.ln=X.med-pe,X.un=X.med+pe;var ge=X.lf,Ae=X.uf;x.boxpoints&&se.length&&(ge=Math.min(ge,se[0]),Ae=Math.max(Ae,se[ie-1])),x.notched&&(ge=Math.min(ge,X.ln),Ae=Math.max(Ae,X.un)),X.min=ge,X.max=Ae}else{T.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+X.q1,"median = "+X.med,"q3 = "+X.q3].join(`
`));var we;X.med!==e?we=X.med:X.q1!==e?X.q3!==e?we=(X.q1+X.q3)/2:we=X.q1:X.q3!==e?we=X.q3:we=0,X.med=we,X.q1=X.q3=we,X.lf=X.uf=we,X.mean=X.sd=we,X.ln=X.un=we,X.min=X.max=we}Z=Math.min(Z,X.min),ee=Math.max(ee,X.max),X.pts2=oe.filter(q),L.push(X)}}x._extremes[z._id]=c.findExtremes(z,[Z,ee],{padded:!0})}else{var De=z.makeCalcdata(x,I),Be=r(j,Y),Ve=j.length,xe=t(Ve);for(k=0;k<x._length;k++)if(U=De[k],!!w(U)){var Le=T.findBin(V[k],Be);Le>=0&&Le<Ve&&(N={v:U,i:k},o(N,x,k),xe[Le].push(N))}var He=1/0,Je=-1/0,Oe=x.quartilemethod,Pe=Oe==="exclusive",Ue=Oe==="inclusive";for(k=0;k<Ve;k++)if(xe[k].length>0){if(X={},X.pos=X[R]=j[k],oe=X.pts=xe[k].sort(g),se=X[I]=oe.map(p),ie=se.length,X.min=se[0],X.max=se[ie-1],X.mean=T.mean(se,ie),X.sd=T.stdev(se,ie,X.mean),X.med=T.interp(se,.5),ie%2&&(Pe||Ue)){var vt,Lt;Pe?(vt=se.slice(0,ie/2),Lt=se.slice(ie/2+1)):Ue&&(vt=se.slice(0,ie/2+1),Lt=se.slice(ie/2)),X.q1=T.interp(vt,.5),X.q3=T.interp(Lt,.5)}else X.q1=T.interp(se,.25),X.q3=T.interp(se,.75);X.lf=y(X,se,ie),X.uf=h(X,se,ie),X.lo=m(X),X.uo=u(X);var Yt=_(X,ie);X.ln=X.med-Yt,X.un=X.med+Yt,He=Math.min(He,X.ln),Je=Math.max(Je,X.un),X.pts2=oe.filter(q),L.push(X)}x._extremes[z._id]=c.findExtremes(z,x.notched?De.concat([He,Je]):De,{padded:!0})}return i(L,x),L.length>0?(L[0].t={num:v[S],dPos:Y,posLetter:R,valLetter:I,labels:{med:a(A,"median:"),min:a(A,"min:"),q1:a(A,"q1:"),q3:a(A,"q3:"),max:a(A,"max:"),mean:x.boxmean==="sd"?a(A,"mean \xB1 \u03C3:"):a(A,"mean:"),lf:a(A,"lower fence:"),uf:a(A,"upper fence:")}},v[S]++,L):[{t:{empty:!0}}]};function n(s,A,x,v){var b=A in s,l=A+"0"in s,L="d"+A in s;if(b||l&&L){var S=x.makeCalcdata(s,A),k=M(s,x,A,S).vals;return[k,S]}var P;l?P=s[A+"0"]:"name"in s&&(x.type==="category"||w(s.name)&&["linear","log"].indexOf(x.type)!==-1||T.isDateTime(s.name)&&x.type==="date")?P=s.name:P=v;for(var z=x.type==="multicategory"?x.r2c_just_indices(P):x.d2c(P,0,s[A+"calendar"]),I=s._length,D=new Array(I),R=0;R<I;R++)D[R]=z;return[D]}function r(s,A){for(var x=s.length,v=new Array(x+1),b=0;b<x;b++)v[b]=s[b]-A;return v[x]=s[x-1]+A,v}function t(s){for(var A=new Array(s),x=0;x<s;x++)A[x]=[];return A}var f={text:"tx",hovertext:"htx"};function o(s,A,x){for(var v in f)T.isArrayOrTypedArray(A[v])&&(Array.isArray(x)?T.isArrayOrTypedArray(A[v][x[0]])&&(s[f[v]]=A[v][x[0]][x[1]]):s[f[v]]=A[v][x])}function i(s,A){if(T.isArrayOrTypedArray(A.selectedpoints))for(var x=0;x<s.length;x++){for(var v=s[x].pts||[],b={},l=0;l<v.length;l++)b[v[l].i]=l;T.tagSelected(v,A,b)}}function g(s,A){return s.v-A.v}function p(s){return s.v}function y(s,A,x){return x===0?s.q1:Math.min(s.q1,A[Math.min(T.findBin(2.5*s.q1-1.5*s.q3,A,!0)+1,x-1)])}function h(s,A,x){return x===0?s.q3:Math.max(s.q3,A[Math.max(T.findBin(2.5*s.q3-1.5*s.q1,A),0)])}function m(s){return 4*s.q1-3*s.q3}function u(s){return 4*s.q3-3*s.q1}function _(s,A){return A===0?0:1.57*(s.q3-s.q1)/Math.sqrt(A)}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"fast-isnumeric":190}],675:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("../../lib"),M=d("../../plots/cartesian/constraints").getAxisGroup,T=["v","h"];function e(n,r){for(var t=n.calcdata,f=r.xaxis,o=r.yaxis,i=0;i<T.length;i++){for(var g=T[i],p=g==="h"?o:f,y=[],h=0;h<t.length;h++){var m=t[h],u=m[0].t,_=m[0].trace;_.visible===!0&&(_.type==="box"||_.type==="candlestick")&&!u.empty&&(_.orientation||"v")===g&&_.xaxis===f._id&&_.yaxis===o._id&&y.push(h)}a("box",n,y,p)}}function a(n,r,t,f){var o=r.calcdata,i=r._fullLayout,g=f._id,p=g.charAt(0),y,h,m,u=[],_=0;for(y=0;y<t.length;y++)for(m=o[t[y]],h=0;h<m.length;h++)u.push(f.c2l(m[h].pos,!0)),_+=(m[h].pts2||[]).length;if(!!u.length){var s=c.distinctVals(u);(f.type==="category"||f.type==="multicategory")&&(s.minDiff=1);var A=s.minDiff/2;w.minDtick(f,s.minDiff,s.vals[0],!0);var x=n==="violin"?"_numViolins":"_numBoxes",v=i[x],b=i[n+"mode"]==="group"&&v>1,l=1-i[n+"gap"],L=1-i[n+"groupgap"];for(y=0;y<t.length;y++){m=o[t[y]];var S=m[0].trace,k=m[0].t,P=S.width,z=S.side,I,D,R,B;if(P)I=D=B=P/2,R=0;else if(I=A,b){var F=M(i,f._id)+S.orientation,V=i._alignmentOpts[F]||{},G=V[S.alignmentgroup]||{},J=Object.keys(G.offsetGroups||{}).length,j=J||v,Y=J?S._offsetIndex:k.num;D=I*l*L/j,R=2*I*(-.5+(Y+.5)/j)*l,B=I*l/j}else D=I*l*L,R=0,B=I;k.dPos=I,k.bPos=R,k.bdPos=D,k.wHover=B;var X,oe,se=R+D,ie,N,U,q,Q,W,Z=Boolean(P),ee=(S.boxpoints||S.points)&&_>0;if(z==="positive"?(X=I*(P?1:.5),ie=se,oe=ie=R):z==="negative"?(X=ie=R,oe=I*(P?1:.5),N=se):(X=oe=I,ie=N=se),ee){var te=S.pointpos,ae=S.jitter,le=S.marker.size/2,ye=0;te+ae>=0&&(ye=se*(te+ae),ye>X?(Z=!0,Q=le,U=ye):ye>ie&&(Q=le,U=X)),ye<=X&&(U=X);var fe=0;te-ae<=0&&(fe=-se*(te-ae),fe>oe?(Z=!0,W=le,q=fe):fe>N&&(W=le,q=oe)),fe<=oe&&(q=oe)}else U=X,q=oe;var pe=new Array(m.length);for(h=0;h<m.length;h++)pe[h]=m[h].pos;S._extremes[g]=w.findExtremes(f,pe,{padded:Z,vpadminus:q,vpadplus:U,vpadLinearized:!0,ppadminus:{x:W,y:Q}[p],ppadplus:{x:Q,y:W}[p]})}}}re.exports={crossTraceCalc:e,setPositionOffset:a}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../plots/cartesian/constraints":562}],676:[function(d,re,ne){var w=d("../../lib"),c=d("../../registry"),M=d("../../components/color"),T=d("../scatter/period_defaults"),e=d("../bar/defaults").handleGroupingDefaults,a=d("../../plots/cartesian/axis_autotype"),n=d("./attributes");function r(i,g,p,y){function h(b,l){return w.coerce(i,g,n,b,l)}if(t(i,g,h,y),g.visible!==!1){T(i,g,y,h),h("xhoverformat"),h("yhoverformat");var m=g._hasPreCompStats;m&&(h("lowerfence"),h("upperfence")),h("line.color",(i.marker||{}).color||p),h("line.width"),h("fillcolor",M.addOpacity(g.line.color,.5));var u=!1;if(m){var _=h("mean"),s=h("sd");_&&_.length&&(u=!0,s&&s.length&&(u="sd"))}h("boxmean",u),h("whiskerwidth"),h("width"),h("quartilemethod");var A=!1;if(m){var x=h("notchspan");x&&x.length&&(A=!0)}else w.validate(i.notchwidth,n.notchwidth)&&(A=!0);var v=h("notched",A);v&&h("notchwidth"),f(i,g,h,{prefix:"box"})}}function t(i,g,p,y){function h(J){var j=0;return J&&J.length&&(j+=1,w.isArrayOrTypedArray(J[0])&&J[0].length&&(j+=1)),j}function m(J){return w.validate(i[J],n[J])}var u=p("y"),_=p("x"),s;if(g.type==="box"){var A=p("q1"),x=p("median"),v=p("q3");g._hasPreCompStats=A&&A.length&&x&&x.length&&v&&v.length,s=Math.min(w.minRowLength(A),w.minRowLength(x),w.minRowLength(v))}var b=h(u),l=h(_),L=b&&w.minRowLength(u),S=l&&w.minRowLength(_),k=y.calendar,P={autotypenumbers:y.autotypenumbers},z,I;if(g._hasPreCompStats)switch(String(l)+String(b)){case"00":var D=m("x0")||m("dx"),R=m("y0")||m("dy");R&&!D?z="h":z="v",I=s;break;case"10":z="v",I=Math.min(s,S);break;case"20":z="h",I=Math.min(s,_.length);break;case"01":z="h",I=Math.min(s,L);break;case"02":z="v",I=Math.min(s,u.length);break;case"12":z="v",I=Math.min(s,S,u.length);break;case"21":z="h",I=Math.min(s,_.length,L);break;case"11":I=0;break;case"22":var B=!1,F;for(F=0;F<_.length;F++)if(a(_[F],k,P)==="category"){B=!0;break}if(B)z="v",I=Math.min(s,S,u.length);else{for(F=0;F<u.length;F++)if(a(u[F],k,P)==="category"){B=!0;break}B?(z="h",I=Math.min(s,_.length,L)):(z="v",I=Math.min(s,S,u.length))}break}else b>0?(z="v",l>0?I=Math.min(S,L):I=Math.min(L)):l>0?(z="h",I=Math.min(S)):I=0;if(!I){g.visible=!1;return}g._length=I;var V=p("orientation",z);g._hasPreCompStats?V==="v"&&l===0?(p("x0",0),p("dx",1)):V==="h"&&b===0&&(p("y0",0),p("dy",1)):V==="v"&&l===0?p("x0"):V==="h"&&b===0&&p("y0");var G=c.getComponentMethod("calendars","handleTraceDefaults");G(i,g,["x","y"],y)}function f(i,g,p,y){var h=y.prefix,m=w.coerce2(i,g,n,"marker.outliercolor"),u=p("marker.line.outliercolor"),_="outliers";g._hasPreCompStats?_="all":(m||u)&&(_="suspectedoutliers");var s=p(h+"points",_);s?(p("jitter",s==="all"?.3:0),p("pointpos",s==="all"?-1.5:0),p("marker.symbol"),p("marker.opacity"),p("marker.size"),p("marker.color",g.line.color),p("marker.line.color"),p("marker.line.width"),s==="suspectedoutliers"&&(p("marker.line.outliercolor",g.marker.color),p("marker.line.outlierwidth")),p("selected.marker.color"),p("unselected.marker.color"),p("selected.marker.size"),p("unselected.marker.size"),p("text"),p("hovertext")):delete g.marker;var A=p("hoveron");(A==="all"||A.indexOf("points")!==-1)&&p("hovertemplate"),w.coerceSelectionMarkerOpacity(g,p)}function o(i,g){var p,y;function h(_){return w.coerce(y._input,y,n,_)}for(var m=0;m<i.length;m++){y=i[m];var u=y.type;(u==="box"||u==="violin")&&(p=y._input,g[u+"mode"]==="group"&&e(p,y,g,h))}}re.exports={supplyDefaults:r,crossTraceDefaults:o,handleSampleDefaults:t,handlePointsDefaults:f}},{"../../components/color":366,"../../lib":503,"../../plots/cartesian/axis_autotype":555,"../../registry":638,"../bar/defaults":652,"../scatter/period_defaults":947,"./attributes":673}],677:[function(d,re,ne){re.exports=function(c,M){return M.hoverOnBox&&(c.hoverOnBox=M.hoverOnBox),"xVal"in M&&(c.x=M.xVal),"yVal"in M&&(c.y=M.yVal),M.xa&&(c.xaxis=M.xa),M.ya&&(c.yaxis=M.ya),c}},{}],678:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("../../lib"),M=d("../../components/fx"),T=d("../../components/color"),e=c.fillText;function a(t,f,o,i){var g=t.cd,p=g[0].trace,y=p.hoveron,h=[],m;return y.indexOf("boxes")!==-1&&(h=h.concat(n(t,f,o,i))),y.indexOf("points")!==-1&&(m=r(t,f,o)),i==="closest"?m?[m]:h:(m&&h.push(m),h)}function n(t,f,o,i){var g=t.cd,p=t.xa,y=t.ya,h=g[0].trace,m=g[0].t,u=h.type==="violin",_=[],s,A,x,v,b,l,L,S,k,P,z,I=m.bdPos,D,R,B=m.wHover,F=function(ee){return x.c2l(ee.pos)+m.bPos-x.c2l(l)};u&&h.side!=="both"?(h.side==="positive"&&(k=function(ee){var te=F(ee);return M.inbox(te,te+B,P)},D=I,R=0),h.side==="negative"&&(k=function(ee){var te=F(ee);return M.inbox(te-B,te,P)},D=0,R=I)):(k=function(ee){var te=F(ee);return M.inbox(te-B,te+B,P)},D=R=I);var V;u?V=function(ee){return M.inbox(ee.span[0]-b,ee.span[1]-b,P)}:V=function(ee){return M.inbox(ee.min-b,ee.max-b,P)},h.orientation==="h"?(b=f,l=o,L=V,S=k,s="y",x=y,A="x",v=p):(b=o,l=f,L=k,S=V,s="x",x=p,A="y",v=y);var G=Math.min(1,I/Math.abs(x.r2c(x.range[1])-x.r2c(x.range[0])));P=t.maxHoverDistance-G,z=t.maxSpikeDistance-G;function J(ee){return(L(ee)+S(ee))/2}var j=M.getDistanceFunction(i,L,S,J);if(M.getClosest(g,j,t),t.index===!1)return[];var Y=g[t.index],X=h.line.color,oe=(h.marker||{}).color;T.opacity(X)&&h.line.width?t.color=X:T.opacity(oe)&&h.boxpoints?t.color=oe:t.color=h.fillcolor,t[s+"0"]=x.c2p(Y.pos+m.bPos-R,!0),t[s+"1"]=x.c2p(Y.pos+m.bPos+D,!0),t[s+"LabelVal"]=Y.orig_p!==void 0?Y.orig_p:Y.pos;var se=s+"Spike";t.spikeDistance=J(Y)*z/P,t[se]=x.c2p(Y.pos,!0);var ie={},N=["med","q1","q3","min","max"];(h.boxmean||(h.meanline||{}).visible)&&N.push("mean"),(h.boxpoints||h.points)&&N.push("lf","uf");for(var U=0;U<N.length;U++){var q=N[U];if(!(!(q in Y)||Y[q]in ie)){ie[Y[q]]=!0;var Q=Y[q],W=v.c2p(Q,!0),Z=c.extendFlat({},t);Z.attr=q,Z[A+"0"]=Z[A+"1"]=W,Z[A+"LabelVal"]=Q,Z[A+"Label"]=(m.labels?m.labels[q]+" ":"")+w.hoverLabelText(v,Q,h[A+"hoverformat"]),Z.hoverOnBox=!0,q==="mean"&&"sd"in Y&&h.boxmean==="sd"&&(Z[A+"err"]=Y.sd),t.name="",t.spikeDistance=void 0,t[se]=void 0,Z.hovertemplate=!1,_.push(Z)}}return _}function r(t,f,o){for(var i=t.cd,g=t.xa,p=t.ya,y=i[0].trace,h=g.c2p(f),m=p.c2p(o),u,_=function(F){var V=Math.max(3,F.mrc||0);return Math.max(Math.abs(g.c2p(F.x)-h)-V,1-3/V)},s=function(F){var V=Math.max(3,F.mrc||0);return Math.max(Math.abs(p.c2p(F.y)-m)-V,1-3/V)},A=M.quadrature(_,s),x=!1,v,b,l=0;l<i.length;l++){v=i[l];for(var L=0;L<(v.pts||[]).length;L++){b=v.pts[L];var S=A(b);S<=t.distance&&(t.distance=S,x=[l,L])}}if(!x)return!1;v=i[x[0]],b=v.pts[x[1]];var k=g.c2p(b.x,!0),P=p.c2p(b.y,!0),z=b.mrc||1;u=c.extendFlat({},t,{index:b.i,color:(y.marker||{}).color,name:y.name,x0:k-z,x1:k+z,y0:P-z,y1:P+z,spikeDistance:t.distance,hovertemplate:y.hovertemplate});var I=v.orig_p,D=I!==void 0?I:v.pos,R;y.orientation==="h"?(R=p,u.xLabelVal=b.x,u.yLabelVal=D):(R=g,u.xLabelVal=D,u.yLabelVal=b.y);var B=R._id.charAt(0);return u[B+"Spike"]=R.c2p(v.pos,!0),e(b,y,u),u}re.exports={hoverPoints:a,hoverOnBoxes:n,hoverOnPoints:r}},{"../../components/color":366,"../../components/fx":406,"../../lib":503,"../../plots/cartesian/axes":554}],679:[function(d,re,ne){re.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults").supplyLayoutDefaults,calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc").crossTraceCalc,plot:d("./plot").plot,style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"box",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"./attributes":673,"./calc":674,"./cross_trace_calc":675,"./defaults":676,"./event_data":677,"./hover":678,"./layout_attributes":680,"./layout_defaults":681,"./plot":682,"./select":683,"./style":684}],680:[function(d,re,ne){re.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],681:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib"),M=d("./layout_attributes");function T(a,n,r,t,f){for(var o=f+"Layout",i=!1,g=0;g<r.length;g++){var p=r[g];if(w.traceIs(p,o)){i=!0;break}}!i||(t(f+"mode"),t(f+"gap"),t(f+"groupgap"))}function e(a,n,r){function t(f,o){return c.coerce(a,n,M,f,o)}T(a,n,r,t,"box")}re.exports={supplyLayoutDefaults:e,_supply:T}},{"../../lib":503,"../../registry":638,"./layout_attributes":680}],682:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../components/drawing"),T=5,e=.01;function a(f,o,i,g){var p=o.xaxis,y=o.yaxis;c.makeTraceGroups(g,i,"trace boxes").each(function(h){var m=w.select(this),u=h[0],_=u.t,s=u.trace;if(_.wdPos=_.bdPos*s.whiskerwidth,s.visible!==!0||_.empty){m.remove();return}var A,x;s.orientation==="h"?(A=y,x=p):(A=p,x=y),n(m,{pos:A,val:x},s,_),r(m,{x:p,y},s,_),t(m,{pos:A,val:x},s,_)})}function n(f,o,i,g){var p=i.orientation==="h",y=o.val,h=o.pos,m=!!h.rangebreaks,u=g.bPos,_=g.wdPos||0,s=g.bPosPxOffset||0,A=i.whiskerwidth||0,x=i.notched||!1,v=x?1-2*i.notchwidth:1,b,l;Array.isArray(g.bdPos)?(b=g.bdPos[0],l=g.bdPos[1]):(b=g.bdPos,l=g.bdPos);var L=f.selectAll("path.box").data(i.type!=="violin"||i.box.visible?c.identity:[]);L.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),L.exit().remove(),L.each(function(S){if(S.empty)return"M0,0Z";var k=h.c2l(S.pos+u,!0),P=h.l2p(k-b)+s,z=h.l2p(k+l)+s,I=m?(P+z)/2:h.l2p(k)+s,D=i.whiskerwidth,R=m?P*D+(1-D)*I:h.l2p(k-_)+s,B=m?z*D+(1-D)*I:h.l2p(k+_)+s,F=h.l2p(k-b*v)+s,V=h.l2p(k+l*v)+s,G=y.c2p(S.q1,!0),J=y.c2p(S.q3,!0),j=c.constrain(y.c2p(S.med,!0),Math.min(G,J)+1,Math.max(G,J)-1),Y=S.lf===void 0||i.boxpoints===!1,X=y.c2p(Y?S.min:S.lf,!0),oe=y.c2p(Y?S.max:S.uf,!0),se=y.c2p(S.ln,!0),ie=y.c2p(S.un,!0);p?w.select(this).attr("d","M"+j+","+F+"V"+V+"M"+G+","+P+"V"+z+(x?"H"+se+"L"+j+","+V+"L"+ie+","+z:"")+"H"+J+"V"+P+(x?"H"+ie+"L"+j+","+F+"L"+se+","+P:"")+"ZM"+G+","+I+"H"+X+"M"+J+","+I+"H"+oe+(A===0?"":"M"+X+","+R+"V"+B+"M"+oe+","+R+"V"+B)):w.select(this).attr("d","M"+F+","+j+"H"+V+"M"+P+","+G+"H"+z+(x?"V"+se+"L"+V+","+j+"L"+z+","+ie:"")+"V"+J+"H"+P+(x?"V"+ie+"L"+F+","+j+"L"+P+","+se:"")+"ZM"+I+","+G+"V"+X+"M"+I+","+J+"V"+oe+(A===0?"":"M"+R+","+X+"H"+B+"M"+R+","+oe+"H"+B))})}function r(f,o,i,g){var p=o.x,y=o.y,h=g.bdPos,m=g.bPos,u=i.boxpoints||i.points;c.seedPseudoRandom();var _=function(x){return x.forEach(function(v){v.t=g,v.trace=i}),x},s=f.selectAll("g.points").data(u?_:[]);s.enter().append("g").attr("class","points"),s.exit().remove();var A=s.selectAll("path").data(function(x){var v,b=x.pts2,l=Math.max((x.max-x.min)/10,x.q3-x.q1),L=l*1e-9,S=l*e,k=[],P=0,z;if(i.jitter){if(l===0)for(P=1,k=new Array(b.length),v=0;v<b.length;v++)k[v]=1;else for(v=0;v<b.length;v++){var I=Math.max(0,v-T),D=b[I].v,R=Math.min(b.length-1,v+T),B=b[R].v;u!=="all"&&(b[v].v<x.lf?B=Math.min(B,x.lf):D=Math.max(D,x.uf));var F=Math.sqrt(S*(R-I)/(B-D+L))||0;F=c.constrain(Math.abs(F),0,1),k.push(F),P=Math.max(F,P)}z=i.jitter*2/(P||1)}for(v=0;v<b.length;v++){var V=b[v],G=V.v,J=i.jitter?z*k[v]*(c.pseudoRandom()-.5):0,j=x.pos+m+h*(i.pointpos+J);i.orientation==="h"?(V.y=j,V.x=G):(V.x=j,V.y=G),u==="suspectedoutliers"&&G<x.uo&&G>x.lo&&(V.so=!0)}return b});A.enter().append("path").classed("point",!0),A.exit().remove(),A.call(M.translatePoints,p,y)}function t(f,o,i,g){var p=o.val,y=o.pos,h=!!y.rangebreaks,m=g.bPos,u=g.bPosPxOffset||0,_=i.boxmean||(i.meanline||{}).visible,s,A;Array.isArray(g.bdPos)?(s=g.bdPos[0],A=g.bdPos[1]):(s=g.bdPos,A=g.bdPos);var x=f.selectAll("path.mean").data(i.type==="box"&&i.boxmean||i.type==="violin"&&i.box.visible&&i.meanline.visible?c.identity:[]);x.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),x.exit().remove(),x.each(function(v){var b=y.c2l(v.pos+m,!0),l=y.l2p(b-s)+u,L=y.l2p(b+A)+u,S=h?(l+L)/2:y.l2p(b)+u,k=p.c2p(v.mean,!0),P=p.c2p(v.mean-v.sd,!0),z=p.c2p(v.mean+v.sd,!0);i.orientation==="h"?w.select(this).attr("d","M"+k+","+l+"V"+L+(_==="sd"?"m0,0L"+P+","+S+"L"+k+","+l+"L"+z+","+S+"Z":"")):w.select(this).attr("d","M"+l+","+k+"H"+L+(_==="sd"?"m0,0L"+S+","+P+"L"+l+","+k+"L"+S+","+z+"Z":""))})}re.exports={plot:a,plotBoxAndWhiskers:n,plotPoints:r,plotBoxMean:t}},{"../../components/drawing":388,"../../lib":503,"@plotly/d3":58}],683:[function(d,re,ne){re.exports=function(c,M){var T=c.cd,e=c.xaxis,a=c.yaxis,n=[],r,t;if(M===!1)for(r=0;r<T.length;r++)for(t=0;t<(T[r].pts||[]).length;t++)T[r].pts[t].selected=0;else for(r=0;r<T.length;r++)for(t=0;t<(T[r].pts||[]).length;t++){var f=T[r].pts[t],o=e.c2p(f.x),i=a.c2p(f.y);M.contains([o,i],null,f.i,c)?(n.push({pointNumber:f.i,x:e.c2d(f.x),y:a.c2d(f.y)}),f.selected=1):f.selected=0}return n}},{}],684:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/color"),M=d("../../components/drawing");function T(a,n,r){var t=r||w.select(a).selectAll("g.trace.boxes");t.style("opacity",function(f){return f[0].trace.opacity}),t.each(function(f){var o=w.select(this),i=f[0].trace,g=i.line.width;function p(m,u,_,s){m.style("stroke-width",u+"px").call(c.stroke,_).call(c.fill,s)}var y=o.selectAll("path.box");if(i.type==="candlestick")y.each(function(m){if(!m.empty){var u=w.select(this),_=i[m.dir];p(u,_.line.width,_.line.color,_.fillcolor),u.style("opacity",i.selectedpoints&&!m.selected?.3:1)}});else{p(y,g,i.line.color,i.fillcolor),o.selectAll("path.mean").style({"stroke-width":g,"stroke-dasharray":2*g+"px,"+g+"px"}).call(c.stroke,i.line.color);var h=o.selectAll("path.point");M.pointStyle(h,i,a)}})}function e(a,n,r){var t=n[0].trace,f=r.selectAll("path.point");t.selectedpoints?M.selectedPointStyle(f,t):M.pointStyle(f,t,a)}re.exports={style:T,styleOnSelect:e}},{"../../components/color":366,"../../components/drawing":388,"@plotly/d3":58}],685:[function(d,re,ne){var w=d("../../lib").extendFlat,c=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../ohlc/attributes"),T=d("../box/attributes");function e(a){return{line:{color:w({},T.line.color,{dflt:a}),width:T.line.width,editType:"style"},fillcolor:T.fillcolor,editType:"style"}}re.exports={xperiod:M.xperiod,xperiod0:M.xperiod0,xperiodalignment:M.xperiodalignment,xhoverformat:c("x"),yhoverformat:c("y"),x:M.x,open:M.open,high:M.high,low:M.low,close:M.close,line:{width:w({},T.line.width,{}),editType:"style"},increasing:e(M.increasing.line.color.dflt),decreasing:e(M.decreasing.line.color.dflt),text:M.text,hovertext:M.hovertext,whiskerwidth:w({},T.whiskerwidth,{dflt:0}),hoverlabel:M.hoverlabel}},{"../../lib":503,"../../plots/cartesian/axis_format_attributes":557,"../box/attributes":673,"../ohlc/attributes":872}],686:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes"),M=d("../../plots/cartesian/align_period"),T=d("../ohlc/calc").calcCommon;re.exports=function(a,n){var r=a._fullLayout,t=c.getFromId(a,n.xaxis),f=c.getFromId(a,n.yaxis),o=t.makeCalcdata(n,"x"),i=M(n,t,"x",o).vals,g=T(a,n,o,i,f,e);return g.length?(w.extendFlat(g[0].t,{num:r._numBoxes,dPos:w.distinctVals(i).minDiff/2,posLetter:"x",valLetter:"y"}),r._numBoxes++,g):[{t:{empty:!0}}]};function e(a,n,r,t){return{min:r,q1:Math.min(a,t),med:t,q3:Math.max(a,t),max:n}}},{"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../ohlc/calc":873}],687:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/color"),M=d("../ohlc/ohlc_defaults"),T=d("../scatter/period_defaults"),e=d("./attributes");re.exports=function(r,t,f,o){function i(p,y){return w.coerce(r,t,e,p,y)}var g=M(r,t,i,o);if(!g){t.visible=!1;return}T(r,t,o,i,{x:!0}),i("xhoverformat"),i("yhoverformat"),i("line.width"),a(r,t,i,"increasing"),a(r,t,i,"decreasing"),i("text"),i("hovertext"),i("whiskerwidth"),o._requestRangeslider[t.xaxis]=!0};function a(n,r,t,f){var o=t(f+".line.color");t(f+".line.width",r.line.width),t(f+".fillcolor",c.addOpacity(o,.5))}},{"../../components/color":366,"../../lib":503,"../ohlc/ohlc_defaults":877,"../scatter/period_defaults":947,"./attributes":685}],688:[function(d,re,ne){re.exports={moduleType:"trace",name:"candlestick",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:d("./attributes"),layoutAttributes:d("../box/layout_attributes"),supplyLayoutDefaults:d("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:d("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("../box/plot").plot,layerName:"boxlayer",style:d("../box/style").style,hoverPoints:d("../ohlc/hover").hoverPoints,selectPoints:d("../ohlc/select")}},{"../../plots/cartesian":568,"../box/cross_trace_calc":675,"../box/layout_attributes":680,"../box/layout_defaults":681,"../box/plot":682,"../box/style":684,"../ohlc/hover":875,"../ohlc/select":879,"./attributes":685,"./calc":686,"./defaults":687}],689:[function(d,re,ne){var w=d("./axis_defaults"),c=d("../../plot_api/plot_template");re.exports=function(e,a,n,r,t){var f=r("a");f||(r("da"),r("a0"));var o=r("b");o||(r("db"),r("b0")),M(e,a,n,t)};function M(T,e,a,n){var r=["aaxis","baxis"];r.forEach(function(t){var f=t.charAt(0),o=T[t]||{},i=c.newContainer(e,t),g={noTicklabelstep:!0,tickfont:"x",id:f+"axis",letter:f,font:e.font,name:t,data:T[f],calendar:e.calendar,dfltColor:n,bgColor:a.paper_bgcolor,autotypenumbersDflt:a.autotypenumbers,fullLayout:a};w(o,i,g),i._categories=i._categories||[],!T[t]&&o.type!=="-"&&(T[t]={type:o.type})})}},{"../../plot_api/plot_template":543,"./axis_defaults":694}],690:[function(d,re,ne){var w=d("../../lib").isArrayOrTypedArray;re.exports=function(M){return c(M,0)};function c(M,T){if(!w(M)||T>=10)return null;for(var e=1/0,a=-1/0,n=M.length,r=0;r<n;r++){var t=M[r];if(w(t)){var f=c(t,T+1);f&&(e=Math.min(f[0],e),a=Math.max(f[1],a))}else e=Math.min(t,e),a=Math.max(t,a)}return[e,a]}},{"../../lib":503}],691:[function(d,re,ne){var w=d("../../plots/font_attributes"),c=d("./axis_attributes"),M=d("../../components/color/attributes"),T=w({editType:"calc"});T.family.dflt='"Open Sans", verdana, arial, sans-serif',T.size.dflt=12,T.color.dflt=M.defaultLine,re.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:c,baxis:c,font:T,color:{valType:"color",dflt:M.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":365,"../../plots/font_attributes":585,"./axis_attributes":693}],692:[function(d,re,ne){var w=d("../../lib").isArrayOrTypedArray;re.exports=function(c,M,T,e){var a,n,r,t,f,o,i,g,p,y,h,m,u,_=w(T)?"a":"b",s=_==="a"?c.aaxis:c.baxis,A=s.smoothing,x=_==="a"?c.a2i:c.b2j,v=_==="a"?T:e,b=_==="a"?e:T,l=_==="a"?M.a.length:M.b.length,L=_==="a"?M.b.length:M.a.length,S=Math.floor(_==="a"?c.b2j(b):c.a2i(b)),k=_==="a"?function(Y){return c.evalxy([],Y,S)}:function(Y){return c.evalxy([],S,Y)};A&&(r=Math.max(0,Math.min(L-2,S)),t=S-r,n=_==="a"?function(Y,X){return c.dxydi([],Y,r,X,t)}:function(Y,X){return c.dxydj([],r,Y,t,X)});var P=x(v[0]),z=x(v[1]),I=P<z?1:-1,D=(z-P)*1e-8,R=I>0?Math.floor:Math.ceil,B=I>0?Math.ceil:Math.floor,F=I>0?Math.min:Math.max,V=I>0?Math.max:Math.min,G=R(P+D),J=B(z-D);i=k(P);var j=[[i]];for(a=G;a*I<J*I;a+=I)f=[],h=V(P,a),m=F(z,a+I),u=m-h,o=Math.max(0,Math.min(l-2,Math.floor(.5*(h+m)))),g=k(m),A&&(p=n(o,h-o),y=n(o,m-o),f.push([i[0]+p[0]/3*u,i[1]+p[1]/3*u]),f.push([g[0]-y[0]/3*u,g[1]-y[1]/3*u])),f.push(g),j.push(f),i=g;return j}},{"../../lib":503}],693:[function(d,re,ne){var w=d("../../plots/font_attributes"),c=d("../../components/color/attributes"),M=d("../../plots/cartesian/layout_attributes"),T=d("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=d("../../plot_api/edit_types").overrideAll;re.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:w({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:M.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:w({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:T("tick label")},tickformatstops:e(M.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:c.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:c.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:w({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":365,"../../plot_api/edit_types":536,"../../plots/cartesian/axis_format_attributes":557,"../../plots/cartesian/layout_attributes":569,"../../plots/font_attributes":585}],694:[function(d,re,ne){var w=d("./attributes"),c=d("../../components/color").addOpacity,M=d("../../registry"),T=d("../../lib"),e=d("../../plots/cartesian/tick_value_defaults"),a=d("../../plots/cartesian/tick_label_defaults"),n=d("../../plots/cartesian/prefix_suffix_defaults"),r=d("../../plots/cartesian/category_order_defaults"),t=d("../../plots/cartesian/set_convert"),f=d("../../plots/cartesian/axis_autotype");re.exports=function(g,p,y){var h=y.letter,m=y.font||{},u=w[h+"axis"];function _(V,G){return T.coerce(g,p,u,V,G)}function s(V,G){return T.coerce2(g,p,u,V,G)}y.name&&(p._name=y.name,p._id=y.name),_("autotypenumbers",y.autotypenumbersDflt);var A=_("type");if(A==="-"&&(y.data&&o(p,y.data),p.type==="-"?p.type="linear":A=g.type=p.type),_("smoothing"),_("cheatertype"),_("showticklabels"),_("labelprefix",h+" = "),_("labelsuffix"),_("showtickprefix"),_("showticksuffix"),_("separatethousands"),_("tickformat"),_("exponentformat"),_("minexponent"),_("showexponent"),_("categoryorder"),_("tickmode"),_("tickvals"),_("ticktext"),_("tick0"),_("dtick"),p.tickmode==="array"&&(_("arraytick0"),_("arraydtick")),_("labelpadding"),p._hovertitle=h,A==="date"){var x=M.getComponentMethod("calendars","handleDefaults");x(g,p,"calendar",y.calendar)}t(p,y.fullLayout),p.c2p=T.identity;var v=_("color",y.dfltColor),b=v===g.color?v:m.color,l=_("title.text");l&&(T.coerceFont(_,"title.font",{family:m.family,size:T.bigFont(m.size),color:b}),_("title.offset")),_("tickangle");var L=_("autorange",!p.isValidRange(g.range));L&&_("rangemode"),_("range"),p.cleanRange(),_("fixedrange"),e(g,p,_,A),n(g,p,_,A,y),a(g,p,_,A,y),r(g,p,_,{data:y.data,dataAttr:h});var S=s("gridcolor",c(v,.3)),k=s("gridwidth"),P=_("showgrid");P||(delete p.gridcolor,delete p.gridwidth);var z=s("startlinecolor",v),I=s("startlinewidth",k),D=_("startline",p.showgrid||!!z||!!I);D||(delete p.startlinecolor,delete p.startlinewidth);var R=s("endlinecolor",v),B=s("endlinewidth",k),F=_("endline",p.showgrid||!!R||!!B);return F||(delete p.endlinecolor,delete p.endlinewidth),P?(_("minorgridcount"),_("minorgridwidth",k),_("minorgridcolor",c(S,.06)),p.minorgridcount||(delete p.minorgridwidth,delete p.minorgridcolor)):(delete p.gridcolor,delete p.gridWidth),p.showticklabels==="none"&&(delete p.tickfont,delete p.tickangle,delete p.showexponent,delete p.exponentformat,delete p.minexponent,delete p.tickformat,delete p.showticksuffix,delete p.showtickprefix),p.showticksuffix||delete p.ticksuffix,p.showtickprefix||delete p.tickprefix,_("tickmode"),p};function o(i,g){if(i.type==="-"){var p=i._id,y=p.charAt(0),h=y+"calendar",m=i[h];i.type=f(g,m,{autotypenumbers:i.autotypenumbers})}}},{"../../components/color":366,"../../lib":503,"../../plots/cartesian/axis_autotype":555,"../../plots/cartesian/category_order_defaults":559,"../../plots/cartesian/prefix_suffix_defaults":573,"../../plots/cartesian/set_convert":576,"../../plots/cartesian/tick_label_defaults":578,"../../plots/cartesian/tick_value_defaults":580,"../../registry":638,"./attributes":691}],695:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("../../lib").isArray1D,M=d("./cheater_basis"),T=d("./array_minmax"),e=d("./calc_gridlines"),a=d("./calc_labels"),n=d("./calc_clippath"),r=d("../heatmap/clean_2d_array"),t=d("./smooth_fill_2d_array"),f=d("../heatmap/convert_column_xyz"),o=d("./set_convert");re.exports=function(g,p){var y=w.getFromId(g,p.xaxis),h=w.getFromId(g,p.yaxis),m=p.aaxis,u=p.baxis,_=p.x,s=p.y,A=[];_&&c(_)&&A.push("x"),s&&c(s)&&A.push("y"),A.length&&f(p,m,u,"a","b",A);var x=p._a=p._a||p.a,v=p._b=p._b||p.b;_=p._x||p.x,s=p._y||p.y;var b={};if(p._cheater){var l=m.cheatertype==="index"?x.length:x,L=u.cheatertype==="index"?v.length:v;_=M(l,L,p.cheaterslope)}p._x=_=r(_),p._y=s=r(s),t(_,x,v),t(s,x,v),o(p),p.setScale();var S=T(_),k=T(s),P=.5*(S[1]-S[0]),z=.5*(S[1]+S[0]),I=.5*(k[1]-k[0]),D=.5*(k[1]+k[0]),R=1.3;return S=[z-P*R,z+P*R],k=[D-I*R,D+I*R],p._extremes[y._id]=w.findExtremes(y,S,{padded:!0}),p._extremes[h._id]=w.findExtremes(h,k,{padded:!0}),e(p,"a","b"),e(p,"b","a"),a(p,m),a(p,u),b.clipsegments=n(p._xctrl,p._yctrl,m,u),b.x=_,b.y=s,b.a=x,b.b=v,[b]}},{"../../lib":503,"../../plots/cartesian/axes":554,"../heatmap/clean_2d_array":794,"../heatmap/convert_column_xyz":796,"./array_minmax":690,"./calc_clippath":696,"./calc_gridlines":697,"./calc_labels":698,"./cheater_basis":700,"./set_convert":713,"./smooth_fill_2d_array":714}],696:[function(d,re,ne){re.exports=function(c,M,T,e){var a,n,r,t=[],f=!!T.smoothing,o=!!e.smoothing,i=c[0].length-1,g=c.length-1;for(a=0,n=[],r=[];a<=i;a++)n[a]=c[0][a],r[a]=M[0][a];for(t.push({x:n,y:r,bicubic:f}),a=0,n=[],r=[];a<=g;a++)n[a]=c[a][i],r[a]=M[a][i];for(t.push({x:n,y:r,bicubic:o}),a=i,n=[],r=[];a>=0;a--)n[i-a]=c[g][a],r[i-a]=M[g][a];for(t.push({x:n,y:r,bicubic:f}),a=g,n=[],r=[];a>=0;a--)n[g-a]=c[a][0],r[g-a]=M[a][0];return t.push({x:n,y:r,bicubic:o}),t}},{}],697:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("../../lib/extend").extendFlat;re.exports=function(T,e,a){var n,r,t,f,o,i,g,p,y,h,m,u,_,s,A=T["_"+e],x=T[e+"axis"],v=x._gridlines=[],b=x._minorgridlines=[],l=x._boundarylines=[],L=T["_"+a],S=T[a+"axis"];x.tickmode==="array"&&(x.tickvals=A.slice());var k=T._xctrl,P=T._yctrl,z=k[0].length,I=k.length,D=T._a.length,R=T._b.length;w.prepTicks(x),x.tickmode==="array"&&delete x.tickvals;var B=x.smoothing?3:1;function F(G){var J,j,Y,X,oe,se,ie,N,U,q,Q,W,Z=[],ee=[],te={};if(e==="b")for(j=T.b2j(G),Y=Math.floor(Math.max(0,Math.min(R-2,j))),X=j-Y,te.length=R,te.crossLength=D,te.xy=function(ae){return T.evalxy([],ae,j)},te.dxy=function(ae,le){return T.dxydi([],ae,Y,le,X)},J=0;J<D;J++)se=Math.min(D-2,J),ie=J-se,N=T.evalxy([],J,j),S.smoothing&&J>0&&(U=T.dxydi([],J-1,Y,0,X),Z.push(oe[0]+U[0]/3),ee.push(oe[1]+U[1]/3),q=T.dxydi([],J-1,Y,1,X),Z.push(N[0]-q[0]/3),ee.push(N[1]-q[1]/3)),Z.push(N[0]),ee.push(N[1]),oe=N;else for(J=T.a2i(G),se=Math.floor(Math.max(0,Math.min(D-2,J))),ie=J-se,te.length=D,te.crossLength=R,te.xy=function(ae){return T.evalxy([],J,ae)},te.dxy=function(ae,le){return T.dxydj([],se,ae,ie,le)},j=0;j<R;j++)Y=Math.min(R-2,j),X=j-Y,N=T.evalxy([],J,j),S.smoothing&&j>0&&(Q=T.dxydj([],se,j-1,ie,0),Z.push(oe[0]+Q[0]/3),ee.push(oe[1]+Q[1]/3),W=T.dxydj([],se,j-1,ie,1),Z.push(N[0]-W[0]/3),ee.push(N[1]-W[1]/3)),Z.push(N[0]),ee.push(N[1]),oe=N;return te.axisLetter=e,te.axis=x,te.crossAxis=S,te.value=G,te.constvar=a,te.index=p,te.x=Z,te.y=ee,te.smoothing=S.smoothing,te}function V(G){var J,j,Y,X,oe,se=[],ie=[],N={};if(N.length=A.length,N.crossLength=L.length,e==="b")for(Y=Math.max(0,Math.min(R-2,G)),oe=Math.min(1,Math.max(0,G-Y)),N.xy=function(U){return T.evalxy([],U,G)},N.dxy=function(U,q){return T.dxydi([],U,Y,q,oe)},J=0;J<z;J++)se[J]=k[G*B][J],ie[J]=P[G*B][J];else for(j=Math.max(0,Math.min(D-2,G)),X=Math.min(1,Math.max(0,G-j)),N.xy=function(U){return T.evalxy([],G,U)},N.dxy=function(U,q){return T.dxydj([],j,U,X,q)},J=0;J<I;J++)se[J]=k[J][G*B],ie[J]=P[J][G*B];return N.axisLetter=e,N.axis=x,N.crossAxis=S,N.value=A[G],N.constvar=a,N.index=G,N.x=se,N.y=ie,N.smoothing=S.smoothing,N}if(x.tickmode==="array"){for(f=5e-15,o=[Math.floor((A.length-1-x.arraytick0)/x.arraydtick*(1+f)),Math.ceil(-x.arraytick0/x.arraydtick/(1+f))].sort(function(G,J){return G-J}),i=o[0]-1,g=o[1]+1,p=i;p<g;p++)r=x.arraytick0+x.arraydtick*p,!(r<0||r>A.length-1)&&v.push(c(V(r),{color:x.gridcolor,width:x.gridwidth}));for(p=i;p<g;p++)if(t=x.arraytick0+x.arraydtick*p,m=Math.min(t+x.arraydtick,A.length-1),!(t<0||t>A.length-1)&&!(m<0||m>A.length-1))for(u=A[t],_=A[m],n=0;n<x.minorgridcount;n++)s=m-t,!(s<=0)&&(h=u+(_-u)*(n+1)/(x.minorgridcount+1)*(x.arraydtick/s),!(h<A[0]||h>A[A.length-1])&&b.push(c(F(h),{color:x.minorgridcolor,width:x.minorgridwidth})));x.startline&&l.push(c(V(0),{color:x.startlinecolor,width:x.startlinewidth})),x.endline&&l.push(c(V(A.length-1),{color:x.endlinecolor,width:x.endlinewidth}))}else{for(f=5e-15,o=[Math.floor((A[A.length-1]-x.tick0)/x.dtick*(1+f)),Math.ceil((A[0]-x.tick0)/x.dtick/(1+f))].sort(function(G,J){return G-J}),i=o[0],g=o[1],p=i;p<=g;p++)y=x.tick0+x.dtick*p,v.push(c(F(y),{color:x.gridcolor,width:x.gridwidth}));for(p=i-1;p<g+1;p++)for(y=x.tick0+x.dtick*p,n=0;n<x.minorgridcount;n++)h=y+x.dtick*(n+1)/(x.minorgridcount+1),!(h<A[0]||h>A[A.length-1])&&b.push(c(F(h),{color:x.minorgridcolor,width:x.minorgridwidth}));x.startline&&l.push(c(F(A[0]),{color:x.startlinecolor,width:x.startlinewidth})),x.endline&&l.push(c(F(A[A.length-1]),{color:x.endlinecolor,width:x.endlinewidth}))}}},{"../../lib/extend":493,"../../plots/cartesian/axes":554}],698:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("../../lib/extend").extendFlat;re.exports=function(T,e){var a,n,r,t,f,o=e._labels=[],i=e._gridlines;for(a=0;a<i.length;a++)f=i[a],["start","both"].indexOf(e.showticklabels)!==-1&&(n=w.tickText(e,f.value),c(n,{prefix:r,suffix:t,endAnchor:!0,xy:f.xy(0),dxy:f.dxy(0,0),axis:f.axis,length:f.crossAxis.length,font:f.axis.tickfont,isFirst:a===0,isLast:a===i.length-1}),o.push(n)),["end","both"].indexOf(e.showticklabels)!==-1&&(n=w.tickText(e,f.value),c(n,{endAnchor:!1,xy:f.xy(f.crossLength-1),dxy:f.dxy(f.crossLength-2,1),axis:f.axis,length:f.crossAxis.length,font:f.axis.tickfont,isFirst:a===0,isLast:a===i.length-1}),o.push(n))}},{"../../lib/extend":493,"../../plots/cartesian/axes":554}],699:[function(d,re,ne){var w=.5;re.exports=function(M,T,e,a){var n=M[0]-T[0],r=M[1]-T[1],t=e[0]-T[0],f=e[1]-T[1],o=Math.pow(n*n+r*r,w/2),i=Math.pow(t*t+f*f,w/2),g=(i*i*n-o*o*t)*a,p=(i*i*r-o*o*f)*a,y=i*(o+i)*3,h=o*(o+i)*3;return[[T[0]+(y&&g/y),T[1]+(y&&p/y)],[T[0]-(h&&g/h),T[1]-(h&&p/h)]]}},{}],700:[function(d,re,ne){var w=d("../../lib").isArrayOrTypedArray;re.exports=function(c,M,T){var e,a,n,r,t,f,o=[],i=w(c)?c.length:c,g=w(M)?M.length:M,p=w(c)?c:null,y=w(M)?M:null;p&&(n=(p.length-1)/(p[p.length-1]-p[0])/(i-1)),y&&(r=(y.length-1)/(y[y.length-1]-y[0])/(g-1));var h,m=1/0,u=-1/0;for(a=0;a<g;a++)for(o[a]=[],f=y?(y[a]-y[0])*r:a/(g-1),e=0;e<i;e++)t=p?(p[e]-p[0])*n:e/(i-1),h=t-f*T,m=Math.min(h,m),u=Math.max(h,u),o[a][e]=h;var _=1/(u-m),s=-m*_;for(a=0;a<g;a++)for(e=0;e<i;e++)o[a][e]=_*o[a][e]+s;return o}},{"../../lib":503}],701:[function(d,re,ne){var w=d("./catmull_rom"),c=d("../../lib").ensureArray;function M(T,e,a){var n=-.5*a[0]+1.5*e[0],r=-.5*a[1]+1.5*e[1];return[(2*n+T[0])/3,(2*r+T[1])/3]}re.exports=function(e,a,n,r,t,f){var o,i,g,p,y,h,m,u,_,s,A=n[0].length,x=n.length,v=t?3*A-2:A,b=f?3*x-2:x;for(e=c(e,b),a=c(a,b),g=0;g<b;g++)e[g]=c(e[g],v),a[g]=c(a[g],v);for(i=0,p=0;i<x;i++,p+=f?3:1)for(y=e[p],h=a[p],m=n[i],u=r[i],o=0,g=0;o<A;o++,g+=t?3:1)y[g]=m[o],h[g]=u[o];if(t)for(i=0,p=0;i<x;i++,p+=f?3:1){for(o=1,g=3;o<A-1;o++,g+=3)_=w([n[i][o-1],r[i][o-1]],[n[i][o],r[i][o]],[n[i][o+1],r[i][o+1]],t),e[p][g-1]=_[0][0],a[p][g-1]=_[0][1],e[p][g+1]=_[1][0],a[p][g+1]=_[1][1];s=M([e[p][0],a[p][0]],[e[p][2],a[p][2]],[e[p][3],a[p][3]]),e[p][1]=s[0],a[p][1]=s[1],s=M([e[p][v-1],a[p][v-1]],[e[p][v-3],a[p][v-3]],[e[p][v-4],a[p][v-4]]),e[p][v-2]=s[0],a[p][v-2]=s[1]}if(f)for(g=0;g<v;g++){for(p=3;p<b-3;p+=3)_=w([e[p-3][g],a[p-3][g]],[e[p][g],a[p][g]],[e[p+3][g],a[p+3][g]],f),e[p-1][g]=_[0][0],a[p-1][g]=_[0][1],e[p+1][g]=_[1][0],a[p+1][g]=_[1][1];s=M([e[0][g],a[0][g]],[e[2][g],a[2][g]],[e[3][g],a[3][g]]),e[1][g]=s[0],a[1][g]=s[1],s=M([e[b-1][g],a[b-1][g]],[e[b-3][g],a[b-3][g]],[e[b-4][g],a[b-4][g]]),e[b-2][g]=s[0],a[b-2][g]=s[1]}if(t&&f)for(p=1;p<b;p+=(p+1)%3===0?2:1){for(g=3;g<v-3;g+=3)_=w([e[p][g-3],a[p][g-3]],[e[p][g],a[p][g]],[e[p][g+3],a[p][g+3]],t),e[p][g-1]=.5*(e[p][g-1]+_[0][0]),a[p][g-1]=.5*(a[p][g-1]+_[0][1]),e[p][g+1]=.5*(e[p][g+1]+_[1][0]),a[p][g+1]=.5*(a[p][g+1]+_[1][1]);s=M([e[p][0],a[p][0]],[e[p][2],a[p][2]],[e[p][3],a[p][3]]),e[p][1]=.5*(e[p][1]+s[0]),a[p][1]=.5*(a[p][1]+s[1]),s=M([e[p][v-1],a[p][v-1]],[e[p][v-3],a[p][v-3]],[e[p][v-4],a[p][v-4]]),e[p][v-2]=.5*(e[p][v-2]+s[0]),a[p][v-2]=.5*(a[p][v-2]+s[1])}return[e,a]}},{"../../lib":503,"./catmull_rom":699}],702:[function(d,re,ne){re.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],703:[function(d,re,ne){re.exports=function(w,c,M){return c&&M?function(T,e,a,n,r){T||(T=[]);var t,f,o,i,g,p;e*=3,a*=3;var y=n*n,h=1-n,m=h*h,u=h*n*2,_=-3*m,s=3*(m-u),A=3*(u-y),x=3*y,v=r*r,b=v*r,l=1-r,L=l*l,S=L*l;for(p=0;p<w.length;p++)g=w[p],t=_*g[a][e]+s*g[a][e+1]+A*g[a][e+2]+x*g[a][e+3],f=_*g[a+1][e]+s*g[a+1][e+1]+A*g[a+1][e+2]+x*g[a+1][e+3],o=_*g[a+2][e]+s*g[a+2][e+1]+A*g[a+2][e+2]+x*g[a+2][e+3],i=_*g[a+3][e]+s*g[a+3][e+1]+A*g[a+3][e+2]+x*g[a+3][e+3],T[p]=S*t+3*(L*r*f+l*v*o)+b*i;return T}:c?function(T,e,a,n,r){T||(T=[]);var t,f,o,i;e*=3;var g=n*n,p=1-n,y=p*p,h=p*n*2,m=-3*y,u=3*(y-h),_=3*(h-g),s=3*g,A=1-r;for(o=0;o<w.length;o++)i=w[o],t=m*i[a][e]+u*i[a][e+1]+_*i[a][e+2]+s*i[a][e+3],f=m*i[a+1][e]+u*i[a+1][e+1]+_*i[a+1][e+2]+s*i[a+1][e+3],T[o]=A*t+r*f;return T}:M?function(T,e,a,n,r){T||(T=[]);var t,f,o,i,g,p;a*=3;var y=r*r,h=y*r,m=1-r,u=m*m,_=u*m;for(g=0;g<w.length;g++)p=w[g],t=p[a][e+1]-p[a][e],f=p[a+1][e+1]-p[a+1][e],o=p[a+2][e+1]-p[a+2][e],i=p[a+3][e+1]-p[a+3][e],T[g]=_*t+3*(u*r*f+m*y*o)+h*i;return T}:function(T,e,a,n,r){T||(T=[]);var t,f,o,i,g=1-r;for(o=0;o<w.length;o++)i=w[o],t=i[a][e+1]-i[a][e],f=i[a+1][e+1]-i[a+1][e],T[o]=g*t+r*f;return T}}},{}],704:[function(d,re,ne){re.exports=function(w,c,M){return c&&M?function(T,e,a,n,r){T||(T=[]);var t,f,o,i,g,p;e*=3,a*=3;var y=n*n,h=y*n,m=1-n,u=m*m,_=u*m,s=r*r,A=1-r,x=A*A,v=A*r*2,b=-3*x,l=3*(x-v),L=3*(v-s),S=3*s;for(p=0;p<w.length;p++)g=w[p],t=b*g[a][e]+l*g[a+1][e]+L*g[a+2][e]+S*g[a+3][e],f=b*g[a][e+1]+l*g[a+1][e+1]+L*g[a+2][e+1]+S*g[a+3][e+1],o=b*g[a][e+2]+l*g[a+1][e+2]+L*g[a+2][e+2]+S*g[a+3][e+2],i=b*g[a][e+3]+l*g[a+1][e+3]+L*g[a+2][e+3]+S*g[a+3][e+3],T[p]=_*t+3*(u*n*f+m*y*o)+h*i;return T}:c?function(T,e,a,n,r){T||(T=[]);var t,f,o,i,g,p;e*=3;var y=r*r,h=y*r,m=1-r,u=m*m,_=u*m;for(g=0;g<w.length;g++)p=w[g],t=p[a+1][e]-p[a][e],f=p[a+1][e+1]-p[a][e+1],o=p[a+1][e+2]-p[a][e+2],i=p[a+1][e+3]-p[a][e+3],T[g]=_*t+3*(u*r*f+m*y*o)+h*i;return T}:M?function(T,e,a,n,r){T||(T=[]);var t,f,o,i;a*=3;var g=1-n,p=r*r,y=1-r,h=y*y,m=y*r*2,u=-3*h,_=3*(h-m),s=3*(m-p),A=3*p;for(o=0;o<w.length;o++)i=w[o],t=u*i[a][e]+_*i[a+1][e]+s*i[a+2][e]+A*i[a+3][e],f=u*i[a][e+1]+_*i[a+1][e+1]+s*i[a+2][e+1]+A*i[a+3][e+1],T[o]=g*t+n*f;return T}:function(T,e,a,n,r){T||(T=[]);var t,f,o,i,g=1-n;for(o=0;o<w.length;o++)i=w[o],t=i[a+1][e]-i[a][e],f=i[a+1][e+1]-i[a][e+1],T[o]=g*t+n*f;return T}}},{}],705:[function(d,re,ne){re.exports=function(w,c,M,T,e){var a=c-2,n=M-2;return T&&e?function(r,t,f){r||(r=[]);var o,i,g,p,y,h,m=Math.max(0,Math.min(Math.floor(t),a)),u=Math.max(0,Math.min(Math.floor(f),n)),_=Math.max(0,Math.min(1,t-m)),s=Math.max(0,Math.min(1,f-u));m*=3,u*=3;var A=_*_,x=A*_,v=1-_,b=v*v,l=b*v,L=s*s,S=L*s,k=1-s,P=k*k,z=P*k;for(h=0;h<w.length;h++)y=w[h],o=l*y[u][m]+3*(b*_*y[u][m+1]+v*A*y[u][m+2])+x*y[u][m+3],i=l*y[u+1][m]+3*(b*_*y[u+1][m+1]+v*A*y[u+1][m+2])+x*y[u+1][m+3],g=l*y[u+2][m]+3*(b*_*y[u+2][m+1]+v*A*y[u+2][m+2])+x*y[u+2][m+3],p=l*y[u+3][m]+3*(b*_*y[u+3][m+1]+v*A*y[u+3][m+2])+x*y[u+3][m+3],r[h]=z*o+3*(P*s*i+k*L*g)+S*p;return r}:T?function(r,t,f){r||(r=[]);var o=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(f),n)),g=Math.max(0,Math.min(1,t-o)),p=Math.max(0,Math.min(1,f-i)),y,h,m,u,_,s;o*=3;var A=g*g,x=A*g,v=1-g,b=v*v,l=b*v,L=1-p;for(_=0;_<w.length;_++)s=w[_],y=L*s[i][o]+p*s[i+1][o],h=L*s[i][o+1]+p*s[i+1][o+1],m=L*s[i][o+2]+p*s[i+1][o+1],u=L*s[i][o+3]+p*s[i+1][o+1],r[_]=l*y+3*(b*g*h+v*A*m)+x*u;return r}:e?function(r,t,f){r||(r=[]);var o=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(f),n)),g=Math.max(0,Math.min(1,t-o)),p=Math.max(0,Math.min(1,f-i)),y,h,m,u,_,s;i*=3;var A=p*p,x=A*p,v=1-p,b=v*v,l=b*v,L=1-g;for(_=0;_<w.length;_++)s=w[_],y=L*s[i][o]+g*s[i][o+1],h=L*s[i+1][o]+g*s[i+1][o+1],m=L*s[i+2][o]+g*s[i+2][o+1],u=L*s[i+3][o]+g*s[i+3][o+1],r[_]=l*y+3*(b*p*h+v*A*m)+x*u;return r}:function(r,t,f){r||(r=[]);var o=Math.max(0,Math.min(Math.floor(t),a)),i=Math.max(0,Math.min(Math.floor(f),n)),g=Math.max(0,Math.min(1,t-o)),p=Math.max(0,Math.min(1,f-i)),y,h,m,u,_=1-p,s=1-g;for(m=0;m<w.length;m++)u=w[m],y=s*u[i][o]+g*u[i][o+1],h=s*u[i+1][o]+g*u[i+1][o+1],r[m]=_*y+p*h;return r}}},{}],706:[function(d,re,ne){var w=d("../../lib"),c=d("./xy_defaults"),M=d("./ab_defaults"),T=d("./attributes"),e=d("../../components/color/attributes");re.exports=function(n,r,t,f){function o(p,y){return w.coerce(n,r,T,p,y)}r._clipPathId="clip"+r.uid+"carpet";var i=o("color",e.defaultLine);if(w.coerceFont(o,"font"),o("carpet"),M(n,r,f,o,i),!r.a||!r.b){r.visible=!1;return}r.a.length<3&&(r.aaxis.smoothing=0),r.b.length<3&&(r.baxis.smoothing=0);var g=c(n,r,o);g||(r.visible=!1),r._cheater&&o("cheaterslope")}},{"../../components/color/attributes":365,"../../lib":503,"./ab_defaults":689,"./attributes":691,"./xy_defaults":715}],707:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),plot:d("./plot"),calc:d("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":568,"./attributes":691,"./calc":695,"./defaults":706,"./plot":712}],708:[function(d,re,ne){re.exports=function(w,c){for(var M=w._fullData.length,T,e=0;e<M;e++){var a=w._fullData[e];if(a.index!==c.index&&a.type==="carpet"&&(T||(T=a),a.carpet===c.carpet))return a}return T}},{}],709:[function(d,re,ne){re.exports=function(c,M,T){if(c.length===0)return"";var e,a=[],n=T?3:1;for(e=0;e<c.length;e+=n)a.push(c[e]+","+M[e]),T&&e<c.length-n&&(a.push("C"),a.push([c[e+1]+","+M[e+1],c[e+2]+","+M[e+2]+" "].join(" ")));return a.join(T?"":"L")}},{}],710:[function(d,re,ne){var w=d("../../lib").isArrayOrTypedArray;re.exports=function(M,T,e){var a;for(w(M)?M.length>T.length&&(M=M.slice(0,T.length)):M=[],a=0;a<T.length;a++)M[a]=e(T[a]);return M}},{"../../lib":503}],711:[function(d,re,ne){re.exports=function(c,M,T,e,a,n){var r=a[0]*c.dpdx(M),t=a[1]*c.dpdy(T),f=1,o=1;if(n){var i=Math.sqrt(a[0]*a[0]+a[1]*a[1]),g=Math.sqrt(n[0]*n[0]+n[1]*n[1]),p=(a[0]*n[0]+a[1]*n[1])/i/g;o=Math.max(0,p)}var y=Math.atan2(t,r)*180/Math.PI;return y<-90?(y+=180,f=-f):y>90&&(y-=180,f=-f),{angle:y,flip:f,p:c.c2p(e,M,T),offsetMultplier:o}}},{}],712:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/drawing"),M=d("./map_1d_array"),T=d("./makepath"),e=d("./orient_text"),a=d("../../lib/svg_text_utils"),n=d("../../lib"),r=n.strRotate,t=n.strTranslate,f=d("../../constants/alignment");re.exports=function(_,s,A,x){var v=s.xaxis,b=s.yaxis,l=_._fullLayout,L=l._clips;n.makeTraceGroups(x,A,"trace").each(function(S){var k=w.select(this),P=S[0],z=P.trace,I=z.aaxis,D=z.baxis,R=n.ensureSingle(k,"g","minorlayer"),B=n.ensureSingle(k,"g","majorlayer"),F=n.ensureSingle(k,"g","boundarylayer"),V=n.ensureSingle(k,"g","labellayer");k.style("opacity",z.opacity),i(v,b,B,I,"a",I._gridlines),i(v,b,B,D,"b",D._gridlines),i(v,b,R,I,"a",I._minorgridlines),i(v,b,R,D,"b",D._minorgridlines),i(v,b,F,I,"a-boundary",I._boundarylines),i(v,b,F,D,"b-boundary",D._boundarylines);var G=g(_,v,b,z,P,V,I._labels,"a-label"),J=g(_,v,b,z,P,V,D._labels,"b-label");p(_,V,z,P,v,b,G,J),o(z,P,L,v,b)})};function o(u,_,s,A,x){var v,b,l,L,S=s.select("#"+u._clipPathId);S.size()||(S=s.append("clipPath").classed("carpetclip",!0));var k=n.ensureSingle(S,"path","carpetboundary"),P=_.clipsegments,z=[];for(L=0;L<P.length;L++)v=P[L],b=M([],v.x,A.c2p),l=M([],v.y,x.c2p),z.push(T(b,l,v.bicubic));var I="M"+z.join("L")+"Z";S.attr("id",u._clipPathId),k.attr("d",I)}function i(u,_,s,A,x,v){var b="const-"+x+"-lines",l=s.selectAll("."+b).data(v);l.enter().append("path").classed(b,!0).style("vector-effect","non-scaling-stroke"),l.each(function(L){var S=L,k=S.x,P=S.y,z=M([],k,u.c2p),I=M([],P,_.c2p),D="M"+T(z,I,S.smoothing),R=w.select(this);R.attr("d",D).style("stroke-width",S.width).style("stroke",S.color).style("fill","none")}),l.exit().remove()}function g(u,_,s,A,x,v,b,l){var L=v.selectAll("text."+l).data(b);L.enter().append("text").classed(l,!0);var S=0,k={};return L.each(function(P,z){var I;if(P.axis.tickangle==="auto")I=e(A,_,s,P.xy,P.dxy);else{var D=(P.axis.tickangle+180)*Math.PI/180;I=e(A,_,s,P.xy,[Math.cos(D),Math.sin(D)])}z||(k={angle:I.angle,flip:I.flip});var R=(P.endAnchor?-1:1)*I.flip,B=w.select(this).attr({"text-anchor":R>0?"start":"end","data-notex":1}).call(c.font,P.font).text(P.text).call(a.convertToTspans,u),F=c.bBox(this);B.attr("transform",t(I.p[0],I.p[1])+r(I.angle)+t(P.axis.labelpadding*R,F.height*.3)),S=Math.max(S,F.width+P.axis.labelpadding)}),L.exit().remove(),k.maxExtent=S,k}function p(u,_,s,A,x,v,b,l){var L,S,k,P,z=n.aggNums(Math.min,null,s.a),I=n.aggNums(Math.max,null,s.a),D=n.aggNums(Math.min,null,s.b),R=n.aggNums(Math.max,null,s.b);L=.5*(z+I),S=D,k=s.ab2xy(L,S,!0),P=s.dxyda_rough(L,S),b.angle===void 0&&n.extendFlat(b,e(s,x,v,k,s.dxydb_rough(L,S))),m(u,_,s,A,k,P,s.aaxis,x,v,b,"a-title"),L=z,S=.5*(D+R),k=s.ab2xy(L,S,!0),P=s.dxydb_rough(L,S),l.angle===void 0&&n.extendFlat(l,e(s,x,v,k,s.dxyda_rough(L,S))),m(u,_,s,A,k,P,s.baxis,x,v,l,"b-title")}var y=f.LINE_SPACING,h=(1-f.MID_SHIFT)/y+1;function m(u,_,s,A,x,v,b,l,L,S,k){var P=[];b.title.text&&P.push(b.title.text);var z=_.selectAll("text."+k).data(P),I=S.maxExtent;z.enter().append("text").classed(k,!0),z.each(function(){var D=e(s,l,L,x,v);["start","both"].indexOf(b.showticklabels)===-1&&(I=0);var R=b.title.font.size;I+=R+b.title.offset;var B=S.angle+(S.flip<0?180:0),F=(B-D.angle+450)%360,V=F>90&&F<270,G=w.select(this);G.text(b.title.text).call(a.convertToTspans,u),V&&(I=(-a.lineCount(G)+h)*y*R-I),G.attr("transform",t(D.p[0],D.p[1])+r(D.angle)+t(0,I)).attr("text-anchor","middle").call(c.font,b.title.font)}),z.exit().remove()}},{"../../components/drawing":388,"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"./makepath":709,"./map_1d_array":710,"./orient_text":711,"@plotly/d3":58}],713:[function(d,re,ne){var w=d("./constants"),c=d("../../lib/search").findBin,M=d("./compute_control_points"),T=d("./create_spline_evaluator"),e=d("./create_i_derivative_evaluator"),a=d("./create_j_derivative_evaluator");re.exports=function(r){var t=r._a,f=r._b,o=t.length,i=f.length,g=r.aaxis,p=r.baxis,y=t[0],h=t[o-1],m=f[0],u=f[i-1],_=t[t.length-1]-t[0],s=f[f.length-1]-f[0],A=_*w.RELATIVE_CULL_TOLERANCE,x=s*w.RELATIVE_CULL_TOLERANCE;y-=A,h+=A,m-=x,u+=x,r.isVisible=function(v,b){return v>y&&v<h&&b>m&&b<u},r.isOccluded=function(v,b){return v<y||v>h||b<m||b>u},r.setScale=function(){var v=r._x,b=r._y,l=M(r._xctrl,r._yctrl,v,b,g.smoothing,p.smoothing);r._xctrl=l[0],r._yctrl=l[1],r.evalxy=T([r._xctrl,r._yctrl],o,i,g.smoothing,p.smoothing),r.dxydi=e([r._xctrl,r._yctrl],g.smoothing,p.smoothing),r.dxydj=a([r._xctrl,r._yctrl],g.smoothing,p.smoothing)},r.i2a=function(v){var b=Math.max(0,Math.floor(v[0]),o-2),l=v[0]-b;return(1-l)*t[b]+l*t[b+1]},r.j2b=function(v){var b=Math.max(0,Math.floor(v[1]),o-2),l=v[1]-b;return(1-l)*f[b]+l*f[b+1]},r.ij2ab=function(v){return[r.i2a(v[0]),r.j2b(v[1])]},r.a2i=function(v){var b=Math.max(0,Math.min(c(v,t),o-2)),l=t[b],L=t[b+1];return Math.max(0,Math.min(o-1,b+(v-l)/(L-l)))},r.b2j=function(v){var b=Math.max(0,Math.min(c(v,f),i-2)),l=f[b],L=f[b+1];return Math.max(0,Math.min(i-1,b+(v-l)/(L-l)))},r.ab2ij=function(v){return[r.a2i(v[0]),r.b2j(v[1])]},r.i2c=function(v,b){return r.evalxy([],v,b)},r.ab2xy=function(v,b,l){if(!l&&(v<t[0]||v>t[o-1]|b<f[0]||b>f[i-1]))return[!1,!1];var L=r.a2i(v),S=r.b2j(b),k=r.evalxy([],L,S);if(l){var P=0,z=0,I=[],D,R,B,F;v<t[0]?(D=0,R=0,P=(v-t[0])/(t[1]-t[0])):v>t[o-1]?(D=o-2,R=1,P=(v-t[o-1])/(t[o-1]-t[o-2])):(D=Math.max(0,Math.min(o-2,Math.floor(L))),R=L-D),b<f[0]?(B=0,F=0,z=(b-f[0])/(f[1]-f[0])):b>f[i-1]?(B=i-2,F=1,z=(b-f[i-1])/(f[i-1]-f[i-2])):(B=Math.max(0,Math.min(i-2,Math.floor(S))),F=S-B),P&&(r.dxydi(I,D,B,R,F),k[0]+=I[0]*P,k[1]+=I[1]*P),z&&(r.dxydj(I,D,B,R,F),k[0]+=I[0]*z,k[1]+=I[1]*z)}return k},r.c2p=function(v,b,l){return[b.c2p(v[0]),l.c2p(v[1])]},r.p2x=function(v,b,l){return[b.p2c(v[0]),l.p2c(v[1])]},r.dadi=function(v){var b=Math.max(0,Math.min(t.length-2,v));return t[b+1]-t[b]},r.dbdj=function(v){var b=Math.max(0,Math.min(f.length-2,v));return f[b+1]-f[b]},r.dxyda=function(v,b,l,L){var S=r.dxydi(null,v,b,l,L),k=r.dadi(v,l);return[S[0]/k,S[1]/k]},r.dxydb=function(v,b,l,L){var S=r.dxydj(null,v,b,l,L),k=r.dbdj(b,L);return[S[0]/k,S[1]/k]},r.dxyda_rough=function(v,b,l){var L=_*(l||.1),S=r.ab2xy(v+L,b,!0),k=r.ab2xy(v-L,b,!0);return[(S[0]-k[0])*.5/L,(S[1]-k[1])*.5/L]},r.dxydb_rough=function(v,b,l){var L=s*(l||.1),S=r.ab2xy(v,b+L,!0),k=r.ab2xy(v,b-L,!0);return[(S[0]-k[0])*.5/L,(S[1]-k[1])*.5/L]},r.dpdx=function(v){return v._m},r.dpdy=function(v){return v._m}}},{"../../lib/search":523,"./compute_control_points":701,"./constants":702,"./create_i_derivative_evaluator":703,"./create_j_derivative_evaluator":704,"./create_spline_evaluator":705}],714:[function(d,re,ne){var w=d("../../lib");re.exports=function(M,T,e){var a,n,r,t=[],f=[],o=M[0].length,i=M.length;function g(j,Y){var X=0,oe,se=0;return j>0&&(oe=M[Y][j-1])!==void 0&&(se++,X+=oe),j<o-1&&(oe=M[Y][j+1])!==void 0&&(se++,X+=oe),Y>0&&(oe=M[Y-1][j])!==void 0&&(se++,X+=oe),Y<i-1&&(oe=M[Y+1][j])!==void 0&&(se++,X+=oe),X/Math.max(1,se)}var p=0;for(a=0;a<o;a++)for(n=0;n<i;n++)M[n][a]===void 0&&(t.push(a),f.push(n),M[n][a]=g(a,n)),p=Math.max(p,Math.abs(M[n][a]));if(!t.length)return M;var y,h,m,u,_,s,A,x,v,b,l,L=1e-5,S=0,k=100,P=0,z=t.length;do{for(S=0,r=0;r<z;r++){a=t[r],n=f[r];var I=0,D=0,R,B,F,V,G,J;a===0?(G=Math.min(o-1,2),F=T[G],V=T[1],R=M[n][G],B=M[n][1],D+=B+(B-R)*(T[0]-V)/(V-F),I++):a===o-1&&(G=Math.max(0,o-3),F=T[G],V=T[o-2],R=M[n][G],B=M[n][o-2],D+=B+(B-R)*(T[o-1]-V)/(V-F),I++),(a===0||a===o-1)&&n>0&&n<i-1&&(y=e[n+1]-e[n],h=e[n]-e[n-1],D+=(h*M[n+1][a]+y*M[n-1][a])/(h+y),I++),n===0?(J=Math.min(i-1,2),F=e[J],V=e[1],R=M[J][a],B=M[1][a],D+=B+(B-R)*(e[0]-V)/(V-F),I++):n===i-1&&(J=Math.max(0,i-3),F=e[J],V=e[i-2],R=M[J][a],B=M[i-2][a],D+=B+(B-R)*(e[i-1]-V)/(V-F),I++),(n===0||n===i-1)&&a>0&&a<o-1&&(y=T[a+1]-T[a],h=T[a]-T[a-1],D+=(h*M[n][a+1]+y*M[n][a-1])/(h+y),I++),I?D/=I:(m=T[a+1]-T[a],u=T[a]-T[a-1],_=e[n+1]-e[n],s=e[n]-e[n-1],A=m*u*(m+u),x=_*s*(_+s),D=(A*(s*M[n+1][a]+_*M[n-1][a])+x*(u*M[n][a+1]+m*M[n][a-1]))/(x*(u+m)+A*(s+_))),v=D-M[n][a],b=v/p,S+=b*b,l=I?0:.85,M[n][a]+=v*(1+l)}S=Math.sqrt(S)}while(P++<k&&S>L);return w.log("Smoother converged to",S,"after",P,"iterations"),M}},{"../../lib":503}],715:[function(d,re,ne){var w=d("../../lib").isArray1D;re.exports=function(M,T,e){var a=e("x"),n=a&&a.length,r=e("y"),t=r&&r.length;if(!n&&!t)return!1;if(T._cheater=!a,(!n||w(a))&&(!t||w(r))){var f=n?a.length:1/0;t&&(f=Math.min(f,r.length)),T.a&&T.a.length&&(f=Math.min(f,T.a.length)),T.b&&T.b.length&&(f=Math.min(f,T.b.length)),T._length=f}else T._length=null;return!0}},{"../../lib":503}],716:[function(d,re,ne){var w=d("../../plots/template_attributes").hovertemplateAttrs,c=d("../scattergeo/attributes"),M=d("../../components/colorscale/attributes"),T=d("../../plots/attributes"),e=d("../../components/color/attributes").defaultLine,a=d("../../lib/extend").extendFlat,n=c.marker.line;re.exports=a({locations:{valType:"data_array",editType:"calc"},locationmode:c.locationmode,z:{valType:"data_array",editType:"calc"},geojson:a({},c.geojson,{}),featureidkey:c.featureidkey,text:a({},c.text,{}),hovertext:a({},c.hovertext,{}),marker:{line:{color:a({},n.color,{dflt:e}),width:a({},n.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:c.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:c.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:a({},T.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:w(),showlegend:a({},T.showlegend,{dflt:!1})},M("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":365,"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scattergeo/attributes":969}],717:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../constants/numerical").BADNUM,M=d("../../components/colorscale/calc"),T=d("../scatter/arrays_to_calcdata"),e=d("../scatter/calc_selection");function a(n){return n&&typeof n=="string"}re.exports=function(r,t){var f=t._length,o=new Array(f),i;t.geojson?i=function(m){return a(m)||w(m)}:i=a;for(var g=0;g<f;g++){var p=o[g]={},y=t.locations[g],h=t.z[g];i(y)&&w(h)?(p.loc=y,p.z=h):(p.loc=null,p.z=c),p.index=g}return T(o,t),M(r,t,{vals:t.z,containerStr:"",cLetter:"z"}),e(o,t),o}},{"../../components/colorscale/calc":374,"../../constants/numerical":479,"../scatter/arrays_to_calcdata":926,"../scatter/calc_selection":929,"fast-isnumeric":190}],718:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/colorscale/defaults"),M=d("./attributes");re.exports=function(e,a,n,r){function t(h,m){return w.coerce(e,a,M,h,m)}var f=t("locations"),o=t("z");if(!(f&&f.length&&w.isArrayOrTypedArray(o)&&o.length)){a.visible=!1;return}a._length=Math.min(f.length,o.length);var i=t("geojson"),g;(typeof i=="string"&&i!==""||w.isPlainObject(i))&&(g="geojson-id");var p=t("locationmode",g);p==="geojson-id"&&t("featureidkey"),t("text"),t("hovertext"),t("hovertemplate");var y=t("marker.line.width");y&&t("marker.line.color"),t("marker.opacity"),c(e,a,r,t,{prefix:"",cLetter:"z"}),w.coerceSelectionMarkerOpacity(a,t)}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":716}],719:[function(d,re,ne){re.exports=function(c,M,T,e,a){c.location=M.location,c.z=M.z;var n=e[a];return n.fIn&&n.fIn.properties&&(c.properties=n.fIn.properties),c.ct=n.ct,c}},{}],720:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("./attributes"),M=d("../../lib").fillText;re.exports=function(a,n,r){var t=a.cd,f=t[0].trace,o=a.subplot,i,g,p,y,h=[n,r],m=[n+360,r];for(g=0;g<t.length;g++)if(i=t[g],y=!1,i._polygons){for(p=0;p<i._polygons.length;p++)i._polygons[p].contains(h)&&(y=!y),i._polygons[p].contains(m)&&(y=!y);if(y)break}if(!(!y||!i))return a.x0=a.x1=a.xa.c2p(i.ct),a.y0=a.y1=a.ya.c2p(i.ct),a.index=i.index,a.location=i.loc,a.z=i.z,a.zLabel=w.tickText(o.mockAxis,o.mockAxis.c2l(i.z),"hover").text,a.hovertemplate=i.hovertemplate,T(a,f,i),[a]};function T(e,a,n){if(!a.hovertemplate){var r=n.hi||a.hoverinfo,t=String(n.loc),f=r==="all"?c.hoverinfo.flags:r.split("+"),o=f.indexOf("name")!==-1,i=f.indexOf("location")!==-1,g=f.indexOf("z")!==-1,p=f.indexOf("text")!==-1,y=!o&&i,h=[];y?e.nameOverride=t:(o&&(e.nameOverride=a.name),i&&h.push(t)),g&&h.push(e.zLabel),p&&M(n,a,h),e.extraText=h.join("<br>")}}},{"../../lib":503,"../../plots/cartesian/axes":554,"./attributes":716}],721:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),calc:d("./calc"),calcGeoJSON:d("./plot").calcGeoJSON,plot:d("./plot").plot,style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"choropleth",basePlotModule:d("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":589,"../heatmap/colorbar":795,"./attributes":716,"./calc":717,"./defaults":718,"./event_data":719,"./hover":720,"./plot":722,"./select":723,"./style":724}],722:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../lib/geo_location_utils"),T=d("../../lib/topojson_utils").getTopojsonFeatures,e=d("../../plots/cartesian/autorange").findExtremes,a=d("./style").style;function n(t,f,o){var i=f.layers.backplot.select(".choroplethlayer");c.makeTraceGroups(i,o,"trace choropleth").each(function(g){var p=w.select(this),y=p.selectAll("path.choroplethlocation").data(c.identity);y.enter().append("path").classed("choroplethlocation",!0),y.exit().remove(),a(t,g)})}function r(t,f){for(var o=t[0].trace,i=f[o.geo],g=i._subplot,p=o.locationmode,y=o._length,h=p==="geojson-id"?M.extractTraceFeature(t):T(o,g.topojson),m=[],u=[],_=0;_<y;_++){var s=t[_],A=p==="geojson-id"?s.fOut:M.locationToFeature(p,s.loc,h);if(A){s.geojson=A,s.ct=A.properties.ct,s._polygons=M.feature2polygons(A);var x=M.computeBbox(A);m.push(x[0],x[2]),u.push(x[1],x[3])}else s.geojson=null}if(i.fitbounds==="geojson"&&p==="geojson-id"){var v=M.computeBbox(M.getTraceGeojson(o));m=[v[0],v[2]],u=[v[1],v[3]]}var b={padded:!0};o._extremes.lon=e(i.lonaxis._ax,m,b),o._extremes.lat=e(i.lataxis._ax,u,b)}re.exports={calcGeoJSON:r,plot:n}},{"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/topojson_utils":532,"../../plots/cartesian/autorange":553,"./style":724,"@plotly/d3":58}],723:[function(d,re,ne){re.exports=function(c,M){var T=c.cd,e=c.xaxis,a=c.yaxis,n=[],r,t,f,o,i;if(M===!1)for(r=0;r<T.length;r++)T[r].selected=0;else for(r=0;r<T.length;r++)t=T[r],f=t.ct,f&&(o=e.c2p(f),i=a.c2p(f),M.contains([o,i],null,r,c)?(n.push({pointNumber:r,lon:f[0],lat:f[1]}),t.selected=1):t.selected=0);return n}},{}],724:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/color"),M=d("../../components/drawing"),T=d("../../components/colorscale");function e(r,t){t&&a(r,t)}function a(r,t){var f=t[0].trace,o=t[0].node3,i=o.selectAll(".choroplethlocation"),g=f.marker||{},p=g.line||{},y=T.makeColorScaleFuncFromTrace(f);i.each(function(h){w.select(this).attr("fill",y(h.z)).call(c.stroke,h.mlc||p.color).call(M.dashLine,"",h.mlw||p.width||0).style("opacity",g.opacity)}),M.selectedPointStyle(i,f,r)}function n(r,t){var f=t[0].node3,o=t[0].trace;o.selectedpoints?M.selectedPointStyle(f.selectAll(".choroplethlocation"),o,r):a(r,t)}re.exports={style:e,styleOnSelect:n}},{"../../components/color":366,"../../components/colorscale":378,"../../components/drawing":388,"@plotly/d3":58}],725:[function(d,re,ne){var w=d("../choropleth/attributes"),c=d("../../components/colorscale/attributes"),M=d("../../plots/template_attributes").hovertemplateAttrs,T=d("../../plots/attributes"),e=d("../../lib/extend").extendFlat;re.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},w.featureidkey,{}),below:{valType:"string",editType:"plot"},text:w.text,hovertext:w.hovertext,marker:{line:{color:e({},w.marker.line.color,{editType:"plot"}),width:e({},w.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},w.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},w.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},w.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:w.hoverinfo,hovertemplate:M({},{keys:["properties"]}),showlegend:e({},T.showlegend,{dflt:!1})},c("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../choropleth/attributes":716}],726:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("../../components/colorscale"),T=d("../../components/drawing"),e=d("../../lib/geojson_utils").makeBlank,a=d("../../lib/geo_location_utils");function n(t){var f=t[0].trace,o=f.visible===!0&&f._length!==0,i={layout:{visibility:"none"},paint:{}},g={layout:{visibility:"none"},paint:{}},p=f._opts={fill:i,line:g,geojson:e()};if(!o)return p;var y=a.extractTraceFeature(t);if(!y)return p;var h=M.makeColorScaleFuncFromTrace(f),m=f.marker,u=m.line||{},_;c.isArrayOrTypedArray(m.opacity)&&(_=function(S){var k=S.mo;return w(k)?+c.constrain(k,0,1):0});var s;c.isArrayOrTypedArray(u.color)&&(s=function(S){return S.mlc});var A;c.isArrayOrTypedArray(u.width)&&(A=function(S){return S.mlw});for(var x=0;x<t.length;x++){var v=t[x],b=v.fOut;if(b){var l=b.properties;l.fc=h(v.z),_&&(l.mo=_(v)),s&&(l.mlc=s(v)),A&&(l.mlw=A(v)),v.ct=l.ct,v._polygons=a.feature2polygons(b)}}var L=_?{type:"identity",property:"mo"}:m.opacity;return c.extendFlat(i.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),c.extendFlat(g.paint,{"line-color":s?{type:"identity",property:"mlc"}:u.color,"line-width":A?{type:"identity",property:"mlw"}:u.width,"line-opacity":L}),i.layout.visibility="visible",g.layout.visibility="visible",p.geojson={type:"FeatureCollection",features:y},r(t),p}function r(t){var f=t[0].trace,o=f._opts,i;if(f.selectedpoints){for(var g=T.makeSelectedPointStyleFns(f),p=0;p<t.length;p++){var y=t[p];y.fOut&&(y.fOut.properties.mo2=g.selectedOpacityFn(y))}i={type:"identity",property:"mo2"}}else i=c.isArrayOrTypedArray(f.marker.opacity)?{type:"identity",property:"mo"}:f.marker.opacity;return c.extendFlat(o.fill.paint,{"fill-opacity":i}),c.extendFlat(o.line.paint,{"line-opacity":i}),o}re.exports={convert:n,convertOnSelect:r}},{"../../components/colorscale":378,"../../components/drawing":388,"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/geojson_utils":497,"fast-isnumeric":190}],727:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/colorscale/defaults"),M=d("./attributes");re.exports=function(e,a,n,r){function t(p,y){return w.coerce(e,a,M,p,y)}var f=t("locations"),o=t("z"),i=t("geojson");if(!w.isArrayOrTypedArray(f)||!f.length||!w.isArrayOrTypedArray(o)||!o.length||!(typeof i=="string"&&i!==""||w.isPlainObject(i))){a.visible=!1;return}t("featureidkey"),a._length=Math.min(f.length,o.length),t("below"),t("text"),t("hovertext"),t("hovertemplate");var g=t("marker.line.width");g&&t("marker.line.color"),t("marker.opacity"),c(e,a,r,t,{prefix:"",cLetter:"z"}),w.coerceSelectionMarkerOpacity(a,t)}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":725}],728:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),calc:d("../choropleth/calc"),plot:d("./plot"),hoverPoints:d("../choropleth/hover"),eventData:d("../choropleth/event_data"),selectPoints:d("../choropleth/select"),styleOnSelect:function(w,c){if(c){var M=c[0].trace;M._glTrace.updateOnSelect(c)}},getBelow:function(w,c){for(var M=c.getMapLayers(),T=M.length-2;T>=0;T--){var e=M[T].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var a=T+1;a<M.length;a++)if(e=M[a].id,typeof e=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:d("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":613,"../choropleth/calc":717,"../choropleth/event_data":719,"../choropleth/hover":720,"../choropleth/select":723,"../heatmap/colorbar":795,"./attributes":725,"./defaults":727,"./plot":729}],729:[function(d,re,ne){var w=d("./convert").convert,c=d("./convert").convertOnSelect,M=d("../../plots/mapbox/constants").traceLayerPrefix;function T(a,n){this.type="choroplethmapbox",this.subplot=a,this.uid=n,this.sourceId="source-"+n,this.layerList=[["fill",M+n+"-fill"],["line",M+n+"-line"]],this.below=null}var e=T.prototype;e.update=function(a){this._update(w(a))},e.updateOnSelect=function(a){this._update(c(a))},e._update=function(a){var n=this.subplot,r=this.layerList,t=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(a.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(a,t),this.below=t);for(var f=0;f<r.length;f++){var o=r[f],i=o[0],g=o[1],p=a[i];n.setOptions(g,"setLayoutProperty",p.layout),p.layout.visibility==="visible"&&n.setOptions(g,"setPaintProperty",p.paint)}},e._addLayers=function(a,n){for(var r=this.subplot,t=this.layerList,f=this.sourceId,o=0;o<t.length;o++){var i=t[o],g=i[0],p=a[g];r.addLayer({type:g,id:i[1],source:f,layout:p.layout,paint:p.paint},n)}},e._removeLayers=function(){for(var a=this.subplot.map,n=this.layerList,r=n.length-1;r>=0;r--)a.removeLayer(n[r][1])},e.dispose=function(){var a=this.subplot.map;this._removeLayers(),a.removeSource(this.sourceId)},re.exports=function(n,r){var t=r[0].trace,f=new T(n,t.uid),o=f.sourceId,i=w(r),g=f.below=n.belowLookup["trace-"+t.uid];return n.map.addSource(o,{type:"geojson",data:i.geojson}),f._addLayers(i,g),r[0].trace._glTrace=f,f}},{"../../plots/mapbox/constants":611,"./convert":726}],730:[function(d,re,ne){var w=d("../../components/colorscale/attributes"),c=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,T=d("../mesh3d/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:M({editType:"calc"},{keys:["norm"]}),uhoverformat:c("u",1),vhoverformat:c("v",1),whoverformat:c("w",1),xhoverformat:c("x"),yhoverformat:c("y"),zhoverformat:c("z"),showlegend:a({},e.showlegend,{dflt:!1})};a(n,w("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var r=["opacity","lightposition","lighting"];r.forEach(function(t){n[t]=T[t]}),n.hoverinfo=a({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,re.exports=n},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../mesh3d/attributes":867}],731:[function(d,re,ne){var w=d("../../components/colorscale/calc");re.exports=function(M,T){for(var e=T.u,a=T.v,n=T.w,r=Math.min(T.x.length,T.y.length,T.z.length,e.length,a.length,n.length),t=-1/0,f=1/0,o=0;o<r;o++){var i=e[o],g=a[o],p=n[o],y=Math.sqrt(i*i+g*g+p*p);t=Math.max(t,y),f=Math.min(f,y)}T._len=r,T._normMax=t,w(M,T,{vals:[f,t],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374}],732:[function(d,re,ne){var w=d("../../../stackgl_modules").gl_cone3d,c=d("../../../stackgl_modules").gl_cone3d.createConeMesh,M=d("../../lib").simpleMap,T=d("../../lib/gl_format_color").parseColorScale,e=d("../../components/colorscale").extractOpts,a=d("../../plots/gl3d/zip3");function n(p,y){this.scene=p,this.uid=y,this.mesh=null,this.data=null}var r=n.prototype;r.handlePick=function(p){if(p.object===this.mesh){var y=p.index=p.data.index,h=this.data.x[y],m=this.data.y[y],u=this.data.z[y],_=this.data.u[y],s=this.data.v[y],A=this.data.w[y];p.traceCoordinate=[h,m,u,_,s,A,Math.sqrt(_*_+s*s+A*A)];var x=this.data.hovertext||this.data.text;return Array.isArray(x)&&x[y]!==void 0?p.textLabel=x[y]:x&&(p.textLabel=x),!0}};var t={xaxis:0,yaxis:1,zaxis:2},f={tip:1,tail:0,cm:.25,center:.5},o={tip:1,tail:1,cm:.75,center:.5};function i(p,y){var h=p.fullSceneLayout,m=p.dataScale,u={};function _(v,b){var l=h[b],L=m[t[b]];return M(v,function(S){return l.d2l(S)*L})}u.vectors=a(_(y.u,"xaxis"),_(y.v,"yaxis"),_(y.w,"zaxis"),y._len),u.positions=a(_(y.x,"xaxis"),_(y.y,"yaxis"),_(y.z,"zaxis"),y._len);var s=e(y);u.colormap=T(y),u.vertexIntensityBounds=[s.min/y._normMax,s.max/y._normMax],u.coneOffset=f[y.anchor],y.sizemode==="scaled"?u.coneSize=y.sizeref||.5:u.coneSize=y.sizeref&&y._normMax?y.sizeref/y._normMax:.5;var A=w(u),x=y.lightposition;return A.lightPosition=[x.x,x.y,x.z],A.ambient=y.lighting.ambient,A.diffuse=y.lighting.diffuse,A.specular=y.lighting.specular,A.roughness=y.lighting.roughness,A.fresnel=y.lighting.fresnel,A.opacity=y.opacity,y._pad=o[y.anchor]*A.vectorScale*A.coneScale*y._normMax,A}r.update=function(p){this.data=p;var y=i(this.scene,p);this.mesh.update(y)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function g(p,y){var h=p.glplot.gl,m=i(p,y),u=c(h,m),_=new n(p,y.uid);return _.mesh=u,_.data=y,u._trace=_,p.glplot.add(u),_}re.exports=g},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib":503,"../../lib/gl_format_color":499,"../../plots/gl3d/zip3":609}],733:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/colorscale/defaults"),M=d("./attributes");re.exports=function(e,a,n,r){function t(h,m){return w.coerce(e,a,M,h,m)}var f=t("u"),o=t("v"),i=t("w"),g=t("x"),p=t("y"),y=t("z");if(!f||!f.length||!o||!o.length||!i||!i.length||!g||!g.length||!p||!p.length||!y||!y.length){a.visible=!1;return}t("sizeref"),t("sizemode"),t("anchor"),t("lighting.ambient"),t("lighting.diffuse"),t("lighting.specular"),t("lighting.roughness"),t("lighting.fresnel"),t("lightposition.x"),t("lightposition.y"),t("lightposition.z"),c(e,a,r,t,{prefix:"",cLetter:"c"}),t("text"),t("hovertext"),t("hovertemplate"),t("uhoverformat"),t("vhoverformat"),t("whoverformat"),t("xhoverformat"),t("yhoverformat"),t("zhoverformat"),a._length=null}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":730}],734:[function(d,re,ne){re.exports={moduleType:"trace",name:"cone",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:d("./calc"),plot:d("./convert"),eventData:function(w,c){return w.norm=c.traceCoordinate[6],w},meta:{}}},{"../../plots/gl3d":598,"./attributes":730,"./calc":731,"./convert":732,"./defaults":733}],735:[function(d,re,ne){var w=d("../heatmap/attributes"),c=d("../scatter/attributes"),M=d("../../plots/cartesian/axis_format_attributes"),T=M.axisHoverFormat,e=M.descriptionOnlyNumbers,a=d("../../components/colorscale/attributes"),n=d("../../components/drawing/attributes").dash,r=d("../../plots/font_attributes"),t=d("../../lib/extend").extendFlat,f=d("../../constants/filter_ops"),o=f.COMPARISON_OPS2,i=f.INTERVAL_OPS,g=c.line;re.exports=t({z:w.z,x:w.x,x0:w.x0,dx:w.dx,y:w.y,y0:w.y0,dy:w.dy,xperiod:w.xperiod,yperiod:w.yperiod,xperiod0:c.xperiod0,yperiod0:c.yperiod0,xperiodalignment:w.xperiodalignment,yperiodalignment:w.yperiodalignment,text:w.text,hovertext:w.hovertext,transpose:w.transpose,xtype:w.xtype,ytype:w.ytype,xhoverformat:T("x"),yhoverformat:T("y"),zhoverformat:T("z",1),hovertemplate:w.hovertemplate,texttemplate:t({},w.texttemplate,{}),textfont:t({},w.textfont,{}),hoverongaps:w.hoverongaps,connectgaps:t({},w.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:r({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(o).concat(i),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:t({},g.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:n,smoothing:t({},g.smoothing,{}),editType:"plot"}},a("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../constants/filter_ops":475,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../heatmap/attributes":792,"../scatter/attributes":927}],736:[function(d,re,ne){var w=d("../../components/colorscale"),c=d("../heatmap/calc"),M=d("./set_contours"),T=d("./end_plus");re.exports=function(a,n){var r=c(a,n),t=r[0].z;M(n,t);var f=n.contours,o=w.extractOpts(n),i;if(f.coloring==="heatmap"&&o.auto&&n.autocontour===!1){var g=f.start,p=T(f),y=f.size||1,h=Math.floor((p-g)/y)+1;isFinite(y)||(y=1,h=1);var m=g-y/2,u=m+h*y;i=[m,u]}else i=t;return w.calc(a,n,{vals:i,cLetter:"z"}),r}},{"../../components/colorscale":378,"../heatmap/calc":793,"./end_plus":746,"./set_contours":754}],737:[function(d,re,ne){re.exports=function(w,c){var M=w[0],T=M.z,e;switch(c.type){case"levels":var a=Math.min(T[0][0],T[0][1]);for(e=0;e<w.length;e++){var n=w[e];n.prefixBoundary=!n.edgepaths.length&&(a>n.level||n.starts.length&&a===n.level)}break;case"constraint":if(M.prefixBoundary=!1,M.edgepaths.length)return;var r=M.x.length,t=M.y.length,f=-1/0,o=1/0;for(e=0;e<t;e++)o=Math.min(o,T[e][0]),o=Math.min(o,T[e][r-1]),f=Math.max(f,T[e][0]),f=Math.max(f,T[e][r-1]);for(e=1;e<r-1;e++)o=Math.min(o,T[0][e]),o=Math.min(o,T[t-1][e]),f=Math.max(f,T[0][e]),f=Math.max(f,T[t-1][e]);var i=c.value,g,p;switch(c._operation){case">":i>f&&(M.prefixBoundary=!0);break;case"<":(i<o||M.starts.length&&i===o)&&(M.prefixBoundary=!0);break;case"[]":g=Math.min(i[0],i[1]),p=Math.max(i[0],i[1]),(p<o||g>f||M.starts.length&&p===o)&&(M.prefixBoundary=!0);break;case"][":g=Math.min(i[0],i[1]),p=Math.max(i[0],i[1]),g<o&&p>f&&(M.prefixBoundary=!0);break}break}}},{}],738:[function(d,re,ne){var w=d("../../components/colorscale"),c=d("./make_color_map"),M=d("./end_plus");function T(e,a,n){var r=a.contours,t=a.line,f=r.size||1,o=r.coloring,i=c(a,{isColorbar:!0});if(o==="heatmap"){var g=w.extractOpts(a);n._fillgradient=g.reversescale?w.flipScale(g.colorscale):g.colorscale,n._zrange=[g.min,g.max]}else o==="fill"&&(n._fillcolor=i);n._line={color:o==="lines"?i:t.color,width:r.showlines!==!1?t.width:0,dash:t.dash},n._levels={start:r.start,end:M(r),size:f}}re.exports={min:"zmin",max:"zmax",calc:T}},{"../../components/colorscale":378,"./end_plus":746,"./make_color_map":751}],739:[function(d,re,ne){re.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],740:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("./label_defaults"),M=d("../../components/color"),T=M.addOpacity,e=M.opacity,a=d("../../constants/filter_ops"),n=a.CONSTRAINT_REDUCTION,r=a.COMPARISON_OPS2;re.exports=function(o,i,g,p,y,h){var m=i.contours,u,_,s,A=g("contours.operation");if(m._operation=n[A],t(g,m),A==="="?u=m.showlines=!0:(u=g("contours.showlines"),s=g("fillcolor",T((o.line||{}).color||y,.5))),u){var x=s&&e(s)?T(i.fillcolor,1):y;_=g("line.color",x),g("line.width",2),g("line.dash")}g("line.smoothing"),c(g,p,_,h)};function t(f,o){var i;r.indexOf(o.operation)===-1?(f("contours.value",[0,1]),Array.isArray(o.value)?o.value.length>2?o.value=o.value.slice(2):o.length===0?o.value=[0,1]:o.length<2?(i=parseFloat(o.value[0]),o.value=[i,i+1]):o.value=[parseFloat(o.value[0]),parseFloat(o.value[1])]:w(o.value)&&(i=parseFloat(o.value),o.value=[i,i+1])):(f("contours.value",0),w(o.value)||(Array.isArray(o.value)?o.value=parseFloat(o.value[0]):o.value=0))}},{"../../components/color":366,"../../constants/filter_ops":475,"./label_defaults":750,"fast-isnumeric":190}],741:[function(d,re,ne){var w=d("../../constants/filter_ops"),c=d("fast-isnumeric");re.exports={"[]":T("[]"),"][":T("]["),">":e(">"),"<":e("<"),"=":e("=")};function M(a,n){var r=Array.isArray(n),t;function f(o){return c(o)?+o:null}return w.COMPARISON_OPS2.indexOf(a)!==-1?t=f(r?n[0]:n):w.INTERVAL_OPS.indexOf(a)!==-1?t=r?[f(n[0]),f(n[1])]:[f(n),f(n)]:w.SET_OPS.indexOf(a)!==-1&&(t=r?n.map(f):[f(n)]),t}function T(a){return function(n){n=M(a,n);var r=Math.min(n[0],n[1]),t=Math.max(n[0],n[1]);return{start:r,end:t,size:t-r}}}function e(a){return function(n){return n=M(a,n),{start:n,end:1/0,size:1/0}}}},{"../../constants/filter_ops":475,"fast-isnumeric":190}],742:[function(d,re,ne){re.exports=function(c,M,T,e){var a=e("contours.start"),n=e("contours.end"),r=a===!1||n===!1,t=T("contours.size"),f;r?f=M.autocontour=!0:f=T("autocontour",!1),(f||!t)&&T("ncontours")}},{}],743:[function(d,re,ne){var w=d("../../lib");re.exports=function(M,T){var e,a,n,r=function(o){return o.reverse()},t=function(o){return o};switch(T){case"=":case"<":return M;case">":for(M.length!==1&&w.warn("Contour data invalid for the specified inequality operation."),a=M[0],e=0;e<a.edgepaths.length;e++)a.edgepaths[e]=r(a.edgepaths[e]);for(e=0;e<a.paths.length;e++)a.paths[e]=r(a.paths[e]);for(e=0;e<a.starts.length;e++)a.starts[e]=r(a.starts[e]);return M;case"][":var f=r;r=t,t=f;case"[]":for(M.length!==2&&w.warn("Contour data invalid for the specified inequality range operation."),a=c(M[0]),n=c(M[1]),e=0;e<a.edgepaths.length;e++)a.edgepaths[e]=r(a.edgepaths[e]);for(e=0;e<a.paths.length;e++)a.paths[e]=r(a.paths[e]);for(e=0;e<a.starts.length;e++)a.starts[e]=r(a.starts[e]);for(;n.edgepaths.length;)a.edgepaths.push(t(n.edgepaths.shift()));for(;n.paths.length;)a.paths.push(t(n.paths.shift()));for(;n.starts.length;)a.starts.push(t(n.starts.shift()));return[a]}};function c(M){return w.extendFlat({},M,{edgepaths:w.extendDeep([],M.edgepaths),paths:w.extendDeep([],M.paths),starts:w.extendDeep([],M.starts)})}},{"../../lib":503}],744:[function(d,re,ne){var w=d("../../lib"),c=d("../heatmap/xyz_defaults"),M=d("../scatter/period_defaults"),T=d("./constraint_defaults"),e=d("./contours_defaults"),a=d("./style_defaults"),n=d("../heatmap/label_defaults"),r=d("./attributes");re.exports=function(f,o,i,g){function p(u,_){return w.coerce(f,o,r,u,_)}function y(u){return w.coerce2(f,o,r,u)}var h=c(f,o,p,g);if(!h){o.visible=!1;return}M(f,o,g,p),p("xhoverformat"),p("yhoverformat"),p("text"),p("hovertext"),p("hoverongaps"),p("hovertemplate");var m=p("contours.type")==="constraint";p("connectgaps",w.isArray1D(o.z)),m?T(f,o,p,g,i):(e(f,o,p,y),a(f,o,p,g)),o.contours&&o.contours.coloring==="heatmap"&&n(p,g)}},{"../../lib":503,"../heatmap/label_defaults":802,"../heatmap/xyz_defaults":807,"../scatter/period_defaults":947,"./attributes":735,"./constraint_defaults":740,"./contours_defaults":742,"./style_defaults":756}],745:[function(d,re,ne){var w=d("../../lib"),c=d("./constraint_mapping"),M=d("./end_plus");re.exports=function(e,a,n){for(var r=e.type==="constraint"?c[e._operation](e.value):e,t=r.size,f=[],o=M(r),i=n.trace._carpetTrace,g=i?{xaxis:i.aaxis,yaxis:i.baxis,x:n.a,y:n.b}:{xaxis:a.xaxis,yaxis:a.yaxis,x:n.x,y:n.y},p=r.start;p<o;p+=t)if(f.push(w.extendFlat({level:p,crossings:{},starts:[],edgepaths:[],paths:[],z:n.z,smoothing:n.trace.line.smoothing},g)),f.length>1e3){w.warn("Too many contours, clipping at 1000",e);break}return f}},{"../../lib":503,"./constraint_mapping":741,"./end_plus":746}],746:[function(d,re,ne){re.exports=function(c){return c.end+c.size/1e6}},{}],747:[function(d,re,ne){var w=d("../../lib"),c=d("./constants");re.exports=function(t,f,o){var i,g,p,y,h;for(f=f||.01,o=o||.01,p=0;p<t.length;p++){for(y=t[p],h=0;h<y.starts.length;h++)g=y.starts[h],e(y,g,"edge",f,o);for(i=0;Object.keys(y.crossings).length&&i<1e4;)i++,g=Object.keys(y.crossings)[0].split(",").map(Number),e(y,g,void 0,f,o);i===1e4&&w.log("Infinite loop in contour?")}};function M(r,t,f,o){return Math.abs(r[0]-t[0])<f&&Math.abs(r[1]-t[1])<o}function T(r,t){var f=r[2]-t[2],o=r[3]-t[3];return Math.sqrt(f*f+o*o)}function e(r,t,f,o,i){var g=t.join(","),p=r.crossings[g],y=a(p,f,t),h=[n(r,t,[-y[0],-y[1]])],m=r.z.length,u=r.z[0].length,_=t.slice(),s=y.slice(),A;for(A=0;A<1e4;A++){if(p>20?(p=c.CHOOSESADDLE[p][(y[0]||y[1])<0?0:1],r.crossings[g]=c.SADDLEREMAINDER[p]):delete r.crossings[g],y=c.NEWDELTA[p],!y){w.log("Found bad marching index:",p,t,r.level);break}h.push(n(r,t,y)),t[0]+=y[0],t[1]+=y[1],g=t.join(","),M(h[h.length-1],h[h.length-2],o,i)&&h.pop();var x=y[0]&&(t[0]<0||t[0]>u-2)||y[1]&&(t[1]<0||t[1]>m-2),v=t[0]===_[0]&&t[1]===_[1]&&y[0]===s[0]&&y[1]===s[1];if(v||f&&x)break;p=r.crossings[g]}A===1e4&&w.log("Infinite loop in contour?");var b=M(h[0],h[h.length-1],o,i),l=0,L=.2*r.smoothing,S=[],k=0,P,z,I,D,R,B,F,V,G,J,j;for(A=1;A<h.length;A++)F=T(h[A],h[A-1]),l+=F,S.push(F);var Y=l/S.length*L;function X(ie){return h[ie%h.length]}for(A=h.length-2;A>=k;A--)if(P=S[A],P<Y){for(I=0,z=A-1;z>=k&&P+S[z]<Y;z--)P+=S[z];if(b&&A===h.length-2)for(I=0;I<z&&P+S[I]<Y;I++)P+=S[I];R=A-z+I+1,B=Math.floor((A+z+I+2)/2),!b&&A===h.length-2?D=h[h.length-1]:!b&&z===-1?D=h[0]:R%2?D=X(B):D=[(X(B)[0]+X(B+1)[0])/2,(X(B)[1]+X(B+1)[1])/2],h.splice(z+1,A-z+1,D),A=z+1,I&&(k=I),b&&(A===h.length-2?h[I]=h[h.length-1]:A===0&&(h[h.length-1]=h[0]))}for(h.splice(0,k),A=0;A<h.length;A++)h[A].length=2;if(!(h.length<2))if(b)h.pop(),r.paths.push(h);else{f||w.log("Unclosed interior contour?",r.level,_.join(","),h.join("L"));var oe=!1;for(V=0;V<r.edgepaths.length;V++)if(J=r.edgepaths[V],!oe&&M(J[0],h[h.length-1],o,i)){h.pop(),oe=!0;var se=!1;for(G=0;G<r.edgepaths.length;G++)if(j=r.edgepaths[G],M(j[j.length-1],h[0],o,i)){se=!0,h.shift(),r.edgepaths.splice(V,1),G===V?r.paths.push(h.concat(j)):(G>V&&G--,r.edgepaths[G]=j.concat(h,J));break}se||(r.edgepaths[V]=h.concat(J))}for(V=0;V<r.edgepaths.length&&!oe;V++)J=r.edgepaths[V],M(J[J.length-1],h[0],o,i)&&(h.shift(),r.edgepaths[V]=J.concat(h),oe=!0);oe||r.edgepaths.push(h)}}function a(r,t,f){var o=0,i=0;return r>20&&t?r===208||r===1114?o=f[0]===0?1:-1:i=f[1]===0?1:-1:c.BOTTOMSTART.indexOf(r)!==-1?i=1:c.LEFTSTART.indexOf(r)!==-1?o=1:c.TOPSTART.indexOf(r)!==-1?i=-1:o=-1,[o,i]}function n(r,t,f){var o=t[0]+Math.max(f[0],0),i=t[1]+Math.max(f[1],0),g=r.z[i][o],p=r.xaxis,y=r.yaxis;if(f[1]){var h=(r.level-g)/(r.z[i][o+1]-g),m=(h!==1?(1-h)*p.c2l(r.x[o]):0)+(h!==0?h*p.c2l(r.x[o+1]):0);return[p.c2p(p.l2c(m),!0),y.c2p(r.y[i],!0),o+h,i]}else{var u=(r.level-g)/(r.z[i+1][o]-g),_=(u!==1?(1-u)*y.c2l(r.y[i]):0)+(u!==0?u*y.c2l(r.y[i+1]):0);return[p.c2p(r.x[o],!0),y.c2p(y.l2c(_),!0),o,i+u]}}},{"../../lib":503,"./constants":739}],748:[function(d,re,ne){var w=d("../../components/color"),c=d("../heatmap/hover");re.exports=function(T,e,a,n,r){r||(r={}),r.isContour=!0;var t=c(T,e,a,n,r);return t&&t.forEach(function(f){var o=f.trace;o.contours.type==="constraint"&&(o.fillcolor&&w.opacity(o.fillcolor)?f.color=w.addOpacity(o.fillcolor,1):o.contours.showlines&&w.opacity(o.line.color)&&(f.color=w.addOpacity(o.line.color,1)))}),t}},{"../../components/color":366,"../heatmap/hover":799}],749:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot").plot,style:d("./style"),colorbar:d("./colorbar"),hoverPoints:d("./hover"),moduleType:"trace",name:"contour",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":568,"./attributes":735,"./calc":736,"./colorbar":738,"./defaults":744,"./hover":748,"./plot":753,"./style":755}],750:[function(d,re,ne){var w=d("../../lib");re.exports=function(M,T,e,a){a||(a={});var n=M("contours.showlabels");if(n){var r=T.font;w.coerceFont(M,"contours.labelfont",{family:r.family,size:r.size,color:e}),M("contours.labelformat")}a.hasHover!==!1&&M("zhoverformat")}},{"../../lib":503}],751:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/colorscale"),M=d("./end_plus");re.exports=function(e){var a=e.contours,n=a.start,r=M(a),t=a.size||1,f=Math.floor((r-n)/t)+1,o=a.coloring==="lines"?0:1,i=c.extractOpts(e);isFinite(t)||(t=1,f=1);var g=i.reversescale?c.flipScale(i.colorscale):i.colorscale,p=g.length,y=new Array(p),h=new Array(p),m,u;if(a.coloring==="heatmap"){var _=i.min,s=i.max;for(u=0;u<p;u++)m=g[u],y[u]=m[0]*(s-_)+_,h[u]=m[1];var A=w.extent([_,s,a.start,a.start+t*(f-1)]),x=A[_<s?0:1],v=A[_<s?1:0];x!==_&&(y.splice(0,0,x),h.splice(0,0,h[0])),v!==s&&(y.push(v),h.push(h[h.length-1]))}else for(u=0;u<p;u++)m=g[u],y[u]=(m[0]*(f+o-1)-o/2)*t+n,h[u]=m[1];return c.makeColorScaleFunc({domain:y,range:h},{noNumericCheck:!0})}},{"../../components/colorscale":378,"./end_plus":746,"@plotly/d3":58}],752:[function(d,re,ne){var w=d("./constants");re.exports=function(T){var e=T[0].z,a=e.length,n=e[0].length,r=a===2||n===2,t,f,o,i,g,p,y,h,m;for(f=0;f<a-1;f++)for(i=[],f===0&&(i=i.concat(w.BOTTOMSTART)),f===a-2&&(i=i.concat(w.TOPSTART)),t=0;t<n-1;t++)for(o=i.slice(),t===0&&(o=o.concat(w.LEFTSTART)),t===n-2&&(o=o.concat(w.RIGHTSTART)),g=t+","+f,p=[[e[f][t],e[f][t+1]],[e[f+1][t],e[f+1][t+1]]],m=0;m<T.length;m++)h=T[m],y=c(h.level,p),y&&(h.crossings[g]=y,o.indexOf(y)!==-1&&(h.starts.push([t,f]),r&&o.indexOf(y,o.indexOf(y)+1)!==-1&&h.starts.push([t,f])))};function c(M,T){var e=(T[0][0]>M?0:1)+(T[0][1]>M?0:2)+(T[1][1]>M?0:4)+(T[1][0]>M?0:8);if(e===5||e===10){var a=(T[0][0]+T[0][1]+T[1][0]+T[1][1])/4;return M>a?e===5?713:1114:e===5?104:208}return e===15?0:e}},{"./constants":739}],753:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../components/drawing"),T=d("../../components/colorscale"),e=d("../../lib/svg_text_utils"),a=d("../../plots/cartesian/axes"),n=d("../../plots/cartesian/set_convert"),r=d("../heatmap/plot"),t=d("./make_crossings"),f=d("./find_all_paths"),o=d("./empty_pathinfo"),i=d("./convert_to_constraints"),g=d("./close_boundaries"),p=d("./constants"),y=p.LABELOPTIMIZER;ne.plot=function(b,l,L,S){var k=l.xaxis,P=l.yaxis;c.makeTraceGroups(S,L,"contour").each(function(z){var I=w.select(this),D=z[0],R=D.trace,B=D.x,F=D.y,V=R.contours,G=o(V,l,D),J=c.ensureSingle(I,"g","heatmapcoloring"),j=[];V.coloring==="heatmap"&&(j=[z]),r(b,l,j,J),t(G),f(G);var Y=k.c2p(B[0],!0),X=k.c2p(B[B.length-1],!0),oe=P.c2p(F[0],!0),se=P.c2p(F[F.length-1],!0),ie=[[Y,se],[X,se],[X,oe],[Y,oe]],N=G;V.type==="constraint"&&(N=i(G,V._operation)),h(I,ie,V),m(I,N,ie,V),_(I,G,b,D,V),A(I,l,b,D,ie)})};function h(v,b,l){var L=c.ensureSingle(v,"g","contourbg"),S=L.selectAll("path").data(l.coloring==="fill"?[0]:[]);S.enter().append("path"),S.exit().remove(),S.attr("d","M"+b.join("L")+"Z").style("stroke","none")}function m(v,b,l,L){var S=L.coloring==="fill"||L.type==="constraint"&&L._operation!=="=",k="M"+l.join("L")+"Z";S&&g(b,L);var P=c.ensureSingle(v,"g","contourfill"),z=P.selectAll("path").data(S?b:[]);z.enter().append("path"),z.exit().remove(),z.each(function(I){var D=(I.prefixBoundary?k:"")+u(I,l);D?w.select(this).attr("d",D).style("stroke","none"):w.select(this).remove()})}function u(v,b){var l="",L=0,S=v.edgepaths.map(function(Y,X){return X}),k=!0,P,z,I,D,R,B;function F(Y){return Math.abs(Y[1]-b[0][1])<.01}function V(Y){return Math.abs(Y[1]-b[2][1])<.01}function G(Y){return Math.abs(Y[0]-b[0][0])<.01}function J(Y){return Math.abs(Y[0]-b[2][0])<.01}for(;S.length;){for(B=M.smoothopen(v.edgepaths[L],v.smoothing),l+=k?B:B.replace(/^M/,"L"),S.splice(S.indexOf(L),1),P=v.edgepaths[L][v.edgepaths[L].length-1],D=-1,I=0;I<4;I++){if(!P){c.log("Missing end?",L,v);break}for(F(P)&&!J(P)?z=b[1]:G(P)?z=b[0]:V(P)?z=b[3]:J(P)&&(z=b[2]),R=0;R<v.edgepaths.length;R++){var j=v.edgepaths[R][0];Math.abs(P[0]-z[0])<.01?Math.abs(P[0]-j[0])<.01&&(j[1]-P[1])*(z[1]-j[1])>=0&&(z=j,D=R):Math.abs(P[1]-z[1])<.01?Math.abs(P[1]-j[1])<.01&&(j[0]-P[0])*(z[0]-j[0])>=0&&(z=j,D=R):c.log("endpt to newendpt is not vert. or horz.",P,z,j)}if(P=z,D>=0)break;l+="L"+z}if(D===v.edgepaths.length){c.log("unclosed perimeter path");break}L=D,k=S.indexOf(L)===-1,k&&(L=S[0],l+="Z")}for(L=0;L<v.paths.length;L++)l+=M.smoothclosed(v.paths[L],v.smoothing);return l}function _(v,b,l,L,S){var k=c.ensureSingle(v,"g","contourlines"),P=S.showlines!==!1,z=S.showlabels,I=P&&z,D=ne.createLines(k,P||z,b),R=ne.createLineClip(k,I,l,L.trace.uid),B=v.selectAll("g.contourlabels").data(z?[0]:[]);if(B.exit().remove(),B.enter().append("g").classed("contourlabels",!0),z){var F=[],V=[];c.clearLocationCache();var G=ne.labelFormatter(l,L),J=M.tester.append("text").attr("data-notex",1).call(M.font,S.labelfont),j=b[0].xaxis,Y=b[0].yaxis,X=j._length,oe=Y._length,se=j.range,ie=Y.range,N=c.aggNums(Math.min,null,L.x),U=c.aggNums(Math.max,null,L.x),q=c.aggNums(Math.min,null,L.y),Q=c.aggNums(Math.max,null,L.y),W=Math.max(j.c2p(N,!0),0),Z=Math.min(j.c2p(U,!0),X),ee=Math.max(Y.c2p(Q,!0),0),te=Math.min(Y.c2p(q,!0),oe),ae={};se[0]<se[1]?(ae.left=W,ae.right=Z):(ae.left=Z,ae.right=W),ie[0]<ie[1]?(ae.top=ee,ae.bottom=te):(ae.top=te,ae.bottom=ee),ae.middle=(ae.top+ae.bottom)/2,ae.center=(ae.left+ae.right)/2,F.push([[ae.left,ae.top],[ae.right,ae.top],[ae.right,ae.bottom],[ae.left,ae.bottom]]);var le=Math.sqrt(X*X+oe*oe),ye=p.LABELDISTANCE*le/Math.max(1,b.length/p.LABELINCREASE);D.each(function(fe){var pe=ne.calcTextOpts(fe.level,G,J,l);w.select(this).selectAll("path").each(function(){var ge=this,Ae=c.getVisibleSegment(ge,ae,pe.height/2);if(!!Ae&&!(Ae.len<(pe.width+pe.height)*p.LABELMIN))for(var we=Math.min(Math.ceil(Ae.len/ye),p.LABELMAX),De=0;De<we;De++){var Be=ne.findBestTextLocation(ge,Ae,pe,V,ae);if(!Be)break;ne.addLabelData(Be,pe,V,F)}})}),J.remove(),ne.drawLabels(B,V,l,R,I?F:null)}z&&!P&&D.remove()}ne.createLines=function(v,b,l){var L=l[0].smoothing,S=v.selectAll("g.contourlevel").data(b?l:[]);if(S.exit().remove(),S.enter().append("g").classed("contourlevel",!0),b){var k=S.selectAll("path.openline").data(function(z){return z.pedgepaths||z.edgepaths});k.exit().remove(),k.enter().append("path").classed("openline",!0),k.attr("d",function(z){return M.smoothopen(z,L)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var P=S.selectAll("path.closedline").data(function(z){return z.ppaths||z.paths});P.exit().remove(),P.enter().append("path").classed("closedline",!0),P.attr("d",function(z){return M.smoothclosed(z,L)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return S},ne.createLineClip=function(v,b,l,L){var S=l._fullLayout._clips,k=b?"clipline"+L:null,P=S.selectAll("#"+k).data(b?[0]:[]);return P.exit().remove(),P.enter().append("clipPath").classed("contourlineclip",!0).attr("id",k),M.setClipUrl(v,k,l),P},ne.labelFormatter=function(v,b){var l=v._fullLayout,L=b.trace,S=L.contours,k={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(S.labelformat)k.tickformat=S.labelformat,n(k,l);else{var P=T.extractOpts(L);if(P&&P.colorbar&&P.colorbar._axis)k=P.colorbar._axis;else{if(S.type==="constraint"){var z=S.value;Array.isArray(z)?k.range=[z[0],z[z.length-1]]:k.range=[z,z]}else k.range=[S.start,S.end],k.nticks=(S.end-S.start)/S.size;k.range[0]===k.range[1]&&(k.range[1]+=k.range[0]||1),k.nticks||(k.nticks=1e3),n(k,l),a.prepTicks(k),k._tmin=null,k._tmax=null}}return function(I){return a.tickText(k,I).text}},ne.calcTextOpts=function(v,b,l,L){var S=b(v);l.text(S).call(e.convertToTspans,L);var k=l.node(),P=M.bBox(k,!0);return{text:S,width:P.width,height:P.height,fontSize:+k.style["font-size"].replace("px",""),level:v,dy:(P.top+P.bottom)/2}},ne.findBestTextLocation=function(v,b,l,L,S){var k=l.width,P,z,I,D,R;b.isClosed?(z=b.len/y.INITIALSEARCHPOINTS,P=b.min+z/2,I=b.max):(z=(b.len-k)/(y.INITIALSEARCHPOINTS+1),P=b.min+z+k/2,I=b.max-(z+k)/2);for(var B=1/0,F=0;F<y.ITERATIONS;F++){for(var V=P;V<I;V+=z){var G=c.getTextLocation(v,b.total,V,k),J=s(G,l,L,S);J<B&&(B=J,R=G,D=V)}if(B>y.MAXCOST*2)break;F&&(z/=2),P=D-z/2,I=P+z*1.5}if(B<=y.MAXCOST)return R};function s(v,b,l,L){var S=b.width/2,k=b.height/2,P=v.x,z=v.y,I=v.theta,D=Math.cos(I)*S,R=Math.sin(I)*S,B=(P>L.center?L.right-P:P-L.left)/(D+Math.abs(Math.sin(I)*k)),F=(z>L.middle?L.bottom-z:z-L.top)/(Math.abs(R)+Math.cos(I)*k);if(B<1||F<1)return 1/0;var V=y.EDGECOST*(1/(B-1)+1/(F-1));V+=y.ANGLECOST*I*I;for(var G=P-D,J=z-R,j=P+D,Y=z+R,X=0;X<l.length;X++){var oe=l[X],se=Math.cos(oe.theta)*oe.width/2,ie=Math.sin(oe.theta)*oe.width/2,N=c.segmentDistance(G,J,j,Y,oe.x-se,oe.y-ie,oe.x+se,oe.y+ie)*2/(b.height+oe.height),U=oe.level===b.level,q=U?y.SAMELEVELDISTANCE:1;if(N<=q)return 1/0;var Q=y.NEIGHBORCOST*(U?y.SAMELEVELFACTOR:1);V+=Q/(N-q)}return V}ne.addLabelData=function(v,b,l,L){var S=b.fontSize,k=b.width+S/3,P=Math.max(0,b.height-S/3),z=v.x,I=v.y,D=v.theta,R=Math.sin(D),B=Math.cos(D),F=function(G,J){return[z+G*B-J*R,I+G*R+J*B]},V=[F(-k/2,-P/2),F(-k/2,P/2),F(k/2,P/2),F(k/2,-P/2)];l.push({text:b.text,x:z,y:I,dy:b.dy,theta:D,level:b.level,width:k,height:P}),L.push(V)},ne.drawLabels=function(v,b,l,L,S){var k=v.selectAll("text").data(b,function(D){return D.text+","+D.x+","+D.y+","+D.theta});if(k.exit().remove(),k.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(D){var R=D.x+Math.sin(D.theta)*D.dy,B=D.y-Math.cos(D.theta)*D.dy;w.select(this).text(D.text).attr({x:R,y:B,transform:"rotate("+180*D.theta/Math.PI+" "+R+" "+B+")"}).call(e.convertToTspans,l)}),S){for(var P="",z=0;z<S.length;z++)P+="M"+S[z].join("L")+"Z";var I=c.ensureSingle(L,"path","");I.attr("d",P)}};function A(v,b,l,L,S){var k=L.trace,P=l._fullLayout._clips,z="clip"+k.uid,I=P.selectAll("#"+z).data(k.connectgaps?[]:[0]);if(I.enter().append("clipPath").classed("contourclip",!0).attr("id",z),I.exit().remove(),k.connectgaps===!1){var D={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:b.xaxis,yaxis:b.yaxis,x:L.x,y:L.y,z:x(L),smoothing:0};t([D]),f([D]),g([D],{type:"levels"});var R=c.ensureSingle(I,"path","");R.attr("d",(D.prefixBoundary?"M"+S.join("L")+"Z":"")+u(D,S))}else z=null;M.setClipUrl(v,z,l)}function x(v){var b=v.trace._emptypoints,l=[],L=v.z.length,S=v.z[0].length,k,P=[],z;for(k=0;k<S;k++)P.push(1);for(k=0;k<L;k++)l.push(P.slice());for(k=0;k<b.length;k++)z=b[k],l[z[0]][z[1]]=0;return v.zmask=l,l}},{"../../components/colorscale":378,"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../plots/cartesian/set_convert":576,"../heatmap/plot":804,"./close_boundaries":737,"./constants":739,"./convert_to_constraints":743,"./empty_pathinfo":745,"./find_all_paths":747,"./make_crossings":752,"@plotly/d3":58}],754:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("../../lib");re.exports=function(e,a){var n=e.contours;if(e.autocontour){var r=e.zmin,t=e.zmax;(e.zauto||r===void 0)&&(r=c.aggNums(Math.min,null,a)),(e.zauto||t===void 0)&&(t=c.aggNums(Math.max,null,a));var f=M(r,t,e.ncontours);n.size=f.dtick,n.start=w.tickFirst(f),f.range.reverse(),n.end=w.tickFirst(f),n.start===r&&(n.start+=n.size),n.end===t&&(n.end-=n.size),n.start>n.end&&(n.start=n.end=(n.start+n.end)/2),e._input.contours||(e._input.contours={}),c.extendFlat(e._input.contours,{start:n.start,end:n.end,size:n.size}),e._input.autocontour=!0}else if(n.type!=="constraint"){var o=n.start,i=n.end,g=e._input.contours;if(o>i&&(n.start=g.start=i,i=n.end=g.end=o,o=n.start),!(n.size>0)){var p;o===i?p=1:p=M(o,i,e.ncontours).dtick,g.size=n.size=p}}};function M(T,e,a){var n={type:"linear",range:[T,e]};return w.autoTicks(n,(e-T)/(a||15)),n}},{"../../lib":503,"../../plots/cartesian/axes":554}],755:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/drawing"),M=d("../heatmap/style"),T=d("./make_color_map");re.exports=function(a){var n=w.select(a).selectAll("g.contour");n.style("opacity",function(r){return r[0].trace.opacity}),n.each(function(r){var t=w.select(this),f=r[0].trace,o=f.contours,i=f.line,g=o.size||1,p=o.start,y=o.type==="constraint",h=!y&&o.coloring==="lines",m=!y&&o.coloring==="fill",u=h||m?T(f):null;t.selectAll("g.contourlevel").each(function(A){w.select(this).selectAll("path").call(c.lineGroupStyle,i.width,h?u(A.level):i.color,i.dash)});var _=o.labelfont;if(t.selectAll("g.contourlabels text").each(function(A){c.font(w.select(this),{family:_.family,size:_.size,color:_.color||(h?u(A.level):i.color)})}),y)t.selectAll("g.contourfill path").style("fill",f.fillcolor);else if(m){var s;t.selectAll("g.contourfill path").style("fill",function(A){return s===void 0&&(s=A.level),u(A.level+.5*g)}),s===void 0&&(s=p),t.selectAll("g.contourbg path").style("fill",u(s-.5*g))}}),M(a)}},{"../../components/drawing":388,"../heatmap/style":805,"./make_color_map":751,"@plotly/d3":58}],756:[function(d,re,ne){var w=d("../../components/colorscale/defaults"),c=d("./label_defaults");re.exports=function(T,e,a,n,r){var t=a("contours.coloring"),f,o="";t==="fill"&&(f=a("contours.showlines")),f!==!1&&(t!=="lines"&&(o=a("line.color","#000")),a("line.width",.5),a("line.dash")),t!=="none"&&(T.showlegend!==!0&&(e.showlegend=!1),e._dfltShowLegend=!1,w(T,e,n,a,{prefix:"",cLetter:"z"})),a("line.smoothing"),c(a,n,o,r)}},{"../../components/colorscale/defaults":376,"./label_defaults":750}],757:[function(d,re,ne){var w=d("../heatmap/attributes"),c=d("../contour/attributes"),M=d("../../components/colorscale/attributes"),T=d("../../lib/extend").extendFlat,e=c.contours;re.exports=T({carpet:{valType:"string",editType:"calc"},z:w.z,a:w.x,a0:w.x0,da:w.dx,b:w.y,b0:w.y0,db:w.dy,text:w.text,hovertext:w.hovertext,transpose:w.transpose,atype:w.xtype,btype:w.ytype,fillcolor:c.fillcolor,autocontour:c.autocontour,ncontours:c.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:c.line.color,width:c.line.width,dash:c.line.dash,smoothing:c.line.smoothing,editType:"plot"},transforms:void 0},M("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../contour/attributes":735,"../heatmap/attributes":792}],758:[function(d,re,ne){var w=d("../../components/colorscale/calc"),c=d("../../lib"),M=d("../heatmap/convert_column_xyz"),T=d("../heatmap/clean_2d_array"),e=d("../heatmap/interp2d"),a=d("../heatmap/find_empties"),n=d("../heatmap/make_bound_array"),r=d("./defaults"),t=d("../carpet/lookup_carpetid"),f=d("../contour/set_contours");re.exports=function(g,p){var y=p._carpetTrace=t(g,p);if(!(!y||!y.visible||y.visible==="legendonly")){if(!p.a||!p.b){var h=g.data[y.index],m=g.data[p.index];m.a||(m.a=h.a),m.b||(m.b=h.b),r(m,p,p._defaultColor,g._fullLayout)}var u=o(g,p);return f(p,p._z),u}};function o(i,g){var p=g._carpetTrace,y=p.aaxis,h=p.baxis,m,u,_,s,A,x,v;y._minDtick=0,h._minDtick=0,c.isArray1D(g.z)&&M(g,y,h,"a","b",["z"]),m=g._a=g._a||g.a,s=g._b=g._b||g.b,m=m?y.makeCalcdata(g,"_a"):[],s=s?h.makeCalcdata(g,"_b"):[],u=g.a0||0,_=g.da||1,A=g.b0||0,x=g.db||1,v=g._z=T(g._z||g.z,g.transpose),g._emptypoints=a(v),e(v,g._emptypoints);var b=c.maxRowLength(v),l=g.xtype==="scaled"?"":m,L=n(g,l,u,_,b,y),S=g.ytype==="scaled"?"":s,k=n(g,S,A,x,v.length,h),P={a:L,b:k,z:v};return g.contours.type==="levels"&&g.contours.coloring!=="none"&&w(i,g,{vals:v,containerStr:"",cLetter:"z"}),[P]}},{"../../components/colorscale/calc":374,"../../lib":503,"../carpet/lookup_carpetid":708,"../contour/set_contours":754,"../heatmap/clean_2d_array":794,"../heatmap/convert_column_xyz":796,"../heatmap/find_empties":798,"../heatmap/interp2d":801,"../heatmap/make_bound_array":803,"./defaults":759}],759:[function(d,re,ne){var w=d("../../lib"),c=d("../heatmap/xyz_defaults"),M=d("./attributes"),T=d("../contour/constraint_defaults"),e=d("../contour/contours_defaults"),a=d("../contour/style_defaults");re.exports=function(r,t,f,o){function i(h,m){return w.coerce(r,t,M,h,m)}function g(h){return w.coerce2(r,t,M,h)}if(i("carpet"),r.a&&r.b){var p=c(r,t,i,o,"a","b");if(!p){t.visible=!1;return}i("text");var y=i("contours.type")==="constraint";y?T(r,t,i,o,f,{hasHover:!1}):(e(r,t,i,g),a(r,t,i,o,{hasHover:!1}))}else t._defaultColor=f,t._length=null}},{"../../lib":503,"../contour/constraint_defaults":740,"../contour/contours_defaults":742,"../contour/style_defaults":756,"../heatmap/xyz_defaults":807,"./attributes":757}],760:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../contour/colorbar"),calc:d("./calc"),plot:d("./plot"),style:d("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":568,"../contour/colorbar":738,"../contour/style":755,"./attributes":757,"./calc":758,"./defaults":759,"./plot":761}],761:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../carpet/map_1d_array"),M=d("../carpet/makepath"),T=d("../../components/drawing"),e=d("../../lib"),a=d("../contour/make_crossings"),n=d("../contour/find_all_paths"),r=d("../contour/plot"),t=d("../contour/constants"),f=d("../contour/convert_to_constraints"),o=d("../contour/empty_pathinfo"),i=d("../contour/close_boundaries"),g=d("../carpet/lookup_carpetid"),p=d("../carpet/axis_aligned_line");re.exports=function(l,L,S,k){var P=L.xaxis,z=L.yaxis;e.makeTraceGroups(k,S,"contour").each(function(I){var D=w.select(this),R=I[0],B=R.trace,F=B._carpetTrace=g(l,B),V=l.calcdata[F.index][0];if(!F.visible||F.visible==="legendonly")return;var G=R.a,J=R.b,j=B.contours,Y=o(j,L,R),X=j.type==="constraint",oe=j._operation,se=X?oe==="="?"lines":"fill":j.coloring;function ie(ye){var fe=F.ab2xy(ye[0],ye[1],!0);return[P.c2p(fe[0]),z.c2p(fe[1])]}var N=[[G[0],J[J.length-1]],[G[G.length-1],J[J.length-1]],[G[G.length-1],J[0]],[G[0],J[0]]];a(Y);var U=(G[G.length-1]-G[0])*1e-8,q=(J[J.length-1]-J[0])*1e-8;n(Y,U,q);var Q=Y;j.type==="constraint"&&(Q=f(Y,oe)),y(Y,ie);var W,Z,ee,te,ae=[];for(te=V.clipsegments.length-1;te>=0;te--)W=V.clipsegments[te],Z=c([],W.x,P.c2p),ee=c([],W.y,z.c2p),Z.reverse(),ee.reverse(),ae.push(M(Z,ee,W.bicubic));var le="M"+ae.join("L")+"Z";A(D,V.clipsegments,P,z,X,se),x(B,D,P,z,Q,N,ie,F,V,se,le),h(D,Y,l,R,j,L,F),T.setClipUrl(D,F._clipPathId,l)})};function y(b,l){var L,S,k,P,z,I,D,R,B;for(L=0;L<b.length;L++){for(P=b[L],z=P.pedgepaths=[],I=P.ppaths=[],S=0;S<P.edgepaths.length;S++){for(B=P.edgepaths[S],D=[],k=0;k<B.length;k++)D[k]=l(B[k]);z.push(D)}for(S=0;S<P.paths.length;S++){for(B=P.paths[S],R=[],k=0;k<B.length;k++)R[k]=l(B[k]);I.push(R)}}}function h(b,l,L,S,k,P,z){var I=e.ensureSingle(b,"g","contourlines"),D=k.showlines!==!1,R=k.showlabels,B=D&&R,F=r.createLines(I,D||R,l),V=r.createLineClip(I,B,L,S.trace.uid),G=b.selectAll("g.contourlabels").data(R?[0]:[]);if(G.exit().remove(),G.enter().append("g").classed("contourlabels",!0),R){var J=P.xaxis,j=P.yaxis,Y=J._length,X=j._length,oe=[[[0,0],[Y,0],[Y,X],[0,X]]],se=[];e.clearLocationCache();var ie=r.labelFormatter(L,S),N=T.tester.append("text").attr("data-notex",1).call(T.font,k.labelfont),U={left:0,right:Y,center:Y/2,top:0,bottom:X,middle:X/2},q=Math.sqrt(Y*Y+X*X),Q=t.LABELDISTANCE*q/Math.max(1,l.length/t.LABELINCREASE);F.each(function(W){var Z=r.calcTextOpts(W.level,ie,N,L);w.select(this).selectAll("path").each(function(ee){var te=this,ae=e.getVisibleSegment(te,U,Z.height/2);if(!!ae&&(m(te,ee,W,ae,z,Z.height),!(ae.len<(Z.width+Z.height)*t.LABELMIN)))for(var le=Math.min(Math.ceil(ae.len/Q),t.LABELMAX),ye=0;ye<le;ye++){var fe=r.findBestTextLocation(te,ae,Z,se,U);if(!fe)break;r.addLabelData(fe,Z,se,oe)}})}),N.remove(),r.drawLabels(G,se,L,V,B?oe:null)}R&&!D&&F.remove()}function m(b,l,L,S,k,P){for(var z,I=0;I<L.pedgepaths.length;I++)l===L.pedgepaths[I]&&(z=L.edgepaths[I]);if(!z)return;var D=k.a[0],R=k.a[k.a.length-1],B=k.b[0],F=k.b[k.b.length-1];function V(X,oe){var se=0,ie,N=.1;return(Math.abs(X[0]-D)<N||Math.abs(X[0]-R)<N)&&(ie=_(k.dxydb_rough(X[0],X[1],N)),se=Math.max(se,P*s(oe,ie)/2)),(Math.abs(X[1]-B)<N||Math.abs(X[1]-F)<N)&&(ie=_(k.dxyda_rough(X[0],X[1],N)),se=Math.max(se,P*s(oe,ie)/2)),se}var G=u(b,0,1),J=u(b,S.total,S.total-1),j=V(z[0],G),Y=S.total-V(z[z.length-1],J);S.min<j&&(S.min=j),S.max>Y&&(S.max=Y),S.len=S.max-S.min}function u(b,l,L){var S=b.getPointAtLength(l),k=b.getPointAtLength(L),P=k.x-S.x,z=k.y-S.y,I=Math.sqrt(P*P+z*z);return[P/I,z/I]}function _(b){var l=Math.sqrt(b[0]*b[0]+b[1]*b[1]);return[b[0]/l,b[1]/l]}function s(b,l){var L=Math.abs(b[0]*l[0]+b[1]*l[1]),S=Math.sqrt(1-L*L);return S/L}function A(b,l,L,S,k,P){var z,I,D,R,B=e.ensureSingle(b,"g","contourbg"),F=B.selectAll("path").data(P==="fill"&&!k?[0]:[]);F.enter().append("path"),F.exit().remove();var V=[];for(R=0;R<l.length;R++)z=l[R],I=c([],z.x,L.c2p),D=c([],z.y,S.c2p),V.push(M(I,D,z.bicubic));F.attr("d","M"+V.join("L")+"Z").style("stroke","none")}function x(b,l,L,S,k,P,z,I,D,R,B){var F=R==="fill";F&&i(k,b.contours);var V=e.ensureSingle(l,"g","contourfill"),G=V.selectAll("path").data(F?k:[]);G.enter().append("path"),G.exit().remove(),G.each(function(J){var j=(J.prefixBoundary?B:"")+v(b,J,P,z,I,D,L,S);j?w.select(this).attr("d",j).style("stroke","none"):w.select(this).remove()})}function v(b,l,L,S,k,P,z,I){var D,R="",B=l.edgepaths.map(function(ee,te){return te}),F=!0,V,G,J,j,Y,X,oe=Math.abs(L[0][0]-L[2][0])*1e-4,se=Math.abs(L[0][1]-L[2][1])*1e-4;function ie(ee){return Math.abs(ee[1]-L[0][1])<se}function N(ee){return Math.abs(ee[1]-L[2][1])<se}function U(ee){return Math.abs(ee[0]-L[0][0])<oe}function q(ee){return Math.abs(ee[0]-L[2][0])<oe}function Q(ee,te){var ae,le,ye,fe,pe="";for(ie(ee)&&!q(ee)||N(ee)&&!U(ee)?(fe=k.aaxis,ye=p(k,P,[ee[0],te[0]],.5*(ee[1]+te[1]))):(fe=k.baxis,ye=p(k,P,.5*(ee[0]+te[0]),[ee[1],te[1]])),ae=1;ae<ye.length;ae++)for(pe+=fe.smoothing?"C":"L",le=0;le<ye[ae].length;le++){var ge=ye[ae][le];pe+=[z.c2p(ge[0]),I.c2p(ge[1])]+" "}return pe}for(D=0,V=null;B.length;){var W=l.edgepaths[D][0];for(V&&(R+=Q(V,W)),X=T.smoothopen(l.edgepaths[D].map(S),l.smoothing),R+=F?X:X.replace(/^M/,"L"),B.splice(B.indexOf(D),1),V=l.edgepaths[D][l.edgepaths[D].length-1],j=-1,J=0;J<4;J++){if(!V){e.log("Missing end?",D,l);break}for(ie(V)&&!q(V)?G=L[1]:U(V)?G=L[0]:N(V)?G=L[3]:q(V)&&(G=L[2]),Y=0;Y<l.edgepaths.length;Y++){var Z=l.edgepaths[Y][0];Math.abs(V[0]-G[0])<oe?Math.abs(V[0]-Z[0])<oe&&(Z[1]-V[1])*(G[1]-Z[1])>=0&&(G=Z,j=Y):Math.abs(V[1]-G[1])<se?Math.abs(V[1]-Z[1])<se&&(Z[0]-V[0])*(G[0]-Z[0])>=0&&(G=Z,j=Y):e.log("endpt to newendpt is not vert. or horz.",V,G,Z)}if(j>=0)break;R+=Q(V,G),V=G}if(j===l.edgepaths.length){e.log("unclosed perimeter path");break}D=j,F=B.indexOf(D)===-1,F&&(D=B[0],R+=Q(V,G)+"Z",V=null)}for(D=0;D<l.paths.length;D++)R+=T.smoothclosed(l.paths[D].map(S),l.smoothing);return R}},{"../../components/drawing":388,"../../lib":503,"../carpet/axis_aligned_line":692,"../carpet/lookup_carpetid":708,"../carpet/makepath":709,"../carpet/map_1d_array":710,"../contour/close_boundaries":737,"../contour/constants":739,"../contour/convert_to_constraints":743,"../contour/empty_pathinfo":745,"../contour/find_all_paths":747,"../contour/make_crossings":752,"../contour/plot":753,"@plotly/d3":58}],762:[function(d,re,ne){var w=d("../../components/colorscale/attributes"),c=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../plots/attributes"),T=d("../scattermapbox/attributes"),e=d("../../lib/extend").extendFlat;re.exports=e({lon:T.lon,lat:T.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:T.text,hovertext:T.hovertext,hoverinfo:e({},M.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:c(),showlegend:e({},M.showlegend,{dflt:!1})},w("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scattermapbox/attributes":993}],763:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib").isArrayOrTypedArray,M=d("../../constants/numerical").BADNUM,T=d("../../components/colorscale/calc"),e=d("../../lib")._;re.exports=function(n,r){for(var t=r._length,f=new Array(t),o=r.z,i=c(o)&&o.length,g=0;g<t;g++){var p=f[g]={},y=r.lon[g],h=r.lat[g];if(p.lonlat=w(y)&&w(h)?[+y,+h]:[M,M],i){var m=o[g];p.z=w(m)?m:M}}return T(n,r,{vals:i?o:[0,1],containerStr:"",cLetter:"z"}),t&&(f[0].t={labels:{lat:e(n,"lat:")+" ",lon:e(n,"lon:")+" "}}),f}},{"../../components/colorscale/calc":374,"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],764:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("../../components/color"),T=d("../../components/colorscale"),e=d("../../constants/numerical").BADNUM,a=d("../../lib/geojson_utils").makeBlank;re.exports=function(r){var t=r[0].trace,f=t.visible===!0&&t._length!==0,o={layout:{visibility:"none"},paint:{}},i=t._opts={heatmap:o,geojson:a()};if(!f)return i;var g=[],p,y=t.z,h=t.radius,m=c.isArrayOrTypedArray(y)&&y.length,u=c.isArrayOrTypedArray(h);for(p=0;p<r.length;p++){var _=r[p],s=_.lonlat;if(s[0]!==e){var A={};if(m){var x=_.z;A.z=x!==e?x:0}u&&(A.r=w(h[p])&&h[p]>0?+h[p]:0),g.push({type:"Feature",geometry:{type:"Point",coordinates:s},properties:A})}}var v=T.extractOpts(t),b=v.reversescale?T.flipScale(v.colorscale):v.colorscale,l=b[0][1],L=M.opacity(l)<1?l:M.addOpacity(l,0),S=["interpolate",["linear"],["heatmap-density"],0,L];for(p=1;p<b.length;p++)S.push(b[p][0],b[p][1]);var k=["interpolate",["linear"],["get","z"],v.min,0,v.max,1];return c.extendFlat(i.heatmap.paint,{"heatmap-weight":m?k:1/(v.max-v.min),"heatmap-color":S,"heatmap-radius":u?{type:"identity",property:"r"}:t.radius,"heatmap-opacity":t.opacity}),i.geojson={type:"FeatureCollection",features:g},i.heatmap.layout.visibility="visible",i}},{"../../components/color":366,"../../components/colorscale":378,"../../constants/numerical":479,"../../lib":503,"../../lib/geojson_utils":497,"fast-isnumeric":190}],765:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/colorscale/defaults"),M=d("./attributes");re.exports=function(e,a,n,r){function t(g,p){return w.coerce(e,a,M,g,p)}var f=t("lon")||[],o=t("lat")||[],i=Math.min(f.length,o.length);if(!i){a.visible=!1;return}a._length=i,t("z"),t("radius"),t("below"),t("text"),t("hovertext"),t("hovertemplate"),c(e,a,r,t,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":762}],766:[function(d,re,ne){re.exports=function(c,M){return c.lon=M.lon,c.lat=M.lat,c.z=M.z,c}},{}],767:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("../scattermapbox/hover").hoverPoints,M=d("../scattermapbox/hover").getExtraText;re.exports=function(e,a,n){var r=c(e,a,n);if(!!r){var t=r[0],f=t.cd,o=f[0].trace,i=f[t.index];if(delete t.color,"z"in i){var g=t.subplot.mockAxis;t.z=i.z,t.zLabel=w.tickText(g,g.c2l(i.z),"hover").text}return t.extraText=M(o,i,f[0].t.labels),[t]}}},{"../../plots/cartesian/axes":554,"../scattermapbox/hover":998}],768:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),formatLabels:d("../scattermapbox/format_labels"),calc:d("./calc"),plot:d("./plot"),hoverPoints:d("./hover"),eventData:d("./event_data"),getBelow:function(w,c){for(var M=c.getMapLayers(),T=0;T<M.length;T++){var e=M[T],a=e.id;if(e.type==="symbol"&&typeof a=="string"&&a.indexOf("plotly-")===-1)return a}},moduleType:"trace",name:"densitymapbox",basePlotModule:d("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":613,"../heatmap/colorbar":795,"../scattermapbox/format_labels":997,"./attributes":762,"./calc":763,"./defaults":765,"./event_data":766,"./hover":767,"./plot":769}],769:[function(d,re,ne){var w=d("./convert"),c=d("../../plots/mapbox/constants").traceLayerPrefix;function M(e,a){this.type="densitymapbox",this.subplot=e,this.uid=a,this.sourceId="source-"+a,this.layerList=[["heatmap",c+a+"-heatmap"]],this.below=null}var T=M.prototype;T.update=function(e){var a=this.subplot,n=this.layerList,r=w(e),t=a.belowLookup["trace-"+this.uid];a.map.getSource(this.sourceId).setData(r.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(r,t),this.below=t);for(var f=0;f<n.length;f++){var o=n[f],i=o[0],g=o[1],p=r[i];a.setOptions(g,"setLayoutProperty",p.layout),p.layout.visibility==="visible"&&a.setOptions(g,"setPaintProperty",p.paint)}},T._addLayers=function(e,a){for(var n=this.subplot,r=this.layerList,t=this.sourceId,f=0;f<r.length;f++){var o=r[f],i=o[0],g=e[i];n.addLayer({type:i,id:o[1],source:t,layout:g.layout,paint:g.paint},a)}},T._removeLayers=function(){for(var e=this.subplot.map,a=this.layerList,n=a.length-1;n>=0;n--)e.removeLayer(a[n][1])},T.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},re.exports=function(a,n){var r=n[0].trace,t=new M(a,r.uid),f=t.sourceId,o=w(n),i=t.below=a.belowLookup["trace-"+r.uid];return a.map.addSource(f,{type:"geojson",data:o.geojson}),t._addLayers(o,i),t}},{"../../plots/mapbox/constants":611,"./convert":764}],770:[function(d,re,ne){var w=d("../../lib");re.exports=function(M,T){for(var e=0;e<M.length;e++)M[e].i=e;w.mergeArray(T.text,M,"tx"),w.mergeArray(T.hovertext,M,"htx");var a=T.marker;if(a){w.mergeArray(a.opacity,M,"mo"),w.mergeArray(a.color,M,"mc");var n=a.line;n&&(w.mergeArray(n.color,M,"mlc"),w.mergeArrayCastPositive(n.width,M,"mlw"))}}},{"../../lib":503}],771:[function(d,re,ne){var w=d("../bar/attributes"),c=d("../scatter/attributes").line,M=d("../../plots/attributes"),T=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("./constants"),r=d("../../lib/extend").extendFlat,t=d("../../components/color");re.exports={x:w.x,x0:w.x0,dx:w.dx,y:w.y,y0:w.y0,dy:w.dy,xperiod:w.xperiod,yperiod:w.yperiod,xperiod0:w.xperiod0,yperiod0:w.yperiod0,xperiodalignment:w.xperiodalignment,yperiodalignment:w.yperiodalignment,xhoverformat:T("x"),yhoverformat:T("y"),hovertext:w.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:r({},M.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:a({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),text:w.text,textposition:w.textposition,insidetextanchor:r({},w.insidetextanchor,{dflt:"middle"}),textangle:r({},w.textangle,{dflt:0}),textfont:w.textfont,insidetextfont:w.insidetextfont,outsidetextfont:w.outsidetextfont,constraintext:w.constraintext,cliponaxis:w.cliponaxis,orientation:r({},w.orientation,{}),offset:r({},w.offset,{arrayOk:!1}),width:r({},w.width,{arrayOk:!1}),marker:f(),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:r({},c.color,{dflt:t.defaultLine}),width:r({},c.width,{dflt:0,editType:"plot"}),dash:c.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:w.offsetgroup,alignmentgroup:w.alignmentgroup};function f(){var o=r({},w.marker);return delete o.pattern,o}},{"../../components/color":366,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatter/attributes":927,"./constants":773}],772:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("../../plots/cartesian/align_period"),M=d("./arrays_to_calcdata"),T=d("../scatter/calc_selection"),e=d("../../constants/numerical").BADNUM;re.exports=function(r,t){var f=w.getFromId(r,t.xaxis||"x"),o=w.getFromId(r,t.yaxis||"y"),i,g,p,y,h,m,u,_;t.orientation==="h"?(i=f.makeCalcdata(t,"x"),p=o.makeCalcdata(t,"y"),y=c(t,o,"y",p),h=!!t.yperiodalignment,m="y"):(i=o.makeCalcdata(t,"y"),p=f.makeCalcdata(t,"x"),y=c(t,f,"x",p),h=!!t.xperiodalignment,m="x"),g=y.vals;var s=Math.min(g.length,i.length),A=new Array(s);for(t._base=[],u=0;u<s;u++){i[u]<0&&(i[u]=e);var x=!1;i[u]!==e&&u+1<s&&i[u+1]!==e&&(x=!0),_=A[u]={p:g[u],s:i[u],cNext:x},t._base[u]=-.5*_.s,h&&(A[u].orig_p=p[u],A[u][m+"End"]=y.ends[u],A[u][m+"Start"]=y.starts[u]),t.ids&&(_.id=String(t.ids[u])),u===0&&(A[0].vTotal=0),A[0].vTotal+=a(_.s),_.begR=a(_.s)/a(A[0].s)}var v;for(u=0;u<s;u++)_=A[u],_.s!==e&&(_.sumR=_.s/A[0].vTotal,_.difR=v!==void 0?_.s/v:1,v=_.s);return M(A,t),T(A,t),A};function a(n){return n===e?0:n}},{"../../constants/numerical":479,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../scatter/calc_selection":929,"./arrays_to_calcdata":770}],773:[function(d,re,ne){re.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],774:[function(d,re,ne){var w=d("../bar/cross_trace_calc").setGroupPositions;re.exports=function(M,T){var e=M._fullLayout,a=M._fullData,n=M.calcdata,r=T.xaxis,t=T.yaxis,f=[],o=[],i=[],g,p;for(p=0;p<a.length;p++){var y=a[p],h=y.orientation==="h";y.visible===!0&&y.xaxis===r._id&&y.yaxis===t._id&&y.type==="funnel"&&(g=n[p],h?i.push(g):o.push(g),f.push(g))}var m={mode:e.funnelmode,norm:e.funnelnorm,gap:e.funnelgap,groupgap:e.funnelgroupgap};for(w(M,r,t,o,m),w(M,t,r,i,m),p=0;p<f.length;p++){g=f[p];for(var u=0;u<g.length;u++)u+1<g.length&&(g[u].nextP0=g[u+1].p0,g[u].nextS0=g[u+1].s0,g[u].nextP1=g[u+1].p1,g[u].nextS1=g[u+1].s1)}}},{"../bar/cross_trace_calc":651}],775:[function(d,re,ne){var w=d("../../lib"),c=d("../bar/defaults").handleGroupingDefaults,M=d("../bar/defaults").handleText,T=d("../scatter/xy_defaults"),e=d("../scatter/period_defaults"),a=d("./attributes"),n=d("../../components/color");function r(o,i,g,p){function y(x,v){return w.coerce(o,i,a,x,v)}var h=T(o,i,p,y);if(!h){i.visible=!1;return}e(o,i,p,y),y("xhoverformat"),y("yhoverformat"),y("orientation",i.y&&!i.x?"v":"h"),y("offset"),y("width");var m=y("text");y("hovertext"),y("hovertemplate");var u=y("textposition");M(o,i,p,y,u,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),i.textposition!=="none"&&!i.texttemplate&&y("textinfo",Array.isArray(m)?"text+value":"value");var _=y("marker.color",g);y("marker.line.color",n.defaultLine),y("marker.line.width");var s=y("connector.visible");if(s){y("connector.fillcolor",t(_));var A=y("connector.line.width");A&&(y("connector.line.color"),y("connector.line.dash"))}}function t(o){var i=w.isArrayOrTypedArray(o)?"#000":o;return n.addOpacity(i,.5*n.opacity(i))}function f(o,i){var g,p;function y(m){return w.coerce(p._input,p,a,m)}if(i.funnelmode==="group")for(var h=0;h<o.length;h++)p=o[h],g=p._input,c(g,p,i,y)}re.exports={supplyDefaults:r,crossTraceDefaults:f}},{"../../components/color":366,"../../lib":503,"../bar/defaults":652,"../scatter/period_defaults":947,"../scatter/xy_defaults":954,"./attributes":771}],776:[function(d,re,ne){re.exports=function(c,M){return c.x="xVal"in M?M.xVal:M.x,c.y="yVal"in M?M.yVal:M.y,"percentInitial"in M&&(c.percentInitial=M.percentInitial),"percentPrevious"in M&&(c.percentPrevious=M.percentPrevious),"percentTotal"in M&&(c.percentTotal=M.percentTotal),M.xa&&(c.xaxis=M.xa),M.ya&&(c.yaxis=M.ya),c}},{}],777:[function(d,re,ne){var w=d("../../components/color").opacity,c=d("../bar/hover").hoverOnBars,M=d("../../lib").formatPercent;re.exports=function(a,n,r,t,f){var o=c(a,n,r,t,f);if(!!o){var i=o.cd,g=i[0].trace,p=g.orientation==="h",y=o.index,h=i[y],m=p?"x":"y";o[m+"LabelVal"]=h.s,o.percentInitial=h.begR,o.percentInitialLabel=M(h.begR,1),o.percentPrevious=h.difR,o.percentPreviousLabel=M(h.difR,1),o.percentTotal=h.sumR,o.percentTotalLabel=M(h.sumR,1);var u=h.hi||g.hoverinfo,_=[];if(u&&u!=="none"&&u!=="skip"){var s=u==="all",A=u.split("+"),x=function(v){return s||A.indexOf(v)!==-1};x("percent initial")&&_.push(o.percentInitialLabel+" of initial"),x("percent previous")&&_.push(o.percentPreviousLabel+" of previous"),x("percent total")&&_.push(o.percentTotalLabel+" of total")}return o.extraText=_.join("<br>"),o.color=T(g,h),[o]}};function T(e,a){var n=e.marker,r=a.mc||n.color,t=a.mlc||n.line.color,f=a.mlw||n.line.width;if(w(r))return r;if(w(t)&&f)return t}},{"../../components/color":366,"../../lib":503,"../bar/hover":655}],778:[function(d,re,ne){re.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc"),plot:d("./plot"),style:d("./style").style,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../bar/select":660,"./attributes":771,"./calc":772,"./cross_trace_calc":774,"./defaults":775,"./event_data":776,"./hover":777,"./layout_attributes":779,"./layout_defaults":780,"./plot":781,"./style":782}],779:[function(d,re,ne){re.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],780:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes");re.exports=function(M,T,e){var a=!1;function n(f,o){return w.coerce(M,T,c,f,o)}for(var r=0;r<e.length;r++){var t=e[r];if(t.visible&&t.type==="funnel"){a=!0;break}}a&&(n("funnelmode"),n("funnelgap",.2),n("funnelgroupgap"))}},{"../../lib":503,"./layout_attributes":779}],781:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../components/drawing"),T=d("../../constants/numerical").BADNUM,e=d("../bar/plot"),a=d("../bar/uniform_text").clearMinTextSize;re.exports=function(o,i,g,p){var y=o._fullLayout;a("funnel",y),n(o,i,g,p),r(o,i,g,p),e.plot(o,i,g,p,{mode:y.funnelmode,norm:y.funnelmode,gap:y.funnelgap,groupgap:y.funnelgroupgap})};function n(f,o,i,g){var p=o.xaxis,y=o.yaxis;c.makeTraceGroups(g,i,"trace bars").each(function(h){var m=w.select(this),u=h[0].trace,_=c.ensureSingle(m,"g","regions");if(!u.connector||!u.connector.visible){_.remove();return}var s=u.orientation==="h",A=_.selectAll("g.region").data(c.identity);A.enter().append("g").classed("region",!0),A.exit().remove();var x=A.size();A.each(function(v,b){if(!(b!==x-1&&!v.cNext)){var l=t(v,p,y,s),L=l[0],S=l[1],k="";L[0]!==T&&S[0]!==T&&L[1]!==T&&S[1]!==T&&L[2]!==T&&S[2]!==T&&L[3]!==T&&S[3]!==T&&(s?k+="M"+L[0]+","+S[1]+"L"+L[2]+","+S[2]+"H"+L[3]+"L"+L[1]+","+S[1]+"Z":k+="M"+L[1]+","+S[1]+"L"+L[2]+","+S[3]+"V"+S[2]+"L"+L[1]+","+S[0]+"Z"),k===""&&(k="M0,0Z"),c.ensureSingle(w.select(this),"path").attr("d",k).call(M.setClipUrl,o.layerClipId,f)}})})}function r(f,o,i,g){var p=o.xaxis,y=o.yaxis;c.makeTraceGroups(g,i,"trace bars").each(function(h){var m=w.select(this),u=h[0].trace,_=c.ensureSingle(m,"g","lines");if(!u.connector||!u.connector.visible||!u.connector.line.width){_.remove();return}var s=u.orientation==="h",A=_.selectAll("g.line").data(c.identity);A.enter().append("g").classed("line",!0),A.exit().remove();var x=A.size();A.each(function(v,b){if(!(b!==x-1&&!v.cNext)){var l=t(v,p,y,s),L=l[0],S=l[1],k="";L[3]!==void 0&&S[3]!==void 0&&(s?(k+="M"+L[0]+","+S[1]+"L"+L[2]+","+S[2],k+="M"+L[1]+","+S[1]+"L"+L[3]+","+S[2]):(k+="M"+L[1]+","+S[1]+"L"+L[2]+","+S[3],k+="M"+L[1]+","+S[0]+"L"+L[2]+","+S[2])),k===""&&(k="M0,0Z"),c.ensureSingle(w.select(this),"path").attr("d",k).call(M.setClipUrl,o.layerClipId,f)}})})}function t(f,o,i,g){var p=[],y=[],h=g?o:i,m=g?i:o;return p[0]=h.c2p(f.s0,!0),y[0]=m.c2p(f.p0,!0),p[1]=h.c2p(f.s1,!0),y[1]=m.c2p(f.p1,!0),p[2]=h.c2p(f.nextS0,!0),y[2]=m.c2p(f.nextP0,!0),p[3]=h.c2p(f.nextS1,!0),y[3]=m.c2p(f.nextP1,!0),g?[p,y]:[y,p]}},{"../../components/drawing":388,"../../constants/numerical":479,"../../lib":503,"../bar/plot":659,"../bar/uniform_text":664,"@plotly/d3":58}],782:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/drawing"),M=d("../../components/color"),T=d("../../constants/interactions").DESELECTDIM,e=d("../bar/style"),a=d("../bar/uniform_text").resizeText,n=e.styleTextPoints;function r(t,f,o){var i=o||w.select(t).selectAll("g.funnellayer").selectAll("g.trace");a(t,i,"funnel"),i.style("opacity",function(g){return g[0].trace.opacity}),i.each(function(g){var p=w.select(this),y=g[0].trace;p.selectAll(".point > path").each(function(h){if(!h.isBlank){var m=y.marker;w.select(this).call(M.fill,h.mc||m.color).call(M.stroke,h.mlc||m.line.color).call(c.dashLine,m.line.dash,h.mlw||m.line.width).style("opacity",y.selectedpoints&&!h.selected?T:1)}}),n(p,y,t),p.selectAll(".regions").each(function(){w.select(this).selectAll("path").style("stroke-width",0).call(M.fill,y.connector.fillcolor)}),p.selectAll(".lines").each(function(){var h=y.connector.line;c.lineGroupStyle(w.select(this).selectAll("path"),h.width,h.color,h.dash)})})}re.exports={style:r}},{"../../components/color":366,"../../components/drawing":388,"../../constants/interactions":478,"../bar/style":662,"../bar/uniform_text":664,"@plotly/d3":58}],783:[function(d,re,ne){var w=d("../pie/attributes"),c=d("../../plots/attributes"),M=d("../../plots/domain").attributes,T=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../../plots/template_attributes").texttemplateAttrs,a=d("../../lib/extend").extendFlat;re.exports={labels:w.labels,label0:w.label0,dlabel:w.dlabel,values:w.values,marker:{colors:w.marker.colors,line:{color:a({},w.marker.line.color,{dflt:null}),width:a({},w.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:w.text,hovertext:w.hovertext,scalegroup:a({},w.scalegroup,{}),textinfo:a({},w.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:a({},c.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:T({},{keys:["label","color","value","text","percent"]}),textposition:a({},w.textposition,{values:["inside","none"],dflt:"inside"}),textfont:w.textfont,insidetextfont:w.insidetextfont,title:{text:w.title.text,font:w.title.font,position:a({},w.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:M({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":901}],784:[function(d,re,ne){var w=d("../../plots/plots");ne.name="funnelarea",ne.plot=function(c,M,T,e){w.plotBasePlot(ne.name,c,M,T,e)},ne.clean=function(c,M,T,e){w.cleanBasePlot(ne.name,c,M,T,e)}},{"../../plots/plots":619}],785:[function(d,re,ne){var w=d("../pie/calc");function c(T,e){return w.calc(T,e)}function M(T){w.crossTraceCalc(T,{type:"funnelarea"})}re.exports={calc:c,crossTraceCalc:M}},{"../pie/calc":903}],786:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes"),M=d("../../plots/domain").defaults,T=d("../bar/defaults").handleText,e=d("../pie/defaults").handleLabelsAndValues;re.exports=function(n,r,t,f){function o(x,v){return w.coerce(n,r,c,x,v)}var i=o("labels"),g=o("values"),p=e(i,g),y=p.len;if(r._hasLabels=p.hasLabels,r._hasValues=p.hasValues,!r._hasLabels&&r._hasValues&&(o("label0"),o("dlabel")),!y){r.visible=!1;return}r._length=y;var h=o("marker.line.width");h&&o("marker.line.color",f.paper_bgcolor),o("marker.colors"),o("scalegroup");var m=o("text"),u=o("texttemplate"),_;if(u||(_=o("textinfo",Array.isArray(m)?"text+percent":"percent")),o("hovertext"),o("hovertemplate"),u||_&&_!=="none"){var s=o("textposition");T(n,r,f,o,s,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}M(r,f,o);var A=o("title.text");A&&(o("title.position"),w.coerceFont(o,"title.font",f.font)),o("aspectratio"),o("baseratio")}},{"../../lib":503,"../../plots/domain":584,"../bar/defaults":652,"../pie/defaults":904,"./attributes":783}],787:[function(d,re,ne){re.exports={moduleType:"trace",name:"funnelarea",basePlotModule:d("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),style:d("./style"),styleOne:d("../pie/style_one"),meta:{}}},{"../pie/style_one":912,"./attributes":783,"./base_plot":784,"./calc":785,"./defaults":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(d,re,ne){var w=d("../pie/layout_attributes").hiddenlabels;re.exports={hiddenlabels:w,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":908}],789:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes");re.exports=function(T,e){function a(n,r){return w.coerce(T,e,c,n,r)}a("hiddenlabels"),a("funnelareacolorway",e.colorway),a("extendfunnelareacolors")}},{"../../lib":503,"./layout_attributes":788}],790:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/drawing"),M=d("../../lib"),T=M.strScale,e=M.strTranslate,a=d("../../lib/svg_text_utils"),n=d("../bar/plot"),r=n.toMoveInsideBar,t=d("../bar/uniform_text"),f=t.recordMinTextSize,o=t.clearMinTextSize,i=d("../pie/helpers"),g=d("../pie/plot"),p=g.attachFxHandlers,y=g.determineInsideTextFont,h=g.layoutAreas,m=g.prerenderTitles,u=g.positionTitleOutside,_=g.formatSliceLabel;re.exports=function(b,l){var L=b._fullLayout;o("funnelarea",L),m(l,b),h(l,L._size),M.makeTraceGroups(L._funnelarealayer,l,"trace").each(function(S){var k=w.select(this),P=S[0],z=P.trace;x(S),k.each(function(){var I=w.select(this).selectAll("g.slice").data(S);I.enter().append("g").classed("slice",!0),I.exit().remove(),I.each(function(R,B){if(R.hidden){w.select(this).selectAll("path,g").remove();return}R.pointNumber=R.i,R.curveNumber=z.index;var F=P.cx,V=P.cy,G=w.select(this),J=G.selectAll("path.surface").data([R]);J.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),G.call(p,b,S);var j="M"+(F+R.TR[0])+","+(V+R.TR[1])+s(R.TR,R.BR)+s(R.BR,R.BL)+s(R.BL,R.TL)+"Z";J.attr("d",j),_(b,R,P);var Y=i.castOption(z.textposition,R.pts),X=G.selectAll("g.slicetext").data(R.text&&Y!=="none"?[0]:[]);X.enter().append("g").classed("slicetext",!0),X.exit().remove(),X.each(function(){var oe=M.ensureSingle(w.select(this),"text","",function(Z){Z.attr("data-notex",1)}),se=M.ensureUniformFontSize(b,y(z,R,L.font));oe.text(R.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(c.font,se).call(a.convertToTspans,b);var ie=c.bBox(oe.node()),N,U,q,Q=Math.min(R.BL[1],R.BR[1])+V,W=Math.max(R.TL[1],R.TR[1])+V;U=Math.max(R.TL[0],R.BL[0])+F,q=Math.min(R.TR[0],R.BR[0])+F,N=r(U,q,Q,W,ie,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"}),N.fontSize=se.size,f(z.type,N,L),S[B].transform=N,oe.attr("transform",M.getTextTransform(N))})});var D=w.select(this).selectAll("g.titletext").data(z.title.text?[0]:[]);D.enter().append("g").classed("titletext",!0),D.exit().remove(),D.each(function(){var R=M.ensureSingle(w.select(this),"text","",function(V){V.attr("data-notex",1)}),B=z.title.text;z._meta&&(B=M.templateString(B,z._meta)),R.text(B).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(c.font,z.title.font).call(a.convertToTspans,b);var F=u(P,L._size);R.attr("transform",e(F.x,F.y)+T(Math.min(1,F.scale))+e(F.tx,F.ty))})})})};function s(v,b){var l=b[0]-v[0],L=b[1]-v[1];return"l"+l+","+L}function A(v,b){return[.5*(v[0]+b[0]),.5*(v[1]+b[1])]}function x(v){if(!v.length)return;var b=v[0],l=b.trace,L=l.aspectratio,S=l.baseratio;S>.999&&(S=.999);var k=Math.pow(S,2),P=b.vTotal,z=P*k/(1-k),I=P,D=z/P;function R(){var te=Math.sqrt(D);return{x:te,y:-te}}function B(){var te=R();return[te.x,te.y]}var F,V=[];V.push(B());var G,J;for(G=v.length-1;G>-1;G--)if(J=v[G],!J.hidden){var j=J.v/I;D+=j,V.push(B())}var Y=1/0,X=-1/0;for(G=0;G<V.length;G++)F=V[G],Y=Math.min(Y,F[1]),X=Math.max(X,F[1]);for(G=0;G<V.length;G++)V[G][1]-=(X+Y)/2;var oe=V[V.length-1][0],se=b.r,ie=(X-Y)/2,N=se/oe,U=se/ie*L;for(b.r=U*ie,G=0;G<V.length;G++)V[G][0]*=N,V[G][1]*=U;F=V[0];var q=[-F[0],F[1]],Q=[F[0],F[1]],W=0;for(G=v.length-1;G>-1;G--)if(J=v[G],!J.hidden){W+=1;var Z=V[W][0],ee=V[W][1];J.TL=[-Z,ee],J.TR=[Z,ee],J.BL=q,J.BR=Q,J.pxmid=A(J.TR,J.BR),q=J.TL,Q=J.TR}}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../bar/plot":659,"../bar/uniform_text":664,"../pie/helpers":906,"../pie/plot":910,"@plotly/d3":58}],791:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../pie/style_one"),M=d("../bar/uniform_text").resizeText;re.exports=function(e){var a=e._fullLayout._funnelarealayer.selectAll(".trace");M(e,a,"funnelarea"),a.each(function(n){var r=n[0],t=r.trace,f=w.select(this);f.style({opacity:t.opacity}),f.selectAll("path.surface").each(function(o){w.select(this).call(c,o,t)})})}},{"../bar/uniform_text":664,"../pie/style_one":912,"@plotly/d3":58}],792:[function(d,re,ne){var w=d("../scatter/attributes"),c=d("../../plots/attributes"),M=d("../../plots/font_attributes"),T=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("../../components/colorscale/attributes"),r=d("../../lib/extend").extendFlat;re.exports=r({z:{valType:"data_array",editType:"calc"},x:r({},w.x,{impliedEdits:{xtype:"array"}}),x0:r({},w.x0,{impliedEdits:{xtype:"scaled"}}),dx:r({},w.dx,{impliedEdits:{xtype:"scaled"}}),y:r({},w.y,{impliedEdits:{ytype:"array"}}),y0:r({},w.y0,{impliedEdits:{ytype:"scaled"}}),dy:r({},w.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:r({},w.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:r({},w.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:r({},w.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:r({},w.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:r({},w.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:r({},w.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:T("x"),yhoverformat:T("y"),zhoverformat:T("z",1),hovertemplate:e(),texttemplate:a({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:M({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:r({},c.showlegend,{dflt:!1})},{transforms:void 0},n("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"../scatter/attributes":927}],793:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib"),M=d("../../plots/cartesian/axes"),T=d("../../plots/cartesian/align_period"),e=d("../histogram2d/calc"),a=d("../../components/colorscale/calc"),n=d("./convert_column_xyz"),r=d("./clean_2d_array"),t=d("./interp2d"),f=d("./find_empties"),o=d("./make_bound_array"),i=d("../../constants/numerical").BADNUM;re.exports=function(h,m){var u=M.getFromId(h,m.xaxis||"x"),_=M.getFromId(h,m.yaxis||"y"),s=w.traceIs(m,"contour"),A=w.traceIs(m,"histogram"),x=w.traceIs(m,"gl2d"),v=s?"best":m.zsmooth,b,l,L,S,k,P,z,I,D,R,B;if(u._minDtick=0,_._minDtick=0,A)B=e(h,m),S=B.orig_x,b=B.x,l=B.x0,L=B.dx,I=B.orig_y,k=B.y,P=B.y0,z=B.dy,D=B.z;else{var F=m.z;c.isArray1D(F)?(n(m,u,_,"x","y",["z"]),b=m._x,k=m._y,F=m._z):(S=m.x?u.makeCalcdata(m,"x"):[],I=m.y?_.makeCalcdata(m,"y"):[],b=T(m,u,"x",S).vals,k=T(m,_,"y",I).vals,m._x=b,m._y=k),l=m.x0,L=m.dx,P=m.y0,z=m.dy,D=r(F,m,u,_)}(u.rangebreaks||_.rangebreaks)&&(D=p(b,k,D),A||(b=g(b),k=g(k),m._x=b,m._y=k)),!A&&(s||m.connectgaps)&&(m._emptypoints=f(D),t(D,m._emptypoints));function V(Q){v=m._input.zsmooth=m.zsmooth=!1,c.warn('cannot use zsmooth: "fast": '+Q)}if(v==="fast"){if(u.type==="log"||_.type==="log")V("log axis found");else if(!A){if(b.length){var G=(b[b.length-1]-b[0])/(b.length-1),J=Math.abs(G/100);for(R=0;R<b.length-1;R++)if(Math.abs(b[R+1]-b[R]-G)>J){V("x scale is not linear");break}}if(k.length&&v==="fast"){var j=(k[k.length-1]-k[0])/(k.length-1),Y=Math.abs(j/100);for(R=0;R<k.length-1;R++)if(Math.abs(k[R+1]-k[R]-j)>Y){V("y scale is not linear");break}}}}var X=c.maxRowLength(D),oe=m.xtype==="scaled"?"":b,se=o(m,oe,l,L,X,u),ie=m.ytype==="scaled"?"":k,N=o(m,ie,P,z,D.length,_);x||(m._extremes[u._id]=M.findExtremes(u,se),m._extremes[_._id]=M.findExtremes(_,N));var U={x:se,y:N,z:D,text:m._text||m.text,hovertext:m._hovertext||m.hovertext};if(m.xperiodalignment&&S&&(U.orig_x=S),m.yperiodalignment&&I&&(U.orig_y=I),oe&&oe.length===se.length-1&&(U.xCenter=oe),ie&&ie.length===N.length-1&&(U.yCenter=ie),A&&(U.xRanges=B.xRanges,U.yRanges=B.yRanges,U.pts=B.pts),s||a(h,m,{vals:D,cLetter:"z"}),s&&m.contours&&m.contours.coloring==="heatmap"){var q={type:m.type==="contour"?"heatmap":"histogram2d",xcalendar:m.xcalendar,ycalendar:m.ycalendar};U.xfill=o(q,oe,l,L,X,u),U.yfill=o(q,ie,P,z,D.length,_)}return[U]};function g(y){for(var h=[],m=y.length,u=0;u<m;u++){var _=y[u];_!==i&&h.push(_)}return h}function p(y,h,m){for(var u=[],_=-1,s=0;s<m.length;s++)if(h[s]!==i){_++,u[_]=[];for(var A=0;A<m[s].length;A++)y[A]!==i&&u[_].push(m[s][A])}return u}},{"../../components/colorscale/calc":374,"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../../registry":638,"../histogram2d/calc":826,"./clean_2d_array":794,"./convert_column_xyz":796,"./find_empties":798,"./interp2d":801,"./make_bound_array":803}],794:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("../../constants/numerical").BADNUM;re.exports=function(e,a,n,r){var t,f,o,i,g,p;function y(A){if(!!w(A))return+A}if(a&&a.transpose){for(t=0,g=0;g<e.length;g++)t=Math.max(t,e[g].length);if(t===0)return!1;o=function(A){return A.length},i=function(A,x,v){return(A[v]||[])[x]}}else t=e.length,o=function(A,x){return A[x].length},i=function(A,x,v){return(A[x]||[])[v]};var h=function(A,x,v){return x===M||v===M?M:i(A,x,v)};function m(A){if(a&&a.type!=="carpet"&&a.type!=="contourcarpet"&&A&&A.type==="category"&&a["_"+A._id.charAt(0)].length){var x=A._id.charAt(0),v={},b=a["_"+x+"CategoryMap"]||a[x];for(g=0;g<b.length;g++)v[b[g]]=g;return function(l){var L=v[A._categories[l]];return L+1?L:M}}else return c.identity}var u=m(n),_=m(r);r&&r.type==="category"&&(t=r._categories.length);var s=new Array(t);for(g=0;g<t;g++)for(n&&n.type==="category"?f=n._categories.length:f=o(e,g),s[g]=new Array(f),p=0;p<f;p++)s[g][p]=y(h(e,_(g),u(p)));return s}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],795:[function(d,re,ne){re.exports={min:"zmin",max:"zmax"}},{}],796:[function(d,re,ne){var w=d("../../lib"),c=d("../../constants/numerical").BADNUM,M=d("../../plots/cartesian/align_period");re.exports=function(e,a,n,r,t,f){var o=e._length,i=a.makeCalcdata(e,r),g=n.makeCalcdata(e,t);i=M(e,a,r,i).vals,g=M(e,n,t,g).vals;var p=e.text,y=p!==void 0&&w.isArray1D(p),h=e.hovertext,m=h!==void 0&&w.isArray1D(h),u,_,s=w.distinctVals(i),A=s.vals,x=w.distinctVals(g),v=x.vals,b=[],l,L,S=v.length,k=A.length;for(u=0;u<f.length;u++)b[u]=w.init2dArray(S,k);y&&(l=w.init2dArray(S,k)),m&&(L=w.init2dArray(S,k));var P=w.init2dArray(S,k);for(u=0;u<o;u++)if(i[u]!==c&&g[u]!==c){var z=w.findBin(i[u]+s.minDiff/2,A),I=w.findBin(g[u]+x.minDiff/2,v);for(_=0;_<f.length;_++){var D=f[_],R=e[D],B=b[_];B[I][z]=R[u],P[I][z]=u}y&&(l[I][z]=p[u]),m&&(L[I][z]=h[u])}for(e["_"+r]=A,e["_"+t]=v,_=0;_<f.length;_++)e["_"+f[_]]=b[_];y&&(e._text=l),m&&(e._hovertext=L),a&&a.type==="category"&&(e["_"+r+"CategoryMap"]=A.map(function(F){return a._categories[F]})),n&&n.type==="category"&&(e["_"+t+"CategoryMap"]=v.map(function(F){return n._categories[F]})),e._after2before=P}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551}],797:[function(d,re,ne){var w=d("../../lib"),c=d("./xyz_defaults"),M=d("./label_defaults"),T=d("../scatter/period_defaults"),e=d("./style_defaults"),a=d("../../components/colorscale/defaults"),n=d("./attributes");re.exports=function(t,f,o,i){function g(y,h){return w.coerce(t,f,n,y,h)}var p=c(t,f,g,i);if(!p){f.visible=!1;return}T(t,f,i,g),g("xhoverformat"),g("yhoverformat"),g("text"),g("hovertext"),g("hovertemplate"),M(g,i),e(t,f,g,i),g("hoverongaps"),g("connectgaps",w.isArray1D(f.z)&&f.zsmooth!==!1),a(t,f,i,g,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":376,"../../lib":503,"../scatter/period_defaults":947,"./attributes":792,"./label_defaults":802,"./style_defaults":806,"./xyz_defaults":807}],798:[function(d,re,ne){var w=d("../../lib").maxRowLength;re.exports=function(M){var T=[],e={},a=[],n=M[0],r=[],t=[0,0,0],f=w(M),o,i,g,p,y,h,m,u;for(i=0;i<M.length;i++)for(o=r,r=n,n=M[i+1]||[],g=0;g<f;g++)r[g]===void 0&&(h=(r[g-1]!==void 0?1:0)+(r[g+1]!==void 0?1:0)+(o[g]!==void 0?1:0)+(n[g]!==void 0?1:0),h?(i===0&&h++,g===0&&h++,i===M.length-1&&h++,g===r.length-1&&h++,h<4&&(e[[i,g]]=[i,g,h]),T.push([i,g,h])):a.push([i,g]));for(;a.length;){for(m={},u=!1,y=a.length-1;y>=0;y--)p=a[y],i=p[0],g=p[1],h=((e[[i-1,g]]||t)[2]+(e[[i+1,g]]||t)[2]+(e[[i,g-1]]||t)[2]+(e[[i,g+1]]||t)[2])/20,h&&(m[p]=[i,g,h],a.splice(y,1),u=!0);if(!u)throw"findEmpties iterated with no new neighbors";for(p in m)e[p]=m[p],T.push(m[p])}return T.sort(function(_,s){return s[2]-_[2]})}},{"../../lib":503}],799:[function(d,re,ne){var w=d("../../components/fx"),c=d("../../lib"),M=d("../../plots/cartesian/axes"),T=d("../../components/colorscale").extractOpts;re.exports=function(a,n,r,t,f){f||(f={});var o=f.isContour,i=a.cd[0],g=i.trace,p=a.xa,y=a.ya,h=i.x,m=i.y,u=i.z,_=i.xCenter,s=i.yCenter,A=i.zmask,x=g.zhoverformat,v=h,b=m,l,L,S,k;if(a.index!==!1){try{S=Math.round(a.index[1]),k=Math.round(a.index[0])}catch{c.error("Error hovering on heatmap, pointNumber must be [row,col], found:",a.index);return}if(S<0||S>=u[0].length||k<0||k>u.length)return}else{if(w.inbox(n-h[0],n-h[h.length-1],0)>0||w.inbox(r-m[0],r-m[m.length-1],0)>0)return;if(o){var P;for(v=[2*h[0]-h[1]],P=1;P<h.length;P++)v.push((h[P]+h[P-1])/2);for(v.push([2*h[h.length-1]-h[h.length-2]]),b=[2*m[0]-m[1]],P=1;P<m.length;P++)b.push((m[P]+m[P-1])/2);b.push([2*m[m.length-1]-m[m.length-2]])}S=Math.max(0,Math.min(v.length-2,c.findBin(n,v))),k=Math.max(0,Math.min(b.length-2,c.findBin(r,b)))}var z=p.c2p(h[S]),I=p.c2p(h[S+1]),D=y.c2p(m[k]),R=y.c2p(m[k+1]),B,F;o?(B=i.orig_x||h,F=i.orig_y||m,I=z,l=B[S],R=D,L=F[k]):(B=i.orig_x||_||h,F=i.orig_y||s||m,l=_?B[S]:(B[S]+B[S+1])/2,L=s?F[k]:(F[k]+F[k+1])/2,p&&p.type==="category"&&(l=h[S]),y&&y.type==="category"&&(L=m[k]),g.zsmooth&&(z=I=p.c2p(l),D=R=y.c2p(L)));var V=u[k][S];if(A&&!A[k][S]&&(V=void 0),!(V===void 0&&!g.hoverongaps)){var G;Array.isArray(i.hovertext)&&Array.isArray(i.hovertext[k])?G=i.hovertext[k][S]:Array.isArray(i.text)&&Array.isArray(i.text[k])&&(G=i.text[k][S]);var J=T(g),j={type:"linear",range:[J.min,J.max],hoverformat:x,_separators:p._separators,_numFormat:p._numFormat},Y=M.tickText(j,V,"hover").text;return[c.extendFlat(a,{index:g._after2before?g._after2before[k][S]:[k,S],distance:a.maxHoverDistance,spikeDistance:a.maxSpikeDistance,x0:z,x1:I,y0:D,y1:R,xLabelVal:l,yLabelVal:L,zLabelVal:V,zLabel:Y,text:G})]}}},{"../../components/colorscale":378,"../../components/fx":406,"../../lib":503,"../../plots/cartesian/axes":554}],800:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),colorbar:d("./colorbar"),style:d("./style"),hoverPoints:d("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":568,"./attributes":792,"./calc":793,"./colorbar":795,"./defaults":797,"./hover":799,"./plot":804,"./style":805}],801:[function(d,re,ne){var w=d("../../lib"),c=.01,M=[[-1,0],[1,0],[0,-1],[0,1]];function T(a){return .5-.25*Math.min(1,a*.5)}re.exports=function(n,r){var t=1,f;for(e(n,r),f=0;f<r.length&&!(r[f][2]<4);f++);for(r=r.slice(f),f=0;f<100&&t>c;f++)t=e(n,r,T(t));return t>c&&w.log("interp2d didn't converge quickly",t),n};function e(a,n,r){var t=0,f,o,i,g,p,y,h,m,u,_,s,A,x;for(g=0;g<n.length;g++){for(f=n[g],o=f[0],i=f[1],s=a[o][i],_=0,u=0,p=0;p<4;p++)y=M[p],h=a[o+y[0]],h&&(m=h[i+y[1]],m!==void 0&&(_===0?A=x=m:(A=Math.min(A,m),x=Math.max(x,m)),u++,_+=m));if(u===0)throw"iterateInterp2d order is wrong: no defined neighbors";a[o][i]=_/u,s===void 0?u<4&&(t=1):(a[o][i]=(1+r)*a[o][i]-r*s,x>A&&(t=Math.max(t,Math.abs(a[o][i]-s)/(x-A))))}return t}},{"../../lib":503}],802:[function(d,re,ne){var w=d("../../lib");re.exports=function(M,T){M("texttemplate");var e=w.extendFlat({},T.font,{color:"auto",size:"auto"});w.coerceFont(M,"textfont",e)}},{"../../lib":503}],803:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib").isArrayOrTypedArray;re.exports=function(T,e,a,n,r,t){var f=[],o=w.traceIs(T,"contour"),i=w.traceIs(T,"histogram"),g=w.traceIs(T,"gl2d"),p,y,h,m=c(e)&&e.length>1;if(m&&!i&&t.type!=="category"){var u=e.length;if(u<=r){if(o||g)f=e.slice(0,r);else if(r===1)f=[e[0]-.5,e[0]+.5];else{for(f=[1.5*e[0]-.5*e[1]],h=1;h<u;h++)f.push((e[h-1]+e[h])*.5);f.push(1.5*e[u-1]-.5*e[u-2])}if(u<r){var _=f[f.length-1],s=_-f[f.length-2];for(h=u;h<r;h++)_+=s,f.push(_)}}else return o?e.slice(0,r):e.slice(0,r+1)}else{var A=T[t._id.charAt(0)+"calendar"];if(i)p=t.r2c(a,0,A);else if(c(e)&&e.length===1)p=e[0];else if(a===void 0)p=0;else{var x=t.type==="log"?t.d2c:t.r2c;p=x(a,0,A)}for(y=n||1,h=o||g?0:-.5;h<r;h++)f.push(p+y*h)}return f}},{"../../lib":503,"../../registry":638}],804:[function(d,re,ne){var w=d("@plotly/d3"),c=d("tinycolor2"),M=d("../../registry"),T=d("../../components/drawing"),e=d("../../plots/cartesian/axes"),a=d("../../lib"),n=d("../../lib/svg_text_utils"),r=d("../scatter/format_labels"),t=d("../../components/color"),f=d("../../components/colorscale").extractOpts,o=d("../../components/colorscale").makeColorScaleFuncFromTrace,i=d("../../constants/xmlns_namespaces"),g=d("../../constants/alignment"),p=g.LINE_SPACING,y="heatmap-label";function h(A){return A.selectAll("g."+y)}function m(A){h(A).remove()}re.exports=function(A,x,v,b){var l=x.xaxis,L=x.yaxis;a.makeTraceGroups(b,v,"hm").each(function(S){var k=w.select(this),P=S[0],z=P.trace,I=z.xgap||0,D=z.ygap||0,R=P.z,B=P.x,F=P.y,V=P.xCenter,G=P.yCenter,J=M.traceIs(z,"contour"),j=J?"best":z.zsmooth,Y=R.length,X=a.maxRowLength(R),oe=!1,se=!1,ie,N,U,q,Q,W,Z,ee;for(W=0;ie===void 0&&W<B.length-1;)ie=l.c2p(B[W]),W++;for(W=B.length-1;N===void 0&&W>0;)N=l.c2p(B[W]),W--;for(N<ie&&(U=N,N=ie,ie=U,oe=!0),W=0;q===void 0&&W<F.length-1;)q=L.c2p(F[W]),W++;for(W=F.length-1;Q===void 0&&W>0;)Q=L.c2p(F[W]),W--;if(Q<q&&(U=q,q=Q,Q=U,se=!0),J&&(V=B,G=F,B=P.xfill,F=P.yfill),j!=="fast"){var te=j==="best"?0:.5;ie=Math.max(-te*l._length,ie),N=Math.min((1+te)*l._length,N),q=Math.max(-te*L._length,q),Q=Math.min((1+te)*L._length,Q)}var ae=Math.round(N-ie),le=Math.round(Q-q),ye=ae<=0||le<=0;if(ye){var fe=k.selectAll("image").data([]);fe.exit().remove(),m(k);return}var pe,ge;j==="fast"?(pe=X,ge=Y):(pe=ae,ge=le);var Ae=document.createElement("canvas");Ae.width=pe,Ae.height=ge;var we=Ae.getContext("2d"),De=o(z,{noNumericCheck:!0,returnArray:!0}),Be,Ve;j==="fast"?(Be=oe?function(Pr){return X-1-Pr}:a.identity,Ve=se?function(Pr){return Y-1-Pr}:a.identity):(Be=function(Pr){return a.constrain(Math.round(l.c2p(B[Pr])-ie),0,ae)},Ve=function(Pr){return a.constrain(Math.round(L.c2p(F[Pr])-q),0,le)});var xe=Ve(0),Le=[xe,xe],He=oe?0:1,Je=se?0:1,Oe=0,Pe=0,Ue=0,vt=0,Lt,Yt,At,Rt,Bt;function Mt(Pr,Tr){if(Pr!==void 0){var jr=De(Pr);return jr[0]=Math.round(jr[0]),jr[1]=Math.round(jr[1]),jr[2]=Math.round(jr[2]),Oe+=Tr,Pe+=jr[0]*Tr,Ue+=jr[1]*Tr,vt+=jr[2]*Tr,jr}return[0,0,0,0]}function Tt(Pr,Tr,jr,Pn){var An=Pr[jr.bin0];if(An===void 0)return Mt(void 0,1);var $n=Pr[jr.bin1],zn=Tr[jr.bin0],Yn=Tr[jr.bin1],Kn=$n-An||0,Aa=zn-An||0,Ua;return $n===void 0?Yn===void 0?Ua=0:zn===void 0?Ua=2*(Yn-An):Ua=(2*Yn-zn-An)*2/3:Yn===void 0?zn===void 0?Ua=0:Ua=(2*An-$n-zn)*2/3:zn===void 0?Ua=(2*Yn-$n-An)*2/3:Ua=Yn+An-$n-zn,Mt(An+jr.frac*Kn+Pn.frac*(Aa+jr.frac*Ua))}if(j){var at=0,ct;try{ct=new Uint8Array(ae*le*4)}catch{ct=new Array(ae*le*4)}if(j==="best"){var je=V||B,ke=G||F,Ye=new Array(je.length),Ke=new Array(ke.length),st=new Array(ae),Et=V?_:u,bt=G?_:u,zt,$t,Ot;for(W=0;W<je.length;W++)Ye[W]=Math.round(l.c2p(je[W])-ie);for(W=0;W<ke.length;W++)Ke[W]=Math.round(L.c2p(ke[W])-q);for(W=0;W<ae;W++)st[W]=Et(W,Ye);for(Z=0;Z<le;Z++)for(zt=bt(Z,Ke),$t=R[zt.bin0],Ot=R[zt.bin1],W=0;W<ae;W++,at+=4)Bt=Tt($t,Ot,st[W],zt),s(ct,at,Bt)}else for(Z=0;Z<Y;Z++)for(Rt=R[Z],Le=Ve(Z),W=0;W<ae;W++)Bt=Mt(Rt[W],1),at=(Le*ae+Be(W))*4,s(ct,at,Bt);var Qt=we.createImageData(ae,le);try{Qt.data.set(ct)}catch{var tr=Qt.data,qt=tr.length;for(Z=0;Z<qt;Z++)tr[Z]=ct[Z]}we.putImageData(Qt,0,0)}else{var lr=Math.floor(I/2),Wr=Math.floor(D/2);for(Z=0;Z<Y;Z++)if(Rt=R[Z],Le.reverse(),Le[Je]=Ve(Z+1),!(Le[0]===Le[1]||Le[0]===void 0||Le[1]===void 0))for(Yt=Be(0),Lt=[Yt,Yt],W=0;W<X;W++)Lt.reverse(),Lt[He]=Be(W+1),!(Lt[0]===Lt[1]||Lt[0]===void 0||Lt[1]===void 0)&&(At=Rt[W],Bt=Mt(At,(Lt[1]-Lt[0])*(Le[1]-Le[0])),we.fillStyle="rgba("+Bt.join(",")+")",we.fillRect(Lt[0]+lr,Le[0]+Wr,Lt[1]-Lt[0]-I,Le[1]-Le[0]-D))}Pe=Math.round(Pe/Oe),Ue=Math.round(Ue/Oe),vt=Math.round(vt/Oe);var cn=c("rgb("+Pe+","+Ue+","+vt+")");A._hmpixcount=(A._hmpixcount||0)+Oe,A._hmlumcount=(A._hmlumcount||0)+Oe*cn.getLuminance();var Jr=k.selectAll("image").data(S);Jr.enter().append("svg:image").attr({xmlns:i.svg,preserveAspectRatio:"none"}),Jr.attr({height:le,width:ae,x:ie,y:q,"xlink:href":Ae.toDataURL("image/png")}),m(k);var ot=z.texttemplate;if(ot){var Vt=f(z),jt={type:"linear",range:[Vt.min,Vt.max],_separators:l._separators,_numFormat:l._numFormat},Ut=z.type==="histogram2dcontour",yr=z.type==="contour",nt=yr?1:0,_e=yr?Y-1:Y,Me=yr?1:0,Ne=yr?X-1:X,We=[];for(W=nt;W<_e;W++){var Qe;if(yr)Qe=P.y[W];else if(Ut){if(W===0||W===Y-1)continue;Qe=P.y[W]}else if(P.yCenter)Qe=P.yCenter[W];else{if(W+1===Y&&P.y[W+1]===void 0)continue;Qe=(P.y[W]+P.y[W+1])/2}var rt=Math.round(L.c2p(Qe));if(!(0>rt||rt>L._length))for(Z=Me;Z<Ne;Z++){var $e;if(yr)$e=P.x[Z];else if(Ut){if(Z===0||Z===X-1)continue;$e=P.x[Z]}else if(P.xCenter)$e=P.xCenter[Z];else{if(Z+1===X&&P.x[Z+1]===void 0)continue;$e=(P.x[Z]+P.x[Z+1])/2}var ht=Math.round(l.c2p($e));if(!(0>ht||ht>l._length)){var xt=r({x:$e,y:Qe},z,A._fullLayout);xt.x=$e,xt.y=Qe;var kt=P.z[W][Z];kt===void 0?(xt.z="",xt.zLabel=""):(xt.z=kt,xt.zLabel=e.tickText(jt,kt,"hover").text);var Wt=P.text&&P.text[W]&&P.text[W][Z];(Wt===void 0||Wt===!1)&&(Wt=""),xt.text=Wt;var Ft=a.texttemplateString(ot,xt,A._fullLayout._d3locale,xt,z._meta||{});if(!!Ft){var ir=Ft.split("<br>"),hr=ir.length,_r=0;for(ee=0;ee<hr;ee++)_r=Math.max(_r,ir[ee].length);We.push({l:hr,c:_r,t:Ft,x:ht,y:rt,z:kt})}}}}var an=z.textfont,Rr=an.family,Vr=an.size,fn=A._fullLayout.font.size;if(!Vr||Vr==="auto"){var xr=1/0,mr=1/0,Fr=0,Ir=0;for(ee=0;ee<We.length;ee++){var Sr=We[ee];if(Fr=Math.max(Fr,Sr.l),Ir=Math.max(Ir,Sr.c),ee<We.length-1){var tt=We[ee+1],Ct=Math.abs(tt.x-Sr.x),Zt=Math.abs(tt.y-Sr.y);Ct&&(xr=Math.min(xr,Ct)),Zt&&(mr=Math.min(mr,Zt))}}!isFinite(xr)||!isFinite(mr)?Vr=fn:(xr-=I,mr-=D,xr/=Ir,mr/=Fr,xr/=p/2,mr/=p,Vr=Math.min(Math.floor(xr),Math.floor(mr),fn))}if(Vr<=0||!isFinite(Vr))return;var ur=function(Pr){return Pr.x},Lr=function(Pr){return Pr.y-Vr*(Pr.l*p/2-1)},Br=h(k).data(We);Br.enter().append("g").classed(y,1).append("text").attr("text-anchor","middle").each(function(Pr){var Tr=w.select(this),jr=an.color;(!jr||jr==="auto")&&(jr=t.contrast("rgba("+De(Pr.z).join()+")")),Tr.attr("data-notex",1).call(n.positionText,ur(Pr),Lr(Pr)).call(T.font,Rr,Vr,jr).text(Pr.t).call(n.convertToTspans,A)})}})};function u(A,x){var v=x.length-2,b=a.constrain(a.findBin(A,x),0,v),l=x[b],L=x[b+1],S=a.constrain(b+(A-l)/(L-l)-.5,0,v),k=Math.round(S),P=Math.abs(S-k);return!S||S===v||!P?{bin0:k,bin1:k,frac:0}:{bin0:k,frac:P,bin1:Math.round(k+P/(S-k))}}function _(A,x){var v=x.length-1,b=a.constrain(a.findBin(A,x),0,v),l=x[b],L=x[b+1],S=(A-l)/(L-l)||0;return S<=0?{bin0:b,bin1:b,frac:0}:S<.5?{bin0:b,bin1:b+1,frac:S}:{bin0:b+1,bin1:b,frac:1-S}}function s(A,x,v){A[x]=v[0],A[x+1]=v[1],A[x+2]=v[2],A[x+3]=Math.round(v[3]*255)}},{"../../components/color":366,"../../components/colorscale":378,"../../components/drawing":388,"../../constants/alignment":471,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../registry":638,"../scatter/format_labels":936,"@plotly/d3":58,tinycolor2:312}],805:[function(d,re,ne){var w=d("@plotly/d3");re.exports=function(M){w.select(M).selectAll(".hm image").style("opacity",function(T){return T.trace.opacity})}},{"@plotly/d3":58}],806:[function(d,re,ne){re.exports=function(c,M,T){var e=T("zsmooth");e===!1&&(T("xgap"),T("ygap")),T("zhoverformat")}},{}],807:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("../../registry");re.exports=function(n,r,t,f,o,i){var g=t("z");o=o||"x",i=i||"y";var p,y;if(g===void 0||!g.length)return 0;if(c.isArray1D(n.z)){p=t(o),y=t(i);var h=c.minRowLength(p),m=c.minRowLength(y);if(h===0||m===0)return 0;r._length=Math.min(h,m,g.length)}else{if(p=T(o,t),y=T(i,t),!e(g))return 0;t("transpose"),r._length=null}if(n.type==="heatmapgl")return!0;var u=M.getComponentMethod("calendars","handleTraceDefaults");return u(n,r,[o,i],f),!0};function T(a,n){var r=n(a),t=r?n(a+"type","array"):"scaled";return t==="scaled"&&(n(a+"0"),n("d"+a)),r}function e(a){for(var n=!0,r=!1,t=!1,f,o=0;o<a.length;o++){if(f=a[o],!c.isArrayOrTypedArray(f)){n=!1;break}f.length>0&&(r=!0);for(var i=0;i<f.length;i++)if(w(f[i])){t=!0;break}}return n&&r&&t}},{"../../lib":503,"../../registry":638,"fast-isnumeric":190}],808:[function(d,re,ne){for(var w=d("../heatmap/attributes"),c=d("../../components/colorscale/attributes"),M=d("../../lib/extend").extendFlat,T=d("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],a={},n=0;n<e.length;n++){var r=e[n];a[r]=w[r]}a.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},M(a,c("",{cLetter:"z",autoColorDflt:!1})),re.exports=T(a,"calc","nested")},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../heatmap/attributes":792}],809:[function(d,re,ne){var w=d("../../../stackgl_modules").gl_heatmap2d,c=d("../../plots/cartesian/axes"),M=d("../../lib/str2rgbarray");function T(r,t){this.scene=r,this.uid=t,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=w(r.glplot,this.options),this.heatmap._trace=this}var e=T.prototype;e.handlePick=function(r){var t=this.options,f=t.shape,o=r.pointId,i=o%f[0],g=Math.floor(o/f[0]),p=o;return{trace:this,dataCoord:r.dataCoord,traceCoord:[t.x[i],t.y[g],t.z[p]],textLabel:this.textLabels[o],name:this.name,pointIndex:[g,i],hoverinfo:this.hoverinfo}},e.update=function(r,t){var f=t[0];this.index=r.index,this.name=r.name,this.hoverinfo=r.hoverinfo;var o=f.z;this.options.z=[].concat.apply([],o);var i=o[0].length,g=o.length;this.options.shape=[i,g],this.options.x=f.x,this.options.y=f.y,this.options.zsmooth=r.zsmooth;var p=a(r);this.options.colorLevels=p.colorLevels,this.options.colorValues=p.colorValues,this.textLabels=[].concat.apply([],r.text),this.heatmap.update(this.options);var y=this.scene.xaxis,h=this.scene.yaxis,m,u;r.zsmooth===!1&&(m={ppad:f.x[1]-f.x[0]},u={ppad:f.y[1]-f.y[0]}),r._extremes[y._id]=c.findExtremes(y,f.x,m),r._extremes[h._id]=c.findExtremes(h,f.y,u)},e.dispose=function(){this.heatmap.dispose()};function a(r){for(var t=r.colorscale,f=r.zmin,o=r.zmax,i=t.length,g=new Array(i),p=new Array(4*i),y=0;y<i;y++){var h=t[y],m=M(h[1]);g[y]=f+h[0]*(o-f);for(var u=0;u<4;u++)p[4*y+u]=m[u]}return{colorLevels:g,colorValues:p}}function n(r,t,f){var o=new T(r,t.uid);return o.update(t,f),o}re.exports=n},{"../../../stackgl_modules":1124,"../../lib/str2rgbarray":528,"../../plots/cartesian/axes":554}],810:[function(d,re,ne){var w=d("../../lib"),c=d("../heatmap/xyz_defaults"),M=d("../../components/colorscale/defaults"),T=d("./attributes");re.exports=function(a,n,r,t){function f(i,g){return w.coerce(a,n,T,i,g)}var o=c(a,n,f,t);if(!o){n.visible=!1;return}f("text"),f("zsmooth"),M(a,n,t,f,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":376,"../../lib":503,"../heatmap/xyz_defaults":807,"./attributes":808}],811:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../heatmap/colorbar"),calc:d("../heatmap/calc"),plot:d("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:d("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":596,"../heatmap/calc":793,"../heatmap/colorbar":795,"./attributes":808,"./convert":809,"./defaults":810}],812:[function(d,re,ne){var w=d("../bar/attributes"),c=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,T=d("../../plots/template_attributes").texttemplateAttrs,e=d("../../plots/font_attributes"),a=d("./bin_attributes"),n=d("./constants"),r=d("../../lib/extend").extendFlat;re.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:c("x"),yhoverformat:c("y"),text:r({},w.text,{}),hovertext:r({},w.hovertext,{}),orientation:w.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:a("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:a("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:M({},{keys:n.eventDataKeys}),texttemplate:T({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:r({},w.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:w.insidetextanchor,textangle:w.textangle,cliponaxis:w.cliponaxis,constraintext:w.constraintext,marker:w.marker,offsetgroup:w.offsetgroup,alignmentgroup:w.alignmentgroup,selected:w.selected,unselected:w.unselected,_deprecated:{bardir:w._deprecated.bardir}}},{"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"../bar/attributes":648,"./bin_attributes":814,"./constants":818}],813:[function(d,re,ne){re.exports=function(c,M){for(var T=c.length,e=0,a=0;a<T;a++)M[a]?(c[a]/=M[a],e+=c[a]):c[a]=null;return e}},{}],814:[function(d,re,ne){re.exports=function(c,M){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],815:[function(d,re,ne){var w=d("fast-isnumeric");re.exports={count:function(c,M,T){return T[c]++,1},sum:function(c,M,T,e){var a=e[M];return w(a)?(a=Number(a),T[c]+=a,a):0},avg:function(c,M,T,e,a){var n=e[M];return w(n)&&(n=Number(n),T[c]+=n,a[c]++),0},min:function(c,M,T,e){var a=e[M];if(w(a))if(a=Number(a),w(T[c])){if(T[c]>a){var n=a-T[c];return T[c]=a,n}}else return T[c]=a,a;return 0},max:function(c,M,T,e){var a=e[M];if(w(a))if(a=Number(a),w(T[c])){if(T[c]<a){var n=a-T[c];return T[c]=a,n}}else return T[c]=a,a;return 0}}},{"fast-isnumeric":190}],816:[function(d,re,ne){var w=d("../../constants/numerical"),c=w.ONEAVGYEAR,M=w.ONEAVGMONTH,T=w.ONEDAY,e=w.ONEHOUR,a=w.ONEMIN,n=w.ONESEC,r=d("../../plots/cartesian/axes").tickIncrement;re.exports=function(p,y,h,m,u){var _=-1.1*y,s=-.1*y,A=p-s,x=h[0],v=h[1],b=Math.min(t(x+s,x+A,m,u),t(v+s,v+A,m,u)),l=Math.min(t(x+_,x+s,m,u),t(v+_,v+s,m,u)),L,S;if(b>l&&l<Math.abs(v-x)/4e3?(L=b,S=!1):(L=Math.min(b,l),S=!0),m.type==="date"&&L>T){var k=L===c?1:6,P=L===c?"M12":"M1";return function(z,I){var D=m.c2d(z,c,u),R=D.indexOf("-",k);R>0&&(D=D.substr(0,R));var B=m.d2c(D,0,u);if(B<z){var F=r(B,P,!1,u);(B+F)/2<z+p&&(B=F)}return I&&S?r(B,P,!0,u):B}}return function(z,I){var D=L*Math.round(z/L);return D+L/10<z&&D+L*.9<z+p&&(D+=L),I&&S&&(D-=L),D}};function t(g,p,y,h){if(g*p<=0)return 1/0;for(var m=Math.abs(p-g),u=y.type==="date",_=f(m,u),s=0;s<10;s++){var A=f(_*80,u);if(_===A)break;if(o(A,g,p,u,y,h))_=A;else break}return _}function f(g,p){return p&&g>n?g>T?g>c*1.1?c:g>M*1.1?M:T:g>e?e:g>a?a:n:Math.pow(10,Math.floor(Math.log(g)/Math.LN10))}function o(g,p,y,h,m,u){if(h&&g>T){var _=i(p,m,u),s=i(y,m,u),A=g===c?0:1;return _[A]!==s[A]}return Math.floor(y/g)-Math.floor(p/g)>.1}function i(g,p,y){var h=p.c2d(g,c,y).split("-");return h[0]===""&&(h.unshift(),h[0]="-"+h[0]),h}},{"../../constants/numerical":479,"../../plots/cartesian/axes":554}],817:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("../../registry"),T=d("../../plots/cartesian/axes"),e=d("../bar/arrays_to_calcdata"),a=d("./bin_functions"),n=d("./norm_functions"),r=d("./average"),t=d("./bin_label_vals");function f(y,h){var m=[],u=[],_=h.orientation==="h",s=T.getFromId(y,_?h.yaxis:h.xaxis),A=_?"y":"x",x={x:"y",y:"x"}[A],v=h[A+"calendar"],b=h.cumulative,l,L=o(y,h,s,A),S=L[0],k=L[1],P=typeof S.size=="string",z=[],I=P?z:S,D=[],R=[],B=[],F=0,V=h.histnorm,G=h.histfunc,J=V.indexOf("density")!==-1,j,Y,X;b.enabled&&J&&(V=V.replace(/ ?density$/,""),J=!1);var oe=G==="max"||G==="min",se=oe?null:0,ie=a.count,N=n[V],U=!1,q=function(Ve){return s.r2c(Ve,0,v)},Q;for(c.isArrayOrTypedArray(h[x])&&G!=="count"&&(Q=h[x],U=G==="avg",ie=a[G]),l=q(S.start),Y=q(S.end)+(l-T.tickIncrement(l,S.size,!1,v))/1e6;l<Y&&m.length<1e6&&(j=T.tickIncrement(l,S.size,!1,v),m.push((l+j)/2),u.push(se),B.push([]),z.push(l),J&&D.push(1/(j-l)),U&&R.push(0),!(j<=l));)l=j;z.push(l),!P&&s.type==="date"&&(I={start:q(I.start),end:q(I.end),size:I.size}),y._fullLayout._roundFnOpts||(y._fullLayout._roundFnOpts={});var W=h["_"+A+"bingroup"],Z={leftGap:1/0,rightGap:1/0};W&&(y._fullLayout._roundFnOpts[W]||(y._fullLayout._roundFnOpts[W]=Z),Z=y._fullLayout._roundFnOpts[W]);var ee=u.length,te=!0,ae=Z.leftGap,le=Z.rightGap,ye={};for(l=0;l<k.length;l++){var fe=k[l];X=c.findBin(fe,I),X>=0&&X<ee&&(F+=ie(X,l,u,Q,R),te&&B[X].length&&fe!==k[B[X][0]]&&(te=!1),B[X].push(l),ye[l]=X,ae=Math.min(ae,fe-z[X]),le=Math.min(le,z[X+1]-fe))}Z.leftGap=ae,Z.rightGap=le;var pe;te||(pe=function(Ve,xe){return function(){var Le=y._fullLayout._roundFnOpts[W];return t(Le.leftGap,Le.rightGap,z,s,v)(Ve,xe)}}),U&&(F=r(u,R)),N&&N(u,F,D),b.enabled&&p(u,b.direction,b.currentbin);var ge=Math.min(m.length,u.length),Ae=[],we=0,De=ge-1;for(l=0;l<ge;l++)if(u[l]){we=l;break}for(l=ge-1;l>=we;l--)if(u[l]){De=l;break}for(l=we;l<=De;l++)if(w(m[l])&&w(u[l])){var Be={p:m[l],s:u[l],b:0};b.enabled||(Be.pts=B[l],te?Be.ph0=Be.ph1=B[l].length?k[B[l][0]]:m[l]:(h._computePh=!0,Be.ph0=pe(z[l]),Be.ph1=pe(z[l+1],!0))),Ae.push(Be)}return Ae.length===1&&(Ae[0].width1=T.tickIncrement(Ae[0].p,S.size,!1,v)-Ae[0].p),e(Ae,h),c.isArrayOrTypedArray(h.selectedpoints)&&c.tagSelected(Ae,h,ye),Ae}function o(y,h,m,u,_){var s=u+"bins",A=y._fullLayout,x=h["_"+u+"bingroup"],v=A._histogramBinOpts[x],b=A.barmode==="overlay",l,L,S,k,P,z,I,D=function(fe){return m.r2c(fe,0,k)},R=function(fe){return m.c2r(fe,0,k)},B=m.type==="date"?function(fe){return fe||fe===0?c.cleanDate(fe,null,k):null}:function(fe){return w(fe)?Number(fe):null};function F(fe,pe,ge){pe[fe+"Found"]?(pe[fe]=B(pe[fe]),pe[fe]===null&&(pe[fe]=ge[fe])):(z[fe]=pe[fe]=ge[fe],c.nestedProperty(L[0],s+"."+fe).set(ge[fe]))}if(h["_"+u+"autoBinFinished"])delete h["_"+u+"autoBinFinished"];else{L=v.traces;var V=[],G=!0,J=!1,j=!1;for(l=0;l<L.length;l++)if(S=L[l],S.visible){var Y=v.dirs[l];P=S["_"+Y+"pos0"]=m.makeCalcdata(S,Y),V=c.concat(V,P),delete S["_"+u+"autoBinFinished"],h.visible===!0&&(G?G=!1:(delete S._autoBin,S["_"+u+"autoBinFinished"]=1),M.traceIs(S,"2dMap")&&(J=!0),S.type==="histogram2dcontour"&&(j=!0))}k=L[0][u+"calendar"];var X=T.autoBin(V,m,v.nbins,J,k,v.sizeFound&&v.size),oe=L[0]._autoBin={};if(z=oe[v.dirs[0]]={},j&&(v.size||(X.start=R(T.tickIncrement(D(X.start),X.size,!0,k))),v.end===void 0&&(X.end=R(T.tickIncrement(D(X.end),X.size,!1,k)))),b&&!M.traceIs(h,"2dMap")&&X._dataSpan===0&&m.type!=="category"&&m.type!=="multicategory"){if(_)return[X,P,!0];X=i(y,h,m,u,s)}I=S.cumulative||{},I.enabled&&I.currentbin!=="include"&&(I.direction==="decreasing"?X.start=R(T.tickIncrement(D(X.start),X.size,!0,k)):X.end=R(T.tickIncrement(D(X.end),X.size,!1,k))),v.size=X.size,v.sizeFound||(z.size=X.size,c.nestedProperty(L[0],s+".size").set(X.size)),F("start",v,X),F("end",v,X)}P=h["_"+u+"pos0"],delete h["_"+u+"pos0"];var se=h._input[s]||{},ie=c.extendFlat({},v),N=v.start,U=m.r2l(se.start),q=U!==void 0;if((v.startFound||q)&&U!==m.r2l(N)){var Q=q?U:c.aggNums(Math.min,null,P),W={type:m.type==="category"||m.type==="multicategory"?"linear":m.type,r2l:m.r2l,dtick:v.size,tick0:N,calendar:k,range:[Q,T.tickIncrement(Q,v.size,!1,k)].map(m.l2r)},Z=T.tickFirst(W);Z>m.r2l(Q)&&(Z=T.tickIncrement(Z,v.size,!0,k)),ie.start=m.l2r(Z),q||c.nestedProperty(h,s+".start").set(ie.start)}var ee=v.end,te=m.r2l(se.end),ae=te!==void 0;if((v.endFound||ae)&&te!==m.r2l(ee)){var le=ae?te:c.aggNums(Math.max,null,P);ie.end=m.l2r(le),ae||c.nestedProperty(h,s+".start").set(ie.end)}var ye="autobin"+u;return h._input[ye]===!1&&(h._input[s]=c.extendFlat({},h[s]||{}),delete h._input[ye],delete h[ye]),[ie,P]}function i(y,h,m,u,_){var s=y._fullLayout,A=g(y,h),x=!1,v=1/0,b=[h],l,L,S;for(l=0;l<A.length;l++)if(L=A[l],L===h)x=!0;else if(!x)S=s._histogramBinOpts[L["_"+u+"bingroup"]],v=Math.min(v,S.size||L[_].size);else{var k=o(y,L,m,u,!0),P=k[0],z=k[2];L["_"+u+"autoBinFinished"]=1,L["_"+u+"pos0"]=k[1],z?b.push(L):v=Math.min(v,P.size)}var I=new Array(b.length);for(l=0;l<b.length;l++)for(var D=b[l]["_"+u+"pos0"],R=0;R<D.length;R++)if(D[R]!==void 0){I[l]=D[R];break}for(isFinite(v)||(v=c.distinctVals(I).minDiff),l=0;l<b.length;l++){L=b[l];var B=L[u+"calendar"],F={start:m.c2r(I[l]-v/2,0,B),end:m.c2r(I[l]+v/2,0,B),size:v};L._input[_]=L[_]=F,S=s._histogramBinOpts[L["_"+u+"bingroup"]],S&&c.extendFlat(S,F)}return h[_]}function g(y,h){for(var m=h.xaxis,u=h.yaxis,_=h.orientation,s=[],A=y._fullData,x=0;x<A.length;x++){var v=A[x];v.type==="histogram"&&v.visible===!0&&v.orientation===_&&v.xaxis===m&&v.yaxis===u&&s.push(v)}return s}function p(y,h,m){var u,_,s;function A(v){s=y[v],y[v]/=2}function x(v){_=y[v],y[v]=s+_/2,s+=_}if(m==="half")if(h==="increasing")for(A(0),u=1;u<y.length;u++)x(u);else for(A(y.length-1),u=y.length-2;u>=0;u--)x(u);else if(h==="increasing"){for(u=1;u<y.length;u++)y[u]+=y[u-1];m==="exclude"&&(y.unshift(0),y.pop())}else{for(u=y.length-2;u>=0;u--)y[u]+=y[u+1];m==="exclude"&&(y.push(0),y.shift())}}re.exports={calc:f,calcAllAutoBins:o}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"../bar/arrays_to_calcdata":647,"./average":813,"./bin_functions":815,"./bin_label_vals":816,"./norm_functions":824,"fast-isnumeric":190}],818:[function(d,re,ne){re.exports={eventDataKeys:["binNumber"]}},{}],819:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axis_ids"),M=d("../../registry").traceIs,T=d("../bar/defaults").handleGroupingDefaults,e=w.nestedProperty,a=d("../../plots/cartesian/constraints").getAxisGroup,n=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],r=["x","y"];re.exports=function(f,o){var i=o._histogramBinOpts={},g=[],p={},y=[],h,m,u,_,s,A,x;function v(j,Y){return w.coerce(h._input,h,h._module.attributes,j,Y)}function b(j){return j.orientation==="v"?"x":"y"}function l(j,Y){var X=c.getFromTrace({_fullLayout:o},j,Y);return X.type}function L(j,Y,X){var oe=j.uid+"__"+X;Y||(Y=oe);var se=l(j,X),ie=j[X+"calendar"]||"",N=i[Y],U=!0;N&&(se===N.axType&&ie===N.calendar?(U=!1,N.traces.push(j),N.dirs.push(X)):(Y=oe,se!==N.axType&&w.warn(["Attempted to group the bins of trace",j.index,"set on a","type:"+se,"axis","with bins on","type:"+N.axType,"axis."].join(" ")),ie!==N.calendar&&w.warn(["Attempted to group the bins of trace",j.index,"set with a",ie,"calendar","with bins",N.calendar?"on a "+N.calendar+" calendar":"w/o a set calendar"].join(" ")))),U&&(i[Y]={traces:[j],dirs:[X],axType:se,calendar:j[X+"calendar"]||""}),j["_"+X+"bingroup"]=Y}for(s=0;s<f.length;s++)h=f[s],M(h,"histogram")&&(g.push(h),delete h._xautoBinFinished,delete h._yautoBinFinished,M(h,"2dMap")||T(h._input,h,o,v));var S=o._alignmentOpts||{};for(s=0;s<g.length;s++){if(h=g[s],u="",!M(h,"2dMap")){if(_=b(h),o.barmode==="group"&&h.alignmentgroup){var k=h[_+"axis"],P=a(o,k)+h.orientation;(S[P]||{})[h.alignmentgroup]&&(u=P)}!u&&o.barmode!=="overlay"&&(u=a(o,h.xaxis)+a(o,h.yaxis)+b(h))}u?(p[u]||(p[u]=[]),p[u].push(h)):y.push(h)}for(u in p){if(m=p[u],m.length===1){y.push(m[0]);continue}var z=!1;for(m.length&&(h=m[0],z=v("bingroup")),u=z||u,s=0;s<m.length;s++){h=m[s];var I=h._input.bingroup;I&&I!==u&&w.warn(["Trace",h.index,"must match","within bingroup",u+".","Ignoring its bingroup:",I,"setting."].join(" ")),h.bingroup=u,L(h,u,b(h))}}for(s=0;s<y.length;s++){h=y[s];var D=v("bingroup");if(M(h,"2dMap"))for(x=0;x<2;x++){_=r[x];var R=v(_+"bingroup",D?D+"__"+_:null);L(h,R,_)}else L(h,D,b(h))}for(u in i){var B=i[u];for(m=B.traces,A=0;A<n.length;A++){var F=n[A],V=F.name,G,J;if(!(V==="nbins"&&B.sizeFound)){for(s=0;s<m.length;s++){if(h=m[s],_=B.dirs[s],G=F.aStr[_],e(h._input,G).get()!==void 0){B[V]=v(G),B[V+"Found"]=!0;break}J=(h._autoBin||{})[_]||{},J[V]&&e(h,G).set(J[V])}if(V==="start"||V==="end")for(;s<m.length;s++)h=m[s],h["_"+_+"bingroup"]&&(J=(h._autoBin||{})[_]||{},v(G,J[V]));V==="nbins"&&!B.sizeFound&&!B.nbinsFound&&(h=m[0],B[V]=v(G))}}}}},{"../../lib":503,"../../plots/cartesian/axis_ids":558,"../../plots/cartesian/constraints":562,"../../registry":638,"../bar/defaults":652}],820:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib"),M=d("../../components/color"),T=d("../bar/defaults").handleText,e=d("../bar/style_defaults"),a=d("./attributes");re.exports=function(r,t,f,o){function i(l,L){return c.coerce(r,t,a,l,L)}var g=i("x"),p=i("y"),y=i("cumulative.enabled");y&&(i("cumulative.direction"),i("cumulative.currentbin")),i("text");var h=i("textposition");T(r,t,o,i,h,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),i("hovertext"),i("hovertemplate"),i("xhoverformat"),i("yhoverformat");var m=i("orientation",p&&!g?"h":"v"),u=m==="v"?"x":"y",_=m==="v"?"y":"x",s=g&&p?Math.min(c.minRowLength(g)&&c.minRowLength(p)):c.minRowLength(t[u]||[]);if(!s){t.visible=!1;return}t._length=s;var A=w.getComponentMethod("calendars","handleTraceDefaults");A(r,t,["x","y"],o);var x=t[_];x&&i("histfunc"),i("histnorm"),i("autobin"+u),e(r,t,i,f,o),c.coerceSelectionMarkerOpacity(t,i);var v=(t.marker.line||{}).color,b=w.getComponentMethod("errorbars","supplyDefaults");b(r,t,v||M.defaultLine,{axis:"y"}),b(r,t,v||M.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":366,"../../lib":503,"../../registry":638,"../bar/defaults":652,"../bar/style_defaults":663,"./attributes":812}],821:[function(d,re,ne){re.exports=function(c,M,T,e,a){if(c.x="xVal"in M?M.xVal:M.x,c.y="yVal"in M?M.yVal:M.y,"zLabelVal"in M&&(c.z=M.zLabelVal),M.xa&&(c.xaxis=M.xa),M.ya&&(c.yaxis=M.ya),!(T.cumulative||{}).enabled){var n=Array.isArray(a)?e[0].pts[a[0]][a[1]]:e[a].pts;c.pointNumbers=n,c.binNumber=c.pointNumber,delete c.pointNumber,delete c.pointIndex;var r;if(T._indexToPoints){r=[];for(var t=0;t<n.length;t++)r=r.concat(T._indexToPoints[n[t]])}else r=n;c.pointIndices=r}return c}},{}],822:[function(d,re,ne){var w=d("../bar/hover").hoverPoints,c=d("../../plots/cartesian/axes").hoverLabelText;re.exports=function(T,e,a,n,r){var t=w(T,e,a,n,r);if(!!t){T=t[0];var f=T.cd[T.index],o=T.cd[0].trace;if(!o.cumulative.enabled){var i=o.orientation==="h"?"y":"x";T[i+"Label"]=c(T[i+"a"],[f.ph0,f.ph1],o[i+"hoverformat"])}return t}}},{"../../plots/cartesian/axes":554,"../bar/hover":655}],823:[function(d,re,ne){re.exports={attributes:d("./attributes"),layoutAttributes:d("../bar/layout_attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("./cross_trace_defaults"),supplyLayoutDefaults:d("../bar/layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("../bar/cross_trace_calc").crossTraceCalc,plot:d("../bar/plot").plot,layerName:"barlayer",style:d("../bar/style").style,styleOnSelect:d("../bar/style").styleOnSelect,colorbar:d("../scatter/marker_colorbar"),hoverPoints:d("./hover"),selectPoints:d("../bar/select"),eventData:d("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":568,"../bar/cross_trace_calc":651,"../bar/layout_attributes":657,"../bar/layout_defaults":658,"../bar/plot":659,"../bar/select":660,"../bar/style":662,"../scatter/marker_colorbar":945,"./attributes":812,"./calc":817,"./cross_trace_defaults":819,"./defaults":820,"./event_data":821,"./hover":822}],824:[function(d,re,ne){re.exports={percent:function(w,c){for(var M=w.length,T=100/c,e=0;e<M;e++)w[e]*=T},probability:function(w,c){for(var M=w.length,T=0;T<M;T++)w[T]/=c},density:function(w,c,M,T){var e=w.length;T=T||1;for(var a=0;a<e;a++)w[a]*=M[a]*T},"probability density":function(w,c,M,T){var e=w.length;T&&(c/=T);for(var a=0;a<e;a++)w[a]*=M[a]/c}}},{}],825:[function(d,re,ne){var w=d("../histogram/attributes"),c=d("../histogram/bin_attributes"),M=d("../heatmap/attributes"),T=d("../../plots/attributes"),e=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,a=d("../../plots/template_attributes").hovertemplateAttrs,n=d("../../plots/template_attributes").texttemplateAttrs,r=d("../../components/colorscale/attributes"),t=d("../../lib/extend").extendFlat;re.exports=t({x:w.x,y:w.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:w.histnorm,histfunc:w.histfunc,nbinsx:w.nbinsx,xbins:c("x"),nbinsy:w.nbinsy,ybins:c("y"),autobinx:w.autobinx,autobiny:w.autobiny,bingroup:t({},w.bingroup,{}),xbingroup:t({},w.bingroup,{}),ybingroup:t({},w.bingroup,{}),xgap:M.xgap,ygap:M.ygap,zsmooth:M.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:a({},{keys:"z"}),texttemplate:n({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:M.textfont,showlegend:t({},T.showlegend,{dflt:!1})},r("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../heatmap/attributes":792,"../histogram/attributes":812,"../histogram/bin_attributes":814}],826:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes"),M=d("../histogram/bin_functions"),T=d("../histogram/norm_functions"),e=d("../histogram/average"),a=d("../histogram/bin_label_vals"),n=d("../histogram/calc").calcAllAutoBins;re.exports=function(i,g){var p=c.getFromId(i,g.xaxis),y=c.getFromId(i,g.yaxis),h=g.xcalendar,m=g.ycalendar,u=function(at){return p.r2c(at,0,h)},_=function(at){return y.r2c(at,0,m)},s=function(at){return p.c2r(at,0,h)},A=function(at){return y.c2r(at,0,m)},x,v,b,l,L=n(i,g,p,"x"),S=L[0],k=L[1],P=n(i,g,y,"y"),z=P[0],I=P[1],D=g._length;k.length>D&&k.splice(D,k.length-D),I.length>D&&I.splice(D,I.length-D);var R=[],B=[],F=[],V=typeof S.size=="string",G=typeof z.size=="string",J=[],j=[],Y=V?J:S,X=G?j:z,oe=0,se=[],ie=[],N=g.histnorm,U=g.histfunc,q=N.indexOf("density")!==-1,Q=U==="max"||U==="min",W=Q?null:0,Z=M.count,ee=T[N],te=!1,ae=[],le=[],ye="z"in g?g.z:"marker"in g&&Array.isArray(g.marker.color)?g.marker.color:"";ye&&U!=="count"&&(te=U==="avg",Z=M[U]);var fe=S.size,pe=u(S.start),ge=u(S.end)+(pe-c.tickIncrement(pe,fe,!1,h))/1e6;for(x=pe;x<ge;x=c.tickIncrement(x,fe,!1,h))B.push(W),J.push(x),te&&F.push(0);J.push(x);var Ae=B.length,we=(x-pe)/Ae,De=s(pe+we/2),Be=z.size,Ve=_(z.start),xe=_(z.end)+(Ve-c.tickIncrement(Ve,Be,!1,m))/1e6;for(x=Ve;x<xe;x=c.tickIncrement(x,Be,!1,m)){R.push(B.slice()),j.push(x);var Le=new Array(Ae);for(v=0;v<Ae;v++)Le[v]=[];ie.push(Le),te&&se.push(F.slice())}j.push(x);var He=R.length,Je=(x-Ve)/He,Oe=A(Ve+Je/2);q&&(ae=r(B.length,Y,we,V),le=r(R.length,X,Je,G)),!V&&p.type==="date"&&(Y=t(u,Y)),!G&&y.type==="date"&&(X=t(_,X));var Pe=!0,Ue=!0,vt=new Array(Ae),Lt=new Array(He),Yt=1/0,At=1/0,Rt=1/0,Bt=1/0;for(x=0;x<D;x++){var Mt=k[x],Tt=I[x];b=w.findBin(Mt,Y),l=w.findBin(Tt,X),b>=0&&b<Ae&&l>=0&&l<He&&(oe+=Z(b,x,R[l],ye,se[l]),ie[l][b].push(x),Pe&&(vt[b]===void 0?vt[b]=Mt:vt[b]!==Mt&&(Pe=!1)),Ue&&(Lt[l]===void 0?Lt[l]=Tt:Lt[l]!==Tt&&(Ue=!1)),Yt=Math.min(Yt,Mt-J[b]),At=Math.min(At,J[b+1]-Mt),Rt=Math.min(Rt,Tt-j[l]),Bt=Math.min(Bt,j[l+1]-Tt))}if(te)for(l=0;l<He;l++)oe+=e(R[l],se[l]);if(ee)for(l=0;l<He;l++)ee(R[l],oe,ae,le[l]);return{x:k,xRanges:f(J,Pe&&vt,Yt,At,p,h),x0:De,dx:we,y:I,yRanges:f(j,Ue&&Lt,Rt,Bt,y,m),y0:Oe,dy:Je,z:R,pts:ie}};function r(o,i,g,p){var y=new Array(o),h;if(p)for(h=0;h<o;h++)y[h]=1/(i[h+1]-i[h]);else{var m=1/g;for(h=0;h<o;h++)y[h]=m}return y}function t(o,i){return{start:o(i.start),end:o(i.end),size:i.size}}function f(o,i,g,p,y,h){var m,u=o.length-1,_=new Array(u),s=a(g,p,o,y,h);for(m=0;m<u;m++){var A=(i||[])[m];_[m]=A===void 0?[s(o[m]),s(o[m+1],!0)]:[A,A]}return _}},{"../../lib":503,"../../plots/cartesian/axes":554,"../histogram/average":813,"../histogram/bin_functions":815,"../histogram/bin_label_vals":816,"../histogram/calc":817,"../histogram/norm_functions":824}],827:[function(d,re,ne){var w=d("../../lib"),c=d("./sample_defaults"),M=d("../heatmap/style_defaults"),T=d("../../components/colorscale/defaults"),e=d("../heatmap/label_defaults"),a=d("./attributes");re.exports=function(r,t,f,o){function i(g,p){return w.coerce(r,t,a,g,p)}c(r,t,i,o),t.visible!==!1&&(M(r,t,i,o),T(r,t,o,i,{prefix:"",cLetter:"z"}),i("hovertemplate"),e(i,o),i("xhoverformat"),i("yhoverformat"))}},{"../../components/colorscale/defaults":376,"../../lib":503,"../heatmap/label_defaults":802,"../heatmap/style_defaults":806,"./attributes":825,"./sample_defaults":830}],828:[function(d,re,ne){var w=d("../heatmap/hover"),c=d("../../plots/cartesian/axes").hoverLabelText;re.exports=function(T,e,a,n,r){var t=w(T,e,a,n,r);if(!!t){T=t[0];var f=T.index,o=f[0],i=f[1],g=T.cd[0],p=g.trace,y=g.xRanges[i],h=g.yRanges[o];return T.xLabel=c(T.xa,[y[0],y[1]],p.xhoverformat),T.yLabel=c(T.ya,[h[0],h[1]],p.yhoverformat),t}}},{"../../plots/cartesian/axes":554,"../heatmap/hover":799}],829:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../histogram/cross_trace_defaults"),calc:d("../heatmap/calc"),plot:d("../heatmap/plot"),layerName:"heatmaplayer",colorbar:d("../heatmap/colorbar"),style:d("../heatmap/style"),hoverPoints:d("./hover"),eventData:d("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":568,"../heatmap/calc":793,"../heatmap/colorbar":795,"../heatmap/plot":804,"../heatmap/style":805,"../histogram/cross_trace_defaults":819,"../histogram/event_data":821,"./attributes":825,"./defaults":827,"./hover":828}],830:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib");re.exports=function(T,e,a,n){var r=a("x"),t=a("y"),f=c.minRowLength(r),o=c.minRowLength(t);if(!f||!o){e.visible=!1;return}e._length=Math.min(f,o);var i=w.getComponentMethod("calendars","handleTraceDefaults");i(T,e,["x","y"],n);var g=a("z")||a("marker.color");g&&a("histfunc"),a("histnorm"),a("autobinx"),a("autobiny")}},{"../../lib":503,"../../registry":638}],831:[function(d,re,ne){var w=d("../histogram2d/attributes"),c=d("../contour/attributes"),M=d("../../components/colorscale/attributes"),T=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../lib/extend").extendFlat;re.exports=e({x:w.x,y:w.y,z:w.z,marker:w.marker,histnorm:w.histnorm,histfunc:w.histfunc,nbinsx:w.nbinsx,xbins:w.xbins,nbinsy:w.nbinsy,ybins:w.ybins,autobinx:w.autobinx,autobiny:w.autobiny,bingroup:w.bingroup,xbingroup:w.xbingroup,ybingroup:w.ybingroup,autocontour:c.autocontour,ncontours:c.ncontours,contours:c.contours,line:{color:c.line.color,width:e({},c.line.width,{dflt:.5}),dash:c.line.dash,smoothing:c.line.smoothing,editType:"plot"},xhoverformat:T("x"),yhoverformat:T("y"),zhoverformat:T("z",1),hovertemplate:w.hovertemplate,texttemplate:c.texttemplate,textfont:c.textfont},M("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../contour/attributes":735,"../histogram2d/attributes":825}],832:[function(d,re,ne){var w=d("../../lib"),c=d("../histogram2d/sample_defaults"),M=d("../contour/contours_defaults"),T=d("../contour/style_defaults"),e=d("../heatmap/label_defaults"),a=d("./attributes");re.exports=function(r,t,f,o){function i(p,y){return w.coerce(r,t,a,p,y)}function g(p){return w.coerce2(r,t,a,p)}c(r,t,i,o),t.visible!==!1&&(M(r,t,i,g),T(r,t,i,o),i("xhoverformat"),i("yhoverformat"),i("hovertemplate"),t.contours&&t.contours.coloring==="heatmap"&&e(i,o))}},{"../../lib":503,"../contour/contours_defaults":742,"../contour/style_defaults":756,"../heatmap/label_defaults":802,"../histogram2d/sample_defaults":830,"./attributes":831}],833:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../histogram/cross_trace_defaults"),calc:d("../contour/calc"),plot:d("../contour/plot").plot,layerName:"contourlayer",style:d("../contour/style"),colorbar:d("../contour/colorbar"),hoverPoints:d("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":568,"../contour/calc":736,"../contour/colorbar":738,"../contour/hover":748,"../contour/plot":753,"../contour/style":755,"../histogram/cross_trace_defaults":819,"./attributes":831,"./defaults":832}],834:[function(d,re,ne){var w=d("../../plots/template_attributes").hovertemplateAttrs,c=d("../../plots/template_attributes").texttemplateAttrs,M=d("../../components/colorscale/attributes"),T=d("../../plots/domain").attributes,e=d("../pie/attributes"),a=d("../sunburst/attributes"),n=d("../treemap/attributes"),r=d("../treemap/constants"),t=d("../../lib/extend").extendFlat;re.exports={labels:a.labels,parents:a.parents,values:a.values,branchvalues:a.branchvalues,count:a.count,level:a.level,maxdepth:a.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:n.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:t({colors:a.marker.colors,line:a.marker.line,editType:"calc"},M("marker",{colorAttr:"colors",anim:!1})),leaf:a.leaf,pathbar:n.pathbar,text:e.text,textinfo:a.textinfo,texttemplate:c({editType:"plot"},{keys:r.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:a.hoverinfo,hovertemplate:w({},{keys:r.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:n.outsidetextfont,textposition:n.textposition,sort:e.sort,root:a.root,domain:T({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":901,"../sunburst/attributes":1049,"../treemap/attributes":1075,"../treemap/constants":1078}],835:[function(d,re,ne){var w=d("../../plots/plots");ne.name="icicle",ne.plot=function(c,M,T,e){w.plotBasePlot(ne.name,c,M,T,e)},ne.clean=function(c,M,T,e){w.cleanBasePlot(ne.name,c,M,T,e)}},{"../../plots/plots":619}],836:[function(d,re,ne){var w=d("../sunburst/calc");ne.calc=function(c,M){return w.calc(c,M)},ne.crossTraceCalc=function(c){return w._runCrossTraceCalc("icicle",c)}},{"../sunburst/calc":1051}],837:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes"),M=d("../../components/color"),T=d("../../plots/domain").defaults,e=d("../bar/defaults").handleText,a=d("../bar/constants").TEXTPAD,n=d("../../components/colorscale"),r=n.hasColorscale,t=n.handleDefaults;re.exports=function(o,i,g,p){function y(b,l){return w.coerce(o,i,c,b,l)}var h=y("labels"),m=y("parents");if(!h||!h.length||!m||!m.length){i.visible=!1;return}var u=y("values");u&&u.length?y("branchvalues"):y("count"),y("level"),y("maxdepth"),y("tiling.orientation"),y("tiling.flip"),y("tiling.pad");var _=y("text");y("texttemplate"),i.texttemplate||y("textinfo",Array.isArray(_)?"text+label":"label"),y("hovertext"),y("hovertemplate");var s=y("pathbar.visible"),A="auto";e(o,i,p,y,A,{hasPathbar:s,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),y("textposition");var x=y("marker.line.width");x&&y("marker.line.color",p.paper_bgcolor),y("marker.colors");var v=i._hasColorscale=r(o,"marker","colors")||(o.marker||{}).coloraxis;v&&t(o,i,p,y,{prefix:"marker.",cLetter:"c"}),y("leaf.opacity",v?1:.7),i._hovered={marker:{line:{width:2,color:M.contrast(p.paper_bgcolor)}}},s&&(y("pathbar.thickness",i.pathbar.textfont.size+2*a),y("pathbar.side"),y("pathbar.edgeshape")),y("sort"),y("root.color"),T(i,p,y),i._length=null}},{"../../components/color":366,"../../components/colorscale":378,"../../lib":503,"../../plots/domain":584,"../bar/constants":650,"../bar/defaults":652,"./attributes":834}],838:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../components/drawing"),T=d("../../lib/svg_text_utils"),e=d("./partition"),a=d("./style").styleOne,n=d("../treemap/constants"),r=d("../sunburst/helpers"),t=d("../sunburst/fx"),f=d("../sunburst/plot").formatSliceLabel,o=!1;re.exports=function(g,p,y,h,m){var u=m.width,_=m.height,s=m.viewX,A=m.viewY,x=m.pathSlice,v=m.toMoveInsideSlice,b=m.strTransform,l=m.hasTransition,L=m.handleSlicesExit,S=m.makeUpdateSliceInterpolator,k=m.makeUpdateTextInterpolator,P=m.prevEntry,z={},I=g._fullLayout,D=p[0],R=D.trace,B=R.textposition.indexOf("left")!==-1,F=R.textposition.indexOf("right")!==-1,V=R.textposition.indexOf("bottom")!==-1,G=e(y,[u,_],{flipX:R.tiling.flip.indexOf("x")>-1,flipY:R.tiling.flip.indexOf("y")>-1,orientation:R.tiling.orientation,pad:{inner:R.tiling.pad},maxDepth:R._maxDepth}),J=G.descendants(),j=1/0,Y=-1/0;J.forEach(function(N){var U=N.depth;U>=R._maxDepth?(N.x0=N.x1=(N.x0+N.x1)/2,N.y0=N.y1=(N.y0+N.y1)/2):(j=Math.min(j,U),Y=Math.max(Y,U))}),h=h.data(J,r.getPtId),R._maxVisibleLayers=isFinite(Y)?Y-j+1:0,h.enter().append("g").classed("slice",!0),L(h,o,z,[u,_],x),h.order();var X=null;if(l&&P){var oe=r.getPtId(P);h.each(function(N){X===null&&r.getPtId(N)===oe&&(X={x0:N.x0,x1:N.x1,y0:N.y0,y1:N.y1})})}var se=function(){return X||{x0:0,x1:u,y0:0,y1:_}},ie=h;return l&&(ie=ie.transition().each("end",function(){var N=w.select(this);r.setSliceCursor(N,g,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),ie.each(function(N){N._x0=s(N.x0),N._x1=s(N.x1),N._y0=A(N.y0),N._y1=A(N.y1),N._hoverX=s(N.x1-R.tiling.pad),N._hoverY=A(V?N.y1-R.tiling.pad/2:N.y0+R.tiling.pad/2);var U=w.select(this),q=c.ensureSingle(U,"path","surface",function(ee){ee.style("pointer-events","all")});l?q.transition().attrTween("d",function(ee){var te=S(ee,o,se(),[u,_],{orientation:R.tiling.orientation,flipX:R.tiling.flip.indexOf("x")>-1,flipY:R.tiling.flip.indexOf("y")>-1});return function(ae){return x(te(ae))}}):q.attr("d",x),U.call(t,y,g,p,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,g,{isTransitioning:g._transitioning}),q.call(a,N,R,{hovered:!1}),N.x0===N.x1||N.y0===N.y1?N._text="":N._text=f(N,y,R,p,I)||"";var Q=c.ensureSingle(U,"g","slicetext"),W=c.ensureSingle(Q,"text","",function(ee){ee.attr("data-notex",1)}),Z=c.ensureUniformFontSize(g,r.determineTextFont(R,N,I.font));W.text(N._text||" ").classed("slicetext",!0).attr("text-anchor",F?"end":B?"start":"middle").call(M.font,Z).call(T.convertToTspans,g),N.textBB=M.bBox(W.node()),N.transform=v(N,{fontSize:Z.size}),N.transform.fontSize=Z.size,l?W.transition().attrTween("transform",function(ee){var te=k(ee,o,se(),[u,_]);return function(ae){return b(te(ae))}}):W.attr("transform",b(N))}),X}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../sunburst/fx":1054,"../sunburst/helpers":1055,"../sunburst/plot":1059,"../treemap/constants":1078,"./partition":842,"./style":844,"@plotly/d3":58}],839:[function(d,re,ne){re.exports={moduleType:"trace",name:"icicle",basePlotModule:d("./base_plot"),categories:[],animatable:!0,attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),style:d("./style").style,colorbar:d("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":945,"./attributes":834,"./base_plot":835,"./calc":836,"./defaults":837,"./layout_attributes":840,"./layout_defaults":841,"./plot":843,"./style":844}],840:[function(d,re,ne){re.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],841:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes");re.exports=function(T,e){function a(n,r){return w.coerce(T,e,c,n,r)}a("iciclecolorway",e.colorway),a("extendiciclecolors")}},{"../../lib":503,"./layout_attributes":840}],842:[function(d,re,ne){var w=d("d3-hierarchy"),c=d("../treemap/flip_tree");re.exports=function(T,e,a){var n=a.flipX,r=a.flipY,t=a.orientation==="h",f=a.maxDepth,o=e[0],i=e[1];f&&(o=(T.height+1)*e[0]/Math.min(T.height+1,f),i=(T.height+1)*e[1]/Math.min(T.height+1,f));var g=w.partition().padding(a.pad.inner).size(t?[e[1],o]:[e[0],i])(T);return(t||n||r)&&c(g,e,{swapXY:t,flipX:n,flipY:r}),g}},{"../treemap/flip_tree":1083,"d3-hierarchy":115}],843:[function(d,re,ne){var w=d("../treemap/draw"),c=d("./draw_descendants");re.exports=function(T,e,a,n){return w(T,e,a,n,{type:"icicle",drawDescendants:c})}},{"../treemap/draw":1080,"./draw_descendants":838}],844:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/color"),M=d("../../lib"),T=d("../bar/uniform_text").resizeText;function e(n){var r=n._fullLayout._iciclelayer.selectAll(".trace");T(n,r,"icicle"),r.each(function(t){var f=w.select(this),o=t[0],i=o.trace;f.style("opacity",i.opacity),f.selectAll("path.surface").each(function(g){w.select(this).call(a,g,i)})})}function a(n,r,t){var f=r.data.data,o=!r.children,i=f.i,g=M.castOption(t,i,"marker.line.color")||c.defaultLine,p=M.castOption(t,i,"marker.line.width")||0;n.style("stroke-width",p).call(c.fill,f.color).call(c.stroke,g).style("opacity",o?t.leaf.opacity:null)}re.exports={style:e,styleOne:a}},{"../../components/color":366,"../../lib":503,"../bar/uniform_text":664,"@plotly/d3":58}],845:[function(d,re,ne){for(var w=d("../../plots/attributes"),c=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../lib/extend").extendFlat,T=d("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],a=[],n=[],r=0;r<e.length;r++){var t=T[e[r]];a.push("For the `"+e[r]+"` colormodel, it is ["+(t.zminDflt||t.min).join(", ")+"]."),n.push("For the `"+e[r]+"` colormodel, it is ["+(t.zmaxDflt||t.max).join(", ")+"].")}re.exports=M({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:M({},w.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:c({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"./constants":847}],846:[function(d,re,ne){var w=d("../../lib"),c=d("./constants"),M=d("fast-isnumeric"),T=d("../../plots/cartesian/axes"),e=d("../../lib").maxRowLength,a=d("./helpers").getImageSize;re.exports=function(o,i){var g,p;if(i._hasZ)g=i.z.length,p=e(i.z);else if(i._hasSource){var y=a(i.source);g=y.height,p=y.width}var h=T.getFromId(o,i.xaxis||"x"),m=T.getFromId(o,i.yaxis||"y"),u=h.d2c(i.x0)-i.dx/2,_=m.d2c(i.y0)-i.dy/2,s,A=[u,u+p*i.dx],x=[_,_+g*i.dy];if(h&&h.type==="log")for(s=0;s<p;s++)A.push(u+s*i.dx);if(m&&m.type==="log")for(s=0;s<g;s++)x.push(_+s*i.dy);i._extremes[h._id]=T.findExtremes(h,A),i._extremes[m._id]=T.findExtremes(m,x),i._scaler=t(i);var v={x0:u,y0:_,z:i.z,w:p,h:g};return[v]};function n(f,o,i,g){return function(p){return w.constrain((p-f)*o,i,g)}}function r(f,o){return function(i){return w.constrain(i,f,o)}}function t(f){var o=c.colormodel[f.colormodel],i=o.colormodel||f.colormodel,g=i.length;f._sArray=[];for(var p=0;p<g;p++)o.min[p]!==f.zmin[p]||o.max[p]!==f.zmax[p]?f._sArray.push(n(f.zmin[p],(o.max[p]-o.min[p])/(f.zmax[p]-f.zmin[p]),o.min[p],o.max[p])):f._sArray.push(r(o.min[p],o.max[p]));return function(y){for(var h=y.slice(0,g),m=0;m<g;m++){var u=h[m];if(!M(u))return!1;h[m]=f._sArray[m](u)}return h}}},{"../../lib":503,"../../plots/cartesian/axes":554,"./constants":847,"./helpers":850,"fast-isnumeric":190}],847:[function(d,re,ne){re.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(w){return w.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(w){return w.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(w){return w.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(w){var c=w.slice(0,3);return c[1]=c[1]+"%",c[2]=c[2]+"%",c},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(w){var c=w.slice(0,4);return c[1]=c[1]+"%",c[2]=c[2]+"%",c},suffix:["\xB0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],848:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes"),M=d("./constants"),T=d("../../snapshot/helpers").IMAGE_URL_PREFIX;re.exports=function(a,n){function r(o,i){return w.coerce(a,n,c,o,i)}r("source"),n.source&&!n.source.match(T)&&delete n.source,n._hasSource=!!n.source;var t=r("z");if(n._hasZ=!(t===void 0||!t.length||!t[0]||!t[0].length),!n._hasZ&&!n._hasSource){n.visible=!1;return}r("x0"),r("y0"),r("dx"),r("dy");var f;n._hasZ?(r("colormodel","rgb"),f=M.colormodel[n.colormodel],r("zmin",f.zminDflt||f.min),r("zmax",f.zmaxDflt||f.max)):n._hasSource&&(n.colormodel="rgba256",f=M.colormodel[n.colormodel],n.zmin=f.zminDflt,n.zmax=f.zmaxDflt),r("zsmooth"),r("text"),r("hovertext"),r("hovertemplate"),n._length=null}},{"../../lib":503,"../../snapshot/helpers":642,"./attributes":845,"./constants":847}],849:[function(d,re,ne){re.exports=function(c,M){return"xVal"in M&&(c.x=M.xVal),"yVal"in M&&(c.y=M.yVal),M.xa&&(c.xaxis=M.xa),M.ya&&(c.yaxis=M.ya),c.color=M.color,c.colormodel=M.trace.colormodel,c.z||(c.z=M.color),c}},{}],850:[function(d,re,ne){var w=d("probe-image-size/sync"),c=d("../../snapshot/helpers").IMAGE_URL_PREFIX,M=d("buffer/").Buffer;ne.getImageSize=function(T){var e=T.replace(c,""),a=new M(e,"base64");return w(a)}},{"../../snapshot/helpers":642,"buffer/":85,"probe-image-size/sync":276}],851:[function(d,re,ne){var w=d("../../components/fx"),c=d("../../lib"),M=d("./constants");re.exports=function(e,a,n){var r=e.cd[0],t=r.trace,f=e.xa,o=e.ya;if(!(w.inbox(a-r.x0,a-(r.x0+r.w*t.dx),0)>0||w.inbox(n-r.y0,n-(r.y0+r.h*t.dy),0)>0)){var i=Math.floor((a-r.x0)/t.dx),g=Math.floor(Math.abs(n-r.y0)/t.dy),p;if(t._hasZ?p=r.z[g][i]:t._hasSource&&(p=t._canvas.el.getContext("2d").getImageData(i,g,1,1).data),!!p){var y=r.hi||t.hoverinfo,h;if(y){var m=y.split("+");m.indexOf("all")!==-1&&(m=["color"]),m.indexOf("color")!==-1&&(h=!0)}var u=M.colormodel[t.colormodel],_=u.colormodel||t.colormodel,s=_.length,A=t._scaler(p),x=u.suffix,v=[];(t.hovertemplate||h)&&(v.push("["+[A[0]+x[0],A[1]+x[1],A[2]+x[2]].join(", ")),s===4&&v.push(", "+A[3]+x[3]),v.push("]"),v=v.join(""),e.extraText=_.toUpperCase()+": "+v);var b;Array.isArray(t.hovertext)&&Array.isArray(t.hovertext[g])?b=t.hovertext[g][i]:Array.isArray(t.text)&&Array.isArray(t.text[g])&&(b=t.text[g][i]);var l=o.c2p(r.y0+(g+.5)*t.dy),L=r.x0+(i+.5)*t.dx,S=r.y0+(g+.5)*t.dy,k="["+p.slice(0,t.colormodel.length).join(", ")+"]";return[c.extendFlat(e,{index:[g,i],x0:f.c2p(r.x0+i*t.dx),x1:f.c2p(r.x0+(i+1)*t.dx),y0:l,y1:l,color:A,xVal:L,xLabelVal:L,yVal:S,yLabelVal:S,zLabelVal:k,text:b,hovertemplateLabels:{zLabel:k,colorLabel:v,"color[0]Label":A[0]+x[0],"color[1]Label":A[1]+x[1],"color[2]Label":A[2]+x[2],"color[3]Label":A[3]+x[3]}})]}}}},{"../../components/fx":406,"../../lib":503,"./constants":847}],852:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),style:d("./style"),hoverPoints:d("./hover"),eventData:d("./event_data"),moduleType:"trace",name:"image",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":568,"./attributes":845,"./calc":846,"./defaults":848,"./event_data":849,"./hover":851,"./plot":853,"./style":854}],853:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=c.strTranslate,T=d("../../constants/xmlns_namespaces"),e=d("./constants"),a=c.isIOS()||c.isSafari()||c.isIE();re.exports=function(r,t,f,o){var i=t.xaxis,g=t.yaxis,p=!(a||r._context._exportedPlot);c.makeTraceGroups(o,f,"im").each(function(y){var h=w.select(this),m=y[0],u=m.trace,_=(u.zsmooth==="fast"||u.zsmooth===!1&&p)&&!u._hasZ&&u._hasSource&&i.type==="linear"&&g.type==="linear";u._realImage=_;var s=m.z,A=m.x0,x=m.y0,v=m.w,b=m.h,l=u.dx,L=u.dy,S,k,P,z,I,D;for(D=0;S===void 0&&D<v;)S=i.c2p(A+D*l),D++;for(D=v;k===void 0&&D>0;)k=i.c2p(A+D*l),D--;for(D=0;z===void 0&&D<b;)z=g.c2p(x+D*L),D++;for(D=b;I===void 0&&D>0;)I=g.c2p(x+D*L),D--;if(k<S&&(P=k,k=S,S=P),I<z&&(P=z,z=I,I=P),!_){var R=.5;S=Math.max(-R*i._length,S),k=Math.min((1+R)*i._length,k),z=Math.max(-R*g._length,z),I=Math.min((1+R)*g._length,I)}var B=Math.round(k-S),F=Math.round(I-z),V=B<=0||F<=0;if(V){var G=h.selectAll("image").data([]);G.exit().remove();return}function J(Q){var W=document.createElement("canvas");W.width=B,W.height=F;var Z=W.getContext("2d"),ee=function(Be){return c.constrain(Math.round(i.c2p(A+Be*l)-S),0,B)},te=function(Be){return c.constrain(Math.round(g.c2p(x+Be*L)-z),0,F)},ae=e.colormodel[u.colormodel],le=ae.colormodel||u.colormodel,ye=ae.fmt,fe;for(D=0;D<m.w;D++){var pe=ee(D),ge=ee(D+1);if(!(ge===pe||isNaN(ge)||isNaN(pe)))for(var Ae=0;Ae<m.h;Ae++){var we=te(Ae),De=te(Ae+1);De===we||isNaN(De)||isNaN(we)||!Q(D,Ae)||(fe=u._scaler(Q(D,Ae)),fe?Z.fillStyle=le+"("+ye(fe).join(",")+")":Z.fillStyle="rgba(0,0,0,0)",Z.fillRect(pe,we,ge-pe,De-we))}}return W}var j=h.selectAll("image").data([y]);j.enter().append("svg:image").attr({xmlns:T.svg,preserveAspectRatio:"none"}),j.exit().remove();var Y=u.zsmooth===!1?e.pixelatedStyle:"";if(_){var X=c.simpleMap(i.range,i.r2l),oe=c.simpleMap(g.range,g.r2l),se=X[1]<X[0],ie=oe[1]>oe[0];if(se||ie){var N=S+B/2,U=z+F/2;Y+="transform:"+M(N+"px",U+"px")+"scale("+(se?-1:1)+","+(ie?-1:1)+")"+M(-N+"px",-U+"px")+";"}}j.attr("style",Y);var q=new Promise(function(Q){if(u._hasZ)Q();else if(u._hasSource)if(u._canvas&&u._canvas.el.width===v&&u._canvas.el.height===b&&u._canvas.source===u.source)Q();else{var W=document.createElement("canvas");W.width=v,W.height=b;var Z=W.getContext("2d");u._image=u._image||new Image;var ee=u._image;ee.onload=function(){Z.drawImage(ee,0,0),u._canvas={el:W,source:u.source},Q()},ee.setAttribute("src",u.source)}}).then(function(){var Q,W;if(u._hasZ)W=J(function(te,ae){return s[ae][te]}),Q=W.toDataURL("image/png");else if(u._hasSource)if(_)Q=u.source;else{var Z=u._canvas.el.getContext("2d"),ee=Z.getImageData(0,0,v,b).data;W=J(function(te,ae){var le=4*(ae*v+te);return[ee[le],ee[le+1],ee[le+2],ee[le+3]]}),Q=W.toDataURL("image/png")}j.attr({"xlink:href":Q,height:F,width:B,x:S,y:z})});r._promises.push(q)})}},{"../../constants/xmlns_namespaces":480,"../../lib":503,"./constants":847,"@plotly/d3":58}],854:[function(d,re,ne){var w=d("@plotly/d3");re.exports=function(M){w.select(M).selectAll(".im image").style("opacity",function(T){return T[0].trace.opacity})}},{"@plotly/d3":58}],855:[function(d,re,ne){var w=d("../../lib/extend").extendFlat,c=d("../../lib/extend").extendDeep,M=d("../../plot_api/edit_types").overrideAll,T=d("../../plots/font_attributes"),e=d("../../components/color/attributes"),a=d("../../plots/domain").attributes,n=d("../../plots/cartesian/layout_attributes"),r=d("../../plot_api/plot_template").templatedArray,t=d("../../constants/delta.js"),f=d("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,o=T({editType:"plot",colorEditType:"plot"}),i={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},g={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},p=r("step",c({},i,{range:g}));re.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:a({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:w({},o,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:f("value")},font:w({},o,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:f("value")},increasing:{symbol:{valType:"string",dflt:t.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:t.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:w({},o,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:c({},i,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:M({range:g,visible:w({},n.visible,{dflt:!0}),tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:w({},n.ticks,{dflt:"outside"}),ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,ticklabelstep:n.ticklabelstep,showticklabels:n.showticklabels,tickfont:T({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,minexponent:n.minexponent,showexponent:n.showexponent,editType:"plot"},"plot"),steps:p,threshold:{line:{color:w({},i.line.color,{}),width:w({},i.line.width,{dflt:1}),editType:"plot"},thickness:w({},i.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":365,"../../constants/delta.js":473,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_format_attributes":557,"../../plots/cartesian/layout_attributes":569,"../../plots/domain":584,"../../plots/font_attributes":585}],856:[function(d,re,ne){var w=d("../../plots/plots");ne.name="indicator",ne.plot=function(c,M,T,e){w.plotBasePlot(ne.name,c,M,T,e)},ne.clean=function(c,M,T,e){w.cleanBasePlot(ne.name,c,M,T,e)}},{"../../plots/plots":619}],857:[function(d,re,ne){function w(c,M){var T=[],e=M.value;typeof M._lastValue!="number"&&(M._lastValue=M.value);var a=M._lastValue,n=a;return M._hasDelta&&typeof M.delta.reference=="number"&&(n=M.delta.reference),T[0]={y:e,lastY:a,delta:e-n,relativeDelta:(e-n)/n},T}re.exports={calc:w}},{}],858:[function(d,re,ne){re.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],859:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes"),M=d("../../plots/domain").defaults,T=d("../../plot_api/plot_template"),e=d("../../plots/array_container_defaults"),a=d("./constants.js"),n=d("../../plots/cartesian/tick_value_defaults"),r=d("../../plots/cartesian/tick_mark_defaults"),t=d("../../plots/cartesian/tick_label_defaults"),f=d("../../plots/cartesian/prefix_suffix_defaults");function o(g,p,y,h){function m(D,R){return w.coerce(g,p,c,D,R)}M(p,h,m),m("mode"),p._hasNumber=p.mode.indexOf("number")!==-1,p._hasDelta=p.mode.indexOf("delta")!==-1,p._hasGauge=p.mode.indexOf("gauge")!==-1;var u=m("value");p._range=[0,typeof u=="number"?1.5*u:1];var _=new Array(2),s;p._hasNumber&&(m("number.valueformat"),m("number.font.color",h.font.color),m("number.font.family",h.font.family),m("number.font.size"),p.number.font.size===void 0&&(p.number.font.size=a.defaultNumberFontSize,_[0]=!0),m("number.prefix"),m("number.suffix"),s=p.number.font.size);var A;p._hasDelta&&(m("delta.font.color",h.font.color),m("delta.font.family",h.font.family),m("delta.font.size"),p.delta.font.size===void 0&&(p.delta.font.size=(p._hasNumber?.5:1)*(s||a.defaultNumberFontSize),_[1]=!0),m("delta.reference",p.value),m("delta.relative"),m("delta.valueformat",p.delta.relative?"2%":""),m("delta.increasing.symbol"),m("delta.increasing.color"),m("delta.decreasing.symbol"),m("delta.decreasing.color"),m("delta.position"),A=p.delta.font.size),p._scaleNumbers=(!p._hasNumber||_[0])&&(!p._hasDelta||_[1])||!1,m("title.font.color",h.font.color),m("title.font.family",h.font.family),m("title.font.size",.25*(s||A||a.defaultNumberFontSize)),m("title.text");var x,v,b,l;function L(D,R){return w.coerce(x,v,c.gauge,D,R)}function S(D,R){return w.coerce(b,l,c.gauge.axis,D,R)}if(p._hasGauge){x=g.gauge,x||(x={}),v=T.newContainer(p,"gauge"),L("shape");var k=p._isBullet=p.gauge.shape==="bullet";k||m("title.align","center");var P=p._isAngular=p.gauge.shape==="angular";P||m("align","center"),L("bgcolor",h.paper_bgcolor),L("borderwidth"),L("bordercolor"),L("bar.color"),L("bar.line.color"),L("bar.line.width");var z=a.valueThickness*(p.gauge.shape==="bullet"?.5:1);L("bar.thickness",z),e(x,v,{name:"steps",handleItemDefaults:i}),L("threshold.value"),L("threshold.thickness"),L("threshold.line.width"),L("threshold.line.color"),b={},x&&(b=x.axis||{}),l=T.newContainer(v,"axis"),S("visible"),p._range=S("range",p._range);var I={outerTicks:!0};n(b,l,S,"linear"),f(b,l,S,"linear",I),t(b,l,S,"linear",I),r(b,l,S,I)}else m("title.align","center"),m("align","center"),p._isAngular=p._isBullet=!1;p._length=null}function i(g,p){function y(h,m){return w.coerce(g,p,c.gauge.steps,h,m)}y("color"),y("line.color"),y("line.width"),y("range"),y("thickness")}re.exports={supplyDefaults:o}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/array_container_defaults":549,"../../plots/cartesian/prefix_suffix_defaults":573,"../../plots/cartesian/tick_label_defaults":578,"../../plots/cartesian/tick_mark_defaults":579,"../../plots/cartesian/tick_value_defaults":580,"../../plots/domain":584,"./attributes":855,"./constants.js":858}],860:[function(d,re,ne){re.exports={moduleType:"trace",name:"indicator",basePlotModule:d("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,calc:d("./calc").calc,plot:d("./plot"),meta:{}}},{"./attributes":855,"./base_plot":856,"./calc":857,"./defaults":859,"./plot":861}],861:[function(d,re,ne){var w=d("@plotly/d3"),c=d("d3-interpolate").interpolate,M=d("d3-interpolate").interpolateNumber,T=d("../../lib"),e=T.strScale,a=T.strTranslate,n=T.rad2deg,r=d("../../constants/alignment").MID_SHIFT,t=d("../../components/drawing"),f=d("./constants"),o=d("../../lib/svg_text_utils"),i=d("../../plots/cartesian/axes"),g=d("../../plots/cartesian/axis_defaults"),p=d("../../plots/cartesian/position_defaults"),y=d("../../plots/cartesian/layout_attributes"),h=d("../../components/color"),m={left:"start",center:"middle",right:"end"},u={left:0,center:.5,right:1},_=/[yzafpnmkMGTPEZY]/;function s(I){return I&&I.duration>0}re.exports=function(D,R,B,F){var V=D._fullLayout,G;s(B)&&F&&(G=F()),T.makeTraceGroups(V._indicatorlayer,R,"trace").each(function(J){var j=J[0],Y=j.trace,X=w.select(this),oe=Y._hasGauge,se=Y._isAngular,ie=Y._isBullet,N=Y.domain,U={w:V._size.w*(N.x[1]-N.x[0]),h:V._size.h*(N.y[1]-N.y[0]),l:V._size.l+V._size.w*N.x[0],r:V._size.r+V._size.w*(1-N.x[1]),t:V._size.t+V._size.h*(1-N.y[1]),b:V._size.b+V._size.h*N.y[0]},q=U.l+U.w/2,Q=U.t+U.h/2,W=Math.min(U.w/2,U.h),Z=f.innerRadius*W,ee,te,ae,le=Y.align||"center";if(te=Q,!oe)ee=U.l+u[le]*U.w,ae=function(xe){return S(xe,U.w,U.h)};else if(se&&(ee=q,te=Q+W/2,ae=function(xe){return k(xe,.9*Z)}),ie){var ye=f.bulletPadding,fe=1-f.bulletNumberDomainSize+ye;ee=U.l+(fe+(1-fe)*u[le])*U.w,ae=function(xe){return S(xe,(f.bulletNumberDomainSize-ye)*U.w,U.h)}}v(D,X,J,{numbersX:ee,numbersY:te,numbersScaler:ae,transitionOpts:B,onComplete:G});var pe,ge;oe&&(pe={range:Y.gauge.axis.range,color:Y.gauge.bgcolor,line:{color:Y.gauge.bordercolor,width:0},thickness:1},ge={range:Y.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:Y.gauge.bordercolor,width:Y.gauge.borderwidth},thickness:1});var Ae=X.selectAll("g.angular").data(se?J:[]);Ae.exit().remove();var we=X.selectAll("g.angularaxis").data(se?J:[]);we.exit().remove(),se&&x(D,X,J,{radius:W,innerRadius:Z,gauge:Ae,layer:we,size:U,gaugeBg:pe,gaugeOutline:ge,transitionOpts:B,onComplete:G});var De=X.selectAll("g.bullet").data(ie?J:[]);De.exit().remove();var Be=X.selectAll("g.bulletaxis").data(ie?J:[]);Be.exit().remove(),ie&&A(D,X,J,{gauge:De,layer:Be,size:U,gaugeBg:pe,gaugeOutline:ge,transitionOpts:B,onComplete:G});var Ve=X.selectAll("text.title").data(J);Ve.exit().remove(),Ve.enter().append("text").classed("title",!0),Ve.attr("text-anchor",function(){return ie?m.right:m[Y.title.align]}).text(Y.title.text).call(t.font,Y.title.font).call(o.convertToTspans,D),Ve.attr("transform",function(){var xe=U.l+U.w*u[Y.title.align],Le,He=f.titlePadding,Je=t.bBox(Ve.node());if(oe){if(se)if(Y.gauge.axis.visible){var Oe=t.bBox(we.node());Le=Oe.top-He-Je.bottom}else Le=U.t+U.h/2-W/2-Je.bottom-He;ie&&(Le=te-(Je.top+Je.bottom)/2,xe=U.l-f.bulletPadding*U.w)}else Le=Y._numbersTop-He-Je.bottom;return a(xe,Le)})})};function A(I,D,R,B){var F=R[0].trace,V=B.gauge,G=B.layer,J=B.gaugeBg,j=B.gaugeOutline,Y=B.size,X=F.domain,oe=B.transitionOpts,se=B.onComplete,ie,N,U,q,Q;V.enter().append("g").classed("bullet",!0),V.attr("transform",a(Y.l,Y.t)),G.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),G.selectAll("g.xbulletaxistick,path,text").remove();var W=Y.h,Z=F.gauge.bar.thickness*W,ee=X.x[0],te=X.x[0]+(X.x[1]-X.x[0])*(F._hasNumber||F._hasDelta?1-f.bulletNumberDomainSize:1);ie=L(I,F.gauge.axis),ie._id="xbulletaxis",ie.domain=[ee,te],ie.setScale(),N=i.calcTicks(ie),U=i.makeTransTickFn(ie),q=i.getTickSigns(ie)[2],Q=Y.t+Y.h,ie.visible&&(i.drawTicks(I,ie,{vals:ie.ticks==="inside"?i.clipEnds(ie,N):N,layer:G,path:i.makeTickPath(ie,Q,q),transFn:U}),i.drawLabels(I,ie,{vals:N,layer:G,transFn:U,labelFns:i.makeLabelFns(ie,Q)}));function ae(we){we.attr("width",function(De){return Math.max(0,ie.c2p(De.range[1])-ie.c2p(De.range[0]))}).attr("x",function(De){return ie.c2p(De.range[0])}).attr("y",function(De){return .5*(1-De.thickness)*W}).attr("height",function(De){return De.thickness*W})}var le=[J].concat(F.gauge.steps),ye=V.selectAll("g.bg-bullet").data(le);ye.enter().append("g").classed("bg-bullet",!0).append("rect"),ye.select("rect").call(ae).call(b),ye.exit().remove();var fe=V.selectAll("g.value-bullet").data([F.gauge.bar]);fe.enter().append("g").classed("value-bullet",!0).append("rect"),fe.select("rect").attr("height",Z).attr("y",(W-Z)/2).call(b),s(oe)?fe.select("rect").transition().duration(oe.duration).ease(oe.easing).each("end",function(){se&&se()}).each("interrupt",function(){se&&se()}).attr("width",Math.max(0,ie.c2p(Math.min(F.gauge.axis.range[1],R[0].y)))):fe.select("rect").attr("width",typeof R[0].y=="number"?Math.max(0,ie.c2p(Math.min(F.gauge.axis.range[1],R[0].y))):0),fe.exit().remove();var pe=R.filter(function(){return F.gauge.threshold.value||F.gauge.threshold.value===0}),ge=V.selectAll("g.threshold-bullet").data(pe);ge.enter().append("g").classed("threshold-bullet",!0).append("line"),ge.select("line").attr("x1",ie.c2p(F.gauge.threshold.value)).attr("x2",ie.c2p(F.gauge.threshold.value)).attr("y1",(1-F.gauge.threshold.thickness)/2*W).attr("y2",(1-(1-F.gauge.threshold.thickness)/2)*W).call(h.stroke,F.gauge.threshold.line.color).style("stroke-width",F.gauge.threshold.line.width),ge.exit().remove();var Ae=V.selectAll("g.gauge-outline").data([j]);Ae.enter().append("g").classed("gauge-outline",!0).append("rect"),Ae.select("rect").call(ae).call(b),Ae.exit().remove()}function x(I,D,R,B){var F=R[0].trace,V=B.size,G=B.radius,J=B.innerRadius,j=B.gaugeBg,Y=B.gaugeOutline,X=[V.l+V.w/2,V.t+V.h/2+G/2],oe=B.gauge,se=B.layer,ie=B.transitionOpts,N=B.onComplete,U=Math.PI/2;function q(Pe){var Ue=F.gauge.axis.range[0],vt=F.gauge.axis.range[1],Lt=(Pe-Ue)/(vt-Ue)*Math.PI-U;return Lt<-U?-U:Lt>U?U:Lt}function Q(Pe){return w.svg.arc().innerRadius((J+G)/2-Pe/2*(G-J)).outerRadius((J+G)/2+Pe/2*(G-J)).startAngle(-U)}function W(Pe){Pe.attr("d",function(Ue){return Q(Ue.thickness).startAngle(q(Ue.range[0])).endAngle(q(Ue.range[1]))()})}var Z,ee,te,ae;oe.enter().append("g").classed("angular",!0),oe.attr("transform",a(X[0],X[1])),se.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),se.selectAll("g.xangularaxistick,path,text").remove(),Z=L(I,F.gauge.axis),Z.type="linear",Z.range=F.gauge.axis.range,Z._id="xangularaxis",Z.ticklabeloverflow="allow",Z.setScale();var le=function(Pe){return(Z.range[0]-Pe.x)/(Z.range[1]-Z.range[0])*Math.PI+Math.PI},ye={},fe=i.makeLabelFns(Z,0),pe=fe.labelStandoff;ye.xFn=function(Pe){var Ue=le(Pe);return Math.cos(Ue)*pe},ye.yFn=function(Pe){var Ue=le(Pe),vt=Math.sin(Ue)>0?.2:1;return-Math.sin(Ue)*(pe+Pe.fontSize*vt)+Math.abs(Math.cos(Ue))*(Pe.fontSize*r)},ye.anchorFn=function(Pe){var Ue=le(Pe),vt=Math.cos(Ue);return Math.abs(vt)<.1?"middle":vt>0?"start":"end"},ye.heightFn=function(Pe,Ue,vt){var Lt=le(Pe);return-.5*(1+Math.sin(Lt))*vt};var ge=function(Pe){return a(X[0]+G*Math.cos(Pe),X[1]-G*Math.sin(Pe))};te=function(Pe){return ge(le(Pe))};var Ae=function(Pe){var Ue=le(Pe);return ge(Ue)+"rotate("+-n(Ue)+")"};if(ee=i.calcTicks(Z),ae=i.getTickSigns(Z)[2],Z.visible){ae=Z.ticks==="inside"?-1:1;var we=(Z.linewidth||1)/2;i.drawTicks(I,Z,{vals:ee,layer:se,path:"M"+ae*we+",0h"+ae*Z.ticklen,transFn:Ae}),i.drawLabels(I,Z,{vals:ee,layer:se,transFn:te,labelFns:ye})}var De=[j].concat(F.gauge.steps),Be=oe.selectAll("g.bg-arc").data(De);Be.enter().append("g").classed("bg-arc",!0).append("path"),Be.select("path").call(W).call(b),Be.exit().remove();var Ve=Q(F.gauge.bar.thickness),xe=oe.selectAll("g.value-arc").data([F.gauge.bar]);xe.enter().append("g").classed("value-arc",!0).append("path");var Le=xe.select("path");s(ie)?(Le.transition().duration(ie.duration).ease(ie.easing).each("end",function(){N&&N()}).each("interrupt",function(){N&&N()}).attrTween("d",l(Ve,q(R[0].lastY),q(R[0].y))),F._lastValue=R[0].y):Le.attr("d",typeof R[0].y=="number"?Ve.endAngle(q(R[0].y)):"M0,0Z"),Le.call(b),xe.exit().remove(),De=[];var He=F.gauge.threshold.value;(He||He===0)&&De.push({range:[He,He],color:F.gauge.threshold.color,line:{color:F.gauge.threshold.line.color,width:F.gauge.threshold.line.width},thickness:F.gauge.threshold.thickness});var Je=oe.selectAll("g.threshold-arc").data(De);Je.enter().append("g").classed("threshold-arc",!0).append("path"),Je.select("path").call(W).call(b),Je.exit().remove();var Oe=oe.selectAll("g.gauge-outline").data([Y]);Oe.enter().append("g").classed("gauge-outline",!0).append("path"),Oe.select("path").call(W).call(b),Oe.exit().remove()}function v(I,D,R,B){var F=R[0].trace,V=B.numbersX,G=B.numbersY,J=F.align||"center",j=m[J],Y=B.transitionOpts,X=B.onComplete,oe=T.ensureSingle(D,"g","numbers"),se,ie,N,U=[];F._hasNumber&&U.push("number"),F._hasDelta&&(U.push("delta"),F.delta.position==="left"&&U.reverse());var q=oe.selectAll("text").data(U);q.enter().append("text"),q.attr("text-anchor",function(){return j}).attr("class",function(ge){return ge}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),q.exit().remove();function Q(ge,Ae,we,De){if(ge.match("s")&&we>=0!=De>=0&&!Ae(we).slice(-1).match(_)&&!Ae(De).slice(-1).match(_)){var Be=ge.slice().replace("s","f").replace(/\d+/,function(xe){return parseInt(xe)-1}),Ve=L(I,{tickformat:Be});return function(xe){return Math.abs(xe)<1?i.tickText(Ve,xe).text:Ae(xe)}}else return Ae}function W(){var ge=L(I,{tickformat:F.number.valueformat},F._range);ge.setScale(),i.prepTicks(ge);var Ae=function(xe){return i.tickText(ge,xe).text},we=F.number.suffix,De=F.number.prefix,Be=oe.select("text.number");function Ve(){var xe=typeof R[0].y=="number"?De+Ae(R[0].y)+we:"-";Be.text(xe).call(t.font,F.number.font).call(o.convertToTspans,I)}return s(Y)?Be.transition().duration(Y.duration).ease(Y.easing).each("end",function(){Ve(),X&&X()}).each("interrupt",function(){Ve(),X&&X()}).attrTween("text",function(){var xe=w.select(this),Le=M(R[0].lastY,R[0].y);F._lastValue=R[0].y;var He=Q(F.number.valueformat,Ae,R[0].lastY,R[0].y);return function(Je){xe.text(De+He(Le(Je))+we)}}):Ve(),se=P(De+Ae(R[0].y)+we,F.number.font,j,I),Be}function Z(){var ge=L(I,{tickformat:F.delta.valueformat},F._range);ge.setScale(),i.prepTicks(ge);var Ae=function(Le){return i.tickText(ge,Le).text},we=function(Le){var He=F.delta.relative?Le.relativeDelta:Le.delta;return He},De=function(Le,He){return Le===0||typeof Le!="number"||isNaN(Le)?"-":(Le>0?F.delta.increasing.symbol:F.delta.decreasing.symbol)+He(Le)},Be=function(Le){return Le.delta>=0?F.delta.increasing.color:F.delta.decreasing.color};F._deltaLastValue===void 0&&(F._deltaLastValue=we(R[0]));var Ve=oe.select("text.delta");Ve.call(t.font,F.delta.font).call(h.fill,Be({delta:F._deltaLastValue}));function xe(){Ve.text(De(we(R[0]),Ae)).call(h.fill,Be(R[0])).call(o.convertToTspans,I)}return s(Y)?Ve.transition().duration(Y.duration).ease(Y.easing).tween("text",function(){var Le=w.select(this),He=we(R[0]),Je=F._deltaLastValue,Oe=Q(F.delta.valueformat,Ae,Je,He),Pe=M(Je,He);return F._deltaLastValue=He,function(Ue){Le.text(De(Pe(Ue),Oe)),Le.call(h.fill,Be({delta:Pe(Ue)}))}}).each("end",function(){xe(),X&&X()}).each("interrupt",function(){xe(),X&&X()}):xe(),ie=P(De(we(R[0]),Ae),F.delta.font,j,I),Ve}var ee=F.mode+F.align,te;if(F._hasDelta&&(te=Z(),ee+=F.delta.position+F.delta.font.size+F.delta.font.family+F.delta.valueformat,ee+=F.delta.increasing.symbol+F.delta.decreasing.symbol,N=ie),F._hasNumber&&(W(),ee+=F.number.font.size+F.number.font.family+F.number.valueformat+F.number.suffix+F.number.prefix,N=se),F._hasDelta&&F._hasNumber){var ae=[(se.left+se.right)/2,(se.top+se.bottom)/2],le=[(ie.left+ie.right)/2,(ie.top+ie.bottom)/2],ye,fe,pe=.75*F.delta.font.size;F.delta.position==="left"&&(ye=z(F,"deltaPos",0,-1*(se.width*u[F.align]+ie.width*(1-u[F.align])+pe),ee,Math.min),fe=ae[1]-le[1],N={width:se.width+ie.width+pe,height:Math.max(se.height,ie.height),left:ie.left+ye,right:se.right,top:Math.min(se.top,ie.top+fe),bottom:Math.max(se.bottom,ie.bottom+fe)}),F.delta.position==="right"&&(ye=z(F,"deltaPos",0,se.width*(1-u[F.align])+ie.width*u[F.align]+pe,ee,Math.max),fe=ae[1]-le[1],N={width:se.width+ie.width+pe,height:Math.max(se.height,ie.height),left:se.left,right:ie.right+ye,top:Math.min(se.top,ie.top+fe),bottom:Math.max(se.bottom,ie.bottom+fe)}),F.delta.position==="bottom"&&(ye=null,fe=ie.height,N={width:Math.max(se.width,ie.width),height:se.height+ie.height,left:Math.min(se.left,ie.left),right:Math.max(se.right,ie.right),top:se.bottom-se.height,bottom:se.bottom+ie.height}),F.delta.position==="top"&&(ye=null,fe=se.top,N={width:Math.max(se.width,ie.width),height:se.height+ie.height,left:Math.min(se.left,ie.left),right:Math.max(se.right,ie.right),top:se.bottom-se.height-ie.height,bottom:se.bottom}),te.attr({dx:ye,dy:fe})}(F._hasNumber||F._hasDelta)&&oe.attr("transform",function(){var ge=B.numbersScaler(N);ee+=ge[2];var Ae=z(F,"numbersScale",1,ge[0],ee,Math.min),we;F._scaleNumbers||(Ae=1),F._isAngular?we=G-Ae*N.bottom:we=G-Ae*(N.top+N.bottom)/2,F._numbersTop=Ae*N.top+we;var De=N[J];J==="center"&&(De=(N.left+N.right)/2);var Be=V-Ae*De;return Be=z(F,"numbersTranslate",0,Be,ee,Math.max),a(Be,we)+e(Ae)})}function b(I){I.each(function(D){h.stroke(w.select(this),D.line.color)}).each(function(D){h.fill(w.select(this),D.color)}).style("stroke-width",function(D){return D.line.width})}function l(I,D,R){return function(){var B=c(D,R);return function(F){return I.endAngle(B(F))()}}}function L(I,D,R){var B=I._fullLayout,F=T.extendFlat({type:"linear",ticks:"outside",range:R,showline:!0},D),V={type:"linear",_id:"x"+D._id},G={letter:"x",font:B.font,noHover:!0,noTickson:!0};function J(j,Y){return T.coerce(F,V,y,j,Y)}return g(F,V,J,G,B),p(F,V,J,G),V}function S(I,D,R){var B=Math.min(D/I.width,R/I.height);return[B,I,D+"x"+R]}function k(I,D){var R=Math.sqrt(I.width/2*(I.width/2)+I.height*I.height),B=D/R;return[B,I,D]}function P(I,D,R,B){var F=document.createElementNS("http://www.w3.org/2000/svg","text"),V=w.select(F);return V.text(I).attr("x",0).attr("y",0).attr("text-anchor",R).attr("data-unformatted",I).call(o.convertToTspans,B).call(t.font,D),t.bBox(V.node())}function z(I,D,R,B,F,V){var G="_cache"+D;I[G]&&I[G].key===F||(I[G]={key:F,value:R});var J=T.aggNums(V,null,[I[G].value,B],2);return I[G].value=J,J}},{"../../components/color":366,"../../components/drawing":388,"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_defaults":556,"../../plots/cartesian/layout_attributes":569,"../../plots/cartesian/position_defaults":572,"./constants":858,"@plotly/d3":58,"d3-interpolate":116}],862:[function(d,re,ne){var w=d("../../components/colorscale/attributes"),c=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,T=d("../mesh3d/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n=d("../../plot_api/edit_types").overrideAll;function r(o){return{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function t(o){return{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}}var f=re.exports=n(a({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:r(),y:r(),z:r()},caps:{x:t(),y:t(),z:t()},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:M(),xhoverformat:c("x"),yhoverformat:c("y"),zhoverformat:c("z"),valuehoverformat:c("value",1),showlegend:a({},e.showlegend,{dflt:!1})},w("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:T.opacity,lightposition:T.lightposition,lighting:T.lighting,flatshading:T.flatshading,contour:T.contour,hoverinfo:a({},e.hoverinfo)}),"calc","nested");f.flatshading.dflt=!0,f.lighting.facenormalsepsilon.dflt=0,f.x.editType=f.y.editType=f.z.editType=f.value.editType="calc+clearAxisTypes",f.transforms=void 0},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../mesh3d/attributes":867}],863:[function(d,re,ne){var w=d("../../components/colorscale/calc"),c=d("../streamtube/calc").processGrid,M=d("../streamtube/calc").filter;re.exports=function(e,a){a._len=Math.min(a.x.length,a.y.length,a.z.length,a.value.length),a._x=M(a.x,a._len),a._y=M(a.y,a._len),a._z=M(a.z,a._len),a._value=M(a.value,a._len);var n=c(a);a._gridFill=n.fill,a._Xs=n.Xs,a._Ys=n.Ys,a._Zs=n.Zs,a._len=n.len;for(var r=1/0,t=-1/0,f=0;f<a._len;f++){var o=a._value[f];r=Math.min(r,o),t=Math.max(t,o)}a._minValues=r,a._maxValues=t,a._vMin=a.isomin===void 0||a.isomin===null?r:a.isomin,a._vMax=a.isomax===void 0||a.isomin===null?t:a.isomax,w(e,a,{vals:[a._vMin,a._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374,"../streamtube/calc":1045}],864:[function(d,re,ne){var w=d("../../../stackgl_modules").gl_mesh3d,c=d("../../lib/gl_format_color").parseColorScale,M=d("../../lib/str2rgbarray"),T=d("../../components/colorscale").extractOpts,e=d("../../plots/gl3d/zip3"),a=function(i,g){for(var p=g.length-1;p>0;p--){var y=Math.min(g[p],g[p-1]),h=Math.max(g[p],g[p-1]);if(h>y&&y<i&&i<=h)return{id:p,distRatio:(h-i)/(h-y)}}return{id:0,distRatio:0}};function n(i,g,p){this.scene=i,this.uid=p,this.mesh=g,this.name="",this.data=null,this.showContour=!1}var r=n.prototype;r.handlePick=function(i){if(i.object===this.mesh){var g=i.data.index,p=this.data._meshX[g],y=this.data._meshY[g],h=this.data._meshZ[g],m=this.data._Ys.length,u=this.data._Zs.length,_=a(p,this.data._Xs).id,s=a(y,this.data._Ys).id,A=a(h,this.data._Zs).id,x=i.index=A+u*s+u*m*_;i.traceCoordinate=[this.data._meshX[x],this.data._meshY[x],this.data._meshZ[x],this.data._value[x]];var v=this.data.hovertext||this.data.text;return Array.isArray(v)&&v[x]!==void 0?i.textLabel=v[x]:v&&(i.textLabel=v),!0}},r.update=function(i){var g=this.scene,p=g.fullSceneLayout;this.data=f(i);function y(s,A,x,v){return A.map(function(b){return s.d2l(b,0,v)*x})}var h=e(y(p.xaxis,i._meshX,g.dataScale[0],i.xcalendar),y(p.yaxis,i._meshY,g.dataScale[1],i.ycalendar),y(p.zaxis,i._meshZ,g.dataScale[2],i.zcalendar)),m=e(i._meshI,i._meshJ,i._meshK),u={positions:h,cells:m,lightPosition:[i.lightposition.x,i.lightposition.y,i.lightposition.z],ambient:i.lighting.ambient,diffuse:i.lighting.diffuse,specular:i.lighting.specular,roughness:i.lighting.roughness,fresnel:i.lighting.fresnel,vertexNormalsEpsilon:i.lighting.vertexnormalsepsilon,faceNormalsEpsilon:i.lighting.facenormalsepsilon,opacity:i.opacity,contourEnable:i.contour.show,contourColor:M(i.contour.color).slice(0,3),contourWidth:i.contour.width,useFacetNormals:i.flatshading},_=T(i);u.vertexIntensity=i._meshIntensity,u.vertexIntensityBounds=[_.min,_.max],u.colormap=c(i),this.mesh.update(u)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var t=["xyz","xzy","yxz","yzx","zxy","zyx"];function f(i){i._meshI=[],i._meshJ=[],i._meshK=[];var g=i.surface.show,p=i.spaceframe.show,y=i.surface.fill,h=i.spaceframe.fill,m=!1,u=!1,_=0,s,A,x=i._Xs,v=i._Ys,b=i._Zs,l=x.length,L=v.length,S=b.length,k=t.indexOf(i._gridFill.replace(/-/g,"").replace(/\+/g,"")),P=function(Mt,Tt,at){switch(k){case 5:return at+S*Tt+S*L*Mt;case 4:return at+S*Mt+S*l*Tt;case 3:return Tt+L*at+L*S*Mt;case 2:return Tt+L*Mt+L*l*at;case 1:return Mt+l*at+l*S*Tt;default:return Mt+l*Tt+l*L*at}},z=i._minValues,I=i._maxValues,D=i._vMin,R=i._vMax,B,F,V,G;function J(Mt,Tt,at){for(var ct=G.length,je=A;je<ct;je++)if(Mt===B[je]&&Tt===F[je]&&at===V[je])return je;return-1}function j(){A=s}function Y(){B=[],F=[],V=[],G=[],s=0,j()}function X(Mt,Tt,at,ct){return B.push(Mt),F.push(Tt),V.push(at),G.push(ct),s++,s-1}function oe(Mt,Tt,at){return i._meshI.push(Mt),i._meshJ.push(Tt),i._meshK.push(at),_++,_-1}function se(Mt,Tt,at){for(var ct=[],je=0;je<Mt.length;je++)ct[je]=(Mt[je]+Tt[je]+at[je])/3;return ct}function ie(Mt,Tt,at){for(var ct=[],je=0;je<Mt.length;je++)ct[je]=Mt[je]*(1-at)+at*Tt[je];return ct}var N;function U(Mt){N=Mt}function q(Mt,Tt){var at=Mt[0],ct=Mt[1],je=Mt[2],ke=se(at,ct,je),Ye=Math.sqrt(1-N),Ke=ie(ke,at,Ye),st=ie(ke,ct,Ye),Et=ie(ke,je,Ye),bt=Tt[0],zt=Tt[1],$t=Tt[2];return{xyzv:[[at,ct,st],[st,Ke,at],[ct,je,Et],[Et,st,ct],[je,at,Ke],[Ke,Et,je]],abc:[[bt,zt,-1],[-1,-1,bt],[zt,$t,-1],[-1,-1,zt],[$t,bt,-1],[-1,-1,$t]]}}function Q(Mt,Tt){return Mt==="all"||Mt===null?!0:Mt.indexOf(Tt)>-1}function W(Mt,Tt){return Mt===null?Tt:Mt}function Z(Mt,Tt,at){j();var ct=[Tt],je=[at];if(N>=1)ct=[Tt],je=[at];else if(N>0){var ke=q(Tt,at);ct=ke.xyzv,je=ke.abc}for(var Ye=0;Ye<ct.length;Ye++){Tt=ct[Ye],at=je[Ye];for(var Ke=[],st=0;st<3;st++){var Et=Tt[st][0],bt=Tt[st][1],zt=Tt[st][2],$t=Tt[st][3],Ot=at[st]>-1?at[st]:J(Et,bt,zt);Ot>-1?Ke[st]=Ot:Ke[st]=X(Et,bt,zt,W(Mt,$t))}oe(Ke[0],Ke[1],Ke[2])}}function ee(Mt,Tt,at){var ct=function(je,ke,Ye){Z(Mt,[Tt[je],Tt[ke],Tt[Ye]],[at[je],at[ke],at[Ye]])};ct(0,1,2),ct(2,3,0)}function te(Mt,Tt,at){var ct=function(je,ke,Ye){Z(Mt,[Tt[je],Tt[ke],Tt[Ye]],[at[je],at[ke],at[Ye]])};ct(0,1,2),ct(3,0,1),ct(2,3,0),ct(1,2,3)}function ae(Mt,Tt,at,ct){var je=Mt[3];je<at&&(je=at),je>ct&&(je=ct);for(var ke=(Mt[3]-je)/(Mt[3]-Tt[3]+1e-9),Ye=[],Ke=0;Ke<4;Ke++)Ye[Ke]=(1-ke)*Mt[Ke]+ke*Tt[Ke];return Ye}function le(Mt,Tt,at){return Mt>=Tt&&Mt<=at}function ye(Mt){var Tt=.001*(R-D);return Mt>=D-Tt&&Mt<=R+Tt}function fe(Mt){for(var Tt=[],at=0;at<4;at++){var ct=Mt[at];Tt.push([i._x[ct],i._y[ct],i._z[ct],i._value[ct]])}return Tt}var pe=3;function ge(Mt,Tt,at,ct,je,ke){ke||(ke=1),at=[-1,-1,-1];var Ye=!1,Ke=[le(Tt[0][3],ct,je),le(Tt[1][3],ct,je),le(Tt[2][3],ct,je)];if(!Ke[0]&&!Ke[1]&&!Ke[2])return!1;var st=function(bt,zt,$t){return ye(zt[0][3])&&ye(zt[1][3])&&ye(zt[2][3])?(Z(bt,zt,$t),!0):ke<pe?ge(bt,zt,$t,D,R,++ke):!1};if(Ke[0]&&Ke[1]&&Ke[2])return st(Mt,Tt,at)||Ye;var Et=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(bt){if(Ke[bt[0]]&&Ke[bt[1]]&&!Ke[bt[2]]){var zt=Tt[bt[0]],$t=Tt[bt[1]],Ot=Tt[bt[2]],Qt=ae(Ot,zt,ct,je),tr=ae(Ot,$t,ct,je);Ye=st(Mt,[tr,Qt,zt],[-1,-1,at[bt[0]]])||Ye,Ye=st(Mt,[zt,$t,tr],[at[bt[0]],at[bt[1]],-1])||Ye,Et=!0}}),Et||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(bt){if(Ke[bt[0]]&&!Ke[bt[1]]&&!Ke[bt[2]]){var zt=Tt[bt[0]],$t=Tt[bt[1]],Ot=Tt[bt[2]],Qt=ae($t,zt,ct,je),tr=ae(Ot,zt,ct,je);Ye=st(Mt,[tr,Qt,zt],[-1,-1,at[bt[0]]])||Ye,Et=!0}}),Ye}function Ae(Mt,Tt,at,ct){var je=!1,ke=fe(Tt),Ye=[le(ke[0][3],at,ct),le(ke[1][3],at,ct),le(ke[2][3],at,ct),le(ke[3][3],at,ct)];if(!Ye[0]&&!Ye[1]&&!Ye[2]&&!Ye[3])return je;if(Ye[0]&&Ye[1]&&Ye[2]&&Ye[3])return u&&(je=te(Mt,ke,Tt)||je),je;var Ke=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(st){if(Ye[st[0]]&&Ye[st[1]]&&Ye[st[2]]&&!Ye[st[3]]){var Et=ke[st[0]],bt=ke[st[1]],zt=ke[st[2]],$t=ke[st[3]];if(u)je=Z(Mt,[Et,bt,zt],[Tt[st[0]],Tt[st[1]],Tt[st[2]]])||je;else{var Ot=ae($t,Et,at,ct),Qt=ae($t,bt,at,ct),tr=ae($t,zt,at,ct);je=Z(null,[Ot,Qt,tr],[-1,-1,-1])||je}Ke=!0}}),Ke||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(st){if(Ye[st[0]]&&Ye[st[1]]&&!Ye[st[2]]&&!Ye[st[3]]){var Et=ke[st[0]],bt=ke[st[1]],zt=ke[st[2]],$t=ke[st[3]],Ot=ae(zt,Et,at,ct),Qt=ae(zt,bt,at,ct),tr=ae($t,bt,at,ct),qt=ae($t,Et,at,ct);u?(je=Z(Mt,[Et,qt,Ot],[Tt[st[0]],-1,-1])||je,je=Z(Mt,[bt,Qt,tr],[Tt[st[1]],-1,-1])||je):je=ee(null,[Ot,Qt,tr,qt],[-1,-1,-1,-1])||je,Ke=!0}}),Ke)||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(st){if(Ye[st[0]]&&!Ye[st[1]]&&!Ye[st[2]]&&!Ye[st[3]]){var Et=ke[st[0]],bt=ke[st[1]],zt=ke[st[2]],$t=ke[st[3]],Ot=ae(bt,Et,at,ct),Qt=ae(zt,Et,at,ct),tr=ae($t,Et,at,ct);u?(je=Z(Mt,[Et,Ot,Qt],[Tt[st[0]],-1,-1])||je,je=Z(Mt,[Et,Qt,tr],[Tt[st[0]],-1,-1])||je,je=Z(Mt,[Et,tr,Ot],[Tt[st[0]],-1,-1])||je):je=Z(null,[Ot,Qt,tr],[-1,-1,-1])||je,Ke=!0}}),je}function we(Mt,Tt,at,ct,je,ke,Ye,Ke,st,Et,bt){var zt=!1;return m&&(Q(Mt,"A")&&(zt=Ae(null,[Tt,at,ct,ke],Et,bt)||zt),Q(Mt,"B")&&(zt=Ae(null,[at,ct,je,st],Et,bt)||zt),Q(Mt,"C")&&(zt=Ae(null,[at,ke,Ye,st],Et,bt)||zt),Q(Mt,"D")&&(zt=Ae(null,[ct,ke,Ke,st],Et,bt)||zt),Q(Mt,"E")&&(zt=Ae(null,[at,ct,ke,st],Et,bt)||zt)),u&&(zt=Ae(Mt,[at,ct,ke,st],Et,bt)||zt),zt}function De(Mt,Tt,at,ct,je,ke,Ye,Ke){return[Ke[0]===!0?!0:ge(Mt,fe([Tt,at,ct]),[Tt,at,ct],ke,Ye),Ke[1]===!0?!0:ge(Mt,fe([ct,je,Tt]),[ct,je,Tt],ke,Ye)]}function Be(Mt,Tt,at,ct,je,ke,Ye,Ke,st){return Ke?De(Mt,Tt,at,je,ct,ke,Ye,st):De(Mt,at,je,ct,Tt,ke,Ye,st)}function Ve(Mt,Tt,at,ct,je,ke,Ye){var Ke=!1,st,Et,bt,zt,$t=function(){Ke=ge(Mt,[st,Et,bt],[-1,-1,-1],je,ke)||Ke,Ke=ge(Mt,[bt,zt,st],[-1,-1,-1],je,ke)||Ke},Ot=Ye[0],Qt=Ye[1],tr=Ye[2];return Ot&&(st=ie(fe([P(Tt,at-0,ct-0)])[0],fe([P(Tt-1,at-0,ct-0)])[0],Ot),Et=ie(fe([P(Tt,at-0,ct-1)])[0],fe([P(Tt-1,at-0,ct-1)])[0],Ot),bt=ie(fe([P(Tt,at-1,ct-1)])[0],fe([P(Tt-1,at-1,ct-1)])[0],Ot),zt=ie(fe([P(Tt,at-1,ct-0)])[0],fe([P(Tt-1,at-1,ct-0)])[0],Ot),$t()),Qt&&(st=ie(fe([P(Tt-0,at,ct-0)])[0],fe([P(Tt-0,at-1,ct-0)])[0],Qt),Et=ie(fe([P(Tt-0,at,ct-1)])[0],fe([P(Tt-0,at-1,ct-1)])[0],Qt),bt=ie(fe([P(Tt-1,at,ct-1)])[0],fe([P(Tt-1,at-1,ct-1)])[0],Qt),zt=ie(fe([P(Tt-1,at,ct-0)])[0],fe([P(Tt-1,at-1,ct-0)])[0],Qt),$t()),tr&&(st=ie(fe([P(Tt-0,at-0,ct)])[0],fe([P(Tt-0,at-0,ct-1)])[0],tr),Et=ie(fe([P(Tt-0,at-1,ct)])[0],fe([P(Tt-0,at-1,ct-1)])[0],tr),bt=ie(fe([P(Tt-1,at-1,ct)])[0],fe([P(Tt-1,at-1,ct-1)])[0],tr),zt=ie(fe([P(Tt-1,at-0,ct)])[0],fe([P(Tt-1,at-0,ct-1)])[0],tr),$t()),Ke}function xe(Mt,Tt,at,ct,je,ke,Ye,Ke,st,Et,bt,zt){var $t=Mt;return zt?(m&&Mt==="even"&&($t=null),we($t,Tt,at,ct,je,ke,Ye,Ke,st,Et,bt)):(m&&Mt==="odd"&&($t=null),we($t,st,Ke,Ye,ke,je,ct,at,Tt,Et,bt))}function Le(Mt,Tt,at,ct,je){for(var ke=[],Ye=0,Ke=0;Ke<Tt.length;Ke++)for(var st=Tt[Ke],Et=1;Et<S;Et++)for(var bt=1;bt<L;bt++)ke.push(Be(Mt,P(st,bt-1,Et-1),P(st,bt-1,Et),P(st,bt,Et-1),P(st,bt,Et),at,ct,(st+bt+Et)%2,je&&je[Ye]?je[Ye]:[])),Ye++;return ke}function He(Mt,Tt,at,ct,je){for(var ke=[],Ye=0,Ke=0;Ke<Tt.length;Ke++)for(var st=Tt[Ke],Et=1;Et<l;Et++)for(var bt=1;bt<S;bt++)ke.push(Be(Mt,P(Et-1,st,bt-1),P(Et,st,bt-1),P(Et-1,st,bt),P(Et,st,bt),at,ct,(Et+st+bt)%2,je&&je[Ye]?je[Ye]:[])),Ye++;return ke}function Je(Mt,Tt,at,ct,je){for(var ke=[],Ye=0,Ke=0;Ke<Tt.length;Ke++)for(var st=Tt[Ke],Et=1;Et<L;Et++)for(var bt=1;bt<l;bt++)ke.push(Be(Mt,P(bt-1,Et-1,st),P(bt-1,Et,st),P(bt,Et-1,st),P(bt,Et,st),at,ct,(bt+Et+st)%2,je&&je[Ye]?je[Ye]:[])),Ye++;return ke}function Oe(Mt,Tt,at){for(var ct=1;ct<S;ct++)for(var je=1;je<L;je++)for(var ke=1;ke<l;ke++)xe(Mt,P(ke-1,je-1,ct-1),P(ke-1,je-1,ct),P(ke-1,je,ct-1),P(ke-1,je,ct),P(ke,je-1,ct-1),P(ke,je-1,ct),P(ke,je,ct-1),P(ke,je,ct),Tt,at,(ke+je+ct)%2)}function Pe(Mt,Tt,at){u=!0,Oe(Mt,Tt,at),u=!1}function Ue(Mt,Tt,at){m=!0,Oe(Mt,Tt,at),m=!1}function vt(Mt,Tt,at,ct,je,ke){for(var Ye=[],Ke=0,st=0;st<Tt.length;st++)for(var Et=Tt[st],bt=1;bt<S;bt++)for(var zt=1;zt<L;zt++)Ye.push(Ve(Mt,Et,zt,bt,at,ct,je[st],ke&&ke[Ke]?ke[Ke]:[])),Ke++;return Ye}function Lt(Mt,Tt,at,ct,je,ke){for(var Ye=[],Ke=0,st=0;st<Tt.length;st++)for(var Et=Tt[st],bt=1;bt<l;bt++)for(var zt=1;zt<S;zt++)Ye.push(Ve(Mt,bt,Et,zt,at,ct,je[st],ke&&ke[Ke]?ke[Ke]:[])),Ke++;return Ye}function Yt(Mt,Tt,at,ct,je,ke){for(var Ye=[],Ke=0,st=0;st<Tt.length;st++)for(var Et=Tt[st],bt=1;bt<L;bt++)for(var zt=1;zt<l;zt++)Ye.push(Ve(Mt,zt,bt,Et,at,ct,je[st],ke&&ke[Ke]?ke[Ke]:[])),Ke++;return Ye}function At(Mt,Tt){for(var at=[],ct=Mt;ct<Tt;ct++)at.push(ct);return at}function Rt(){for(var Mt=0;Mt<l;Mt++)for(var Tt=0;Tt<L;Tt++)for(var at=0;at<S;at++){var ct=P(Mt,Tt,at);X(i._x[ct],i._y[ct],i._z[ct],i._value[ct])}}function Bt(){Y(),Rt();var Mt=null;if(p&&h&&(U(h),Pe(Mt,D,R)),g&&y){U(y);for(var Tt=i.surface.pattern,at=i.surface.count,ct=0;ct<at;ct++){var je=at===1?.5:ct/(at-1),ke=(1-je)*D+je*R,Ye=Math.abs(ke-z),Ke=Math.abs(ke-I),st=Ye>Ke?[z,ke]:[ke,I];Ue(Tt,st[0],st[1])}}var Et=[[Math.min(D,I),Math.max(D,I)],[Math.min(z,R),Math.max(z,R)]];["x","y","z"].forEach(function(bt){for(var zt=[],$t=0;$t<Et.length;$t++){var Ot=0,Qt=Et[$t][0],tr=Et[$t][1],qt=i.slices[bt];if(qt.show&&qt.fill){U(qt.fill);var lr=[],Wr=[],cn=[];if(qt.locations.length)for(var Jr=0;Jr<qt.locations.length;Jr++){var ot=a(qt.locations[Jr],bt==="x"?x:bt==="y"?v:b);ot.distRatio===0?lr.push(ot.id):ot.id>0&&(Wr.push(ot.id),bt==="x"?cn.push([ot.distRatio,0,0]):bt==="y"?cn.push([0,ot.distRatio,0]):cn.push([0,0,ot.distRatio]))}else bt==="x"?lr=At(1,l-1):bt==="y"?lr=At(1,L-1):lr=At(1,S-1);Wr.length>0&&(bt==="x"?zt[Ot]=vt(Mt,Wr,Qt,tr,cn,zt[Ot]):bt==="y"?zt[Ot]=Lt(Mt,Wr,Qt,tr,cn,zt[Ot]):zt[Ot]=Yt(Mt,Wr,Qt,tr,cn,zt[Ot]),Ot++),lr.length>0&&(bt==="x"?zt[Ot]=Le(Mt,lr,Qt,tr,zt[Ot]):bt==="y"?zt[Ot]=He(Mt,lr,Qt,tr,zt[Ot]):zt[Ot]=Je(Mt,lr,Qt,tr,zt[Ot]),Ot++)}var Vt=i.caps[bt];Vt.show&&Vt.fill&&(U(Vt.fill),bt==="x"?zt[Ot]=Le(Mt,[0,l-1],Qt,tr,zt[Ot]):bt==="y"?zt[Ot]=He(Mt,[0,L-1],Qt,tr,zt[Ot]):zt[Ot]=Je(Mt,[0,S-1],Qt,tr,zt[Ot]),Ot++)}}),_===0&&Y(),i._meshX=B,i._meshY=F,i._meshZ=V,i._meshIntensity=G,i._Xs=x,i._Ys=v,i._Zs=b}return Bt(),i}function o(i,g){var p=i.glplot.gl,y=w({gl:p}),h=new n(i,y,g.uid);return y._trace=h,h.update(g),i.glplot.add(y),h}re.exports={findNearestOnAxis:a,generateIsoMeshes:f,createIsosurfaceTrace:o}},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/gl3d/zip3":609}],865:[function(d,re,ne){var w=d("../../lib"),c=d("../../registry"),M=d("./attributes"),T=d("../../components/colorscale/defaults");function e(n,r,t,f){function o(i,g){return w.coerce(n,r,M,i,g)}a(n,r,t,f,o)}function a(n,r,t,f,o){var i=o("isomin"),g=o("isomax");g!=null&&i!==void 0&&i!==null&&i>g&&(r.isomin=null,r.isomax=null);var p=o("x"),y=o("y"),h=o("z"),m=o("value");if(!p||!p.length||!y||!y.length||!h||!h.length||!m||!m.length){r.visible=!1;return}var u=c.getComponentMethod("calendars","handleTraceDefaults");u(n,r,["x","y","z"],f),o("valuehoverformat"),["x","y","z"].forEach(function(x){o(x+"hoverformat");var v="caps."+x,b=o(v+".show");b&&o(v+".fill");var l="slices."+x,L=o(l+".show");L&&(o(l+".fill"),o(l+".locations"))});var _=o("spaceframe.show");_&&o("spaceframe.fill");var s=o("surface.show");s&&(o("surface.count"),o("surface.fill"),o("surface.pattern"));var A=o("contour.show");A&&(o("contour.color"),o("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(x){o(x)}),T(n,r,f,o,{prefix:"",cLetter:"c"}),r._length=null}re.exports={supplyDefaults:e,supplyIsoDefaults:a}},{"../../components/colorscale/defaults":376,"../../lib":503,"../../registry":638,"./attributes":862}],866:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,calc:d("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:d("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":598,"./attributes":862,"./calc":863,"./convert":864,"./defaults":865}],867:[function(d,re,ne){var w=d("../../components/colorscale/attributes"),c=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,T=d("../surface/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat;re.exports=a({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:M({editType:"calc"}),xhoverformat:c("x"),yhoverformat:c("y"),zhoverformat:c("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},w("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:T.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:a({},T.contours.x.show,{}),color:T.contours.x.color,width:T.contours.x.width,editType:"calc"},lightposition:{x:a({},T.lightposition.x,{dflt:1e5}),y:a({},T.lightposition.y,{dflt:1e5}),z:a({},T.lightposition.z,{dflt:0}),editType:"calc"},lighting:a({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},T.lighting),hoverinfo:a({},e.hoverinfo,{editType:"calc"}),showlegend:a({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../surface/attributes":1061}],868:[function(d,re,ne){var w=d("../../components/colorscale/calc");re.exports=function(M,T){T.intensity&&w(M,T,{vals:T.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374}],869:[function(d,re,ne){var w=d("../../../stackgl_modules").gl_mesh3d,c=d("../../../stackgl_modules").delaunay_triangulate,M=d("../../../stackgl_modules").alpha_shape,T=d("../../../stackgl_modules").convex_hull,e=d("../../lib/gl_format_color").parseColorScale,a=d("../../lib/str2rgbarray"),n=d("../../components/colorscale").extractOpts,r=d("../../plots/gl3d/zip3");function t(m,u,_){this.scene=m,this.uid=_,this.mesh=u,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var f=t.prototype;f.handlePick=function(m){if(m.object===this.mesh){var u=m.index=m.data.index;m.data._cellCenter?m.traceCoordinate=m.data.dataCoordinate:m.traceCoordinate=[this.data.x[u],this.data.y[u],this.data.z[u]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[u]!==void 0?m.textLabel=_[u]:_&&(m.textLabel=_),!0}};function o(m){for(var u=[],_=m.length,s=0;s<_;s++)u[s]=a(m[s]);return u}function i(m,u,_,s){for(var A=[],x=u.length,v=0;v<x;v++)A[v]=m.d2l(u[v],0,s)*_;return A}function g(m){for(var u=[],_=m.length,s=0;s<_;s++)u[s]=Math.round(m[s]);return u}function p(m,u){for(var _=["x","y","z"].indexOf(m),s=[],A=u.length,x=0;x<A;x++)s[x]=[u[x][(_+1)%3],u[x][(_+2)%3]];return c(s)}function y(m,u){for(var _=m.length,s=0;s<_;s++)if(m[s]<=-.5||m[s]>=u-.5)return!1;return!0}f.update=function(m){var u=this.scene,_=u.fullSceneLayout;this.data=m;var s=m.x.length,A=r(i(_.xaxis,m.x,u.dataScale[0],m.xcalendar),i(_.yaxis,m.y,u.dataScale[1],m.ycalendar),i(_.zaxis,m.z,u.dataScale[2],m.zcalendar)),x;if(m.i&&m.j&&m.k){if(m.i.length!==m.j.length||m.j.length!==m.k.length||!y(m.i,s)||!y(m.j,s)||!y(m.k,s))return;x=r(g(m.i),g(m.j),g(m.k))}else m.alphahull===0?x=T(A):m.alphahull>0?x=M(m.alphahull,A):x=p(m.delaunayaxis,A);var v={positions:A,cells:x,lightPosition:[m.lightposition.x,m.lightposition.y,m.lightposition.z],ambient:m.lighting.ambient,diffuse:m.lighting.diffuse,specular:m.lighting.specular,roughness:m.lighting.roughness,fresnel:m.lighting.fresnel,vertexNormalsEpsilon:m.lighting.vertexnormalsepsilon,faceNormalsEpsilon:m.lighting.facenormalsepsilon,opacity:m.opacity,contourEnable:m.contour.show,contourColor:a(m.contour.color).slice(0,3),contourWidth:m.contour.width,useFacetNormals:m.flatshading};if(m.intensity){var b=n(m);this.color="#fff";var l=m.intensitymode;v[l+"Intensity"]=m.intensity,v[l+"IntensityBounds"]=[b.min,b.max],v.colormap=e(m)}else m.vertexcolor?(this.color=m.vertexcolor[0],v.vertexColors=o(m.vertexcolor)):m.facecolor?(this.color=m.facecolor[0],v.cellColors=o(m.facecolor)):(this.color=m.color,v.meshColor=a(m.color));this.mesh.update(v)},f.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function h(m,u){var _=m.glplot.gl,s=w({gl:_}),A=new t(m,s,u.uid);return s._trace=A,A.update(u),m.glplot.add(s),A}re.exports=h},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/gl3d/zip3":609}],870:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib"),M=d("../../components/colorscale/defaults"),T=d("./attributes");re.exports=function(a,n,r,t){function f(y,h){return c.coerce(a,n,T,y,h)}function o(y){var h=y.map(function(m){var u=f(m);return u&&c.isArrayOrTypedArray(u)?u:null});return h.every(function(m){return m&&m.length===h[0].length})&&h}var i=o(["x","y","z"]);if(!i){n.visible=!1;return}if(o(["i","j","k"]),n.i&&(!n.j||!n.k)||n.j&&(!n.k||!n.i)||n.k&&(!n.i||!n.j)){n.visible=!1;return}var g=w.getComponentMethod("calendars","handleTraceDefaults");g(a,n,["x","y","z"],t),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(y){f(y)});var p=f("contour.show");p&&(f("contour.color"),f("contour.width")),"intensity"in a?(f("intensity"),f("intensitymode"),M(a,n,t,f,{prefix:"",cLetter:"c"})):(n.showscale=!1,"facecolor"in a?f("facecolor"):"vertexcolor"in a?f("vertexcolor"):f("color",r)),f("text"),f("hovertext"),f("hovertemplate"),f("xhoverformat"),f("yhoverformat"),f("zhoverformat"),n._length=null}},{"../../components/colorscale/defaults":376,"../../lib":503,"../../registry":638,"./attributes":867}],871:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:d("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":598,"./attributes":867,"./calc":868,"./convert":869,"./defaults":870}],872:[function(d,re,ne){var w=d("../../lib").extendFlat,c=d("../scatter/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,T=d("../../components/drawing/attributes").dash,e=d("../../components/fx/attributes"),a=d("../../constants/delta.js"),n=a.INCREASING.COLOR,r=a.DECREASING.COLOR,t=c.line;function f(o){return{line:{color:w({},t.color,{dflt:o}),width:t.width,dash:T,editType:"style"},editType:"style"}}re.exports={xperiod:c.xperiod,xperiod0:c.xperiod0,xperiodalignment:c.xperiodalignment,xhoverformat:M("x"),yhoverformat:M("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:w({},t.width,{}),dash:w({},T,{}),editType:"style"},increasing:f(n),decreasing:f(r),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:w({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":387,"../../components/fx/attributes":397,"../../constants/delta.js":473,"../../lib":503,"../../plots/cartesian/axis_format_attributes":557,"../scatter/attributes":927}],873:[function(d,re,ne){var w=d("../../lib"),c=w._,M=d("../../plots/cartesian/axes"),T=d("../../plots/cartesian/align_period"),e=d("../../constants/numerical").BADNUM;function a(f,o){var i=M.getFromId(f,o.xaxis),g=M.getFromId(f,o.yaxis),p=t(f,i,o),y=o._minDiff;o._minDiff=null;var h=o._origX;o._origX=null;var m=o._xcalc;o._xcalc=null;var u=r(f,o,h,m,g,n);return o._extremes[i._id]=M.findExtremes(i,m,{vpad:y/2}),u.length?(w.extendFlat(u[0].t,{wHover:y/2,tickLen:p}),u):[{t:{empty:!0}}]}function n(f,o,i,g){return{o:f,h:o,l:i,c:g}}function r(f,o,i,g,p,y){for(var h=p.makeCalcdata(o,"open"),m=p.makeCalcdata(o,"high"),u=p.makeCalcdata(o,"low"),_=p.makeCalcdata(o,"close"),s=Array.isArray(o.text),A=Array.isArray(o.hovertext),x=!0,v=null,b=!!o.xperiodalignment,l=[],L=0;L<g.length;L++){var S=g[L],k=h[L],P=m[L],z=u[L],I=_[L];if(S!==e&&k!==e&&P!==e&&z!==e&&I!==e){I===k?v!==null&&I!==v&&(x=I>v):x=I>k,v=I;var D=y(k,P,z,I);D.pos=S,D.yc=(k+I)/2,D.i=L,D.dir=x?"increasing":"decreasing",D.x=D.pos,D.y=[z,P],b&&(D.orig_p=i[L]),s&&(D.tx=o.text[L]),A&&(D.htx=o.hovertext[L]),l.push(D)}else l.push({pos:S,empty:!0})}return o._extremes[p._id]=M.findExtremes(p,w.concat(u,m),{padded:!0}),l.length&&(l[0].t={labels:{open:c(f,"open:")+" ",high:c(f,"high:")+" ",low:c(f,"low:")+" ",close:c(f,"close:")+" "}}),l}function t(f,o,i){var g=i._minDiff;if(!g){var p=f._fullData,y=[];g=1/0;var h;for(h=0;h<p.length;h++){var m=p[h];if(m.type==="ohlc"&&m.visible===!0&&m.xaxis===o._id){y.push(m);var u=o.makeCalcdata(m,"x");m._origX=u;var _=T(i,o,"x",u).vals;m._xcalc=_;var s=w.distinctVals(_).minDiff;s&&isFinite(s)&&(g=Math.min(g,s))}}for(g===1/0&&(g=1),h=0;h<y.length;h++)y[h]._minDiff=g}return g*i.tickwidth}re.exports={calc:a,calcCommon:r}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554}],874:[function(d,re,ne){var w=d("../../lib"),c=d("./ohlc_defaults"),M=d("../scatter/period_defaults"),T=d("./attributes");re.exports=function(n,r,t,f){function o(g,p){return w.coerce(n,r,T,g,p)}var i=c(n,r,o,f);if(!i){r.visible=!1;return}M(n,r,f,o,{x:!0}),o("xhoverformat"),o("yhoverformat"),o("line.width"),o("line.dash"),e(n,r,o,"increasing"),e(n,r,o,"decreasing"),o("text"),o("hovertext"),o("tickwidth"),f._requestRangeslider[r.xaxis]=!0};function e(a,n,r,t){r(t+".line.color"),r(t+".line.width",n.line.width),r(t+".line.dash",n.line.dash)}},{"../../lib":503,"../scatter/period_defaults":947,"./attributes":872,"./ohlc_defaults":877}],875:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("../../lib"),M=d("../../components/fx"),T=d("../../components/color"),e=d("../../lib").fillText,a=d("../../constants/delta.js"),n={increasing:a.INCREASING.SYMBOL,decreasing:a.DECREASING.SYMBOL};function r(i,g,p,y){var h=i.cd,m=h[0].trace;return m.hoverlabel.split?f(i,g,p,y):o(i,g,p,y)}function t(i,g,p,y){var h=i.cd,m=i.xa,u=h[0].trace,_=h[0].t,s=u.type,A=s==="ohlc"?"l":"min",x=s==="ohlc"?"h":"max",v,b,l=_.bPos||0,L=function(J){return J.pos+l-g},S=_.bdPos||_.tickLen,k=_.wHover,P=Math.min(1,S/Math.abs(m.r2c(m.range[1])-m.r2c(m.range[0])));v=i.maxHoverDistance-P,b=i.maxSpikeDistance-P;function z(J){var j=L(J);return M.inbox(j-k,j+k,v)}function I(J){var j=J[A],Y=J[x];return j===Y||M.inbox(j-p,Y-p,v)}function D(J){return(z(J)+I(J))/2}var R=M.getDistanceFunction(y,z,I,D);if(M.getClosest(h,R,i),i.index===!1)return null;var B=h[i.index];if(B.empty)return null;var F=B.dir,V=u[F],G=V.line.color;return T.opacity(G)&&V.line.width?i.color=G:i.color=V.fillcolor,i.x0=m.c2p(B.pos+l-S,!0),i.x1=m.c2p(B.pos+l+S,!0),i.xLabelVal=B.orig_p!==void 0?B.orig_p:B.pos,i.spikeDistance=D(B)*b/v,i.xSpike=m.c2p(B.pos,!0),i}function f(i,g,p,y){var h=i.cd,m=i.ya,u=h[0].trace,_=h[0].t,s=[],A=t(i,g,p,y);if(!A)return[];var x=A.index,v=h[x],b=v.hi||u.hoverinfo,l=b.split("+"),L=b==="all",S=L||l.indexOf("y")!==-1;if(!S)return[];for(var k=["high","open","close","low"],P={},z=0;z<k.length;z++){var I=k[z],D=u[I][A.index],R=m.c2p(D,!0),B;D in P?(B=P[D],B.yLabel+="<br>"+_.labels[I]+w.hoverLabelText(m,D,u.yhoverformat)):(B=c.extendFlat({},A),B.y0=B.y1=R,B.yLabelVal=D,B.yLabel=_.labels[I]+w.hoverLabelText(m,D,u.yhoverformat),B.name="",s.push(B),P[D]=B)}return s}function o(i,g,p,y){var h=i.cd,m=i.ya,u=h[0].trace,_=h[0].t,s=t(i,g,p,y);if(!s)return[];var A=s.index,x=h[A],v=s.index=x.i,b=x.dir;function l(D){return _.labels[D]+w.hoverLabelText(m,u[D][v],u.yhoverformat)}var L=x.hi||u.hoverinfo,S=L.split("+"),k=L==="all",P=k||S.indexOf("y")!==-1,z=k||S.indexOf("text")!==-1,I=P?[l("open"),l("high"),l("low"),l("close")+"  "+n[b]]:[];return z&&e(x,u,I),s.extraText=I.join("<br>"),s.y0=s.y1=m.c2p(x.yc,!0),[s]}re.exports={hoverPoints:r,hoverSplit:f,hoverOnPoints:o}},{"../../components/color":366,"../../components/fx":406,"../../constants/delta.js":473,"../../lib":503,"../../plots/cartesian/axes":554}],876:[function(d,re,ne){re.exports={moduleType:"trace",name:"ohlc",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc").calc,plot:d("./plot"),style:d("./style"),hoverPoints:d("./hover").hoverPoints,selectPoints:d("./select")}},{"../../plots/cartesian":568,"./attributes":872,"./calc":873,"./defaults":874,"./hover":875,"./plot":878,"./select":879,"./style":880}],877:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib");re.exports=function(T,e,a,n){var r=a("x"),t=a("open"),f=a("high"),o=a("low"),i=a("close");a("hoverlabel.split");var g=w.getComponentMethod("calendars","handleTraceDefaults");if(g(T,e,["x"],n),!!(t&&f&&o&&i)){var p=Math.min(t.length,f.length,o.length,i.length);return r&&(p=Math.min(p,c.minRowLength(r))),e._length=p,p}}},{"../../lib":503,"../../registry":638}],878:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib");re.exports=function(T,e,a,n){var r=e.yaxis,t=e.xaxis,f=!!t.rangebreaks;c.makeTraceGroups(n,a,"trace ohlc").each(function(o){var i=w.select(this),g=o[0],p=g.t,y=g.trace;if(y.visible!==!0||p.empty){i.remove();return}var h=p.tickLen,m=i.selectAll("path").data(c.identity);m.enter().append("path"),m.exit().remove(),m.attr("d",function(u){if(u.empty)return"M0,0Z";var _=t.c2p(u.pos-h,!0),s=t.c2p(u.pos+h,!0),A=f?(_+s)/2:t.c2p(u.pos,!0),x=r.c2p(u.o,!0),v=r.c2p(u.h,!0),b=r.c2p(u.l,!0),l=r.c2p(u.c,!0);return"M"+_+","+x+"H"+A+"M"+A+","+v+"V"+b+"M"+s+","+l+"H"+A})})}},{"../../lib":503,"@plotly/d3":58}],879:[function(d,re,ne){re.exports=function(c,M){var T=c.cd,e=c.xaxis,a=c.yaxis,n=[],r,t=T[0].t.bPos||0;if(M===!1)for(r=0;r<T.length;r++)T[r].selected=0;else for(r=0;r<T.length;r++){var f=T[r];M.contains([e.c2p(f.pos+t),a.c2p(f.yc)],null,f.i,c)?(n.push({pointNumber:f.i,x:e.c2d(f.pos),y:a.c2d(f.yc)}),f.selected=1):f.selected=0}return n}},{}],880:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/drawing"),M=d("../../components/color");re.exports=function(e,a,n){var r=n||w.select(e).selectAll("g.ohlclayer").selectAll("g.trace");r.style("opacity",function(t){return t[0].trace.opacity}),r.each(function(t){var f=t[0].trace;w.select(this).selectAll("path").each(function(o){if(!o.empty){var i=f[o.dir].line;w.select(this).style("fill","none").call(M.stroke,i.color).call(c.dashLine,i.dash,i.width).style("opacity",f.selectedpoints&&!o.selected?.3:1)}})})}},{"../../components/color":366,"../../components/drawing":388,"@plotly/d3":58}],881:[function(d,re,ne){var w=d("../../lib/extend").extendFlat,c=d("../../plots/attributes"),M=d("../../plots/font_attributes"),T=d("../../components/colorscale/attributes"),e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/domain").attributes,n=w({editType:"calc"},T("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});re.exports={domain:a({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:w({},c.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:M({editType:"calc"}),tickfont:M({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:n,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/font_attributes":585,"../../plots/template_attributes":633}],882:[function(d,re,ne){var w=d("../../plots/get_data").getModuleCalcData,c=d("./plot"),M="parcats";ne.name=M,ne.plot=function(T,e,a,n){var r=w(T.calcdata,M);if(r.length){var t=r[0];c(T,t,a,n)}},ne.clean=function(T,e,a,n){var r=n._has&&n._has("parcats"),t=e._has&&e._has("parcats");r&&!t&&n._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":593,"./plot":887}],883:[function(d,re,ne){var w=d("../../lib/gup").wrap,c=d("../../components/colorscale/helpers").hasColorscale,M=d("../../components/colorscale/calc"),T=d("../../lib/filter_unique.js"),e=d("../../components/drawing"),a=d("../../lib"),n=d("fast-isnumeric");re.exports=function(_,s){var A=a.filterVisible(s.dimensions);if(A.length===0)return[];var x=A.map(function(se){var ie;if(se.categoryorder==="trace")ie=null;else if(se.categoryorder==="array")ie=se.categoryarray;else{ie=T(se.values);for(var N=!0,U=0;U<ie.length;U++)if(!n(ie[U])){N=!1;break}ie.sort(N?a.sorterAsc:void 0),se.categoryorder==="category descending"&&(ie=ie.reverse())}return p(se.values,ie)}),v,b,l;a.isArrayOrTypedArray(s.counts)?v=s.counts:v=[s.counts],y(A),A.forEach(function(se,ie){h(se,x[ie])});var L=s.line,S;L?(c(s,"line")&&M(_,s,{vals:s.line.color,containerStr:"line",cLetter:"c"}),S=e.tryColorscale(L)):S=a.identity;function k(se){var ie,N;return a.isArrayOrTypedArray(L.color)?(ie=L.color[se%L.color.length],N=ie):ie=L.color,{color:S(ie),rawColor:N}}var P=A[0].values.length,z={},I=x.map(function(se){return se.inds});l=0;var D,R;for(D=0;D<P;D++){var B=[];for(R=0;R<I.length;R++)B.push(I[R][D]);b=v[D%v.length],l+=b;var F=k(D),V=B+"-"+F.rawColor;z[V]===void 0&&(z[V]=i(B,F.color,F.rawColor)),g(z[V],D,b)}var G=A.map(function(se,ie){return t(ie,se._index,se._displayindex,se.label,l)});for(D=0;D<P;D++)for(b=v[D%v.length],R=0;R<G.length;R++){var J=G[R].containerInd,j=x[R].inds[D],Y=G[R].categories;if(Y[j]===void 0){var X=s.dimensions[J]._categoryarray[j],oe=s.dimensions[J]._ticktext[j];Y[j]=f(R,j,X,oe)}o(Y[j],D,b)}return w(r(G,z,l))};function r(u,_,s){var A=u.map(function(x){return x.categories.length}).reduce(function(x,v){return Math.max(x,v)});return{dimensions:u,paths:_,trace:void 0,maxCats:A,count:s}}function t(u,_,s,A,x){return{dimensionInd:u,containerInd:_,displayInd:s,dimensionLabel:A,count:x,categories:[],dragX:null}}function f(u,_,s,A){return{dimensionInd:u,categoryInd:_,categoryValue:s,displayInd:_,categoryLabel:A,valueInds:[],count:0,dragY:null}}function o(u,_,s){u.valueInds.push(_),u.count+=s}function i(u,_,s){return{categoryInds:u,color:_,rawColor:s,valueInds:[],count:0}}function g(u,_,s){u.valueInds.push(_),u.count+=s}function p(u,_){_==null?_=[]:_=_.map(function(S){return S});var s={},A={},x=[];_.forEach(function(S,k){s[S]=0,A[S]=k});for(var v=0;v<u.length;v++){var b=u[v],l;s[b]===void 0?(s[b]=1,l=_.push(b)-1,A[b]=l):(s[b]++,l=A[b]),x.push(l)}var L=_.map(function(S){return s[S]});return{uniqueValues:_,uniqueCounts:L,inds:x}}function y(u){var _=u.map(function(A){return A.displayindex}),s;if(m(_))for(s=0;s<u.length;s++)u[s]._displayindex=u[s].displayindex;else for(s=0;s<u.length;s++)u[s]._displayindex=s}function h(u,_){u._categoryarray=_.uniqueValues,u.ticktext===null||u.ticktext===void 0?u._ticktext=[]:u._ticktext=u.ticktext.slice();for(var s=u._ticktext.length;s<_.uniqueValues.length;s++)u._ticktext.push(_.uniqueValues[s])}function m(u){for(var _=new Array(u.length),s=0;s<u.length;s++){if(u[s]<0||u[s]>=u.length||_[u[s]]!==void 0)return!1;_[u[s]]=!0}return!0}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"../../components/drawing":388,"../../lib":503,"../../lib/filter_unique.js":494,"../../lib/gup":500,"fast-isnumeric":190}],884:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/colorscale/helpers").hasColorscale,M=d("../../components/colorscale/defaults"),T=d("../../plots/domain").defaults,e=d("../../plots/array_container_defaults"),a=d("./attributes"),n=d("../parcoords/merge_length");function r(f,o,i,g,p){p("line.shape"),p("line.hovertemplate");var y=p("line.color",g.colorway[0]);if(c(f,"line")&&w.isArrayOrTypedArray(y)){if(y.length)return p("line.colorscale"),M(f,o,g,p,{prefix:"line.",cLetter:"c"}),y.length;o.line.color=i}return 1/0}function t(f,o){function i(_,s){return w.coerce(f,o,a.dimensions,_,s)}var g=i("values"),p=i("visible");if(g&&g.length||(p=o.visible=!1),p){i("label"),i("displayindex",o._index);var y=f.categoryarray,h=Array.isArray(y)&&y.length>0,m;h&&(m="array");var u=i("categoryorder",m);u==="array"?(i("categoryarray"),i("ticktext")):(delete f.categoryarray,delete f.ticktext),!h&&u==="array"&&(o.categoryorder="trace")}}re.exports=function(o,i,g,p){function y(s,A){return w.coerce(o,i,a,s,A)}var h=e(o,i,{name:"dimensions",handleItemDefaults:t}),m=r(o,i,g,p,y);T(i,p,y),(!Array.isArray(h)||!h.length)&&(i.visible=!1),n(i,h,"values",m),y("hoveron"),y("hovertemplate"),y("arrangement"),y("bundlecolors"),y("sortpaths"),y("counts");var u={family:p.font.family,size:Math.round(p.font.size),color:p.font.color};w.coerceFont(y,"labelfont",u);var _={family:p.font.family,size:Math.round(p.font.size/1.2),color:p.font.color};w.coerceFont(y,"tickfont",_)}},{"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/domain":584,"../parcoords/merge_length":898,"./attributes":881}],885:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:d("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":881,"./base_plot":882,"./calc":883,"./defaults":884,"./plot":887}],886:[function(d,re,ne){var w=d("@plotly/d3"),c=d("d3-interpolate").interpolateNumber,M=d("../../plot_api/plot_api"),T=d("../../components/fx"),e=d("../../lib"),a=e.strTranslate,n=d("../../components/drawing"),r=d("tinycolor2"),t=d("../../lib/svg_text_utils");function f(U,q,Q,W){var Z=U.map(X.bind(0,q,Q)),ee=W.selectAll("g.parcatslayer").data([null]);ee.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var te=ee.selectAll("g.trace.parcats").data(Z,o),ae=te.enter().append("g").attr("class","trace parcats");te.attr("transform",function(xe){return a(xe.x,xe.y)}),ae.append("g").attr("class","paths");var le=te.select("g.paths"),ye=le.selectAll("path.path").data(function(xe){return xe.paths},o);ye.attr("fill",function(xe){return xe.model.color});var fe=ye.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(xe){return xe.model.color}).attr("fill-opacity",0);_(fe),ye.attr("d",function(xe){return xe.svgD}),fe.empty()||ye.sort(g),ye.exit().remove(),ye.on("mouseover",p).on("mouseout",y).on("click",u),ae.append("g").attr("class","dimensions");var pe=te.select("g.dimensions"),ge=pe.selectAll("g.dimension").data(function(xe){return xe.dimensions},o);ge.enter().append("g").attr("class","dimension"),ge.attr("transform",function(xe){return a(xe.x,0)}),ge.exit().remove();var Ae=ge.selectAll("g.category").data(function(xe){return xe.categories},o),we=Ae.enter().append("g").attr("class","category");Ae.attr("transform",function(xe){return a(0,xe.y)}),we.append("rect").attr("class","catrect").attr("pointer-events","none"),Ae.select("rect.catrect").attr("fill","none").attr("width",function(xe){return xe.width}).attr("height",function(xe){return xe.height}),x(we);var De=Ae.selectAll("rect.bandrect").data(function(xe){return xe.bands},o);De.each(function(){e.raiseToTop(this)}),De.attr("fill",function(xe){return xe.color});var Be=De.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(xe){return xe.color}).attr("fill-opacity",0);De.attr("fill",function(xe){return xe.color}).attr("width",function(xe){return xe.width}).attr("height",function(xe){return xe.height}).attr("y",function(xe){return xe.y}).attr("cursor",function(xe){return xe.parcatsViewModel.arrangement==="fixed"?"default":xe.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),b(Be),De.exit().remove(),we.append("text").attr("class","catlabel").attr("pointer-events","none");var Ve=q._fullLayout.paper_bgcolor;Ae.select("text.catlabel").attr("text-anchor",function(xe){return i(xe)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",t.makeTextShadow(Ve)).style("fill","rgb(0, 0, 0)").attr("x",function(xe){return i(xe)?xe.width+5:-5}).attr("y",function(xe){return xe.height/2}).text(function(xe){return xe.model.categoryLabel}).each(function(xe){n.font(w.select(this),xe.parcatsViewModel.categorylabelfont),t.convertToTspans(w.select(this),q)}),we.append("text").attr("class","dimlabel"),Ae.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(xe){return xe.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(xe){return xe.width/2}).attr("y",-5).text(function(xe,Le){return Le===0?xe.parcatsViewModel.model.dimensions[xe.model.dimensionInd].dimensionLabel:null}).each(function(xe){n.font(w.select(this),xe.parcatsViewModel.labelfont)}),Ae.selectAll("rect.bandrect").on("mouseover",R).on("mouseout",B),Ae.exit().remove(),ge.call(w.behavior.drag().origin(function(xe){return{x:xe.x,y:0}}).on("dragstart",F).on("drag",V).on("dragend",G)),te.each(function(xe){xe.traceSelection=w.select(this),xe.pathSelection=w.select(this).selectAll("g.paths").selectAll("path.path"),xe.dimensionSelection=w.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),te.exit().remove()}re.exports=function(U,q,Q,W){f(Q,U,W,q)};function o(U){return U.key}function i(U){var q=U.parcatsViewModel.dimensions.length,Q=U.parcatsViewModel.dimensions[q-1].model.dimensionInd;return U.model.dimensionInd===Q}function g(U,q){return U.model.rawColor>q.model.rawColor?1:U.model.rawColor<q.model.rawColor?-1:0}function p(U){if(!U.parcatsViewModel.dragDimension&&U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),s(w.select(this));var q=h(U),Q=m(U);if(U.parcatsViewModel.graphDiv.emit("plotly_hover",{points:q,event:w.event,constraints:Q}),U.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var W=w.mouse(this)[0],Z=U.parcatsViewModel.graphDiv,ee=U.parcatsViewModel.trace,te=Z._fullLayout,ae=te._paperdiv.node().getBoundingClientRect(),le=U.parcatsViewModel.graphDiv.getBoundingClientRect(),ye,fe,pe;for(pe=0;pe<U.leftXs.length-1;pe++)if(U.leftXs[pe]+U.dimWidths[pe]-2<=W&&W<=U.leftXs[pe+1]+2){var ge=U.parcatsViewModel.dimensions[pe],Ae=U.parcatsViewModel.dimensions[pe+1];ye=(ge.x+ge.width+Ae.x)/2,fe=(U.topYs[pe]+U.topYs[pe+1]+U.height)/2;break}var we=U.parcatsViewModel.x+ye,De=U.parcatsViewModel.y+fe,Be=r.mostReadable(U.model.color,["black","white"]),Ve=U.model.count,xe=Ve/U.parcatsViewModel.model.count,Le={countLabel:Ve,probabilityLabel:xe.toFixed(3)},He=[];U.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&He.push(["Count:",Le.countLabel].join(" ")),U.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&He.push(["P:",Le.probabilityLabel].join(" "));var Je=He.join("<br>"),Oe=w.mouse(Z)[0];T.loneHover({trace:ee,x:we-ae.left+le.left,y:De-ae.top+le.top,text:Je,color:U.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:Be,idealAlign:Oe<we?"right":"left",hovertemplate:(ee.line||{}).hovertemplate,hovertemplateLabels:Le,eventData:[{data:ee._input,fullData:ee,count:Ve,probability:xe}]},{container:te._hoverlayer.node(),outerContainer:te._paper.node(),gd:Z})}}}function y(U){if(!U.parcatsViewModel.dragDimension&&(_(w.select(this)),T.loneUnhover(U.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),U.parcatsViewModel.pathSelection.sort(g),U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var q=h(U),Q=m(U);U.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:q,event:w.event,constraints:Q})}}function h(U){for(var q=[],Q=J(U.parcatsViewModel),W=0;W<U.model.valueInds.length;W++){var Z=U.model.valueInds[W];q.push({curveNumber:Q,pointNumber:Z})}return q}function m(U){for(var q={},Q=U.parcatsViewModel.model.dimensions,W=0;W<Q.length;W++){var Z=Q[W],ee=Z.categories[U.model.categoryInds[W]];q[Z.containerInd]=ee.categoryValue}return U.model.rawColor!==void 0&&(q.color=U.model.rawColor),q}function u(U){if(U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var q=h(U),Q=m(U);U.parcatsViewModel.graphDiv.emit("plotly_click",{points:q,event:w.event,constraints:Q})}}function _(U){U.attr("fill",function(q){return q.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function s(U){U.attr("fill-opacity",.8).attr("stroke",function(q){return r.mostReadable(q.model.color,["black","white"])}).attr("stroke-width",.3)}function A(U){U.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function x(U){U.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function v(U){U.attr("stroke","black").attr("stroke-width",1.5)}function b(U){U.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function l(U){var q=U.parcatsViewModel.pathSelection,Q=U.categoryViewModel.model.dimensionInd,W=U.categoryViewModel.model.categoryInd;return q.filter(function(Z){return Z.model.categoryInds[Q]===W&&Z.model.color===U.color})}function L(U){var q=w.select(U.parentNode).selectAll("rect.bandrect");q.each(function(Q){var W=l(Q);s(W),W.each(function(){e.raiseToTop(this)})}),A(w.select(U.parentNode))}function S(U){var q=w.select(U).datum(),Q=l(q);s(Q),Q.each(function(){e.raiseToTop(this)}),w.select(U.parentNode).selectAll("rect.bandrect").filter(function(W){return W.color===q.color}).each(function(){e.raiseToTop(this),v(w.select(this))})}function k(U,q,Q){var W=w.select(U).datum(),Z=W.categoryViewModel.model,ee=W.parcatsViewModel.graphDiv,te=w.select(U.parentNode).selectAll("rect.bandrect"),ae=[];te.each(function(ye){var fe=l(ye);fe.each(function(pe){Array.prototype.push.apply(ae,h(pe))})});var le={};le[Z.dimensionInd]=Z.categoryValue,ee.emit(q,{points:ae,event:Q,constraints:le})}function P(U,q,Q){var W=w.select(U).datum(),Z=W.categoryViewModel.model,ee=W.parcatsViewModel.graphDiv,te=l(W),ae=[];te.each(function(ye){Array.prototype.push.apply(ae,h(ye))});var le={};le[Z.dimensionInd]=Z.categoryValue,W.rawColor!==void 0&&(le.color=W.rawColor),ee.emit(q,{points:ae,event:Q,constraints:le})}function z(U,q,Q){U._fullLayout._calcInverseTransform(U);var W=U._fullLayout._invScaleX,Z=U._fullLayout._invScaleY,ee=w.select(Q.parentNode).select("rect.catrect"),te=ee.node().getBoundingClientRect(),ae=ee.datum(),le=ae.parcatsViewModel,ye=le.model.dimensions[ae.model.dimensionInd],fe=le.trace,pe=te.top+te.height/2,ge,Ae;le.dimensions.length>1&&ye.displayInd===le.dimensions.length-1?(ge=te.left,Ae="left"):(ge=te.left+te.width,Ae="right");var we=ae.model.count,De=ae.model.categoryLabel,Be=we/ae.parcatsViewModel.model.count,Ve={countLabel:we,categoryLabel:De,probabilityLabel:Be.toFixed(3)},xe=[];ae.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&xe.push(["Count:",Ve.countLabel].join(" ")),ae.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&xe.push(["P("+Ve.categoryLabel+"):",Ve.probabilityLabel].join(" "));var Le=xe.join("<br>");return{trace:fe,x:W*(ge-q.left),y:Z*(pe-q.top),text:Le,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:Ae,hovertemplate:fe.hovertemplate,hovertemplateLabels:Ve,eventData:[{data:fe._input,fullData:fe,count:we,category:De,probability:Be}]}}function I(U,q,Q){var W=[];return w.select(Q.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){var Z=this;W.push(z(U,q,Z))}),W}function D(U,q,Q){U._fullLayout._calcInverseTransform(U);var W=U._fullLayout._invScaleX,Z=U._fullLayout._invScaleY,ee=Q.getBoundingClientRect(),te=w.select(Q).datum(),ae=te.categoryViewModel,le=ae.parcatsViewModel,ye=le.model.dimensions[ae.model.dimensionInd],fe=le.trace,pe=ee.y+ee.height/2,ge,Ae;le.dimensions.length>1&&ye.displayInd===le.dimensions.length-1?(ge=ee.left,Ae="left"):(ge=ee.left+ee.width,Ae="right");var we=ae.model.categoryLabel,De=te.parcatsViewModel.model.count,Be=0;te.categoryViewModel.bands.forEach(function(Lt){Lt.color===te.color&&(Be+=Lt.count)});var Ve=ae.model.count,xe=0;le.pathSelection.each(function(Lt){Lt.model.color===te.color&&(xe+=Lt.model.count)});var Le=Be/De,He=Be/xe,Je=Be/Ve,Oe={countLabel:De,categoryLabel:we,probabilityLabel:Le.toFixed(3)},Pe=[];ae.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Pe.push(["Count:",Oe.countLabel].join(" ")),ae.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(Pe.push("P(color \u2229 "+we+"): "+Oe.probabilityLabel),Pe.push("P("+we+" | color): "+He.toFixed(3)),Pe.push("P(color | "+we+"): "+Je.toFixed(3)));var Ue=Pe.join("<br>"),vt=r.mostReadable(te.color,["black","white"]);return{trace:fe,x:W*(ge-q.left),y:Z*(pe-q.top),text:Ue,color:te.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:vt,fontSize:10,idealAlign:Ae,hovertemplate:fe.hovertemplate,hovertemplateLabels:Oe,eventData:[{data:fe._input,fullData:fe,category:we,count:De,probability:Le,categorycount:Ve,colorcount:xe,bandcolorcount:Be}]}}function R(U){if(!U.parcatsViewModel.dragDimension&&U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var q=w.mouse(this)[1];if(q<-1)return;var Q=U.parcatsViewModel.graphDiv,W=Q._fullLayout,Z=W._paperdiv.node().getBoundingClientRect(),ee=U.parcatsViewModel.hoveron,te=this;if(ee==="color"?(S(te),P(te,"plotly_hover",w.event)):(L(te),k(te,"plotly_hover",w.event)),U.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var ae;ee==="category"?ae=z(Q,Z,te):ee==="color"?ae=D(Q,Z,te):ee==="dimension"&&(ae=I(Q,Z,te)),ae&&T.loneHover(ae,{container:W._hoverlayer.node(),outerContainer:W._paper.node(),gd:Q})}}}function B(U){var q=U.parcatsViewModel;if(!q.dragDimension&&(_(q.pathSelection),x(q.dimensionSelection.selectAll("g.category")),b(q.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),T.loneUnhover(q.graphDiv._fullLayout._hoverlayer.node()),q.pathSelection.sort(g),q.hoverinfoItems.indexOf("skip")===-1)){var Q=U.parcatsViewModel.hoveron,W=this;Q==="color"?P(W,"plotly_unhover",w.event):k(W,"plotly_unhover",w.event)}}function F(U){U.parcatsViewModel.arrangement!=="fixed"&&(U.dragDimensionDisplayInd=U.model.displayInd,U.initialDragDimensionDisplayInds=U.parcatsViewModel.model.dimensions.map(function(q){return q.displayInd}),U.dragHasMoved=!1,U.dragCategoryDisplayInd=null,w.select(this).selectAll("g.category").select("rect.catrect").each(function(q){var Q=w.mouse(this)[0],W=w.mouse(this)[1];-2<=Q&&Q<=q.width+2&&-2<=W&&W<=q.height+2&&(U.dragCategoryDisplayInd=q.model.displayInd,U.initialDragCategoryDisplayInds=U.model.categories.map(function(Z){return Z.displayInd}),q.model.dragY=q.y,e.raiseToTop(this.parentNode),w.select(this.parentNode).selectAll("rect.bandrect").each(function(Z){Z.y<W&&W<=Z.y+Z.height&&(U.potentialClickBand=this)}))}),U.parcatsViewModel.dragDimension=U,T.loneUnhover(U.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function V(U){if(U.parcatsViewModel.arrangement!=="fixed"&&(U.dragHasMoved=!0,U.dragDimensionDisplayInd!==null)){var q=U.dragDimensionDisplayInd,Q=q-1,W=q+1,Z=U.parcatsViewModel.dimensions[q];if(U.dragCategoryDisplayInd!==null){var ee=Z.categories[U.dragCategoryDisplayInd];ee.model.dragY+=w.event.dy;var te=ee.model.dragY,ae=ee.model.displayInd,le=Z.categories,ye=le[ae-1],fe=le[ae+1];ye!==void 0&&te<ye.y+ye.height/2&&(ee.model.displayInd=ye.model.displayInd,ye.model.displayInd=ae),fe!==void 0&&te+ee.height>fe.y+fe.height/2&&(ee.model.displayInd=fe.model.displayInd,fe.model.displayInd=ae),U.dragCategoryDisplayInd=ee.model.displayInd}if(U.dragCategoryDisplayInd===null||U.parcatsViewModel.arrangement==="freeform"){Z.model.dragX=w.event.x;var pe=U.parcatsViewModel.dimensions[Q],ge=U.parcatsViewModel.dimensions[W];pe!==void 0&&Z.model.dragX<pe.x+pe.width&&(Z.model.displayInd=pe.model.displayInd,pe.model.displayInd=q),ge!==void 0&&Z.model.dragX+Z.width>ge.x&&(Z.model.displayInd=ge.model.displayInd,ge.model.displayInd=U.dragDimensionDisplayInd),U.dragDimensionDisplayInd=Z.model.displayInd}ie(U.parcatsViewModel),se(U.parcatsViewModel),Y(U.parcatsViewModel),j(U.parcatsViewModel)}}function G(U){if(U.parcatsViewModel.arrangement!=="fixed"&&U.dragDimensionDisplayInd!==null){w.select(this).selectAll("text").attr("font-weight","normal");var q={},Q=J(U.parcatsViewModel),W=U.parcatsViewModel.model.dimensions.map(function(ge){return ge.displayInd}),Z=U.initialDragDimensionDisplayInds.some(function(ge,Ae){return ge!==W[Ae]});Z&&W.forEach(function(ge,Ae){var we=U.parcatsViewModel.model.dimensions[Ae].containerInd;q["dimensions["+we+"].displayindex"]=ge});var ee=!1;if(U.dragCategoryDisplayInd!==null){var te=U.model.categories.map(function(ge){return ge.displayInd});if(ee=U.initialDragCategoryDisplayInds.some(function(ge,Ae){return ge!==te[Ae]}),ee){var ae=U.model.categories.slice().sort(function(ge,Ae){return ge.displayInd-Ae.displayInd}),le=ae.map(function(ge){return ge.categoryValue}),ye=ae.map(function(ge){return ge.categoryLabel});q["dimensions["+U.model.containerInd+"].categoryarray"]=[le],q["dimensions["+U.model.containerInd+"].ticktext"]=[ye],q["dimensions["+U.model.containerInd+"].categoryorder"]="array"}}if(U.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!U.dragHasMoved&&U.potentialClickBand&&(U.parcatsViewModel.hoveron==="color"?P(U.potentialClickBand,"plotly_click",w.event.sourceEvent):k(U.potentialClickBand,"plotly_click",w.event.sourceEvent)),U.model.dragX=null,U.dragCategoryDisplayInd!==null){var fe=U.parcatsViewModel.dimensions[U.dragDimensionDisplayInd].categories[U.dragCategoryDisplayInd];fe.model.dragY=null,U.dragCategoryDisplayInd=null}U.dragDimensionDisplayInd=null,U.parcatsViewModel.dragDimension=null,U.dragHasMoved=null,U.potentialClickBand=null,ie(U.parcatsViewModel),se(U.parcatsViewModel);var pe=w.transition().duration(300).ease("cubic-in-out");pe.each(function(){Y(U.parcatsViewModel,!0),j(U.parcatsViewModel,!0)}).each("end",function(){(Z||ee)&&M.restyle(U.parcatsViewModel.graphDiv,q,[Q])})}}function J(U){for(var q,Q=U.graphDiv._fullData,W=0;W<Q.length;W++)if(U.key===Q[W].uid){q=W;break}return q}function j(U,q){q===void 0&&(q=!1);function Q(W){return q?W.transition():W}U.pathSelection.data(function(W){return W.paths},o),Q(U.pathSelection).attr("d",function(W){return W.svgD})}function Y(U,q){q===void 0&&(q=!1);function Q(le){return q?le.transition():le}U.dimensionSelection.data(function(le){return le.dimensions},o);var W=U.dimensionSelection.selectAll("g.category").data(function(le){return le.categories},o);Q(U.dimensionSelection).attr("transform",function(le){return a(le.x,0)}),Q(W).attr("transform",function(le){return a(0,le.y)});var Z=W.select(".dimlabel");Z.text(function(le,ye){return ye===0?le.parcatsViewModel.model.dimensions[le.model.dimensionInd].dimensionLabel:null});var ee=W.select(".catlabel");ee.attr("text-anchor",function(le){return i(le)?"start":"end"}).attr("x",function(le){return i(le)?le.width+5:-5}).each(function(le){var ye,fe;i(le)?(ye=le.width+5,fe="start"):(ye=-5,fe="end"),w.select(this).selectAll("tspan").attr("x",ye).attr("text-anchor",fe)});var te=W.selectAll("rect.bandrect").data(function(le){return le.bands},o),ae=te.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(le){return le.color}).attr("fill-opacity",0);te.attr("fill",function(le){return le.color}).attr("width",function(le){return le.width}).attr("height",function(le){return le.height}).attr("y",function(le){return le.y}),b(ae),te.each(function(){e.raiseToTop(this)}),te.exit().remove()}function X(U,q,Q){var W=Q[0],Z=q.margin||{l:80,r:80,t:100,b:80},ee=W.trace,te=ee.domain,ae=q.width,le=q.height,ye=Math.floor(ae*(te.x[1]-te.x[0])),fe=Math.floor(le*(te.y[1]-te.y[0])),pe=te.x[0]*ae+Z.l,ge=q.height-te.y[1]*q.height+Z.t,Ae=ee.line.shape,we;ee.hoverinfo==="all"?we=["count","probability"]:we=(ee.hoverinfo||"").split("+");var De={trace:ee,key:ee.uid,model:W,x:pe,y:ge,width:ye,height:fe,hoveron:ee.hoveron,hoverinfoItems:we,arrangement:ee.arrangement,bundlecolors:ee.bundlecolors,sortpaths:ee.sortpaths,labelfont:ee.labelfont,categorylabelfont:ee.tickfont,pathShape:Ae,dragDimension:null,margin:Z,paths:[],dimensions:[],graphDiv:U,traceSelection:null,pathSelection:null,dimensionSelection:null};return W.dimensions&&(ie(De),se(De)),De}function oe(U,q,Q,W,Z){var ee=[],te=[],ae,le;for(le=0;le<Q.length-1;le++)ae=c(Q[le]+U[le],U[le+1]),ee.push(ae(Z)),te.push(ae(1-Z));var ye="M "+U[0]+","+q[0];for(ye+="l"+Q[0]+",0 ",le=1;le<Q.length;le++)ye+="C"+ee[le-1]+","+q[le-1]+" "+te[le-1]+","+q[le]+" "+U[le]+","+q[le],ye+="l"+Q[le]+",0 ";for(ye+="l0,"+W+" ",ye+="l -"+Q[Q.length-1]+",0 ",le=Q.length-2;le>=0;le--)ye+="C"+te[le]+","+(q[le+1]+W)+" "+ee[le]+","+(q[le]+W)+" "+(U[le]+Q[le])+","+(q[le]+W),ye+="l-"+Q[le]+",0 ";return ye+="Z",ye}function se(U){var q=U.dimensions,Q=U.model,W=q.map(function(Rt){return Rt.categories.map(function(Bt){return Bt.y})}),Z=U.model.dimensions.map(function(Rt){return Rt.categories.map(function(Bt){return Bt.displayInd})}),ee=U.model.dimensions.map(function(Rt){return Rt.displayInd}),te=U.dimensions.map(function(Rt){return Rt.model.dimensionInd}),ae=q.map(function(Rt){return Rt.x}),le=q.map(function(Rt){return Rt.width}),ye=[];for(var fe in Q.paths)Q.paths.hasOwnProperty(fe)&&ye.push(Q.paths[fe]);function pe(Rt){var Bt=Rt.categoryInds.map(function(Tt,at){return Z[at][Tt]}),Mt=te.map(function(Tt){return Bt[Tt]});return Mt}ye.sort(function(Rt,Bt){var Mt=pe(Rt),Tt=pe(Bt);return U.sortpaths==="backward"&&(Mt.reverse(),Tt.reverse()),Mt.push(Rt.valueInds[0]),Tt.push(Bt.valueInds[0]),U.bundlecolors&&(Mt.unshift(Rt.rawColor),Tt.unshift(Bt.rawColor)),Mt<Tt?-1:Mt>Tt?1:0});for(var ge=new Array(ye.length),Ae=q[0].model.count,we=q[0].categories.map(function(Rt){return Rt.height}).reduce(function(Rt,Bt){return Rt+Bt}),De=0;De<ye.length;De++){var Be=ye[De],Ve;Ae>0?Ve=we*(Be.count/Ae):Ve=0;for(var xe=new Array(W.length),Le=0;Le<Be.categoryInds.length;Le++){var He=Be.categoryInds[Le],Je=Z[Le][He],Oe=ee[Le];xe[Oe]=W[Oe][Je],W[Oe][Je]+=Ve;var Pe=U.dimensions[Oe].categories[Je],Ue=Pe.bands.length,vt=Pe.bands[Ue-1];if(vt===void 0||Be.rawColor!==vt.rawColor){var Lt=vt===void 0?0:vt.y+vt.height;Pe.bands.push({key:Lt,color:Be.color,rawColor:Be.rawColor,height:Ve,width:Pe.width,count:Be.count,y:Lt,categoryViewModel:Pe,parcatsViewModel:U})}else{var Yt=Pe.bands[Ue-1];Yt.height+=Ve,Yt.count+=Be.count}}var At;U.pathShape==="hspline"?At=oe(ae,xe,le,Ve,.5):At=oe(ae,xe,le,Ve,0),ge[De]={key:Be.valueInds[0],model:Be,height:Ve,leftXs:ae,topYs:xe,dimWidths:le,svgD:At,parcatsViewModel:U}}U.paths=ge}function ie(U){var q=U.model.dimensions.map(function(te){return{displayInd:te.displayInd,dimensionInd:te.dimensionInd}});q.sort(function(te,ae){return te.displayInd-ae.displayInd});var Q=[];for(var W in q){var Z=q[W].dimensionInd,ee=U.model.dimensions[Z];Q.push(N(U,ee))}U.dimensions=Q}function N(U,q){var Q=40,W=16,Z=U.model.dimensions.length,ee=q.displayInd,te,ae,le;Z>1?te=(U.width-2*Q-W)/(Z-1):te=0,ae=Q,le=ae+te*ee;var ye=[],fe=U.model.maxCats,pe=q.categories.length,ge=8,Ae=q.count,we=U.height-ge*(fe-1),De,Be,Ve,xe,Le,He=(fe-pe)*ge/2,Je=q.categories.map(function(Oe){return{displayInd:Oe.displayInd,categoryInd:Oe.categoryInd}});for(Je.sort(function(Oe,Pe){return Oe.displayInd-Pe.displayInd}),Le=0;Le<pe;Le++)xe=Je[Le].categoryInd,Be=q.categories[xe],Ae>0?De=Be.count/Ae*we:De=0,Ve={key:Be.valueInds[0],model:Be,width:W,height:De,y:Be.dragY!==null?Be.dragY:He,bands:[],parcatsViewModel:U},He=He+De+ge,ye.push(Ve);return{key:q.dimensionInd,x:q.dragX!==null?q.dragX:le,y:0,width:W,model:q,categories:ye,parcatsViewModel:U,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}},{"../../components/drawing":388,"../../components/fx":406,"../../lib":503,"../../lib/svg_text_utils":529,"../../plot_api/plot_api":540,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:312}],887:[function(d,re,ne){var w=d("./parcats");re.exports=function(M,T,e,a){var n=M._fullLayout,r=n._paper,t=n._size;w(M,r,T,{width:t.w,height:t.h,margin:{t:t.t,r:t.r,b:t.b,l:t.l}},e,a)}},{"./parcats":886}],888:[function(d,re,ne){var w=d("../../components/colorscale/attributes"),c=d("../../plots/cartesian/layout_attributes"),M=d("../../plots/font_attributes"),T=d("../../plots/domain").attributes,e=d("../../lib/extend").extendFlat,a=d("../../plot_api/plot_template").templatedArray;re.exports={domain:T({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:M({editType:"plot"}),tickfont:M({editType:"plot"}),rangefont:M({editType:"plot"}),dimensions:a("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},c.tickvals,{editType:"plot"}),ticktext:e({},c.ticktext,{editType:"plot"}),tickformat:e({},c.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},w("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../plots/cartesian/layout_attributes":569,"../../plots/domain":584,"../../plots/font_attributes":585}],889:[function(d,re,ne){var w=d("./constants"),c=d("@plotly/d3"),M=d("../../lib/gup").keyFun,T=d("../../lib/gup").repeat,e=d("../../lib").sorterAsc,a=d("../../lib").strTranslate,n=w.bar.snapRatio;function r(G,J){return G*(1-n)+J*n}var t=w.bar.snapClose;function f(G,J){return G*(1-t)+J*t}function o(G,J,j,Y){if(i(j,Y))return j;var X=G?-1:1,oe=0,se=J.length-1;if(X<0){var ie=oe;oe=se,se=ie}for(var N=J[oe],U=N,q=oe;X*q<X*se;q+=X){var Q=q+X,W=J[Q];if(X*j<X*f(N,W))return r(N,U);if(X*j<X*W||Q===se)return r(W,N);U=N,N=W}}function i(G,J){for(var j=0;j<J.length;j++)if(G>=J[j][0]&&G<=J[j][1])return!0;return!1}function g(G){G.attr("x",-w.bar.captureWidth/2).attr("width",w.bar.captureWidth)}function p(G){G.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function y(G){if(!G.brush.filterSpecified)return"0,"+G.height;for(var J=h(G.brush.filter.getConsolidated(),G.height),j=[0],Y,X,oe,se=J.length?J[0][0]:null,ie=0;ie<J.length;ie++)Y=J[ie],X=Y[1]-Y[0],j.push(se),j.push(X),oe=ie+1,oe<J.length&&(se=J[oe][0]-Y[1]);return j.push(G.height),j}function h(G,J){return G.map(function(j){return j.map(function(Y){return Math.max(0,Y*J)}).sort(e)})}function m(G,J){var j=w.bar.handleHeight;if(!(J>G[1]+j||J<G[0]-j))return J>=.9*G[1]+.1*G[0]?"n":J<=.9*G[0]+.1*G[1]?"s":"ns"}function u(){c.select(document.body).style("cursor",null)}function _(G){G.attr("stroke-dasharray",y)}function s(G,J){var j=c.select(G).selectAll(".highlight, .highlight-shadow"),Y=J?j.transition().duration(w.bar.snapDuration).each("end",J):j;_(Y)}function A(G,J){var j=G.brush,Y=j.filterSpecified,X=NaN,oe={},se;if(Y){var ie=G.height,N=j.filter.getConsolidated(),U=h(N,ie),q=NaN,Q=NaN,W=NaN;for(se=0;se<=U.length;se++){var Z=U[se];if(Z&&Z[0]<=J&&J<=Z[1]){q=se;break}else if(Q=se?se-1:NaN,Z&&Z[0]>J){W=se;break}}if(X=q,isNaN(X)&&(isNaN(Q)||isNaN(W)?X=isNaN(Q)?W:Q:X=J-U[Q][1]<U[W][0]-J?Q:W),!isNaN(X)){var ee=U[X],te=m(ee,J);te&&(oe.interval=N[X],oe.intervalPix=ee,oe.region=te)}}if(G.ordinal&&!oe.region){var ae=G.unitTickvals,le=G.unitToPaddedPx.invert(J);for(se=0;se<ae.length;se++){var ye=[ae[Math.max(se-1,0)]*.25+ae[se]*.75,ae[Math.min(se+1,ae.length-1)]*.25+ae[se]*.75];if(le>=ye[0]&&le<=ye[1]){oe.clickableOrdinalRange=ye;break}}}return oe}function x(G,J){c.event.sourceEvent.stopPropagation();var j=J.height-c.mouse(G)[1]-2*w.verticalPadding,Y=J.unitToPaddedPx.invert(j),X=J.brush,oe=A(J,j),se=oe.interval,ie=X.svgBrush;if(ie.wasDragged=!1,ie.grabbingBar=oe.region==="ns",ie.grabbingBar){var N=se.map(J.unitToPaddedPx);ie.grabPoint=j-N[0]-w.verticalPadding,ie.barLength=N[1]-N[0]}ie.clickableOrdinalRange=oe.clickableOrdinalRange,ie.stayingIntervals=J.multiselect&&X.filterSpecified?X.filter.getConsolidated():[],se&&(ie.stayingIntervals=ie.stayingIntervals.filter(function(U){return U[0]!==se[0]&&U[1]!==se[1]})),ie.startExtent=oe.region?se[oe.region==="s"?1:0]:Y,J.parent.inBrushDrag=!0,ie.brushStartCallback()}function v(G,J){c.event.sourceEvent.stopPropagation();var j=J.height-c.mouse(G)[1]-2*w.verticalPadding,Y=J.brush.svgBrush;Y.wasDragged=!0,Y._dragging=!0,Y.grabbingBar?Y.newExtent=[j-Y.grabPoint,j+Y.barLength-Y.grabPoint].map(J.unitToPaddedPx.invert):Y.newExtent=[Y.startExtent,J.unitToPaddedPx.invert(j)].sort(e),J.brush.filterSpecified=!0,Y.extent=Y.stayingIntervals.concat([Y.newExtent]),Y.brushCallback(J),s(G.parentNode)}function b(G,J){var j=J.brush,Y=j.filter,X=j.svgBrush;X._dragging||(l(G,J),v(G,J),J.brush.svgBrush.wasDragged=!1),X._dragging=!1;var oe=c.event;oe.sourceEvent.stopPropagation();var se=X.grabbingBar;if(X.grabbingBar=!1,X.grabLocation=void 0,J.parent.inBrushDrag=!1,u(),!X.wasDragged){X.wasDragged=void 0,X.clickableOrdinalRange?j.filterSpecified&&J.multiselect?X.extent.push(X.clickableOrdinalRange):(X.extent=[X.clickableOrdinalRange],j.filterSpecified=!0):se?(X.extent=X.stayingIntervals,X.extent.length===0&&I(j)):I(j),X.brushCallback(J),s(G.parentNode),X.brushEndCallback(j.filterSpecified?Y.getConsolidated():[]);return}var ie=function(){Y.set(Y.getConsolidated())};if(J.ordinal){var N=J.unitTickvals;N[N.length-1]<N[0]&&N.reverse(),X.newExtent=[o(0,N,X.newExtent[0],X.stayingIntervals),o(1,N,X.newExtent[1],X.stayingIntervals)];var U=X.newExtent[1]>X.newExtent[0];X.extent=X.stayingIntervals.concat(U?[X.newExtent]:[]),X.extent.length||I(j),X.brushCallback(J),U?s(G.parentNode,ie):(ie(),s(G.parentNode))}else ie();X.brushEndCallback(j.filterSpecified?Y.getConsolidated():[])}function l(G,J){var j=J.height-c.mouse(G)[1]-2*w.verticalPadding,Y=A(J,j),X="crosshair";Y.clickableOrdinalRange?X="pointer":Y.region&&(X=Y.region+"-resize"),c.select(document.body).style("cursor",X)}function L(G){G.on("mousemove",function(J){c.event.preventDefault(),J.parent.inBrushDrag||l(this,J)}).on("mouseleave",function(J){J.parent.inBrushDrag||u()}).call(c.behavior.drag().on("dragstart",function(J){x(this,J)}).on("drag",function(J){v(this,J)}).on("dragend",function(J){b(this,J)}))}function S(G,J){return G[0]-J[0]}function k(G,J){var j=G.selectAll(".background").data(T);j.enter().append("rect").classed("background",!0).call(g).call(p).style("pointer-events","auto").attr("transform",a(0,w.verticalPadding)),j.call(L).attr("height",function(oe){return oe.height-w.verticalPadding});var Y=G.selectAll(".highlight-shadow").data(T);Y.enter().append("line").classed("highlight-shadow",!0).attr("x",-w.bar.width/2).attr("stroke-width",w.bar.width+w.bar.strokeWidth).attr("stroke",J).attr("opacity",w.bar.strokeOpacity).attr("stroke-linecap","butt"),Y.attr("y1",function(oe){return oe.height}).call(_);var X=G.selectAll(".highlight").data(T);X.enter().append("line").classed("highlight",!0).attr("x",-w.bar.width/2).attr("stroke-width",w.bar.width-w.bar.strokeWidth).attr("stroke",w.bar.fillColor).attr("opacity",w.bar.fillOpacity).attr("stroke-linecap","butt"),X.attr("y1",function(oe){return oe.height}).call(_)}function P(G,J){var j=G.selectAll("."+w.cn.axisBrush).data(T,M);j.enter().append("g").classed(w.cn.axisBrush,!0),k(j,J)}function z(G){return G.svgBrush.extent.map(function(J){return J.slice()})}function I(G){G.filterSpecified=!1,G.svgBrush.extent=[[-1/0,1/0]]}function D(G){return function(j){var Y=j.brush,X=z(Y),oe=X.slice();Y.filter.set(oe),G()}}function R(G){for(var J=G.slice(),j=[],Y,X=J.shift();X;){for(Y=X.slice();(X=J.shift())&&X[0]<=Y[1];)Y[1]=Math.max(Y[1],X[1]);j.push(Y)}return j.length===1&&j[0][0]>j[0][1]&&(j=[]),j}function B(){var G=[],J,j;return{set:function(Y){G=Y.map(function(X){return X.slice().sort(e)}).sort(S),G.length===1&&G[0][0]===-1/0&&G[0][1]===1/0&&(G=[[0,-1]]),J=R(G),j=G.reduce(function(X,oe){return[Math.min(X[0],oe[0]),Math.max(X[1],oe[1])]},[1/0,-1/0])},get:function(){return G.slice()},getConsolidated:function(){return J},getBounds:function(){return j}}}function F(G,J,j,Y,X,oe){var se=B();return se.set(j),{filter:se,filterSpecified:J,svgBrush:{extent:[],brushStartCallback:Y,brushCallback:D(X),brushEndCallback:oe}}}function V(G,J){if(Array.isArray(G[0])?(G=G.map(function(Y){return Y.sort(e)}),J.multiselect?G=R(G.sort(S)):G=[G[0]]):G=[G.sort(e)],J.tickvals){var j=J.tickvals.slice().sort(e);if(G=G.map(function(Y){var X=[o(0,j,Y[0],[]),o(1,j,Y[1],[])];if(X[1]>X[0])return X}).filter(function(Y){return Y}),!G.length)return}return G.length>1?G:G[0]}re.exports={makeBrush:F,ensureAxisBrush:P,cleanRanges:V}},{"../../lib":503,"../../lib/gup":500,"./constants":893,"@plotly/d3":58}],890:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:d("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":888,"./base_plot":891,"./calc":892,"./defaults":894}],891:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../plots/get_data").getModuleCalcData,M=d("./plot"),T=d("../../constants/xmlns_namespaces");ne.name="parcoords",ne.plot=function(e){var a=c(e.calcdata,"parcoords")[0];a.length&&M(e,a)},ne.clean=function(e,a,n,r){var t=r._has&&r._has("parcoords"),f=a._has&&a._has("parcoords");t&&!f&&(r._paperdiv.selectAll(".parcoords").remove(),r._glimages.selectAll("*").remove())},ne.toSVG=function(e){var a=e._fullLayout._glimages,n=w.select(e).selectAll(".svg-container"),r=n.filter(function(f,o){return o===n.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function t(){var f=this,o=f.toDataURL("image/png"),i=a.append("svg:image");i.attr({xmlns:T.svg,"xlink:href":o,preserveAspectRatio:"none",x:0,y:0,width:f.style.width,height:f.style.height})}r.each(t),window.setTimeout(function(){w.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":480,"../../plots/get_data":593,"./plot":900,"@plotly/d3":58}],892:[function(d,re,ne){var w=d("../../lib").isArrayOrTypedArray,c=d("../../components/colorscale"),M=d("../../lib/gup").wrap;re.exports=function(a,n){var r,t;return c.hasColorscale(n,"line")&&w(n.line.color)?(r=n.line.color,t=c.extractOpts(n.line).colorscale,c.calc(a,n,{vals:r,containerStr:"line",cLetter:"c"})):(r=T(n._length),t=[[0,n.line.color],[1,n.line.color]]),M({lineColor:r,cscale:t})};function T(e){for(var a=new Array(e),n=0;n<e;n++)a[n]=.5;return a}},{"../../components/colorscale":378,"../../lib":503,"../../lib/gup":500}],893:[function(d,re,ne){re.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],894:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/colorscale/helpers").hasColorscale,M=d("../../components/colorscale/defaults"),T=d("../../plots/domain").defaults,e=d("../../plots/array_container_defaults"),a=d("../../plots/cartesian/axes"),n=d("./attributes"),r=d("./axisbrush"),t=d("./constants").maxDimensionCount,f=d("./merge_length");function o(g,p,y,h,m){var u=m("line.color",y);if(c(g,"line")&&w.isArrayOrTypedArray(u)){if(u.length)return m("line.colorscale"),M(g,p,h,m,{prefix:"line.",cLetter:"c"}),u.length;p.line.color=y}return 1/0}function i(g,p,y,h){function m(x,v){return w.coerce(g,p,n.dimensions,x,v)}var u=m("values"),_=m("visible");if(u&&u.length||(_=p.visible=!1),_){m("label"),m("tickvals"),m("ticktext"),m("tickformat");var s=m("range");p._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:s},a.setConvert(p._ax,h.layout),m("multiselect");var A=m("constraintrange");A&&(p.constraintrange=r.cleanRanges(A,p))}}re.exports=function(p,y,h,m){function u(v,b){return w.coerce(p,y,n,v,b)}var _=p.dimensions;Array.isArray(_)&&_.length>t&&(w.log("parcoords traces support up to "+t+" dimensions at the moment"),_.splice(t));var s=e(p,y,{name:"dimensions",layout:m,handleItemDefaults:i}),A=o(p,y,h,m,u);T(y,m,u),(!Array.isArray(s)||!s.length)&&(y.visible=!1),f(y,s,"values",A);var x={family:m.font.family,size:Math.round(m.font.size/1.2),color:m.font.color};w.coerceFont(u,"labelfont",x),w.coerceFont(u,"tickfont",x),w.coerceFont(u,"rangefont",x),u("labelangle"),u("labelside")}},{"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"../../plots/domain":584,"./attributes":888,"./axisbrush":889,"./constants":893,"./merge_length":898}],895:[function(d,re,ne){var w=d("../../lib").isTypedArray;ne.convertTypedArray=function(c){return w(c)?Array.prototype.slice.call(c):c},ne.isOrdinal=function(c){return!!c.tickvals},ne.isVisible=function(c){return c.visible||!("visible"in c)}},{"../../lib":503}],896:[function(d,re,ne){var w=d("./base_index");w.plot=d("./plot"),re.exports=w},{"./base_index":890,"./plot":900}],897:[function(d,re,ne){var w=d("glslify"),c=w([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),M=w([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),T=d("./constants").maxDimensionCount,e=d("../../lib"),a=1e-6,n=2048,r=new Uint8Array(4),t=new Uint8Array(4),f={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function o(l){l.read({x:0,y:0,width:1,height:1,data:r})}function i(l,L,S,k,P){var z=l._gl;z.enable(z.SCISSOR_TEST),z.scissor(L,S,k,P),l.clear({color:[0,0,0,0],depth:1})}function g(l,L,S,k,P,z){var I=z.key;function D(R){var B=Math.min(k,P-R*k);R===0&&(window.cancelAnimationFrame(S.currentRafs[I]),delete S.currentRafs[I],i(l,z.scissorX,z.scissorY,z.scissorWidth,z.viewBoxSize[1])),!S.clearOnly&&(z.count=2*B,z.offset=2*R*k,L(z),R*k+B<P&&(S.currentRafs[I]=window.requestAnimationFrame(function(){D(R+1)})),S.drawCompleted=!1)}S.drawCompleted||(o(l),S.drawCompleted=!0),D(0)}function p(l){return Math.max(a,Math.min(1-a,l))}function y(l,L){for(var S=new Array(256),k=0;k<256;k++)S[k]=l(k/255).concat(L);return S}function h(l,L){return(l>>>8*L)%256/255}function m(l,L,S){for(var k=new Array(l*(T+4)),P=0,z=0;z<l;z++){for(var I=0;I<T;I++)k[P++]=I<L.length?L[I].paddedUnitValues[z]:.5;k[P++]=h(z,2),k[P++]=h(z,1),k[P++]=h(z,0),k[P++]=p(S[z])}return k}function u(l,L,S){for(var k=new Array(L*8),P=0,z=0;z<L;z++)for(var I=0;I<2;I++)for(var D=0;D<4;D++){var R=l*4+D,B=S[z*64+R];R===63&&I===0&&(B*=-1),k[P++]=B}return k}function _(l){var L="0"+l;return L.substr(L.length-2)}function s(l){return l<T?"p"+_(l+1)+"_"+_(l+4):"colors"}function A(l,L,S){for(var k=0;k<=T;k+=4)l[s(k)](u(k/4,L,S))}function x(l){for(var L={},S=0;S<=T;S+=4)L[s(S)]=l.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return L}function v(l,L,S,k,P,z,I,D,R,B,F,V,G,J){for(var j=[[],[]],Y=0;Y<64;Y++)j[0][Y]=Y===P?1:0,j[1][Y]=Y===z?1:0;I*=J,D*=J,R*=J,B*=J;var X=l.lines.canvasOverdrag*J,oe=l.domain,se=l.canvasWidth*J,ie=l.canvasHeight*J,N=l.pad.l*J,U=l.pad.b*J,q=l.layoutHeight*J,Q=l.layoutWidth*J,W=l.deselectedLines.color,Z=e.extendFlat({key:F,resolution:[se,ie],viewBoxPos:[I+X,D],viewBoxSize:[R,B],i0:P,i1:z,dim0A:j[0].slice(0,16),dim0B:j[0].slice(16,32),dim0C:j[0].slice(32,48),dim0D:j[0].slice(48,64),dim1A:j[1].slice(0,16),dim1B:j[1].slice(16,32),dim1C:j[1].slice(32,48),dim1D:j[1].slice(48,64),drwLayer:V,contextColor:[W[0]/255,W[1]/255,W[2]/255,W[3]<1?W[3]:Math.max(1/255,Math.pow(1/l.lines.color.length,1/3))],scissorX:(k===L?0:I+X)+(N-X)+Q*oe.x[0],scissorWidth:(k===S?se-I+X:R+.5)+(k===L?I+X:0),scissorY:D+U+q*oe.y[0],scissorHeight:B,viewportX:N-X+Q*oe.x[0],viewportY:U+q*oe.y[0],viewportWidth:se,viewportHeight:ie},G);return Z}function b(l){var L=n-1,S=Math.max(0,Math.floor(l[0]*L),0),k=Math.min(L,Math.ceil(l[1]*L),L);return[Math.min(S,k),Math.max(S,k)]}re.exports=function(l,L){var S=L.context,k=L.pick,P=L.regl,z=P._gl,I=z.getParameter(z.ALIASED_LINE_WIDTH_RANGE),D=Math.max(I[0],Math.min(I[1],L.viewModel.plotGlPixelRatio)),R={currentRafs:{},drawCompleted:!0,clearOnly:!1},B,F,V,G,J=x(P),j,Y=P.texture(f),X=[];se(L);var oe=P({profile:!1,blend:{enable:S,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!S,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:P.prop("scissorX"),y:P.prop("scissorY"),width:P.prop("scissorWidth"),height:P.prop("scissorHeight")}},viewport:{x:P.prop("viewportX"),y:P.prop("viewportY"),width:P.prop("viewportWidth"),height:P.prop("viewportHeight")},dither:!1,vert:c,frag:M,primitive:"lines",lineWidth:D,attributes:J,uniforms:{resolution:P.prop("resolution"),viewBoxPos:P.prop("viewBoxPos"),viewBoxSize:P.prop("viewBoxSize"),dim0A:P.prop("dim0A"),dim1A:P.prop("dim1A"),dim0B:P.prop("dim0B"),dim1B:P.prop("dim1B"),dim0C:P.prop("dim0C"),dim1C:P.prop("dim1C"),dim0D:P.prop("dim0D"),dim1D:P.prop("dim1D"),loA:P.prop("loA"),hiA:P.prop("hiA"),loB:P.prop("loB"),hiB:P.prop("hiB"),loC:P.prop("loC"),hiC:P.prop("hiC"),loD:P.prop("loD"),hiD:P.prop("hiD"),palette:Y,contextColor:P.prop("contextColor"),maskTexture:P.prop("maskTexture"),drwLayer:P.prop("drwLayer"),maskHeight:P.prop("maskHeight")},offset:P.prop("offset"),count:P.prop("count")});function se(W){B=W.model,F=W.viewModel,V=F.dimensions.slice(),G=V[0]?V[0].values.length:0;var Z=B.lines,ee=k?Z.color.map(function(ae,le){return le/Z.color.length}):Z.color,te=m(G,V,ee);A(J,G,te),!S&&!k&&(Y=P.texture(e.extendFlat({data:y(B.unitToColor,255)},f)))}function ie(W){var Z,ee,te,ae=[[],[]];for(te=0;te<64;te++){var le=!W&&te<V.length?V[te].brush.filter.getBounds():[-1/0,1/0];ae[0][te]=le[0],ae[1][te]=le[1]}var ye=n*8,fe=new Array(ye);for(Z=0;Z<ye;Z++)fe[Z]=255;if(!W)for(Z=0;Z<V.length;Z++){var pe=Z%8,ge=(Z-pe)/8,Ae=Math.pow(2,pe),we=V[Z],De=we.brush.filter.get();if(!(De.length<2)){var Be=b(De[0])[1];for(ee=1;ee<De.length;ee++){var Ve=b(De[ee]);for(te=Be+1;te<Ve[0];te++)fe[te*8+ge]&=~Ae;Be=Math.max(Be,Ve[1])}}}var xe={shape:[8,n],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:fe};return j?j(xe):j=P.texture(xe),{maskTexture:j,maskHeight:n,loA:ae[0].slice(0,16),loB:ae[0].slice(16,32),loC:ae[0].slice(32,48),loD:ae[0].slice(48,64),hiA:ae[1].slice(0,16),hiB:ae[1].slice(16,32),hiC:ae[1].slice(32,48),hiD:ae[1].slice(48,64)}}function N(W,Z,ee){var te=W.length,ae,le,ye,fe=1/0,pe=-1/0;for(ae=0;ae<te;ae++)W[ae].dim0.canvasX<fe&&(fe=W[ae].dim0.canvasX,le=ae),W[ae].dim1.canvasX>pe&&(pe=W[ae].dim1.canvasX,ye=ae);te===0&&i(P,0,0,B.canvasWidth,B.canvasHeight);var ge=ie(S);for(ae=0;ae<te;ae++){var Ae=W[ae],we=Ae.dim0.crossfilterDimensionIndex,De=Ae.dim1.crossfilterDimensionIndex,Be=Ae.canvasX,Ve=Ae.canvasY,xe=Be+Ae.panelSizeX,Le=Ae.plotGlPixelRatio;if(Z||!X[we]||X[we][0]!==Be||X[we][1]!==xe){X[we]=[Be,xe];var He=v(B,le,ye,ae,we,De,Be,Ve,Ae.panelSizeX,Ae.panelSizeY,Ae.dim0.crossfilterDimensionIndex,S?0:k?2:1,ge,Le);R.clearOnly=ee;var Je=Z?B.lines.blockLineCount:G;g(P,oe,R,Je,G,He)}}}function U(W,Z){return P.read({x:W,y:Z,width:1,height:1,data:t}),t}function q(W,Z,ee,te){var ae=new Uint8Array(4*ee*te);return P.read({x:W,y:Z,width:ee,height:te,data:ae}),ae}function Q(){l.style["pointer-events"]="none",Y.destroy(),j&&j.destroy();for(var W in J)J[W].destroy()}return{render:N,readPixel:U,readPixels:q,destroy:Q,update:se}}},{"../../lib":503,"./constants":893,glslify:227}],898:[function(d,re,ne){re.exports=function(w,c,M,T){T||(T=1/0);var e,a;for(e=0;e<c.length;e++)a=c[e],a.visible&&(T=Math.min(T,a[M].length));for(T===1/0&&(T=0),w._length=T,e=0;e<c.length;e++)a=c[e],a.visible&&(a._length=T);return T}},{}],899:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=c.numberFormat,T=d("color-rgba"),e=d("../../plots/cartesian/axes"),a=c.strRotate,n=c.strTranslate,r=d("../../lib/svg_text_utils"),t=d("../../components/drawing"),f=d("../../components/colorscale"),o=d("../../lib/gup"),i=o.keyFun,g=o.repeat,p=o.unwrap,y=d("./helpers"),h=d("./constants"),m=d("./axisbrush"),u=d("./lines");function _(j,Y,X){return c.aggNums(j,null,Y,X)}function s(j,Y){return x(_(Math.min,j,Y),_(Math.max,j,Y))}function A(j){var Y=j.range;return Y?x(Y[0],Y[1]):s(j.values,j._length)}function x(j,Y){return(isNaN(j)||!isFinite(j))&&(j=0),(isNaN(Y)||!isFinite(Y))&&(Y=0),j===Y&&(j===0?(j-=1,Y+=1):(j*=.9,Y*=1.1)),[j,Y]}function v(j,Y){return Y?function(X,oe){var se=Y[oe];return se==null?j(X):se}:j}function b(j,Y,X,oe,se){var ie=A(X);return oe?w.scale.ordinal().domain(oe.map(v(M(X.tickformat),se))).range(oe.map(function(N){var U=(N-ie[0])/(ie[1]-ie[0]);return j-Y+U*(2*Y-j)})):w.scale.linear().domain(ie).range([j-Y,Y])}function l(j,Y){return w.scale.linear().range([Y,j-Y])}function L(j,Y){return w.scale.linear().domain(A(j)).range([Y,1-Y])}function S(j){if(!!j.tickvals){var Y=A(j);return w.scale.ordinal().domain(j.tickvals).range(j.tickvals.map(function(X){return(X-Y[0])/(Y[1]-Y[0])}))}}function k(j){var Y=j.map(function(ie){return ie[0]}),X=j.map(function(ie){var N=T(ie[1]);return w.rgb("rgb("+N[0]+","+N[1]+","+N[2]+")")}),oe=function(ie){return function(N){return N[ie]}},se="rgb".split("").map(function(ie){return w.scale.linear().clamp(!0).domain(Y).range(X.map(oe(ie)))});return function(ie){return se.map(function(N){return N(ie)})}}function P(j){return j.dimensions.some(function(Y){return Y.brush.filterSpecified})}function z(j,Y,X){var oe=p(Y),se=oe.trace,ie=y.convertTypedArray(oe.lineColor),N=se.line,U={color:T(h.deselectedLineColor)},q=f.extractOpts(N),Q=q.reversescale?f.flipScale(oe.cscale):oe.cscale,W=se.domain,Z=se.dimensions,ee=j.width,te=se.labelangle,ae=se.labelside,le=se.labelfont,ye=se.tickfont,fe=se.rangefont,pe=c.extendDeepNoArrays({},N,{color:ie.map(w.scale.linear().domain(A({values:ie,range:[q.min,q.max],_length:se._length}))),blockLineCount:h.blockLineCount,canvasOverdrag:h.overdrag*h.canvasPixelRatio}),ge=Math.floor(ee*(W.x[1]-W.x[0])),Ae=Math.floor(j.height*(W.y[1]-W.y[0])),we=j.margin||{l:80,r:80,t:100,b:80},De=ge,Be=Ae;return{key:X,colCount:Z.filter(y.isVisible).length,dimensions:Z,tickDistance:h.tickDistance,unitToColor:k(Q),lines:pe,deselectedLines:U,labelAngle:te,labelSide:ae,labelFont:le,tickFont:ye,rangeFont:fe,layoutWidth:ee,layoutHeight:j.height,domain:W,translateX:W.x[0]*ee,translateY:j.height-W.y[1]*j.height,pad:we,canvasWidth:De*h.canvasPixelRatio+2*pe.canvasOverdrag,canvasHeight:Be*h.canvasPixelRatio,width:De,height:Be,canvasPixelRatio:h.canvasPixelRatio}}function I(j,Y,X){var oe=X.width,se=X.height,ie=X.dimensions,N=X.canvasPixelRatio,U=function(ee){return oe*ee/Math.max(1,X.colCount-1)},q=h.verticalPadding/se,Q=l(se,h.verticalPadding),W={key:X.key,xScale:U,model:X,inBrushDrag:!1},Z={};return W.dimensions=ie.filter(y.isVisible).map(function(ee,te){var ae=L(ee,q),le=Z[ee.label];Z[ee.label]=(le||0)+1;var ye=ee.label+(le?"__"+le:""),fe=ee.constraintrange,pe=fe&&fe.length;pe&&!Array.isArray(fe[0])&&(fe=[fe]);var ge=pe?fe.map(function(Oe){return Oe.map(ae)}):[[-1/0,1/0]],Ae=function(){var Oe=W;Oe.focusLayer&&Oe.focusLayer.render(Oe.panels,!0);var Pe=P(Oe);!j.contextShown()&&Pe?(Oe.contextLayer&&Oe.contextLayer.render(Oe.panels,!0),j.contextShown(!0)):j.contextShown()&&!Pe&&(Oe.contextLayer&&Oe.contextLayer.render(Oe.panels,!0,!0),j.contextShown(!1))},we=ee.values;we.length>ee._length&&(we=we.slice(0,ee._length));var De=ee.tickvals,Be;function Ve(Oe,Pe){return{val:Oe,text:Be[Pe]}}function xe(Oe,Pe){return Oe.val-Pe.val}if(Array.isArray(De)&&De.length){Be=ee.ticktext,!Array.isArray(Be)||!Be.length?Be=De.map(M(ee.tickformat)):Be.length>De.length?Be=Be.slice(0,De.length):De.length>Be.length&&(De=De.slice(0,Be.length));for(var Le=1;Le<De.length;Le++)if(De[Le]<De[Le-1]){for(var He=De.map(Ve).sort(xe),Je=0;Je<De.length;Je++)De[Je]=He[Je].val,Be[Je]=He[Je].text;break}}else De=void 0;return we=y.convertTypedArray(we),{key:ye,label:ee.label,tickFormat:ee.tickformat,tickvals:De,ticktext:Be,ordinal:y.isOrdinal(ee),multiselect:ee.multiselect,xIndex:te,crossfilterDimensionIndex:te,visibleIndex:ee._index,height:se,values:we,paddedUnitValues:we.map(ae),unitTickvals:De&&De.map(ae),xScale:U,x:U(te),canvasX:U(te)*N,unitToPaddedPx:Q,domainScale:b(se,h.verticalPadding,ee,De,Be),ordinalScale:S(ee),parent:W,model:X,brush:m.makeBrush(j,pe,ge,function(){j.linePickActive(!1)},Ae,function(Oe){if(W.focusLayer.render(W.panels,!0),W.pickLayer&&W.pickLayer.render(W.panels,!0),j.linePickActive(!0),Y&&Y.filterChanged){var Pe=ae.invert,Ue=Oe.map(function(vt){return vt.map(Pe).sort(c.sorterAsc)}).sort(function(vt,Lt){return vt[0]-Lt[0]});Y.filterChanged(W.key,ee._index,Ue)}})}}),W}function D(j){j.classed(h.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function R(){var j=!0,Y=!1;return{linePickActive:function(X){return arguments.length?j=!!X:j},contextShown:function(X){return arguments.length?Y=!!X:Y}}}function B(j,Y){var X=Y==="top"?1:-1,oe=j*Math.PI/180,se=Math.sin(oe),ie=Math.cos(oe);return{dir:X,dx:se,dy:ie,degrees:j}}function F(j,Y,X){for(var oe=Y.panels||(Y.panels=[]),se=j.data(),ie=0;ie<se.length-1;ie++){var N=oe[ie]||(oe[ie]={}),U=se[ie],q=se[ie+1];N.dim0=U,N.dim1=q,N.canvasX=U.canvasX,N.panelSizeX=q.canvasX-U.canvasX,N.panelSizeY=Y.model.canvasHeight,N.y=0,N.canvasY=0,N.plotGlPixelRatio=X}}function V(j){for(var Y=0;Y<j.length;Y++)for(var X=0;X<j[Y].length;X++)for(var oe=j[Y][X].trace,se=oe.dimensions,ie=0;ie<se.length;ie++){var N=se[ie].values,U=se[ie]._ax;U&&(U.range?U.range=x(U.range[0],U.range[1]):U.range=s(N,oe._length),U.dtick||(U.dtick=.01*(Math.abs(U.range[1]-U.range[0])||1)),U.tickformat=se[ie].tickformat,e.calcTicks(U),U.cleanRange())}}function G(j,Y){return e.tickText(j._ax,Y,!1).text}function J(j,Y){if(j.ordinal)return"";var X=j.domainScale.domain(),oe=X[Y?X.length-1:0];return G(j.model.dimensions[j.visibleIndex],oe)}re.exports=function(Y,X,oe,se){var ie=Y._fullLayout,N=ie._toppaper,U=ie._glcontainer,q=Y._context.plotGlPixelRatio,Q=Y._fullLayout.paper_bgcolor;V(X);var W=R(),Z=X.filter(function(He){return p(He).trace.visible}).map(z.bind(0,oe)).map(I.bind(0,W,se));U.each(function(He,Je){return c.extendFlat(He,Z[Je])});var ee=U.selectAll(".gl-canvas").each(function(He){He.viewModel=Z[0],He.viewModel.plotGlPixelRatio=q,He.viewModel.paperColor=Q,He.model=He.viewModel?He.viewModel.model:null}),te=null,ae=ee.filter(function(He){return He.pick});ae.style("pointer-events","auto").on("mousemove",function(He){if(W.linePickActive()&&He.lineLayer&&se&&se.hover){var Je=w.event,Oe=this.width,Pe=this.height,Ue=w.mouse(this),vt=Ue[0],Lt=Ue[1];if(vt<0||Lt<0||vt>=Oe||Lt>=Pe)return;var Yt=He.lineLayer.readPixel(vt,Pe-1-Lt),At=Yt[3]!==0,Rt=At?Yt[2]+256*(Yt[1]+256*Yt[0]):null,Bt={x:vt,y:Lt,clientX:Je.clientX,clientY:Je.clientY,dataIndex:He.model.key,curveNumber:Rt};Rt!==te&&(At?se.hover(Bt):se.unhover&&se.unhover(Bt),te=Rt)}}),ee.style("opacity",function(He){return He.pick?0:1}),N.style("background","rgba(255, 255, 255, 0)");var le=N.selectAll("."+h.cn.parcoords).data(Z,i);le.exit().remove(),le.enter().append("g").classed(h.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),le.attr("transform",function(He){return n(He.model.translateX,He.model.translateY)});var ye=le.selectAll("."+h.cn.parcoordsControlView).data(g,i);ye.enter().append("g").classed(h.cn.parcoordsControlView,!0),ye.attr("transform",function(He){return n(He.model.pad.l,He.model.pad.t)});var fe=ye.selectAll("."+h.cn.yAxis).data(function(He){return He.dimensions},i);fe.enter().append("g").classed(h.cn.yAxis,!0),ye.each(function(He){F(fe,He,q)}),ee.each(function(He){if(He.viewModel){!He.lineLayer||se?He.lineLayer=u(this,He):He.lineLayer.update(He),(He.key||He.key===0)&&(He.viewModel[He.key]=He.lineLayer);var Je=!He.context||se;He.lineLayer.render(He.viewModel.panels,Je)}}),fe.attr("transform",function(He){return n(He.xScale(He.xIndex),0)}),fe.call(w.behavior.drag().origin(function(He){return He}).on("drag",function(He){var Je=He.parent;W.linePickActive(!1),He.x=Math.max(-h.overdrag,Math.min(He.model.width+h.overdrag,w.event.x)),He.canvasX=He.x*He.model.canvasPixelRatio,fe.sort(function(Oe,Pe){return Oe.x-Pe.x}).each(function(Oe,Pe){Oe.xIndex=Pe,Oe.x=He===Oe?Oe.x:Oe.xScale(Oe.xIndex),Oe.canvasX=Oe.x*Oe.model.canvasPixelRatio}),F(fe,Je,q),fe.filter(function(Oe){return Math.abs(He.xIndex-Oe.xIndex)!==0}).attr("transform",function(Oe){return n(Oe.xScale(Oe.xIndex),0)}),w.select(this).attr("transform",n(He.x,0)),fe.each(function(Oe,Pe,Ue){Ue===He.parent.key&&(Je.dimensions[Pe]=Oe)}),Je.contextLayer&&Je.contextLayer.render(Je.panels,!1,!P(Je)),Je.focusLayer.render&&Je.focusLayer.render(Je.panels)}).on("dragend",function(He){var Je=He.parent;He.x=He.xScale(He.xIndex),He.canvasX=He.x*He.model.canvasPixelRatio,F(fe,Je,q),w.select(this).attr("transform",function(Oe){return n(Oe.x,0)}),Je.contextLayer&&Je.contextLayer.render(Je.panels,!1,!P(Je)),Je.focusLayer&&Je.focusLayer.render(Je.panels),Je.pickLayer&&Je.pickLayer.render(Je.panels,!0),W.linePickActive(!0),se&&se.axesMoved&&se.axesMoved(Je.key,Je.dimensions.map(function(Oe){return Oe.crossfilterDimensionIndex}))})),fe.exit().remove();var pe=fe.selectAll("."+h.cn.axisOverlays).data(g,i);pe.enter().append("g").classed(h.cn.axisOverlays,!0),pe.selectAll("."+h.cn.axis).remove();var ge=pe.selectAll("."+h.cn.axis).data(g,i);ge.enter().append("g").classed(h.cn.axis,!0),ge.each(function(He){var Je=He.model.height/He.model.tickDistance,Oe=He.domainScale,Pe=Oe.domain();w.select(this).call(w.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Je,He.tickFormat).tickValues(He.ordinal?Pe:null).tickFormat(function(Ue){return y.isOrdinal(He)?Ue:G(He.model.dimensions[He.visibleIndex],Ue)}).scale(Oe)),t.font(ge.selectAll("text"),He.model.tickFont)}),ge.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),ge.selectAll("text").style("text-shadow",r.makeTextShadow(Q)).style("cursor","default");var Ae=pe.selectAll("."+h.cn.axisHeading).data(g,i);Ae.enter().append("g").classed(h.cn.axisHeading,!0);var we=Ae.selectAll("."+h.cn.axisTitle).data(g,i);we.enter().append("text").classed(h.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),we.text(function(He){return He.label}).each(function(He){var Je=w.select(this);t.font(Je,He.model.labelFont),r.convertToTspans(Je,Y)}).attr("transform",function(He){var Je=B(He.model.labelAngle,He.model.labelSide),Oe=h.axisTitleOffset;return(Je.dir>0?"":n(0,2*Oe+He.model.height))+a(Je.degrees)+n(-Oe*Je.dx,-Oe*Je.dy)}).attr("text-anchor",function(He){var Je=B(He.model.labelAngle,He.model.labelSide),Oe=Math.abs(Je.dx),Pe=Math.abs(Je.dy);return 2*Oe>Pe?Je.dir*Je.dx<0?"start":"end":"middle"});var De=pe.selectAll("."+h.cn.axisExtent).data(g,i);De.enter().append("g").classed(h.cn.axisExtent,!0);var Be=De.selectAll("."+h.cn.axisExtentTop).data(g,i);Be.enter().append("g").classed(h.cn.axisExtentTop,!0),Be.attr("transform",n(0,-h.axisExtentOffset));var Ve=Be.selectAll("."+h.cn.axisExtentTopText).data(g,i);Ve.enter().append("text").classed(h.cn.axisExtentTopText,!0).call(D),Ve.text(function(He){return J(He,!0)}).each(function(He){t.font(w.select(this),He.model.rangeFont)});var xe=De.selectAll("."+h.cn.axisExtentBottom).data(g,i);xe.enter().append("g").classed(h.cn.axisExtentBottom,!0),xe.attr("transform",function(He){return n(0,He.model.height+h.axisExtentOffset)});var Le=xe.selectAll("."+h.cn.axisExtentBottomText).data(g,i);Le.enter().append("text").classed(h.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(D),Le.text(function(He){return J(He,!1)}).each(function(He){t.font(w.select(this),He.model.rangeFont)}),m.ensureAxisBrush(pe,Q)}},{"../../components/colorscale":378,"../../components/drawing":388,"../../lib":503,"../../lib/gup":500,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"./axisbrush":889,"./constants":893,"./helpers":895,"./lines":897,"@plotly/d3":58,"color-rgba":91}],900:[function(d,re,n){var w=d("./parcoords"),c=d("../../lib/prepare_regl"),M=d("./helpers").isVisible,T={};function e(r,t,f){var o=t.indexOf(f),i=r.indexOf(o);return i===-1&&(i+=t.length),i}function a(r,t){return function(o,i){return e(r,t,o)-e(r,t,i)}}var n=re.exports=function(t,f){var o=t._fullLayout,i=c(t,[],T);if(!!i){var g={},p={},y={},h={},m=o._size;f.forEach(function(x,v){var b=x[0].trace;y[v]=b.index;var l=h[v]=b._fullInput.index;g[v]=t.data[l].dimensions,p[v]=t.data[l].dimensions.slice()});var u=function(x,v,b){var l=p[x][v],L=b.map(function(D){return D.slice()}),S="dimensions["+v+"].constraintrange",k=o._tracePreGUI[t._fullData[y[x]]._fullInput.uid];if(k[S]===void 0){var P=l.constraintrange;k[S]=P||null}var z=t._fullData[y[x]].dimensions[v];L.length?(L.length===1&&(L=L[0]),l.constraintrange=L,z.constraintrange=L.slice(),L=[L]):(delete l.constraintrange,delete z.constraintrange,L=null);var I={};I[S]=L,t.emit("plotly_restyle",[I,[h[x]]])},_=function(x){t.emit("plotly_hover",x)},s=function(x){t.emit("plotly_unhover",x)},A=function(x,v){var b=a(v,p[x].filter(M));g[x].sort(b),p[x].filter(function(l){return!M(l)}).sort(function(l){return p[x].indexOf(l)}).forEach(function(l){g[x].splice(g[x].indexOf(l),1),g[x].splice(p[x].indexOf(l),0,l)}),t.emit("plotly_restyle",[{dimensions:[g[x]]},[h[x]]])};w(t,f,{width:m.w,height:m.h,margin:{t:m.t,r:m.r,b:m.b,l:m.l}},{filterChanged:u,hover:_,unhover:s,axesMoved:A})}};n.reglPrecompiled=T},{"../../lib/prepare_regl":516,"./helpers":895,"./parcoords":899}],901:[function(d,re,ne){var w=d("../../plots/attributes"),c=d("../../plots/domain").attributes,M=d("../../plots/font_attributes"),T=d("../../components/color/attributes"),e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("../../lib/extend").extendFlat,r=M({editType:"plot",arrayOk:!0,colorEditType:"plot"});re.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:T.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:n({},w.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:a({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:n({},r,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:n({},r,{}),outsidetextfont:n({},r,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:n({},r,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:c({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:n({},r,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":365,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/font_attributes":585,"../../plots/template_attributes":633}],902:[function(d,re,ne){var w=d("../../plots/plots");ne.name="pie",ne.plot=function(c,M,T,e){w.plotBasePlot(ne.name,c,M,T,e)},ne.clean=function(c,M,T,e){w.cleanBasePlot(ne.name,c,M,T,e)}},{"../../plots/plots":619}],903:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("tinycolor2"),M=d("../../components/color"),T={};function e(t,f){var o=[],i=t._fullLayout,g=i.hiddenlabels||[],p=f.labels,y=f.marker.colors||[],h=f.values,m=f._length,u=f._hasValues&&m,_,s;if(f.dlabel)for(p=new Array(m),_=0;_<m;_++)p[_]=String(f.label0+_*f.dlabel);var A={},x=a(i["_"+f.type+"colormap"]),v=0,b=!1;for(_=0;_<m;_++){var l,L,S;if(u){if(l=h[_],!w(l))continue;l=+l}else l=1;L=p[_],(L===void 0||L==="")&&(L=_),L=String(L);var k=A[L];k===void 0?(A[L]=o.length,S=g.indexOf(L)!==-1,S||(v+=l),o.push({v:l,label:L,color:x(y[_],L),i:_,pts:[_],hidden:S})):(b=!0,s=o[k],s.v+=l,s.pts.push(_),s.hidden||(v+=l),s.color===!1&&y[_]&&(s.color=x(y[_],L)))}o=o.filter(function(z){return z.v>=0});var P=f.type==="funnelarea"?b:f.sort;return P&&o.sort(function(z,I){return I.v-z.v}),o[0]&&(o[0].vTotal=v),o}function a(t){return function(o,i){return!o||(o=c(o),!o.isValid())?!1:(o=M.addOpacity(o,o.getAlpha()),t[i]||(t[i]=o),o)}}function n(t,f){var o=(f||{}).type;o||(o="pie");var i=t._fullLayout,g=t.calcdata,p=i[o+"colorway"],y=i["_"+o+"colormap"];i["extend"+o+"colors"]&&(p=r(p,T));for(var h=0,m=0;m<g.length;m++){var u=g[m],_=u[0].trace.type;if(_===o)for(var s=0;s<u.length;s++){var A=u[s];A.color===!1&&(y[A.label]?A.color=y[A.label]:(y[A.label]=A.color=p[h%p.length],h++))}}}function r(t,f){var o,i=JSON.stringify(t),g=f[i];if(!g){for(g=t.slice(),o=0;o<t.length;o++)g.push(c(t[o]).lighten(20).toHexString());for(o=0;o<t.length;o++)g.push(c(t[o]).darken(20).toHexString());f[i]=g}return g}re.exports={calc:e,crossTraceCalc:n,makePullColorFn:a,generateExtendedColors:r}},{"../../components/color":366,"fast-isnumeric":190,tinycolor2:312}],904:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("./attributes"),T=d("../../plots/domain").defaults,e=d("../bar/defaults").handleText;function a(r,t){var f=Array.isArray(r),o=c.isArrayOrTypedArray(t),i=Math.min(f?r.length:1/0,o?t.length:1/0);if(isFinite(i)||(i=0),i&&o){for(var g,p=0;p<i;p++){var y=t[p];if(w(y)&&y>0){g=!0;break}}g||(i=0)}return{hasLabels:f,hasValues:o,len:i}}function n(r,t,f,o){function i(S,k){return c.coerce(r,t,M,S,k)}var g=i("labels"),p=i("values"),y=a(g,p),h=y.len;if(t._hasLabels=y.hasLabels,t._hasValues=y.hasValues,!t._hasLabels&&t._hasValues&&(i("label0"),i("dlabel")),!h){t.visible=!1;return}t._length=h;var m=i("marker.line.width");m&&i("marker.line.color"),i("marker.colors"),i("scalegroup");var u=i("text"),_=i("texttemplate"),s;if(_||(s=i("textinfo",Array.isArray(u)?"text+percent":"percent")),i("hovertext"),i("hovertemplate"),_||s&&s!=="none"){var A=i("textposition");e(r,t,o,i,A,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1});var x=Array.isArray(A)||A==="auto",v=x||A==="outside";v&&i("automargin"),(A==="inside"||A==="auto"||Array.isArray(A))&&i("insidetextorientation")}T(t,o,i);var b=i("hole"),l=i("title.text");if(l){var L=i("title.position",b?"middle center":"top center");!b&&L==="middle center"&&(t.title.position="top center"),c.coerceFont(i,"title.font",o.font)}i("sort"),i("direction"),i("rotation"),i("pull")}re.exports={handleLabelsAndValues:a,supplyDefaults:n}},{"../../lib":503,"../../plots/domain":584,"../bar/defaults":652,"./attributes":901,"fast-isnumeric":190}],905:[function(d,re,ne){var w=d("../../components/fx/helpers").appendArrayMultiPointValues;re.exports=function(M,T){var e={curveNumber:T.index,pointNumbers:M.pts,data:T._input,fullData:T,label:M.label,color:M.color,value:M.v,percent:M.percent,text:M.text,bbox:M.bbox,v:M.v};return M.pts.length===1&&(e.pointNumber=e.i=M.pts[0]),w(e,T,M.pts),T.type==="funnelarea"&&(delete e.v,delete e.i),e}},{"../../components/fx/helpers":402}],906:[function(d,re,ne){var w=d("../../lib");function c(M){return M.indexOf("e")!==-1?M.replace(/[.]?0+e/,"e"):M.indexOf(".")!==-1?M.replace(/[.]?0+$/,""):M}ne.formatPiePercent=function(T,e){var a=c((T*100).toPrecision(3));return w.numSeparate(a,e)+"%"},ne.formatPieValue=function(T,e){var a=c(T.toPrecision(10));return w.numSeparate(a,e)},ne.getFirstFilled=function(T,e){if(!!Array.isArray(T))for(var a=0;a<e.length;a++){var n=T[e[a]];if(n||n===0||n==="")return n}},ne.castOption=function(T,e){if(Array.isArray(T))return ne.getFirstFilled(T,e);if(T)return T},ne.getRotationAngle=function(M){return(M==="auto"?0:M)*Math.PI/180}},{"../../lib":503}],907:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,supplyLayoutDefaults:d("./layout_defaults"),layoutAttributes:d("./layout_attributes"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot").plot,style:d("./style"),styleOne:d("./style_one"),moduleType:"trace",name:"pie",basePlotModule:d("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":901,"./base_plot":902,"./calc":903,"./defaults":904,"./layout_attributes":908,"./layout_defaults":909,"./plot":910,"./style":911,"./style_one":912}],908:[function(d,re,ne){re.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],909:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes");re.exports=function(T,e){function a(n,r){return w.coerce(T,e,c,n,r)}a("hiddenlabels"),a("piecolorway",e.colorway),a("extendpiecolors")}},{"../../lib":503,"./layout_attributes":908}],910:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../plots/plots"),M=d("../../components/fx"),T=d("../../components/color"),e=d("../../components/drawing"),a=d("../../lib"),n=a.strScale,r=a.strTranslate,t=d("../../lib/svg_text_utils"),f=d("../bar/uniform_text"),o=f.recordMinTextSize,i=f.clearMinTextSize,g=d("../bar/constants").TEXTPAD,p=d("./helpers"),y=d("./event_data"),h=d("../../lib").isValidTextValue;function m(ie,N){var U=ie._fullLayout,q=U._size;i("pie",U),x(N,ie),J(N,q);var Q=a.makeTraceGroups(U._pielayer,N,"trace").each(function(W){var Z=w.select(this),ee=W[0],te=ee.trace;Y(W),Z.attr("stroke-linejoin","round"),Z.each(function(){var ae=w.select(this).selectAll("g.slice").data(W);ae.enter().append("g").classed("slice",!0),ae.exit().remove();var le=[[[],[]],[[],[]]],ye=!1;ae.each(function(Ve,xe){if(Ve.hidden){w.select(this).selectAll("path,g").remove();return}Ve.pointNumber=Ve.i,Ve.curveNumber=te.index,le[Ve.pxmid[1]<0?0:1][Ve.pxmid[0]<0?0:1].push(Ve);var Le=ee.cx,He=ee.cy,Je=w.select(this),Oe=Je.selectAll("path.surface").data([Ve]);if(Oe.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),Je.call(_,ie,W),te.pull){var Pe=+p.castOption(te.pull,Ve.pts)||0;Pe>0&&(Le+=Pe*Ve.pxmid[0],He+=Pe*Ve.pxmid[1])}Ve.cxFinal=Le,Ve.cyFinal=He;function Ue(Mt,Tt,at,ct){var je=ct*(Tt[0]-Mt[0]),ke=ct*(Tt[1]-Mt[1]);return"a"+ct*ee.r+","+ct*ee.r+" 0 "+Ve.largeArc+(at?" 1 ":" 0 ")+je+","+ke}var vt=te.hole;if(Ve.v===ee.vTotal){var Lt="M"+(Le+Ve.px0[0])+","+(He+Ve.px0[1])+Ue(Ve.px0,Ve.pxmid,!0,1)+Ue(Ve.pxmid,Ve.px0,!0,1)+"Z";vt?Oe.attr("d","M"+(Le+vt*Ve.px0[0])+","+(He+vt*Ve.px0[1])+Ue(Ve.px0,Ve.pxmid,!1,vt)+Ue(Ve.pxmid,Ve.px0,!1,vt)+"Z"+Lt):Oe.attr("d",Lt)}else{var Yt=Ue(Ve.px0,Ve.px1,!0,1);if(vt){var At=1-vt;Oe.attr("d","M"+(Le+vt*Ve.px1[0])+","+(He+vt*Ve.px1[1])+Ue(Ve.px1,Ve.px0,!1,vt)+"l"+At*Ve.px0[0]+","+At*Ve.px0[1]+Yt+"Z")}else Oe.attr("d","M"+Le+","+He+"l"+Ve.px0[0]+","+Ve.px0[1]+Yt+"Z")}oe(ie,Ve,ee);var Rt=p.castOption(te.textposition,Ve.pts),Bt=Je.selectAll("g.slicetext").data(Ve.text&&Rt!=="none"?[0]:[]);Bt.enter().append("g").classed("slicetext",!0),Bt.exit().remove(),Bt.each(function(){var Mt=a.ensureSingle(w.select(this),"text","",function(st){st.attr("data-notex",1)}),Tt=a.ensureUniformFontSize(ie,Rt==="outside"?s(te,Ve,U.font):A(te,Ve,U.font));Mt.text(Ve.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,Tt).call(t.convertToTspans,ie);var at=e.bBox(Mt.node()),ct;if(Rt==="outside")ct=I(at,Ve);else if(ct=v(at,Ve,ee),Rt==="auto"&&ct.scale<1){var je=a.ensureUniformFontSize(ie,te.outsidetextfont);Mt.call(e.font,je),at=e.bBox(Mt.node()),ct=I(at,Ve)}var ke=ct.textPosAngle,Ye=ke===void 0?Ve.pxmid:X(ee.r,ke);if(ct.targetX=Le+Ye[0]*ct.rCenter+(ct.x||0),ct.targetY=He+Ye[1]*ct.rCenter+(ct.y||0),se(ct,at),ct.outside){var Ke=ct.targetY;Ve.yLabelMin=Ke-at.height/2,Ve.yLabelMid=Ke,Ve.yLabelMax=Ke+at.height/2,Ve.labelExtraX=0,Ve.labelExtraY=0,ye=!0}ct.fontSize=Tt.size,o(te.type,ct,U),W[xe].transform=ct,Mt.attr("transform",a.getTextTransform(ct))})});var fe=w.select(this).selectAll("g.titletext").data(te.title.text?[0]:[]);if(fe.enter().append("g").classed("titletext",!0),fe.exit().remove(),fe.each(function(){var Ve=a.ensureSingle(w.select(this),"text","",function(He){He.attr("data-notex",1)}),xe=te.title.text;te._meta&&(xe=a.templateString(xe,te._meta)),Ve.text(xe).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,te.title.font).call(t.convertToTspans,ie);var Le;te.title.position==="middle center"?Le=D(ee):Le=R(ee,q),Ve.attr("transform",r(Le.x,Le.y)+n(Math.min(1,Le.scale))+r(Le.tx,Le.ty))}),ye&&G(le,te),u(ae,te),ye&&te.automargin){var pe=e.bBox(Z.node()),ge=te.domain,Ae=q.w*(ge.x[1]-ge.x[0]),we=q.h*(ge.y[1]-ge.y[0]),De=(.5*Ae-ee.r)/q.w,Be=(.5*we-ee.r)/q.h;c.autoMargin(ie,"pie."+te.uid+".automargin",{xl:ge.x[0]-De,xr:ge.x[1]+De,yb:ge.y[0]-Be,yt:ge.y[1]+Be,l:Math.max(ee.cx-ee.r-pe.left,0),r:Math.max(pe.right-(ee.cx+ee.r),0),b:Math.max(pe.bottom-(ee.cy+ee.r),0),t:Math.max(ee.cy-ee.r-pe.top,0),pad:5})}})});setTimeout(function(){Q.selectAll("tspan").each(function(){var W=w.select(this);W.attr("dy")&&W.attr("dy",W.attr("dy"))})},0)}function u(ie,N){ie.each(function(U){var q=w.select(this);if(!U.labelExtraX&&!U.labelExtraY){q.select("path.textline").remove();return}var Q=q.select("g.slicetext text");U.transform.targetX+=U.labelExtraX,U.transform.targetY+=U.labelExtraY,Q.attr("transform",a.getTextTransform(U.transform));var W=U.cxFinal+U.pxmid[0],Z=U.cyFinal+U.pxmid[1],ee="M"+W+","+Z,te=(U.yLabelMax-U.yLabelMin)*(U.pxmid[0]<0?-1:1)/4;if(U.labelExtraX){var ae=U.labelExtraX*U.pxmid[1]/U.pxmid[0],le=U.yLabelMid+U.labelExtraY-(U.cyFinal+U.pxmid[1]);Math.abs(ae)>Math.abs(le)?ee+="l"+le*U.pxmid[0]/U.pxmid[1]+","+le+"H"+(W+U.labelExtraX+te):ee+="l"+U.labelExtraX+","+ae+"v"+(le-ae)+"h"+te}else ee+="V"+(U.yLabelMid+U.labelExtraY)+"h"+te;a.ensureSingle(q,"path","textline").call(T.stroke,N.outsidetextfont.color).attr({"stroke-width":Math.min(2,N.outsidetextfont.size/8),d:ee,fill:"none"})})}function _(ie,N,U){var q=U[0],Q=q.cx,W=q.cy,Z=q.trace,ee=Z.type==="funnelarea";"_hasHoverLabel"in Z||(Z._hasHoverLabel=!1),"_hasHoverEvent"in Z||(Z._hasHoverEvent=!1),ie.on("mouseover",function(te){var ae=N._fullLayout,le=N._fullData[Z.index];if(!(N._dragging||ae.hovermode===!1)){var ye=le.hoverinfo;if(Array.isArray(ye)&&(ye=M.castHoverinfo({hoverinfo:[p.castOption(ye,te.pts)],_module:Z._module},ae,0)),ye==="all"&&(ye="label+text+value+percent+name"),le.hovertemplate||ye!=="none"&&ye!=="skip"&&ye){var fe=te.rInscribed||0,pe=Q+te.pxmid[0]*(1-fe),ge=W+te.pxmid[1]*(1-fe),Ae=ae.separators,we=[];if(ye&&ye.indexOf("label")!==-1&&we.push(te.label),te.text=p.castOption(le.hovertext||le.text,te.pts),ye&&ye.indexOf("text")!==-1){var De=te.text;a.isValidTextValue(De)&&we.push(De)}te.value=te.v,te.valueLabel=p.formatPieValue(te.v,Ae),ye&&ye.indexOf("value")!==-1&&we.push(te.valueLabel),te.percent=te.v/q.vTotal,te.percentLabel=p.formatPiePercent(te.percent,Ae),ye&&ye.indexOf("percent")!==-1&&we.push(te.percentLabel);var Be=le.hoverlabel,Ve=Be.font,xe=[];M.loneHover({trace:Z,x0:pe-fe*q.r,x1:pe+fe*q.r,y:ge,_x0:ee?Q+te.TL[0]:pe-fe*q.r,_x1:ee?Q+te.TR[0]:pe+fe*q.r,_y0:ee?W+te.TL[1]:ge-fe*q.r,_y1:ee?W+te.BL[1]:ge+fe*q.r,text:we.join("<br>"),name:le.hovertemplate||ye.indexOf("name")!==-1?le.name:void 0,idealAlign:te.pxmid[0]<0?"left":"right",color:p.castOption(Be.bgcolor,te.pts)||te.color,borderColor:p.castOption(Be.bordercolor,te.pts),fontFamily:p.castOption(Ve.family,te.pts),fontSize:p.castOption(Ve.size,te.pts),fontColor:p.castOption(Ve.color,te.pts),nameLength:p.castOption(Be.namelength,te.pts),textAlign:p.castOption(Be.align,te.pts),hovertemplate:p.castOption(le.hovertemplate,te.pts),hovertemplateLabels:te,eventData:[y(te,le)]},{container:ae._hoverlayer.node(),outerContainer:ae._paper.node(),gd:N,inOut_bbox:xe}),te.bbox=xe[0],Z._hasHoverLabel=!0}Z._hasHoverEvent=!0,N.emit("plotly_hover",{points:[y(te,le)],event:w.event})}}),ie.on("mouseout",function(te){var ae=N._fullLayout,le=N._fullData[Z.index],ye=w.select(this).datum();Z._hasHoverEvent&&(te.originalEvent=w.event,N.emit("plotly_unhover",{points:[y(ye,le)],event:w.event}),Z._hasHoverEvent=!1),Z._hasHoverLabel&&(M.loneUnhover(ae._hoverlayer.node()),Z._hasHoverLabel=!1)}),ie.on("click",function(te){var ae=N._fullLayout,le=N._fullData[Z.index];N._dragging||ae.hovermode===!1||(N._hoverdata=[y(te,le)],M.click(N,w.event))})}function s(ie,N,U){var q=p.castOption(ie.outsidetextfont.color,N.pts)||p.castOption(ie.textfont.color,N.pts)||U.color,Q=p.castOption(ie.outsidetextfont.family,N.pts)||p.castOption(ie.textfont.family,N.pts)||U.family,W=p.castOption(ie.outsidetextfont.size,N.pts)||p.castOption(ie.textfont.size,N.pts)||U.size;return{color:q,family:Q,size:W}}function A(ie,N,U){var q=p.castOption(ie.insidetextfont.color,N.pts);!q&&ie._input.textfont&&(q=p.castOption(ie._input.textfont.color,N.pts));var Q=p.castOption(ie.insidetextfont.family,N.pts)||p.castOption(ie.textfont.family,N.pts)||U.family,W=p.castOption(ie.insidetextfont.size,N.pts)||p.castOption(ie.textfont.size,N.pts)||U.size;return{color:q||T.contrast(N.color),family:Q,size:W}}function x(ie,N){for(var U,q,Q=0;Q<ie.length;Q++)if(U=ie[Q][0],q=U.trace,q.title.text){var W=q.title.text;q._meta&&(W=a.templateString(W,q._meta));var Z=e.tester.append("text").attr("data-notex",1).text(W).call(e.font,q.title.font).call(t.convertToTspans,N),ee=e.bBox(Z.node(),!0);U.titleBox={width:ee.width,height:ee.height},Z.remove()}}function v(ie,N,U){var q=U.r||N.rpx1,Q=N.rInscribed,W=N.startangle===N.stopangle;if(W)return{rCenter:1-Q,scale:0,rotate:0,textPosAngle:0};var Z=N.ring,ee=Z===1&&Math.abs(N.startangle-N.stopangle)===Math.PI*2,te=N.halfangle,ae=N.midangle,le=U.trace.insidetextorientation,ye=le==="horizontal",fe=le==="tangential",pe=le==="radial",ge=le==="auto",Ae=[],we;if(!ge){var De=function(Oe,Pe){if(b(N,Oe)){var Ue=Math.abs(Oe-N.startangle),vt=Math.abs(Oe-N.stopangle),Lt=Ue<vt?Ue:vt;Pe==="tan"?we=L(ie,q,Z,Lt,0):we=l(ie,q,Z,Lt,Math.PI/2),we.textPosAngle=Oe,Ae.push(we)}},Be;if(ye||fe){for(Be=4;Be>=-4;Be-=2)De(Math.PI*Be,"tan");for(Be=4;Be>=-4;Be-=2)De(Math.PI*(Be+1),"tan")}if(ye||pe){for(Be=4;Be>=-4;Be-=2)De(Math.PI*(Be+1.5),"rad");for(Be=4;Be>=-4;Be-=2)De(Math.PI*(Be+.5),"rad")}}if(ee||ge||ye){var Ve=Math.sqrt(ie.width*ie.width+ie.height*ie.height);if(we={scale:Q*q*2/Ve,rCenter:1-Q,rotate:0},we.textPosAngle=(N.startangle+N.stopangle)/2,we.scale>=1)return we;Ae.push(we)}(ge||pe)&&(we=l(ie,q,Z,te,ae),we.textPosAngle=(N.startangle+N.stopangle)/2,Ae.push(we)),(ge||fe)&&(we=L(ie,q,Z,te,ae),we.textPosAngle=(N.startangle+N.stopangle)/2,Ae.push(we));for(var xe=0,Le=0,He=0;He<Ae.length;He++){var Je=Ae[He].scale;if(Le<Je&&(Le=Je,xe=He),!ge&&Le>=1)break}return Ae[xe]}function b(ie,N){var U=ie.startangle,q=ie.stopangle;return U>N&&N>q||U<N&&N<q}function l(ie,N,U,q,Q){N=Math.max(0,N-2*g);var W=ie.width/ie.height,Z=P(W,q,N,U);return{scale:Z*2/ie.height,rCenter:S(W,Z/N),rotate:k(Q)}}function L(ie,N,U,q,Q){N=Math.max(0,N-2*g);var W=ie.height/ie.width,Z=P(W,q,N,U);return{scale:Z*2/ie.width,rCenter:S(W,Z/N),rotate:k(Q+Math.PI/2)}}function S(ie,N){return Math.cos(N)-ie*N}function k(ie){return(180/Math.PI*ie+720)%180-90}function P(ie,N,U,q){var Q=ie+1/(2*Math.tan(N));return U*Math.min(1/(Math.sqrt(Q*Q+.5)+Q),q/(Math.sqrt(ie*ie+q/2)+ie))}function z(ie,N){return ie.v===N.vTotal&&!N.trace.hole?1:Math.min(1/(1+1/Math.sin(ie.halfangle)),ie.ring/2)}function I(ie,N){var U=N.pxmid[0],q=N.pxmid[1],Q=ie.width/2,W=ie.height/2;return U<0&&(Q*=-1),q<0&&(W*=-1),{scale:1,rCenter:1,rotate:0,x:Q+Math.abs(W)*(Q>0?1:-1)/2,y:W/(1+U*U/(q*q)),outside:!0}}function D(ie){var N=Math.sqrt(ie.titleBox.width*ie.titleBox.width+ie.titleBox.height*ie.titleBox.height);return{x:ie.cx,y:ie.cy,scale:ie.trace.hole*ie.r*2/N,tx:0,ty:-ie.titleBox.height/2+ie.trace.title.font.size}}function R(ie,N){var U=1,q=1,Q,W=ie.trace,Z={x:ie.cx,y:ie.cy},ee={tx:0,ty:0};ee.ty+=W.title.font.size,Q=V(W),W.title.position.indexOf("top")!==-1?(Z.y-=(1+Q)*ie.r,ee.ty-=ie.titleBox.height):W.title.position.indexOf("bottom")!==-1&&(Z.y+=(1+Q)*ie.r);var te=B(ie.r,ie.trace.aspectratio),ae=N.w*(W.domain.x[1]-W.domain.x[0])/2;return W.title.position.indexOf("left")!==-1?(ae=ae+te,Z.x-=(1+Q)*te,ee.tx+=ie.titleBox.width/2):W.title.position.indexOf("center")!==-1?ae*=2:W.title.position.indexOf("right")!==-1&&(ae=ae+te,Z.x+=(1+Q)*te,ee.tx-=ie.titleBox.width/2),U=ae/ie.titleBox.width,q=F(ie,N)/ie.titleBox.height,{x:Z.x,y:Z.y,scale:Math.min(U,q),tx:ee.tx,ty:ee.ty}}function B(ie,N){return ie/(N===void 0?1:N)}function F(ie,N){var U=ie.trace,q=N.h*(U.domain.y[1]-U.domain.y[0]);return Math.min(ie.titleBox.height,q/2)}function V(ie){var N=ie.pull;if(!N)return 0;var U;if(Array.isArray(N))for(N=0,U=0;U<ie.pull.length;U++)ie.pull[U]>N&&(N=ie.pull[U]);return N}function G(ie,N){var U,q,Q,W,Z,ee,te,ae,le,ye,fe,pe,ge;function Ae(Ve,xe){return Ve.pxmid[1]-xe.pxmid[1]}function we(Ve,xe){return xe.pxmid[1]-Ve.pxmid[1]}function De(Ve,xe){xe||(xe={});var Le=xe.labelExtraY+(q?xe.yLabelMax:xe.yLabelMin),He=q?Ve.yLabelMin:Ve.yLabelMax,Je=q?Ve.yLabelMax:Ve.yLabelMin,Oe=Ve.cyFinal+Z(Ve.px0[1],Ve.px1[1]),Pe=Le-He,Ue,vt,Lt,Yt,At,Rt;if(Pe*te>0&&(Ve.labelExtraY=Pe),!!Array.isArray(N.pull))for(vt=0;vt<ye.length;vt++)Lt=ye[vt],!(Lt===Ve||(p.castOption(N.pull,Ve.pts)||0)>=(p.castOption(N.pull,Lt.pts)||0))&&((Ve.pxmid[1]-Lt.pxmid[1])*te>0?(Yt=Lt.cyFinal+Z(Lt.px0[1],Lt.px1[1]),Pe=Yt-He-Ve.labelExtraY,Pe*te>0&&(Ve.labelExtraY+=Pe)):(Je+Ve.labelExtraY-Oe)*te>0&&(Ue=3*ee*Math.abs(vt-ye.indexOf(Ve)),At=Lt.cxFinal+W(Lt.px0[0],Lt.px1[0]),Rt=At+Ue-(Ve.cxFinal+Ve.pxmid[0])-Ve.labelExtraX,Rt*ee>0&&(Ve.labelExtraX+=Rt)))}for(q=0;q<2;q++)for(Q=q?Ae:we,Z=q?Math.max:Math.min,te=q?1:-1,U=0;U<2;U++){for(W=U?Math.max:Math.min,ee=U?1:-1,ae=ie[q][U],ae.sort(Q),le=ie[1-q][U],ye=le.concat(ae),pe=[],fe=0;fe<ae.length;fe++)ae[fe].yLabelMid!==void 0&&pe.push(ae[fe]);for(ge=!1,fe=0;q&&fe<le.length;fe++)if(le[fe].yLabelMid!==void 0){ge=le[fe];break}for(fe=0;fe<pe.length;fe++){var Be=fe&&pe[fe-1];ge&&!fe&&(Be=ge),De(pe[fe],Be)}}}function J(ie,N){for(var U=[],q=0;q<ie.length;q++){var Q=ie[q][0],W=Q.trace,Z=W.domain,ee=N.w*(Z.x[1]-Z.x[0]),te=N.h*(Z.y[1]-Z.y[0]);W.title.text&&W.title.position!=="middle center"&&(te-=F(Q,N));var ae=ee/2,le=te/2;W.type==="funnelarea"&&!W.scalegroup&&(le/=W.aspectratio),Q.r=Math.min(ae,le)/(1+V(W)),Q.cx=N.l+N.w*(W.domain.x[1]+W.domain.x[0])/2,Q.cy=N.t+N.h*(1-W.domain.y[0])-te/2,W.title.text&&W.title.position.indexOf("bottom")!==-1&&(Q.cy-=F(Q,N)),W.scalegroup&&U.indexOf(W.scalegroup)===-1&&U.push(W.scalegroup)}j(ie,U)}function j(ie,N){for(var U,q,Q,W=0;W<N.length;W++){var Z=1/0,ee=N[W];for(q=0;q<ie.length;q++)if(U=ie[q][0],Q=U.trace,Q.scalegroup===ee){var te;if(Q.type==="pie")te=U.r*U.r;else if(Q.type==="funnelarea"){var ae,le;Q.aspectratio>1?(ae=U.r,le=ae/Q.aspectratio):(le=U.r,ae=le*Q.aspectratio),ae*=(1+Q.baseratio)/2,te=ae*le}Z=Math.min(Z,te/U.vTotal)}for(q=0;q<ie.length;q++)if(U=ie[q][0],Q=U.trace,Q.scalegroup===ee){var ye=Z*U.vTotal;Q.type==="funnelarea"&&(ye/=(1+Q.baseratio)/2,ye/=Q.aspectratio),U.r=Math.sqrt(ye)}}}function Y(ie){var N=ie[0],U=N.r,q=N.trace,Q=p.getRotationAngle(q.rotation),W=2*Math.PI/N.vTotal,Z="px0",ee="px1",te,ae,le;if(q.direction==="counterclockwise"){for(te=0;te<ie.length&&ie[te].hidden;te++);if(te===ie.length)return;Q+=W*ie[te].v,W*=-1,Z="px1",ee="px0"}for(le=X(U,Q),te=0;te<ie.length;te++)ae=ie[te],!ae.hidden&&(ae[Z]=le,ae.startangle=Q,Q+=W*ae.v/2,ae.pxmid=X(U,Q),ae.midangle=Q,Q+=W*ae.v/2,le=X(U,Q),ae.stopangle=Q,ae[ee]=le,ae.largeArc=ae.v>N.vTotal/2?1:0,ae.halfangle=Math.PI*Math.min(ae.v/N.vTotal,.5),ae.ring=1-q.hole,ae.rInscribed=z(ae,N))}function X(ie,N){return[ie*Math.sin(N),-ie*Math.cos(N)]}function oe(ie,N,U){var q=ie._fullLayout,Q=U.trace,W=Q.texttemplate,Z=Q.textinfo;if(!W&&Z&&Z!=="none"){var ee=Z.split("+"),te=function(xe){return ee.indexOf(xe)!==-1},ae=te("label"),le=te("text"),ye=te("value"),fe=te("percent"),pe=q.separators,ge;if(ge=ae?[N.label]:[],le){var Ae=p.getFirstFilled(Q.text,N.pts);h(Ae)&&ge.push(Ae)}ye&&ge.push(p.formatPieValue(N.v,pe)),fe&&ge.push(p.formatPiePercent(N.v/U.vTotal,pe)),N.text=ge.join("<br>")}function we(xe){return{label:xe.label,value:xe.v,valueLabel:p.formatPieValue(xe.v,q.separators),percent:xe.v/U.vTotal,percentLabel:p.formatPiePercent(xe.v/U.vTotal,q.separators),color:xe.color,text:xe.text,customdata:a.castOption(Q,xe.i,"customdata")}}if(W){var De=a.castOption(Q,N.i,"texttemplate");if(!De)N.text="";else{var Be=we(N),Ve=p.getFirstFilled(Q.text,N.pts);(h(Ve)||Ve==="")&&(Be.text=Ve),N.text=a.texttemplateString(De,Be,ie._fullLayout._d3locale,Be,Q._meta||{})}}}function se(ie,N){var U=ie.rotate*Math.PI/180,q=Math.cos(U),Q=Math.sin(U),W=(N.left+N.right)/2,Z=(N.top+N.bottom)/2;ie.textX=W*q-Z*Q,ie.textY=W*Q+Z*q,ie.noCenter=!0}re.exports={plot:m,formatSliceLabel:oe,transformInsideText:v,determineInsideTextFont:A,positionTitleOutside:R,prerenderTitles:x,layoutAreas:J,attachFxHandlers:_,computeTransform:se}},{"../../components/color":366,"../../components/drawing":388,"../../components/fx":406,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../bar/constants":650,"../bar/uniform_text":664,"./event_data":905,"./helpers":906,"@plotly/d3":58}],911:[function(d,re,ne){var w=d("@plotly/d3"),c=d("./style_one"),M=d("../bar/uniform_text").resizeText;re.exports=function(e){var a=e._fullLayout._pielayer.selectAll(".trace");M(e,a,"pie"),a.each(function(n){var r=n[0],t=r.trace,f=w.select(this);f.style({opacity:t.opacity}),f.selectAll("path.surface").each(function(o){w.select(this).call(c,o,t)})})}},{"../bar/uniform_text":664,"./style_one":912,"@plotly/d3":58}],912:[function(d,re,ne){var w=d("../../components/color"),c=d("./helpers").castOption;re.exports=function(T,e,a){var n=a.marker.line,r=c(n.color,e.pts)||w.defaultLine,t=c(n.width,e.pts)||0;T.style("stroke-width",t).call(w.fill,e.color).call(w.stroke,r)}},{"../../components/color":366,"./helpers":906}],913:[function(d,re,ne){var w=d("../scatter/attributes");re.exports={x:w.x,y:w.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:w.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":927}],914:[function(d,re,ne){var w=d("../../../stackgl_modules").gl_pointcloud2d,c=d("../../lib/str2rgbarray"),M=d("../../plots/cartesian/autorange").findExtremes,T=d("../scatter/get_trace_color");function e(r,t){this.scene=r,this.uid=t,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=w(r.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var a=e.prototype;a.handlePick=function(r){var t=this.idToIndex[r.pointId];return{trace:this,dataCoord:r.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[t*2],this.pickXYData[t*2+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}},a.update=function(r){this.index=r.index,this.textLabels=r.text,this.name=r.name,this.hoverinfo=r.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(r),this.color=T(r,{})},a.updateFast=function(r){var t=this.xData=this.pickXData=r.x,f=this.yData=this.pickYData=r.y,o=this.pickXYData=r.xy,i=r.xbounds&&r.ybounds,g=r.indices,p,y,h,m=this.bounds,u,_,s;if(o){if(h=o,p=o.length>>>1,i)m[0]=r.xbounds[0],m[2]=r.xbounds[1],m[1]=r.ybounds[0],m[3]=r.ybounds[1];else for(s=0;s<p;s++)u=h[s*2],_=h[s*2+1],u<m[0]&&(m[0]=u),u>m[2]&&(m[2]=u),_<m[1]&&(m[1]=_),_>m[3]&&(m[3]=_);if(g)y=g;else for(y=new Int32Array(p),s=0;s<p;s++)y[s]=s}else for(p=t.length,h=new Float32Array(2*p),y=new Int32Array(p),s=0;s<p;s++)u=t[s],_=f[s],y[s]=s,h[s*2]=u,h[s*2+1]=_,u<m[0]&&(m[0]=u),u>m[2]&&(m[2]=u),_<m[1]&&(m[1]=_),_>m[3]&&(m[3]=_);this.idToIndex=y,this.pointcloudOptions.idToIndex=y,this.pointcloudOptions.positions=h;var A=c(r.marker.color),x=c(r.marker.border.color),v=r.opacity*r.marker.opacity;A[3]*=v,this.pointcloudOptions.color=A;var b=r.marker.blend;if(b===null){var l=100;b=t.length<l||f.length<l}this.pointcloudOptions.blend=b,x[3]*=v,this.pointcloudOptions.borderColor=x;var L=r.marker.sizemin,S=Math.max(r.marker.sizemax,r.marker.sizemin);this.pointcloudOptions.sizeMin=L,this.pointcloudOptions.sizeMax=S,this.pointcloudOptions.areaRatio=r.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var k=this.scene.xaxis,P=this.scene.yaxis,z=S/2||.5;r._extremes[k._id]=M(k,[m[0],m[2]],{ppad:z}),r._extremes[P._id]=M(P,[m[1],m[3]],{ppad:z})},a.dispose=function(){this.pointcloud.dispose()};function n(r,t){var f=new e(r,t.uid);return f.update(t),f}re.exports=n},{"../../../stackgl_modules":1124,"../../lib/str2rgbarray":528,"../../plots/cartesian/autorange":553,"../scatter/get_trace_color":937}],915:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes");re.exports=function(T,e,a){function n(r,t){return w.coerce(T,e,c,r,t)}n("x"),n("y"),n("xbounds"),n("ybounds"),T.xy&&T.xy instanceof Float32Array&&(e.xy=T.xy),T.indices&&T.indices instanceof Int32Array&&(e.indices=T.indices),n("text"),n("marker.color",a),n("marker.opacity"),n("marker.blend"),n("marker.sizemin"),n("marker.sizemax"),n("marker.border.color",a),n("marker.border.arearatio"),e._length=null}},{"../../lib":503,"./attributes":913}],916:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("../scatter3d/calc"),plot:d("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:d("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":596,"../scatter3d/calc":956,"./attributes":913,"./convert":914,"./defaults":915}],917:[function(d,re,ne){var w=d("../../plots/font_attributes"),c=d("../../plots/attributes"),M=d("../../components/color/attributes"),T=d("../../components/fx/attributes"),e=d("../../plots/domain").attributes,a=d("../../plots/template_attributes").hovertemplateAttrs,n=d("../../components/colorscale/attributes"),r=d("../../plot_api/plot_template").templatedArray,t=d("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,f=d("../../lib/extend").extendFlat,o=d("../../plot_api/edit_types").overrideAll,i=re.exports=o({hoverinfo:f({},c.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:T.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:t("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:w({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:M.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:T.hoverlabel,hovertemplate:a({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:M.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:T.hoverlabel,hovertemplate:a({},{keys:["value","label"]}),colorscales:r("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:f(n().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested");i.transforms=void 0},{"../../components/color/attributes":365,"../../components/colorscale/attributes":373,"../../components/fx/attributes":397,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/domain":584,"../../plots/font_attributes":585,"../../plots/template_attributes":633}],918:[function(d,re,ne){var w=d("../../plot_api/edit_types").overrideAll,c=d("../../plots/get_data").getModuleCalcData,M=d("./plot"),T=d("../../components/fx/layout_attributes"),e=d("../../lib/setcursor"),a=d("../../components/dragelement"),n=d("../../plots/cartesian/select").prepSelect,r=d("../../lib"),t=d("../../registry"),f="sankey";ne.name=f,ne.baseLayoutAttrOverrides=w({hoverlabel:T.hoverlabel},"plot","nested"),ne.plot=function(i){var g=c(i.calcdata,f)[0];M(i,g),ne.updateFx(i)},ne.clean=function(i,g,p,y){var h=y._has&&y._has(f),m=g._has&&g._has(f);h&&!m&&(y._paperdiv.selectAll(".sankey").remove(),y._paperdiv.selectAll(".bgsankey").remove())},ne.updateFx=function(i){for(var g=0;g<i._fullData.length;g++)o(i,g)};function o(i,g){var p=i._fullData[g],y=i._fullLayout,h=y.dragmode,m=y.dragmode==="pan"?"move":"crosshair",u=p._bgRect;if(!(h==="pan"||h==="zoom")){e(u,m);var _={_id:"x",c2p:r.identity,_offset:p._sankey.translateX,_length:p._sankey.width},s={_id:"y",c2p:r.identity,_offset:p._sankey.translateY,_length:p._sankey.height},A={gd:i,element:u.node(),plotinfo:{id:g,xaxis:_,yaxis:s,fillRangeItems:r.noop},subplot:g,xaxes:[_],yaxes:[s],doneFnCompleted:function(x){var v=i._fullData[g],b,l=v.node.groups.slice(),L=[];function S(I){for(var D=v._sankey.graph.nodes,R=0;R<D.length;R++)if(D[R].pointNumber===I)return D[R]}for(var k=0;k<x.length;k++){var P=S(x[k].pointNumber);if(!!P)if(P.group){for(var z=0;z<P.childrenNodes.length;z++)L.push(P.childrenNodes[z].pointNumber);l[P.pointNumber-v.node._count]=!1}else L.push(P.pointNumber)}b=l.filter(Boolean).concat([L]),t.call("_guiRestyle",i,{"node.groups":[b]},g)}};A.prepFn=function(x,v,b){n(x,v,b,A,h)},a.init(A)}}},{"../../components/dragelement":385,"../../components/fx/layout_attributes":407,"../../lib":503,"../../lib/setcursor":524,"../../plot_api/edit_types":536,"../../plots/cartesian/select":575,"../../plots/get_data":593,"../../registry":638,"./plot":923}],919:[function(d,re,ne){var w=d("strongly-connected-components"),c=d("../../lib"),M=d("../../lib/gup").wrap,T=c.isArrayOrTypedArray,e=c.isIndex,a=d("../../components/colorscale");function n(t){var f=t.node,o=t.link,i=[],g=T(o.color),p=T(o.customdata),y={},h={},m=o.colorscales.length,u;for(u=0;u<m;u++){var _=o.colorscales[u],s=a.extractScale(_,{cLetter:"c"}),A=a.makeColorScaleFunc(s);h[_.label]=A}var x=0;for(u=0;u<o.value.length;u++)o.source[u]>x&&(x=o.source[u]),o.target[u]>x&&(x=o.target[u]);var v=x+1;t.node._count=v;var b,l=t.node.groups,L={};for(u=0;u<l.length;u++){var S=l[u];for(b=0;b<S.length;b++){var k=S[b],P=v+u;L.hasOwnProperty(k)?c.warn("Node "+k+" is already part of a group."):L[k]=P}}var z={source:[],target:[]};for(u=0;u<o.value.length;u++){var I=o.value[u],D=o.source[u],R=o.target[u];if(!!(I>0&&e(D,v)&&e(R,v))&&!(L.hasOwnProperty(D)&&L.hasOwnProperty(R)&&L[D]===L[R])){L.hasOwnProperty(R)&&(R=L[R]),L.hasOwnProperty(D)&&(D=L[D]),D=+D,R=+R,y[D]=y[R]=!0;var B="";o.label&&o.label[u]&&(B=o.label[u]);var F=null;B&&h.hasOwnProperty(B)&&(F=h[B]),i.push({pointNumber:u,label:B,color:g?o.color[u]:o.color,customdata:p?o.customdata[u]:o.customdata,concentrationscale:F,source:D,target:R,value:+I}),z.source.push(D),z.target.push(R)}}var V=v+l.length,G=T(f.color),J=T(f.customdata),j=[];for(u=0;u<V;u++)if(!!y[u]){var Y=f.label[u];j.push({group:u>v-1,childrenNodes:[],pointNumber:u,label:Y,color:G?f.color[u]:f.color,customdata:J?f.customdata[u]:f.customdata})}var X=!1;return r(V,z.source,z.target)&&(X=!0),{circular:X,links:i,nodes:j,groups:l,groupLookup:L}}function r(t,f,o){for(var i=c.init2dArray(t,0),g=0;g<Math.min(f.length,o.length);g++)if(c.isIndex(f[g],t)&&c.isIndex(o[g],t)){if(f[g]===o[g])return!0;i[f[g]].push(o[g])}var p=w(i);return p.components.some(function(y){return y.length>1})}re.exports=function(f,o){var i=n(o);return M({circular:i.circular,_nodes:i.nodes,_links:i.links,_groups:i.groups,_groupLookup:i.groupLookup})}},{"../../components/colorscale":378,"../../lib":503,"../../lib/gup":500,"strongly-connected-components":306}],920:[function(d,re,ne){re.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],921:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes"),M=d("../../components/color"),T=d("tinycolor2"),e=d("../../plots/domain").defaults,a=d("../../components/fx/hoverlabel_defaults"),n=d("../../plot_api/plot_template"),r=d("../../plots/array_container_defaults");re.exports=function(o,i,g,p){function y(S,k){return w.coerce(o,i,c,S,k)}var h=w.extendDeep(p.hoverlabel,o.hoverlabel),m=o.node,u=n.newContainer(i,"node");function _(S,k){return w.coerce(m,u,c.node,S,k)}_("label"),_("groups"),_("x"),_("y"),_("pad"),_("thickness"),_("line.color"),_("line.width"),_("hoverinfo",o.hoverinfo),a(m,u,_,h),_("hovertemplate");var s=p.colorway,A=function(S){return s[S%s.length]};_("color",u.label.map(function(S,k){return M.addOpacity(A(k),.8)})),_("customdata");var x=o.link||{},v=n.newContainer(i,"link");function b(S,k){return w.coerce(x,v,c.link,S,k)}b("label"),b("source"),b("target"),b("value"),b("line.color"),b("line.width"),b("hoverinfo",o.hoverinfo),a(x,v,b,h),b("hovertemplate");var l=T(p.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";b("color",w.repeat(l,v.value.length)),b("customdata"),r(x,v,{name:"colorscales",handleItemDefaults:t}),e(i,p,y),y("orientation"),y("valueformat"),y("valuesuffix");var L;u.x.length&&u.y.length&&(L="freeform"),y("arrangement",L),w.coerceFont(y,"textfont",w.extendFlat({},p.font)),i._length=null};function t(f,o){function i(g,p){return w.coerce(f,o,c.link.colorscales,g,p)}i("label"),i("cmin"),i("cmax"),i("colorscale")}},{"../../components/color":366,"../../components/fx/hoverlabel_defaults":404,"../../lib":503,"../../plot_api/plot_template":543,"../../plots/array_container_defaults":549,"../../plots/domain":584,"./attributes":917,tinycolor2:312}],922:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),moduleType:"trace",name:"sankey",basePlotModule:d("./base_plot"),selectPoints:d("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":917,"./base_plot":918,"./calc":919,"./defaults":921,"./plot":923,"./select.js":925}],923:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=c.numberFormat,T=d("./render"),e=d("../../components/fx"),a=d("../../components/color"),n=d("./constants").cn,r=c._;function t(s){return s!==""}function f(s,A){return s.filter(function(x){return x.key===A.traceId})}function o(s,A){w.select(s).select("path").style("fill-opacity",A),w.select(s).select("rect").style("fill-opacity",A)}function i(s){w.select(s).select("text.name").style("fill","black")}function g(s){return function(A){return s.node.sourceLinks.indexOf(A.link)!==-1||s.node.targetLinks.indexOf(A.link)!==-1}}function p(s){return function(A){return A.node.sourceLinks.indexOf(s.link)!==-1||A.node.targetLinks.indexOf(s.link)!==-1}}function y(s,A,x){A&&x&&f(x,A).selectAll("."+n.sankeyLink).filter(g(A)).call(m.bind(0,A,x,!1))}function h(s,A,x){A&&x&&f(x,A).selectAll("."+n.sankeyLink).filter(g(A)).call(u.bind(0,A,x,!1))}function m(s,A,x,v){var b=v.datum().link.label;v.style("fill-opacity",function(l){if(!l.link.concentrationscale)return .4}),b&&f(A,s).selectAll("."+n.sankeyLink).filter(function(l){return l.link.label===b}).style("fill-opacity",function(l){if(!l.link.concentrationscale)return .4}),x&&f(A,s).selectAll("."+n.sankeyNode).filter(p(s)).call(y)}function u(s,A,x,v){var b=v.datum().link.label;v.style("fill-opacity",function(l){return l.tinyColorAlpha}),b&&f(A,s).selectAll("."+n.sankeyLink).filter(function(l){return l.link.label===b}).style("fill-opacity",function(l){return l.tinyColorAlpha}),x&&f(A,s).selectAll(n.sankeyNode).filter(p(s)).call(h)}function _(s,A){var x=s.hoverlabel||{},v=c.nestedProperty(x,A).get();return Array.isArray(v)?!1:v}re.exports=function(A,x){for(var v=A._fullLayout,b=v._paper,l=v._size,L=0;L<A._fullData.length;L++)if(!!A._fullData[L].visible&&A._fullData[L].type===n.sankey&&!A._fullData[L]._viewInitial){var S=A._fullData[L].node;A._fullData[L]._viewInitial={node:{groups:S.groups.slice(),x:S.x.slice(),y:S.y.slice()}}}var k=function(X,oe){var se=oe.link;se.originalEvent=w.event,A._hoverdata=[se],e.click(A,{target:!0})},P=function(X,oe,se){A._fullLayout.hovermode!==!1&&(w.select(X).call(m.bind(0,oe,se,!0)),oe.link.trace.link.hoverinfo!=="skip"&&(oe.link.fullData=oe.link.trace,A.emit("plotly_hover",{event:w.event,points:[oe.link]})))},z=r(A,"source:")+" ",I=r(A,"target:")+" ",D=r(A,"concentration:")+" ",R=r(A,"incoming flow count:")+" ",B=r(A,"outgoing flow count:")+" ",F=function(X,oe){if(A._fullLayout.hovermode===!1)return;var se=oe.link.trace.link;if(se.hoverinfo==="none"||se.hoverinfo==="skip")return;var ie=[];function N(te){var ae,le;te.circular?(ae=(te.circularPathData.leftInnerExtent+te.circularPathData.rightInnerExtent)/2,le=te.circularPathData.verticalFullExtent):(ae=(te.source.x1+te.target.x0)/2,le=(te.y0+te.y1)/2);var ye=[ae,le];return te.trace.orientation==="v"&&ye.reverse(),ye[0]+=oe.parent.translateX,ye[1]+=oe.parent.translateY,ye}for(var U=0,q=0;q<oe.flow.links.length;q++){var Q=oe.flow.links[q];if(!(A._fullLayout.hovermode==="closest"&&oe.link.pointNumber!==Q.pointNumber)){oe.link.pointNumber===Q.pointNumber&&(U=q),Q.fullData=Q.trace,se=oe.link.trace.link;var W=N(Q),Z={valueLabel:M(oe.valueFormat)(Q.value)+oe.valueSuffix};ie.push({x:W[0],y:W[1],name:Z.valueLabel,text:[Q.label||"",z+Q.source.label,I+Q.target.label,Q.concentrationscale?D+M("%0.2f")(Q.flow.labelConcentration):""].filter(t).join("<br>"),color:_(se,"bgcolor")||a.addOpacity(Q.color,1),borderColor:_(se,"bordercolor"),fontFamily:_(se,"font.family"),fontSize:_(se,"font.size"),fontColor:_(se,"font.color"),nameLength:_(se,"namelength"),textAlign:_(se,"align"),idealAlign:w.event.x<W[0]?"right":"left",hovertemplate:se.hovertemplate,hovertemplateLabels:Z,eventData:[Q]})}}var ee=e.loneHover(ie,{container:v._hoverlayer.node(),outerContainer:v._paper.node(),gd:A,anchorIndex:U});ee.each(function(){var te=this;oe.link.concentrationscale||o(te,.65),i(te)})},V=function(X,oe,se){A._fullLayout.hovermode!==!1&&(w.select(X).call(u.bind(0,oe,se,!0)),oe.link.trace.link.hoverinfo!=="skip"&&(oe.link.fullData=oe.link.trace,A.emit("plotly_unhover",{event:w.event,points:[oe.link]})),e.loneUnhover(v._hoverlayer.node()))},G=function(X,oe,se){var ie=oe.node;ie.originalEvent=w.event,A._hoverdata=[ie],w.select(X).call(h,oe,se),e.click(A,{target:!0})},J=function(X,oe,se){A._fullLayout.hovermode!==!1&&(w.select(X).call(y,oe,se),oe.node.trace.node.hoverinfo!=="skip"&&(oe.node.fullData=oe.node.trace,A.emit("plotly_hover",{event:w.event,points:[oe.node]})))},j=function(X,oe){if(A._fullLayout.hovermode!==!1){var se=oe.node.trace.node;if(!(se.hoverinfo==="none"||se.hoverinfo==="skip")){var ie=w.select(X).select("."+n.nodeRect),N=A._fullLayout._paperdiv.node().getBoundingClientRect(),U=ie.node().getBoundingClientRect(),q=U.left-2-N.left,Q=U.right+2-N.left,W=U.top+U.height/4-N.top,Z={valueLabel:M(oe.valueFormat)(oe.node.value)+oe.valueSuffix};oe.node.fullData=oe.node.trace,A._fullLayout._calcInverseTransform(A);var ee=A._fullLayout._invScaleX,te=A._fullLayout._invScaleY,ae=e.loneHover({x0:ee*q,x1:ee*Q,y:te*W,name:M(oe.valueFormat)(oe.node.value)+oe.valueSuffix,text:[oe.node.label,R+oe.node.targetLinks.length,B+oe.node.sourceLinks.length].filter(t).join("<br>"),color:_(se,"bgcolor")||oe.tinyColorHue,borderColor:_(se,"bordercolor"),fontFamily:_(se,"font.family"),fontSize:_(se,"font.size"),fontColor:_(se,"font.color"),nameLength:_(se,"namelength"),textAlign:_(se,"align"),idealAlign:"left",hovertemplate:se.hovertemplate,hovertemplateLabels:Z,eventData:[oe.node]},{container:v._hoverlayer.node(),outerContainer:v._paper.node(),gd:A});o(ae,.85),i(ae)}}},Y=function(X,oe,se){A._fullLayout.hovermode!==!1&&(w.select(X).call(h,oe,se),oe.node.trace.node.hoverinfo!=="skip"&&(oe.node.fullData=oe.node.trace,A.emit("plotly_unhover",{event:w.event,points:[oe.node]})),e.loneUnhover(v._hoverlayer.node()))};T(A,b,x,{width:l.w,height:l.h,margin:{t:l.t,r:l.r,b:l.b,l:l.l}},{linkEvents:{hover:P,follow:F,unhover:V,select:k},nodeEvents:{hover:J,follow:j,unhover:Y,select:G}})}},{"../../components/color":366,"../../components/fx":406,"../../lib":503,"./constants":920,"./render":924,"@plotly/d3":58}],924:[function(d,re,ne){var w=d("d3-force"),c=d("d3-interpolate").interpolateNumber,M=d("@plotly/d3"),T=d("@plotly/d3-sankey"),e=d("@plotly/d3-sankey-circular"),a=d("./constants"),n=d("tinycolor2"),r=d("../../components/color"),t=d("../../components/drawing"),f=d("../../lib"),o=f.strTranslate,i=f.strRotate,g=d("../../lib/gup"),p=g.keyFun,y=g.repeat,h=g.unwrap,m=d("../../lib/svg_text_utils"),u=d("../../registry"),_=d("../../constants/alignment"),s=_.CAP_SHIFT,A=_.LINE_SPACING,x=3;function v(N,U,q){var Q=h(U),W=Q.trace,Z=W.domain,ee=W.orientation==="h",te=W.node.pad,ae=W.node.thickness,le=N.width*(Z.x[1]-Z.x[0]),ye=N.height*(Z.y[1]-Z.y[0]),fe=Q._nodes,pe=Q._links,ge=Q.circular,Ae;ge?Ae=e.sankeyCircular().circularLinkGap(0):Ae=T.sankey(),Ae.iterations(a.sankeyIterations).size(ee?[le,ye]:[ye,le]).nodeWidth(ae).nodePadding(te).nodeId(function(At){return At.pointNumber}).nodes(fe).links(pe);var we=Ae();Ae.nodePadding()<te&&f.warn("node.pad was reduced to ",Ae.nodePadding()," to fit within the figure.");var De,Be,Ve;for(var xe in Q._groupLookup){var Le=parseInt(Q._groupLookup[xe]),He;for(De=0;De<we.nodes.length;De++)if(we.nodes[De].pointNumber===Le){He=we.nodes[De];break}if(!!He){var Je={pointNumber:parseInt(xe),x0:He.x0,x1:He.x1,y0:He.y0,y1:He.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};we.nodes.unshift(Je),He.childrenNodes.unshift(Je)}}function Oe(){for(De=0;De<we.nodes.length;De++){var At=we.nodes[De],Rt={},Bt,Mt;for(Be=0;Be<At.targetLinks.length;Be++)Mt=At.targetLinks[Be],Bt=Mt.source.pointNumber+":"+Mt.target.pointNumber,Rt.hasOwnProperty(Bt)||(Rt[Bt]=[]),Rt[Bt].push(Mt);var Tt=Object.keys(Rt);for(Be=0;Be<Tt.length;Be++){Bt=Tt[Be];var at=Rt[Bt],ct=0,je={};for(Ve=0;Ve<at.length;Ve++)Mt=at[Ve],je[Mt.label]||(je[Mt.label]=0),je[Mt.label]+=Mt.value,ct+=Mt.value;for(Ve=0;Ve<at.length;Ve++)Mt=at[Ve],Mt.flow={value:ct,labelConcentration:je[Mt.label]/ct,concentration:Mt.value/ct,links:at},Mt.concentrationscale&&(Mt.color=n(Mt.concentrationscale(Mt.flow.labelConcentration)))}var ke=0;for(Be=0;Be<At.sourceLinks.length;Be++)ke+=At.sourceLinks[Be].value;for(Be=0;Be<At.sourceLinks.length;Be++)Mt=At.sourceLinks[Be],Mt.concentrationOut=Mt.value/ke;var Ye=0;for(Be=0;Be<At.targetLinks.length;Be++)Ye+=At.targetLinks[Be].value;for(Be=0;Be<At.targetLinks.length;Be++)Mt=At.targetLinks[Be],Mt.concenrationIn=Mt.value/Ye}}Oe();function Pe(At){At.forEach(function(Rt){var Bt,Mt,Tt=0,at=Rt.length,ct;for(Rt.sort(function(je,ke){return je.y0-ke.y0}),ct=0;ct<at;++ct)Bt=Rt[ct],Bt.y0>=Tt||(Mt=Tt-Bt.y0,Mt>1e-6&&(Bt.y0+=Mt,Bt.y1+=Mt)),Tt=Bt.y1+te})}function Ue(At){var Rt=At.map(function(ke,Ye){return{x0:ke.x0,index:Ye}}).sort(function(ke,Ye){return ke.x0-Ye.x0}),Bt=[],Mt=-1,Tt,at=-1/0,ct;for(De=0;De<Rt.length;De++){var je=At[Rt[De].index];je.x0>at+ae&&(Mt+=1,Tt=je.x0),at=je.x0,Bt[Mt]||(Bt[Mt]=[]),Bt[Mt].push(je),ct=Tt-je.x0,je.x0+=ct,je.x1+=ct}return Bt}if(W.node.x.length&&W.node.y.length){for(De=0;De<Math.min(W.node.x.length,W.node.y.length,we.nodes.length);De++)if(W.node.x[De]&&W.node.y[De]){var vt=[W.node.x[De]*le,W.node.y[De]*ye];we.nodes[De].x0=vt[0]-ae/2,we.nodes[De].x1=vt[0]+ae/2;var Lt=we.nodes[De].y1-we.nodes[De].y0;we.nodes[De].y0=vt[1]-Lt/2,we.nodes[De].y1=vt[1]+Lt/2}if(W.arrangement==="snap"){fe=we.nodes;var Yt=Ue(fe);Pe(Yt)}Ae.update(we)}return{circular:ge,key:q,trace:W,guid:f.randstr(),horizontal:ee,width:le,height:ye,nodePad:W.node.pad,nodeLineColor:W.node.line.color,nodeLineWidth:W.node.line.width,linkLineColor:W.link.line.color,linkLineWidth:W.link.line.width,valueFormat:W.valueformat,valueSuffix:W.valuesuffix,textFont:W.textfont,translateX:Z.x[0]*N.width+N.margin.l,translateY:N.height-Z.y[1]*N.height+N.margin.t,dragParallel:ee?ye:le,dragPerpendicular:ee?le:ye,arrangement:W.arrangement,sankey:Ae,graph:we,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function b(N,U,q){var Q=n(U.color),W=U.source.label+"|"+U.target.label,Z=W+"__"+q;return U.trace=N.trace,U.curveNumber=N.trace.index,{circular:N.circular,key:Z,traceId:N.key,pointNumber:U.pointNumber,link:U,tinyColorHue:r.tinyRGB(Q),tinyColorAlpha:Q.getAlpha(),linkPath:L,linkLineColor:N.linkLineColor,linkLineWidth:N.linkLineWidth,valueFormat:N.valueFormat,valueSuffix:N.valueSuffix,sankey:N.sankey,parent:N,interactionState:N.interactionState,flow:U.flow}}function l(N){var U="",q=N.width/2,Q=N.circularPathData;return N.circularLinkType==="top"?U="M "+Q.targetX+" "+(Q.targetY+q)+" L"+Q.rightInnerExtent+" "+(Q.targetY+q)+"A"+(Q.rightLargeArcRadius+q)+" "+(Q.rightSmallArcRadius+q)+" 0 0 1 "+(Q.rightFullExtent-q)+" "+(Q.targetY-Q.rightSmallArcRadius)+"L"+(Q.rightFullExtent-q)+" "+Q.verticalRightInnerExtent+"A"+(Q.rightLargeArcRadius+q)+" "+(Q.rightLargeArcRadius+q)+" 0 0 1 "+Q.rightInnerExtent+" "+(Q.verticalFullExtent-q)+"L"+Q.leftInnerExtent+" "+(Q.verticalFullExtent-q)+"A"+(Q.leftLargeArcRadius+q)+" "+(Q.leftLargeArcRadius+q)+" 0 0 1 "+(Q.leftFullExtent+q)+" "+Q.verticalLeftInnerExtent+"L"+(Q.leftFullExtent+q)+" "+(Q.sourceY-Q.leftSmallArcRadius)+"A"+(Q.leftLargeArcRadius+q)+" "+(Q.leftSmallArcRadius+q)+" 0 0 1 "+Q.leftInnerExtent+" "+(Q.sourceY+q)+"L"+Q.sourceX+" "+(Q.sourceY+q)+"L"+Q.sourceX+" "+(Q.sourceY-q)+"L"+Q.leftInnerExtent+" "+(Q.sourceY-q)+"A"+(Q.leftLargeArcRadius-q)+" "+(Q.leftSmallArcRadius-q)+" 0 0 0 "+(Q.leftFullExtent-q)+" "+(Q.sourceY-Q.leftSmallArcRadius)+"L"+(Q.leftFullExtent-q)+" "+Q.verticalLeftInnerExtent+"A"+(Q.leftLargeArcRadius-q)+" "+(Q.leftLargeArcRadius-q)+" 0 0 0 "+Q.leftInnerExtent+" "+(Q.verticalFullExtent+q)+"L"+Q.rightInnerExtent+" "+(Q.verticalFullExtent+q)+"A"+(Q.rightLargeArcRadius-q)+" "+(Q.rightLargeArcRadius-q)+" 0 0 0 "+(Q.rightFullExtent+q)+" "+Q.verticalRightInnerExtent+"L"+(Q.rightFullExtent+q)+" "+(Q.targetY-Q.rightSmallArcRadius)+"A"+(Q.rightLargeArcRadius-q)+" "+(Q.rightSmallArcRadius-q)+" 0 0 0 "+Q.rightInnerExtent+" "+(Q.targetY-q)+"L"+Q.targetX+" "+(Q.targetY-q)+"Z":U="M "+Q.targetX+" "+(Q.targetY-q)+" L"+Q.rightInnerExtent+" "+(Q.targetY-q)+"A"+(Q.rightLargeArcRadius+q)+" "+(Q.rightSmallArcRadius+q)+" 0 0 0 "+(Q.rightFullExtent-q)+" "+(Q.targetY+Q.rightSmallArcRadius)+"L"+(Q.rightFullExtent-q)+" "+Q.verticalRightInnerExtent+"A"+(Q.rightLargeArcRadius+q)+" "+(Q.rightLargeArcRadius+q)+" 0 0 0 "+Q.rightInnerExtent+" "+(Q.verticalFullExtent+q)+"L"+Q.leftInnerExtent+" "+(Q.verticalFullExtent+q)+"A"+(Q.leftLargeArcRadius+q)+" "+(Q.leftLargeArcRadius+q)+" 0 0 0 "+(Q.leftFullExtent+q)+" "+Q.verticalLeftInnerExtent+"L"+(Q.leftFullExtent+q)+" "+(Q.sourceY+Q.leftSmallArcRadius)+"A"+(Q.leftLargeArcRadius+q)+" "+(Q.leftSmallArcRadius+q)+" 0 0 0 "+Q.leftInnerExtent+" "+(Q.sourceY-q)+"L"+Q.sourceX+" "+(Q.sourceY-q)+"L"+Q.sourceX+" "+(Q.sourceY+q)+"L"+Q.leftInnerExtent+" "+(Q.sourceY+q)+"A"+(Q.leftLargeArcRadius-q)+" "+(Q.leftSmallArcRadius-q)+" 0 0 1 "+(Q.leftFullExtent-q)+" "+(Q.sourceY+Q.leftSmallArcRadius)+"L"+(Q.leftFullExtent-q)+" "+Q.verticalLeftInnerExtent+"A"+(Q.leftLargeArcRadius-q)+" "+(Q.leftLargeArcRadius-q)+" 0 0 1 "+Q.leftInnerExtent+" "+(Q.verticalFullExtent-q)+"L"+Q.rightInnerExtent+" "+(Q.verticalFullExtent-q)+"A"+(Q.rightLargeArcRadius-q)+" "+(Q.rightLargeArcRadius-q)+" 0 0 1 "+(Q.rightFullExtent+q)+" "+Q.verticalRightInnerExtent+"L"+(Q.rightFullExtent+q)+" "+(Q.targetY+Q.rightSmallArcRadius)+"A"+(Q.rightLargeArcRadius-q)+" "+(Q.rightSmallArcRadius-q)+" 0 0 1 "+Q.rightInnerExtent+" "+(Q.targetY+q)+"L"+Q.targetX+" "+(Q.targetY+q)+"Z",U}function L(){var N=.5;function U(q){if(q.link.circular)return l(q.link);var Q=q.link.source.x1,W=q.link.target.x0,Z=c(Q,W),ee=Z(N),te=Z(1-N),ae=q.link.y0-q.link.width/2,le=q.link.y0+q.link.width/2,ye=q.link.y1-q.link.width/2,fe=q.link.y1+q.link.width/2;return"M"+Q+","+ae+"C"+ee+","+ae+" "+te+","+ye+" "+W+","+ye+"L"+W+","+fe+"C"+te+","+fe+" "+ee+","+le+" "+Q+","+le+"Z"}return U}function S(N,U){var q=n(U.color),Q=a.nodePadAcross,W=N.nodePad/2;U.dx=U.x1-U.x0,U.dy=U.y1-U.y0;var Z=U.dx,ee=Math.max(.5,U.dy),te="node_"+U.pointNumber;return U.group&&(te=f.randstr()),U.trace=N.trace,U.curveNumber=N.trace.index,{index:U.pointNumber,key:te,partOfGroup:U.partOfGroup||!1,group:U.group,traceId:N.key,trace:N.trace,node:U,nodePad:N.nodePad,nodeLineColor:N.nodeLineColor,nodeLineWidth:N.nodeLineWidth,textFont:N.textFont,size:N.horizontal?N.height:N.width,visibleWidth:Math.ceil(Z),visibleHeight:ee,zoneX:-Q,zoneY:-W,zoneWidth:Z+2*Q,zoneHeight:ee+2*W,labelY:N.horizontal?U.dy/2+1:U.dx/2+1,left:U.originalLayer===1,sizeAcross:N.width,forceLayouts:N.forceLayouts,horizontal:N.horizontal,darkBackground:q.getBrightness()<=128,tinyColorHue:r.tinyRGB(q),tinyColorAlpha:q.getAlpha(),valueFormat:N.valueFormat,valueSuffix:N.valueSuffix,sankey:N.sankey,graph:N.graph,arrangement:N.arrangement,uniqueNodeLabelPathId:[N.guid,N.key,te].join("_"),interactionState:N.interactionState,figure:N}}function k(N){N.attr("transform",function(U){return o(U.node.x0.toFixed(3),U.node.y0.toFixed(3))})}function P(N){N.call(k)}function z(N,U){N.call(P),U.attr("d",L())}function I(N){N.attr("width",function(U){return U.node.x1-U.node.x0}).attr("height",function(U){return U.visibleHeight})}function D(N){return N.link.width>1||N.linkLineWidth>0}function R(N){var U=o(N.translateX,N.translateY);return U+(N.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function B(N,U,q){N.on(".basic",null).on("mouseover.basic",function(Q){!Q.interactionState.dragInProgress&&!Q.partOfGroup&&(q.hover(this,Q,U),Q.interactionState.hovered=[this,Q])}).on("mousemove.basic",function(Q){!Q.interactionState.dragInProgress&&!Q.partOfGroup&&(q.follow(this,Q),Q.interactionState.hovered=[this,Q])}).on("mouseout.basic",function(Q){!Q.interactionState.dragInProgress&&!Q.partOfGroup&&(q.unhover(this,Q,U),Q.interactionState.hovered=!1)}).on("click.basic",function(Q){Q.interactionState.hovered&&(q.unhover(this,Q,U),Q.interactionState.hovered=!1),!Q.interactionState.dragInProgress&&!Q.partOfGroup&&q.select(this,Q,U)})}function F(N,U,q,Q){var W=M.behavior.drag().origin(function(Z){return{x:Z.node.x0+Z.visibleWidth/2,y:Z.node.y0+Z.visibleHeight/2}}).on("dragstart",function(Z){if(Z.arrangement!=="fixed"&&(f.ensureSingle(Q._fullLayout._infolayer,"g","dragcover",function(te){Q._fullLayout._dragCover=te}),f.raiseToTop(this),Z.interactionState.dragInProgress=Z.node,X(Z.node),Z.interactionState.hovered&&(q.nodeEvents.unhover.apply(0,Z.interactionState.hovered),Z.interactionState.hovered=!1),Z.arrangement==="snap")){var ee=Z.traceId+"|"+Z.key;Z.forceLayouts[ee]?Z.forceLayouts[ee].alpha(1):V(N,ee,Z),G(N,U,Z,ee,Q)}}).on("drag",function(Z){if(Z.arrangement!=="fixed"){var ee=M.event.x,te=M.event.y;Z.arrangement==="snap"?(Z.node.x0=ee-Z.visibleWidth/2,Z.node.x1=ee+Z.visibleWidth/2,Z.node.y0=te-Z.visibleHeight/2,Z.node.y1=te+Z.visibleHeight/2):(Z.arrangement==="freeform"&&(Z.node.x0=ee-Z.visibleWidth/2,Z.node.x1=ee+Z.visibleWidth/2),te=Math.max(0,Math.min(Z.size-Z.visibleHeight/2,te)),Z.node.y0=te-Z.visibleHeight/2,Z.node.y1=te+Z.visibleHeight/2),X(Z.node),Z.arrangement!=="snap"&&(Z.sankey.update(Z.graph),z(N.filter(oe(Z)),U))}}).on("dragend",function(Z){if(Z.arrangement!=="fixed"){Z.interactionState.dragInProgress=!1;for(var ee=0;ee<Z.node.childrenNodes.length;ee++)Z.node.childrenNodes[ee].x=Z.node.x,Z.node.childrenNodes[ee].y=Z.node.y;Z.arrangement!=="snap"&&j(Z,Q)}});N.on(".drag",null).call(W)}function V(N,U,q,Q){se(q.graph.nodes);var W=q.graph.nodes.filter(function(Z){return Z.originalX===q.node.originalX}).filter(function(Z){return!Z.partOfGroup});q.forceLayouts[U]=w.forceSimulation(W).alphaDecay(0).force("collide",w.forceCollide().radius(function(Z){return Z.dy/2+q.nodePad/2}).strength(1).iterations(a.forceIterations)).force("constrain",J(N,U,W,q)).stop()}function G(N,U,q,Q,W){window.requestAnimationFrame(function Z(){var ee;for(ee=0;ee<a.forceTicksPerFrame;ee++)q.forceLayouts[Q].tick();var te=q.graph.nodes;if(ie(te),q.sankey.update(q.graph),z(N.filter(oe(q)),U),q.forceLayouts[Q].alpha()>0)window.requestAnimationFrame(Z);else{var ae=q.node.originalX;q.node.x0=ae-q.visibleWidth/2,q.node.x1=ae+q.visibleWidth/2,j(q,W)}})}function J(N,U,q,Q){return function(){for(var Z=0,ee=0;ee<q.length;ee++){var te=q[ee];te===Q.interactionState.dragInProgress?(te.x=te.lastDraggedX,te.y=te.lastDraggedY):(te.vx=(te.originalX-te.x)/a.forceTicksPerFrame,te.y=Math.min(Q.size-te.dy/2,Math.max(te.dy/2,te.y))),Z=Math.max(Z,Math.abs(te.vx),Math.abs(te.vy))}!Q.interactionState.dragInProgress&&Z<.1&&Q.forceLayouts[U].alpha()>0&&Q.forceLayouts[U].alpha(0)}}function j(N,U){for(var q=[],Q=[],W=0;W<N.graph.nodes.length;W++){var Z=(N.graph.nodes[W].x0+N.graph.nodes[W].x1)/2,ee=(N.graph.nodes[W].y0+N.graph.nodes[W].y1)/2;q.push(Z/N.figure.width),Q.push(ee/N.figure.height)}u.call("_guiRestyle",U,{"node.x":[q],"node.y":[Q]},N.trace.index).then(function(){U._fullLayout._dragCover&&U._fullLayout._dragCover.remove()})}function Y(N){var U=[],q;for(q=0;q<N.length;q++)N[q].originalX=(N[q].x0+N[q].x1)/2,N[q].originalY=(N[q].y0+N[q].y1)/2,U.indexOf(N[q].originalX)===-1&&U.push(N[q].originalX);for(U.sort(function(Q,W){return Q-W}),q=0;q<N.length;q++)N[q].originalLayerIndex=U.indexOf(N[q].originalX),N[q].originalLayer=N[q].originalLayerIndex/(U.length-1)}function X(N){N.lastDraggedX=N.x0+N.dx/2,N.lastDraggedY=N.y0+N.dy/2}function oe(N){return function(U){return U.node.originalX===N.node.originalX}}function se(N){for(var U=0;U<N.length;U++)N[U].y=(N[U].y0+N[U].y1)/2,N[U].x=(N[U].x0+N[U].x1)/2}function ie(N){for(var U=0;U<N.length;U++)N[U].y0=N[U].y-N[U].dy/2,N[U].y1=N[U].y0+N[U].dy,N[U].x0=N[U].x-N[U].dx/2,N[U].x1=N[U].x0+N[U].dx}re.exports=function(N,U,q,Q,W){var Z=!1;f.ensureSingle(N._fullLayout._infolayer,"g","first-render",function(){Z=!0});var ee=N._fullLayout._dragCover,te=q.filter(function(we){return h(we).trace.visible}).map(v.bind(null,Q)),ae=U.selectAll("."+a.cn.sankey).data(te,p);ae.exit().remove(),ae.enter().append("g").classed(a.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",R),ae.each(function(we,De){N._fullData[De]._sankey=we;var Be="bgsankey-"+we.trace.uid+"-"+De;f.ensureSingle(N._fullLayout._draggers,"rect",Be),N._fullData[De]._bgRect=M.select("."+Be),N._fullData[De]._bgRect.style("pointer-events","all").attr("width",we.width).attr("height",we.height).attr("x",we.translateX).attr("y",we.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),ae.transition().ease(a.ease).duration(a.duration).attr("transform",R);var le=ae.selectAll("."+a.cn.sankeyLinks).data(y,p);le.enter().append("g").classed(a.cn.sankeyLinks,!0).style("fill","none");var ye=le.selectAll("."+a.cn.sankeyLink).data(function(we){var De=we.graph.links;return De.filter(function(Be){return Be.value}).map(b.bind(null,we))},p);ye.enter().append("path").classed(a.cn.sankeyLink,!0).call(B,ae,W.linkEvents),ye.style("stroke",function(we){return D(we)?r.tinyRGB(n(we.linkLineColor)):we.tinyColorHue}).style("stroke-opacity",function(we){return D(we)?r.opacity(we.linkLineColor):we.tinyColorAlpha}).style("fill",function(we){return we.tinyColorHue}).style("fill-opacity",function(we){return we.tinyColorAlpha}).style("stroke-width",function(we){return D(we)?we.linkLineWidth:1}).attr("d",L()),ye.style("opacity",function(){return N._context.staticPlot||Z||ee?1:0}).transition().ease(a.ease).duration(a.duration).style("opacity",1),ye.exit().transition().ease(a.ease).duration(a.duration).style("opacity",0).remove();var fe=ae.selectAll("."+a.cn.sankeyNodeSet).data(y,p);fe.enter().append("g").classed(a.cn.sankeyNodeSet,!0),fe.style("cursor",function(we){switch(we.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var pe=fe.selectAll("."+a.cn.sankeyNode).data(function(we){var De=we.graph.nodes;return Y(De),De.map(S.bind(null,we))},p);pe.enter().append("g").classed(a.cn.sankeyNode,!0).call(k).style("opacity",function(we){return(N._context.staticPlot||Z)&&!we.partOfGroup?1:0}),pe.call(B,ae,W.nodeEvents).call(F,ye,W,N),pe.transition().ease(a.ease).duration(a.duration).call(k).style("opacity",function(we){return we.partOfGroup?0:1}),pe.exit().transition().ease(a.ease).duration(a.duration).style("opacity",0).remove();var ge=pe.selectAll("."+a.cn.nodeRect).data(y);ge.enter().append("rect").classed(a.cn.nodeRect,!0).call(I),ge.style("stroke-width",function(we){return we.nodeLineWidth}).style("stroke",function(we){return r.tinyRGB(n(we.nodeLineColor))}).style("stroke-opacity",function(we){return r.opacity(we.nodeLineColor)}).style("fill",function(we){return we.tinyColorHue}).style("fill-opacity",function(we){return we.tinyColorAlpha}),ge.transition().ease(a.ease).duration(a.duration).call(I);var Ae=pe.selectAll("."+a.cn.nodeLabel).data(y);Ae.enter().append("text").classed(a.cn.nodeLabel,!0).style("cursor","default"),Ae.attr("data-notex",1).text(function(we){return we.node.label}).each(function(we){var De=M.select(this);t.font(De,we.textFont),m.convertToTspans(De,N)}).style("text-shadow",m.makeTextShadow(N._fullLayout.paper_bgcolor)).attr("text-anchor",function(we){return we.horizontal&&we.left?"end":"start"}).attr("transform",function(we){var De=M.select(this),Be=m.lineCount(De),Ve=we.textFont.size*((Be-1)*A-s),xe=we.nodeLineWidth/2+x,Le=((we.horizontal?we.visibleHeight:we.visibleWidth)-Ve)/2;we.horizontal&&(we.left?xe=-xe:xe+=we.visibleWidth);var He=we.horizontal?"":"scale(-1,1)"+i(90);return o(we.horizontal?xe:Le,we.horizontal?Le:xe)+He}),Ae.transition().ease(a.ease).duration(a.duration)}},{"../../components/color":366,"../../components/drawing":388,"../../constants/alignment":471,"../../lib":503,"../../lib/gup":500,"../../lib/svg_text_utils":529,"../../registry":638,"./constants":920,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:312}],925:[function(d,re,ne){re.exports=function(c,M){for(var T=c.cd,e=[],a=T[0].trace,n=a._sankey.graph.nodes,r=0;r<n.length;r++){var t=n[r];if(!t.partOfGroup){var f=[(t.x0+t.x1)/2,(t.y0+t.y1)/2];a.orientation==="v"&&f.reverse(),M&&M.contains(f,!1,r,c)&&e.push({pointNumber:t.pointNumber})}}return e}},{}],926:[function(d,re,ne){var w=d("../../lib");re.exports=function(M,T){for(var e=0;e<M.length;e++)M[e].i=e;w.mergeArray(T.text,M,"tx"),w.mergeArray(T.texttemplate,M,"txt"),w.mergeArray(T.hovertext,M,"htx"),w.mergeArray(T.customdata,M,"data"),w.mergeArray(T.textposition,M,"tp"),T.textfont&&(w.mergeArrayCastPositive(T.textfont.size,M,"ts"),w.mergeArray(T.textfont.color,M,"tc"),w.mergeArray(T.textfont.family,M,"tf"));var a=T.marker;if(a){w.mergeArrayCastPositive(a.size,M,"ms"),w.mergeArrayCastPositive(a.opacity,M,"mo"),w.mergeArray(a.symbol,M,"mx"),w.mergeArray(a.color,M,"mc");var n=a.line;a.line&&(w.mergeArray(n.color,M,"mlc"),w.mergeArrayCastPositive(n.width,M,"mlw"));var r=a.gradient;r&&r.type!=="none"&&(w.mergeArray(r.type,M,"mgt"),w.mergeArray(r.color,M,"mgc"))}}},{"../../lib":503}],927:[function(d,re,ne){var w=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,c=d("../../plots/template_attributes").texttemplateAttrs,M=d("../../plots/template_attributes").hovertemplateAttrs,T=d("../../components/colorscale/attributes"),e=d("../../plots/font_attributes"),a=d("../../components/drawing/attributes").dash,n=d("../../components/drawing/attributes").pattern,r=d("../../components/drawing"),t=d("./constants"),f=d("../../lib/extend").extendFlat;function o(p){return{valType:"any",dflt:0,editType:"calc"}}function i(p){return{valType:"any",editType:"calc"}}function g(p){return{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"}}re.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:o(),yperiod:o(),xperiod0:i(),yperiod0:i(),xperiodalignment:g(),yperiodalignment:g(),xhoverformat:w("x"),yhoverformat:w("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:c({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:M({},{keys:t.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:f({},a,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:n,marker:f({symbol:{valType:"enumerated",values:r.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:f({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},T("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},T("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":373,"../../components/drawing":388,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"./constants":931}],928:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("../../plots/cartesian/axes"),T=d("../../plots/cartesian/align_period"),e=d("../../constants/numerical").BADNUM,a=d("./subtypes"),n=d("./colorscale_calc"),r=d("./arrays_to_calcdata"),t=d("./calc_selection");function f(h,m){var u=h._fullLayout,_=M.getFromId(h,m.xaxis||"x"),s=M.getFromId(h,m.yaxis||"y"),A=_.makeCalcdata(m,"x"),x=s.makeCalcdata(m,"y"),v=T(m,_,"x",A),b=T(m,s,"y",x),l=v.vals,L=b.vals,S=m._length,k=new Array(S),P=m.ids,z=y(m,u,_,s),I=!1,D,R,B,F,V,G;g(u,m);var J="x",j="y",Y;if(z)c.pushUnique(z.traceIndices,m._expandedIndex),D=z.orientation==="v",D?(j="s",Y="x"):(J="s",Y="y"),V=z.stackgaps==="interpolate";else{var X=i(m,S);o(h,m,_,s,l,L,X)}var oe=!!m.xperiodalignment,se=!!m.yperiodalignment;for(R=0;R<S;R++){var ie=k[R]={},N=w(l[R]),U=w(L[R]);N&&U?(ie[J]=l[R],ie[j]=L[R],oe&&(ie.orig_x=A[R],ie.xEnd=v.ends[R],ie.xStart=v.starts[R]),se&&(ie.orig_y=x[R],ie.yEnd=b.ends[R],ie.yStart=b.starts[R])):z&&(D?N:U)?(ie[Y]=D?l[R]:L[R],ie.gap=!0,V?(ie.s=e,I=!0):ie.s=0):ie[J]=ie[j]=e,P&&(ie.id=String(P[R]))}if(r(k,m),n(h,m),t(k,m),z){for(R=0;R<k.length;)k[R][Y]===e?k.splice(R,1):R++;if(c.sort(k,function(Z,ee){return Z[Y]-ee[Y]||Z.i-ee.i}),I){for(R=0;R<k.length-1&&k[R].gap;)R++;for(G=k[R].s,G||(G=k[R].s=0),B=0;B<R;B++)k[B].s=G;for(F=k.length-1;F>R&&k[F].gap;)F--;for(G=k[F].s,B=k.length-1;B>F;B--)k[B].s=G;for(;R<F;)if(R++,k[R].gap){for(B=R+1;k[B].gap;)B++;for(var q=k[R-1][Y],Q=k[R-1].s,W=(k[B].s-Q)/(k[B][Y]-q);R<B;)k[R].s=Q+(k[R][Y]-q)*W,R++}}}return k}function o(h,m,u,_,s,A,x){var v=m._length,b=h._fullLayout,l=u._id,L=_._id,S=b._firstScatter[p(m)]===m.uid,k=(y(m,b,u,_)||{}).orientation,P=m.fill;u._minDtick=0,_._minDtick=0;var z={padded:!0},I={padded:!0};x&&(z.ppad=I.ppad=x);var D=v<2||s[0]!==s[v-1]||A[0]!==A[v-1];D&&(P==="tozerox"||P==="tonextx"&&(S||k==="h"))?z.tozero=!0:!(m.error_y||{}).visible&&(P==="tonexty"||P==="tozeroy"||!a.hasMarkers(m)&&!a.hasText(m))&&(z.padded=!1,z.ppad=0),D&&(P==="tozeroy"||P==="tonexty"&&(S||k==="v"))?I.tozero=!0:(P==="tonextx"||P==="tozerox")&&(I.padded=!1),l&&(m._extremes[l]=M.findExtremes(u,s,z)),L&&(m._extremes[L]=M.findExtremes(_,A,I))}function i(h,m){if(!!a.hasMarkers(h)){var u=h.marker,_=1.6*(h.marker.sizeref||1),s;if(h.marker.sizemode==="area"?s=function(l){return Math.max(Math.sqrt((l||0)/_),3)}:s=function(l){return Math.max((l||0)/_,3)},c.isArrayOrTypedArray(u.size)){var A={type:"linear"};M.setConvert(A);for(var x=A.makeCalcdata(h.marker,"size"),v=new Array(m),b=0;b<m;b++)v[b]=s(x[b]);return v}else return s(u.size)}}function g(h,m){var u=p(m),_=h._firstScatter;_[u]||(_[u]=m.uid)}function p(h){var m=h.stackgroup;return h.xaxis+h.yaxis+h.type+(m?"-"+m:"")}function y(h,m,u,_){var s=h.stackgroup;if(!!s){var A=m._scatterStackOpts[u._id+_._id][s],x=A.orientation==="v"?_:u;if(x.type==="linear"||x.type==="log")return A}}re.exports={calc:f,calcMarkerSize:i,calcAxisExpansion:o,setFirstScatter:g,getStackOpts:y}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"./arrays_to_calcdata":926,"./calc_selection":929,"./colorscale_calc":930,"./subtypes":952,"fast-isnumeric":190}],929:[function(d,re,ne){var w=d("../../lib");re.exports=function(M,T){w.isArrayOrTypedArray(T.selectedpoints)&&w.tagSelected(M,T)}},{"../../lib":503}],930:[function(d,re,ne){var w=d("../../components/colorscale/helpers").hasColorscale,c=d("../../components/colorscale/calc"),M=d("./subtypes");re.exports=function(e,a){M.hasLines(a)&&w(a,"line")&&c(e,a,{vals:a.line.color,containerStr:"line",cLetter:"c"}),M.hasMarkers(a)&&(w(a,"marker")&&c(e,a,{vals:a.marker.color,containerStr:"marker",cLetter:"c"}),w(a,"marker.line")&&c(e,a,{vals:a.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"./subtypes":952}],931:[function(d,re,ne){re.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],932:[function(d,re,ne){var w=d("./calc");re.exports=function(e,a){var n=a.xaxis,r=a.yaxis,t=n._id+r._id,f=e._fullLayout._scatterStackOpts[t];if(!!f){var o=e.calcdata,i,g,p,y,h,m,u,_,s,A,x,v,b,l,L;for(var S in f){A=f[S];var k=A.traceIndices;if(!!k.length){for(x=A.stackgaps==="interpolate",v=A.groupnorm,A.orientation==="v"?(b="x",l="y"):(b="y",l="x"),L=new Array(k.length),i=0;i<L.length;i++)L[i]=!1;m=o[k[0]];var P=new Array(m.length);for(i=0;i<m.length;i++)P[i]=m[i][b];for(i=1;i<k.length;i++){for(h=o[k[i]],g=p=0;g<h.length;g++){for(u=h[g][b];u>P[p]&&p<P.length;p++)c(h,g,P[p],i,L,x,b),g++;if(u!==P[p]){for(y=0;y<i;y++)c(o[k[y]],p,u,y,L,x,b);P.splice(p,0,u)}p++}for(;p<P.length;p++)c(h,g,P[p],i,L,x,b),g++}var z=P.length;for(g=0;g<m.length;g++){for(_=m[g][l]=m[g].s,i=1;i<k.length;i++)h=o[k[i]],h[0].trace._rawLength=h[0].trace._length,h[0].trace._length=z,_+=h[g].s,h[g][l]=_;if(v)for(s=(v==="fraction"?_:_/100)||1,i=0;i<k.length;i++){var I=o[k[i]][g];I[l]/=s,I.sNorm=I.s/s}}for(i=0;i<k.length;i++){h=o[k[i]];var D=h[0].trace,R=w.calcMarkerSize(D,D._rawLength),B=Array.isArray(R);if(R&&L[i]||B){var F=R;for(R=new Array(z),g=0;g<z;g++)R[g]=h[g].gap?0:B?F[h[g].i]:F}var V=new Array(z),G=new Array(z);for(g=0;g<z;g++)V[g]=h[g].x,G[g]=h[g].y;w.calcAxisExpansion(e,D,n,r,V,G,R),h[0].t.orientation=A.orientation}}}}};function c(T,e,a,n,r,t,f){r[n]=!0;var o={i:null,gap:!0,s:0};if(o[f]=a,T.splice(e,0,o),e&&a===T[e-1][f]){var i=T[e-1];o.s=i.s,o.i=i.i,o.gap=i.gap}else t&&(o.s=M(T,e,a,f));e||(T[0].t=T[1].t,T[0].trace=T[1].trace,delete T[1].t,delete T[1].trace)}function M(T,e,a,n){var r=T[e-1],t=T[e+1];return t?r?r.s+(t.s-r.s)*(a-r[n])/(t[n]-r[n]):t.s:r.s}},{"./calc":928}],933:[function(d,re,ne){re.exports=function(c){for(var M=0;M<c.length;M++){var T=c[M];if(T.type==="scatter"){var e=T.fill;if(!(e==="none"||e==="toself")&&(T.opacity=void 0,e==="tonexty"||e==="tonextx"))for(var a=M-1;a>=0;a--){var n=c[a];if(n.type==="scatter"&&n.xaxis===T.xaxis&&n.yaxis===T.yaxis){n.opacity=void 0;break}}}}}},{}],934:[function(d,re,ne){var w=d("../../lib"),c=d("../../registry"),M=d("./attributes"),T=d("./constants"),e=d("./subtypes"),a=d("./xy_defaults"),n=d("./period_defaults"),r=d("./stack_defaults"),t=d("./marker_defaults"),f=d("./line_defaults"),o=d("./line_shape_defaults"),i=d("./text_defaults"),g=d("./fillcolor_defaults"),p=d("../../lib").coercePattern;re.exports=function(h,m,u,_){function s(k,P){return w.coerce(h,m,M,k,P)}var A=a(h,m,_,s);if(A||(m.visible=!1),!!m.visible){n(h,m,_,s),s("xhoverformat"),s("yhoverformat");var x=r(h,m,_,s),v=!x&&A<T.PTS_LINESONLY?"lines+markers":"lines";s("text"),s("hovertext"),s("mode",v),e.hasLines(m)&&(f(h,m,u,_,s),o(h,m,s),s("connectgaps"),s("line.simplify")),e.hasMarkers(m)&&t(h,m,u,_,s,{gradient:!0}),e.hasText(m)&&(s("texttemplate"),i(h,m,_,s));var b=[];(e.hasMarkers(m)||e.hasText(m))&&(s("cliponaxis"),s("marker.maxdisplayed"),b.push("points")),s("fill",x?x.fillDflt:"none"),m.fill!=="none"&&(g(h,m,u,s),e.hasLines(m)||o(h,m,s),p(s,"fillpattern",m.fillcolor,!1));var l=(m.line||{}).color,L=(m.marker||{}).color;(m.fill==="tonext"||m.fill==="toself")&&b.push("fills"),s("hoveron",b.join("+")||"points"),m.hoveron!=="fills"&&s("hovertemplate");var S=c.getComponentMethod("errorbars","supplyDefaults");S(h,m,l||L||u,{axis:"y"}),S(h,m,l||L||u,{axis:"x",inherit:"y"}),w.coerceSelectionMarkerOpacity(m,s)}}},{"../../lib":503,"../../registry":638,"./attributes":927,"./constants":931,"./fillcolor_defaults":935,"./line_defaults":940,"./line_shape_defaults":942,"./marker_defaults":946,"./period_defaults":947,"./stack_defaults":950,"./subtypes":952,"./text_defaults":953,"./xy_defaults":954}],935:[function(d,re,ne){var w=d("../../components/color"),c=d("../../lib").isArrayOrTypedArray;re.exports=function(T,e,a,n){var r=!1;if(e.marker){var t=e.marker.color,f=(e.marker.line||{}).color;t&&!c(t)?r=t:f&&!c(f)&&(r=f)}n("fillcolor",w.addOpacity((e.line||{}).color||r||a,.5))}},{"../../components/color":366,"../../lib":503}],936:[function(d,re,ne){var w=d("../../plots/cartesian/axes");re.exports=function(M,T,e){var a={},n={_fullLayout:e},r=w.getFromTrace(n,T,"x"),t=w.getFromTrace(n,T,"y");return a.xLabel=w.tickText(r,r.c2l(M.x),!0).text,a.yLabel=w.tickText(t,t.c2l(M.y),!0).text,a}},{"../../plots/cartesian/axes":554}],937:[function(d,re,ne){var w=d("../../components/color"),c=d("./subtypes");re.exports=function(T,e){var a,n;if(T.mode==="lines")return a=T.line.color,a&&w.opacity(a)?a:T.fillcolor;if(T.mode==="none")return T.fill?T.fillcolor:"";var r=e.mcc||(T.marker||{}).color,t=e.mlcc||((T.marker||{}).line||{}).color;return n=r&&w.opacity(r)?r:t&&w.opacity(t)&&(e.mlw||((T.marker||{}).line||{}).width)?t:"",n?w.opacity(n)<.3?w.addOpacity(n,.3):n:(a=(T.line||{}).color,a&&w.opacity(a)&&c.hasLines(T)&&T.line.width?a:T.fillcolor)}},{"../../components/color":366,"./subtypes":952}],938:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/fx"),M=d("../../registry"),T=d("./get_trace_color"),e=d("../../components/color"),a=w.fillText;re.exports=function(r,t,f,o){var i=r.cd,g=i[0].trace,p=r.xa,y=r.ya,h=p.c2p(t),m=y.c2p(f),u=[h,m],_=g.hoveron||"",s=g.mode.indexOf("markers")!==-1?3:.5,A=!!g.xperiodalignment,x=!!g.yperiodalignment;if(_.indexOf("points")!==-1){var v=function(ae){if(A){var le=p.c2p(ae.xStart),ye=p.c2p(ae.xEnd);return h>=Math.min(le,ye)&&h<=Math.max(le,ye)?0:1/0}var fe=Math.max(3,ae.mrc||0),pe=1-1/fe,ge=Math.abs(p.c2p(ae.x)-h);return ge<fe?pe*ge/fe:ge-fe+pe},b=function(ae){if(x){var le=y.c2p(ae.yStart),ye=y.c2p(ae.yEnd);return m>=Math.min(le,ye)&&m<=Math.max(le,ye)?0:1/0}var fe=Math.max(3,ae.mrc||0),pe=1-1/fe,ge=Math.abs(y.c2p(ae.y)-m);return ge<fe?pe*ge/fe:ge-fe+pe},l=function(ae){var le=Math.max(s,ae.mrc||0),ye=p.c2p(ae.x)-h,fe=y.c2p(ae.y)-m;return Math.max(Math.sqrt(ye*ye+fe*fe)-le,1-s/le)},L=c.getDistanceFunction(o,v,b,l);if(c.getClosest(i,L,r),r.index!==!1){var S=i[r.index],k=p.c2p(S.x,!0),P=y.c2p(S.y,!0),z=S.mrc||1;r.index=S.i;var I=i[0].t.orientation,D=I&&(S.sNorm||S.s),R=I==="h"?D:S.orig_x!==void 0?S.orig_x:S.x,B=I==="v"?D:S.orig_y!==void 0?S.orig_y:S.y;return w.extendFlat(r,{color:T(g,S),x0:k-z,x1:k+z,xLabelVal:R,y0:P-z,y1:P+z,yLabelVal:B,spikeDistance:l(S),hovertemplate:g.hovertemplate}),a(S,g,r),M.getComponentMethod("errorbars","hoverInfo")(S,g,r),[r]}}if(_.indexOf("fills")!==-1&&g._polygons){var F=g._polygons,V=[],G=!1,J=1/0,j=-1/0,Y=1/0,X=-1/0,oe,se,ie,N,U,q,Q,W,Z;for(oe=0;oe<F.length;oe++)ie=F[oe],ie.contains(u)&&(G=!G,V.push(ie),Y=Math.min(Y,ie.ymin),X=Math.max(X,ie.ymax));if(G){Y=Math.max(Y,0),X=Math.min(X,y._length);var ee=(Y+X)/2;for(oe=0;oe<V.length;oe++)for(N=V[oe].pts,se=1;se<N.length;se++)W=N[se-1][1],Z=N[se][1],W>ee!=Z>=ee&&(q=N[se-1][0],Q=N[se][0],Z-W&&(U=q+(Q-q)*(ee-W)/(Z-W),J=Math.min(J,U),j=Math.max(j,U)));J=Math.max(J,0),j=Math.min(j,p._length);var te=e.defaultLine;return e.opacity(g.fillcolor)?te=g.fillcolor:e.opacity((g.line||{}).color)&&(te=g.line.color),w.extendFlat(r,{distance:r.maxHoverDistance,x0:J,x1:j,y0:ee,y1:ee,color:te,hovertemplate:!1}),delete r.index,g.text&&!Array.isArray(g.text)?r.text=String(g.text):r.text=g.name,[r]}}}},{"../../components/color":366,"../../components/fx":406,"../../lib":503,"../../registry":638,"./get_trace_color":937}],939:[function(d,re,ne){var w=d("./subtypes");re.exports={hasLines:w.hasLines,hasMarkers:w.hasMarkers,hasText:w.hasText,isBubble:w.isBubble,attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("./cross_trace_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./cross_trace_calc"),arraysToCalcdata:d("./arrays_to_calcdata"),plot:d("./plot"),colorbar:d("./marker_colorbar"),formatLabels:d("./format_labels"),style:d("./style").style,styleOnSelect:d("./style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"./arrays_to_calcdata":926,"./attributes":927,"./calc":928,"./cross_trace_calc":932,"./cross_trace_defaults":933,"./defaults":934,"./format_labels":936,"./hover":938,"./marker_colorbar":945,"./plot":948,"./select":949,"./style":951,"./subtypes":952}],940:[function(d,re,ne){var w=d("../../lib").isArrayOrTypedArray,c=d("../../components/colorscale/helpers").hasColorscale,M=d("../../components/colorscale/defaults");re.exports=function(e,a,n,r,t,f){var o=(e.marker||{}).color;if(t("line.color",n),c(e,"line"))M(e,a,r,t,{prefix:"line.",cLetter:"c"});else{var i=(w(o)?!1:o)||n;t("line.color",i)}t("line.width"),(f||{}).noDash||t("line.dash")}},{"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503}],941:[function(d,re,ne){var w=d("../../constants/numerical"),c=w.BADNUM,M=w.LOG_CLIP,T=M+.5,e=M-.5,a=d("../../lib"),n=a.segmentsIntersect,r=a.constrain,t=d("./constants");re.exports=function(o,i){var g=i.xaxis,p=i.yaxis,y=g.type==="log",h=p.type==="log",m=g._length,u=p._length,_=i.connectGaps,s=i.baseTolerance,A=i.shape,x=A==="linear",v=i.fill&&i.fill!=="none",b=[],l=t.minTolerance,L=o.length,S=new Array(L),k=0,P,z,I,D,R,B,F,V,G,J,j,Y,X,oe,se,ie;function N(At){var Rt=o[At];if(!Rt)return!1;var Bt=i.linearized?g.l2p(Rt.x):g.c2p(Rt.x),Mt=i.linearized?p.l2p(Rt.y):p.c2p(Rt.y);if(Bt===c){if(y&&(Bt=g.c2p(Rt.x,!0)),Bt===c)return!1;h&&Mt===c&&(Bt*=Math.abs(g._m*u*(g._m>0?T:e)/(p._m*m*(p._m>0?T:e)))),Bt*=1e3}if(Mt===c){if(h&&(Mt=p.c2p(Rt.y,!0)),Mt===c)return!1;Mt*=1e3}return[Bt,Mt]}function U(At,Rt,Bt,Mt){var Tt=Bt-At,at=Mt-Rt,ct=.5-At,je=.5-Rt,ke=Tt*Tt+at*at,Ye=Tt*ct+at*je;if(Ye>0&&Ye<ke){var Ke=ct*at-je*Tt;if(Ke*Ke<ke)return!0}}var q,Q;function W(At,Rt){var Bt=At[0]/m,Mt=At[1]/u,Tt=Math.max(0,-Bt,Bt-1,-Mt,Mt-1);return Tt&&q!==void 0&&U(Bt,Mt,q,Q)&&(Tt=0),Tt&&Rt&&U(Bt,Mt,Rt[0]/m,Rt[1]/u)&&(Tt=0),(1+t.toleranceGrowth*Tt)*s}function Z(At,Rt){var Bt=At[0]-Rt[0],Mt=At[1]-Rt[1];return Math.sqrt(Bt*Bt+Mt*Mt)}var ee=t.maxScreensAway,te=-m*ee,ae=m*(1+ee),le=-u*ee,ye=u*(1+ee),fe=[[te,le,ae,le],[ae,le,ae,ye],[ae,ye,te,ye],[te,ye,te,le]],pe,ge,Ae,we,De,Be;function Ve(At,Rt){for(var Bt=[],Mt=0,Tt=0;Tt<4;Tt++){var at=fe[Tt],ct=n(At[0],At[1],Rt[0],Rt[1],at[0],at[1],at[2],at[3]);ct&&(!Mt||Math.abs(ct.x-Bt[0][0])>1||Math.abs(ct.y-Bt[0][1])>1)&&(ct=[ct.x,ct.y],Mt&&Z(ct,At)<Z(Bt[0],At)?Bt.unshift(ct):Bt.push(ct),Mt++)}return Bt}function xe(At){if(At[0]<te||At[0]>ae||At[1]<le||At[1]>ye)return[r(At[0],te,ae),r(At[1],le,ye)]}function Le(At,Rt){if(At[0]===Rt[0]&&(At[0]===te||At[0]===ae)||At[1]===Rt[1]&&(At[1]===le||At[1]===ye))return!0}function He(At,Rt){var Bt=[],Mt=xe(At),Tt=xe(Rt);return Mt&&Tt&&Le(Mt,Tt)||(Mt&&Bt.push(Mt),Tt&&Bt.push(Tt)),Bt}function Je(At,Rt,Bt){return function(Mt,Tt){var at=xe(Mt),ct=xe(Tt),je=[];if(at&&ct&&Le(at,ct))return je;at&&je.push(at),ct&&je.push(ct);var ke=2*a.constrain((Mt[At]+Tt[At])/2,Rt,Bt)-((at||Mt)[At]+(ct||Tt)[At]);if(ke){var Ye;at&&ct?Ye=ke>0==at[At]>ct[At]?at:ct:Ye=at||ct,Ye[At]+=ke}return je}}var Oe;A==="linear"||A==="spline"?Oe=Ve:A==="hv"||A==="vh"?Oe=He:A==="hvh"?Oe=Je(0,te,ae):A==="vhv"&&(Oe=Je(1,le,ye));function Pe(At,Rt){var Bt=Rt[0]-At[0],Mt=(Rt[1]-At[1])/Bt,Tt=(At[1]*Rt[0]-Rt[1]*At[0])/Bt;return Tt>0?[Mt>0?te:ae,ye]:[Mt>0?ae:te,le]}function Ue(At){var Rt=At[0],Bt=At[1],Mt=Rt===S[k-1][0],Tt=Bt===S[k-1][1];if(!(Mt&&Tt))if(k>1){var at=Rt===S[k-2][0],ct=Bt===S[k-2][1];Mt&&(Rt===te||Rt===ae)&&at?ct?k--:S[k-1]=At:Tt&&(Bt===le||Bt===ye)&&ct?at?k--:S[k-1]=At:S[k++]=At}else S[k++]=At}function vt(At){S[k-1][0]!==At[0]&&S[k-1][1]!==At[1]&&Ue([Ae,we]),Ue(At),De=null,Ae=we=0}function Lt(At){if(q=At[0]/m,Q=At[1]/u,pe=At[0]<te?te:At[0]>ae?ae:0,ge=At[1]<le?le:At[1]>ye?ye:0,pe||ge){if(!k)S[k++]=[pe||At[0],ge||At[1]];else if(De){var Rt=Oe(De,At);Rt.length>1&&(vt(Rt[0]),S[k++]=Rt[1])}else Be=Oe(S[k-1],At)[0],S[k++]=Be;var Bt=S[k-1];pe&&ge&&(Bt[0]!==pe||Bt[1]!==ge)?(De&&(Ae!==pe&&we!==ge?Ue(Ae&&we?Pe(De,At):[Ae||pe,we||ge]):Ae&&we&&Ue([Ae,we])),Ue([pe,ge])):Ae-pe&&we-ge&&Ue([pe||Ae,ge||we]),De=At,Ae=pe,we=ge}else De&&vt(Oe(De,At)[0]),S[k++]=At}for(P=0;P<L;P++)if(z=N(P),!!z){for(k=0,De=null,Lt(z),P++;P<L;P++){if(D=N(P),!D){if(_)continue;break}if(!x||!i.simplify){Lt(D);continue}var Yt=N(P+1);if(J=Z(D,z),!(!(v&&(k===0||k===L-1))&&J<W(D,Yt)*l)){for(V=[(D[0]-z[0])/J,(D[1]-z[1])/J],R=z,j=J,Y=oe=se=0,F=!1,I=D,P++;P<o.length;P++){if(B=Yt,Yt=N(P+1),!B){if(_)continue;break}if(G=[B[0]-z[0],B[1]-z[1]],ie=G[0]*V[1]-G[1]*V[0],oe=Math.min(oe,ie),se=Math.max(se,ie),se-oe>W(B,Yt))break;I=B,X=G[0]*V[0]+G[1]*V[1],X>j?(j=X,D=B,F=!1):X<Y&&(Y=X,R=B,F=!0)}if(F?(Lt(D),I!==R&&Lt(R)):(R!==z&&Lt(R),I!==D&&Lt(D)),Lt(I),P>=o.length||!B)break;Lt(B),z=B}}De&&Ue([Ae||De[0],we||De[1]]),b.push(S.slice(0,k))}return b}},{"../../constants/numerical":479,"../../lib":503,"./constants":931}],942:[function(d,re,ne){re.exports=function(c,M,T){var e=T("line.shape");e==="spline"&&T("line.smoothing")}},{}],943:[function(d,re,ne){var w={tonextx:1,tonexty:1,tonext:1};re.exports=function(M,T,e){var a,n,r,t,f,o={},i=!1,g=-1,p=0,y=-1;for(n=0;n<e.length;n++)a=e[n][0].trace,r=a.stackgroup||"",r?r in o?f=o[r]:(f=o[r]=p,p++):a.fill in w&&y>=0?f=y:(f=y=p,p++),f<g&&(i=!0),a._groupIndex=g=f;var h=e.slice();i&&h.sort(function(u,_){var s=u[0].trace,A=_[0].trace;return s._groupIndex-A._groupIndex||s.index-A.index});var m={};for(n=0;n<h.length;n++)a=h[n][0].trace,r=a.stackgroup||"",a.visible===!0?(a._nexttrace=null,a.fill in w&&(t=m[r],a._prevtrace=t||null,t&&(t._nexttrace=a)),a._ownfill=a.fill&&(a.fill.substr(0,6)==="tozero"||a.fill==="toself"||a.fill.substr(0,2)==="to"&&!a._prevtrace),m[r]=a):a._prevtrace=a._nexttrace=a._ownfill=null;return h}},{}],944:[function(d,re,ne){var w=d("fast-isnumeric");re.exports=function(M,T){T||(T=2);var e=M.marker,a=e.sizeref||1,n=e.sizemin||0,r=e.sizemode==="area"?function(t){return Math.sqrt(t/a)}:function(t){return t/a};return function(t){var f=r(t/T);return w(f)&&f>0?Math.max(f,n):0}}},{"fast-isnumeric":190}],945:[function(d,re,ne){re.exports={container:"marker",min:"cmin",max:"cmax"}},{}],946:[function(d,re,ne){var w=d("../../components/color"),c=d("../../components/colorscale/helpers").hasColorscale,M=d("../../components/colorscale/defaults"),T=d("./subtypes");re.exports=function(a,n,r,t,f,o){var i=T.isBubble(a),g=(a.line||{}).color,p;if(o=o||{},g&&(r=g),f("marker.symbol"),f("marker.opacity",i?.7:1),f("marker.size"),f("marker.color",r),c(a,"marker")&&M(a,n,t,f,{prefix:"marker.",cLetter:"c"}),o.noSelect||(f("selected.marker.color"),f("unselected.marker.color"),f("selected.marker.size"),f("unselected.marker.size")),o.noLine||(g&&!Array.isArray(g)&&n.marker.color!==g?p=g:i?p=w.background:p=w.defaultLine,f("marker.line.color",p),c(a,"marker.line")&&M(a,n,t,f,{prefix:"marker.line.",cLetter:"c"}),f("marker.line.width",i?1:0)),i&&(f("marker.sizeref"),f("marker.sizemin"),f("marker.sizemode")),o.gradient){var y=f("marker.gradient.type");y!=="none"&&f("marker.gradient.color")}}},{"../../components/color":366,"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"./subtypes":952}],947:[function(d,re,ne){var w=d("../../lib").dateTick0,c=d("../../constants/numerical"),M=c.ONEWEEK;function T(e,a){return e%M===0?w(a,1):w(a,0)}re.exports=function(a,n,r,t,f){if(f||(f={x:!0,y:!0}),f.x){var o=t("xperiod");o&&(t("xperiod0",T(o,n.xcalendar)),t("xperiodalignment"))}if(f.y){var i=t("yperiod");i&&(t("yperiod0",T(i,n.ycalendar)),t("yperiodalignment"))}}},{"../../constants/numerical":479,"../../lib":503}],948:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../registry"),M=d("../../lib"),T=M.ensureSingle,e=M.identity,a=d("../../components/drawing"),n=d("./subtypes"),r=d("./line_points"),t=d("./link_traces"),f=d("../../lib/polygon").tester;re.exports=function(y,h,m,u,_,s){var A,x,v=!_,b=!!_&&_.duration>0,l=t(y,h,m);if(A=u.selectAll("g.trace").data(l,function(S){return S[0].trace.uid}),A.enter().append("g").attr("class",function(S){return"trace scatter trace"+S[0].trace.uid}).style("stroke-miterlimit",2),A.order(),o(y,A,h),b){s&&(x=s());var L=w.transition().duration(_.duration).ease(_.easing).each("end",function(){x&&x()}).each("interrupt",function(){x&&x()});L.each(function(){u.selectAll("g.trace").each(function(S,k){i(y,k,h,S,l,this,_)})})}else A.each(function(S,k){i(y,k,h,S,l,this,_)});v&&A.exit().remove(),u.selectAll("path:not([d])").remove()};function o(p,y,h){y.each(function(m){var u=T(w.select(this),"g","fills");a.setClipUrl(u,h.layerClipId,p);var _=m[0].trace,s=[];_._ownfill&&s.push("_ownFill"),_._nexttrace&&s.push("_nextFill");var A=u.selectAll("g").data(s,e);A.enter().append("g"),A.exit().each(function(x){_[x]=null}).remove(),A.order().each(function(x){_[x]=T(w.select(this),"path","js-fill")})})}function i(p,y,h,m,u,_,s){var A;g(p,y,h,m,u);var x=!!s&&s.duration>0;function v(Ve){return x?Ve.transition():Ve}var b=h.xaxis,l=h.yaxis,L=m[0].trace,S=L.line,k=w.select(_),P=T(k,"g","errorbars"),z=T(k,"g","lines"),I=T(k,"g","points"),D=T(k,"g","text");if(c.getComponentMethod("errorbars","plot")(p,P,h,s),L.visible!==!0)return;v(k).style("opacity",L.opacity);var R,B,F=L.fill.charAt(L.fill.length-1);F!=="x"&&F!=="y"&&(F=""),m[0][h.isRangePlot?"nodeRangePlot3":"node3"]=k;var V="",G=[],J=L._prevtrace;J&&(V=J._prevRevpath||"",B=J._nextFill,G=J._polygons);var j,Y,X="",oe="",se,ie,N,U,q,Q,W,Z=[],ee=M.noop;if(R=L._ownFill,n.hasLines(L)||L.fill!=="none"){for(B&&B.datum(m),["hv","vh","hvh","vhv"].indexOf(S.shape)!==-1?(se=a.steps(S.shape),ie=a.steps(S.shape.split("").reverse().join(""))):S.shape==="spline"?se=ie=function(Ve){var xe=Ve[Ve.length-1];return Ve.length>1&&Ve[0][0]===xe[0]&&Ve[0][1]===xe[1]?a.smoothclosed(Ve.slice(1),S.smoothing):a.smoothopen(Ve,S.smoothing)}:se=ie=function(Ve){return"M"+Ve.join("L")},N=function(Ve){return ie(Ve.reverse())},Z=r(m,{xaxis:b,yaxis:l,connectGaps:L.connectgaps,baseTolerance:Math.max(S.width||1,3)/4,shape:S.shape,simplify:S.simplify,fill:L.fill}),W=L._polygons=new Array(Z.length),A=0;A<Z.length;A++)L._polygons[A]=f(Z[A]);Z.length&&(U=Z[0][0],q=Z[Z.length-1],Q=q[q.length-1]),ee=function(Ve){return function(xe){if(j=se(xe),Y=N(xe),X?F?(X+="L"+j.substr(1),oe=Y+("L"+oe.substr(1))):(X+="Z"+j,oe=Y+"Z"+oe):(X=j,oe=Y),n.hasLines(L)&&xe.length>1){var Le=w.select(this);if(Le.datum(m),Ve)v(Le.style("opacity",0).attr("d",j).call(a.lineGroupStyle)).style("opacity",1);else{var He=v(Le);He.attr("d",j),a.singleLineStyle(m,He)}}}}}var te=z.selectAll(".js-line").data(Z);v(te.exit()).style("opacity",0).remove(),te.each(ee(!1)),te.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(a.lineGroupStyle).each(ee(!0)),a.setClipUrl(te,h.layerClipId,p);function ae(Ve){v(Ve).attr("d","M0,0Z")}Z.length?(R?(R.datum(m),U&&Q&&(F?(F==="y"?U[1]=Q[1]=l.c2p(0,!0):F==="x"&&(U[0]=Q[0]=b.c2p(0,!0)),v(R).attr("d","M"+Q+"L"+U+"L"+X.substr(1)).call(a.singleFillStyle,p)):v(R).attr("d",X+"Z").call(a.singleFillStyle,p))):B&&(L.fill.substr(0,6)==="tonext"&&X&&V?(L.fill==="tonext"?v(B).attr("d",X+"Z"+V+"Z").call(a.singleFillStyle,p):v(B).attr("d",X+"L"+V.substr(1)+"Z").call(a.singleFillStyle,p),L._polygons=L._polygons.concat(G)):(ae(B),L._polygons=null)),L._prevRevpath=oe,L._prevPolygons=W):(R?ae(R):B&&ae(B),L._polygons=L._prevRevpath=L._prevPolygons=null);function le(Ve){return Ve.filter(function(xe){return!xe.gap&&xe.vis})}function ye(Ve){return Ve.filter(function(xe){return xe.vis})}function fe(Ve){return Ve.filter(function(xe){return!xe.gap})}function pe(Ve){return Ve.id}function ge(Ve){if(Ve.ids)return pe}function Ae(){return!1}function we(Ve,xe,Le){var He,Je,Oe,Pe=Le[0].trace,Ue=n.hasMarkers(Pe),vt=n.hasText(Pe),Lt=ge(Pe),Yt=Ae,At=Ae;if(Ue||vt){var Rt=e,Bt=Pe.stackgroup,Mt=Bt&&p._fullLayout._scatterStackOpts[b._id+l._id][Bt].stackgaps==="infer zero";Pe.marker.maxdisplayed||Pe._needsCull?Rt=Mt?ye:le:Bt&&!Mt&&(Rt=fe),Ue&&(Yt=Rt),vt&&(At=Rt)}Je=Ve.selectAll("path.point"),He=Je.data(Yt,Lt);var Tt=He.enter().append("path").classed("point",!0);x&&Tt.call(a.pointStyle,Pe,p).call(a.translatePoints,b,l).style("opacity",0).transition().style("opacity",1),He.order();var at;Ue&&(at=a.makePointStyleFns(Pe)),He.each(function(ct){var je=w.select(this),ke=v(je);Oe=a.translatePoint(ct,ke,b,l),Oe?(a.singlePointStyle(ct,ke,Pe,at,p),h.layerClipId&&a.hideOutsideRangePoint(ct,ke,b,l,Pe.xcalendar,Pe.ycalendar),Pe.customdata&&je.classed("plotly-customdata",ct.data!==null&&ct.data!==void 0)):ke.remove()}),x?He.exit().transition().style("opacity",0).remove():He.exit().remove(),Je=xe.selectAll("g"),He=Je.data(At,Lt),He.enter().append("g").classed("textpoint",!0).append("text"),He.order(),He.each(function(ct){var je=w.select(this),ke=v(je.select("text"));Oe=a.translatePoint(ct,ke,b,l),Oe?h.layerClipId&&a.hideOutsideRangePoint(ct,je,b,l,Pe.xcalendar,Pe.ycalendar):je.remove()}),He.selectAll("text").call(a.textPointStyle,Pe,p).each(function(ct){var je=b.c2p(ct.x),ke=l.c2p(ct.y);w.select(this).selectAll("tspan.line").each(function(){v(w.select(this)).attr({x:je,y:ke})})}),He.exit().remove()}I.datum(m),D.datum(m),we(I,D,m);var De=L.cliponaxis===!1,Be=De?null:h.layerClipId;a.setClipUrl(I,Be,p),a.setClipUrl(D,Be,p)}function g(p,y,h,m,u){var _=h.xaxis,s=h.yaxis,A=w.extent(M.simpleMap(_.range,_.r2c)),x=w.extent(M.simpleMap(s.range,s.r2c)),v=m[0].trace;if(!!n.hasMarkers(v)){var b=v.marker.maxdisplayed;if(b!==0){var l=m.filter(function(P){return P.x>=A[0]&&P.x<=A[1]&&P.y>=x[0]&&P.y<=x[1]}),L=Math.ceil(l.length/b),S=0;u.forEach(function(P,z){var I=P[0].trace;n.hasMarkers(I)&&I.marker.maxdisplayed>0&&z<y&&S++});var k=Math.round(S*L/3+Math.floor(S/3)*L/7.1);m.forEach(function(P){delete P.vis}),l.forEach(function(P,z){Math.round((z+k)%L)===0&&(P.vis=!0)})}}}},{"../../components/drawing":388,"../../lib":503,"../../lib/polygon":515,"../../registry":638,"./line_points":941,"./link_traces":943,"./subtypes":952,"@plotly/d3":58}],949:[function(d,re,ne){var w=d("./subtypes");re.exports=function(M,T){var e=M.cd,a=M.xaxis,n=M.yaxis,r=[],t=e[0].trace,f,o,i,g,p=!w.hasMarkers(t)&&!w.hasText(t);if(p)return[];if(T===!1)for(f=0;f<e.length;f++)e[f].selected=0;else for(f=0;f<e.length;f++)o=e[f],i=a.c2p(o.x),g=n.c2p(o.y),o.i!==null&&T.contains([i,g],!1,f,M)?(r.push({pointNumber:o.i,x:a.c2d(o.x),y:n.c2d(o.y)}),o.selected=1):o.selected=0;return r}},{"./subtypes":952}],950:[function(d,re,ne){var w=["orientation","groupnorm","stackgaps"];re.exports=function(M,T,e,a){var n=e._scatterStackOpts,r=a("stackgroup");if(r){var t=T.xaxis+T.yaxis,f=n[t];f||(f=n[t]={});var o=f[r],i=!1;o?o.traces.push(T):(o=f[r]={traceIndices:[],traces:[T]},i=!0);for(var g={orientation:T.x&&!T.y?"h":"v"},p=0;p<w.length;p++){var y=w[p],h=y+"Found";if(!o[h]){var m=M[y]!==void 0,u=y==="orientation";if((m||i)&&(o[y]=a(y,g[y]),u&&(o.fillDflt=o[y]==="h"?"tonextx":"tonexty"),m&&(o[h]=!0,!i&&(delete o.traces[0][y],u))))for(var _=0;_<o.traces.length-1;_++){var s=o.traces[_];s._input.fill!==s.fill&&(s.fill=o.fillDflt)}}}return o}}},{}],951:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/drawing"),M=d("../../registry");function T(r){var t=w.select(r).selectAll("g.trace.scatter");t.style("opacity",function(f){return f[0].trace.opacity}),t.selectAll("g.points").each(function(f){var o=w.select(this),i=f.trace||f[0].trace;e(o,i,r)}),t.selectAll("g.text").each(function(f){var o=w.select(this),i=f.trace||f[0].trace;a(o,i,r)}),t.selectAll("g.trace path.js-line").call(c.lineGroupStyle),t.selectAll("g.trace path.js-fill").call(c.fillGroupStyle,r),M.getComponentMethod("errorbars","style")(t)}function e(r,t,f){c.pointStyle(r.selectAll("path.point"),t,f)}function a(r,t,f){c.textPointStyle(r.selectAll("text"),t,f)}function n(r,t,f){var o=t[0].trace;o.selectedpoints?(c.selectedPointStyle(f.selectAll("path.point"),o),c.selectedTextStyle(f.selectAll("text"),o)):(e(f,o,r),a(f,o,r))}re.exports={style:T,stylePoints:e,styleText:a,styleOnSelect:n}},{"../../components/drawing":388,"../../registry":638,"@plotly/d3":58}],952:[function(d,re,ne){var w=d("../../lib");re.exports={hasLines:function(c){return c.visible&&c.mode&&c.mode.indexOf("lines")!==-1},hasMarkers:function(c){return c.visible&&(c.mode&&c.mode.indexOf("markers")!==-1||c.type==="splom")},hasText:function(c){return c.visible&&c.mode&&c.mode.indexOf("text")!==-1},isBubble:function(c){return w.isPlainObject(c.marker)&&w.isArrayOrTypedArray(c.marker.size)}}},{"../../lib":503}],953:[function(d,re,ne){var w=d("../../lib");re.exports=function(c,M,T,e,a){a=a||{},e("textposition"),w.coerceFont(e,"textfont",T.font),a.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":503}],954:[function(d,re,ne){var w=d("../../lib"),c=d("../../registry");re.exports=function(T,e,a,n){var r=n("x"),t=n("y"),f,o=c.getComponentMethod("calendars","handleTraceDefaults");if(o(T,e,["x","y"],a),r){var i=w.minRowLength(r);t?f=Math.min(i,w.minRowLength(t)):(f=i,n("y0"),n("dy"))}else{if(!t)return 0;f=w.minRowLength(t),n("x0"),n("dx")}return e._length=f,f}},{"../../lib":503,"../../registry":638}],955:[function(d,re,ne){var w=d("../scatter/attributes"),c=d("../../components/colorscale/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,T=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../../plots/template_attributes").texttemplateAttrs,a=d("../../plots/attributes"),n=d("../../constants/gl3d_dashes"),r=d("../../constants/gl3d_markers"),t=d("../../lib/extend").extendFlat,f=d("../../plot_api/edit_types").overrideAll,o=d("../../lib/sort_object_keys"),i=w.line,g=w.marker,p=g.line,y=t({width:i.width,dash:{valType:"enumerated",values:o(n),dflt:"solid"}},c("line"));function h(u){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var m=re.exports=f({x:w.x,y:w.y,z:{valType:"data_array"},text:t({},w.text,{}),texttemplate:e({},{}),hovertext:t({},w.hovertext,{}),hovertemplate:T(),xhoverformat:M("x"),yhoverformat:M("y"),zhoverformat:M("z"),mode:t({},w.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:h(),y:h(),z:h()},connectgaps:w.connectgaps,line:y,marker:t({symbol:{valType:"enumerated",values:o(r),dflt:"circle",arrayOk:!0},size:t({},g.size,{dflt:8}),sizeref:g.sizeref,sizemin:g.sizemin,sizemode:g.sizemode,opacity:t({},g.opacity,{arrayOk:!1}),colorbar:g.colorbar,line:t({width:t({},p.width,{arrayOk:!1})},c("marker.line"))},c("marker")),textposition:t({},w.textposition,{dflt:"top center"}),textfont:{color:w.textfont.color,size:w.textfont.size,family:t({},w.textfont.family,{arrayOk:!1})},opacity:a.opacity,hoverinfo:t({},a.hoverinfo)},"calc","nested");m.x.editType=m.y.editType=m.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":373,"../../constants/gl3d_dashes":476,"../../constants/gl3d_markers":477,"../../lib/extend":493,"../../lib/sort_object_keys":526,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../scatter/attributes":927}],956:[function(d,re,ne){var w=d("../scatter/arrays_to_calcdata"),c=d("../scatter/colorscale_calc");re.exports=function(T,e){var a=[{x:!1,y:!1,trace:e,t:{}}];return w(a,e),c(T,e),a}},{"../scatter/arrays_to_calcdata":926,"../scatter/colorscale_calc":930}],957:[function(d,re,ne){var w=d("../../registry");function c(e,a,n,r){if(!a||!a.visible)return null;for(var t=w.getComponentMethod("errorbars","makeComputeError")(a),f=new Array(e.length),o=0;o<e.length;o++){var i=t(+e[o],o);if(r.type==="log"){var g=r.c2l(e[o]),p=e[o]-i[0],y=e[o]+i[1];if(f[o]=[(r.c2l(p,!0)-g)*n,(r.c2l(y,!0)-g)*n],p>0){var h=r.c2l(p);r._lowerLogErrorBound||(r._lowerLogErrorBound=h),r._lowerErrorBound=Math.min(r._lowerLogErrorBound,h)}}else f[o]=[-i[0]*n,i[1]*n]}return f}function M(e){for(var a=0;a<e.length;a++)if(e[a])return e[a].length;return 0}function T(e,a,n){var r=[c(e.x,e.error_x,a[0],n.xaxis),c(e.y,e.error_y,a[1],n.yaxis),c(e.z,e.error_z,a[2],n.zaxis)],t=M(r);if(t===0)return null;for(var f=new Array(t),o=0;o<t;o++){for(var i=[[0,0,0],[0,0,0]],g=0;g<3;g++)if(r[g])for(var p=0;p<2;p++)i[p][g]=r[g][o][p];f[o]=i}return f}re.exports=T},{"../../registry":638}],958:[function(d,re,ne){var w=d("../../../stackgl_modules").gl_line3d,c=d("../../../stackgl_modules").gl_scatter3d,M=d("../../../stackgl_modules").gl_error3d,T=d("../../../stackgl_modules").gl_mesh3d,e=d("../../../stackgl_modules").delaunay_triangulate,a=d("../../lib"),n=d("../../lib/str2rgbarray"),r=d("../../lib/gl_format_color").formatColor,t=d("../scatter/make_bubble_size_func"),f=d("../../constants/gl3d_dashes"),o=d("../../constants/gl3d_markers"),i=d("../../plots/cartesian/axes"),g=d("../../components/fx/helpers").appendArrayPointValue,p=d("./calc_errors");function y(P,z){this.scene=P,this.uid=z,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var h=y.prototype;h.handlePick=function(P){if(P.object&&(P.object===this.linePlot||P.object===this.delaunayMesh||P.object===this.textMarkers||P.object===this.scatterPlot)){var z=P.index=P.data.index;return P.object.highlight&&P.object.highlight(null),this.scatterPlot&&(P.object=this.scatterPlot,this.scatterPlot.highlight(P.data)),P.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[z]||this.textLabels[z]===0)&&(P.textLabel=this.textLabels[z]):P.textLabel=this.textLabels),P.traceCoordinate=[this.data.x[z],this.data.y[z],this.data.z[z]],!0}};function m(P,z,I){var D=(I+1)%3,R=(I+2)%3,B=[],F=[],V;for(V=0;V<P.length;++V){var G=P[V];isNaN(G[D])||!isFinite(G[D])||isNaN(G[R])||!isFinite(G[R])||(B.push([G[D],G[R]]),F.push(V))}var J=e(B);for(V=0;V<J.length;++V)for(var j=J[V],Y=0;Y<j.length;++Y)j[Y]=F[j[Y]];return{positions:P,cells:J,meshColor:z}}function u(P){for(var z=[0,0,0],I=[[0,0,0],[0,0,0],[0,0,0]],D=[1,1,1],R=0;R<3;R++){var B=P[R];B&&B.copy_zstyle!==!1&&P[2].visible!==!1&&(B=P[2]),!(!B||!B.visible)&&(z[R]=B.width/2,I[R]=n(B.color),D[R]=B.thickness)}return{capSize:z,color:I,lineWidth:D}}function _(P){return P==null?0:P.indexOf("left")>-1?-1:P.indexOf("right")>-1?1:0}function s(P){return P==null?0:P.indexOf("top")>-1?-1:P.indexOf("bottom")>-1?1:0}function A(P){var z=0,I=0,D=[z,I];if(Array.isArray(P))for(var R=0;R<P.length;R++)D[R]=[z,I],P[R]&&(D[R][0]=_(P[R]),D[R][1]=s(P[R]));else D[0]=_(P),D[1]=s(P);return D}function x(P,z){return z(P*4)}function v(P){return o[P]}function b(P,z,I,D,R){var B=null;if(a.isArrayOrTypedArray(P)){B=[];for(var F=0;F<z;F++)P[F]===void 0?B[F]=D:B[F]=I(P[F],R)}else B=I(P,a.identity);return B}function l(P,z){var I=[],D=P.fullSceneLayout,R=P.dataScale,B=D.xaxis,F=D.yaxis,V=D.zaxis,G=z.marker,J=z.line,j=z.x||[],Y=z.y||[],X=z.z||[],oe=j.length,se=z.xcalendar,ie=z.ycalendar,N=z.zcalendar,U,q,Q,W,Z,ee;for(Z=0;Z<oe;Z++)U=B.d2l(j[Z],0,se)*R[0],q=F.d2l(Y[Z],0,ie)*R[1],Q=V.d2l(X[Z],0,N)*R[2],I[Z]=[U,q,Q];if(Array.isArray(z.text))ee=z.text;else if(z.text!==void 0)for(ee=new Array(oe),Z=0;Z<oe;Z++)ee[Z]=z.text;function te(Je,Oe){var Pe=D[Je];return i.tickText(Pe,Pe.d2l(Oe),!0).text}var ae=z.texttemplate;if(ae){var le=P.fullLayout,ye=le._d3locale,fe=Array.isArray(ae),pe=fe?Math.min(ae.length,oe):oe,ge=fe?function(Je){return ae[Je]}:function(){return ae};for(ee=new Array(pe),Z=0;Z<pe;Z++){var Ae={x:j[Z],y:Y[Z],z:X[Z]},we={xLabel:te("xaxis",j[Z]),yLabel:te("yaxis",Y[Z]),zLabel:te("zaxis",X[Z])},De={};g(De,z,Z);var Be=z._meta||{};ee[Z]=a.texttemplateString(ge(Z),we,ye,De,Ae,Be)}}if(W={position:I,mode:z.mode,text:ee},"line"in z&&(W.lineColor=r(J,1,oe),W.lineWidth=J.width,W.lineDashes=J.dash),"marker"in z){var Ve=t(z);W.scatterColor=r(G,1,oe),W.scatterSize=b(G.size,oe,x,20,Ve),W.scatterMarker=b(G.symbol,oe,v,"\u25CF"),W.scatterLineWidth=G.line.width,W.scatterLineColor=r(G.line,1,oe),W.scatterAngle=0}"textposition"in z&&(W.textOffset=A(z.textposition),W.textColor=r(z.textfont,1,oe),W.textSize=b(z.textfont.size,oe,a.identity,12),W.textFont=z.textfont.family,W.textAngle=0);var xe=["x","y","z"];for(W.project=[!1,!1,!1],W.projectScale=[1,1,1],W.projectOpacity=[1,1,1],Z=0;Z<3;++Z){var Le=z.projection[xe[Z]];(W.project[Z]=Le.show)&&(W.projectOpacity[Z]=Le.opacity,W.projectScale[Z]=Le.scale)}W.errorBounds=p(z,R,D);var He=u([z.error_x,z.error_y,z.error_z]);return W.errorColor=He.color,W.errorLineWidth=He.lineWidth,W.errorCapSize=He.capSize,W.delaunayAxis=z.surfaceaxis,W.delaunayColor=n(z.surfacecolor),W}function L(P){if(a.isArrayOrTypedArray(P)){var z=P[0];return a.isArrayOrTypedArray(z)&&(P=z),"rgb("+P.slice(0,3).map(function(I){return Math.round(I*255)})+")"}return null}function S(P){return a.isArrayOrTypedArray(P)?P.length===4&&typeof P[0]=="number"?L(P):P.map(L):null}h.update=function(P){var z=this.scene.glplot.gl,I,D,R,B,F=f.solid;this.data=P;var V=l(this.scene,P);"mode"in V&&(this.mode=V.mode),"lineDashes"in V&&V.lineDashes in f&&(F=f[V.lineDashes]),this.color=S(V.scatterColor)||S(V.lineColor),this.dataPoints=V.position,I={gl:this.scene.glplot.gl,position:V.position,color:V.lineColor,lineWidth:V.lineWidth||1,dashes:F[0],dashScale:F[1],opacity:P.opacity,connectGaps:P.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(I):(this.linePlot=w(I),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var G=P.opacity;if(P.marker&&P.marker.opacity&&(G*=P.marker.opacity),D={gl:this.scene.glplot.gl,position:V.position,color:V.scatterColor,size:V.scatterSize,glyph:V.scatterMarker,opacity:G,orthographic:!0,lineWidth:V.scatterLineWidth,lineColor:V.scatterLineColor,project:V.project,projectScale:V.projectScale,projectOpacity:V.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(D):(this.scatterPlot=c(D),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),B={gl:this.scene.glplot.gl,position:V.position,glyph:V.text,color:V.textColor,size:V.textSize,angle:V.textAngle,alignment:V.textOffset,font:V.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:P.opacity},this.textLabels=P.hovertext||P.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(B):(this.textMarkers=c(B),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),R={gl:this.scene.glplot.gl,position:V.position,color:V.errorColor,error:V.errorBounds,lineWidth:V.errorLineWidth,capSize:V.errorCapSize,opacity:P.opacity},this.errorBars?V.errorBounds?this.errorBars.update(R):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):V.errorBounds&&(this.errorBars=M(R),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),V.delaunayAxis>=0){var J=m(V.position,V.delaunayColor,V.delaunayAxis);J.opacity=P.opacity,this.delaunayMesh?this.delaunayMesh.update(J):(J.gl=z,this.delaunayMesh=T(J),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},h.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())};function k(P,z){var I=new y(P,z.uid);return I.update(z),I}re.exports=k},{"../../../stackgl_modules":1124,"../../components/fx/helpers":402,"../../constants/gl3d_dashes":476,"../../constants/gl3d_markers":477,"../../lib":503,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/cartesian/axes":554,"../scatter/make_bubble_size_func":944,"./calc_errors":957}],959:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib"),M=d("../scatter/subtypes"),T=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/text_defaults"),n=d("./attributes");re.exports=function(f,o,i,g){function p(x,v){return c.coerce(f,o,n,x,v)}var y=r(f,o,p,g);if(!y){o.visible=!1;return}p("text"),p("hovertext"),p("hovertemplate"),p("xhoverformat"),p("yhoverformat"),p("zhoverformat"),p("mode"),M.hasLines(o)&&(p("connectgaps"),e(f,o,i,g,p)),M.hasMarkers(o)&&T(f,o,i,g,p,{noSelect:!0}),M.hasText(o)&&(p("texttemplate"),a(f,o,g,p,{noSelect:!0}));var h=(o.line||{}).color,m=(o.marker||{}).color;p("surfaceaxis")>=0&&p("surfacecolor",h||m);for(var u=["x","y","z"],_=0;_<3;++_){var s="projection."+u[_];p(s+".show")&&(p(s+".opacity"),p(s+".scale"))}var A=w.getComponentMethod("errorbars","supplyDefaults");A(f,o,h||m||i,{axis:"z"}),A(f,o,h||m||i,{axis:"y",inherit:"z"}),A(f,o,h||m||i,{axis:"x",inherit:"z"})};function r(t,f,o,i){var g=0,p=o("x"),y=o("y"),h=o("z"),m=w.getComponentMethod("calendars","handleTraceDefaults");return m(t,f,["x","y","z"],i),p&&y&&h&&(g=Math.min(p.length,y.length,h.length),f._length=f._xlength=f._ylength=f._zlength=g),g}},{"../../lib":503,"../../registry":638,"../scatter/line_defaults":940,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":955}],960:[function(d,re,ne){re.exports={plot:d("./convert"),attributes:d("./attributes"),markerSymbols:d("../../constants/gl3d_markers"),supplyDefaults:d("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:d("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":477,"../../plots/gl3d":598,"./attributes":955,"./calc":956,"./convert":958,"./defaults":959}],961:[function(d,re,ne){var w=d("../scatter/attributes"),c=d("../../plots/attributes"),M=d("../../plots/template_attributes").hovertemplateAttrs,T=d("../../plots/template_attributes").texttemplateAttrs,e=d("../../components/colorscale/attributes"),a=d("../../lib/extend").extendFlat,n=w.marker,r=w.line,t=n.line;re.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:a({},w.mode,{dflt:"markers"}),text:a({},w.text,{}),texttemplate:T({editType:"plot"},{keys:["a","b","text"]}),hovertext:a({},w.hovertext,{}),line:{color:r.color,width:r.width,dash:r.dash,shape:a({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:w.connectgaps,fill:a({},w.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:w.fillcolor,marker:a({symbol:n.symbol,opacity:n.opacity,maxdisplayed:n.maxdisplayed,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,line:a({width:t.width,editType:"calc"},e("marker.line")),gradient:n.gradient,editType:"calc"},e("marker")),textfont:w.textfont,textposition:w.textposition,selected:w.selected,unselected:w.unselected,hoverinfo:a({},c.hoverinfo,{flags:["a","b","text","name"]}),hoveron:w.hoveron,hovertemplate:M()}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":927}],962:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../scatter/colorscale_calc"),M=d("../scatter/arrays_to_calcdata"),T=d("../scatter/calc_selection"),e=d("../scatter/calc").calcMarkerSize,a=d("../carpet/lookup_carpetid");re.exports=function(r,t){var f=t._carpetTrace=a(r,t);if(!(!f||!f.visible||f.visible==="legendonly")){var o;t.xaxis=f.xaxis,t.yaxis=f.yaxis;var i=t._length,g=new Array(i),p,y,h=!1;for(o=0;o<i;o++)if(p=t.a[o],y=t.b[o],w(p)&&w(y)){var m=f.ab2xy(+p,+y,!0),u=f.isVisible(+p,+y);u||(h=!0),g[o]={x:m[0],y:m[1],a:p,b:y,vis:u}}else g[o]={x:!1,y:!1};return t._needsCull=h,g[0].carpet=f,g[0].trace=t,e(t,i),c(r,t),M(g,t),T(g,t),g}}},{"../carpet/lookup_carpetid":708,"../scatter/arrays_to_calcdata":926,"../scatter/calc":928,"../scatter/calc_selection":929,"../scatter/colorscale_calc":930,"fast-isnumeric":190}],963:[function(d,re,ne){var w=d("../../lib"),c=d("../scatter/constants"),M=d("../scatter/subtypes"),T=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/line_shape_defaults"),n=d("../scatter/text_defaults"),r=d("../scatter/fillcolor_defaults"),t=d("./attributes");re.exports=function(o,i,g,p){function y(x,v){return w.coerce(o,i,t,x,v)}y("carpet"),i.xaxis="x",i.yaxis="y";var h=y("a"),m=y("b"),u=Math.min(h.length,m.length);if(!u){i.visible=!1;return}i._length=u,y("text"),y("texttemplate"),y("hovertext");var _=u<c.PTS_LINESONLY?"lines+markers":"lines";y("mode",_),M.hasLines(i)&&(e(o,i,g,p,y),a(o,i,y),y("connectgaps")),M.hasMarkers(i)&&T(o,i,g,p,y,{gradient:!0}),M.hasText(i)&&n(o,i,p,y);var s=[];(M.hasMarkers(i)||M.hasText(i))&&(y("marker.maxdisplayed"),s.push("points")),y("fill"),i.fill!=="none"&&(r(o,i,g,y),M.hasLines(i)||a(o,i,y)),(i.fill==="tonext"||i.fill==="toself")&&s.push("fills");var A=y("hoveron",s.join("+")||"points");A!=="fills"&&y("hovertemplate"),w.coerceSelectionMarkerOpacity(i,y)}},{"../../lib":503,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/line_shape_defaults":942,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":961}],964:[function(d,re,ne){re.exports=function(c,M,T,e,a){var n=e[a];return c.a=n.a,c.b=n.b,c.y=n.y,c}},{}],965:[function(d,re,ne){re.exports=function(c,M){var T={},e=M._carpet,a=e.ab2ij([c.a,c.b]),n=Math.floor(a[0]),r=a[0]-n,t=Math.floor(a[1]),f=a[1]-t,o=e.evalxy([],n,t,r,f);return T.yLabel=o[1].toFixed(3),T}},{}],966:[function(d,re,ne){var w=d("../scatter/hover"),c=d("../../lib").fillText;re.exports=function(T,e,a,n){var r=w(T,e,a,n);if(!r||r[0].index===!1)return;var t=r[0];if(t.index===void 0){var f=1-t.y0/T.ya._length,o=T.xa._length,i=o*f/2,g=o-i;return t.x0=Math.max(Math.min(t.x0,g),i),t.x1=Math.max(Math.min(t.x1,g),i),r}var p=t.cd[t.index];t.a=p.a,t.b=p.b,t.xLabelVal=void 0,t.yLabelVal=void 0;var y=t.trace,h=y._carpet,m=y._module.formatLabels(p,y);t.yLabel=m.yLabel,delete t.text;var u=[];function _(x,v){var b;x.labelprefix&&x.labelprefix.length>0?b=x.labelprefix.replace(/ = $/,""):b=x._hovertitle,u.push(b+": "+v.toFixed(3)+x.labelsuffix)}if(!y.hovertemplate){var s=p.hi||y.hoverinfo,A=s.split("+");A.indexOf("all")!==-1&&(A=["a","b","text"]),A.indexOf("a")!==-1&&_(h.aaxis,p.a),A.indexOf("b")!==-1&&_(h.baxis,p.b),u.push("y: "+t.yLabel),A.indexOf("text")!==-1&&c(p,y,u),t.extraText=u.join("<br>")}return r}},{"../../lib":503,"../scatter/hover":938}],967:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../scatter/select"),eventData:d("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:d("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../scatter/marker_colorbar":945,"../scatter/select":949,"../scatter/style":951,"./attributes":961,"./calc":962,"./defaults":963,"./event_data":964,"./format_labels":965,"./hover":966,"./plot":968}],968:[function(d,re,ne){var w=d("../scatter/plot"),c=d("../../plots/cartesian/axes"),M=d("../../components/drawing");re.exports=function(e,a,n,r){var t,f,o,i=n[0][0].carpet,g={xaxis:c.getFromId(e,i.xaxis||"x"),yaxis:c.getFromId(e,i.yaxis||"y"),plot:a.plot};for(w(e,g,n,r),t=0;t<n.length;t++)f=n[t][0].trace,o=r.selectAll("g.trace"+f.uid+" .js-line"),M.setClipUrl(o,n[t][0].carpet._clipPathId,e)}},{"../../components/drawing":388,"../../plots/cartesian/axes":554,"../scatter/plot":948}],969:[function(d,re,ne){var w=d("../../plots/template_attributes").hovertemplateAttrs,c=d("../../plots/template_attributes").texttemplateAttrs,M=d("../scatter/attributes"),T=d("../../plots/attributes"),e=d("../../components/colorscale/attributes"),a=d("../../components/drawing/attributes").dash,n=d("../../lib/extend").extendFlat,r=d("../../plot_api/edit_types").overrideAll,t=M.marker,f=M.line,o=t.line;re.exports=r({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:n({},M.mode,{dflt:"markers"}),text:n({},M.text,{}),texttemplate:c({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:n({},M.hovertext,{}),textfont:M.textfont,textposition:M.textposition,line:{color:f.color,width:f.width,dash:a},connectgaps:M.connectgaps,marker:n({symbol:t.symbol,opacity:t.opacity,size:t.size,sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,colorbar:t.colorbar,line:n({width:o.width},e("marker.line")),gradient:t.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:M.fillcolor,selected:M.selected,unselected:M.unselected,hoverinfo:n({},T.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:w()},"calc","nested")},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":927}],970:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../constants/numerical").BADNUM,M=d("../scatter/colorscale_calc"),T=d("../scatter/arrays_to_calcdata"),e=d("../scatter/calc_selection"),a=d("../../lib")._;function n(r){return r&&typeof r=="string"}re.exports=function(t,f){var o=Array.isArray(f.locations),i=o?f.locations.length:f._length,g=new Array(i),p;f.geojson?p=function(s){return n(s)||w(s)}:p=n;for(var y=0;y<i;y++){var h=g[y]={};if(o){var m=f.locations[y];h.loc=p(m)?m:null}else{var u=f.lon[y],_=f.lat[y];w(u)&&w(_)?h.lonlat=[+u,+_]:h.lonlat=[c,c]}}return T(g,f),M(t,f),e(g,f),i&&(g[0].t={labels:{lat:a(t,"lat:")+" ",lon:a(t,"lon:")+" "}}),g}},{"../../constants/numerical":479,"../../lib":503,"../scatter/arrays_to_calcdata":926,"../scatter/calc_selection":929,"../scatter/colorscale_calc":930,"fast-isnumeric":190}],971:[function(d,re,ne){var w=d("../../lib"),c=d("../scatter/subtypes"),M=d("../scatter/marker_defaults"),T=d("../scatter/line_defaults"),e=d("../scatter/text_defaults"),a=d("../scatter/fillcolor_defaults"),n=d("./attributes");re.exports=function(t,f,o,i){function g(A,x){return w.coerce(t,f,n,A,x)}var p=g("locations"),y;if(p&&p.length){var h=g("geojson"),m;(typeof h=="string"&&h!==""||w.isPlainObject(h))&&(m="geojson-id");var u=g("locationmode",m);u==="geojson-id"&&g("featureidkey"),y=p.length}else{var _=g("lon")||[],s=g("lat")||[];y=Math.min(_.length,s.length)}if(!y){f.visible=!1;return}f._length=y,g("text"),g("hovertext"),g("hovertemplate"),g("mode"),c.hasLines(f)&&(T(t,f,o,i,g),g("connectgaps")),c.hasMarkers(f)&&M(t,f,o,i,g,{gradient:!0}),c.hasText(f)&&(g("texttemplate"),e(t,f,i,g)),g("fill"),f.fill!=="none"&&a(t,f,o,g),w.coerceSelectionMarkerOpacity(f,g)}},{"../../lib":503,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":969}],972:[function(d,re,ne){re.exports=function(c,M,T,e,a){c.lon=M.lon,c.lat=M.lat,c.location=M.loc?M.loc:null;var n=e[a];return n.fIn&&n.fIn.properties&&(c.properties=n.fIn.properties),c}},{}],973:[function(d,re,ne){var w=d("../../plots/cartesian/axes");re.exports=function(M,T,e){var a={},n=e[T.geo]._subplot,r=n.mockAxis,t=M.lonlat;return a.lonLabel=w.tickText(r,r.c2l(t[0]),!0).text,a.latLabel=w.tickText(r,r.c2l(t[1]),!0).text,a}},{"../../plots/cartesian/axes":554}],974:[function(d,re,ne){var w=d("../../components/fx"),c=d("../../constants/numerical").BADNUM,M=d("../scatter/get_trace_color"),T=d("../../lib").fillText,e=d("./attributes");re.exports=function(r,t,f){var o=r.cd,i=o[0].trace,g=r.xa,p=r.ya,y=r.subplot,h=y.projection.isLonLatOverEdges,m=y.project;function u(l){var L=l.lonlat;if(L[0]===c||h(L))return 1/0;var S=m(L),k=m([t,f]),P=Math.abs(S[0]-k[0]),z=Math.abs(S[1]-k[1]),I=Math.max(3,l.mrc||0);return Math.max(Math.sqrt(P*P+z*z)-I,1-3/I)}if(w.getClosest(o,u,r),r.index!==!1){var _=o[r.index],s=_.lonlat,A=[g.c2p(s),p.c2p(s)],x=_.mrc||1;r.x0=A[0]-x,r.x1=A[0]+x,r.y0=A[1]-x,r.y1=A[1]+x,r.loc=_.loc,r.lon=s[0],r.lat=s[1];var v={};v[i.geo]={_subplot:y};var b=i._module.formatLabels(_,i,v);return r.lonLabel=b.lonLabel,r.latLabel=b.latLabel,r.color=M(i,_),r.extraText=a(i,_,r,o[0].t.labels),r.hovertemplate=i.hovertemplate,[r]}};function a(n,r,t,f){if(n.hovertemplate)return;var o=r.hi||n.hoverinfo,i=o==="all"?e.hoverinfo.flags:o.split("+"),g=i.indexOf("location")!==-1&&Array.isArray(n.locations),p=i.indexOf("lon")!==-1,y=i.indexOf("lat")!==-1,h=i.indexOf("text")!==-1,m=[];function u(_){return _+"\xB0"}return g?m.push(r.loc):p&&y?m.push("("+u(t.latLabel)+", "+u(t.lonLabel)+")"):p?m.push(f.lon+u(t.lonLabel)):y&&m.push(f.lat+u(t.latLabel)),h&&T(r,n,m),m.join("<br>")}},{"../../components/fx":406,"../../constants/numerical":479,"../../lib":503,"../scatter/get_trace_color":937,"./attributes":969}],975:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),calcGeoJSON:d("./plot").calcGeoJSON,plot:d("./plot").plot,style:d("./style"),styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:d("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":589,"../scatter/marker_colorbar":945,"../scatter/style":951,"./attributes":969,"./calc":970,"./defaults":971,"./event_data":972,"./format_labels":973,"./hover":974,"./plot":976,"./select":977,"./style":978}],976:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../lib/topojson_utils").getTopojsonFeatures,T=d("../../lib/geojson_utils"),e=d("../../lib/geo_location_utils"),a=d("../../plots/cartesian/autorange").findExtremes,n=d("../../constants/numerical").BADNUM,r=d("../scatter/calc").calcMarkerSize,t=d("../scatter/subtypes"),f=d("./style");function o(g,p,y){var h=p.layers.frontplot.select(".scatterlayer"),m=c.makeTraceGroups(h,y,"trace scattergeo");function u(_,s){_.lonlat[0]===n&&w.select(s).remove()}m.selectAll("*").remove(),m.each(function(_){var s=w.select(this),A=_[0].trace;if(t.hasLines(A)||A.fill!=="none"){var x=T.calcTraceToLineCoords(_),v=A.fill!=="none"?T.makePolygon(x):T.makeLine(x);s.selectAll("path.js-line").data([{geojson:v,trace:A}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}t.hasMarkers(A)&&s.selectAll("path.point").data(c.identity).enter().append("path").classed("point",!0).each(function(b){u(b,this)}),t.hasText(A)&&s.selectAll("g").data(c.identity).enter().append("g").append("text").each(function(b){u(b,this)}),f(g,_)})}function i(g,p){var y=g[0].trace,h=p[y.geo],m=h._subplot,u=y._length,_,s;if(Array.isArray(y.locations)){var A=y.locationmode,x=A==="geojson-id"?e.extractTraceFeature(g):M(y,m.topojson);for(_=0;_<u;_++){s=g[_];var v=A==="geojson-id"?s.fOut:e.locationToFeature(A,s.loc,x);s.lonlat=v?v.properties.ct:[n,n]}}var b={padded:!0},l,L;if(h.fitbounds==="geojson"&&y.locationmode==="geojson-id"){var S=e.computeBbox(e.getTraceGeojson(y));l=[S[0],S[2]],L=[S[1],S[3]]}else{for(l=new Array(u),L=new Array(u),_=0;_<u;_++)s=g[_],l[_]=s.lonlat[0],L[_]=s.lonlat[1];b.ppad=r(y,u)}y._extremes.lon=a(h.lonaxis._ax,l,b),y._extremes.lat=a(h.lataxis._ax,L,b)}re.exports={calcGeoJSON:i,plot:o}},{"../../constants/numerical":479,"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/geojson_utils":497,"../../lib/topojson_utils":532,"../../plots/cartesian/autorange":553,"../scatter/calc":928,"../scatter/subtypes":952,"./style":978,"@plotly/d3":58}],977:[function(d,re,ne){var w=d("../scatter/subtypes"),c=d("../../constants/numerical").BADNUM;re.exports=function(T,e){var a=T.cd,n=T.xaxis,r=T.yaxis,t=[],f=a[0].trace,o,i,g,p,y,h=!w.hasMarkers(f)&&!w.hasText(f);if(h)return[];if(e===!1)for(y=0;y<a.length;y++)a[y].selected=0;else for(y=0;y<a.length;y++)o=a[y],i=o.lonlat,i[0]!==c&&(g=n.c2p(i),p=r.c2p(i),e.contains([g,p],null,y,T)?(t.push({pointNumber:y,lon:i[0],lat:i[1]}),o.selected=1):o.selected=0);return t}},{"../../constants/numerical":479,"../scatter/subtypes":952}],978:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/drawing"),M=d("../../components/color"),T=d("../scatter/style"),e=T.stylePoints,a=T.styleText;re.exports=function(t,f){f&&n(t,f)};function n(r,t){var f=t[0].trace,o=t[0].node3;o.style("opacity",t[0].trace.opacity),e(o,f,r),a(o,f,r),o.selectAll("path.js-line").style("fill","none").each(function(i){var g=w.select(this),p=i.trace,y=p.line||{};g.call(M.stroke,y.color).call(c.dashLine,y.dash||"",y.width||0),p.fill!=="none"&&g.call(M.fill,p.fillcolor)})}},{"../../components/color":366,"../../components/drawing":388,"../scatter/style":951,"@plotly/d3":58}],979:[function(d,re,ne){var w=d("../../plots/attributes"),c=d("../scatter/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,T=d("../../components/colorscale/attributes"),e=d("../../lib/sort_object_keys"),a=d("../../lib/extend").extendFlat,n=d("../../plot_api/edit_types").overrideAll,r=d("./constants").DASHES,t=c.line,f=c.marker,o=f.line,i=re.exports=n({x:c.x,x0:c.x0,dx:c.dx,y:c.y,y0:c.y0,dy:c.dy,xperiod:c.xperiod,yperiod:c.yperiod,xperiod0:c.xperiod0,yperiod0:c.yperiod0,xperiodalignment:c.xperiodalignment,yperiodalignment:c.yperiodalignment,xhoverformat:M("x"),yhoverformat:M("y"),text:c.text,hovertext:c.hovertext,textposition:c.textposition,textfont:c.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:t.color,width:t.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(r),dflt:"solid"}},marker:a({},T("marker"),{symbol:f.symbol,size:f.size,sizeref:f.sizeref,sizemin:f.sizemin,sizemode:f.sizemode,opacity:f.opacity,colorbar:f.colorbar,line:a({},T("marker.line"),{width:o.width})}),connectgaps:c.connectgaps,fill:a({},c.fill,{dflt:"none"}),fillcolor:c.fillcolor,selected:{marker:c.selected.marker,textfont:c.selected.textfont},unselected:{marker:c.unselected.marker,textfont:c.unselected.textfont},opacity:w.opacity},"calc","nested");i.x.editType=i.y.editType=i.x0.editType=i.y0.editType="calc+clearAxisTypes",i.hovertemplate=c.hovertemplate,i.texttemplate=c.texttemplate},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../lib/sort_object_keys":526,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../scatter/attributes":927,"./constants":982}],980:[function(d,re,ne){var w=d("./hover");re.exports={moduleType:"trace",name:"scattergl",basePlotModule:d("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../scatter/cross_trace_defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),hoverPoints:w.hoverPoints,selectPoints:d("./select"),meta:{}}},{"../../plots/cartesian":568,"../scatter/cross_trace_defaults":933,"../scatter/marker_colorbar":945,"./attributes":979,"./calc":981,"./defaults":984,"./format_labels":986,"./hover":988,"./select":992}],981:[function(d,re,ne){var w=d("@plotly/point-cluster"),c=d("../../lib"),M=d("../../plots/cartesian/axis_ids"),T=d("../../plots/cartesian/autorange").findExtremes,e=d("../../plots/cartesian/align_period"),a=d("../scatter/calc"),n=a.calcMarkerSize,r=a.calcAxisExpansion,t=a.setFirstScatter,f=d("../scatter/colorscale_calc"),o=d("./convert"),i=d("./scene_update"),g=d("../../constants/numerical").BADNUM,p=d("./constants").TOO_MANY_POINTS;re.exports=function(u,_){var s=u._fullLayout,A=M.getFromId(u,_.xaxis),x=M.getFromId(u,_.yaxis),v=s._plots[_.xaxis+_.yaxis],b=_._length,l=b>=p,L=b*2,S={},k,P=A.makeCalcdata(_,"x"),z=x.makeCalcdata(_,"y"),I=e(_,A,"x",P),D=e(_,x,"y",z),R=I.vals,B=D.vals;_._x=R,_._y=B,_.xperiodalignment&&(_._origX=P,_._xStarts=I.starts,_._xEnds=I.ends),_.yperiodalignment&&(_._origY=z,_._yStarts=D.starts,_._yEnds=D.ends);var F=new Array(L),V=new Array(b);for(k=0;k<b;k++)F[k*2]=R[k]===g?NaN:R[k],F[k*2+1]=B[k]===g?NaN:B[k],V[k]=k;if(A.type==="log")for(k=0;k<L;k+=2)F[k]=A.c2l(F[k]);if(x.type==="log")for(k=1;k<L;k+=2)F[k]=x.c2l(F[k]);l&&A.type!=="log"&&x.type!=="log"?S.tree=w(F):S.ids=V,f(u,_);var G=h(u,v,_,F,R,B),J=i(u,v);t(s,_);var j;return l?G.marker&&(j=G.marker.sizeAvg||Math.max(G.marker.size,3)):j=n(_,b),r(u,_,A,x,R,B,j),G.errorX&&y(_,A,G.errorX),G.errorY&&y(_,x,G.errorY),G.fill&&!J.fill2d&&(J.fill2d=!0),G.marker&&!J.scatter2d&&(J.scatter2d=!0),G.line&&!J.line2d&&(J.line2d=!0),(G.errorX||G.errorY)&&!J.error2d&&(J.error2d=!0),G.text&&!J.glText&&(J.glText=!0),G.marker&&(G.marker.snap=b),J.lineOptions.push(G.line),J.errorXOptions.push(G.errorX),J.errorYOptions.push(G.errorY),J.fillOptions.push(G.fill),J.markerOptions.push(G.marker),J.markerSelectedOptions.push(G.markerSel),J.markerUnselectedOptions.push(G.markerUnsel),J.textOptions.push(G.text),J.textSelectedOptions.push(G.textSel),J.textUnselectedOptions.push(G.textUnsel),J.selectBatch.push([]),J.unselectBatch.push([]),S._scene=J,S.index=J.count,S.x=R,S.y=B,S.positions=F,J.count++,[{x:!1,y:!1,t:S,trace:_}]};function y(m,u,_){var s=m._extremes[u._id],A=T(u,_._bnds,{padded:!0});s.min=s.min.concat(A.min),s.max=s.max.concat(A.max)}function h(m,u,_,s,A,x){var v=o.style(m,_);if(v.marker&&(v.marker.positions=s),v.line&&s.length>1&&c.extendFlat(v.line,o.linePositions(m,_,s)),v.errorX||v.errorY){var b=o.errorBarPositions(m,_,s,A,x);v.errorX&&c.extendFlat(v.errorX,b.x),v.errorY&&c.extendFlat(v.errorY,b.y)}return v.text&&(c.extendFlat(v.text,{positions:s},o.textPosition(m,_,v.text,v.marker)),c.extendFlat(v.textSel,{positions:s},o.textPosition(m,_,v.text,v.markerSel)),c.extendFlat(v.textUnsel,{positions:s},o.textPosition(m,_,v.text,v.markerUnsel))),v}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/autorange":553,"../../plots/cartesian/axis_ids":558,"../scatter/calc":928,"../scatter/colorscale_calc":930,"./constants":982,"./convert":983,"./scene_update":991,"@plotly/point-cluster":59}],982:[function(d,re,ne){var w=20;re.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:w,SYMBOL_STROKE:w/20,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],983:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("svg-path-sdf"),M=d("color-normalize"),T=d("../../registry"),e=d("../../lib"),a=d("../../components/drawing"),n=d("../../plots/cartesian/axis_ids"),r=d("../../lib/gl_format_color").formatColor,t=d("../scatter/subtypes"),f=d("../scatter/make_bubble_size_func"),o=d("./helpers"),i=d("./constants"),g=d("../../constants/interactions").DESELECTDIM,p={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},y=d("../../components/fx/helpers").appendArrayPointValue;function h(I,D){var R,B={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},F=I._context.plotGlPixelRatio;if(D.visible!==!0)return B;if(t.hasText(D)&&(B.text=m(I,D),B.textSel=s(I,D,D.selected),B.textUnsel=s(I,D,D.unselected)),t.hasMarkers(D)&&(B.marker=u(D),B.markerSel=_(D,D.selected),B.markerUnsel=_(D,D.unselected),!D.unselected&&e.isArrayOrTypedArray(D.marker.opacity))){var V=D.marker.opacity;for(B.markerUnsel.opacity=new Array(V.length),R=0;R<V.length;R++)B.markerUnsel.opacity[R]=g*V[R]}if(t.hasLines(D)){B.line={overlay:!0,thickness:D.line.width*F,color:D.line.color,opacity:D.opacity};var G=(i.DASHES[D.line.dash]||[1]).slice();for(R=0;R<G.length;++R)G[R]*=D.line.width*F;B.line.dashes=G}return D.error_x&&D.error_x.visible&&(B.errorX=A(D,D.error_x,F)),D.error_y&&D.error_y.visible&&(B.errorY=A(D,D.error_y,F)),!!D.fill&&D.fill!=="none"&&(B.fill={closed:!0,fill:D.fillcolor,thickness:0}),B}function m(I,D){var R=I._fullLayout,B=D._length,F=D.textfont,V=D.textposition,G=Array.isArray(V)?V:[V],J=F.color,j=F.size,Y=F.family,X={},oe,se=I._context.plotGlPixelRatio,ie=D.texttemplate;if(ie){X.text=[];var N=R._d3locale,U=Array.isArray(ie),q=U?Math.min(ie.length,B):B,Q=U?function(ye){return ie[ye]}:function(){return ie};for(oe=0;oe<q;oe++){var W={i:oe},Z=D._module.formatLabels(W,D,R),ee={};y(ee,D,oe);var te=D._meta||{};X.text.push(e.texttemplateString(Q(oe),Z,N,ee,W,te))}}else Array.isArray(D.text)&&D.text.length<B?X.text=D.text.slice():X.text=D.text;if(Array.isArray(X.text))for(oe=X.text.length;oe<B;oe++)X.text[oe]="";for(X.opacity=D.opacity,X.font={},X.align=[],X.baseline=[],oe=0;oe<G.length;oe++){var ae=G[oe].split(/\s+/);switch(ae[1]){case"left":X.align.push("right");break;case"right":X.align.push("left");break;default:X.align.push(ae[1])}switch(ae[0]){case"top":X.baseline.push("bottom");break;case"bottom":X.baseline.push("top");break;default:X.baseline.push(ae[0])}}if(Array.isArray(J))for(X.color=new Array(B),oe=0;oe<B;oe++)X.color[oe]=J[oe];else X.color=J;if(e.isArrayOrTypedArray(j)||Array.isArray(Y))for(X.font=new Array(B),oe=0;oe<B;oe++){var le=X.font[oe]={};le.size=(e.isTypedArray(j)?j[oe]:Array.isArray(j)?w(j[oe])?j[oe]:0:j)*se,le.family=Array.isArray(Y)?Y[oe]:Y}else X.font={size:j*se,family:Y};return X}function u(I){var D=I._length,R=I.marker,B={},F,V=e.isArrayOrTypedArray(R.symbol),G=e.isArrayOrTypedArray(R.color),J=e.isArrayOrTypedArray(R.line.color),j=e.isArrayOrTypedArray(R.opacity),Y=e.isArrayOrTypedArray(R.size),X=e.isArrayOrTypedArray(R.line.width),oe;if(V||(oe=o.isOpenSymbol(R.symbol)),V||G||J||j){B.colors=new Array(D),B.borderColors=new Array(D);var se=r(R,R.opacity,D),ie=r(R.line,R.opacity,D);if(!Array.isArray(ie[0])){var N=ie;for(ie=Array(D),F=0;F<D;F++)ie[F]=N}if(!Array.isArray(se[0])){var U=se;for(se=Array(D),F=0;F<D;F++)se[F]=U}for(B.colors=se,B.borderColors=ie,F=0;F<D;F++){if(V){var q=R.symbol[F];oe=o.isOpenSymbol(q)}oe&&(ie[F]=se[F].slice(),se[F]=se[F].slice(),se[F][3]=0)}B.opacity=I.opacity}else oe?(B.color=M(R.color,"uint8"),B.color[3]=0,B.borderColor=M(R.color,"uint8")):(B.color=M(R.color,"uint8"),B.borderColor=M(R.line.color,"uint8")),B.opacity=I.opacity*R.opacity;if(V)for(B.markers=new Array(D),F=0;F<D;F++)B.markers[F]=S(R.symbol[F]);else B.marker=S(R.symbol);var Q=1,W=f(I,Q),Z;if(Y||X){var ee=B.sizes=new Array(D),te=B.borderSizes=new Array(D),ae=0,le;if(Y){for(F=0;F<D;F++)ee[F]=W(R.size[F]),ae+=ee[F];le=ae/D}else for(Z=W(R.size),F=0;F<D;F++)ee[F]=Z;if(X)for(F=0;F<D;F++)te[F]=R.line.width[F];else for(Z=R.line.width,F=0;F<D;F++)te[F]=Z;B.sizeAvg=le}else B.size=W(R&&R.size||10),B.borderSizes=W(R.line.width);return B}function _(I,D){var R=I.marker,B={};return D&&(D.marker&&D.marker.symbol?B=u(e.extendFlat({},R,D.marker)):D.marker&&(D.marker.size&&(B.size=D.marker.size),D.marker.color&&(B.colors=D.marker.color),D.marker.opacity!==void 0&&(B.opacity=D.marker.opacity))),B}function s(I,D,R){var B={};if(!R)return B;if(R.textfont){var F={opacity:1,text:D.text,texttemplate:D.texttemplate,textposition:D.textposition,textfont:e.extendFlat({},D.textfont)};R.textfont&&e.extendFlat(F.textfont,R.textfont),B=m(I,F)}return B}function A(I,D,R){var B={capSize:D.width*2*R,lineWidth:D.thickness*R,color:D.color};return D.copy_ystyle&&(B=I.error_y),B}var x=i.SYMBOL_SDF_SIZE,v=i.SYMBOL_SIZE,b=i.SYMBOL_STROKE,l={},L=a.symbolFuncs[0](v*.05);function S(I){if(I==="circle")return null;var D,R,B=a.symbolNumber(I),F=a.symbolFuncs[B%100],V=!!a.symbolNoDot[B%100],G=!!a.symbolNoFill[B%100],J=o.isDotSymbol(I);return l[I]?l[I]:(J&&!V?D=F(v*1.1)+L:D=F(v),R=c(D,{w:x,h:x,viewBox:[-v,-v,v,v],stroke:G?b:-b}),l[I]=R,R||null)}function k(I,D,R){var B=R.length,F=B/2,V,G;if(t.hasLines(D)&&F)if(D.line.shape==="hv"){for(V=[],G=0;G<F-1;G++)isNaN(R[G*2])||isNaN(R[G*2+1])?V.push(NaN,NaN,NaN,NaN):(V.push(R[G*2],R[G*2+1]),!isNaN(R[G*2+2])&&!isNaN(R[G*2+3])?V.push(R[G*2+2],R[G*2+1]):V.push(NaN,NaN));V.push(R[B-2],R[B-1])}else if(D.line.shape==="hvh"){for(V=[],G=0;G<F-1;G++)if(isNaN(R[G*2])||isNaN(R[G*2+1])||isNaN(R[G*2+2])||isNaN(R[G*2+3]))!isNaN(R[G*2])&&!isNaN(R[G*2+1])?V.push(R[G*2],R[G*2+1]):V.push(NaN,NaN),V.push(NaN,NaN);else{var J=(R[G*2]+R[G*2+2])/2;V.push(R[G*2],R[G*2+1],J,R[G*2+1],J,R[G*2+3])}V.push(R[B-2],R[B-1])}else if(D.line.shape==="vhv"){for(V=[],G=0;G<F-1;G++)if(isNaN(R[G*2])||isNaN(R[G*2+1])||isNaN(R[G*2+2])||isNaN(R[G*2+3]))!isNaN(R[G*2])&&!isNaN(R[G*2+1])?V.push(R[G*2],R[G*2+1]):V.push(NaN,NaN),V.push(NaN,NaN);else{var j=(R[G*2+1]+R[G*2+3])/2;V.push(R[G*2],R[G*2+1],R[G*2],j,R[G*2+2],j)}V.push(R[B-2],R[B-1])}else if(D.line.shape==="vh"){for(V=[],G=0;G<F-1;G++)isNaN(R[G*2])||isNaN(R[G*2+1])?V.push(NaN,NaN,NaN,NaN):(V.push(R[G*2],R[G*2+1]),!isNaN(R[G*2+2])&&!isNaN(R[G*2+3])?V.push(R[G*2],R[G*2+3]):V.push(NaN,NaN));V.push(R[B-2],R[B-1])}else V=R;var Y=!1;for(G=0;G<V.length;G++)if(isNaN(V[G])){Y=!0;break}var X=Y||V.length>i.TOO_MANY_POINTS||t.hasMarkers(D)?"rect":"round";if(Y&&D.connectgaps){var oe=V[0],se=V[1];for(G=0;G<V.length;G+=2)isNaN(V[G])||isNaN(V[G+1])?(V[G]=oe,V[G+1]=se):(oe=V[G],se=V[G+1])}return{join:X,positions:V}}function P(I,D,R,B,F){var V=T.getComponentMethod("errorbars","makeComputeError"),G=n.getFromId(I,D.xaxis),J=n.getFromId(I,D.yaxis),j=R.length/2,Y={};function X(oe,se){var ie=se._id.charAt(0),N=D["error_"+ie];if(N&&N.visible&&(se.type==="linear"||se.type==="log")){for(var U=V(N),q={x:0,y:1}[ie],Q={x:[0,1,2,3],y:[2,3,0,1]}[ie],W=new Float64Array(4*j),Z=1/0,ee=-1/0,te=0,ae=0;te<j;te++,ae+=4){var le=oe[te];if(w(le)){var ye=R[te*2+q],fe=U(le,te),pe=fe[0],ge=fe[1];if(w(pe)&&w(ge)){var Ae=le-pe,we=le+ge;W[ae+Q[0]]=ye-se.c2l(Ae),W[ae+Q[1]]=se.c2l(we)-ye,W[ae+Q[2]]=0,W[ae+Q[3]]=0,Z=Math.min(Z,le-pe),ee=Math.max(ee,le+ge)}}}Y[ie]={positions:R,errors:W,_bnds:[Z,ee]}}}return X(B,G),X(F,J),Y}function z(I,D,R,B){var F=D._length,V={},G;if(t.hasMarkers(D)){var J=R.font,j=R.align,Y=R.baseline;for(V.offset=new Array(F),G=0;G<F;G++){var X=B.sizes?B.sizes[G]:B.size,oe=Array.isArray(J)?J[G].size:J.size,se=Array.isArray(j)?j.length>1?j[G]:j[0]:j,ie=Array.isArray(Y)?Y.length>1?Y[G]:Y[0]:Y,N=p[se],U=p[ie],q=X?X/.8+1:0,Q=-U*q-U*.5;V.offset[G]=[N*q/oe,Q/oe]}}return V}re.exports={style:h,markerStyle:u,markerSelection:_,linePositions:k,errorBarPositions:P,textPosition:z}},{"../../components/drawing":388,"../../components/fx/helpers":402,"../../constants/interactions":478,"../../lib":503,"../../lib/gl_format_color":499,"../../plots/cartesian/axis_ids":558,"../../registry":638,"../scatter/make_bubble_size_func":944,"../scatter/subtypes":952,"./constants":982,"./helpers":987,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":310}],984:[function(d,re,ne){var w=d("../../lib"),c=d("../../registry"),M=d("./helpers"),T=d("./attributes"),e=d("../scatter/constants"),a=d("../scatter/subtypes"),n=d("../scatter/xy_defaults"),r=d("../scatter/period_defaults"),t=d("../scatter/marker_defaults"),f=d("../scatter/line_defaults"),o=d("../scatter/fillcolor_defaults"),i=d("../scatter/text_defaults");re.exports=function(p,y,h,m){function u(L,S){return w.coerce(p,y,T,L,S)}var _=p.marker?M.isOpenSymbol(p.marker.symbol):!1,s=a.isBubble(p),A=n(p,y,m,u);if(!A){y.visible=!1;return}r(p,y,m,u),u("xhoverformat"),u("yhoverformat");var x=A<e.PTS_LINESONLY?"lines+markers":"lines";u("text"),u("hovertext"),u("hovertemplate"),u("mode",x),a.hasLines(y)&&(u("connectgaps"),f(p,y,h,m,u),u("line.shape")),a.hasMarkers(y)&&(t(p,y,h,m,u),u("marker.line.width",_||s?1:0)),a.hasText(y)&&(u("texttemplate"),i(p,y,m,u));var v=(y.line||{}).color,b=(y.marker||{}).color;u("fill"),y.fill!=="none"&&o(p,y,h,u);var l=c.getComponentMethod("errorbars","supplyDefaults");l(p,y,v||b||h,{axis:"y"}),l(p,y,v||b||h,{axis:"x",inherit:"y"}),w.coerceSelectionMarkerOpacity(y,u)}},{"../../lib":503,"../../registry":638,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/marker_defaults":946,"../scatter/period_defaults":947,"../scatter/subtypes":952,"../scatter/text_defaults":953,"../scatter/xy_defaults":954,"./attributes":979,"./helpers":987}],985:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/color"),M=d("../../constants/interactions").DESELECTDIM;function T(e){var a=e[0],n=a.trace,r=a.t,t=r._scene,f=r.index,o=t.selectBatch[f],i=t.unselectBatch[f],g=t.textOptions[f],p=t.textSelectedOptions[f]||{},y=t.textUnselectedOptions[f]||{},h=w.extendFlat({},g),m,u;if(o.length||i.length){var _=p.color,s=y.color,A=g.color,x=Array.isArray(A);for(h.color=new Array(n._length),m=0;m<o.length;m++)u=o[m],h.color[u]=_||(x?A[u]:A);for(m=0;m<i.length;m++){u=i[m];var v=x?A[u]:A;h.color[u]=s||(_?v:c.addOpacity(v,M))}}t.glText[f].update(h)}re.exports={styleTextSelection:T}},{"../../components/color":366,"../../constants/interactions":478,"../../lib":503}],986:[function(d,re,ne){var w=d("../scatter/format_labels");re.exports=function(M,T,e){var a=M.i;return"x"in M||(M.x=T._x[a]),"y"in M||(M.y=T._y[a]),w(M,T,e)}},{"../scatter/format_labels":936}],987:[function(d,re,ne){var w=d("./constants");ne.isOpenSymbol=function(c){return typeof c=="string"?w.OPEN_RE.test(c):c%200>100},ne.isDotSymbol=function(c){return typeof c=="string"?w.DOT_RE.test(c):c>200}},{"./constants":982}],988:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib"),M=d("../scatter/get_trace_color");function T(a,n,r,t){var f=a.cd,o=f[0].t,i=f[0].trace,g=a.xa,p=a.ya,y=o.x,h=o.y,m=g.c2p(n),u=p.c2p(r),_=a.distance,s;if(o.tree){var A=g.p2c(m-_),x=g.p2c(m+_),v=p.p2c(u-_),b=p.p2c(u+_);t==="x"?s=o.tree.range(Math.min(A,x),Math.min(p._rl[0],p._rl[1]),Math.max(A,x),Math.max(p._rl[0],p._rl[1])):s=o.tree.range(Math.min(A,x),Math.min(v,b),Math.max(A,x),Math.max(v,b))}else s=o.ids;var l,L,S,k,P,z,I,D,R,B=_;if(t==="x"){var F=!!i.xperiodalignment,V=!!i.yperiodalignment;for(P=0;P<s.length;P++){if(l=s[P],S=y[l],z=Math.abs(g.c2p(S)-m),F){var G=g.c2p(i._xStarts[l]),J=g.c2p(i._xEnds[l]);z=m>=Math.min(G,J)&&m<=Math.max(G,J)?0:1/0}if(z<B){if(B=z,k=h[l],I=p.c2p(k)-u,V){var j=p.c2p(i._yStarts[l]),Y=p.c2p(i._yEnds[l]);I=u>=Math.min(j,Y)&&u<=Math.max(j,Y)?0:1/0}R=Math.sqrt(z*z+I*I),L=s[P]}}}else for(P=s.length-1;P>-1;P--)l=s[P],S=y[l],k=h[l],z=g.c2p(S)-m,I=p.c2p(k)-u,D=Math.sqrt(z*z+I*I),D<B&&(B=R=D,L=l);return a.index=L,a.distance=B,a.dxy=R,L===void 0?[a]:[e(a,y,h,i)]}function e(a,n,r,t){var f=a.xa,o=a.ya,i=a.distance,g=a.dxy,p=a.index,y={pointNumber:p,x:n[p],y:r[p]};y.tx=Array.isArray(t.text)?t.text[p]:t.text,y.htx=Array.isArray(t.hovertext)?t.hovertext[p]:t.hovertext,y.data=Array.isArray(t.customdata)?t.customdata[p]:t.customdata,y.tp=Array.isArray(t.textposition)?t.textposition[p]:t.textposition;var h=t.textfont;h&&(y.ts=c.isArrayOrTypedArray(h.size)?h.size[p]:h.size,y.tc=Array.isArray(h.color)?h.color[p]:h.color,y.tf=Array.isArray(h.family)?h.family[p]:h.family);var m=t.marker;m&&(y.ms=c.isArrayOrTypedArray(m.size)?m.size[p]:m.size,y.mo=c.isArrayOrTypedArray(m.opacity)?m.opacity[p]:m.opacity,y.mx=c.isArrayOrTypedArray(m.symbol)?m.symbol[p]:m.symbol,y.mc=c.isArrayOrTypedArray(m.color)?m.color[p]:m.color);var u=m&&m.line;u&&(y.mlc=Array.isArray(u.color)?u.color[p]:u.color,y.mlw=c.isArrayOrTypedArray(u.width)?u.width[p]:u.width);var _=m&&m.gradient;_&&_.type!=="none"&&(y.mgt=Array.isArray(_.type)?_.type[p]:_.type,y.mgc=Array.isArray(_.color)?_.color[p]:_.color);var s=f.c2p(y.x,!0),A=o.c2p(y.y,!0),x=y.mrc||1,v=t.hoverlabel;v&&(y.hbg=Array.isArray(v.bgcolor)?v.bgcolor[p]:v.bgcolor,y.hbc=Array.isArray(v.bordercolor)?v.bordercolor[p]:v.bordercolor,y.hts=c.isArrayOrTypedArray(v.font.size)?v.font.size[p]:v.font.size,y.htc=Array.isArray(v.font.color)?v.font.color[p]:v.font.color,y.htf=Array.isArray(v.font.family)?v.font.family[p]:v.font.family,y.hnl=c.isArrayOrTypedArray(v.namelength)?v.namelength[p]:v.namelength);var b=t.hoverinfo;b&&(y.hi=Array.isArray(b)?b[p]:b);var l=t.hovertemplate;l&&(y.ht=Array.isArray(l)?l[p]:l);var L={};L[a.index]=y;var S=t._origX,k=t._origY,P=c.extendFlat({},a,{color:M(t,y),x0:s-x,x1:s+x,xLabelVal:S?S[p]:y.x,y0:A-x,y1:A+x,yLabelVal:k?k[p]:y.y,cd:L,distance:i,spikeDistance:g,hovertemplate:y.ht});return y.htx?P.text=y.htx:y.tx?P.text=y.tx:t.text&&(P.text=t.text),c.fillText(y,t,P),w.getComponentMethod("errorbars","hoverInfo")(y,t,P),P}re.exports={hoverPoints:T,calcHover:e}},{"../../lib":503,"../../registry":638,"../scatter/get_trace_color":937}],989:[function(d,re,ne){arguments[4][896][0].apply(ne,arguments)},{"./base_index":980,"./plot":990,dup:896}],990:[function(d,re,g){var w=d("regl-scatter2d"),c=d("regl-line2d"),M=d("regl-error2d"),T=d("gl-text"),e=d("../../lib"),a=d("../../components/dragelement/helpers").selectMode,n=d("../../lib/prepare_regl"),r=d("../scatter/subtypes"),t=d("../scatter/link_traces"),f=d("./edit_style").styleTextSelection,o={};function i(p,y,h,m){var u=p._size,_=p.width*m,s=p.height*m,A=u.l*m,x=u.b*m,v=u.r*m,b=u.t*m,l=u.w*m,L=u.h*m;return[A+y.domain[0]*l,x+h.domain[0]*L,_-v-(1-y.domain[1])*l,s-b-(1-h.domain[1])*L]}var g=re.exports=function(y,h,m){if(!!m.length){var u=y._fullLayout,_=h._scene,s=h.xaxis,A=h.yaxis,x,v;if(!!_){var b=n(y,["ANGLE_instanced_arrays","OES_element_index_uint"],o);if(!b){_.init();return}var l=_.count,L=u._glcanvas.data()[0].regl;if(t(y,h,m),_.dirty){if(_.error2d===!0&&(_.error2d=M(L)),_.line2d===!0&&(_.line2d=c(L)),_.scatter2d===!0&&(_.scatter2d=w(L)),_.fill2d===!0&&(_.fill2d=c(L)),_.glText===!0)for(_.glText=new Array(l),x=0;x<l;x++)_.glText[x]=new T(L);if(_.glText){if(l>_.glText.length){var S=l-_.glText.length;for(x=0;x<S;x++)_.glText.push(new T(L))}else if(l<_.glText.length){var k=_.glText.length-l,P=_.glText.splice(l,k);P.forEach(function(W){W.destroy()})}for(x=0;x<l;x++)_.glText[x].update(_.textOptions[x])}if(_.line2d&&(_.line2d.update(_.lineOptions),_.lineOptions=_.lineOptions.map(function(W){if(W&&W.positions){for(var Z=W.positions,ee=0;ee<Z.length&&(isNaN(Z[ee])||isNaN(Z[ee+1]));)ee+=2;for(var te=Z.length-2;te>ee&&(isNaN(Z[te])||isNaN(Z[te+1]));)te-=2;W.positions=Z.slice(ee,te+2)}return W}),_.line2d.update(_.lineOptions)),_.error2d){var z=(_.errorXOptions||[]).concat(_.errorYOptions||[]);_.error2d.update(z)}_.scatter2d&&_.scatter2d.update(_.markerOptions),_.fillOrder=e.repeat(null,l),_.fill2d&&(_.fillOptions=_.fillOptions.map(function(W,Z){var ee=m[Z];if(!(!W||!ee||!ee[0]||!ee[0].trace)){var te=ee[0],ae=te.trace,le=te.t,ye=_.lineOptions[Z],fe,pe,ge=[];ae._ownfill&&ge.push(Z),ae._nexttrace&&ge.push(Z+1),ge.length&&(_.fillOrder[Z]=ge);var Ae=[],we=ye&&ye.positions||le.positions,De,Be;if(ae.fill==="tozeroy"){for(De=0;De<we.length&&isNaN(we[De+1]);)De+=2;for(Be=we.length-2;Be>De&&isNaN(we[Be+1]);)Be-=2;we[De+1]!==0&&(Ae=[we[De],0]),Ae=Ae.concat(we.slice(De,Be+2)),we[Be+1]!==0&&(Ae=Ae.concat([we[Be],0]))}else if(ae.fill==="tozerox"){for(De=0;De<we.length&&isNaN(we[De]);)De+=2;for(Be=we.length-2;Be>De&&isNaN(we[Be]);)Be-=2;we[De]!==0&&(Ae=[0,we[De+1]]),Ae=Ae.concat(we.slice(De,Be+2)),we[Be]!==0&&(Ae=Ae.concat([0,we[Be+1]]))}else if(ae.fill==="toself"||ae.fill==="tonext"){for(Ae=[],fe=0,W.splitNull=!0,pe=0;pe<we.length;pe+=2)(isNaN(we[pe])||isNaN(we[pe+1]))&&(Ae=Ae.concat(we.slice(fe,pe)),Ae.push(we[fe],we[fe+1]),Ae.push(null,null),fe=pe+2);Ae=Ae.concat(we.slice(fe)),fe&&Ae.push(we[fe],we[fe+1])}else{var Ve=ae._nexttrace;if(Ve){var xe=_.lineOptions[Z+1];if(xe){var Le=xe.positions;if(ae.fill==="tonexty"){for(Ae=we.slice(),Z=Math.floor(Le.length/2);Z--;){var He=Le[Z*2],Je=Le[Z*2+1];isNaN(He)||isNaN(Je)||Ae.push(He,Je)}W.fill=Ve.fillcolor}}}}if(ae._prevtrace&&ae._prevtrace.fill==="tonext"){var Oe=_.lineOptions[Z-1].positions,Pe=Ae.length/2;fe=Pe;var Ue=[fe];for(pe=0;pe<Oe.length;pe+=2)(isNaN(Oe[pe])||isNaN(Oe[pe+1]))&&(Ue.push(pe/2+Pe+1),fe=pe+2);Ae=Ae.concat(Oe),W.hole=Ue}return W.fillmode=ae.fill,W.opacity=ae.opacity,W.positions=Ae,W}}),_.fill2d.update(_.fillOptions))}var I=u.dragmode,D=a(I),R=u.clickmode.indexOf("select")>-1;for(x=0;x<l;x++){var B=m[x][0],F=B.trace,V=B.t,G=V.index,J=F._length,j=V.x,Y=V.y;if(F.selectedpoints||D||R){if(D||(D=!0),F.selectedpoints){var X=_.selectBatch[G]=e.selIndices2selPoints(F),oe={};for(v=0;v<X.length;v++)oe[X[v]]=1;var se=[];for(v=0;v<J;v++)oe[v]||se.push(v);_.unselectBatch[G]=se}var ie=V.xpx=new Array(J),N=V.ypx=new Array(J);for(v=0;v<J;v++)ie[v]=s.c2p(j[v]),N[v]=A.c2p(Y[v])}else V.xpx=V.ypx=null}if(D){if(_.select2d||(_.select2d=w(u._glcanvas.data()[1].regl)),_.scatter2d){var U=new Array(l);for(x=0;x<l;x++)U[x]=_.selectBatch[x].length||_.unselectBatch[x].length?_.markerUnselectedOptions[x]:{};_.scatter2d.update(U)}_.select2d&&(_.select2d.update(_.markerOptions),_.select2d.update(_.markerSelectedOptions)),_.glText&&m.forEach(function(W){var Z=((W||[])[0]||{}).trace||{};r.hasText(Z)&&f(W)})}else _.scatter2d&&_.scatter2d.update(_.markerOptions);var q={viewport:i(u,s,A,y._context.plotGlPixelRatio),range:[(s._rl||s.range)[0],(A._rl||A.range)[0],(s._rl||s.range)[1],(A._rl||A.range)[1]]},Q=e.repeat(q,_.count);_.fill2d&&_.fill2d.update(Q),_.line2d&&_.line2d.update(Q),_.error2d&&_.error2d.update(Q.concat(Q)),_.scatter2d&&_.scatter2d.update(Q),_.select2d&&_.select2d.update(Q),_.glText&&_.glText.forEach(function(W){W.update(q)})}}};g.reglPrecompiled=o},{"../../components/dragelement/helpers":384,"../../lib":503,"../../lib/prepare_regl":516,"../scatter/link_traces":943,"../scatter/subtypes":952,"./edit_style":985,"gl-text":225,"regl-error2d":279,"regl-line2d":280,"regl-scatter2d":281}],991:[function(d,re,ne){var w=d("../../lib");re.exports=function(M,T){var e=T._scene,a={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},n={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return T._scene||(e=T._scene={},e.init=function(){w.extendFlat(e,n,a)},e.init(),e.update=function(t){var f=w.repeat(t,e.count);if(e.fill2d&&e.fill2d.update(f),e.scatter2d&&e.scatter2d.update(f),e.line2d&&e.line2d.update(f),e.error2d&&e.error2d.update(f.concat(f)),e.select2d&&e.select2d.update(f),e.glText)for(var o=0;o<e.count;o++)e.glText[o].update(t)},e.draw=function(){for(var t=e.count,f=e.fill2d,o=e.error2d,i=e.line2d,g=e.scatter2d,p=e.glText,y=e.select2d,h=e.selectBatch,m=e.unselectBatch,u=0;u<t;u++){if(f&&e.fillOrder[u]&&f.draw(e.fillOrder[u]),i&&e.lineOptions[u]&&i.draw(u),o&&(e.errorXOptions[u]&&o.draw(u),e.errorYOptions[u]&&o.draw(u+t)),g&&e.markerOptions[u])if(m[u].length){var _=w.repeat([],e.count);_[u]=m[u],g.draw(_)}else h[u].length||g.draw(u);p[u]&&e.textOptions[u]&&p[u].render()}y&&y.draw(h),e.dirty=!1},e.destroy=function(){e.fill2d&&e.fill2d.destroy&&e.fill2d.destroy(),e.scatter2d&&e.scatter2d.destroy&&e.scatter2d.destroy(),e.error2d&&e.error2d.destroy&&e.error2d.destroy(),e.line2d&&e.line2d.destroy&&e.line2d.destroy(),e.select2d&&e.select2d.destroy&&e.select2d.destroy(),e.glText&&e.glText.forEach(function(t){t.destroy&&t.destroy()}),e.lineOptions=null,e.fillOptions=null,e.markerOptions=null,e.markerSelectedOptions=null,e.markerUnselectedOptions=null,e.errorXOptions=null,e.errorYOptions=null,e.textOptions=null,e.textSelectedOptions=null,e.textUnselectedOptions=null,e.selectBatch=null,e.unselectBatch=null,T._scene=null}),e.dirty||w.extendFlat(e,a),e}},{"../../lib":503}],992:[function(d,re,ne){var w=d("../scatter/subtypes"),c=d("./edit_style").styleTextSelection;re.exports=function(T,e){var a=T.cd,n=T.xaxis,r=T.yaxis,t=[],f=a[0].trace,o=a[0].t,i=f._length,g=o.x,p=o.y,y=o._scene,h=o.index;if(!y)return t;var m=w.hasText(f),u=w.hasMarkers(f),_=!u&&!m;if(f.visible!==!0||_)return t;var s=[],A=[];if(e!==!1&&!e.degenerate)for(var x=0;x<i;x++)e.contains([o.xpx[x],o.ypx[x]],!1,x,T)?(s.push(x),t.push({pointNumber:x,x:n.c2d(g[x]),y:r.c2d(p[x])})):A.push(x);if(u){var v=y.scatter2d;if(!s.length&&!A.length){var b=new Array(y.count);b[h]=y.markerOptions[h],v.update.apply(v,b)}else if(!y.selectBatch[h].length&&!y.unselectBatch[h].length){var l=new Array(y.count);l[h]=y.markerUnselectedOptions[h],v.update.apply(v,l)}}return y.selectBatch[h]=s,y.unselectBatch[h]=A,m&&c(a),t}},{"../scatter/subtypes":952,"./edit_style":985}],993:[function(d,re,ne){var w=d("../../plots/template_attributes").hovertemplateAttrs,c=d("../../plots/template_attributes").texttemplateAttrs,M=d("../scattergeo/attributes"),T=d("../scatter/attributes"),e=d("../../plots/mapbox/layout_attributes"),a=d("../../plots/attributes"),n=d("../../components/colorscale/attributes"),r=d("../../lib/extend").extendFlat,t=d("../../plot_api/edit_types").overrideAll,f=M.line,o=M.marker;re.exports=t({lon:M.lon,lat:M.lat,mode:r({},T.mode,{dflt:"markers"}),text:r({},T.text,{}),texttemplate:c({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:r({},T.hovertext,{}),line:{color:f.color,width:f.width},connectgaps:T.connectgaps,marker:r({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:o.opacity,size:o.size,sizeref:o.sizeref,sizemin:o.sizemin,sizemode:o.sizemode},n("marker")),fill:M.fill,fillcolor:T.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:T.selected.marker},unselected:{marker:T.unselected.marker},hoverinfo:r({},a.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:w()},"calc","nested")},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/mapbox/layout_attributes":615,"../../plots/template_attributes":633,"../scatter/attributes":927,"../scattergeo/attributes":969}],994:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../lib"),M=d("../../constants/numerical").BADNUM,T=d("../../lib/geojson_utils"),e=d("../../components/colorscale"),a=d("../../components/drawing"),n=d("../scatter/make_bubble_size_func"),r=d("../scatter/subtypes"),t=d("../../plots/mapbox/convert_text_opts"),f=d("../../components/fx/helpers").appendArrayPointValue,o=d("../../lib/svg_text_utils").NEWLINES,i=d("../../lib/svg_text_utils").BR_TAG_ALL;re.exports=function(s,A){var x=A[0].trace,v=x.visible===!0&&x._length!==0,b=x.fill!=="none",l=r.hasLines(x),L=r.hasMarkers(x),S=r.hasText(x),k=L&&x.marker.symbol==="circle",P=L&&x.marker.symbol!=="circle",z=g(),I=g(),D=g(),R=g(),B={fill:z,line:I,circle:D,symbol:R};if(!v)return B;var F;if((b||l)&&(F=T.calcTraceToLineCoords(A)),b&&(z.geojson=T.makePolygon(F),z.layout.visibility="visible",c.extendFlat(z.paint,{"fill-color":x.fillcolor})),l&&(I.geojson=T.makeLine(F),I.layout.visibility="visible",c.extendFlat(I.paint,{"line-width":x.line.width,"line-color":x.line.color,"line-opacity":x.opacity})),k){var V=p(A);D.geojson=V.geojson,D.layout.visibility="visible",c.extendFlat(D.paint,{"circle-color":V.mcc,"circle-radius":V.mrc,"circle-opacity":V.mo})}if((P||S)&&(R.geojson=y(A,s),c.extendFlat(R.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),P&&(c.extendFlat(R.layout,{"icon-size":x.marker.size/10}),"angle"in x.marker&&x.marker.angle!=="auto"&&c.extendFlat(R.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),R.layout["icon-allow-overlap"]=x.marker.allowoverlap,c.extendFlat(R.paint,{"icon-opacity":x.opacity*x.marker.opacity,"icon-color":x.marker.color})),S)){var G=(x.marker||{}).size,J=t(x.textposition,G);c.extendFlat(R.layout,{"text-size":x.textfont.size,"text-anchor":J.anchor,"text-offset":J.offset}),c.extendFlat(R.paint,{"text-color":x.textfont.color,"text-opacity":x.opacity})}return B};function g(){return{geojson:T.makeBlank(),layout:{visibility:"none"},paint:{}}}function p(_){var s=_[0].trace,A=s.marker,x=s.selectedpoints,v=c.isArrayOrTypedArray(A.color),b=c.isArrayOrTypedArray(A.size),l=c.isArrayOrTypedArray(A.opacity),L;function S(J){return s.opacity*J}function k(J){return J/2}var P;v&&(e.hasColorscale(s,"marker")?P=e.makeColorScaleFuncFromTrace(A):P=c.identity);var z;b&&(z=n(s));var I;l&&(I=function(J){var j=w(J)?+c.constrain(J,0,1):0;return S(j)});var D=[];for(L=0;L<_.length;L++){var R=_[L],B=R.lonlat;if(!u(B)){var F={};P&&(F.mcc=R.mcc=P(R.mc)),z&&(F.mrc=R.mrc=z(R.ms)),I&&(F.mo=I(R.mo)),x&&(F.selected=R.selected||0),D.push({type:"Feature",geometry:{type:"Point",coordinates:B},properties:F})}}var V;if(x)for(V=a.makeSelectedPointStyleFns(s),L=0;L<D.length;L++){var G=D[L].properties;V.selectedOpacityFn&&(G.mo=S(V.selectedOpacityFn(G))),V.selectedColorFn&&(G.mcc=V.selectedColorFn(G)),V.selectedSizeFn&&(G.mrc=V.selectedSizeFn(G))}return{geojson:{type:"FeatureCollection",features:D},mcc:v||V&&V.selectedColorFn?{type:"identity",property:"mcc"}:A.color,mrc:b||V&&V.selectedSizeFn?{type:"identity",property:"mrc"}:k(A.size),mo:l||V&&V.selectedOpacityFn?{type:"identity",property:"mo"}:S(A.opacity)}}function y(_,s){for(var A=s._fullLayout,x=_[0].trace,v=x.marker||{},b=v.symbol,l=v.angle,L=b!=="circle"?h(b):m,S=l!=="auto"?h(l,!0):m,k=r.hasText(x)?h(x.text):m,P=[],z=0;z<_.length;z++){var I=_[z];if(!u(I.lonlat)){var D=x.texttemplate,R;if(D){var B=Array.isArray(D)?D[z]||"":D,F=x._module.formatLabels(I,x,A),V={};f(V,x,I.i);var G=x._meta||{};R=c.texttemplateString(B,F,A._d3locale,V,I,G)}else R=k(z);R&&(R=R.replace(o,"").replace(i,`
`)),P.push({type:"Feature",geometry:{type:"Point",coordinates:I.lonlat},properties:{symbol:L(z),angle:S(z),text:R}})}}return{type:"FeatureCollection",features:P}}function h(_,s){return c.isArrayOrTypedArray(_)?s?function(A){return w(_[A])?+_[A]:0}:function(A){return _[A]}:_?function(){return _}:m}function m(){return""}function u(_){return _[0]===M}},{"../../components/colorscale":378,"../../components/drawing":388,"../../components/fx/helpers":402,"../../constants/numerical":479,"../../lib":503,"../../lib/geojson_utils":497,"../../lib/svg_text_utils":529,"../../plots/mapbox/convert_text_opts":612,"../scatter/make_bubble_size_func":944,"../scatter/subtypes":952,"fast-isnumeric":190}],995:[function(d,re,ne){var w=d("../../lib"),c=d("../scatter/subtypes"),M=d("../scatter/marker_defaults"),T=d("../scatter/line_defaults"),e=d("../scatter/text_defaults"),a=d("../scatter/fillcolor_defaults"),n=d("./attributes");re.exports=function(f,o,i,g){function p(m,u){return w.coerce(f,o,n,m,u)}var y=r(f,o,p);if(!y){o.visible=!1;return}if(p("text"),p("texttemplate"),p("hovertext"),p("hovertemplate"),p("mode"),p("below"),c.hasLines(o)&&(T(f,o,i,g,p,{noDash:!0}),p("connectgaps")),c.hasMarkers(o)){M(f,o,i,g,p,{noLine:!0}),p("marker.allowoverlap"),p("marker.angle");var h=o.marker;h.symbol!=="circle"&&(w.isArrayOrTypedArray(h.size)&&(h.size=h.size[0]),w.isArrayOrTypedArray(h.color)&&(h.color=h.color[0]))}c.hasText(o)&&e(f,o,g,p,{noSelect:!0}),p("fill"),o.fill!=="none"&&a(f,o,i,p),w.coerceSelectionMarkerOpacity(o,p)};function r(t,f,o){var i=o("lon")||[],g=o("lat")||[],p=Math.min(i.length,g.length);return f._length=p,p}},{"../../lib":503,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":993}],996:[function(d,re,ne){re.exports=function(c,M){return c.lon=M.lon,c.lat=M.lat,c}},{}],997:[function(d,re,ne){var w=d("../../plots/cartesian/axes");re.exports=function(M,T,e){var a={},n=e[T.subplot]._subplot,r=n.mockAxis,t=M.lonlat;return a.lonLabel=w.tickText(r,r.c2l(t[0]),!0).text,a.latLabel=w.tickText(r,r.c2l(t[1]),!0).text,a}},{"../../plots/cartesian/axes":554}],998:[function(d,re,ne){var w=d("../../components/fx"),c=d("../../lib"),M=d("../scatter/get_trace_color"),T=c.fillText,e=d("../../constants/numerical").BADNUM;function a(r,t,f){var o=r.cd,i=o[0].trace,g=r.xa,p=r.ya,y=r.subplot,h=t>=0?Math.floor((t+180)/360):Math.ceil((t-180)/360),m=h*360,u=t-m;function _(k){var P=k.lonlat;if(P[0]===e)return 1/0;var z=c.modHalf(P[0],360),I=P[1],D=y.project([z,I]),R=D.x-g.c2p([u,I]),B=D.y-p.c2p([z,f]),F=Math.max(3,k.mrc||0);return Math.max(Math.sqrt(R*R+B*B)-F,1-3/F)}if(w.getClosest(o,_,r),r.index!==!1){var s=o[r.index],A=s.lonlat,x=[c.modHalf(A[0],360)+m,A[1]],v=g.c2p(x),b=p.c2p(x),l=s.mrc||1;r.x0=v-l,r.x1=v+l,r.y0=b-l,r.y1=b+l;var L={};L[i.subplot]={_subplot:y};var S=i._module.formatLabels(s,i,L);return r.lonLabel=S.lonLabel,r.latLabel=S.latLabel,r.color=M(i,s),r.extraText=n(i,s,o[0].t.labels),r.hovertemplate=i.hovertemplate,[r]}}function n(r,t,f){if(r.hovertemplate)return;var o=t.hi||r.hoverinfo,i=o.split("+"),g=i.indexOf("all")!==-1,p=i.indexOf("lon")!==-1,y=i.indexOf("lat")!==-1,h=t.lonlat,m=[];function u(_){return _+"\xB0"}return g||p&&y?m.push("("+u(h[1])+", "+u(h[0])+")"):p?m.push(f.lon+u(h[0])):y&&m.push(f.lat+u(h[1])),(g||i.indexOf("text")!==-1)&&T(t,r,m),m.join("<br>")}re.exports={hoverPoints:a,getExtraText:n}},{"../../components/fx":406,"../../constants/numerical":479,"../../lib":503,"../scatter/get_trace_color":937}],999:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("../scattergeo/calc"),plot:d("./plot"),hoverPoints:d("./hover").hoverPoints,eventData:d("./event_data"),selectPoints:d("./select"),styleOnSelect:function(w,c){if(c){var M=c[0].trace;M._glTrace.update(c)}},moduleType:"trace",name:"scattermapbox",basePlotModule:d("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":613,"../scatter/marker_colorbar":945,"../scattergeo/calc":970,"./attributes":993,"./defaults":995,"./event_data":996,"./format_labels":997,"./hover":998,"./plot":1e3,"./select":1001}],1e3:[function(d,re,ne){var w=d("./convert"),c=d("../../plots/mapbox/constants").traceLayerPrefix,M=["fill","line","circle","symbol"];function T(a,n){this.type="scattermapbox",this.subplot=a,this.uid=n,this.sourceIds={fill:"source-"+n+"-fill",line:"source-"+n+"-line",circle:"source-"+n+"-circle",symbol:"source-"+n+"-symbol"},this.layerIds={fill:c+n+"-fill",line:c+n+"-line",circle:c+n+"-circle",symbol:c+n+"-symbol"},this.below=null}var e=T.prototype;e.addSource=function(a,n){this.subplot.map.addSource(this.sourceIds[a],{type:"geojson",data:n.geojson})},e.setSourceData=function(a,n){this.subplot.map.getSource(this.sourceIds[a]).setData(n.geojson)},e.addLayer=function(a,n,r){this.subplot.addLayer({type:a,id:this.layerIds[a],source:this.sourceIds[a],layout:n.layout,paint:n.paint},r)},e.update=function(n){var r=this.subplot,t=r.map,f=w(r.gd,n),o=r.belowLookup["trace-"+this.uid],i,g,p;if(o!==this.below){for(i=M.length-1;i>=0;i--)g=M[i],t.removeLayer(this.layerIds[g]);for(i=0;i<M.length;i++)g=M[i],p=f[g],this.addLayer(g,p,o);this.below=o}for(i=0;i<M.length;i++)g=M[i],p=f[g],r.setOptions(this.layerIds[g],"setLayoutProperty",p.layout),p.layout.visibility==="visible"&&(this.setSourceData(g,p),r.setOptions(this.layerIds[g],"setPaintProperty",p.paint));n[0].trace._glTrace=this},e.dispose=function(){for(var n=this.subplot.map,r=M.length-1;r>=0;r--){var t=M[r];n.removeLayer(this.layerIds[t]),n.removeSource(this.sourceIds[t])}},re.exports=function(n,r){for(var t=r[0].trace,f=new T(n,t.uid),o=w(n.gd,r),i=f.below=n.belowLookup["trace-"+t.uid],g=0;g<M.length;g++){var p=M[g],y=o[p];f.addSource(p,y),f.addLayer(p,y,i)}return r[0].trace._glTrace=f,f}},{"../../plots/mapbox/constants":611,"./convert":994}],1001:[function(d,re,ne){var w=d("../../lib"),c=d("../scatter/subtypes"),M=d("../../constants/numerical").BADNUM;re.exports=function(e,a){var n=e.cd,r=e.xaxis,t=e.yaxis,f=[],o=n[0].trace,i;if(!c.hasMarkers(o))return[];if(a===!1)for(i=0;i<n.length;i++)n[i].selected=0;else for(i=0;i<n.length;i++){var g=n[i],p=g.lonlat;if(p[0]!==M){var y=[w.modHalf(p[0],360),p[1]],h=[r.c2p(y),t.c2p(y)];a.contains(h,null,i,e)?(f.push({pointNumber:i,lon:p[0],lat:p[1]}),g.selected=1):g.selected=0}}return f}},{"../../constants/numerical":479,"../../lib":503,"../scatter/subtypes":952}],1002:[function(d,re,ne){var w=d("../../plots/template_attributes").hovertemplateAttrs,c=d("../../plots/template_attributes").texttemplateAttrs,M=d("../../lib/extend").extendFlat,T=d("../scatter/attributes"),e=d("../../plots/attributes"),a=T.line;re.exports={mode:T.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:T.text,texttemplate:c({editType:"plot"},{keys:["r","theta","text"]}),hovertext:T.hovertext,line:{color:a.color,width:a.width,dash:a.dash,shape:M({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:T.connectgaps,marker:T.marker,cliponaxis:M({},T.cliponaxis,{dflt:!1}),textposition:T.textposition,textfont:T.textfont,fill:M({},T.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:T.fillcolor,hoverinfo:M({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:T.hoveron,hovertemplate:w(),selected:T.selected,unselected:T.unselected}},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":927}],1003:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../constants/numerical").BADNUM,M=d("../../plots/cartesian/axes"),T=d("../scatter/colorscale_calc"),e=d("../scatter/arrays_to_calcdata"),a=d("../scatter/calc_selection"),n=d("../scatter/calc").calcMarkerSize;re.exports=function(t,f){for(var o=t._fullLayout,i=f.subplot,g=o[i].radialaxis,p=o[i].angularaxis,y=g.makeCalcdata(f,"r"),h=p.makeCalcdata(f,"theta"),m=f._length,u=new Array(m),_=0;_<m;_++){var s=y[_],A=h[_],x=u[_]={};w(s)&&w(A)?(x.r=s,x.theta=A):x.r=c}var v=n(f,m);return f._extremes.x=M.findExtremes(g,y,{ppad:v}),T(t,f),e(u,f),a(u,f),u}},{"../../constants/numerical":479,"../../plots/cartesian/axes":554,"../scatter/arrays_to_calcdata":926,"../scatter/calc":928,"../scatter/calc_selection":929,"../scatter/colorscale_calc":930,"fast-isnumeric":190}],1004:[function(d,re,ne){var w=d("../../lib"),c=d("../scatter/subtypes"),M=d("../scatter/marker_defaults"),T=d("../scatter/line_defaults"),e=d("../scatter/line_shape_defaults"),a=d("../scatter/text_defaults"),n=d("../scatter/fillcolor_defaults"),r=d("../scatter/constants").PTS_LINESONLY,t=d("./attributes");function f(i,g,p,y){function h(_,s){return w.coerce(i,g,t,_,s)}var m=o(i,g,y,h);if(!m){g.visible=!1;return}h("thetaunit"),h("mode",m<r?"lines+markers":"lines"),h("text"),h("hovertext"),g.hoveron!=="fills"&&h("hovertemplate"),c.hasLines(g)&&(T(i,g,p,y,h),e(i,g,h),h("connectgaps")),c.hasMarkers(g)&&M(i,g,p,y,h,{gradient:!0}),c.hasText(g)&&(h("texttemplate"),a(i,g,y,h));var u=[];(c.hasMarkers(g)||c.hasText(g))&&(h("cliponaxis"),h("marker.maxdisplayed"),u.push("points")),h("fill"),g.fill!=="none"&&(n(i,g,p,h),c.hasLines(g)||e(i,g,h)),(g.fill==="tonext"||g.fill==="toself")&&u.push("fills"),h("hoveron",u.join("+")||"points"),w.coerceSelectionMarkerOpacity(g,h)}function o(i,g,p,y){var h=y("r"),m=y("theta"),u;if(h)m?u=Math.min(h.length,m.length):(u=h.length,y("theta0"),y("dtheta"));else{if(!m)return 0;u=g.theta.length,y("r0"),y("dr")}return g._length=u,u}re.exports={handleRThetaDefaults:o,supplyDefaults:f}},{"../../lib":503,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/line_shape_defaults":942,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":1002}],1005:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes");re.exports=function(T,e,a){var n={},r=a[e.subplot]._subplot,t,f;r?(t=r.radialAxis,f=r.angularAxis):(r=a[e.subplot],t=r.radialaxis,f=r.angularaxis);var o=t.c2l(T.r);n.rLabel=c.tickText(t,o,!0).text;var i=f.thetaunit==="degrees"?w.rad2deg(T.theta):T.theta;return n.thetaLabel=c.tickText(f,i,!0).text,n}},{"../../lib":503,"../../plots/cartesian/axes":554}],1006:[function(d,re,ne){var w=d("../scatter/hover");function c(T,e,a,n){var r=w(T,e,a,n);if(!(!r||r[0].index===!1)){var t=r[0];if(t.index===void 0)return r;var f=T.subplot,o=t.cd[t.index],i=t.trace;if(!!f.isPtInside(o))return t.xLabelVal=void 0,t.yLabelVal=void 0,M(o,i,f,t),t.hovertemplate=i.hovertemplate,r}}function M(T,e,a,n){var r=a.radialAxis,t=a.angularAxis;r._hovertitle="r",t._hovertitle="\u03B8";var f={};f[e.subplot]={_subplot:a};var o=e._module.formatLabels(T,e,f);n.rLabel=o.rLabel,n.thetaLabel=o.thetaLabel;var i=T.hi||e.hoverinfo,g=[];function p(h,m){g.push(h._hovertitle+": "+m)}if(!e.hovertemplate){var y=i.split("+");y.indexOf("all")!==-1&&(y=["r","theta","text"]),y.indexOf("r")!==-1&&p(r,n.rLabel),y.indexOf("theta")!==-1&&p(t,n.thetaLabel),y.indexOf("text")!==-1&&n.text&&(g.push(n.text),delete n.text),n.extraText=g.join("<br>")}}re.exports={hoverPoints:c,makeHoverPointText:M}},{"../scatter/hover":938}],1007:[function(d,re,ne){re.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:d("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,selectPoints:d("../scatter/select"),meta:{}}},{"../../plots/polar":622,"../scatter/marker_colorbar":945,"../scatter/select":949,"../scatter/style":951,"./attributes":1002,"./calc":1003,"./defaults":1004,"./format_labels":1005,"./hover":1006,"./plot":1008}],1008:[function(d,re,ne){var w=d("../scatter/plot"),c=d("../../constants/numerical").BADNUM;re.exports=function(T,e,a){for(var n=e.layers.frontplot.select("g.scatterlayer"),r={xaxis:e.xaxis,yaxis:e.yaxis,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},t=e.radialAxis,f=e.angularAxis,o=0;o<a.length;o++)for(var i=a[o],g=0;g<i.length;g++){var p=i[g],y=p.r;if(y===c)p.x=p.y=c;else{var h=t.c2g(y),m=f.c2g(p.theta);p.x=h*Math.cos(m),p.y=h*Math.sin(m)}}w(T,r,a,n)}},{"../../constants/numerical":479,"../scatter/plot":948}],1009:[function(d,re,ne){var w=d("../scatterpolar/attributes"),c=d("../scattergl/attributes"),M=d("../../plots/template_attributes").texttemplateAttrs;re.exports={mode:w.mode,r:w.r,theta:w.theta,r0:w.r0,dr:w.dr,theta0:w.theta0,dtheta:w.dtheta,thetaunit:w.thetaunit,text:w.text,texttemplate:M({editType:"plot"},{keys:["r","theta","text"]}),hovertext:w.hovertext,hovertemplate:w.hovertemplate,line:c.line,connectgaps:c.connectgaps,marker:c.marker,fill:c.fill,fillcolor:c.fillcolor,textposition:c.textposition,textfont:c.textfont,hoverinfo:w.hoverinfo,selected:w.selected,unselected:w.unselected}},{"../../plots/template_attributes":633,"../scattergl/attributes":979,"../scatterpolar/attributes":1002}],1010:[function(d,re,ne){re.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:d("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),hoverPoints:d("./hover").hoverPoints,selectPoints:d("../scattergl/select"),meta:{}}},{"../../plots/polar":622,"../scatter/marker_colorbar":945,"../scattergl/select":992,"./attributes":1009,"./calc":1011,"./defaults":1012,"./format_labels":1013,"./hover":1014}],1011:[function(d,re,ne){var w=d("../scatter/colorscale_calc"),c=d("../scatter/calc").calcMarkerSize,M=d("../scattergl/convert"),T=d("../../plots/cartesian/axes"),e=d("../scattergl/constants").TOO_MANY_POINTS;re.exports=function(n,r){var t=n._fullLayout,f=r.subplot,o=t[f].radialaxis,i=t[f].angularaxis,g=r._r=o.makeCalcdata(r,"r"),p=r._theta=i.makeCalcdata(r,"theta"),y=r._length,h={};y<g.length&&(g=g.slice(0,y)),y<p.length&&(p=p.slice(0,y)),h.r=g,h.theta=p,w(n,r);var m=h.opts=M.style(n,r),u;return y<e?u=c(r,y):m.marker&&(u=2*(m.marker.sizeAvg||Math.max(m.marker.size,3))),r._extremes.x=T.findExtremes(o,g,{ppad:u}),[{x:!1,y:!1,t:h,trace:r}]}},{"../../plots/cartesian/axes":554,"../scatter/calc":928,"../scatter/colorscale_calc":930,"../scattergl/constants":982,"../scattergl/convert":983}],1012:[function(d,re,ne){var w=d("../../lib"),c=d("../scatter/subtypes"),M=d("../scatterpolar/defaults").handleRThetaDefaults,T=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/text_defaults"),n=d("../scatter/fillcolor_defaults"),r=d("../scatter/constants").PTS_LINESONLY,t=d("./attributes");re.exports=function(o,i,g,p){function y(m,u){return w.coerce(o,i,t,m,u)}var h=M(o,i,p,y);if(!h){i.visible=!1;return}y("thetaunit"),y("mode",h<r?"lines+markers":"lines"),y("text"),y("hovertext"),i.hoveron!=="fills"&&y("hovertemplate"),c.hasLines(i)&&(e(o,i,g,p,y),y("connectgaps")),c.hasMarkers(i)&&T(o,i,g,p,y),c.hasText(i)&&(y("texttemplate"),a(o,i,p,y)),y("fill"),i.fill!=="none"&&n(o,i,g,y),w.coerceSelectionMarkerOpacity(i,y)}},{"../../lib":503,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"../scatterpolar/defaults":1004,"./attributes":1009}],1013:[function(d,re,ne){var w=d("../scatterpolar/format_labels");re.exports=function(M,T,e){var a=M.i;return"r"in M||(M.r=T._r[a]),"theta"in M||(M.theta=T._theta[a]),w(M,T,e)}},{"../scatterpolar/format_labels":1005}],1014:[function(d,re,ne){var w=d("../scattergl/hover"),c=d("../scatterpolar/hover").makeHoverPointText;function M(T,e,a,n){var r=T.cd,t=r[0].t,f=t.r,o=t.theta,i=w.hoverPoints(T,e,a,n);if(!(!i||i[0].index===!1)){var g=i[0];if(g.index===void 0)return i;var p=T.subplot,y=g.cd[g.index],h=g.trace;if(y.r=f[g.index],y.theta=o[g.index],!!p.isPtInside(y))return g.xLabelVal=void 0,g.yLabelVal=void 0,c(y,h,p,g),i}}re.exports={hoverPoints:M}},{"../scattergl/hover":988,"../scatterpolar/hover":1006}],1015:[function(d,re,ne){arguments[4][896][0].apply(ne,arguments)},{"./base_index":1010,"./plot":1016,dup:896}],1016:[function(d,re,ne){var w=d("@plotly/point-cluster"),c=d("fast-isnumeric"),M=d("../scattergl/plot"),T=d("../scattergl/scene_update"),e=d("../scattergl/convert"),a=d("../../lib"),n=d("../scattergl/constants").TOO_MANY_POINTS,r={};re.exports=function(f,o,i){if(!!i.length){var g=o.radialAxis,p=o.angularAxis,y=T(f,o);return i.forEach(function(h){if(!(!h||!h[0]||!h[0].trace)){var m=h[0],u=m.trace,_=m.t,s=u._length,A=_.r,x=_.theta,v=_.opts,b,l=A.slice(),L=x.slice();for(b=0;b<A.length;b++)o.isPtInside({r:A[b],theta:x[b]})||(l[b]=NaN,L[b]=NaN);var S=new Array(s*2),k=Array(s),P=Array(s);for(b=0;b<s;b++){var z=l[b],I,D;if(c(z)){var R=g.c2g(z),B=p.c2g(L[b],u.thetaunit);I=R*Math.cos(B),D=R*Math.sin(B)}else I=D=NaN;k[b]=S[b*2]=I,P[b]=S[b*2+1]=D}_.tree=w(S),v.marker&&s>=n&&(v.marker.cluster=_.tree),v.marker&&(v.markerSel.positions=v.markerUnsel.positions=v.marker.positions=S),v.line&&S.length>1&&a.extendFlat(v.line,e.linePositions(f,u,S)),v.text&&(a.extendFlat(v.text,{positions:S},e.textPosition(f,u,v.text,v.marker)),a.extendFlat(v.textSel,{positions:S},e.textPosition(f,u,v.text,v.markerSel)),a.extendFlat(v.textUnsel,{positions:S},e.textPosition(f,u,v.text,v.markerUnsel))),v.fill&&!y.fill2d&&(y.fill2d=!0),v.marker&&!y.scatter2d&&(y.scatter2d=!0),v.line&&!y.line2d&&(y.line2d=!0),v.text&&!y.glText&&(y.glText=!0),y.lineOptions.push(v.line),y.fillOptions.push(v.fill),y.markerOptions.push(v.marker),y.markerSelectedOptions.push(v.markerSel),y.markerUnselectedOptions.push(v.markerUnsel),y.textOptions.push(v.text),y.textSelectedOptions.push(v.textSel),y.textUnselectedOptions.push(v.textUnsel),y.selectBatch.push([]),y.unselectBatch.push([]),_.x=k,_.y=P,_.rawx=k,_.rawy=P,_.r=A,_.theta=x,_.positions=S,_._scene=y,_.index=y.count,y.count++}}),M(f,o,i)}},re.exports.reglPrecompiled=r},{"../../lib":503,"../scattergl/constants":982,"../scattergl/convert":983,"../scattergl/plot":990,"../scattergl/scene_update":991,"@plotly/point-cluster":59,"fast-isnumeric":190}],1017:[function(d,re,ne){var w=d("../../plots/template_attributes").hovertemplateAttrs,c=d("../../plots/template_attributes").texttemplateAttrs,M=d("../../lib/extend").extendFlat,T=d("../scatter/attributes"),e=d("../../plots/attributes"),a=T.line;re.exports={mode:T.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:T.text,texttemplate:c({editType:"plot"},{keys:["real","imag","text"]}),hovertext:T.hovertext,line:{color:a.color,width:a.width,dash:a.dash,shape:M({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:T.connectgaps,marker:T.marker,cliponaxis:M({},T.cliponaxis,{dflt:!1}),textposition:T.textposition,textfont:T.textfont,fill:M({},T.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:T.fillcolor,hoverinfo:M({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:T.hoveron,hovertemplate:w(),selected:T.selected,unselected:T.unselected}},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":927}],1018:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../../constants/numerical").BADNUM,M=d("../scatter/colorscale_calc"),T=d("../scatter/arrays_to_calcdata"),e=d("../scatter/calc_selection"),a=d("../scatter/calc").calcMarkerSize;re.exports=function(r,t){for(var f=r._fullLayout,o=t.subplot,i=f[o].realaxis,g=f[o].imaginaryaxis,p=i.makeCalcdata(t,"real"),y=g.makeCalcdata(t,"imag"),h=t._length,m=new Array(h),u=0;u<h;u++){var _=p[u],s=y[u],A=m[u]={};w(_)&&w(s)?(A.real=_,A.imag=s):A.real=c}return a(t,h),M(r,t),T(m,t),e(m,t),m}},{"../../constants/numerical":479,"../scatter/arrays_to_calcdata":926,"../scatter/calc":928,"../scatter/calc_selection":929,"../scatter/colorscale_calc":930,"fast-isnumeric":190}],1019:[function(d,re,ne){var w=d("../../lib"),c=d("../scatter/subtypes"),M=d("../scatter/marker_defaults"),T=d("../scatter/line_defaults"),e=d("../scatter/line_shape_defaults"),a=d("../scatter/text_defaults"),n=d("../scatter/fillcolor_defaults"),r=d("../scatter/constants").PTS_LINESONLY,t=d("./attributes");re.exports=function(i,g,p,y){function h(_,s){return w.coerce(i,g,t,_,s)}var m=f(i,g,y,h);if(!m){g.visible=!1;return}h("mode",m<r?"lines+markers":"lines"),h("text"),h("hovertext"),g.hoveron!=="fills"&&h("hovertemplate"),c.hasLines(g)&&(T(i,g,p,y,h),e(i,g,h),h("connectgaps")),c.hasMarkers(g)&&M(i,g,p,y,h,{gradient:!0}),c.hasText(g)&&(h("texttemplate"),a(i,g,y,h));var u=[];(c.hasMarkers(g)||c.hasText(g))&&(h("cliponaxis"),h("marker.maxdisplayed"),u.push("points")),h("fill"),g.fill!=="none"&&(n(i,g,p,h),c.hasLines(g)||e(i,g,h)),(g.fill==="tonext"||g.fill==="toself")&&u.push("fills"),h("hoveron",u.join("+")||"points"),w.coerceSelectionMarkerOpacity(g,h)};function f(o,i,g,p){var y=p("real"),h=p("imag"),m;return y&&h&&(m=Math.min(y.length,h.length)),i._length=m,m}},{"../../lib":503,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/line_shape_defaults":942,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":1017}],1020:[function(d,re,ne){var w=d("../../plots/cartesian/axes");re.exports=function(M,T,e){var a={},n=e[T.subplot]._subplot;return a.realLabel=w.tickText(n.radialAxis,M.real,!0).text,a.imagLabel=w.tickText(n.angularAxis,M.imag,!0).text,a}},{"../../plots/cartesian/axes":554}],1021:[function(d,re,ne){var w=d("../scatter/hover");function c(T,e,a,n){var r=w(T,e,a,n);if(!(!r||r[0].index===!1)){var t=r[0];if(t.index===void 0)return r;var f=T.subplot,o=t.cd[t.index],i=t.trace;if(!!f.isPtInside(o))return t.xLabelVal=void 0,t.yLabelVal=void 0,M(o,i,f,t),t.hovertemplate=i.hovertemplate,r}}function M(T,e,a,n){var r=a.radialAxis,t=a.angularAxis;r._hovertitle="real",t._hovertitle="imag";var f={};f[e.subplot]={_subplot:a};var o=e._module.formatLabels(T,e,f);n.realLabel=o.realLabel,n.imagLabel=o.imagLabel;var i=T.hi||e.hoverinfo,g=[];function p(h,m){g.push(h._hovertitle+": "+m)}if(!e.hovertemplate){var y=i.split("+");y.indexOf("all")!==-1&&(y=["real","imag","text"]),y.indexOf("real")!==-1&&p(r,n.realLabel),y.indexOf("imag")!==-1&&p(t,n.imagLabel),y.indexOf("text")!==-1&&n.text&&(g.push(n.text),delete n.text),n.extraText=g.join("<br>")}}re.exports={hoverPoints:c,makeHoverPointText:M}},{"../scatter/hover":938}],1022:[function(d,re,ne){re.exports={moduleType:"trace",name:"scattersmith",basePlotModule:d("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover").hoverPoints,selectPoints:d("../scatter/select"),meta:{}}},{"../../plots/smith":629,"../scatter/marker_colorbar":945,"../scatter/select":949,"../scatter/style":951,"./attributes":1017,"./calc":1018,"./defaults":1019,"./format_labels":1020,"./hover":1021,"./plot":1023}],1023:[function(d,re,ne){var w=d("../scatter/plot"),c=d("../../constants/numerical").BADNUM,M=d("../../plots/smith/helpers"),T=M.smith;re.exports=function(a,n,r){for(var t=n.layers.frontplot.select("g.scatterlayer"),f={xaxis:n.xaxis,yaxis:n.yaxis,plot:n.framework,layerClipId:n._hasClipOnAxisFalse?n.clipIds.forTraces:null},o=0;o<r.length;o++)for(var i=r[o],g=0;g<i.length;g++){var p=i[g],y=p.real;if(y===c)p.x=p.y=c;else{var h=T([y,p.imag]);p.x=h[0],p.y=h[1]}}w(a,f,r,t)}},{"../../constants/numerical":479,"../../plots/smith/helpers":628,"../scatter/plot":948}],1024:[function(d,re,ne){var w=d("../../plots/template_attributes").hovertemplateAttrs,c=d("../../plots/template_attributes").texttemplateAttrs,M=d("../scatter/attributes"),T=d("../../plots/attributes"),e=d("../../components/colorscale/attributes"),a=d("../../components/drawing/attributes").dash,n=d("../../lib/extend").extendFlat,r=M.marker,t=M.line,f=r.line;re.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:n({},M.mode,{dflt:"markers"}),text:n({},M.text,{}),texttemplate:c({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:n({},M.hovertext,{}),line:{color:t.color,width:t.width,dash:a,shape:n({},t.shape,{values:["linear","spline"]}),smoothing:t.smoothing,editType:"calc"},connectgaps:M.connectgaps,cliponaxis:M.cliponaxis,fill:n({},M.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:M.fillcolor,marker:n({symbol:r.symbol,opacity:r.opacity,maxdisplayed:r.maxdisplayed,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,line:n({width:f.width,editType:"calc"},e("marker.line")),gradient:r.gradient,editType:"calc"},e("marker")),textfont:M.textfont,textposition:M.textposition,selected:M.selected,unselected:M.unselected,hoverinfo:n({},T.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:M.hoveron,hovertemplate:w()}},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":927}],1025:[function(d,re,ne){var w=d("fast-isnumeric"),c=d("../scatter/colorscale_calc"),M=d("../scatter/arrays_to_calcdata"),T=d("../scatter/calc_selection"),e=d("../scatter/calc").calcMarkerSize,a=["a","b","c"],n={a:["b","c"],b:["a","c"],c:["a","b"]};re.exports=function(t,f){var o=t._fullLayout[f.subplot],i=o.sum,g=f.sum||i,p={a:f.a,b:f.b,c:f.c},y,h,m,u,_,s;for(y=0;y<a.length;y++)if(m=a[y],!p[m]){for(_=p[n[m][0]],s=p[n[m][1]],u=new Array(_.length),h=0;h<_.length;h++)u[h]=g-_[h]-s[h];p[m]=u}var A=f._length,x=new Array(A),v,b,l,L,S,k;for(y=0;y<A;y++)v=p.a[y],b=p.b[y],l=p.c[y],w(v)&&w(b)&&w(l)?(v=+v,b=+b,l=+l,L=i/(v+b+l),L!==1&&(v*=L,b*=L,l*=L),k=v,S=l-b,x[y]={x:S,y:k,a:v,b,c:l}):x[y]={x:!1,y:!1};return e(f,A),c(t,f),M(x,f),T(x,f),x}},{"../scatter/arrays_to_calcdata":926,"../scatter/calc":928,"../scatter/calc_selection":929,"../scatter/colorscale_calc":930,"fast-isnumeric":190}],1026:[function(d,re,ne){var w=d("../../lib"),c=d("../scatter/constants"),M=d("../scatter/subtypes"),T=d("../scatter/marker_defaults"),e=d("../scatter/line_defaults"),a=d("../scatter/line_shape_defaults"),n=d("../scatter/text_defaults"),r=d("../scatter/fillcolor_defaults"),t=d("./attributes");re.exports=function(o,i,g,p){function y(x,v){return w.coerce(o,i,t,x,v)}var h=y("a"),m=y("b"),u=y("c"),_;if(h?(_=h.length,m?(_=Math.min(_,m.length),u&&(_=Math.min(_,u.length))):u?_=Math.min(_,u.length):_=0):m&&u&&(_=Math.min(m.length,u.length)),!_){i.visible=!1;return}i._length=_,y("sum"),y("text"),y("hovertext"),i.hoveron!=="fills"&&y("hovertemplate");var s=_<c.PTS_LINESONLY?"lines+markers":"lines";y("mode",s),M.hasLines(i)&&(e(o,i,g,p,y),a(o,i,y),y("connectgaps")),M.hasMarkers(i)&&T(o,i,g,p,y,{gradient:!0}),M.hasText(i)&&(y("texttemplate"),n(o,i,p,y));var A=[];(M.hasMarkers(i)||M.hasText(i))&&(y("cliponaxis"),y("marker.maxdisplayed"),A.push("points")),y("fill"),i.fill!=="none"&&(r(o,i,g,y),M.hasLines(i)||a(o,i,y)),(i.fill==="tonext"||i.fill==="toself")&&A.push("fills"),y("hoveron",A.join("+")||"points"),w.coerceSelectionMarkerOpacity(i,y)}},{"../../lib":503,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/line_shape_defaults":942,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":1024}],1027:[function(d,re,ne){re.exports=function(c,M,T,e,a){if(M.xa&&(c.xaxis=M.xa),M.ya&&(c.yaxis=M.ya),e[a]){var n=e[a];c.a=n.a,c.b=n.b,c.c=n.c}else c.a=M.a,c.b=M.b,c.c=M.c;return c}},{}],1028:[function(d,re,ne){var w=d("../../plots/cartesian/axes");re.exports=function(M,T,e){var a={},n=e[T.subplot]._subplot;return a.aLabel=w.tickText(n.aaxis,M.a,!0).text,a.bLabel=w.tickText(n.baxis,M.b,!0).text,a.cLabel=w.tickText(n.caxis,M.c,!0).text,a}},{"../../plots/cartesian/axes":554}],1029:[function(d,re,ne){var w=d("../scatter/hover");re.exports=function(M,T,e,a){var n=w(M,T,e,a);if(!n||n[0].index===!1)return;var r=n[0];if(r.index===void 0){var t=1-r.y0/M.ya._length,f=M.xa._length,o=f*t/2,i=f-o;return r.x0=Math.max(Math.min(r.x0,i),o),r.x1=Math.max(Math.min(r.x1,i),o),n}var g=r.cd[r.index],p=r.trace,y=r.subplot;r.a=g.a,r.b=g.b,r.c=g.c,r.xLabelVal=void 0,r.yLabelVal=void 0;var h={};h[p.subplot]={_subplot:y};var m=p._module.formatLabels(g,p,h);r.aLabel=m.aLabel,r.bLabel=m.bLabel,r.cLabel=m.cLabel;var u=g.hi||p.hoverinfo,_=[];function s(x,v){_.push(x._hovertitle+": "+v)}if(!p.hovertemplate){var A=u.split("+");A.indexOf("all")!==-1&&(A=["a","b","c"]),A.indexOf("a")!==-1&&s(y.aaxis,r.aLabel),A.indexOf("b")!==-1&&s(y.baxis,r.bLabel),A.indexOf("c")!==-1&&s(y.caxis,r.cLabel)}return r.extraText=_.join("<br>"),r.hovertemplate=p.hovertemplate,n}},{"../scatter/hover":938}],1030:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),formatLabels:d("./format_labels"),calc:d("./calc"),plot:d("./plot"),style:d("../scatter/style").style,styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../scatter/select"),eventData:d("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:d("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":634,"../scatter/marker_colorbar":945,"../scatter/select":949,"../scatter/style":951,"./attributes":1024,"./calc":1025,"./defaults":1026,"./event_data":1027,"./format_labels":1028,"./hover":1029,"./plot":1031}],1031:[function(d,re,ne){var w=d("../scatter/plot");re.exports=function(M,T,e){var a=T.plotContainer;a.select(".scatterlayer").selectAll("*").remove();var n={xaxis:T.xaxis,yaxis:T.yaxis,plot:a,layerClipId:T._hasClipOnAxisFalse?T.clipIdRelative:null},r=T.layers.frontplot.select("g.scatterlayer");w(M,n,e,r)}},{"../scatter/plot":948}],1032:[function(d,re,ne){var w=d("../scatter/attributes"),c=d("../../components/colorscale/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,T=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../scattergl/attributes"),a=d("../../plots/cartesian/constants").idRegex,n=d("../../plot_api/plot_template").templatedArray,r=d("../../lib/extend").extendFlat,t=w.marker,f=t.line,o=r(c("marker.line",{editTypeOverride:"calc"}),{width:r({},f.width,{editType:"calc"}),editType:"calc"}),i=r(c("marker"),{symbol:t.symbol,size:r({},t.size,{editType:"markerSize"}),sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,opacity:t.opacity,colorbar:t.colorbar,line:o,editType:"calc"});i.color.editType=i.cmin.editType=i.cmax.editType="style";function g(p){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:a[p],editType:"plot"}}}re.exports={dimensions:n("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:r({},e.text,{}),hovertext:r({},e.hovertext,{}),hovertemplate:T(),xhoverformat:M("x"),yhoverformat:M("y"),marker:i,xaxes:g("x"),yaxes:g("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_format_attributes":557,"../../plots/cartesian/constants":561,"../../plots/template_attributes":633,"../scatter/attributes":927,"../scattergl/attributes":979}],1033:[function(d,re,ne){var w=d("../../registry"),c=d("../../components/grid");re.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:d("../scatter/marker_colorbar"),calc:d("./calc"),plot:d("./plot"),hoverPoints:d("./hover").hoverPoints,selectPoints:d("./select"),editStyle:d("./edit_style"),meta:{}},w.register(c)},{"../../components/grid":410,"../../registry":638,"../scatter/marker_colorbar":945,"./attributes":1032,"./calc":1035,"./defaults":1036,"./edit_style":1037,"./hover":1039,"./plot":1041,"./select":1043}],1034:[function(d,re,ne){var w=d("regl-line2d"),c=d("../../registry"),M=d("../../lib/prepare_regl"),T=d("../../plots/get_data").getModuleCalcData,e=d("../../plots/cartesian"),a=d("../../plots/cartesian/axis_ids").getFromId,n=d("../../plots/cartesian/axes").shouldShowZeroLine,r="splom",t={};function f(h){var m=h._fullLayout,u=c.getModule(r),_=T(h.calcdata,u)[0],s=M(h,["ANGLE_instanced_arrays","OES_element_index_uint"],t);!s||(m._hasOnlyLargeSploms&&g(h),u.plot(h,{},_))}function o(h){var m=h.calcdata,u=h._fullLayout;u._hasOnlyLargeSploms&&g(h);for(var _=0;_<m.length;_++){var s=m[_][0],A=s.trace,x=u._splomScenes[A.uid];A.type==="splom"&&x&&x.matrix&&i(h,A,x)}}function i(h,m,u){for(var _=u.matrixOptions.data.length,s=m._visibleDims,A=u.viewOpts.ranges=new Array(_),x=0;x<s.length;x++){var v=s[x],b=A[x]=new Array(4),l=a(h,m._diag[v][0]);l&&(b[0]=l.r2l(l.range[0]),b[2]=l.r2l(l.range[1]));var L=a(h,m._diag[v][1]);L&&(b[1]=L.r2l(L.range[0]),b[3]=L.r2l(L.range[1]))}u.selectBatch.length||u.unselectBatch.length?u.matrix.update({ranges:A},{ranges:A}):u.matrix.update({ranges:A})}function g(h){var m=h._fullLayout,u=m._glcanvas.data()[0].regl,_=m._splomGrid;_||(_=m._splomGrid=w(u)),_.update(p(h))}function p(h){var m=h._context.plotGlPixelRatio,u=h._fullLayout,_=u._size,s=[0,0,u.width*m,u.height*m],A={},x;function v(J,j,Y,X,oe,se){Y*=m,X*=m,oe*=m,se*=m;var ie=j[J+"color"],N=j[J+"width"],U=String(ie+N);U in A?A[U].data.push(NaN,NaN,Y,X,oe,se):A[U]={data:[Y,X,oe,se],join:"rect",thickness:N*m,color:ie,viewport:s,range:s,overlay:!1}}for(x in u._splomSubplots){var b=u._plots[x],l=b.xaxis,L=b.yaxis,S=l._gridVals,k=L._gridVals,P=l._offset,z=l._length,I=L._length,D=_.b+L.domain[0]*_.h,R=-L._m,B=-R*L.r2l(L.range[0],L.calendar),F,V;if(l.showgrid)for(x=0;x<S.length;x++)F=P+l.l2p(S[x].x),v("grid",l,F,D,F,D+I);if(L.showgrid)for(x=0;x<k.length;x++)V=D+B+R*k[x].x,v("grid",L,P,V,P+z,V);n(h,l,L)&&(F=P+l.l2p(0),v("zeroline",l,F,D,F,D+I)),n(h,L,l)&&(V=D+B+0,v("zeroline",L,P,V,P+z,V))}var G=[];for(x in A)G.push(A[x]);return G}function y(h,m,u,_){var s={},A;if(_._splomScenes){for(A=0;A<h.length;A++){var x=h[A];x.type==="splom"&&(s[x.uid]=1)}for(A=0;A<u.length;A++){var v=u[A];if(!s[v.uid]){var b=_._splomScenes[v.uid];b&&b.destroy&&b.destroy(),_._splomScenes[v.uid]=null,delete _._splomScenes[v.uid]}}}Object.keys(_._splomScenes||{}).length===0&&delete _._splomScenes,_._splomGrid&&!m._hasOnlyLargeSploms&&_._hasOnlyLargeSploms&&(_._splomGrid.destroy(),_._splomGrid=null,delete _._splomGrid),e.clean(h,m,u,_)}re.exports={name:r,attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:f,drag:o,updateGrid:g,clean:y,updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:t}},{"../../lib/prepare_regl":516,"../../plots/cartesian":568,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_ids":558,"../../plots/get_data":593,"../../registry":638,"regl-line2d":280}],1035:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axis_ids"),M=d("../scatter/calc").calcMarkerSize,T=d("../scatter/calc").calcAxisExpansion,e=d("../scatter/colorscale_calc"),a=d("../scattergl/convert").markerSelection,n=d("../scattergl/convert").markerStyle,r=d("./scene_update"),t=d("../../constants/numerical").BADNUM,f=d("../scattergl/constants").TOO_MANY_POINTS;re.exports=function(i,g){var p=g.dimensions,y=g._length,h={},m=h.cdata=[],u=h.data=[],_=g._visibleDims=[],s,A,x,v,b;function l(z,I){for(var D=z.makeCalcdata({v:I.values,vcalendar:g.calendar},"v"),R=0;R<D.length;R++)D[R]=D[R]===t?NaN:D[R];m.push(D),u.push(z.type==="log"?w.simpleMap(D,z.c2l):D)}for(s=0;s<p.length;s++)if(x=p[s],x.visible){if(v=c.getFromId(i,g._diag[s][0]),b=c.getFromId(i,g._diag[s][1]),v&&b&&v.type!==b.type){w.log("Skipping splom dimension "+s+" with conflicting axis types");continue}v?(l(v,x),b&&b.type==="category"&&(b._categories=v._categories.slice())):l(b,x),_.push(s)}e(i,g),w.extendFlat(h,n(g));var L=m.length,S=L*y>f,k;for(S?k=h.sizeAvg||Math.max(h.size,3):k=M(g,y),A=0;A<_.length;A++)s=_[A],x=p[s],v=c.getFromId(i,g._diag[s][0])||{},b=c.getFromId(i,g._diag[s][1])||{},T(i,g,v,b,m[A],m[A],k);var P=r(i,g);return P.matrix||(P.matrix=!0),P.matrixOptions=h,P.selectedOptions=a(g,g.selected),P.unselectedOptions=a(g,g.unselected),[{x:!1,y:!1,t:{},trace:g}]}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axis_ids":558,"../scatter/calc":928,"../scatter/colorscale_calc":930,"../scattergl/constants":982,"../scattergl/convert":983,"./scene_update":1042}],1036:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/array_container_defaults"),M=d("./attributes"),T=d("../scatter/subtypes"),e=d("../scatter/marker_defaults"),a=d("../parcoords/merge_length"),n=d("../scattergl/helpers").isOpenSymbol;re.exports=function(o,i,g,p){function y(v,b){return w.coerce(o,i,M,v,b)}var h=c(o,i,{name:"dimensions",handleItemDefaults:r}),m=y("diagonal.visible"),u=y("showupperhalf"),_=y("showlowerhalf"),s=a(i,h,"values");if(!s||!m&&!u&&!_){i.visible=!1;return}y("text"),y("hovertext"),y("hovertemplate"),y("xhoverformat"),y("yhoverformat"),e(o,i,g,p,y);var A=n(i.marker.symbol),x=T.isBubble(i);y("marker.line.width",A||x?1:0),t(o,i,p,y),w.coerceSelectionMarkerOpacity(i,y)};function r(f,o){function i(p,y){return w.coerce(f,o,M.dimensions,p,y)}i("label");var g=i("values");g&&g.length?i("visible"):o.visible=!1,i("axis.type"),i("axis.matches")}function t(f,o,i,g){var p=o.dimensions,y=p.length,h=o.showupperhalf,m=o.showlowerhalf,u=o.diagonal.visible,_,s,A=new Array(y),x=new Array(y);for(_=0;_<y;_++){var v=_?_+1:"";A[_]="x"+v,x[_]="y"+v}var b=g("xaxes",A),l=g("yaxes",x),L=o._diag=new Array(y);o._xaxes={},o._yaxes={};var S=[],k=[];function P(J,j,Y,X){if(!!J){var oe=J.charAt(0),se=i._splomAxes[oe];if(o["_"+oe+"axes"][J]=1,X.push(J),!(J in se)){var ie=se[J]={};Y&&(ie.label=Y.label||"",Y.visible&&Y.axis&&(Y.axis.type&&(ie.type=Y.axis.type),Y.axis.matches&&(ie.matches=j)))}}}var z=!u&&!m,I=!u&&!h;for(o._axesDim={},_=0;_<y;_++){var D=p[_],R=_===0,B=_===y-1,F=R&&z||B&&I?void 0:b[_],V=R&&I||B&&z?void 0:l[_];P(F,V,D,S),P(V,F,D,k),L[_]=[F,V],o._axesDim[F]=_,o._axesDim[V]=_}for(_=0;_<S.length;_++)for(s=0;s<k.length;s++){var G=S[_]+k[s];(_>s&&h||_<s&&m||_===s&&(u||!m||!h))&&(i._splomSubplots[G]=1)}(!m||!u&&h&&m)&&(i._splomGridDflt.xside="bottom",i._splomGridDflt.yside="left")}},{"../../lib":503,"../../plots/array_container_defaults":549,"../parcoords/merge_length":898,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scattergl/helpers":987,"./attributes":1032}],1037:[function(d,re,ne){var w=d("../../lib"),c=d("../scatter/colorscale_calc"),M=d("../scattergl/convert").markerStyle;re.exports=function(e,a){var n=a.trace,r=e._fullLayout._splomScenes[n.uid];if(r){c(e,n),w.extendFlat(r.matrixOptions,M(n));var t=w.extendFlat({},r.matrixOptions,r.viewOpts);r.matrix.update(t,null)}}},{"../../lib":503,"../scatter/colorscale_calc":930,"../scattergl/convert":983}],1038:[function(d,re,ne){ne.getDimIndex=function(c,M){for(var T=M._id,e=T.charAt(0),a={x:0,y:1}[e],n=c._visibleDims,r=0;r<n.length;r++){var t=n[r];if(c._diag[t][a]===T)return r}return!1}},{}],1039:[function(d,re,ne){var w=d("./helpers"),c=d("../scattergl/hover").calcHover;function M(T,e,a){var n=T.cd,r=n[0].trace,t=T.scene,f=t.matrixOptions.cdata,o=T.xa,i=T.ya,g=o.c2p(e),p=i.c2p(a),y=T.distance,h=w.getDimIndex(r,o),m=w.getDimIndex(r,i);if(h===!1||m===!1)return[T];for(var u=f[h],_=f[m],s,A,x=y,v=0;v<u.length;v++){var b=u[v],l=_[v],L=o.c2p(b)-g,S=i.c2p(l)-p,k=Math.sqrt(L*L+S*S);k<x&&(x=A=k,s=v)}return T.index=s,T.distance=x,T.dxy=A,s===void 0?[T]:[c(T,u,_,r)]}re.exports={hoverPoints:M}},{"../scattergl/hover":988,"./helpers":1038}],1040:[function(d,re,ne){var w=d("./base_index");w.basePlotModule=d("./base_plot"),re.exports=w},{"./base_index":1033,"./base_plot":1034}],1041:[function(d,re,ne){var w=d("regl-splom"),c=d("../../lib"),M=d("../../plots/cartesian/axis_ids"),T=d("../../components/dragelement/helpers").selectMode;re.exports=function(n,r,t){if(!!t.length)for(var f=0;f<t.length;f++)e(n,t[f][0])};function e(a,n){var r=a._fullLayout,t=r._size,f=n.trace,o=n.t,i=r._splomScenes[f.uid],g=i.matrixOptions,p=g.cdata,y=r._glcanvas.data()[0].regl,h=r.dragmode,m,u,_,s,A;if(p.length!==0){g.lower=f.showupperhalf,g.upper=f.showlowerhalf,g.diagonal=f.diagonal.visible;var x=f._visibleDims,v=p.length,b=i.viewOpts={};for(b.ranges=new Array(v),b.domains=new Array(v),A=0;A<x.length;A++){_=x[A];var l=b.ranges[A]=new Array(4),L=b.domains[A]=new Array(4);m=M.getFromId(a,f._diag[_][0]),m&&(l[0]=m._rl[0],l[2]=m._rl[1],L[0]=m.domain[0],L[2]=m.domain[1]),u=M.getFromId(a,f._diag[_][1]),u&&(l[1]=u._rl[0],l[3]=u._rl[1],L[1]=u.domain[0],L[3]=u.domain[1])}var S=a._context.plotGlPixelRatio,k=t.l*S,P=t.b*S,z=t.w*S,I=t.h*S;b.viewport=[k,P,z+k,I+P],i.matrix===!0&&(i.matrix=w(y));var D=r.clickmode.indexOf("select")>-1,R=T(h)||!!f.selectedpoints||D,B=!0;if(R){var F=f._length;if(f.selectedpoints){i.selectBatch=f.selectedpoints;var V=f.selectedpoints,G={};for(_=0;_<V.length;_++)G[V[_]]=!0;var J=[];for(_=0;_<F;_++)G[_]||J.push(_);i.unselectBatch=J}var j=o.xpx=new Array(v),Y=o.ypx=new Array(v);for(A=0;A<x.length;A++){if(_=x[A],m=M.getFromId(a,f._diag[_][0]),m)for(j[A]=new Array(F),s=0;s<F;s++)j[A][s]=m.c2p(p[A][s]);if(u=M.getFromId(a,f._diag[_][1]),u)for(Y[A]=new Array(F),s=0;s<F;s++)Y[A][s]=u.c2p(p[A][s])}if(i.selectBatch.length||i.unselectBatch.length){var X=c.extendFlat({},g,i.unselectedOptions,b),oe=c.extendFlat({},g,i.selectedOptions,b);i.matrix.update(X,oe),B=!1}}else o.xpx=o.ypx=null;if(B){var se=c.extendFlat({},g,b);i.matrix.update(se,null)}}}},{"../../components/dragelement/helpers":384,"../../lib":503,"../../plots/cartesian/axis_ids":558,"regl-splom":282}],1042:[function(d,re,ne){var w=d("../../lib");re.exports=function(M,T){var e=M._fullLayout,a=T.uid,n=e._splomScenes;n||(n=e._splomScenes={});var r={dirty:!0,selectBatch:[],unselectBatch:[]},t={matrix:!1,selectBatch:[],unselectBatch:[]},f=n[T.uid];return f||(f=n[a]=w.extendFlat({},r,t),f.draw=function(){f.matrix&&f.matrix.draw&&(f.selectBatch.length||f.unselectBatch.length?f.matrix.draw(f.unselectBatch,f.selectBatch):f.matrix.draw()),f.dirty=!1},f.destroy=function(){f.matrix&&f.matrix.destroy&&f.matrix.destroy(),f.matrixOptions=null,f.selectBatch=null,f.unselectBatch=null,f=null}),f.dirty||w.extendFlat(f,r),f}},{"../../lib":503}],1043:[function(d,re,ne){var w=d("../../lib"),c=d("../scatter/subtypes"),M=d("./helpers");re.exports=function(e,a){var n=e.cd,r=n[0].trace,t=n[0].t,f=e.scene,o=f.matrixOptions.cdata,i=e.xaxis,g=e.yaxis,p=[];if(!f)return p;var y=!c.hasMarkers(r)&&!c.hasText(r);if(r.visible!==!0||y)return p;var h=M.getDimIndex(r,i),m=M.getDimIndex(r,g);if(h===!1||m===!1)return p;var u=t.xpx[h],_=t.ypx[m],s=o[h],A=o[m],x=[],v=[];if(a!==!1&&!a.degenerate)for(var b=0;b<s.length;b++)a.contains([u[b],_[b]],null,b,e)?(x.push(b),p.push({pointNumber:b,x:s[b],y:A[b]})):v.push(b);var l=f.matrixOptions;return!x.length&&!v.length?f.matrix.update(l,null):!f.selectBatch.length&&!f.unselectBatch.length&&f.matrix.update(f.unselectedOptions,w.extendFlat({},l,f.selectedOptions,f.viewOpts)),f.selectBatch=x,f.unselectBatch=v,p}},{"../../lib":503,"../scatter/subtypes":952,"./helpers":1038}],1044:[function(d,re,ne){var w=d("../../components/colorscale/attributes"),c=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,M=d("../../plots/template_attributes").hovertemplateAttrs,T=d("../mesh3d/attributes"),e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:M({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:c("u",1),vhoverformat:c("v",1),whoverformat:c("w",1),xhoverformat:c("x"),yhoverformat:c("y"),zhoverformat:c("z"),showlegend:a({},e.showlegend,{dflt:!1})};a(n,w("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var r=["opacity","lightposition","lighting"];r.forEach(function(t){n[t]=T[t]}),n.hoverinfo=a({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,re.exports=n},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../mesh3d/attributes":867}],1045:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/colorscale/calc");function M(n,r){r._len=Math.min(r.u.length,r.v.length,r.w.length,r.x.length,r.y.length,r.z.length),r._u=a(r.u,r._len),r._v=a(r.v,r._len),r._w=a(r.w,r._len),r._x=a(r.x,r._len),r._y=a(r.y,r._len),r._z=a(r.z,r._len);var t=T(r);r._gridFill=t.fill,r._Xs=t.Xs,r._Ys=t.Ys,r._Zs=t.Zs,r._len=t.len;var f=0,o,i,g;r.starts&&(o=a(r.starts.x||[]),i=a(r.starts.y||[]),g=a(r.starts.z||[]),f=Math.min(o.length,i.length,g.length)),r._startsX=o||[],r._startsY=i||[],r._startsZ=g||[];var p=0,y=1/0,h;for(h=0;h<r._len;h++){var m=r._u[h],u=r._v[h],_=r._w[h],s=Math.sqrt(m*m+u*u+_*_);p=Math.max(p,s),y=Math.min(y,s)}for(c(n,r,{vals:[y,p],containerStr:"",cLetter:"c"}),h=0;h<f;h++){var A=o[h];t.xMax=Math.max(t.xMax,A),t.xMin=Math.min(t.xMin,A);var x=i[h];t.yMax=Math.max(t.yMax,x),t.yMin=Math.min(t.yMin,x);var v=g[h];t.zMax=Math.max(t.zMax,v),t.zMin=Math.min(t.zMin,v)}r._slen=f,r._normMax=p,r._xbnds=[t.xMin,t.xMax],r._ybnds=[t.yMin,t.yMax],r._zbnds=[t.zMin,t.zMax]}function T(n){var r=n._x,t=n._y,f=n._z,o=n._len,i,g,p,y=-1/0,h=1/0,m=-1/0,u=1/0,_=-1/0,s=1/0,A="",x,v,b,l,L,S,k,P,z;for(o&&(l=r[0],S=t[0],P=f[0]),o>1&&(L=r[o-1],k=t[o-1],z=f[o-1]),i=0;i<o;i++)y=Math.max(y,r[i]),h=Math.min(h,r[i]),m=Math.max(m,t[i]),u=Math.min(u,t[i]),_=Math.max(_,f[i]),s=Math.min(s,f[i]),!x&&r[i]!==l&&(x=!0,A+="x"),!v&&t[i]!==S&&(v=!0,A+="y"),!b&&f[i]!==P&&(b=!0,A+="z");x||(A+="x"),v||(A+="y"),b||(A+="z");var I=e(n._x),D=e(n._y),R=e(n._z);A=A.replace("x",(l>L?"-":"+")+"x"),A=A.replace("y",(S>k?"-":"+")+"y"),A=A.replace("z",(P>z?"-":"+")+"z");var B=function(){o=0,I=[],D=[],R=[]};(!o||o<I.length*D.length*R.length)&&B();var F=function(ae){return ae==="x"?r:ae==="y"?t:f},V=function(ae){return ae==="x"?I:ae==="y"?D:R},G=function(ae){return ae[o-1]<ae[0]?-1:1},J=F(A[1]),j=F(A[3]),Y=F(A[5]),X=V(A[1]).length,oe=V(A[3]).length,se=V(A[5]).length,ie=!1,N=function(ae,le,ye){return X*(oe*ae+le)+ye},U=G(F(A[1])),q=G(F(A[3])),Q=G(F(A[5]));for(i=0;i<se-1;i++){for(g=0;g<oe-1;g++){for(p=0;p<X-1;p++){var W=N(i,g,p),Z=N(i,g,p+1),ee=N(i,g+1,p),te=N(i+1,g,p);if((!(J[W]*U<J[Z]*U)||!(j[W]*q<j[ee]*q)||!(Y[W]*Q<Y[te]*Q))&&(ie=!0),ie)break}if(ie)break}if(ie)break}return ie&&(w.warn("Encountered arbitrary coordinates! Unable to input data grid."),B()),{xMin:h,yMin:u,zMin:s,xMax:y,yMax:m,zMax:_,Xs:I,Ys:D,Zs:R,len:o,fill:A}}function e(n){return w.distinctVals(n).vals}function a(n,r){if(r===void 0&&(r=n.length),w.isTypedArray(n))return n.subarray(0,r);for(var t=[],f=0;f<r;f++)t[f]=+n[f];return t}re.exports={calc:M,filter:a,processGrid:T}},{"../../components/colorscale/calc":374,"../../lib":503}],1046:[function(d,re,ne){var w=d("../../../stackgl_modules").gl_streamtube3d,c=w.createTubeMesh,M=d("../../lib"),T=d("../../lib/gl_format_color").parseColorScale,e=d("../../components/colorscale").extractOpts,a=d("../../plots/gl3d/zip3"),n={xaxis:0,yaxis:1,zaxis:2};function r(p,y){this.scene=p,this.uid=y,this.mesh=null,this.data=null}var t=r.prototype;t.handlePick=function(p){var y=this.scene.fullSceneLayout,h=this.scene.dataScale;function m(s,A){var x=y[A],v=h[n[A]];return x.l2c(s)/v}if(p.object===this.mesh){var u=p.data.position,_=p.data.velocity;return p.traceCoordinate=[m(u[0],"xaxis"),m(u[1],"yaxis"),m(u[2],"zaxis"),m(_[0],"xaxis"),m(_[1],"yaxis"),m(_[2],"zaxis"),p.data.intensity*this.data._normMax,p.data.divergence],p.textLabel=this.data.hovertext||this.data.text,!0}};function f(p){var y=p.length,h;return y>2?h=p.slice(1,y-1):y===2?h=[(p[0]+p[1])/2]:h=p,h}function o(p){var y=p.length;return y===1?[.5,.5]:[p[1]-p[0],p[y-1]-p[y-2]]}function i(p,y){var h=p.fullSceneLayout,m=p.dataScale,u=y._len,_={};function s(oe,se){var ie=h[se],N=m[n[se]];return M.simpleMap(oe,function(U){return ie.d2l(U)*N})}if(_.vectors=a(s(y._u,"xaxis"),s(y._v,"yaxis"),s(y._w,"zaxis"),u),!u)return{positions:[],cells:[]};var A=s(y._Xs,"xaxis"),x=s(y._Ys,"yaxis"),v=s(y._Zs,"zaxis");_.meshgrid=[A,x,v],_.gridFill=y._gridFill;var b=y._slen;if(b)_.startingPositions=a(s(y._startsX,"xaxis"),s(y._startsY,"yaxis"),s(y._startsZ,"zaxis"));else{for(var l=x[0],L=f(A),S=f(v),k=new Array(L.length*S.length),P=0,z=0;z<L.length;z++)for(var I=0;I<S.length;I++)k[P++]=[L[z],l,S[I]];_.startingPositions=k}_.colormap=T(y),_.tubeSize=y.sizeref,_.maxLength=y.maxdisplayed;var D=s(y._xbnds,"xaxis"),R=s(y._ybnds,"yaxis"),B=s(y._zbnds,"zaxis"),F=o(A),V=o(x),G=o(v),J=[[D[0]-F[0],R[0]-V[0],B[0]-G[0]],[D[1]+F[1],R[1]+V[1],B[1]+G[1]]],j=w(_,J),Y=e(y);j.vertexIntensityBounds=[Y.min/y._normMax,Y.max/y._normMax];var X=y.lightposition;return j.lightPosition=[X.x,X.y,X.z],j.ambient=y.lighting.ambient,j.diffuse=y.lighting.diffuse,j.specular=y.lighting.specular,j.roughness=y.lighting.roughness,j.fresnel=y.lighting.fresnel,j.opacity=y.opacity,y._pad=j.tubeScale*y.sizeref*2,j}t.update=function(p){this.data=p;var y=i(this.scene,p);this.mesh.update(y)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function g(p,y){var h=p.glplot.gl,m=i(p,y),u=c(h,m),_=new r(p,y.uid);return _.mesh=u,_.data=y,u._trace=_,p.glplot.add(u),_}re.exports=g},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib":503,"../../lib/gl_format_color":499,"../../plots/gl3d/zip3":609}],1047:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/colorscale/defaults"),M=d("./attributes");re.exports=function(e,a,n,r){function t(h,m){return w.coerce(e,a,M,h,m)}var f=t("u"),o=t("v"),i=t("w"),g=t("x"),p=t("y"),y=t("z");if(!f||!f.length||!o||!o.length||!i||!i.length||!g||!g.length||!p||!p.length||!y||!y.length){a.visible=!1;return}t("starts.x"),t("starts.y"),t("starts.z"),t("maxdisplayed"),t("sizeref"),t("lighting.ambient"),t("lighting.diffuse"),t("lighting.specular"),t("lighting.roughness"),t("lighting.fresnel"),t("lightposition.x"),t("lightposition.y"),t("lightposition.z"),c(e,a,r,t,{prefix:"",cLetter:"c"}),t("text"),t("hovertext"),t("hovertemplate"),t("uhoverformat"),t("vhoverformat"),t("whoverformat"),t("xhoverformat"),t("yhoverformat"),t("zhoverformat"),a._length=null}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":1044}],1048:[function(d,re,ne){re.exports={moduleType:"trace",name:"streamtube",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:d("./attributes"),supplyDefaults:d("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:d("./calc").calc,plot:d("./convert"),eventData:function(w,c){return w.tubex=w.x,w.tubey=w.y,w.tubez=w.z,w.tubeu=c.traceCoordinate[3],w.tubev=c.traceCoordinate[4],w.tubew=c.traceCoordinate[5],w.norm=c.traceCoordinate[6],w.divergence=c.traceCoordinate[7],delete w.x,delete w.y,delete w.z,w},meta:{}}},{"../../plots/gl3d":598,"./attributes":1044,"./calc":1045,"./convert":1046,"./defaults":1047}],1049:[function(d,re,ne){var w=d("../../plots/attributes"),c=d("../../plots/template_attributes").hovertemplateAttrs,M=d("../../plots/template_attributes").texttemplateAttrs,T=d("../../components/colorscale/attributes"),e=d("../../plots/domain").attributes,a=d("../pie/attributes"),n=d("./constants"),r=d("../../lib/extend").extendFlat;re.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:r({colors:{valType:"data_array",editType:"calc"},line:{color:r({},a.marker.line.color,{dflt:null}),width:r({},a.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},T("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:a.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:M({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:a.hovertext,hoverinfo:r({},w.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:c({},{keys:n.eventDataKeys}),textfont:a.textfont,insidetextorientation:a.insidetextorientation,insidetextfont:a.insidetextfont,outsidetextfont:r({},a.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:a.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":901,"./constants":1052}],1050:[function(d,re,ne){var w=d("../../plots/plots");ne.name="sunburst",ne.plot=function(c,M,T,e){w.plotBasePlot(ne.name,c,M,T,e)},ne.clean=function(c,M,T,e){w.cleanBasePlot(ne.name,c,M,T,e)}},{"../../plots/plots":619}],1051:[function(d,re,ne){var w=d("d3-hierarchy"),c=d("fast-isnumeric"),M=d("../../lib"),T=d("../../components/colorscale").makeColorScaleFuncFromTrace,e=d("../pie/calc").makePullColorFn,a=d("../pie/calc").generateExtendedColors,n=d("../../components/colorscale").calc,r=d("../../constants/numerical").ALMOST_EQUAL,t={},f={},o={};ne.calc=function(g,p){var y=g._fullLayout,h=p.ids,m=M.isArrayOrTypedArray(h),u=p.labels,_=p.parents,s=p.values,A=M.isArrayOrTypedArray(s),x=[],v={},b={},l=function(U,q){v[U]?v[U].push(q):v[U]=[q],b[q]=1},L=function(U){return U||typeof U=="number"},S=function(U){return!A||c(s[U])&&s[U]>=0},k,P,z;m?(k=Math.min(h.length,_.length),P=function(U){return L(h[U])&&S(U)},z=function(U){return String(h[U])}):(k=Math.min(u.length,_.length),P=function(U){return L(u[U])&&S(U)},z=function(U){return String(u[U])}),A&&(k=Math.min(k,s.length));for(var I=0;I<k;I++)if(P(I)){var D=z(I),R=L(_[I])?String(_[I]):"",B={i:I,id:D,pid:R,label:L(u[I])?String(u[I]):""};A&&(B.v=+s[I]),x.push(B),l(R,D)}if(v[""]){if(v[""].length>1){for(var G=M.randstr(),J=0;J<x.length;J++)x[J].pid===""&&(x[J].pid=G);x.unshift({hasMultipleRoots:!0,id:G,pid:"",label:""})}}else{var F=[],V;for(V in v)b[V]||F.push(V);if(F.length===1)V=F[0],x.unshift({hasImpliedRoot:!0,id:V,pid:"",label:V});else return M.warn(["Multiple implied roots, cannot build",p.type,"hierarchy of",p.name+".","These roots include:",F.join(", ")].join(" "))}var j;try{j=w.stratify().id(function(U){return U.id}).parentId(function(U){return U.pid})(x)}catch(U){return M.warn(["Failed to build",p.type,"hierarchy of",p.name+".","Error:",U.message].join(" "))}var Y=w.hierarchy(j),X=!1;if(A)switch(p.branchvalues){case"remainder":Y.sum(function(U){return U.data.v});break;case"total":Y.each(function(U){var q=U.data.data,Q=q.v;if(U.children){var W=U.children.reduce(function(Z,ee){return Z+ee.data.data.v},0);if((q.hasImpliedRoot||q.hasMultipleRoots)&&(Q=W),Q<W*r)return X=!0,M.warn(["Total value for node",U.data.data.id,"of",p.name,"is smaller than the sum of its children.",`
parent value =`,Q,`
children sum =`,W].join(" "))}U.value=Q});break}else i(Y,p,{branches:p.count.indexOf("branches")!==-1,leaves:p.count.indexOf("leaves")!==-1});if(!X){p.sort&&Y.sort(function(U,q){return q.value-U.value});var oe,se,ie=p.marker.colors||[],N=!!ie.length;return p._hasColorscale?(N||(ie=A?p.values:p._values),n(g,p,{vals:ie,containerStr:"marker",cLetter:"c"}),se=T(p.marker)):oe=e(y["_"+p.type+"colormap"]),Y.each(function(U){var q=U.data.data;q.color=p._hasColorscale?se(ie[q.i]):oe(ie[q.i],q.id)}),x[0].hierarchy=Y,x}},ne._runCrossTraceCalc=function(g,p){var y=p._fullLayout,h=p.calcdata,m=y[g+"colorway"],u=y["_"+g+"colormap"];y["extend"+g+"colors"]&&(m=a(m,g==="icicle"?o:g==="treemap"?f:t));var _=0,s;function A(l){var L=l.data.data,S=L.id;L.color===!1&&(u[S]?L.color=u[S]:l.parent?l.parent.parent?L.color=l.parent.data.data.color:(u[S]=L.color=m[_%m.length],_++):L.color=s)}for(var x=0;x<h.length;x++){var v=h[x],b=v[0];b.trace.type===g&&b.hierarchy&&(s=b.trace.root.color,b.hierarchy.each(A))}},ne.crossTraceCalc=function(g){return ne._runCrossTraceCalc("sunburst",g)};function i(g,p,y){var h=0,m=g.children;if(m){for(var u=m.length,_=0;_<u;_++)h+=i(m[_],p,y);y.branches&&h++}else y.leaves&&h++;return g.value=g.data.data.value=h,p._values||(p._values=[]),p._values[g.data.data.i]=h,h}},{"../../components/colorscale":378,"../../constants/numerical":479,"../../lib":503,"../pie/calc":903,"d3-hierarchy":115,"fast-isnumeric":190}],1052:[function(d,re,ne){re.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1053:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes"),M=d("../../plots/domain").defaults,T=d("../bar/defaults").handleText,e=d("../../components/colorscale"),a=e.hasColorscale,n=e.handleDefaults;re.exports=function(t,f,o,i){function g(A,x){return w.coerce(t,f,c,A,x)}var p=g("labels"),y=g("parents");if(!p||!p.length||!y||!y.length){f.visible=!1;return}var h=g("values");h&&h.length?g("branchvalues"):g("count"),g("level"),g("maxdepth");var m=g("marker.line.width");m&&g("marker.line.color",i.paper_bgcolor),g("marker.colors");var u=f._hasColorscale=a(t,"marker","colors")||(t.marker||{}).coloraxis;u&&n(t,f,i,g,{prefix:"marker.",cLetter:"c"}),g("leaf.opacity",u?1:.7);var _=g("text");g("texttemplate"),f.texttemplate||g("textinfo",Array.isArray(_)?"text+label":"label"),g("hovertext"),g("hovertemplate");var s="auto";T(t,f,i,g,s,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),g("insidetextorientation"),g("sort"),g("rotation"),g("root.color"),M(f,i,g),f._length=null}},{"../../components/colorscale":378,"../../lib":503,"../../plots/domain":584,"../bar/defaults":652,"./attributes":1049}],1054:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../registry"),M=d("../../components/fx/helpers").appendArrayPointValue,T=d("../../components/fx"),e=d("../../lib"),a=d("../../lib/events"),n=d("./helpers"),r=d("../pie/helpers"),t=r.formatPieValue;re.exports=function(i,g,p,y,h){var m=y[0],u=m.trace,_=m.hierarchy,s=u.type==="sunburst",A=u.type==="treemap"||u.type==="icicle";"_hasHoverLabel"in u||(u._hasHoverLabel=!1),"_hasHoverEvent"in u||(u._hasHoverEvent=!1);var x=function(l){var L=p._fullLayout;if(!(p._dragging||L.hovermode===!1)){var S=p._fullData[u.index],k=l.data.data,P=k.i,z=n.isHierarchyRoot(l),I=n.getParent(_,l),D=n.getValue(l),R=function(Z){return e.castOption(S,P,Z)},B=R("hovertemplate"),F=T.castHoverinfo(S,L,P),V=L.separators,G;if(B||F&&F!=="none"&&F!=="skip"){var J,j;s&&(J=m.cx+l.pxmid[0]*(1-l.rInscribed),j=m.cy+l.pxmid[1]*(1-l.rInscribed)),A&&(J=l._hoverX,j=l._hoverY);var Y={},X=[],oe=[],se=function(Z){return X.indexOf(Z)!==-1};F&&(X=F==="all"?S._module.attributes.hoverinfo.flags:F.split("+")),Y.label=k.label,se("label")&&Y.label&&oe.push(Y.label),k.hasOwnProperty("v")&&(Y.value=k.v,Y.valueLabel=t(Y.value,V),se("value")&&oe.push(Y.valueLabel)),Y.currentPath=l.currentPath=n.getPath(l.data),se("current path")&&!z&&oe.push(Y.currentPath);var ie,N=[],U=function(){N.indexOf(ie)===-1&&(oe.push(ie),N.push(ie))};Y.percentParent=l.percentParent=D/n.getValue(I),Y.parent=l.parentString=n.getPtLabel(I),se("percent parent")&&(ie=n.formatPercent(Y.percentParent,V)+" of "+Y.parent,U()),Y.percentEntry=l.percentEntry=D/n.getValue(g),Y.entry=l.entry=n.getPtLabel(g),se("percent entry")&&!z&&!l.onPathbar&&(ie=n.formatPercent(Y.percentEntry,V)+" of "+Y.entry,U()),Y.percentRoot=l.percentRoot=D/n.getValue(_),Y.root=l.root=n.getPtLabel(_),se("percent root")&&!z&&(ie=n.formatPercent(Y.percentRoot,V)+" of "+Y.root,U()),Y.text=R("hovertext")||R("text"),se("text")&&(ie=Y.text,e.isValidTextValue(ie)&&oe.push(ie)),G=[f(l,S,h.eventDataKeys)];var q={trace:S,y:j,_x0:l._x0,_x1:l._x1,_y0:l._y0,_y1:l._y1,text:oe.join("<br>"),name:B||se("name")?S.name:void 0,color:R("hoverlabel.bgcolor")||k.color,borderColor:R("hoverlabel.bordercolor"),fontFamily:R("hoverlabel.font.family"),fontSize:R("hoverlabel.font.size"),fontColor:R("hoverlabel.font.color"),nameLength:R("hoverlabel.namelength"),textAlign:R("hoverlabel.align"),hovertemplate:B,hovertemplateLabels:Y,eventData:G};s&&(q.x0=J-l.rInscribed*l.rpx1,q.x1=J+l.rInscribed*l.rpx1,q.idealAlign=l.pxmid[0]<0?"left":"right"),A&&(q.x=J,q.idealAlign=J<0?"left":"right");var Q=[];T.loneHover(q,{container:L._hoverlayer.node(),outerContainer:L._paper.node(),gd:p,inOut_bbox:Q}),G[0].bbox=Q[0],u._hasHoverLabel=!0}if(A){var W=i.select("path.surface");h.styleOne(W,l,S,{hovered:!0})}u._hasHoverEvent=!0,p.emit("plotly_hover",{points:G||[f(l,S,h.eventDataKeys)],event:w.event})}},v=function(l){var L=p._fullLayout,S=p._fullData[u.index],k=w.select(this).datum();if(u._hasHoverEvent&&(l.originalEvent=w.event,p.emit("plotly_unhover",{points:[f(k,S,h.eventDataKeys)],event:w.event}),u._hasHoverEvent=!1),u._hasHoverLabel&&(T.loneUnhover(L._hoverlayer.node()),u._hasHoverLabel=!1),A){var P=i.select("path.surface");h.styleOne(P,k,S,{hovered:!1})}},b=function(l){var L=p._fullLayout,S=p._fullData[u.index],k=s&&(n.isHierarchyRoot(l)||n.isLeaf(l)),P=n.getPtId(l),z=n.isEntry(l)?n.findEntryWithChild(_,P):n.findEntryWithLevel(_,P),I=n.getPtId(z),D={points:[f(l,S,h.eventDataKeys)],event:w.event};k||(D.nextLevel=I);var R=a.triggerHandler(p,"plotly_"+u.type+"click",D);if(R!==!1&&L.hovermode&&(p._hoverdata=[f(l,S,h.eventDataKeys)],T.click(p,w.event)),!k&&R!==!1&&!p._dragging&&!p._transitioning){c.call("_storeDirectGUIEdit",S,L._tracePreGUI[S.uid],{level:S.level});var B={data:[{level:I}],traces:[u.index]},F={frame:{redraw:!1,duration:h.transitionTime},transition:{duration:h.transitionTime,easing:h.transitionEasing},mode:"immediate",fromcurrent:!0};T.loneUnhover(L._hoverlayer.node()),c.call("animate",p,B,F)}};i.on("mouseover",x),i.on("mouseout",v),i.on("click",b)};function f(o,i,g){for(var p=o.data.data,y={curveNumber:i.index,pointNumber:p.i,data:i._input,fullData:i},h=0;h<g.length;h++){var m=g[h];m in o&&(y[m]=o[m])}return"parentString"in o&&!n.isHierarchyRoot(o)&&(y.parent=o.parentString),M(y,i,p.i),y}},{"../../components/fx":406,"../../components/fx/helpers":402,"../../lib":503,"../../lib/events":492,"../../registry":638,"../pie/helpers":906,"./helpers":1055,"@plotly/d3":58}],1055:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/color"),M=d("../../lib/setcursor"),T=d("../pie/helpers");ne.findEntryWithLevel=function(r,t){var f;return t&&r.eachAfter(function(o){if(ne.getPtId(o)===t)return f=o.copy()}),f||r},ne.findEntryWithChild=function(r,t){var f;return r.eachAfter(function(o){for(var i=o.children||[],g=0;g<i.length;g++){var p=i[g];if(ne.getPtId(p)===t)return f=o.copy()}}),f||r},ne.isEntry=function(r){return!r.parent},ne.isLeaf=function(r){return!r.children},ne.getPtId=function(r){return r.data.data.id},ne.getPtLabel=function(r){return r.data.data.label},ne.getValue=function(r){return r.value},ne.isHierarchyRoot=function(r){return n(r)===""},ne.setSliceCursor=function(r,t,f){var o=f.isTransitioning;if(!o){var i=r.datum();o=f.hideOnRoot&&ne.isHierarchyRoot(i)||f.hideOnLeaves&&ne.isLeaf(i)}M(r,o?null:"pointer")};function e(r,t,f){return{color:ne.getOutsideTextFontKey("color",r,t,f),family:ne.getOutsideTextFontKey("family",r,t,f),size:ne.getOutsideTextFontKey("size",r,t,f)}}function a(r,t,f,o){var i=(o||{}).onPathbar,g=t.data.data,p=g.i,y=w.castOption(r,p,(i?"pathbar.textfont":"insidetextfont")+".color");return!y&&r._input.textfont&&(y=w.castOption(r._input,p,"textfont.color")),{color:y||c.contrast(g.color),family:ne.getInsideTextFontKey("family",r,t,f,o),size:ne.getInsideTextFontKey("size",r,t,f,o)}}ne.getInsideTextFontKey=function(r,t,f,o,i){var g=(i||{}).onPathbar,p=g?"pathbar.textfont":"insidetextfont",y=f.data.data.i;return w.castOption(t,y,p+"."+r)||w.castOption(t,y,"textfont."+r)||o.size},ne.getOutsideTextFontKey=function(r,t,f,o){var i=f.data.data.i;return w.castOption(t,i,"outsidetextfont."+r)||w.castOption(t,i,"textfont."+r)||o.size},ne.isOutsideText=function(r,t){return!r._hasColorscale&&ne.isHierarchyRoot(t)},ne.determineTextFont=function(r,t,f,o){return ne.isOutsideText(r,t)?e(r,t,f):a(r,t,f,o)},ne.hasTransition=function(r){return!!(r&&r.duration>0)},ne.getMaxDepth=function(r){return r.maxdepth>=0?r.maxdepth:1/0},ne.isHeader=function(r,t){return!(ne.isLeaf(r)||r.depth===t._maxDepth-1)};function n(r){return r.data.data.pid}ne.getParent=function(r,t){return ne.findEntryWithLevel(r,n(t))},ne.listPath=function(r,t){var f=r.parent;if(!f)return[];var o=t?[f.data[t]]:[f];return ne.listPath(f,t).concat(o)},ne.getPath=function(r){return ne.listPath(r,"label").join("/")+"/"},ne.formatValue=T.formatPieValue,ne.formatPercent=function(r,t){var f=w.formatPercent(r,0);return f==="0%"&&(f=T.formatPiePercent(r,t)),f}},{"../../components/color":366,"../../lib":503,"../../lib/setcursor":524,"../pie/helpers":906}],1056:[function(d,re,ne){re.exports={moduleType:"trace",name:"sunburst",basePlotModule:d("./base_plot"),categories:[],animatable:!0,attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot").plot,style:d("./style").style,colorbar:d("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":945,"./attributes":1049,"./base_plot":1050,"./calc":1051,"./defaults":1053,"./layout_attributes":1057,"./layout_defaults":1058,"./plot":1059,"./style":1060}],1057:[function(d,re,ne){re.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1058:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes");re.exports=function(T,e){function a(n,r){return w.coerce(T,e,c,n,r)}a("sunburstcolorway",e.colorway),a("extendsunburstcolors")}},{"../../lib":503,"./layout_attributes":1057}],1059:[function(d,re,ne){var w=d("@plotly/d3"),c=d("d3-hierarchy"),M=d("d3-interpolate").interpolate,T=d("../../components/drawing"),e=d("../../lib"),a=d("../../lib/svg_text_utils"),n=d("../bar/uniform_text"),r=n.recordMinTextSize,t=n.clearMinTextSize,f=d("../pie/plot"),o=d("../pie/helpers").getRotationAngle,i=f.computeTransform,g=f.transformInsideText,p=d("./style").styleOne,y=d("../bar/style").resizeText,h=d("./fx"),m=d("./constants"),u=d("./helpers");ne.plot=function(b,l,L,S){var k=b._fullLayout,P=k._sunburstlayer,z,I,D=!L,R=!k.uniformtext.mode&&u.hasTransition(L);if(t("sunburst",k),z=P.selectAll("g.trace.sunburst").data(l,function(F){return F[0].trace.uid}),z.enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),z.order(),R){S&&(I=S());var B=w.transition().duration(L.duration).ease(L.easing).each("end",function(){I&&I()}).each("interrupt",function(){I&&I()});B.each(function(){P.selectAll("g.trace").each(function(F){_(b,F,this,L)})})}else z.each(function(F){_(b,F,this,L)}),k.uniformtext.mode&&y(b,k._sunburstlayer.selectAll(".trace"),"sunburst");D&&z.exit().remove()};function _(b,l,L,S){var k=b._fullLayout,P=!k.uniformtext.mode&&u.hasTransition(S),z=w.select(L),I=z.selectAll("g.slice"),D=l[0],R=D.trace,B=D.hierarchy,F=u.findEntryWithLevel(B,R.level),V=u.getMaxDepth(R),G=k._size,J=R.domain,j=G.w*(J.x[1]-J.x[0]),Y=G.h*(J.y[1]-J.y[0]),X=.5*Math.min(j,Y),oe=D.cx=G.l+G.w*(J.x[1]+J.x[0])/2,se=D.cy=G.t+G.h*(1-J.y[0])-Y/2;if(!F)return I.remove();var ie=null,N={};P&&I.each(function(xe){N[u.getPtId(xe)]={rpx0:xe.rpx0,rpx1:xe.rpx1,x0:xe.x0,x1:xe.x1,transform:xe.transform},!ie&&u.isEntry(xe)&&(ie=xe)});var U=s(F).descendants(),q=F.height+1,Q=0,W=V;D.hasMultipleRoots&&u.isHierarchyRoot(F)&&(U=U.slice(1),q-=1,Q=1,W+=1),U=U.filter(function(xe){return xe.y1<=W});var Z=o(R.rotation);Z&&U.forEach(function(xe){xe.x0+=Z,xe.x1+=Z});var ee=Math.min(q,V),te=function(xe){return(xe-Q)/ee*X},ae=function(xe,Le){return[xe*Math.cos(Le),-xe*Math.sin(Le)]},le=function(xe){return e.pathAnnulus(xe.rpx0,xe.rpx1,xe.x0,xe.x1,oe,se)},ye=function(xe){return oe+x(xe)[0]*(xe.transform.rCenter||0)+(xe.transform.x||0)},fe=function(xe){return se+x(xe)[1]*(xe.transform.rCenter||0)+(xe.transform.y||0)};I=I.data(U,u.getPtId),I.enter().append("g").classed("slice",!0),P?I.exit().transition().each(function(){var xe=w.select(this),Le=xe.select("path.surface");Le.transition().attrTween("d",function(Je){var Oe=we(Je);return function(Pe){return le(Oe(Pe))}});var He=xe.select("g.slicetext");He.attr("opacity",0)}).remove():I.exit().remove(),I.order();var pe=null;if(P&&ie){var ge=u.getPtId(ie);I.each(function(xe){pe===null&&u.getPtId(xe)===ge&&(pe=xe.x1)})}var Ae=I;P&&(Ae=Ae.transition().each("end",function(){var xe=w.select(this);u.setSliceCursor(xe,b,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),Ae.each(function(xe){var Le=w.select(this),He=e.ensureSingle(Le,"path","surface",function(Lt){Lt.style("pointer-events","all")});xe.rpx0=te(xe.y0),xe.rpx1=te(xe.y1),xe.xmid=(xe.x0+xe.x1)/2,xe.pxmid=ae(xe.rpx1,xe.xmid),xe.midangle=-(xe.xmid-Math.PI/2),xe.startangle=-(xe.x0-Math.PI/2),xe.stopangle=-(xe.x1-Math.PI/2),xe.halfangle=.5*Math.min(e.angleDelta(xe.x0,xe.x1)||Math.PI,Math.PI),xe.ring=1-xe.rpx0/xe.rpx1,xe.rInscribed=A(xe),P?He.transition().attrTween("d",function(Lt){var Yt=De(Lt);return function(At){return le(Yt(At))}}):He.attr("d",le),Le.call(h,F,b,l,{eventDataKeys:m.eventDataKeys,transitionTime:m.CLICK_TRANSITION_TIME,transitionEasing:m.CLICK_TRANSITION_EASING}).call(u.setSliceCursor,b,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:b._transitioning}),He.call(p,xe,R);var Je=e.ensureSingle(Le,"g","slicetext"),Oe=e.ensureSingle(Je,"text","",function(Lt){Lt.attr("data-notex",1)}),Pe=e.ensureUniformFontSize(b,u.determineTextFont(R,xe,k.font));Oe.text(ne.formatSliceLabel(xe,F,R,l,k)).classed("slicetext",!0).attr("text-anchor","middle").call(T.font,Pe).call(a.convertToTspans,b);var Ue=T.bBox(Oe.node());xe.transform=g(Ue,xe,D),xe.transform.targetX=ye(xe),xe.transform.targetY=fe(xe);var vt=function(Lt,Yt){var At=Lt.transform;return i(At,Yt),At.fontSize=Pe.size,r(R.type,At,k),e.getTextTransform(At)};P?Oe.transition().attrTween("transform",function(Lt){var Yt=Be(Lt);return function(At){return vt(Yt(At),Ue)}}):Oe.attr("transform",vt(xe,Ue))});function we(xe){var Le=u.getPtId(xe),He=N[Le],Je=N[u.getPtId(F)],Oe;if(Je){var Pe=(xe.x1>Je.x1?2*Math.PI:0)+Z;Oe=xe.rpx1<Je.rpx1?{x0:xe.x0,x1:xe.x1,rpx0:0,rpx1:0}:{x0:Pe,x1:Pe,rpx0:xe.rpx0,rpx1:xe.rpx1}}else{var Ue,vt=u.getPtId(xe.parent);I.each(function(Bt){if(u.getPtId(Bt)===vt)return Ue=Bt});var Lt=Ue.children,Yt;Lt.forEach(function(Bt,Mt){if(u.getPtId(Bt)===Le)return Yt=Mt});var At=Lt.length,Rt=M(Ue.x0,Ue.x1);Oe={rpx0:X,rpx1:X,x0:Rt(Yt/At),x1:Rt((Yt+1)/At)}}return M(He,Oe)}function De(xe){var Le=N[u.getPtId(xe)],He,Je={x0:xe.x0,x1:xe.x1,rpx0:xe.rpx0,rpx1:xe.rpx1};if(Le)He=Le;else if(ie)if(xe.parent)if(pe){var Oe=(xe.x1>pe?2*Math.PI:0)+Z;He={x0:Oe,x1:Oe}}else He={rpx0:X,rpx1:X},e.extendFlat(He,Ve(xe));else He={rpx0:0,rpx1:0};else He={x0:Z,x1:Z};return M(He,Je)}function Be(xe){var Le=N[u.getPtId(xe)],He,Je=xe.transform;if(Le)He=Le;else if(He={rpx1:xe.rpx1,transform:{textPosAngle:Je.textPosAngle,scale:0,rotate:Je.rotate,rCenter:Je.rCenter,x:Je.x,y:Je.y}},ie)if(xe.parent)if(pe){var Oe=xe.x1>pe?2*Math.PI:0;He.x0=He.x1=Oe}else e.extendFlat(He,Ve(xe));else He.x0=He.x1=Z;else He.x0=He.x1=Z;var Pe=M(He.transform.textPosAngle,xe.transform.textPosAngle),Ue=M(He.rpx1,xe.rpx1),vt=M(He.x0,xe.x0),Lt=M(He.x1,xe.x1),Yt=M(He.transform.scale,Je.scale),At=M(He.transform.rotate,Je.rotate),Rt=Je.rCenter===0?3:He.transform.rCenter===0?1/3:1,Bt=M(He.transform.rCenter,Je.rCenter),Mt=function(Tt){return Bt(Math.pow(Tt,Rt))};return function(Tt){var at=Ue(Tt),ct=vt(Tt),je=Lt(Tt),ke=Mt(Tt),Ye=ae(at,(ct+je)/2),Ke=Pe(Tt),st={pxmid:Ye,rpx1:at,transform:{textPosAngle:Ke,rCenter:ke,x:Je.x,y:Je.y}};return r(R.type,Je,k),{transform:{targetX:ye(st),targetY:fe(st),scale:Yt(Tt),rotate:At(Tt),rCenter:ke}}}}function Ve(xe){var Le=xe.parent,He=N[u.getPtId(Le)],Je={};if(He){var Oe=Le.children,Pe=Oe.indexOf(xe),Ue=Oe.length,vt=M(He.x0,He.x1);Je.x0=vt(Pe/Ue),Je.x1=vt(Pe/Ue)}else Je.x0=Je.x1=0;return Je}}function s(b){return c.partition().size([2*Math.PI,b.height+1])(b)}ne.formatSliceLabel=function(b,l,L,S,k){var P=L.texttemplate,z=L.textinfo;if(!P&&(!z||z==="none"))return"";var I=k.separators,D=S[0],R=b.data.data,B=D.hierarchy,F=u.isHierarchyRoot(b),V=u.getParent(B,b),G=u.getValue(b);if(!P){var J=z.split("+"),j=function(W){return J.indexOf(W)!==-1},Y=[],X;if(j("label")&&R.label&&Y.push(R.label),R.hasOwnProperty("v")&&j("value")&&Y.push(u.formatValue(R.v,I)),!F){j("current path")&&Y.push(u.getPath(b.data));var oe=0;j("percent parent")&&oe++,j("percent entry")&&oe++,j("percent root")&&oe++;var se=oe>1;if(oe){var ie,N=function(W){X=u.formatPercent(ie,I),se&&(X+=" of "+W),Y.push(X)};j("percent parent")&&!F&&(ie=G/u.getValue(V),N("parent")),j("percent entry")&&(ie=G/u.getValue(l),N("entry")),j("percent root")&&(ie=G/u.getValue(B),N("root"))}}return j("text")&&(X=e.castOption(L,R.i,"text"),e.isValidTextValue(X)&&Y.push(X)),Y.join("<br>")}var U=e.castOption(L,R.i,"texttemplate");if(!U)return"";var q={};R.label&&(q.label=R.label),R.hasOwnProperty("v")&&(q.value=R.v,q.valueLabel=u.formatValue(R.v,I)),q.currentPath=u.getPath(b.data),F||(q.percentParent=G/u.getValue(V),q.percentParentLabel=u.formatPercent(q.percentParent,I),q.parent=u.getPtLabel(V)),q.percentEntry=G/u.getValue(l),q.percentEntryLabel=u.formatPercent(q.percentEntry,I),q.entry=u.getPtLabel(l),q.percentRoot=G/u.getValue(B),q.percentRootLabel=u.formatPercent(q.percentRoot,I),q.root=u.getPtLabel(B),R.hasOwnProperty("color")&&(q.color=R.color);var Q=e.castOption(L,R.i,"text");return(e.isValidTextValue(Q)||Q==="")&&(q.text=Q),q.customdata=e.castOption(L,R.i,"customdata"),e.texttemplateString(U,q,k._d3locale,q,L._meta||{})};function A(b){return b.rpx0===0&&e.isFullCircle([b.x0,b.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(b.halfangle)),b.ring/2))}function x(b){return v(b.rpx1,b.transform.textPosAngle)}function v(b,l){return[b*Math.sin(l),-b*Math.cos(l)]}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../bar/style":662,"../bar/uniform_text":664,"../pie/helpers":906,"../pie/plot":910,"./constants":1052,"./fx":1054,"./helpers":1055,"./style":1060,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1060:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/color"),M=d("../../lib"),T=d("../bar/uniform_text").resizeText;function e(n){var r=n._fullLayout._sunburstlayer.selectAll(".trace");T(n,r,"sunburst"),r.each(function(t){var f=w.select(this),o=t[0],i=o.trace;f.style("opacity",i.opacity),f.selectAll("path.surface").each(function(g){w.select(this).call(a,g,i)})})}function a(n,r,t){var f=r.data.data,o=!r.children,i=f.i,g=M.castOption(t,i,"marker.line.color")||c.defaultLine,p=M.castOption(t,i,"marker.line.width")||0;n.style("stroke-width",p).call(c.fill,f.color).call(c.stroke,g).style("opacity",o?t.leaf.opacity:null)}re.exports={style:e,styleOne:a}},{"../../components/color":366,"../../lib":503,"../bar/uniform_text":664,"@plotly/d3":58}],1061:[function(d,re,ne){var w=d("../../components/color"),c=d("../../components/colorscale/attributes"),M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,T=d("../../plots/template_attributes").hovertemplateAttrs,e=d("../../plots/attributes"),a=d("../../lib/extend").extendFlat,n=d("../../plot_api/edit_types").overrideAll;function r(o){return{valType:"boolean",dflt:!1}}function t(o){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:r(),y:r(),z:r()},color:{valType:"color",dflt:w.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:w.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var f=re.exports=n(a({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:T(),xhoverformat:M("x"),yhoverformat:M("y"),zhoverformat:M("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},c("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:t(),y:t(),z:t()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:a({},c.zauto,{}),zmin:a({},c.zmin,{}),zmax:a({},c.zmax,{})},hoverinfo:a({},e.hoverinfo),showlegend:a({},e.showlegend,{dflt:!1})}),"calc","nested");f.x.editType=f.y.editType=f.z.editType="calc+clearAxisTypes",f.transforms=void 0},{"../../components/color":366,"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633}],1062:[function(d,re,ne){var w=d("../../components/colorscale/calc");re.exports=function(M,T){T.surfacecolor?w(M,T,{vals:T.surfacecolor,containerStr:"",cLetter:"c"}):w(M,T,{vals:T.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374}],1063:[function(d,re,ne){var w=d("../../../stackgl_modules").gl_surface3d,c=d("../../../stackgl_modules").ndarray,M=d("../../../stackgl_modules").ndarray_linear_interpolate.d2,T=d("../heatmap/interp2d"),e=d("../heatmap/find_empties"),a=d("../../lib").isArrayOrTypedArray,n=d("../../lib/gl_format_color").parseColorScale,r=d("../../lib/str2rgbarray"),t=d("../../components/colorscale").extractOpts;function f(S,k,P){this.scene=S,this.uid=P,this.surface=k,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var o=f.prototype;o.getXat=function(S,k,P,z){var I=a(this.data.x)?a(this.data.x[0])?this.data.x[k][S]:this.data.x[S]:S;return P===void 0?I:z.d2l(I,0,P)},o.getYat=function(S,k,P,z){var I=a(this.data.y)?a(this.data.y[0])?this.data.y[k][S]:this.data.y[k]:k;return P===void 0?I:z.d2l(I,0,P)},o.getZat=function(S,k,P,z){var I=this.data.z[k][S];return I===null&&this.data.connectgaps&&this.data._interpolatedZ&&(I=this.data._interpolatedZ[k][S]),P===void 0?I:z.d2l(I,0,P)},o.handlePick=function(S){if(S.object===this.surface){var k=(S.data.index[0]-1)/this.dataScaleX-1,P=(S.data.index[1]-1)/this.dataScaleY-1,z=Math.max(Math.min(Math.round(k),this.data.z[0].length-1),0),I=Math.max(Math.min(Math.round(P),this.data._ylength-1),0);S.index=[z,I],S.traceCoordinate=[this.getXat(z,I),this.getYat(z,I),this.getZat(z,I)],S.dataCoordinate=[this.getXat(z,I,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(z,I,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(z,I,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var D=0;D<3;D++){var R=S.dataCoordinate[D];R!=null&&(S.dataCoordinate[D]*=this.scene.dataScale[D])}var B=this.data.hovertext||this.data.text;return Array.isArray(B)&&B[I]&&B[I][z]!==void 0?S.textLabel=B[I][z]:B?S.textLabel=B:S.textLabel="",S.data.dataCoordinate=S.dataCoordinate.slice(),this.surface.highlight(S.data),this.scene.glplot.spikes.position=S.dataCoordinate,!0}};function i(S){var k=S[0].rgb,P=S[S.length-1].rgb;return k[0]===P[0]&&k[1]===P[1]&&k[2]===P[2]&&k[3]===P[3]}var g=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function p(S,k){if(S<k)return 0;for(var P=0;Math.floor(S%k)===0;)S/=k,P++;return P}function y(S){for(var k=[],P=0;P<g.length;P++){var z=g[P];k.push(p(S,z))}return k}function h(S){for(var k=y(S),P=S,z=0;z<g.length;z++)if(k[z]>0){P=g[z];break}return P}function m(S,k){if(!(S<1||k<1)){for(var P=y(S),z=y(k),I=1,D=0;D<g.length;D++)I*=Math.pow(g[D],Math.max(P[D],z[D]));return I}}function u(S){if(S.length!==0){for(var k=1,P=0;P<S.length;P++)k=m(k,S[P]);return k}}o.calcXnums=function(S){var k,P=[];for(k=1;k<S;k++){var z=this.getXat(k-1,0),I=this.getXat(k,0);I!==z&&z!==void 0&&z!==null&&I!==void 0&&I!==null?P[k-1]=Math.abs(I-z):P[k-1]=0}var D=0;for(k=1;k<S;k++)D+=P[k-1];for(k=1;k<S;k++)P[k-1]===0?P[k-1]=1:P[k-1]=Math.round(D/P[k-1]);return P},o.calcYnums=function(S){var k,P=[];for(k=1;k<S;k++){var z=this.getYat(0,k-1),I=this.getYat(0,k);I!==z&&z!==void 0&&z!==null&&I!==void 0&&I!==null?P[k-1]=Math.abs(I-z):P[k-1]=0}var D=0;for(k=1;k<S;k++)D+=P[k-1];for(k=1;k<S;k++)P[k-1]===0?P[k-1]=1:P[k-1]=Math.round(D/P[k-1]);return P};var _=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],s=_[9],A=_[13];o.estimateScale=function(S,k){for(var P=k===0?this.calcXnums(S):this.calcYnums(S),z=1+u(P);z<s;)z*=2;for(;z>A;)z--,z/=h(z),z++,z<s&&(z=A);var I=Math.round(z/S);return I>1?I:1};function x(S,k,P){var z=P[8]+P[2]*k[0]+P[5]*k[1];return S[0]=(P[6]+P[0]*k[0]+P[3]*k[1])/z,S[1]=(P[7]+P[1]*k[0]+P[4]*k[1])/z,S}function v(S,k,P){return b(S,k,x,P),S}function b(S,k,P,z){for(var I=[0,0],D=S.shape[0],R=S.shape[1],B=0;B<D;B++)for(var F=0;F<R;F++)P(I,[B,F],z),S.set(B,F,M(k,I[0],I[1]));return S}o.refineCoords=function(S){for(var k=this.dataScaleX,P=this.dataScaleY,z=S[0].shape[0],I=S[0].shape[1],D=Math.floor(S[0].shape[0]*k+1)|0,R=Math.floor(S[0].shape[1]*P+1)|0,B=1+z+1,F=1+I+1,V=c(new Float32Array(B*F),[B,F]),G=[1/k,0,0,0,1/P,0,0,0,1],J=0;J<S.length;++J){this.surface.padField(V,S[J]);var j=c(new Float32Array(D*R),[D,R]);v(j,V,G),S[J]=j}};function l(S,k){for(var P=!1,z=0;z<S.length;z++)if(k===S[z]){P=!0;break}P===!1&&S.push(k)}o.setContourLevels=function(){var S=[[],[],[]],k=[!1,!1,!1],P=!1,z,I,D;for(z=0;z<3;++z)if(this.showContour[z]&&(P=!0,this.contourSize[z]>0&&this.contourStart[z]!==null&&this.contourEnd[z]!==null&&this.contourEnd[z]>this.contourStart[z]))for(k[z]=!0,I=this.contourStart[z];I<this.contourEnd[z];I+=this.contourSize[z])D=I*this.scene.dataScale[z],l(S[z],D);if(P){var R=[[],[],[]];for(z=0;z<3;++z)this.showContour[z]&&(R[z]=k[z]?S[z]:this.scene.contourLevels[z]);this.surface.update({levels:R})}},o.update=function(S){var k=this.scene,P=k.fullSceneLayout,z=this.surface,I=n(S),D=k.dataScale,R=S.z[0].length,B=S._ylength,F=k.contourLevels;this.data=S;var V,G,J,j,Y=[];for(V=0;V<3;V++)for(Y[V]=[],G=0;G<R;G++)Y[V][G]=[];for(G=0;G<R;G++)for(J=0;J<B;J++)Y[0][G][J]=this.getXat(G,J,S.xcalendar,P.xaxis),Y[1][G][J]=this.getYat(G,J,S.ycalendar,P.yaxis),Y[2][G][J]=this.getZat(G,J,S.zcalendar,P.zaxis);if(S.connectgaps)for(S._emptypoints=e(Y[2]),T(Y[2],S._emptypoints),S._interpolatedZ=[],G=0;G<R;G++)for(S._interpolatedZ[G]=[],J=0;J<B;J++)S._interpolatedZ[G][J]=Y[2][G][J];for(V=0;V<3;V++)for(G=0;G<R;G++)for(J=0;J<B;J++)j=Y[V][G][J],j==null?Y[V][G][J]=NaN:j=Y[V][G][J]*=D[V];for(V=0;V<3;V++)for(G=0;G<R;G++)for(J=0;J<B;J++)j=Y[V][G][J],j!=null&&(this.minValues[V]>j&&(this.minValues[V]=j),this.maxValues[V]<j&&(this.maxValues[V]=j));for(V=0;V<3;V++)this.objectOffset[V]=.5*(this.minValues[V]+this.maxValues[V]);for(V=0;V<3;V++)for(G=0;G<R;G++)for(J=0;J<B;J++)j=Y[V][G][J],j!=null&&(Y[V][G][J]-=this.objectOffset[V]);var X=[c(new Float32Array(R*B),[R,B]),c(new Float32Array(R*B),[R,B]),c(new Float32Array(R*B),[R,B])];for(V=0;V<3;V++)for(G=0;G<R;G++)for(J=0;J<B;J++)X[V].set(G,J,Y[V][G][J]);Y=[];var oe={colormap:I,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!S.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:S.opacityscale,opacity:S.opacity},se=t(S);if(oe.intensityBounds=[se.min,se.max],S.surfacecolor){var ie=c(new Float32Array(R*B),[R,B]);for(G=0;G<R;G++)for(J=0;J<B;J++)ie.set(G,J,S.surfacecolor[J][G]);X.push(ie)}else oe.intensityBounds[0]*=D[2],oe.intensityBounds[1]*=D[2];(A<X[0].shape[0]||A<X[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(X[0].shape[0],0),this.dataScaleY=this.estimateScale(X[0].shape[1],1),(this.dataScaleX!==1||this.dataScaleY!==1)&&this.refineCoords(X)),S.surfacecolor&&(oe.intensity=X.pop());var N=[!0,!0,!0],U=["x","y","z"];for(V=0;V<3;++V){var q=S.contours[U[V]];N[V]=q.highlight,oe.showContour[V]=q.show||q.highlight,oe.showContour[V]&&(oe.contourProject[V]=[q.project.x,q.project.y,q.project.z],q.show?(this.showContour[V]=!0,oe.levels[V]=F[V],z.highlightColor[V]=oe.contourColor[V]=r(q.color),q.usecolormap?z.highlightTint[V]=oe.contourTint[V]=0:z.highlightTint[V]=oe.contourTint[V]=1,oe.contourWidth[V]=q.width,this.contourStart[V]=q.start,this.contourEnd[V]=q.end,this.contourSize[V]=q.size):(this.showContour[V]=!1,this.contourStart[V]=null,this.contourEnd[V]=null,this.contourSize[V]=0),q.highlight&&(oe.dynamicColor[V]=r(q.highlightcolor),oe.dynamicWidth[V]=q.highlightwidth))}i(I)&&(oe.vertexColor=!0),oe.objectOffset=this.objectOffset,oe.coords=X,z.update(oe),z.visible=S.visible,z.enableDynamic=N,z.enableHighlight=N,z.snapToData=!0,"lighting"in S&&(z.ambientLight=S.lighting.ambient,z.diffuseLight=S.lighting.diffuse,z.specularLight=S.lighting.specular,z.roughness=S.lighting.roughness,z.fresnel=S.lighting.fresnel),"lightposition"in S&&(z.lightPosition=[S.lightposition.x,S.lightposition.y,S.lightposition.z])},o.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()};function L(S,k){var P=S.glplot.gl,z=w({gl:P}),I=new f(S,z,k.uid);return z._trace=I,I.update(k),S.glplot.add(z),I}re.exports=L},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib":503,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../heatmap/find_empties":798,"../heatmap/interp2d":801}],1064:[function(d,re,ne){var w=d("../../registry"),c=d("../../lib"),M=d("../../components/colorscale/defaults"),T=d("./attributes"),e=.1;function a(o,i){for(var g=[],p=32,y=0;y<p;y++){var h=y/(p-1),m=i+(1-i)*(1-Math.pow(Math.sin(o*h*Math.PI),2));g.push([h,Math.max(0,Math.min(1,m))])}return g}function n(o){var i=0;if(!Array.isArray(o)||o.length<2||!o[0]||!o[o.length-1]||+o[0][0]!=0||+o[o.length-1][0]!=1)return!1;for(var g=0;g<o.length;g++){var p=o[g];if(p.length!==2||+p[0]<i)return!1;i=+p[0]}return!0}function r(o,i,g,p){var y,h;function m(S,k){return c.coerce(o,i,T,S,k)}var u=m("x"),_=m("y"),s=m("z");if(!s||!s.length||(u?u.length<1:!1)||(_?_.length<1:!1)){i.visible=!1;return}i._xlength=Array.isArray(u)&&c.isArrayOrTypedArray(u[0])?s.length:s[0].length,i._ylength=s.length;var A=w.getComponentMethod("calendars","handleTraceDefaults");A(o,i,["x","y","z"],p),m("text"),m("hovertext"),m("hovertemplate"),m("xhoverformat"),m("yhoverformat"),m("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(S){m(S)});var x=m("surfacecolor"),v=["x","y","z"];for(y=0;y<3;++y){var b="contours."+v[y],l=m(b+".show"),L=m(b+".highlight");if(l||L)for(h=0;h<3;++h)m(b+".project."+v[h]);l&&(m(b+".color"),m(b+".width"),m(b+".usecolormap")),L&&(m(b+".highlightcolor"),m(b+".highlightwidth")),m(b+".start"),m(b+".end"),m(b+".size")}x||(f(o,"zmin","cmin"),f(o,"zmax","cmax"),f(o,"zauto","cauto")),M(o,i,p,m,{prefix:"",cLetter:"c"}),t(o,i,p,m),i._length=null}function t(o,i,g,p){var y=p("opacityscale");y==="max"?i.opacityscale=[[0,e],[1,1]]:y==="min"?i.opacityscale=[[0,1],[1,e]]:y==="extremes"?i.opacityscale=a(1,e):n(y)||(i.opacityscale=void 0)}function f(o,i,g){i in o&&!(g in o)&&(o[g]=o[i])}re.exports={supplyDefaults:r,opacityscaleDefaults:t}},{"../../components/colorscale/defaults":376,"../../lib":503,"../../registry":638,"./attributes":1061}],1065:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:d("./calc"),plot:d("./convert"),moduleType:"trace",name:"surface",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":598,"./attributes":1061,"./calc":1062,"./convert":1063,"./defaults":1064}],1066:[function(d,re,ne){var w=d("../../components/annotations/attributes"),c=d("../../lib/extend").extendFlat,M=d("../../plot_api/edit_types").overrideAll,T=d("../../plots/font_attributes"),e=d("../../plots/domain").attributes,a=d("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,n=re.exports=M({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:a("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:c({},w.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:c({},T({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:a("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:c({},w.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:c({},T({arrayOk:!0}))}},"calc","from-root");n.transforms=void 0},{"../../components/annotations/attributes":349,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/cartesian/axis_format_attributes":557,"../../plots/domain":584,"../../plots/font_attributes":585}],1067:[function(d,re,ne){var w=d("../../plots/get_data").getModuleCalcData,c=d("./plot"),M="table";ne.name=M,ne.plot=function(T){var e=w(T.calcdata,M)[0];e.length&&c(T,e)},ne.clean=function(T,e,a,n){var r=n._has&&n._has(M),t=e._has&&e._has(M);r&&!t&&n._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":593,"./plot":1074}],1068:[function(d,re,ne){var w=d("../../lib/gup").wrap;re.exports=function(){return w({})}},{"../../lib/gup":500}],1069:[function(d,re,ne){re.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1070:[function(d,re,ne){var w=d("./constants"),c=d("../../lib/extend").extendFlat,M=d("fast-isnumeric");re.exports=function(g,p){var y=a(p.cells.values),h=function(G){return G.slice(p.header.values.length,G.length)},m=a(p.header.values);m.length&&!m[0].length&&(m[0]=[""],m=a(m));var u=m.concat(h(y).map(function(){return n((m[0]||[""]).length)})),_=p.domain,s=Math.floor(g._fullLayout._size.w*(_.x[1]-_.x[0])),A=Math.floor(g._fullLayout._size.h*(_.y[1]-_.y[0])),x=p.header.values.length?u[0].map(function(){return p.header.height}):[w.emptyHeaderHeight],v=y.length?y[0].map(function(){return p.cells.height}):[],b=x.reduce(e,0),l=A-b,L=l+w.uplift,S=f(v,L),k=f(x,b),P=t(k,[]),z=t(S,P),I={},D=p._fullInput.columnorder.concat(h(y.map(function(G,J){return J}))),R=u.map(function(G,J){var j=Array.isArray(p.columnwidth)?p.columnwidth[Math.min(J,p.columnwidth.length-1)]:p.columnwidth;return M(j)?Number(j):1}),B=R.reduce(e,0);R=R.map(function(G){return G/B*s});var F=Math.max(T(p.header.line.width),T(p.cells.line.width)),V={key:p.uid+g._context.staticPlot,translateX:_.x[0]*g._fullLayout._size.w,translateY:g._fullLayout._size.h*(1-_.y[1]),size:g._fullLayout._size,width:s,maxLineWidth:F,height:A,columnOrder:D,groupHeight:A,rowBlocks:z,headerRowBlocks:P,scrollY:0,cells:c({},p.cells,{values:y}),headerCells:c({},p.header,{values:u}),gdColumns:u.map(function(G){return G[0]}),gdColumnsOriginalOrder:u.map(function(G){return G[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:u.map(function(G,J){var j=I[G];I[G]=(j||0)+1;var Y=G+"__"+I[G];return{key:Y,label:G,specIndex:J,xIndex:D[J],xScale:r,x:void 0,calcdata:void 0,columnWidth:R[J]}})};return V.columns.forEach(function(G){G.calcdata=V,G.x=r(G)}),V};function T(i){if(Array.isArray(i)){for(var g=0,p=0;p<i.length;p++)g=Math.max(g,T(i[p]));return g}return i}function e(i,g){return i+g}function a(i){var g=i.slice(),p=1/0,y=0,h;for(h=0;h<g.length;h++)Array.isArray(g[h])||(g[h]=[g[h]]),p=Math.min(p,g[h].length),y=Math.max(y,g[h].length);if(p!==y)for(h=0;h<g.length;h++){var m=y-g[h].length;m&&(g[h]=g[h].concat(n(m)))}return g}function n(i){for(var g=new Array(i),p=0;p<i;p++)g[p]="";return g}function r(i){return i.calcdata.columns.reduce(function(g,p){return p.xIndex<i.xIndex?g+p.columnWidth:g},0)}function t(i,g){var p=Object.keys(i);return p.map(function(y){return c({},i[y],{auxiliaryBlocks:g})})}function f(i,g){for(var p={},y,h=0,m=0,u=o(),_=0,s=0,A=0;A<i.length;A++)y=i[A],u.rows.push({rowIndex:A,rowHeight:y}),m+=y,(m>=g||A===i.length-1)&&(p[h]=u,u.key=s++,u.firstRowIndex=_,u.lastRowIndex=A,u=o(),h+=m,_=A+1,m=0);return p}function o(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}},{"../../lib/extend":493,"./constants":1069,"fast-isnumeric":190}],1071:[function(d,re,ne){var w=d("../../lib/extend").extendFlat;ne.splitToPanels=function(M){var T=[0,0],e=w({},M,{key:"header",type:"header",page:0,prevPages:T,currentRepaint:[null,null],dragHandle:!0,values:M.calcdata.headerCells.values[M.specIndex],rowBlocks:M.calcdata.headerRowBlocks,calcdata:w({},M.calcdata,{cells:M.calcdata.headerCells})}),a=w({},M,{key:"cells1",type:"cells",page:0,prevPages:T,currentRepaint:[null,null],dragHandle:!1,values:M.calcdata.cells.values[M.specIndex],rowBlocks:M.calcdata.rowBlocks}),n=w({},M,{key:"cells2",type:"cells",page:1,prevPages:T,currentRepaint:[null,null],dragHandle:!1,values:M.calcdata.cells.values[M.specIndex],rowBlocks:M.calcdata.rowBlocks});return[a,n,e]},ne.splitToCells=function(M){var T=c(M);return(M.values||[]).slice(T[0],T[1]).map(function(e,a){var n=typeof e=="string"&&e.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:a+n,key:T[0]+a,column:M,calcdata:M.calcdata,page:M.page,rowBlocks:M.rowBlocks,value:e}})};function c(M){var T=M.rowBlocks[M.page],e=T?T.rows[0].rowIndex:0,a=T?e+T.rows.length:0;return[e,a]}},{"../../lib/extend":493}],1072:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes"),M=d("../../plots/domain").defaults;function T(e,a){for(var n=e.columnorder||[],r=e.header.values.length,t=n.slice(0,r),f=t.slice().sort(function(g,p){return g-p}),o=t.map(function(g){return f.indexOf(g)}),i=o.length;i<r;i++)o.push(i);a("columnorder",o)}re.exports=function(a,n,r,t){function f(o,i){return w.coerce(a,n,c,o,i)}M(n,t,f),f("columnwidth"),f("header.values"),f("header.format"),f("header.align"),f("header.prefix"),f("header.suffix"),f("header.height"),f("header.line.width"),f("header.line.color"),f("header.fill.color"),w.coerceFont(f,"header.font",w.extendFlat({},t.font)),T(n,f),f("cells.values"),f("cells.format"),f("cells.align"),f("cells.prefix"),f("cells.suffix"),f("cells.height"),f("cells.line.width"),f("cells.line.color"),f("cells.fill.color"),w.coerceFont(f,"cells.font",w.extendFlat({},t.font)),n._length=null}},{"../../lib":503,"../../plots/domain":584,"./attributes":1066}],1073:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("./calc"),plot:d("./plot"),moduleType:"trace",name:"table",basePlotModule:d("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1066,"./base_plot":1067,"./calc":1068,"./defaults":1072,"./plot":1074}],1074:[function(d,re,ne){var w=d("./constants"),c=d("@plotly/d3"),M=d("../../lib"),T=M.numberFormat,e=d("../../lib/gup"),a=d("../../components/drawing"),n=d("../../lib/svg_text_utils"),r=d("../../lib").raiseToTop,t=d("../../lib").strTranslate,f=d("../../lib").cancelTransition,o=d("./data_preparation_helper"),i=d("./data_split_helpers"),g=d("../../components/color");re.exports=function(ee,te){var ae=!ee._context.staticPlot,le=ee._fullLayout._paper.selectAll("."+w.cn.table).data(te.map(function(Oe){var Pe=e.unwrap(Oe),Ue=Pe.trace;return o(ee,Ue)}),e.keyFun);le.exit().remove(),le.enter().append("g").classed(w.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),le.attr("width",function(Oe){return Oe.width+Oe.size.l+Oe.size.r}).attr("height",function(Oe){return Oe.height+Oe.size.t+Oe.size.b}).attr("transform",function(Oe){return t(Oe.translateX,Oe.translateY)});var ye=le.selectAll("."+w.cn.tableControlView).data(e.repeat,e.keyFun),fe=ye.enter().append("g").classed(w.cn.tableControlView,!0).style("box-sizing","content-box");if(ae){var pe="onwheel"in document?"wheel":"mousewheel";fe.on("mousemove",function(Oe){ye.filter(function(Pe){return Oe===Pe}).call(u,ee)}).on(pe,function(Oe){if(!Oe.scrollbarState.wheeling){Oe.scrollbarState.wheeling=!0;var Pe=Oe.scrollY+c.event.deltaY,Ue=j(ee,ye,null,Pe)(Oe);Ue||(c.event.stopPropagation(),c.event.preventDefault()),Oe.scrollbarState.wheeling=!1}}).call(u,ee,!0)}ye.attr("transform",function(Oe){return t(Oe.size.l,Oe.size.t)});var ge=ye.selectAll("."+w.cn.scrollBackground).data(e.repeat,e.keyFun);ge.enter().append("rect").classed(w.cn.scrollBackground,!0).attr("fill","none"),ge.attr("width",function(Oe){return Oe.width}).attr("height",function(Oe){return Oe.height}),ye.each(function(Oe){a.setClipUrl(c.select(this),y(ee,Oe),ee)});var Ae=ye.selectAll("."+w.cn.yColumn).data(function(Oe){return Oe.columns},e.keyFun);Ae.enter().append("g").classed(w.cn.yColumn,!0),Ae.exit().remove(),Ae.attr("transform",function(Oe){return t(Oe.x,0)}),ae&&Ae.call(c.behavior.drag().origin(function(Oe){var Pe=c.select(this);return R(Pe,Oe,-w.uplift),r(this),Oe.calcdata.columnDragInProgress=!0,u(ye.filter(function(Ue){return Oe.calcdata.key===Ue.key}),ee),Oe}).on("drag",function(Oe){var Pe=c.select(this),Ue=function(Yt){return(Oe===Yt?c.event.x:Yt.x)+Yt.columnWidth/2};Oe.x=Math.max(-w.overdrag,Math.min(Oe.calcdata.width+w.overdrag-Oe.columnWidth,c.event.x));var vt=m(Ae).filter(function(Yt){return Yt.calcdata.key===Oe.calcdata.key}),Lt=vt.sort(function(Yt,At){return Ue(Yt)-Ue(At)});Lt.forEach(function(Yt,At){Yt.xIndex=At,Yt.x=Oe===Yt?Yt.x:Yt.xScale(Yt)}),Ae.filter(function(Yt){return Oe!==Yt}).transition().ease(w.transitionEase).duration(w.transitionDuration).attr("transform",function(Yt){return t(Yt.x,0)}),Pe.call(f).attr("transform",t(Oe.x,-w.uplift))}).on("dragend",function(Oe){var Pe=c.select(this),Ue=Oe.calcdata;Oe.x=Oe.xScale(Oe),Oe.calcdata.columnDragInProgress=!1,R(Pe,Oe,0),I(ee,Ue,Ue.columns.map(function(vt){return vt.xIndex}))})),Ae.each(function(Oe){a.setClipUrl(c.select(this),h(ee,Oe),ee)});var we=Ae.selectAll("."+w.cn.columnBlock).data(i.splitToPanels,e.keyFun);we.enter().append("g").classed(w.cn.columnBlock,!0).attr("id",function(Oe){return Oe.key}),we.style("cursor",function(Oe){return Oe.dragHandle?"ew-resize":Oe.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var De=we.filter(F),Be=we.filter(B);ae&&Be.call(c.behavior.drag().origin(function(Oe){return c.event.stopPropagation(),Oe}).on("drag",j(ee,ye,-1)).on("dragend",function(){})),_(ee,ye,De,we),_(ee,ye,Be,we);var Ve=ye.selectAll("."+w.cn.scrollAreaClip).data(e.repeat,e.keyFun);Ve.enter().append("clipPath").classed(w.cn.scrollAreaClip,!0).attr("id",function(Oe){return y(ee,Oe)});var xe=Ve.selectAll("."+w.cn.scrollAreaClipRect).data(e.repeat,e.keyFun);xe.enter().append("rect").classed(w.cn.scrollAreaClipRect,!0).attr("x",-w.overdrag).attr("y",-w.uplift).attr("fill","none"),xe.attr("width",function(Oe){return Oe.width+2*w.overdrag}).attr("height",function(Oe){return Oe.height+w.uplift});var Le=Ae.selectAll("."+w.cn.columnBoundary).data(e.repeat,e.keyFun);Le.enter().append("g").classed(w.cn.columnBoundary,!0);var He=Ae.selectAll("."+w.cn.columnBoundaryClippath).data(e.repeat,e.keyFun);He.enter().append("clipPath").classed(w.cn.columnBoundaryClippath,!0),He.attr("id",function(Oe){return h(ee,Oe)});var Je=He.selectAll("."+w.cn.columnBoundaryRect).data(e.repeat,e.keyFun);Je.enter().append("rect").classed(w.cn.columnBoundaryRect,!0).attr("fill","none"),Je.attr("width",function(Oe){return Oe.columnWidth+2*p(Oe)}).attr("height",function(Oe){return Oe.calcdata.height+2*p(Oe)+w.uplift}).attr("x",function(Oe){return-p(Oe)}).attr("y",function(Oe){return-p(Oe)}),J(null,Be,ye)};function p(Z){return Math.ceil(Z.calcdata.maxLineWidth/2)}function y(Z,ee){return"clip"+Z._fullLayout._uid+"_scrollAreaBottomClip_"+ee.key}function h(Z,ee){return"clip"+Z._fullLayout._uid+"_columnBoundaryClippath_"+ee.calcdata.key+"_"+ee.specIndex}function m(Z){return[].concat.apply([],Z.map(function(ee){return ee})).map(function(ee){return ee.__data__})}function u(Z,ee,te){function ae(Ae){var we=Ae.rowBlocks;return N(we,we.length-1)+(we.length?U(we[we.length-1],1/0):1)}var le=Z.selectAll("."+w.cn.scrollbarKit).data(e.repeat,e.keyFun);le.enter().append("g").classed(w.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),le.each(function(Ae){var we=Ae.scrollbarState;we.totalHeight=ae(Ae),we.scrollableAreaHeight=Ae.groupHeight-V(Ae),we.currentlyVisibleHeight=Math.min(we.totalHeight,we.scrollableAreaHeight),we.ratio=we.currentlyVisibleHeight/we.totalHeight,we.barLength=Math.max(we.ratio*we.currentlyVisibleHeight,w.goldenRatio*w.scrollbarWidth),we.barWiggleRoom=we.currentlyVisibleHeight-we.barLength,we.wiggleRoom=Math.max(0,we.totalHeight-we.scrollableAreaHeight),we.topY=we.barWiggleRoom===0?0:Ae.scrollY/we.wiggleRoom*we.barWiggleRoom,we.bottomY=we.topY+we.barLength,we.dragMultiplier=we.wiggleRoom/we.barWiggleRoom}).attr("transform",function(Ae){var we=Ae.width+w.scrollbarWidth/2+w.scrollbarOffset;return t(we,V(Ae))});var ye=le.selectAll("."+w.cn.scrollbar).data(e.repeat,e.keyFun);ye.enter().append("g").classed(w.cn.scrollbar,!0);var fe=ye.selectAll("."+w.cn.scrollbarSlider).data(e.repeat,e.keyFun);fe.enter().append("g").classed(w.cn.scrollbarSlider,!0),fe.attr("transform",function(Ae){return t(0,Ae.scrollbarState.topY||0)});var pe=fe.selectAll("."+w.cn.scrollbarGlyph).data(e.repeat,e.keyFun);pe.enter().append("line").classed(w.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",w.scrollbarWidth).attr("stroke-linecap","round").attr("y1",w.scrollbarWidth/2),pe.attr("y2",function(Ae){return Ae.scrollbarState.barLength-w.scrollbarWidth/2}).attr("stroke-opacity",function(Ae){return Ae.columnDragInProgress||!Ae.scrollbarState.barWiggleRoom||te?0:.4}),pe.transition().delay(0).duration(0),pe.transition().delay(w.scrollbarHideDelay).duration(w.scrollbarHideDuration).attr("stroke-opacity",0);var ge=ye.selectAll("."+w.cn.scrollbarCaptureZone).data(e.repeat,e.keyFun);ge.enter().append("line").classed(w.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",w.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(Ae){var we=c.event.y,De=this.getBoundingClientRect(),Be=Ae.scrollbarState,Ve=we-De.top,xe=c.scale.linear().domain([0,Be.scrollableAreaHeight]).range([0,Be.totalHeight]).clamp(!0);Be.topY<=Ve&&Ve<=Be.bottomY||j(ee,Z,null,xe(Ve-Be.barLength/2))(Ae)}).call(c.behavior.drag().origin(function(Ae){return c.event.stopPropagation(),Ae.scrollbarState.scrollbarScrollInProgress=!0,Ae}).on("drag",j(ee,Z)).on("dragend",function(){})),ge.attr("y2",function(Ae){return Ae.scrollbarState.scrollableAreaHeight}),ee._context.staticPlot&&(pe.remove(),ge.remove())}function _(Z,ee,te,ae){var le=s(te),ye=A(le);l(ye);var fe=x(ye);S(fe);var pe=b(ye),ge=v(pe);L(ge),k(ge,ee,ae,Z),ie(ye)}function s(Z){var ee=Z.selectAll("."+w.cn.columnCells).data(e.repeat,e.keyFun);return ee.enter().append("g").classed(w.cn.columnCells,!0),ee.exit().remove(),ee}function A(Z){var ee=Z.selectAll("."+w.cn.columnCell).data(i.splitToCells,function(te){return te.keyWithinBlock});return ee.enter().append("g").classed(w.cn.columnCell,!0),ee.exit().remove(),ee}function x(Z){var ee=Z.selectAll("."+w.cn.cellRect).data(e.repeat,function(te){return te.keyWithinBlock});return ee.enter().append("rect").classed(w.cn.cellRect,!0),ee}function v(Z){var ee=Z.selectAll("."+w.cn.cellText).data(e.repeat,function(te){return te.keyWithinBlock});return ee.enter().append("text").classed(w.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){c.event.stopPropagation()}),ee}function b(Z){var ee=Z.selectAll("."+w.cn.cellTextHolder).data(e.repeat,function(te){return te.keyWithinBlock});return ee.enter().append("g").classed(w.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),ee}function l(Z){Z.each(function(ee,te){var ae=ee.calcdata.cells.font,le=ee.column.specIndex,ye={size:D(ae.size,le,te),color:D(ae.color,le,te),family:D(ae.family,le,te)};ee.rowNumber=ee.key,ee.align=D(ee.calcdata.cells.align,le,te),ee.cellBorderWidth=D(ee.calcdata.cells.line.width,le,te),ee.font=ye})}function L(Z){Z.each(function(ee){a.font(c.select(this),ee.font)})}function S(Z){Z.attr("width",function(ee){return ee.column.columnWidth}).attr("stroke-width",function(ee){return ee.cellBorderWidth}).each(function(ee){var te=c.select(this);g.stroke(te,D(ee.calcdata.cells.line.color,ee.column.specIndex,ee.rowNumber)),g.fill(te,D(ee.calcdata.cells.fill.color,ee.column.specIndex,ee.rowNumber))})}function k(Z,ee,te,ae){Z.text(function(le){var ye=le.column.specIndex,fe=le.rowNumber,pe=le.value,ge=typeof pe=="string",Ae=ge&&pe.match(/<br>/i),we=!ge||Ae;le.mayHaveMarkup=ge&&pe.match(/[<&>]/);var De=P(pe);le.latex=De;var Be=De?"":D(le.calcdata.cells.prefix,ye,fe)||"",Ve=De?"":D(le.calcdata.cells.suffix,ye,fe)||"",xe=De?null:D(le.calcdata.cells.format,ye,fe)||null,Le=Be+(xe?T(xe)(le.value):le.value)+Ve,He;le.wrappingNeeded=!le.wrapped&&!we&&!De&&(He=z(Le)),le.cellHeightMayIncrease=Ae||De||le.mayHaveMarkup||(He===void 0?z(Le):He),le.needsConvertToTspans=le.mayHaveMarkup||le.wrappingNeeded||le.latex;var Je;if(le.wrappingNeeded){var Oe=w.wrapSplitCharacter===" "?Le.replace(/<a href=/ig,"<a_href="):Le,Pe=Oe.split(w.wrapSplitCharacter),Ue=w.wrapSplitCharacter===" "?Pe.map(function(vt){return vt.replace(/<a_href=/ig,"<a href=")}):Pe;le.fragments=Ue.map(function(vt){return{text:vt,width:null}}),le.fragments.push({fragment:w.wrapSpacer,width:null}),Je=Ue.join(w.lineBreaker)+w.lineBreaker+w.wrapSpacer}else delete le.fragments,Je=Le;return Je}).attr("dy",function(le){return le.needsConvertToTspans?0:"0.75em"}).each(function(le){var ye=this,fe=c.select(ye),pe=le.wrappingNeeded?X:oe;le.needsConvertToTspans?n.convertToTspans(fe,ae,pe(te,ye,ee,ae,le)):c.select(ye.parentNode).attr("transform",function(ge){return t(se(ge),w.cellPad)}).attr("text-anchor",function(ge){return{left:"start",center:"middle",right:"end"}[ge.align]})})}function P(Z){return typeof Z=="string"&&Z.match(w.latexCheck)}function z(Z){return Z.indexOf(w.wrapSplitCharacter)!==-1}function I(Z,ee,te){var ae=ee.gdColumnsOriginalOrder;ee.gdColumns.sort(function(le,ye){return te[ae.indexOf(le)]-te[ae.indexOf(ye)]}),ee.columnorder=te,Z.emit("plotly_restyle")}function D(Z,ee,te){if(Array.isArray(Z)){var ae=Z[Math.min(ee,Z.length-1)];return Array.isArray(ae)?ae[Math.min(te,ae.length-1)]:ae}else return Z}function R(Z,ee,te){Z.transition().ease(w.releaseTransitionEase).duration(w.releaseTransitionDuration).attr("transform",t(ee.x,te))}function B(Z){return Z.type==="cells"}function F(Z){return Z.type==="header"}function V(Z){var ee=Z.rowBlocks.length?Z.rowBlocks[0].auxiliaryBlocks:[];return ee.reduce(function(te,ae){return te+U(ae,1/0)},0)}function G(Z,ee,te){for(var ae=[],le=0,ye=0;ye<Z.length;ye++){for(var fe=Z[ye],pe=fe.rows,ge=0,Ae=0;Ae<pe.length;Ae++)ge+=pe[Ae].rowHeight;fe.allRowsHeight=ge;var we=le+ge,De=ee,Be=De+te;De<we&&Be>le&&ae.push(ye),le+=ge}return ae}function J(Z,ee,te){var ae=m(ee)[0];if(ae!==void 0){var le=ae.rowBlocks,ye=ae.calcdata,fe=N(le,le.length),pe=ae.calcdata.groupHeight-V(ae),ge=ye.scrollY=Math.max(0,Math.min(fe-pe,ye.scrollY)),Ae=G(le,ge,pe);Ae.length===1&&(Ae[0]===le.length-1?Ae.unshift(Ae[0]-1):Ae.push(Ae[0]+1)),Ae[0]%2&&Ae.reverse(),ee.each(function(we,De){we.page=Ae[De],we.scrollY=ge}),ee.attr("transform",function(we){var De=N(we.rowBlocks,we.page)-we.scrollY;return t(0,De)}),Z&&(Y(Z,te,ee,Ae,ae.prevPages,ae,0),Y(Z,te,ee,Ae,ae.prevPages,ae,1),u(te,Z))}}function j(Z,ee,te,ae){return function(ye){var fe=ye.calcdata?ye.calcdata:ye,pe=ee.filter(function(De){return fe.key===De.key}),ge=te||fe.scrollbarState.dragMultiplier,Ae=fe.scrollY;fe.scrollY=ae===void 0?fe.scrollY+ge*c.event.dy:ae;var we=pe.selectAll("."+w.cn.yColumn).selectAll("."+w.cn.columnBlock).filter(B);return J(Z,we,pe),fe.scrollY===Ae}}function Y(Z,ee,te,ae,le,ye,fe){var pe=ae[fe]!==le[fe];pe&&(clearTimeout(ye.currentRepaint[fe]),ye.currentRepaint[fe]=setTimeout(function(){var ge=te.filter(function(Ae,we){return we===fe&&ae[we]!==le[we]});_(Z,ee,ge,te),le[fe]=ae[fe]}))}function X(Z,ee,te,ae){return function(){var ye=c.select(ee.parentNode);ye.each(function(fe){var pe=fe.fragments;ye.selectAll("tspan.line").each(function(Le,He){pe[He].width=this.getComputedTextLength()});var ge=pe[pe.length-1].width,Ae=pe.slice(0,-1),we=[],De,Be,Ve=0,xe=fe.column.columnWidth-2*w.cellPad;for(fe.value="";Ae.length;)De=Ae.shift(),Be=De.width+ge,Ve+Be>xe&&(fe.value+=we.join(w.wrapSpacer)+w.lineBreaker,we=[],Ve=0),we.push(De.text),Ve+=Be;Ve&&(fe.value+=we.join(w.wrapSpacer)),fe.wrapped=!0}),ye.selectAll("tspan.line").remove(),k(ye.select("."+w.cn.cellText),te,Z,ae),c.select(ee.parentNode.parentNode).call(ie)}}function oe(Z,ee,te,ae,le){return function(){if(!le.settledY){var fe=c.select(ee.parentNode),pe=Q(le),ge=le.key-pe.firstRowIndex,Ae=pe.rows[ge].rowHeight,we=le.cellHeightMayIncrease?ee.parentNode.getBoundingClientRect().height+2*w.cellPad:Ae,De=Math.max(we,Ae),Be=De-pe.rows[ge].rowHeight;Be&&(pe.rows[ge].rowHeight=De,Z.selectAll("."+w.cn.columnCell).call(ie),J(null,Z.filter(B),0),u(te,ae,!0)),fe.attr("transform",function(){var Ve=this,xe=Ve.parentNode,Le=xe.getBoundingClientRect(),He=c.select(Ve.parentNode).select("."+w.cn.cellRect).node().getBoundingClientRect(),Je=Ve.transform.baseVal.consolidate(),Oe=He.top-Le.top+(Je?Je.matrix.f:w.cellPad);return t(se(le,c.select(Ve.parentNode).select("."+w.cn.cellTextHolder).node().getBoundingClientRect().width),Oe)}),le.settledY=!0}}}function se(Z,ee){switch(Z.align){case"left":return w.cellPad;case"right":return Z.column.columnWidth-(ee||0)-w.cellPad;case"center":return(Z.column.columnWidth-(ee||0))/2;default:return w.cellPad}}function ie(Z){Z.attr("transform",function(ee){var te=ee.rowBlocks[0].auxiliaryBlocks.reduce(function(fe,pe){return fe+U(pe,1/0)},0),ae=Q(ee),le=U(ae,ee.key),ye=le+te;return t(0,ye)}).selectAll("."+w.cn.cellRect).attr("height",function(ee){return W(Q(ee),ee.key).rowHeight})}function N(Z,ee){for(var te=0,ae=ee-1;ae>=0;ae--)te+=q(Z[ae]);return te}function U(Z,ee){for(var te=0,ae=0;ae<Z.rows.length&&Z.rows[ae].rowIndex<ee;ae++)te+=Z.rows[ae].rowHeight;return te}function q(Z){var ee=Z.allRowsHeight;if(ee!==void 0)return ee;for(var te=0,ae=0;ae<Z.rows.length;ae++)te+=Z.rows[ae].rowHeight;return Z.allRowsHeight=te,te}function Q(Z){return Z.rowBlocks[Z.page]}function W(Z,ee){return Z.rows[ee-Z.firstRowIndex]}},{"../../components/color":366,"../../components/drawing":388,"../../lib":503,"../../lib/gup":500,"../../lib/svg_text_utils":529,"./constants":1069,"./data_preparation_helper":1070,"./data_split_helpers":1071,"@plotly/d3":58}],1075:[function(d,re,ne){var w=d("../../plots/template_attributes").hovertemplateAttrs,c=d("../../plots/template_attributes").texttemplateAttrs,M=d("../../components/colorscale/attributes"),T=d("../../plots/domain").attributes,e=d("../pie/attributes"),a=d("../sunburst/attributes"),n=d("./constants"),r=d("../../lib/extend").extendFlat;re.exports={labels:a.labels,parents:a.parents,values:a.values,branchvalues:a.branchvalues,count:a.count,level:a.level,maxdepth:a.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:r({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:a.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:a.marker.line,editType:"calc"},M("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:r({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:a.textinfo,texttemplate:c({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:a.hoverinfo,hovertemplate:w({},{keys:n.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:r({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:a.root,domain:T({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":901,"../sunburst/attributes":1049,"./constants":1078}],1076:[function(d,re,ne){var w=d("../../plots/plots");ne.name="treemap",ne.plot=function(c,M,T,e){w.plotBasePlot(ne.name,c,M,T,e)},ne.clean=function(c,M,T,e){w.cleanBasePlot(ne.name,c,M,T,e)}},{"../../plots/plots":619}],1077:[function(d,re,ne){var w=d("../sunburst/calc");ne.calc=function(c,M){return w.calc(c,M)},ne.crossTraceCalc=function(c){return w._runCrossTraceCalc("treemap",c)}},{"../sunburst/calc":1051}],1078:[function(d,re,ne){re.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1079:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes"),M=d("../../components/color"),T=d("../../plots/domain").defaults,e=d("../bar/defaults").handleText,a=d("../bar/constants").TEXTPAD,n=d("../../components/colorscale"),r=n.hasColorscale,t=n.handleDefaults;re.exports=function(o,i,g,p){function y(k,P){return w.coerce(o,i,c,k,P)}var h=y("labels"),m=y("parents");if(!h||!h.length||!m||!m.length){i.visible=!1;return}var u=y("values");u&&u.length?y("branchvalues"):y("count"),y("level"),y("maxdepth");var _=y("tiling.packing");_==="squarify"&&y("tiling.squarifyratio"),y("tiling.flip"),y("tiling.pad");var s=y("text");y("texttemplate"),i.texttemplate||y("textinfo",Array.isArray(s)?"text+label":"label"),y("hovertext"),y("hovertemplate");var A=y("pathbar.visible"),x="auto";e(o,i,p,y,x,{hasPathbar:A,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),y("textposition");var v=i.textposition.indexOf("bottom")!==-1,b=y("marker.line.width");b&&y("marker.line.color",p.paper_bgcolor);var l=y("marker.colors"),L=i._hasColorscale=r(o,"marker","colors")||(o.marker||{}).coloraxis;L?t(o,i,p,y,{prefix:"marker.",cLetter:"c"}):y("marker.depthfade",!(l||[]).length);var S=i.textfont.size*2;y("marker.pad.t",v?S/4:S),y("marker.pad.l",S/4),y("marker.pad.r",S/4),y("marker.pad.b",v?S:S/4),i._hovered={marker:{line:{width:2,color:M.contrast(p.paper_bgcolor)}}},A&&(y("pathbar.thickness",i.pathbar.textfont.size+2*a),y("pathbar.side"),y("pathbar.edgeshape")),y("sort"),y("root.color"),T(i,p,y),i._length=null}},{"../../components/color":366,"../../components/colorscale":378,"../../lib":503,"../../plots/domain":584,"../bar/constants":650,"../bar/defaults":652,"./attributes":1075}],1080:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../sunburst/helpers"),M=d("../bar/uniform_text"),T=M.clearMinTextSize,e=d("../bar/style").resizeText,a=d("./plot_one");re.exports=function(r,t,f,o,i){var g=i.type,p=i.drawDescendants,y=r._fullLayout,h=y["_"+g+"layer"],m,u,_=!f;if(T(g,y),m=h.selectAll("g.trace."+g).data(t,function(A){return A[0].trace.uid}),m.enter().append("g").classed("trace",!0).classed(g,!0),m.order(),!y.uniformtext.mode&&c.hasTransition(f)){o&&(u=o());var s=w.transition().duration(f.duration).ease(f.easing).each("end",function(){u&&u()}).each("interrupt",function(){u&&u()});s.each(function(){h.selectAll("g.trace").each(function(A){a(r,A,this,f,p)})})}else m.each(function(A){a(r,A,this,f,p)}),y.uniformtext.mode&&e(r,h.selectAll(".trace"),g);_&&m.exit().remove()}},{"../bar/style":662,"../bar/uniform_text":664,"../sunburst/helpers":1055,"./plot_one":1089,"@plotly/d3":58}],1081:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../components/drawing"),T=d("../../lib/svg_text_utils"),e=d("./partition"),a=d("./style").styleOne,n=d("./constants"),r=d("../sunburst/helpers"),t=d("../sunburst/fx"),f=!0;re.exports=function(i,g,p,y,h){var m=h.barDifY,u=h.width,_=h.height,s=h.viewX,A=h.viewY,x=h.pathSlice,v=h.toMoveInsideSlice,b=h.strTransform,l=h.hasTransition,L=h.handleSlicesExit,S=h.makeUpdateSliceInterpolator,k=h.makeUpdateTextInterpolator,P={},z=i._fullLayout,I=g[0],D=I.trace,R=I.hierarchy,B=u/D._entryDepth,F=r.listPath(p.data,"id"),V=e(R.copy(),[u,_],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();V=V.filter(function(J){var j=F.indexOf(J.data.id);return j===-1?!1:(J.x0=B*j,J.x1=B*(j+1),J.y0=m,J.y1=m+_,J.onPathbar=!0,!0)}),V.reverse(),y=y.data(V,r.getPtId),y.enter().append("g").classed("pathbar",!0),L(y,f,P,[u,_],x),y.order();var G=y;l&&(G=G.transition().each("end",function(){var J=w.select(this);r.setSliceCursor(J,i,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),G.each(function(J){J._x0=s(J.x0),J._x1=s(J.x1),J._y0=A(J.y0),J._y1=A(J.y1),J._hoverX=s(J.x1-Math.min(u,_)/2),J._hoverY=A(J.y1-_/2);var j=w.select(this),Y=c.ensureSingle(j,"path","surface",function(ie){ie.style("pointer-events","all")});l?Y.transition().attrTween("d",function(ie){var N=S(ie,f,P,[u,_]);return function(U){return x(N(U))}}):Y.attr("d",x),j.call(t,p,i,g,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,i,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:i._transitioning}),Y.call(a,J,D,{hovered:!1}),J._text=(r.getPtLabel(J)||"").split("<br>").join(" ")||"";var X=c.ensureSingle(j,"g","slicetext"),oe=c.ensureSingle(X,"text","",function(ie){ie.attr("data-notex",1)}),se=c.ensureUniformFontSize(i,r.determineTextFont(D,J,z.font,{onPathbar:!0}));oe.text(J._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(M.font,se).call(T.convertToTspans,i),J.textBB=M.bBox(oe.node()),J.transform=v(J,{fontSize:se.size,onPathbar:!0}),J.transform.fontSize=se.size,l?oe.transition().attrTween("transform",function(ie){var N=k(ie,f,P,[u,_]);return function(U){return b(N(U))}}):oe.attr("transform",b(J))})}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../sunburst/fx":1054,"../sunburst/helpers":1055,"./constants":1078,"./partition":1087,"./style":1090,"@plotly/d3":58}],1082:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../components/drawing"),T=d("../../lib/svg_text_utils"),e=d("./partition"),a=d("./style").styleOne,n=d("./constants"),r=d("../sunburst/helpers"),t=d("../sunburst/fx"),f=d("../sunburst/plot").formatSliceLabel,o=!1;re.exports=function(g,p,y,h,m){var u=m.width,_=m.height,s=m.viewX,A=m.viewY,x=m.pathSlice,v=m.toMoveInsideSlice,b=m.strTransform,l=m.hasTransition,L=m.handleSlicesExit,S=m.makeUpdateSliceInterpolator,k=m.makeUpdateTextInterpolator,P=m.prevEntry,z={},I=g._fullLayout,D=p[0],R=D.trace,B=R.textposition.indexOf("left")!==-1,F=R.textposition.indexOf("right")!==-1,V=R.textposition.indexOf("bottom")!==-1,G=!V&&!R.marker.pad.t||V&&!R.marker.pad.b,J=e(y,[u,_],{packing:R.tiling.packing,squarifyratio:R.tiling.squarifyratio,flipX:R.tiling.flip.indexOf("x")>-1,flipY:R.tiling.flip.indexOf("y")>-1,pad:{inner:R.tiling.pad,top:R.marker.pad.t,left:R.marker.pad.l,right:R.marker.pad.r,bottom:R.marker.pad.b}}),j=J.descendants(),Y=1/0,X=-1/0;j.forEach(function(U){var q=U.depth;q>=R._maxDepth?(U.x0=U.x1=(U.x0+U.x1)/2,U.y0=U.y1=(U.y0+U.y1)/2):(Y=Math.min(Y,q),X=Math.max(X,q))}),h=h.data(j,r.getPtId),R._maxVisibleLayers=isFinite(X)?X-Y+1:0,h.enter().append("g").classed("slice",!0),L(h,o,z,[u,_],x),h.order();var oe=null;if(l&&P){var se=r.getPtId(P);h.each(function(U){oe===null&&r.getPtId(U)===se&&(oe={x0:U.x0,x1:U.x1,y0:U.y0,y1:U.y1})})}var ie=function(){return oe||{x0:0,x1:u,y0:0,y1:_}},N=h;return l&&(N=N.transition().each("end",function(){var U=w.select(this);r.setSliceCursor(U,g,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),N.each(function(U){var q=r.isHeader(U,R);U._x0=s(U.x0),U._x1=s(U.x1),U._y0=A(U.y0),U._y1=A(U.y1),U._hoverX=s(U.x1-R.marker.pad.r),U._hoverY=A(V?U.y1-R.marker.pad.b/2:U.y0+R.marker.pad.t/2);var Q=w.select(this),W=c.ensureSingle(Q,"path","surface",function(ae){ae.style("pointer-events","all")});l?W.transition().attrTween("d",function(ae){var le=S(ae,o,ie(),[u,_]);return function(ye){return x(le(ye))}}):W.attr("d",x),Q.call(t,y,g,p,{styleOne:a,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(r.setSliceCursor,g,{isTransitioning:g._transitioning}),W.call(a,U,R,{hovered:!1}),U.x0===U.x1||U.y0===U.y1?U._text="":q?U._text=G?"":r.getPtLabel(U)||"":U._text=f(U,y,R,p,I)||"";var Z=c.ensureSingle(Q,"g","slicetext"),ee=c.ensureSingle(Z,"text","",function(ae){ae.attr("data-notex",1)}),te=c.ensureUniformFontSize(g,r.determineTextFont(R,U,I.font));ee.text(U._text||" ").classed("slicetext",!0).attr("text-anchor",F?"end":B||q?"start":"middle").call(M.font,te).call(T.convertToTspans,g),U.textBB=M.bBox(ee.node()),U.transform=v(U,{fontSize:te.size,isHeader:q}),U.transform.fontSize=te.size,l?ee.transition().attrTween("transform",function(ae){var le=k(ae,o,ie(),[u,_]);return function(ye){return b(le(ye))}}):ee.attr("transform",b(U))}),oe}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../sunburst/fx":1054,"../sunburst/helpers":1055,"../sunburst/plot":1059,"./constants":1078,"./partition":1087,"./style":1090,"@plotly/d3":58}],1083:[function(d,re,ne){re.exports=function w(c,M,T){var e;T.swapXY&&(e=c.x0,c.x0=c.y0,c.y0=e,e=c.x1,c.x1=c.y1,c.y1=e),T.flipX&&(e=c.x0,c.x0=M[0]-c.x1,c.x1=M[0]-e),T.flipY&&(e=c.y0,c.y0=M[1]-c.y1,c.y1=M[1]-e);var a=c.children;if(a)for(var n=0;n<a.length;n++)w(a[n],M,T)}},{}],1084:[function(d,re,ne){re.exports={moduleType:"trace",name:"treemap",basePlotModule:d("./base_plot"),categories:[],animatable:!0,attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc").calc,crossTraceCalc:d("./calc").crossTraceCalc,plot:d("./plot"),style:d("./style").style,colorbar:d("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":945,"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1079,"./layout_attributes":1085,"./layout_defaults":1086,"./plot":1088,"./style":1090}],1085:[function(d,re,ne){re.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1086:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes");re.exports=function(T,e){function a(n,r){return w.coerce(T,e,c,n,r)}a("treemapcolorway",e.colorway),a("extendtreemapcolors")}},{"../../lib":503,"./layout_attributes":1085}],1087:[function(d,re,ne){var w=d("d3-hierarchy"),c=d("./flip_tree");re.exports=function(e,a,n){var r=n.flipX,t=n.flipY,f=n.packing==="dice-slice",o=n.pad[t?"bottom":"top"],i=n.pad[r?"right":"left"],g=n.pad[r?"left":"right"],p=n.pad[t?"top":"bottom"],y;f&&(y=i,i=o,o=y,y=g,g=p,p=y);var h=w.treemap().tile(M(n.packing,n.squarifyratio)).paddingInner(n.pad.inner).paddingLeft(i).paddingRight(g).paddingTop(o).paddingBottom(p).size(f?[a[1],a[0]]:a)(e);return(f||r||t)&&c(h,a,{swapXY:f,flipX:r,flipY:t}),h};function M(T,e){switch(T){case"squarify":return w.treemapSquarify.ratio(e);case"binary":return w.treemapBinary;case"dice":return w.treemapDice;case"slice":return w.treemapSlice;default:return w.treemapSliceDice}}},{"./flip_tree":1083,"d3-hierarchy":115}],1088:[function(d,re,ne){var w=d("./draw"),c=d("./draw_descendants");re.exports=function(T,e,a,n){return w(T,e,a,n,{type:"treemap",drawDescendants:c})}},{"./draw":1080,"./draw_descendants":1082}],1089:[function(d,re,ne){var w=d("@plotly/d3"),c=d("d3-interpolate").interpolate,M=d("../sunburst/helpers"),T=d("../../lib"),e=d("../bar/constants").TEXTPAD,a=d("../bar/plot"),n=a.toMoveInsideBar,r=d("../bar/uniform_text"),t=r.recordMinTextSize,f=d("./constants"),o=d("./draw_ancestors");function i(g){return M.isHierarchyRoot(g)?"":M.getPtId(g)}re.exports=function(p,y,h,m,u){var _=p._fullLayout,s=y[0],A=s.trace,x=A.type,v=x==="icicle",b=s.hierarchy,l=M.findEntryWithLevel(b,A.level),L=w.select(h),S=L.selectAll("g.pathbar"),k=L.selectAll("g.slice");if(!l){S.remove(),k.remove();return}var P=M.isHierarchyRoot(l),z=!_.uniformtext.mode&&M.hasTransition(m),I=M.getMaxDepth(A),D=function(Ue){return Ue.data.depth-l.data.depth<I},R=_._size,B=A.domain,F=R.w*(B.x[1]-B.x[0]),V=R.h*(B.y[1]-B.y[0]),G=F,J=A.pathbar.thickness,j=A.marker.line.width+f.gapWithPathbar,Y=A.pathbar.visible?A.pathbar.side.indexOf("bottom")>-1?V+j:-(J+j):0,X={x0:G,x1:G,y0:Y,y1:Y+J},oe=function(Ue,vt,Lt){var Yt=A.tiling.pad,At=function(Tt){return Tt-Yt<=vt.x0},Rt=function(Tt){return Tt+Yt>=vt.x1},Bt=function(Tt){return Tt-Yt<=vt.y0},Mt=function(Tt){return Tt+Yt>=vt.y1};return Ue.x0===vt.x0&&Ue.x1===vt.x1&&Ue.y0===vt.y0&&Ue.y1===vt.y1?{x0:Ue.x0,x1:Ue.x1,y0:Ue.y0,y1:Ue.y1}:{x0:At(Ue.x0-Yt)?0:Rt(Ue.x0-Yt)?Lt[0]:Ue.x0,x1:At(Ue.x1+Yt)?0:Rt(Ue.x1+Yt)?Lt[0]:Ue.x1,y0:Bt(Ue.y0-Yt)?0:Mt(Ue.y0-Yt)?Lt[1]:Ue.y0,y1:Bt(Ue.y1+Yt)?0:Mt(Ue.y1+Yt)?Lt[1]:Ue.y1}},se=null,ie={},N={},U=null,q=function(Ue,vt){return vt?ie[i(Ue)]:N[i(Ue)]},Q=function(Ue,vt,Lt,Yt){if(vt)return ie[i(b)]||X;var At=N[A.level]||Lt;return D(Ue)?oe(Ue,At,Yt):{}};s.hasMultipleRoots&&P&&I++,A._maxDepth=I,A._backgroundColor=_.paper_bgcolor,A._entryDepth=l.data.depth,A._atRootLevel=P;var W=-F/2+R.l+R.w*(B.x[1]+B.x[0])/2,Z=-V/2+R.t+R.h*(1-(B.y[1]+B.y[0])/2),ee=function(Ue){return W+Ue},te=function(Ue){return Z+Ue},ae=te(0),le=ee(0),ye=function(Ue){return le+Ue},fe=function(Ue){return ae+Ue};function pe(Ue,vt){return Ue+","+vt}var ge=ye(0),Ae=function(Ue){Ue.x=Math.max(ge,Ue.x)},we=A.pathbar.edgeshape,De=function(Ue){var vt=ye(Math.max(Math.min(Ue.x0,Ue.x0),0)),Lt=ye(Math.min(Math.max(Ue.x1,Ue.x1),G)),Yt=fe(Ue.y0),At=fe(Ue.y1),Rt=J/2,Bt={},Mt={};Bt.x=vt,Mt.x=Lt,Bt.y=Mt.y=(Yt+At)/2;var Tt={x:vt,y:Yt},at={x:Lt,y:Yt},ct={x:Lt,y:At},je={x:vt,y:At};return we===">"?(Tt.x-=Rt,at.x-=Rt,ct.x-=Rt,je.x-=Rt):we==="/"?(ct.x-=Rt,je.x-=Rt,Bt.x-=Rt/2,Mt.x-=Rt/2):we==="\\"?(Tt.x-=Rt,at.x-=Rt,Bt.x-=Rt/2,Mt.x-=Rt/2):we==="<"&&(Bt.x-=Rt,Mt.x-=Rt),Ae(Tt),Ae(je),Ae(Bt),Ae(at),Ae(ct),Ae(Mt),"M"+pe(Tt.x,Tt.y)+"L"+pe(at.x,at.y)+"L"+pe(Mt.x,Mt.y)+"L"+pe(ct.x,ct.y)+"L"+pe(je.x,je.y)+"L"+pe(Bt.x,Bt.y)+"Z"},Be=function(Ue){var vt=ee(Ue.x0),Lt=ee(Ue.x1),Yt=te(Ue.y0),At=te(Ue.y1),Rt=Lt-vt,Bt=At-Yt;if(!Rt||!Bt)return"";var Mt=0,Tt=Rt>2*Mt&&Bt>2*Mt?Mt:0,at=function(ct,je){return Tt?"a"+pe(Tt,Tt)+" 0 0 1 "+pe(ct,je):""};return"M"+pe(vt,Yt+Tt)+at(Tt,-Tt)+"L"+pe(Lt-Tt,Yt)+at(Tt,Tt)+"L"+pe(Lt,At-Tt)+at(-Tt,Tt)+"L"+pe(vt+Tt,At)+at(-Tt,-Tt)+"Z"},Ve=function(Ue,vt){var Lt=Ue.x0,Yt=Ue.x1,At=Ue.y0,Rt=Ue.y1,Bt=Ue.textBB,Mt=function(zt){return A.textposition.indexOf(zt)!==-1},Tt=Mt("bottom"),at=Mt("top")||vt.isHeader&&!Tt,ct=at?"start":Tt?"end":"middle",je=Mt("right"),ke=Mt("left")||vt.onPathbar,Ye=ke?-1:je?1:0,Ke=A[v?"tiling":"marker"].pad;if(vt.isHeader){if(Lt+=(v?Ke:Ke.l)-e,Yt-=(v?Ke:Ke.r)-e,Lt>=Yt){var st=(Lt+Yt)/2;Lt=st,Yt=st}var Et;Tt?(Et=Rt-(v?Ke:Ke.b),At<Et&&Et<Rt&&(At=Et)):(Et=At+(v?Ke:Ke.t),At<Et&&Et<Rt&&(Rt=Et))}var bt=n(Lt,Yt,At,Rt,Bt,{isHorizontal:!1,constrained:!0,angle:0,anchor:ct,leftToRight:Ye});return bt.fontSize=vt.fontSize,bt.targetX=ee(bt.targetX),bt.targetY=te(bt.targetY),isNaN(bt.targetX)||isNaN(bt.targetY)?{}:(Lt!==Yt&&At!==Rt&&t(A.type,bt,_),{scale:bt.scale,rotate:bt.rotate,textX:bt.textX,textY:bt.textY,anchorX:bt.anchorX,anchorY:bt.anchorY,targetX:bt.targetX,targetY:bt.targetY})},xe=function(Ue,vt){for(var Lt,Yt=0,At=Ue;!Lt&&Yt<I;)Yt++,At=At.parent,At?Lt=q(At,vt):Yt=I;return Lt||{}},Le=function(Ue,vt,Lt,Yt){var At=q(Ue,vt),Rt;if(vt)Rt=X;else{var Bt=q(l,vt);Bt?Rt=oe(Ue,Bt,Yt):Rt={}}return c(At,Rt)},He=function(Ue,vt,Lt,Yt,At){var Rt=q(Ue,vt),Bt;if(Rt)Bt=Rt;else if(vt)Bt=X;else if(se)if(Ue.parent){var Mt=U||Lt;Mt&&!vt?Bt=oe(Ue,Mt,Yt):(Bt={},T.extendFlat(Bt,xe(Ue,vt)))}else Bt=T.extendFlat({},Ue),v&&(At.orientation==="h"?At.flipX?Bt.x0=Ue.x1:Bt.x1=0:At.flipY?Bt.y0=Ue.y1:Bt.y1=0);else Bt={};return c(Bt,{x0:Ue.x0,x1:Ue.x1,y0:Ue.y0,y1:Ue.y1})},Je=function(Ue,vt,Lt,Yt){var At=q(Ue,vt),Rt={},Bt=Q(Ue,vt,Lt,Yt);T.extendFlat(Rt,{transform:Ve({x0:Bt.x0,x1:Bt.x1,y0:Bt.y0,y1:Bt.y1,textBB:Ue.textBB,_text:Ue._text},{isHeader:M.isHeader(Ue,A)})}),At?Rt=At:Ue.parent&&T.extendFlat(Rt,xe(Ue,vt));var Mt=Ue.transform;return Ue.x0!==Ue.x1&&Ue.y0!==Ue.y1&&t(A.type,Mt,_),c(Rt,{transform:{scale:Mt.scale,rotate:Mt.rotate,textX:Mt.textX,textY:Mt.textY,anchorX:Mt.anchorX,anchorY:Mt.anchorY,targetX:Mt.targetX,targetY:Mt.targetY}})},Oe=function(Ue,vt,Lt,Yt,At){var Rt=Yt[0],Bt=Yt[1];z?Ue.exit().transition().each(function(){var Mt=w.select(this),Tt=Mt.select("path.surface");Tt.transition().attrTween("d",function(ct){var je=Le(ct,vt,Lt,[Rt,Bt]);return function(ke){return At(je(ke))}});var at=Mt.select("g.slicetext");at.attr("opacity",0)}).remove():Ue.exit().remove()},Pe=function(Ue){var vt=Ue.transform;return Ue.x0!==Ue.x1&&Ue.y0!==Ue.y1&&t(A.type,vt,_),T.getTextTransform({textX:vt.textX,textY:vt.textY,anchorX:vt.anchorX,anchorY:vt.anchorY,targetX:vt.targetX,targetY:vt.targetY,scale:vt.scale,rotate:vt.rotate})};z&&(S.each(function(Ue){ie[i(Ue)]={x0:Ue.x0,x1:Ue.x1,y0:Ue.y0,y1:Ue.y1},Ue.transform&&(ie[i(Ue)].transform={textX:Ue.transform.textX,textY:Ue.transform.textY,anchorX:Ue.transform.anchorX,anchorY:Ue.transform.anchorY,targetX:Ue.transform.targetX,targetY:Ue.transform.targetY,scale:Ue.transform.scale,rotate:Ue.transform.rotate})}),k.each(function(Ue){N[i(Ue)]={x0:Ue.x0,x1:Ue.x1,y0:Ue.y0,y1:Ue.y1},Ue.transform&&(N[i(Ue)].transform={textX:Ue.transform.textX,textY:Ue.transform.textY,anchorX:Ue.transform.anchorX,anchorY:Ue.transform.anchorY,targetX:Ue.transform.targetX,targetY:Ue.transform.targetY,scale:Ue.transform.scale,rotate:Ue.transform.rotate}),!se&&M.isEntry(Ue)&&(se=Ue)})),U=u(p,y,l,k,{width:F,height:V,viewX:ee,viewY:te,pathSlice:Be,toMoveInsideSlice:Ve,prevEntry:se,makeUpdateSliceInterpolator:He,makeUpdateTextInterpolator:Je,handleSlicesExit:Oe,hasTransition:z,strTransform:Pe}),A.pathbar.visible?o(p,y,l,S,{barDifY:Y,width:G,height:J,viewX:ye,viewY:fe,pathSlice:De,toMoveInsideSlice:Ve,makeUpdateSliceInterpolator:He,makeUpdateTextInterpolator:Je,handleSlicesExit:Oe,hasTransition:z,strTransform:Pe}):S.remove()}},{"../../lib":503,"../bar/constants":650,"../bar/plot":659,"../bar/uniform_text":664,"../sunburst/helpers":1055,"./constants":1078,"./draw_ancestors":1081,"@plotly/d3":58,"d3-interpolate":116}],1090:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/color"),M=d("../../lib"),T=d("../sunburst/helpers"),e=d("../bar/uniform_text").resizeText;function a(r){var t=r._fullLayout._treemaplayer.selectAll(".trace");e(r,t,"treemap"),t.each(function(f){var o=w.select(this),i=f[0],g=i.trace;o.style("opacity",g.opacity),o.selectAll("path.surface").each(function(p){w.select(this).call(n,p,g,{hovered:!1})})})}function n(r,t,f,o){var i=(o||{}).hovered,g=t.data.data,p=g.i,y,h,m=g.color,u=T.isHierarchyRoot(t),_=1;if(i)y=f._hovered.marker.line.color,h=f._hovered.marker.line.width;else if(u&&m===f.root.color)_=100,y="rgba(0,0,0,0)",h=0;else if(y=M.castOption(f,p,"marker.line.color")||c.defaultLine,h=M.castOption(f,p,"marker.line.width")||0,!f._hasColorscale&&!t.onPathbar){var s=f.marker.depthfade;if(s){var A=c.combine(c.addOpacity(f._backgroundColor,.75),m),x;if(s===!0){var v=T.getMaxDepth(f);isFinite(v)?T.isLeaf(t)?x=0:x=f._maxVisibleLayers-(t.data.depth-f._entryDepth):x=t.data.height+1}else x=t.data.depth-f._entryDepth,f._atRootLevel||x++;if(x>0)for(var b=0;b<x;b++){var l=.5*b/x;m=c.combine(c.addOpacity(A,l),m)}}}r.style("stroke-width",h).call(c.fill,m).call(c.stroke,y).style("opacity",_)}re.exports={style:a,styleOne:n}},{"../../components/color":366,"../../lib":503,"../bar/uniform_text":664,"../sunburst/helpers":1055,"@plotly/d3":58}],1091:[function(d,re,ne){var w=d("../box/attributes"),c=d("../../lib/extend").extendFlat,M=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat;re.exports={y:w.y,x:w.x,x0:w.x0,y0:w.y0,xhoverformat:M("x"),yhoverformat:M("y"),name:c({},w.name,{}),orientation:c({},w.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:w.fillcolor,points:c({},w.boxpoints,{}),jitter:c({},w.jitter,{}),pointpos:c({},w.pointpos,{}),width:c({},w.width,{}),marker:w.marker,text:w.text,hovertext:w.hovertext,hovertemplate:w.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:w.offsetgroup,alignmentgroup:w.alignmentgroup,selected:w.selected,unselected:w.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../box/attributes":673}],1092:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes"),M=d("../box/calc"),T=d("./helpers"),e=d("../../constants/numerical").BADNUM;re.exports=function(f,o){var i=M(f,o);if(i[0].t.empty)return i;for(var g=f._fullLayout,p=c.getFromId(f,o[o.orientation==="h"?"xaxis":"yaxis"]),y=1/0,h=-1/0,m=0,u=0,_=0;_<i.length;_++){var s=i[_],A=s.pts.map(T.extractVal),x=s.bandwidth=n(o,s,A),v=s.span=r(o,s,p,x);if(s.min===s.max&&x===0)v=s.span=[s.min,s.max],s.density=[{v:1,t:v[0]}],s.bandwidth=x,m=Math.max(m,1);else{var b=v[1]-v[0],l=Math.ceil(b/(x/3)),L=b/l;if(!isFinite(L)||!isFinite(l))return w.error("Something went wrong with computing the violin span"),i[0].t.empty=!0,i;var S=T.makeKDE(s,o,A);s.density=new Array(l);for(var k=0,P=v[0];P<v[1]+L/2;k++,P+=L){var z=S(P);s.density[k]={v:z,t:P},m=Math.max(m,z)}}u=Math.max(u,A.length),y=Math.min(y,v[0]),h=Math.max(h,v[1])}var I=c.findExtremes(p,[y,h],{padded:!0});if(o._extremes[p._id]=I,o.width)i[0].t.maxKDE=m;else{var D=g._violinScaleGroupStats,R=o.scalegroup,B=D[R];B?(B.maxKDE=Math.max(B.maxKDE,m),B.maxCount=Math.max(B.maxCount,u)):D[R]={maxKDE:m,maxCount:u}}return i[0].t.labels.kde=w._(f,"kde:"),i};function a(t,f,o){var i=Math.min(f,o/1.349);return 1.059*i*Math.pow(t,-.2)}function n(t,f,o){var i=f.max-f.min;if(!i)return t.bandwidth?t.bandwidth:0;if(t.bandwidth)return Math.max(t.bandwidth,i/1e4);var g=o.length,p=w.stdev(o,g-1,f.mean);return Math.max(a(g,p,f.q3-f.q1),i/100)}function r(t,f,o,i){var g=t.spanmode,p=t.span||[],y=[f.min,f.max],h=[f.min-2*i,f.max+2*i],m;function u(s){var A=p[s],x=o.type==="multicategory"?o.r2c(A):o.d2c(A,0,t[f.valLetter+"calendar"]);return x===e?h[s]:x}g==="soft"?m=h:g==="hard"?m=y:m=[u(0),u(1)];var _={type:"linear",range:m};return c.setConvert(_),_.cleanRange(),m}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axes":554,"../box/calc":674,"./helpers":1095}],1093:[function(d,re,ne){var w=d("../box/cross_trace_calc").setPositionOffset,c=["v","h"];re.exports=function(T,e){for(var a=T.calcdata,n=e.xaxis,r=e.yaxis,t=0;t<c.length;t++){for(var f=c[t],o=f==="h"?r:n,i=[],g=0;g<a.length;g++){var p=a[g],y=p[0].t,h=p[0].trace;h.visible===!0&&h.type==="violin"&&!y.empty&&h.orientation===f&&h.xaxis===n._id&&h.yaxis===r._id&&i.push(g)}w("violin",T,i,o)}}},{"../box/cross_trace_calc":675}],1094:[function(d,re,ne){var w=d("../../lib"),c=d("../../components/color"),M=d("../box/defaults"),T=d("./attributes");re.exports=function(a,n,r,t){function f(L,S){return w.coerce(a,n,T,L,S)}function o(L,S){return w.coerce2(a,n,T,L,S)}if(M.handleSampleDefaults(a,n,f,t),n.visible!==!1){f("bandwidth"),f("side");var i=f("width");i||(f("scalegroup",n.name),f("scalemode"));var g=f("span"),p;Array.isArray(g)&&(p="manual"),f("spanmode",p);var y=f("line.color",(a.marker||{}).color||r),h=f("line.width"),m=f("fillcolor",c.addOpacity(n.line.color,.5));M.handlePointsDefaults(a,n,f,{prefix:""});var u=o("box.width"),_=o("box.fillcolor",m),s=o("box.line.color",y),A=o("box.line.width",h),x=f("box.visible",Boolean(u||_||s||A));x||(n.box={visible:!1});var v=o("meanline.color",y),b=o("meanline.width",h),l=f("meanline.visible",Boolean(v||b));l||(n.meanline={visible:!1})}}},{"../../components/color":366,"../../lib":503,"../box/defaults":676,"./attributes":1091}],1095:[function(d,re,ne){var w=d("../../lib"),c={gaussian:function(M){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*M*M)}};ne.makeKDE=function(M,T,e){var a=e.length,n=c.gaussian,r=M.bandwidth,t=1/(a*r);return function(f){for(var o=0,i=0;i<a;i++)o+=n((f-e[i])/r);return t*o}},ne.getPositionOnKdePath=function(M,T,e){var a,n;T.orientation==="h"?(a="y",n="x"):(a="x",n="y");var r=w.findPointOnPath(M.path,e,n,{pathLength:M.pathLength}),t=M.posCenterPx,f=r[a],o=T.side==="both"?2*t-f:t;return[f,o]},ne.getKdeValue=function(M,T,e){var a=M.pts.map(ne.extractVal),n=ne.makeKDE(M,T,a);return n(e)/M.posDensityScale},ne.extractVal=function(M){return M.v}},{"../../lib":503}],1096:[function(d,re,ne){var w=d("../../lib"),c=d("../../plots/cartesian/axes"),M=d("../box/hover"),T=d("./helpers");re.exports=function(a,n,r,t,f){f||(f={});var o=f.hoverLayer,i=a.cd,g=i[0].trace,p=g.hoveron,y=p.indexOf("violins")!==-1,h=p.indexOf("kde")!==-1,m=[],u,_;if(y||h){var s=M.hoverOnBoxes(a,n,r,t);if(h&&s.length>0){var A=a.xa,x=a.ya,v,b,l,L,S;g.orientation==="h"?(S=n,v="y",l=x,b="x",L=A):(S=r,v="x",l=A,b="y",L=x);var k=i[a.index];if(S>=k.span[0]&&S<=k.span[1]){var P=w.extendFlat({},a),z=L.c2p(S,!0),I=T.getKdeValue(k,g,S),D=T.getPositionOnKdePath(k,g,z),R=l._offset,B=l._length;P[v+"0"]=D[0],P[v+"1"]=D[1],P[b+"0"]=P[b+"1"]=z,P[b+"Label"]=b+": "+c.hoverLabelText(L,S,g[b+"hoverformat"])+", "+i[0].t.labels.kde+" "+I.toFixed(3),P.spikeDistance=s[0].spikeDistance;var F=v+"Spike";P[F]=s[0][F],s[0].spikeDistance=void 0,s[0][F]=void 0,P.hovertemplate=!1,m.push(P),_={stroke:a.color},_[v+"1"]=w.constrain(R+D[0],R,R+B),_[v+"2"]=w.constrain(R+D[1],R,R+B),_[b+"1"]=_[b+"2"]=L._offset+z}}y&&(m=m.concat(s))}p.indexOf("points")!==-1&&(u=M.hoverOnPoints(a,n,r));var V=o.selectAll(".violinline-"+g.uid).data(_?[0]:[]);return V.enter().append("line").classed("violinline-"+g.uid,!0).attr("stroke-width",1.5),V.exit().remove(),V.attr(_),t==="closest"?u?[u]:m:(u&&m.push(u),m)}},{"../../lib":503,"../../plots/cartesian/axes":554,"../box/hover":678,"./helpers":1095}],1097:[function(d,re,ne){re.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults"),crossTraceDefaults:d("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc"),plot:d("./plot"),style:d("./style"),styleOnSelect:d("../scatter/style").styleOnSelect,hoverPoints:d("./hover"),selectPoints:d("../box/select"),moduleType:"trace",name:"violin",basePlotModule:d("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../box/defaults":676,"../box/select":683,"../scatter/style":951,"./attributes":1091,"./calc":1092,"./cross_trace_calc":1093,"./defaults":1094,"./hover":1096,"./layout_attributes":1098,"./layout_defaults":1099,"./plot":1100,"./style":1101}],1098:[function(d,re,ne){var w=d("../box/layout_attributes"),c=d("../../lib").extendFlat;re.exports={violinmode:c({},w.boxmode,{}),violingap:c({},w.boxgap,{}),violingroupgap:c({},w.boxgroupgap,{})}},{"../../lib":503,"../box/layout_attributes":680}],1099:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes"),M=d("../box/layout_defaults");re.exports=function(e,a,n){function r(t,f){return w.coerce(e,a,c,t,f)}M._supply(e,a,n,r,"violin")}},{"../../lib":503,"../box/layout_defaults":681,"./layout_attributes":1098}],1100:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../components/drawing"),T=d("../box/plot"),e=d("../scatter/line_points"),a=d("./helpers");re.exports=function(r,t,f,o){var i=r._fullLayout,g=t.xaxis,p=t.yaxis;function y(h){var m=e(h,{xaxis:g,yaxis:p,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return M.smoothopen(m[0],1)}c.makeTraceGroups(o,f,"trace violins").each(function(h){var m=w.select(this),u=h[0],_=u.t,s=u.trace;if(s.visible!==!0||_.empty){m.remove();return}var A=_.bPos,x=_.bdPos,v=t[_.valLetter+"axis"],b=t[_.posLetter+"axis"],l=s.side==="both",L=l||s.side==="positive",S=l||s.side==="negative",k=m.selectAll("path.violin").data(c.identity);k.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),k.exit().remove(),k.each(function(V){var G=w.select(this),J=V.density,j=J.length,Y=b.c2l(V.pos+A,!0),X=b.l2p(Y),oe;if(s.width)oe=_.maxKDE/x;else{var se=i._violinScaleGroupStats[s.scalegroup];oe=s.scalemode==="count"?se.maxKDE/x*(se.maxCount/V.pts.length):se.maxKDE/x}var ie,N,U,q,Q,W,Z;if(L){for(W=new Array(j),q=0;q<j;q++)Z=W[q]={},Z[_.posLetter]=Y+J[q].v/oe,Z[_.valLetter]=v.c2l(J[q].t,!0);ie=y(W)}if(S){for(W=new Array(j),Q=0,q=j-1;Q<j;Q++,q--)Z=W[Q]={},Z[_.posLetter]=Y-J[q].v/oe,Z[_.valLetter]=v.c2l(J[q].t,!0);N=y(W)}if(l)U=ie+"L"+N.substr(1)+"Z";else{var ee=[X,v.c2p(J[0].t)],te=[X,v.c2p(J[j-1].t)];s.orientation==="h"&&(ee.reverse(),te.reverse()),L?U="M"+ee+"L"+ie.substr(1)+"L"+te:U="M"+te+"L"+N.substr(1)+"L"+ee}G.attr("d",U),V.posCenterPx=X,V.posDensityScale=oe*x,V.path=G.node(),V.pathLength=V.path.getTotalLength()/(l?2:1)});var P=s.box,z=P.width,I=(P.line||{}).width,D,R;l?(D=x*z,R=0):L?(D=[0,x*z/2],R=I*{x:1,y:-1}[_.posLetter]):(D=[x*z/2,0],R=I*{x:-1,y:1}[_.posLetter]),T.plotBoxAndWhiskers(m,{pos:b,val:v},s,{bPos:A,bdPos:D,bPosPxOffset:R}),T.plotBoxMean(m,{pos:b,val:v},s,{bPos:A,bdPos:D,bPosPxOffset:R});var B;!s.box.visible&&s.meanline.visible&&(B=c.identity);var F=m.selectAll("path.meanline").data(B||[]);F.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),F.exit().remove(),F.each(function(V){var G=v.c2p(V.mean,!0),J=a.getPositionOnKdePath(V,s,G);w.select(this).attr("d",s.orientation==="h"?"M"+G+","+J[0]+"V"+J[1]:"M"+J[0]+","+G+"H"+J[1])}),T.plotPoints(m,{x:g,y:p},s,_)})}},{"../../components/drawing":388,"../../lib":503,"../box/plot":682,"../scatter/line_points":941,"./helpers":1095,"@plotly/d3":58}],1101:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/color"),M=d("../scatter/style").stylePoints;re.exports=function(e){var a=w.select(e).selectAll("g.trace.violins");a.style("opacity",function(n){return n[0].trace.opacity}),a.each(function(n){var r=n[0].trace,t=w.select(this),f=r.box||{},o=f.line||{},i=r.meanline||{},g=i.width;t.selectAll("path.violin").style("stroke-width",r.line.width+"px").call(c.stroke,r.line.color).call(c.fill,r.fillcolor),t.selectAll("path.box").style("stroke-width",o.width+"px").call(c.stroke,o.color).call(c.fill,f.fillcolor);var p={"stroke-width":g+"px","stroke-dasharray":2*g+"px,"+g+"px"};t.selectAll("path.mean").style(p).call(c.stroke,i.color),t.selectAll("path.meanline").style(p).call(c.stroke,i.color),M(t,r,e)})}},{"../../components/color":366,"../scatter/style":951,"@plotly/d3":58}],1102:[function(d,re,ne){var w=d("../../components/colorscale/attributes"),c=d("../isosurface/attributes"),M=d("../surface/attributes"),T=d("../../plots/attributes"),e=d("../../lib/extend").extendFlat,a=d("../../plot_api/edit_types").overrideAll,n=re.exports=a(e({x:c.x,y:c.y,z:c.z,value:c.value,isomin:c.isomin,isomax:c.isomax,surface:c.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:c.slices,caps:c.caps,text:c.text,hovertext:c.hovertext,xhoverformat:c.xhoverformat,yhoverformat:c.yhoverformat,zhoverformat:c.zhoverformat,valuehoverformat:c.valuehoverformat,hovertemplate:c.hovertemplate},w("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:c.colorbar,opacity:c.opacity,opacityscale:M.opacityscale,lightposition:c.lightposition,lighting:c.lighting,flatshading:c.flatshading,contour:c.contour,hoverinfo:e({},T.hoverinfo),showlegend:e({},T.showlegend,{dflt:!1})}),"calc","nested");n.x.editType=n.y.editType=n.z.editType=n.value.editType="calc+clearAxisTypes",n.transforms=void 0},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../isosurface/attributes":862,"../surface/attributes":1061}],1103:[function(d,re,ne){var w=d("../../../stackgl_modules").gl_mesh3d,c=d("../../lib/gl_format_color").parseColorScale,M=d("../../lib/str2rgbarray"),T=d("../../components/colorscale").extractOpts,e=d("../../plots/gl3d/zip3"),a=d("../isosurface/convert").findNearestOnAxis,n=d("../isosurface/convert").generateIsoMeshes;function r(o,i,g){this.scene=o,this.uid=g,this.mesh=i,this.name="",this.data=null,this.showContour=!1}var t=r.prototype;t.handlePick=function(o){if(o.object===this.mesh){var i=o.data.index,g=this.data._meshX[i],p=this.data._meshY[i],y=this.data._meshZ[i],h=this.data._Ys.length,m=this.data._Zs.length,u=a(g,this.data._Xs).id,_=a(p,this.data._Ys).id,s=a(y,this.data._Zs).id,A=o.index=s+m*_+m*h*u;o.traceCoordinate=[this.data._meshX[A],this.data._meshY[A],this.data._meshZ[A],this.data._value[A]];var x=this.data.hovertext||this.data.text;return Array.isArray(x)&&x[A]!==void 0?o.textLabel=x[A]:x&&(o.textLabel=x),!0}},t.update=function(o){var i=this.scene,g=i.fullSceneLayout;this.data=n(o);function p(_,s,A,x){return s.map(function(v){return _.d2l(v,0,x)*A})}var y=e(p(g.xaxis,o._meshX,i.dataScale[0],o.xcalendar),p(g.yaxis,o._meshY,i.dataScale[1],o.ycalendar),p(g.zaxis,o._meshZ,i.dataScale[2],o.zcalendar)),h=e(o._meshI,o._meshJ,o._meshK),m={positions:y,cells:h,lightPosition:[o.lightposition.x,o.lightposition.y,o.lightposition.z],ambient:o.lighting.ambient,diffuse:o.lighting.diffuse,specular:o.lighting.specular,roughness:o.lighting.roughness,fresnel:o.lighting.fresnel,vertexNormalsEpsilon:o.lighting.vertexnormalsepsilon,faceNormalsEpsilon:o.lighting.facenormalsepsilon,opacity:o.opacity,opacityscale:o.opacityscale,contourEnable:o.contour.show,contourColor:M(o.contour.color).slice(0,3),contourWidth:o.contour.width,useFacetNormals:o.flatshading},u=T(o);m.vertexIntensity=o._meshIntensity,m.vertexIntensityBounds=[u.min,u.max],m.colormap=c(o),this.mesh.update(m)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function f(o,i){var g=o.glplot.gl,p=w({gl:g}),y=new r(o,p,i.uid);return p._trace=y,y.update(i),o.glplot.add(p),y}re.exports=f},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/gl3d/zip3":609,"../isosurface/convert":864}],1104:[function(d,re,ne){var w=d("../../lib"),c=d("./attributes"),M=d("../isosurface/defaults").supplyIsoDefaults,T=d("../surface/defaults").opacityscaleDefaults;re.exports=function(a,n,r,t){function f(o,i){return w.coerce(a,n,c,o,i)}M(a,n,r,t,f),T(a,n,t,f)}},{"../../lib":503,"../isosurface/defaults":865,"../surface/defaults":1064,"./attributes":1102}],1105:[function(d,re,ne){re.exports={attributes:d("./attributes"),supplyDefaults:d("./defaults"),calc:d("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:d("./convert"),moduleType:"trace",name:"volume",basePlotModule:d("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":598,"../isosurface/calc":863,"./attributes":1102,"./convert":1103,"./defaults":1104}],1106:[function(d,re,ne){var w=d("../bar/attributes"),c=d("../scatter/attributes").line,M=d("../../plots/attributes"),T=d("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=d("../../plots/template_attributes").hovertemplateAttrs,a=d("../../plots/template_attributes").texttemplateAttrs,n=d("./constants"),r=d("../../lib/extend").extendFlat,t=d("../../components/color");function f(o){return{marker:{color:r({},w.marker.color,{arrayOk:!1,editType:"style"}),line:{color:r({},w.marker.line.color,{arrayOk:!1,editType:"style"}),width:r({},w.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}re.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:w.x,x0:w.x0,dx:w.dx,y:w.y,y0:w.y0,dy:w.dy,xperiod:w.xperiod,yperiod:w.yperiod,xperiod0:w.xperiod0,yperiod0:w.yperiod0,xperiodalignment:w.xperiodalignment,yperiodalignment:w.yperiodalignment,xhoverformat:T("x"),yhoverformat:T("y"),hovertext:w.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:r({},M.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:a({editType:"plot"},{keys:n.eventDataKeys.concat(["label"])}),text:w.text,textposition:w.textposition,insidetextanchor:w.insidetextanchor,textangle:w.textangle,textfont:w.textfont,insidetextfont:w.insidetextfont,outsidetextfont:w.outsidetextfont,constraintext:w.constraintext,cliponaxis:w.cliponaxis,orientation:w.orientation,offset:w.offset,width:w.width,increasing:f(),decreasing:f(),totals:f(),connector:{line:{color:r({},c.color,{dflt:t.defaultLine}),width:r({},c.width,{editType:"plot"}),dash:c.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:w.offsetgroup,alignmentgroup:w.alignmentgroup}},{"../../components/color":366,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatter/attributes":927,"./constants":1108}],1107:[function(d,re,ne){var w=d("../../plots/cartesian/axes"),c=d("../../plots/cartesian/align_period"),M=d("../../lib").mergeArray,T=d("../scatter/calc_selection"),e=d("../../constants/numerical").BADNUM;function a(r){return r==="a"||r==="absolute"}function n(r){return r==="t"||r==="total"}re.exports=function(t,f){var o=w.getFromId(t,f.xaxis||"x"),i=w.getFromId(t,f.yaxis||"y"),g,p,y,h,m,u;f.orientation==="h"?(g=o.makeCalcdata(f,"x"),y=i.makeCalcdata(f,"y"),h=c(f,i,"y",y),m=!!f.yperiodalignment,u="y"):(g=i.makeCalcdata(f,"y"),y=o.makeCalcdata(f,"x"),h=c(f,o,"x",y),m=!!f.xperiodalignment,u="x"),p=h.vals;for(var _=Math.min(p.length,g.length),s=new Array(_),A=0,x,v=!1,b=0;b<_;b++){var l=g[b]||0,L=!1;(g[b]!==e||n(f.measure[b])||a(f.measure[b]))&&b+1<_&&(g[b+1]!==e||n(f.measure[b+1])||a(f.measure[b+1]))&&(L=!0);var S=s[b]={i:b,p:p[b],s:l,rawS:l,cNext:L};a(f.measure[b])?(A=S.s,S.isSum=!0,S.dir="totals",S.s=A):n(f.measure[b])?(S.isSum=!0,S.dir="totals",S.s=A):(S.isSum=!1,S.dir=S.rawS<0?"decreasing":"increasing",x=S.s,S.s=A+x,A+=x),S.dir==="totals"&&(v=!0),m&&(s[b].orig_p=y[b],s[b][u+"End"]=h.ends[b],s[b][u+"Start"]=h.starts[b]),f.ids&&(S.id=String(f.ids[b])),S.v=(f.base||0)+A}return s.length&&(s[0].hasTotals=v),M(f.text,s,"tx"),M(f.hovertext,s,"htx"),T(s,f),s}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../scatter/calc_selection":929}],1108:[function(d,re,ne){re.exports={eventDataKeys:["initial","delta","final"]}},{}],1109:[function(d,re,ne){var w=d("../bar/cross_trace_calc").setGroupPositions;re.exports=function(M,T){var e=M._fullLayout,a=M._fullData,n=M.calcdata,r=T.xaxis,t=T.yaxis,f=[],o=[],i=[],g,p;for(p=0;p<a.length;p++){var y=a[p];y.visible===!0&&y.xaxis===r._id&&y.yaxis===t._id&&y.type==="waterfall"&&(g=n[p],y.orientation==="h"?i.push(g):o.push(g),f.push(g))}var h={mode:e.waterfallmode,norm:e.waterfallnorm,gap:e.waterfallgap,groupgap:e.waterfallgroupgap};for(w(M,r,t,o,h),w(M,t,r,i,h),p=0;p<f.length;p++){g=f[p];for(var m=0;m<g.length;m++){var u=g[m];u.isSum===!1&&(u.s0+=m===0?0:g[m-1].s),m+1<g.length&&(g[m].nextP0=g[m+1].p0,g[m].nextS0=g[m+1].s0)}}}},{"../bar/cross_trace_calc":651}],1110:[function(d,re,ne){var w=d("../../lib"),c=d("../bar/defaults").handleGroupingDefaults,M=d("../bar/defaults").handleText,T=d("../scatter/xy_defaults"),e=d("../scatter/period_defaults"),a=d("./attributes"),n=d("../../components/color"),r=d("../../constants/delta.js"),t=r.INCREASING.COLOR,f=r.DECREASING.COLOR,o="#4499FF";function i(y,h,m){y(h+".marker.color",m),y(h+".marker.line.color",n.defaultLine),y(h+".marker.line.width")}function g(y,h,m,u){function _(b,l){return w.coerce(y,h,a,b,l)}var s=T(y,h,u,_);if(!s){h.visible=!1;return}e(y,h,u,_),_("xhoverformat"),_("yhoverformat"),_("measure"),_("orientation",h.x&&!h.y?"h":"v"),_("base"),_("offset"),_("width"),_("text"),_("hovertext"),_("hovertemplate");var A=_("textposition");M(y,h,u,_,A,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),h.textposition!=="none"&&(_("texttemplate"),h.texttemplate||_("textinfo")),i(_,"increasing",t),i(_,"decreasing",f),i(_,"totals",o);var x=_("connector.visible");if(x){_("connector.mode");var v=_("connector.line.width");v&&(_("connector.line.color"),_("connector.line.dash"))}}function p(y,h){var m,u;function _(A){return w.coerce(u._input,u,a,A)}if(h.waterfallmode==="group")for(var s=0;s<y.length;s++)u=y[s],m=u._input,c(m,u,h,_)}re.exports={supplyDefaults:g,crossTraceDefaults:p}},{"../../components/color":366,"../../constants/delta.js":473,"../../lib":503,"../bar/defaults":652,"../scatter/period_defaults":947,"../scatter/xy_defaults":954,"./attributes":1106}],1111:[function(d,re,ne){re.exports=function(c,M){return c.x="xVal"in M?M.xVal:M.x,c.y="yVal"in M?M.yVal:M.y,"initial"in M&&(c.initial=M.initial),"delta"in M&&(c.delta=M.delta),"final"in M&&(c.final=M.final),M.xa&&(c.xaxis=M.xa),M.ya&&(c.yaxis=M.ya),c}},{}],1112:[function(d,re,ne){var w=d("../../plots/cartesian/axes").hoverLabelText,c=d("../../components/color").opacity,M=d("../bar/hover").hoverOnBars,T=d("../../constants/delta.js"),e={increasing:T.INCREASING.SYMBOL,decreasing:T.DECREASING.SYMBOL};re.exports=function(r,t,f,o,i){var g=M(r,t,f,o,i);if(!g)return;var p=g.cd,y=p[0].trace,h=y.orientation==="h",m=h?"x":"y",u=h?r.xa:r.ya;function _(P){return w(u,P,y[m+"hoverformat"])}var s=g.index,A=p[s],x=A.isSum?A.b+A.s:A.rawS;if(!A.isSum){g.initial=A.b+A.s-x,g.delta=x,g.final=g.initial+g.delta;var v=_(Math.abs(g.delta));g.deltaLabel=x<0?"("+v+")":v,g.finalLabel=_(g.final),g.initialLabel=_(g.initial)}var b=A.hi||y.hoverinfo,l=[];if(b&&b!=="none"&&b!=="skip"){var L=b==="all",S=b.split("+"),k=function(P){return L||S.indexOf(P)!==-1};A.isSum||(k("final")&&(h?!k("x"):!k("y"))&&l.push(g.finalLabel),k("delta")&&(x<0?l.push(g.deltaLabel+" "+e.decreasing):l.push(g.deltaLabel+" "+e.increasing)),k("initial")&&l.push("Initial: "+g.initialLabel))}return l.length&&(g.extraText=l.join("<br>")),g.color=a(y,A),[g]};function a(n,r){var t=n[r.dir].marker,f=t.color,o=t.line.color,i=t.line.width;if(c(f))return f;if(c(o)&&i)return o}},{"../../components/color":366,"../../constants/delta.js":473,"../../plots/cartesian/axes":554,"../bar/hover":655}],1113:[function(d,re,ne){re.exports={attributes:d("./attributes"),layoutAttributes:d("./layout_attributes"),supplyDefaults:d("./defaults").supplyDefaults,crossTraceDefaults:d("./defaults").crossTraceDefaults,supplyLayoutDefaults:d("./layout_defaults"),calc:d("./calc"),crossTraceCalc:d("./cross_trace_calc"),plot:d("./plot"),style:d("./style").style,hoverPoints:d("./hover"),eventData:d("./event_data"),selectPoints:d("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:d("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../bar/select":660,"./attributes":1106,"./calc":1107,"./cross_trace_calc":1109,"./defaults":1110,"./event_data":1111,"./hover":1112,"./layout_attributes":1114,"./layout_defaults":1115,"./plot":1116,"./style":1117}],1114:[function(d,re,ne){re.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1115:[function(d,re,ne){var w=d("../../lib"),c=d("./layout_attributes");re.exports=function(M,T,e){var a=!1;function n(f,o){return w.coerce(M,T,c,f,o)}for(var r=0;r<e.length;r++){var t=e[r];if(t.visible&&t.type==="waterfall"){a=!0;break}}a&&(n("waterfallmode"),n("waterfallgap",.2),n("waterfallgroupgap"))}},{"../../lib":503,"./layout_attributes":1114}],1116:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../lib"),M=d("../../components/drawing"),T=d("../../constants/numerical").BADNUM,e=d("../bar/plot"),a=d("../bar/uniform_text").clearMinTextSize;re.exports=function(f,o,i,g){var p=f._fullLayout;a("waterfall",p),e.plot(f,o,i,g,{mode:p.waterfallmode,norm:p.waterfallmode,gap:p.waterfallgap,groupgap:p.waterfallgroupgap}),n(f,o,i,g)};function n(t,f,o,i){var g=f.xaxis,p=f.yaxis;c.makeTraceGroups(i,o,"trace bars").each(function(y){var h=w.select(this),m=y[0].trace,u=c.ensureSingle(h,"g","lines");if(!m.connector||!m.connector.visible){u.remove();return}var _=m.orientation==="h",s=m.connector.mode,A=u.selectAll("g.line").data(c.identity);A.enter().append("g").classed("line",!0),A.exit().remove();var x=A.size();A.each(function(v,b){if(!(b!==x-1&&!v.cNext)){var l=r(v,g,p,_),L=l[0],S=l[1],k="";L[0]!==T&&S[0]!==T&&L[1]!==T&&S[1]!==T&&(s==="spanning"&&!v.isSum&&b>0&&(_?k+="M"+L[0]+","+S[1]+"V"+S[0]:k+="M"+L[1]+","+S[0]+"H"+L[0]),s!=="between"&&(v.isSum||b<x-1)&&(_?k+="M"+L[1]+","+S[0]+"V"+S[1]:k+="M"+L[0]+","+S[1]+"H"+L[1]),L[2]!==T&&S[2]!==T&&(_?k+="M"+L[1]+","+S[1]+"V"+S[2]:k+="M"+L[1]+","+S[1]+"H"+L[2])),k===""&&(k="M0,0Z"),c.ensureSingle(w.select(this),"path").attr("d",k).call(M.setClipUrl,f.layerClipId,t)}})})}function r(t,f,o,i){var g=[],p=[],y=i?f:o,h=i?o:f;return g[0]=y.c2p(t.s0,!0),p[0]=h.c2p(t.p0,!0),g[1]=y.c2p(t.s1,!0),p[1]=h.c2p(t.p1,!0),g[2]=y.c2p(t.nextS0,!0),p[2]=h.c2p(t.nextP0,!0),i?[g,p]:[p,g]}},{"../../components/drawing":388,"../../constants/numerical":479,"../../lib":503,"../bar/plot":659,"../bar/uniform_text":664,"@plotly/d3":58}],1117:[function(d,re,ne){var w=d("@plotly/d3"),c=d("../../components/drawing"),M=d("../../components/color"),T=d("../../constants/interactions").DESELECTDIM,e=d("../bar/style"),a=d("../bar/uniform_text").resizeText,n=e.styleTextPoints;function r(t,f,o){var i=o||w.select(t).selectAll("g.waterfalllayer").selectAll("g.trace");a(t,i,"waterfall"),i.style("opacity",function(g){return g[0].trace.opacity}),i.each(function(g){var p=w.select(this),y=g[0].trace;p.selectAll(".point > path").each(function(h){if(!h.isBlank){var m=y[h.dir].marker;w.select(this).call(M.fill,m.color).call(M.stroke,m.line.color).call(c.dashLine,m.line.dash,m.line.width).style("opacity",y.selectedpoints&&!h.selected?T:1)}}),n(p,y,t),p.selectAll(".lines").each(function(){var h=y.connector.line;c.lineGroupStyle(w.select(this).selectAll("path"),h.width,h.color,h.dash)})})}re.exports={style:r}},{"../../components/color":366,"../../components/drawing":388,"../../constants/interactions":478,"../bar/style":662,"../bar/uniform_text":664,"@plotly/d3":58}],1118:[function(d,re,ne){var w=d("../plots/cartesian/axes"),c=d("../lib"),M=d("../plot_api/plot_schema"),T=d("./helpers").pointsAccessorFunction,e=d("../constants/numerical").BADNUM;ne.moduleType="transform",ne.name="aggregate";var a=ne.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},n=a.aggregations;ne.supplyDefaults=function(g,p){var y={},h;function m(P,z){return c.coerce(g,y,a,P,z)}var u=m("enabled");if(!u)return y;var _=M.findArrayAttributes(p),s={};for(h=0;h<_.length;h++)s[_[h]]=1;var A=m("groups");if(!Array.isArray(A)){if(!s[A])return y.enabled=!1,y;s[A]=0}var x=g.aggregations||[],v=y.aggregations=new Array(x.length),b;function l(P,z){return c.coerce(x[h],b,n,P,z)}for(h=0;h<x.length;h++){b={_index:h};var L=l("target"),S=l("func"),k=l("enabled");k&&L&&(s[L]||S==="count"&&s[L]===void 0)?(S==="stddev"&&l("funcmode"),s[L]=0,v[h]=b):v[h]={enabled:!1,_index:h}}for(h=0;h<_.length;h++)s[_[h]]&&v.push({target:_[h],func:n.func.dflt,enabled:!0,_index:-1});return y},ne.calcTransform=function(g,p,y){if(!!y.enabled){var h=y.groups,m=c.getTargetArray(p,{target:h});if(!!m){var u,_,s,A,x={},v={},b=[],l=T(p.transforms,y),L=m.length;for(p._length&&(L=Math.min(L,p._length)),u=0;u<L;u++)_=m[u],s=x[_],s===void 0?(x[_]=b.length,A=[u],b.push(A),v[x[_]]=l(u)):(b[s].push(u),v[x[_]]=(v[x[_]]||[]).concat(l(u)));y._indexToPoints=v;var S=y.aggregations;for(u=0;u<S.length;u++)r(g,p,b,S[u]);typeof h=="string"&&r(g,p,b,{target:h,func:"first",enabled:!0}),p._length=b.length}}};function r(g,p,y,h){if(!!h.enabled){for(var m=h.target,u=c.nestedProperty(p,m),_=u.get(),s=w.getDataConversions(g,p,m,_),A=t(h,s),x=new Array(y.length),v=0;v<y.length;v++)x[v]=A(_,y[v]);u.set(x),h.func==="count"&&c.pushUnique(p._arrayAttrs,m)}}function t(g,p){var y=g.func,h=p.d2c,m=p.c2d;switch(y){case"count":return f;case"first":return o;case"last":return i;case"sum":return function(u,_){for(var s=0,A=0;A<_.length;A++){var x=h(u[_[A]]);x!==e&&(s+=x)}return m(s)};case"avg":return function(u,_){for(var s=0,A=0,x=0;x<_.length;x++){var v=h(u[_[x]]);v!==e&&(s+=v,A++)}return A?m(s/A):e};case"min":return function(u,_){for(var s=1/0,A=0;A<_.length;A++){var x=h(u[_[A]]);x!==e&&(s=Math.min(s,x))}return s===1/0?e:m(s)};case"max":return function(u,_){for(var s=-1/0,A=0;A<_.length;A++){var x=h(u[_[A]]);x!==e&&(s=Math.max(s,x))}return s===-1/0?e:m(s)};case"range":return function(u,_){for(var s=1/0,A=-1/0,x=0;x<_.length;x++){var v=h(u[_[x]]);v!==e&&(s=Math.min(s,v),A=Math.max(A,v))}return A===-1/0||s===1/0?e:m(A-s)};case"change":return function(u,_){var s=h(u[_[0]]),A=h(u[_[_.length-1]]);return s===e||A===e?e:m(A-s)};case"median":return function(u,_){for(var s=[],A=0;A<_.length;A++){var x=h(u[_[A]]);x!==e&&s.push(x)}if(!s.length)return e;s.sort(c.sorterAsc);var v=(s.length-1)/2;return m((s[Math.floor(v)]+s[Math.ceil(v)])/2)};case"mode":return function(u,_){for(var s={},A=0,x=e,v=0;v<_.length;v++){var b=h(u[_[v]]);if(b!==e){var l=s[b]=(s[b]||0)+1;l>A&&(A=l,x=b)}}return A?m(x):e};case"rms":return function(u,_){for(var s=0,A=0,x=0;x<_.length;x++){var v=h(u[_[x]]);v!==e&&(s+=v*v,A++)}return A?m(Math.sqrt(s/A)):e};case"stddev":return function(u,_){var s=0,A=0,x=1,v=e,b;for(b=0;b<_.length&&v===e;b++)v=h(u[_[b]]);if(v===e)return e;for(;b<_.length;b++){var l=h(u[_[b]]);if(l!==e){var L=l-v;s+=L,A+=L*L,x++}}var S=g.funcmode==="sample"?x-1:x;return S?Math.sqrt((A-s*s/x)/S):0}}}function f(g,p){return p.length}function o(g,p){return g[p[0]]}function i(g,p){return g[p[p.length-1]]}},{"../constants/numerical":479,"../lib":503,"../plot_api/plot_schema":542,"../plots/cartesian/axes":554,"./helpers":1121}],1119:[function(d,re,ne){var w=d("../lib"),c=d("../registry"),M=d("../plots/cartesian/axes"),T=d("./helpers").pointsAccessorFunction,e=d("../constants/filter_ops"),a=e.COMPARISON_OPS,n=e.INTERVAL_OPS,r=e.SET_OPS;ne.moduleType="transform",ne.name="filter",ne.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(a).concat(n).concat(r),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},ne.supplyDefaults=function(f){var o={};function i(h,m){return w.coerce(f,o,ne.attributes,h,m)}var g=i("enabled");if(g){var p=i("target");if(w.isArrayOrTypedArray(p)&&p.length===0)return o.enabled=!1,o;i("preservegaps"),i("operation"),i("value");var y=c.getComponentMethod("calendars","handleDefaults");y(f,o,"valuecalendar",null),y(f,o,"targetcalendar",null)}return o},ne.calcTransform=function(f,o,i){if(!i.enabled)return;var g=w.getTargetArray(o,i);if(!g)return;var p=i.target,y=g.length;o._length&&(y=Math.min(y,o._length));var h=i.targetcalendar,m=o._arrayAttrs,u=i.preservegaps;if(typeof p=="string"){var _=w.nestedProperty(o,p+"calendar").get();_&&(h=_)}var s=M.getDataToCoordFunc(f,o,p,g),A=t(i,s,h),x={},v={},b=0;function l(I,D){for(var R=0;R<m.length;R++){var B=w.nestedProperty(o,m[R]);I(B,D)}}var L,S;u?(L=function(I){x[I.astr]=w.extendDeep([],I.get()),I.set(new Array(y))},S=function(I,D){var R=x[I.astr][D];I.get()[D]=R}):(L=function(I){x[I.astr]=w.extendDeep([],I.get()),I.set([])},S=function(I,D){var R=x[I.astr][D];I.get().push(R)}),l(L);for(var k=T(o.transforms,i),P=0;P<y;P++){var z=A(g[P]);z?(l(S,P),v[b++]=k(P)):u&&b++}i._indexToPoints=v,o._length=b};function t(f,o,i){var g=f.operation,p=f.value,y=Array.isArray(p);function h(s){return s.indexOf(g)!==-1}var m=function(s){return o(s,0,f.valuecalendar)},u=function(s){return o(s,0,i)},_;switch(h(a)?_=m(y?p[0]:p):h(n)?_=y?[m(p[0]),m(p[1])]:[m(p),m(p)]:h(r)&&(_=y?p.map(m):[m(p)]),g){case"=":return function(s){return u(s)===_};case"!=":return function(s){return u(s)!==_};case"<":return function(s){return u(s)<_};case"<=":return function(s){return u(s)<=_};case">":return function(s){return u(s)>_};case">=":return function(s){return u(s)>=_};case"[]":return function(s){var A=u(s);return A>=_[0]&&A<=_[1]};case"()":return function(s){var A=u(s);return A>_[0]&&A<_[1]};case"[)":return function(s){var A=u(s);return A>=_[0]&&A<_[1]};case"(]":return function(s){var A=u(s);return A>_[0]&&A<=_[1]};case"][":return function(s){var A=u(s);return A<=_[0]||A>=_[1]};case")(":return function(s){var A=u(s);return A<_[0]||A>_[1]};case"](":return function(s){var A=u(s);return A<=_[0]||A>_[1]};case")[":return function(s){var A=u(s);return A<_[0]||A>=_[1]};case"{}":return function(s){return _.indexOf(u(s))!==-1};case"}{":return function(s){return _.indexOf(u(s))===-1}}}},{"../constants/filter_ops":475,"../lib":503,"../plots/cartesian/axes":554,"../registry":638,"./helpers":1121}],1120:[function(d,re,ne){var w=d("../lib"),c=d("../plot_api/plot_schema"),M=d("../plots/plots"),T=d("./helpers").pointsAccessorFunction;ne.moduleType="transform",ne.name="groupby",ne.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},ne.supplyDefaults=function(a,n,r){var t,f={};function o(m,u){return w.coerce(a,f,ne.attributes,m,u)}var i=o("enabled");if(!i)return f;o("groups"),o("nameformat",r._dataLength>1?"%{group} (%{trace})":"%{group}");var g=a.styles,p=f.styles=[];if(g)for(t=0;t<g.length;t++){var y=p[t]={};w.coerce(g[t],p[t],ne.attributes.styles,"target");var h=w.coerce(g[t],p[t],ne.attributes.styles,"value");w.isPlainObject(h)?y.value=w.extendDeep({},h):h&&delete y.value}return f},ne.transform=function(a,n){var r,t,f,o=[];for(t=0;t<a.length;t++)for(r=e(a[t],n),f=0;f<r.length;f++)o.push(r[f]);return o};function e(a,n){var r,t,f,o,i,g,p,y,h,m,u=n.transform,_=n.transformIndex,s=a.transforms[_].groups,A=T(a.transforms,u);if(!w.isArrayOrTypedArray(s)||s.length===0)return[a];var x=w.filterUnique(s),v=new Array(x.length),b=s.length,l=c.findArrayAttributes(a),L=u.styles||[],S={};for(r=0;r<L.length;r++)S[L[r].target]=L[r].value;u.styles&&(m=w.keyedContainer(u,"styles","target","value.name"));var k={},P={};for(r=0;r<x.length;r++){g=x[r],k[g]=r,P[g]=0,p=v[r]=w.extendDeepNoArrays({},a),p._group=g,p.transforms[_]._indexToPoints={};var z=null;for(m&&(z=m.get(g)),z||z===""?p.name=z:p.name=w.templateString(u.nameformat,{trace:a.name,group:g}),y=p.transforms,p.transforms=[],t=0;t<y.length;t++)p.transforms[t]=w.extendDeepNoArrays({},y[t]);for(t=0;t<l.length;t++)w.nestedProperty(p,l[t]).set([])}for(f=0;f<l.length;f++){for(o=l[f],t=0,h=[];t<x.length;t++)h[t]=w.nestedProperty(v[t],o).get();for(i=w.nestedProperty(a,o).get(),t=0;t<b;t++)h[k[s[t]]].push(i[t])}for(t=0;t<b;t++){p=v[k[s[t]]];var I=p.transforms[_]._indexToPoints;I[P[s[t]]]=A(t),P[s[t]]++}for(r=0;r<x.length;r++)g=x[r],p=v[r],M.clearExpandedTraceDefaultColors(p),p=w.extendDeepNoArrays(p,S[g]||{});return v}},{"../lib":503,"../plot_api/plot_schema":542,"../plots/plots":619,"./helpers":1121}],1121:[function(d,re,ne){ne.pointsAccessorFunction=function(w,c){for(var M,T,e=0;e<w.length&&(M=w[e],M!==c);e++)!M._indexToPoints||M.enabled===!1||(T=M._indexToPoints);var a=T?function(n){return T[n]}:function(n){return[n]};return a}},{}],1122:[function(d,re,ne){var w=d("../lib"),c=d("../plots/cartesian/axes"),M=d("./helpers").pointsAccessorFunction,T=d("../constants/numerical").BADNUM;ne.moduleType="transform",ne.name="sort",ne.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},ne.supplyDefaults=function(n){var r={};function t(o,i){return w.coerce(n,r,ne.attributes,o,i)}var f=t("enabled");return f&&(t("target"),t("order")),r},ne.calcTransform=function(n,r,t){if(!!t.enabled){var f=w.getTargetArray(r,t);if(!!f){var o=t.target,i=f.length;r._length&&(i=Math.min(i,r._length));var g=r._arrayAttrs,p=c.getDataToCoordFunc(n,r,o,f),y=e(t,f,p,i),h=M(r.transforms,t),m={},u,_;for(u=0;u<g.length;u++){var s=w.nestedProperty(r,g[u]),A=s.get(),x=new Array(i);for(_=0;_<i;_++)x[_]=A[y[_]];s.set(x)}for(_=0;_<i;_++)m[_]=h(y[_]);t._indexToPoints=m,r._length=i}}};function e(n,r,t,f){var o=new Array(f),i=new Array(f),g;for(g=0;g<f;g++)o[g]={v:r[g],i:g};for(o.sort(a(n,t)),g=0;g<f;g++)i[g]=o[g].i;return i}function a(n,r){switch(n.order){case"ascending":return function(t,f){var o=r(t.v),i=r(f.v);return o===T?1:i===T?-1:o-i};case"descending":return function(t,f){var o=r(t.v),i=r(f.v);return o===T?1:i===T?-1:i-o}}}},{"../constants/numerical":479,"../lib":503,"../plots/cartesian/axes":554,"./helpers":1121}],1123:[function(d,re,ne){ne.version="2.11.1"},{}],1124:[function(d,re,ne){(function(w){(function(){(function(c){if(typeof ne=="object"&&typeof re!="undefined")re.exports=c();else{var M;typeof window!="undefined"?M=window:typeof w!="undefined"?M=w:typeof self!="undefined"?M=self:M=this,M.stackgl=c()}})(function(){return function(){function c(M,T,e){function a(t,f){if(!T[t]){if(!M[t]){var o=typeof d=="function"&&d;if(!f&&o)return o(t,!0);if(n)return n(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var g=T[t]={exports:{}};M[t][0].call(g.exports,function(p){var y=M[t][1][p];return a(y||p)},g,g.exports,c,M,T,e)}return T[t].exports}for(var n=typeof d=="function"&&d,r=0;r<e.length;r++)a(e[r]);return a}return c}()({1:[function(c,M,T){T.byteLength=i,T.toByteArray=p,T.fromByteArray=m;for(var e=[],a=[],n=typeof Uint8Array!="undefined"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,f=r.length;t<f;++t)e[t]=r[t],a[r.charCodeAt(t)]=t;a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63;function o(u){var _=u.length;if(_%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=u.indexOf("=");s===-1&&(s=_);var A=s===_?0:4-s%4;return[s,A]}function i(u){var _=o(u),s=_[0],A=_[1];return(s+A)*3/4-A}function g(u,_,s){return(_+s)*3/4-s}function p(u){var _,s=o(u),A=s[0],x=s[1],v=new n(g(u,A,x)),b=0,l=x>0?A-4:A,L;for(L=0;L<l;L+=4)_=a[u.charCodeAt(L)]<<18|a[u.charCodeAt(L+1)]<<12|a[u.charCodeAt(L+2)]<<6|a[u.charCodeAt(L+3)],v[b++]=_>>16&255,v[b++]=_>>8&255,v[b++]=_&255;return x===2&&(_=a[u.charCodeAt(L)]<<2|a[u.charCodeAt(L+1)]>>4,v[b++]=_&255),x===1&&(_=a[u.charCodeAt(L)]<<10|a[u.charCodeAt(L+1)]<<4|a[u.charCodeAt(L+2)]>>2,v[b++]=_>>8&255,v[b++]=_&255),v}function y(u){return e[u>>18&63]+e[u>>12&63]+e[u>>6&63]+e[u&63]}function h(u,_,s){for(var A,x=[],v=_;v<s;v+=3)A=(u[v]<<16&16711680)+(u[v+1]<<8&65280)+(u[v+2]&255),x.push(y(A));return x.join("")}function m(u){for(var _,s=u.length,A=s%3,x=[],v=16383,b=0,l=s-A;b<l;b+=v)x.push(h(u,b,b+v>l?l:b+v));return A===1?(_=u[s-1],x.push(e[_>>2]+e[_<<4&63]+"==")):A===2&&(_=(u[s-2]<<8)+u[s-1],x.push(e[_>>10]+e[_>>4&63]+e[_<<2&63]+"=")),x.join("")}},{}],2:[function(c,M,T){},{}],3:[function(c,M,T){(function(e){(function(){var a=c("base64-js"),n=c("ieee754");T.Buffer=o,T.SlowBuffer=A,T.INSPECT_MAX_BYTES=50;var r=2147483647;T.kMaxLength=r,o.TYPED_ARRAY_SUPPORT=t(),!o.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function t(){try{var fe=new Uint8Array(1);return fe.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},fe.foo()===42}catch{return!1}}Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(!!o.isBuffer(this))return this.byteOffset}});function f(fe){if(fe>r)throw new RangeError('The value "'+fe+'" is invalid for option "size"');var pe=new Uint8Array(fe);return pe.__proto__=o.prototype,pe}function o(fe,pe,ge){if(typeof fe=="number"){if(typeof pe=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(fe)}return i(fe,pe,ge)}typeof Symbol!="undefined"&&Symbol.species!=null&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),o.poolSize=8192;function i(fe,pe,ge){if(typeof fe=="string")return h(fe,pe);if(ArrayBuffer.isView(fe))return m(fe);if(fe==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof fe);if(le(fe,ArrayBuffer)||fe&&le(fe.buffer,ArrayBuffer))return u(fe,pe,ge);if(typeof fe=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Ae=fe.valueOf&&fe.valueOf();if(Ae!=null&&Ae!==fe)return o.from(Ae,pe,ge);var we=_(fe);if(we)return we;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof fe[Symbol.toPrimitive]=="function")return o.from(fe[Symbol.toPrimitive]("string"),pe,ge);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof fe)}o.from=function(fe,pe,ge){return i(fe,pe,ge)},o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array;function g(fe){if(typeof fe!="number")throw new TypeError('"size" argument must be of type number');if(fe<0)throw new RangeError('The value "'+fe+'" is invalid for option "size"')}function p(fe,pe,ge){return g(fe),fe<=0?f(fe):pe!==void 0?typeof ge=="string"?f(fe).fill(pe,ge):f(fe).fill(pe):f(fe)}o.alloc=function(fe,pe,ge){return p(fe,pe,ge)};function y(fe){return g(fe),f(fe<0?0:s(fe)|0)}o.allocUnsafe=function(fe){return y(fe)},o.allocUnsafeSlow=function(fe){return y(fe)};function h(fe,pe){if((typeof pe!="string"||pe==="")&&(pe="utf8"),!o.isEncoding(pe))throw new TypeError("Unknown encoding: "+pe);var ge=x(fe,pe)|0,Ae=f(ge),we=Ae.write(fe,pe);return we!==ge&&(Ae=Ae.slice(0,we)),Ae}function m(fe){for(var pe=fe.length<0?0:s(fe.length)|0,ge=f(pe),Ae=0;Ae<pe;Ae+=1)ge[Ae]=fe[Ae]&255;return ge}function u(fe,pe,ge){if(pe<0||fe.byteLength<pe)throw new RangeError('"offset" is outside of buffer bounds');if(fe.byteLength<pe+(ge||0))throw new RangeError('"length" is outside of buffer bounds');var Ae;return pe===void 0&&ge===void 0?Ae=new Uint8Array(fe):ge===void 0?Ae=new Uint8Array(fe,pe):Ae=new Uint8Array(fe,pe,ge),Ae.__proto__=o.prototype,Ae}function _(fe){if(o.isBuffer(fe)){var pe=s(fe.length)|0,ge=f(pe);return ge.length===0||fe.copy(ge,0,0,pe),ge}if(fe.length!==void 0)return typeof fe.length!="number"||ye(fe.length)?f(0):m(fe);if(fe.type==="Buffer"&&Array.isArray(fe.data))return m(fe.data)}function s(fe){if(fe>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return fe|0}function A(fe){return+fe!=fe&&(fe=0),o.alloc(+fe)}o.isBuffer=function(pe){return pe!=null&&pe._isBuffer===!0&&pe!==o.prototype},o.compare=function(pe,ge){if(le(pe,Uint8Array)&&(pe=o.from(pe,pe.offset,pe.byteLength)),le(ge,Uint8Array)&&(ge=o.from(ge,ge.offset,ge.byteLength)),!o.isBuffer(pe)||!o.isBuffer(ge))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(pe===ge)return 0;for(var Ae=pe.length,we=ge.length,De=0,Be=Math.min(Ae,we);De<Be;++De)if(pe[De]!==ge[De]){Ae=pe[De],we=ge[De];break}return Ae<we?-1:we<Ae?1:0},o.isEncoding=function(pe){switch(String(pe).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(pe,ge){if(!Array.isArray(pe))throw new TypeError('"list" argument must be an Array of Buffers');if(pe.length===0)return o.alloc(0);var Ae;if(ge===void 0)for(ge=0,Ae=0;Ae<pe.length;++Ae)ge+=pe[Ae].length;var we=o.allocUnsafe(ge),De=0;for(Ae=0;Ae<pe.length;++Ae){var Be=pe[Ae];if(le(Be,Uint8Array)&&(Be=o.from(Be)),!o.isBuffer(Be))throw new TypeError('"list" argument must be an Array of Buffers');Be.copy(we,De),De+=Be.length}return we};function x(fe,pe){if(o.isBuffer(fe))return fe.length;if(ArrayBuffer.isView(fe)||le(fe,ArrayBuffer))return fe.byteLength;if(typeof fe!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof fe);var ge=fe.length,Ae=arguments.length>2&&arguments[2]===!0;if(!Ae&&ge===0)return 0;for(var we=!1;;)switch(pe){case"ascii":case"latin1":case"binary":return ge;case"utf8":case"utf-8":return W(fe).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ge*2;case"hex":return ge>>>1;case"base64":return te(fe).length;default:if(we)return Ae?-1:W(fe).length;pe=(""+pe).toLowerCase(),we=!0}}o.byteLength=x;function v(fe,pe,ge){var Ae=!1;if((pe===void 0||pe<0)&&(pe=0),pe>this.length||((ge===void 0||ge>this.length)&&(ge=this.length),ge<=0)||(ge>>>=0,pe>>>=0,ge<=pe))return"";for(fe||(fe="utf8");;)switch(fe){case"hex":return j(this,pe,ge);case"utf8":case"utf-8":return B(this,pe,ge);case"ascii":return G(this,pe,ge);case"latin1":case"binary":return J(this,pe,ge);case"base64":return R(this,pe,ge);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,pe,ge);default:if(Ae)throw new TypeError("Unknown encoding: "+fe);fe=(fe+"").toLowerCase(),Ae=!0}}o.prototype._isBuffer=!0;function b(fe,pe,ge){var Ae=fe[pe];fe[pe]=fe[ge],fe[ge]=Ae}o.prototype.swap16=function(){var pe=this.length;if(pe%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var ge=0;ge<pe;ge+=2)b(this,ge,ge+1);return this},o.prototype.swap32=function(){var pe=this.length;if(pe%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var ge=0;ge<pe;ge+=4)b(this,ge,ge+3),b(this,ge+1,ge+2);return this},o.prototype.swap64=function(){var pe=this.length;if(pe%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var ge=0;ge<pe;ge+=8)b(this,ge,ge+7),b(this,ge+1,ge+6),b(this,ge+2,ge+5),b(this,ge+3,ge+4);return this},o.prototype.toString=function(){var pe=this.length;return pe===0?"":arguments.length===0?B(this,0,pe):v.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(pe){if(!o.isBuffer(pe))throw new TypeError("Argument must be a Buffer");return this===pe?!0:o.compare(this,pe)===0},o.prototype.inspect=function(){var pe="",ge=T.INSPECT_MAX_BYTES;return pe=this.toString("hex",0,ge).replace(/(.{2})/g,"$1 ").trim(),this.length>ge&&(pe+=" ... "),"<Buffer "+pe+">"},o.prototype.compare=function(pe,ge,Ae,we,De){if(le(pe,Uint8Array)&&(pe=o.from(pe,pe.offset,pe.byteLength)),!o.isBuffer(pe))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof pe);if(ge===void 0&&(ge=0),Ae===void 0&&(Ae=pe?pe.length:0),we===void 0&&(we=0),De===void 0&&(De=this.length),ge<0||Ae>pe.length||we<0||De>this.length)throw new RangeError("out of range index");if(we>=De&&ge>=Ae)return 0;if(we>=De)return-1;if(ge>=Ae)return 1;if(ge>>>=0,Ae>>>=0,we>>>=0,De>>>=0,this===pe)return 0;for(var Be=De-we,Ve=Ae-ge,xe=Math.min(Be,Ve),Le=this.slice(we,De),He=pe.slice(ge,Ae),Je=0;Je<xe;++Je)if(Le[Je]!==He[Je]){Be=Le[Je],Ve=He[Je];break}return Be<Ve?-1:Ve<Be?1:0};function l(fe,pe,ge,Ae,we){if(fe.length===0)return-1;if(typeof ge=="string"?(Ae=ge,ge=0):ge>2147483647?ge=2147483647:ge<-2147483648&&(ge=-2147483648),ge=+ge,ye(ge)&&(ge=we?0:fe.length-1),ge<0&&(ge=fe.length+ge),ge>=fe.length){if(we)return-1;ge=fe.length-1}else if(ge<0)if(we)ge=0;else return-1;if(typeof pe=="string"&&(pe=o.from(pe,Ae)),o.isBuffer(pe))return pe.length===0?-1:L(fe,pe,ge,Ae,we);if(typeof pe=="number")return pe=pe&255,typeof Uint8Array.prototype.indexOf=="function"?we?Uint8Array.prototype.indexOf.call(fe,pe,ge):Uint8Array.prototype.lastIndexOf.call(fe,pe,ge):L(fe,[pe],ge,Ae,we);throw new TypeError("val must be string, number or Buffer")}function L(fe,pe,ge,Ae,we){var De=1,Be=fe.length,Ve=pe.length;if(Ae!==void 0&&(Ae=String(Ae).toLowerCase(),Ae==="ucs2"||Ae==="ucs-2"||Ae==="utf16le"||Ae==="utf-16le")){if(fe.length<2||pe.length<2)return-1;De=2,Be/=2,Ve/=2,ge/=2}function xe(Pe,Ue){return De===1?Pe[Ue]:Pe.readUInt16BE(Ue*De)}var Le;if(we){var He=-1;for(Le=ge;Le<Be;Le++)if(xe(fe,Le)===xe(pe,He===-1?0:Le-He)){if(He===-1&&(He=Le),Le-He+1===Ve)return He*De}else He!==-1&&(Le-=Le-He),He=-1}else for(ge+Ve>Be&&(ge=Be-Ve),Le=ge;Le>=0;Le--){for(var Je=!0,Oe=0;Oe<Ve;Oe++)if(xe(fe,Le+Oe)!==xe(pe,Oe)){Je=!1;break}if(Je)return Le}return-1}o.prototype.includes=function(pe,ge,Ae){return this.indexOf(pe,ge,Ae)!==-1},o.prototype.indexOf=function(pe,ge,Ae){return l(this,pe,ge,Ae,!0)},o.prototype.lastIndexOf=function(pe,ge,Ae){return l(this,pe,ge,Ae,!1)};function S(fe,pe,ge,Ae){ge=Number(ge)||0;var we=fe.length-ge;Ae?(Ae=Number(Ae),Ae>we&&(Ae=we)):Ae=we;var De=pe.length;Ae>De/2&&(Ae=De/2);for(var Be=0;Be<Ae;++Be){var Ve=parseInt(pe.substr(Be*2,2),16);if(ye(Ve))return Be;fe[ge+Be]=Ve}return Be}function k(fe,pe,ge,Ae){return ae(W(pe,fe.length-ge),fe,ge,Ae)}function P(fe,pe,ge,Ae){return ae(Z(pe),fe,ge,Ae)}function z(fe,pe,ge,Ae){return P(fe,pe,ge,Ae)}function I(fe,pe,ge,Ae){return ae(te(pe),fe,ge,Ae)}function D(fe,pe,ge,Ae){return ae(ee(pe,fe.length-ge),fe,ge,Ae)}o.prototype.write=function(pe,ge,Ae,we){if(ge===void 0)we="utf8",Ae=this.length,ge=0;else if(Ae===void 0&&typeof ge=="string")we=ge,Ae=this.length,ge=0;else if(isFinite(ge))ge=ge>>>0,isFinite(Ae)?(Ae=Ae>>>0,we===void 0&&(we="utf8")):(we=Ae,Ae=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var De=this.length-ge;if((Ae===void 0||Ae>De)&&(Ae=De),pe.length>0&&(Ae<0||ge<0)||ge>this.length)throw new RangeError("Attempt to write outside buffer bounds");we||(we="utf8");for(var Be=!1;;)switch(we){case"hex":return S(this,pe,ge,Ae);case"utf8":case"utf-8":return k(this,pe,ge,Ae);case"ascii":return P(this,pe,ge,Ae);case"latin1":case"binary":return z(this,pe,ge,Ae);case"base64":return I(this,pe,ge,Ae);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,pe,ge,Ae);default:if(Be)throw new TypeError("Unknown encoding: "+we);we=(""+we).toLowerCase(),Be=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function R(fe,pe,ge){return pe===0&&ge===fe.length?a.fromByteArray(fe):a.fromByteArray(fe.slice(pe,ge))}function B(fe,pe,ge){ge=Math.min(fe.length,ge);for(var Ae=[],we=pe;we<ge;){var De=fe[we],Be=null,Ve=De>239?4:De>223?3:De>191?2:1;if(we+Ve<=ge){var xe,Le,He,Je;switch(Ve){case 1:De<128&&(Be=De);break;case 2:xe=fe[we+1],(xe&192)===128&&(Je=(De&31)<<6|xe&63,Je>127&&(Be=Je));break;case 3:xe=fe[we+1],Le=fe[we+2],(xe&192)===128&&(Le&192)===128&&(Je=(De&15)<<12|(xe&63)<<6|Le&63,Je>2047&&(Je<55296||Je>57343)&&(Be=Je));break;case 4:xe=fe[we+1],Le=fe[we+2],He=fe[we+3],(xe&192)===128&&(Le&192)===128&&(He&192)===128&&(Je=(De&15)<<18|(xe&63)<<12|(Le&63)<<6|He&63,Je>65535&&Je<1114112&&(Be=Je))}}Be===null?(Be=65533,Ve=1):Be>65535&&(Be-=65536,Ae.push(Be>>>10&1023|55296),Be=56320|Be&1023),Ae.push(Be),we+=Ve}return V(Ae)}var F=4096;function V(fe){var pe=fe.length;if(pe<=F)return String.fromCharCode.apply(String,fe);for(var ge="",Ae=0;Ae<pe;)ge+=String.fromCharCode.apply(String,fe.slice(Ae,Ae+=F));return ge}function G(fe,pe,ge){var Ae="";ge=Math.min(fe.length,ge);for(var we=pe;we<ge;++we)Ae+=String.fromCharCode(fe[we]&127);return Ae}function J(fe,pe,ge){var Ae="";ge=Math.min(fe.length,ge);for(var we=pe;we<ge;++we)Ae+=String.fromCharCode(fe[we]);return Ae}function j(fe,pe,ge){var Ae=fe.length;(!pe||pe<0)&&(pe=0),(!ge||ge<0||ge>Ae)&&(ge=Ae);for(var we="",De=pe;De<ge;++De)we+=Q(fe[De]);return we}function Y(fe,pe,ge){for(var Ae=fe.slice(pe,ge),we="",De=0;De<Ae.length;De+=2)we+=String.fromCharCode(Ae[De]+Ae[De+1]*256);return we}o.prototype.slice=function(pe,ge){var Ae=this.length;pe=~~pe,ge=ge===void 0?Ae:~~ge,pe<0?(pe+=Ae,pe<0&&(pe=0)):pe>Ae&&(pe=Ae),ge<0?(ge+=Ae,ge<0&&(ge=0)):ge>Ae&&(ge=Ae),ge<pe&&(ge=pe);var we=this.subarray(pe,ge);return we.__proto__=o.prototype,we};function X(fe,pe,ge){if(fe%1!==0||fe<0)throw new RangeError("offset is not uint");if(fe+pe>ge)throw new RangeError("Trying to access beyond buffer length")}o.prototype.readUIntLE=function(pe,ge,Ae){pe=pe>>>0,ge=ge>>>0,Ae||X(pe,ge,this.length);for(var we=this[pe],De=1,Be=0;++Be<ge&&(De*=256);)we+=this[pe+Be]*De;return we},o.prototype.readUIntBE=function(pe,ge,Ae){pe=pe>>>0,ge=ge>>>0,Ae||X(pe,ge,this.length);for(var we=this[pe+--ge],De=1;ge>0&&(De*=256);)we+=this[pe+--ge]*De;return we},o.prototype.readUInt8=function(pe,ge){return pe=pe>>>0,ge||X(pe,1,this.length),this[pe]},o.prototype.readUInt16LE=function(pe,ge){return pe=pe>>>0,ge||X(pe,2,this.length),this[pe]|this[pe+1]<<8},o.prototype.readUInt16BE=function(pe,ge){return pe=pe>>>0,ge||X(pe,2,this.length),this[pe]<<8|this[pe+1]},o.prototype.readUInt32LE=function(pe,ge){return pe=pe>>>0,ge||X(pe,4,this.length),(this[pe]|this[pe+1]<<8|this[pe+2]<<16)+this[pe+3]*16777216},o.prototype.readUInt32BE=function(pe,ge){return pe=pe>>>0,ge||X(pe,4,this.length),this[pe]*16777216+(this[pe+1]<<16|this[pe+2]<<8|this[pe+3])},o.prototype.readIntLE=function(pe,ge,Ae){pe=pe>>>0,ge=ge>>>0,Ae||X(pe,ge,this.length);for(var we=this[pe],De=1,Be=0;++Be<ge&&(De*=256);)we+=this[pe+Be]*De;return De*=128,we>=De&&(we-=Math.pow(2,8*ge)),we},o.prototype.readIntBE=function(pe,ge,Ae){pe=pe>>>0,ge=ge>>>0,Ae||X(pe,ge,this.length);for(var we=ge,De=1,Be=this[pe+--we];we>0&&(De*=256);)Be+=this[pe+--we]*De;return De*=128,Be>=De&&(Be-=Math.pow(2,8*ge)),Be},o.prototype.readInt8=function(pe,ge){return pe=pe>>>0,ge||X(pe,1,this.length),this[pe]&128?(255-this[pe]+1)*-1:this[pe]},o.prototype.readInt16LE=function(pe,ge){pe=pe>>>0,ge||X(pe,2,this.length);var Ae=this[pe]|this[pe+1]<<8;return Ae&32768?Ae|4294901760:Ae},o.prototype.readInt16BE=function(pe,ge){pe=pe>>>0,ge||X(pe,2,this.length);var Ae=this[pe+1]|this[pe]<<8;return Ae&32768?Ae|4294901760:Ae},o.prototype.readInt32LE=function(pe,ge){return pe=pe>>>0,ge||X(pe,4,this.length),this[pe]|this[pe+1]<<8|this[pe+2]<<16|this[pe+3]<<24},o.prototype.readInt32BE=function(pe,ge){return pe=pe>>>0,ge||X(pe,4,this.length),this[pe]<<24|this[pe+1]<<16|this[pe+2]<<8|this[pe+3]},o.prototype.readFloatLE=function(pe,ge){return pe=pe>>>0,ge||X(pe,4,this.length),n.read(this,pe,!0,23,4)},o.prototype.readFloatBE=function(pe,ge){return pe=pe>>>0,ge||X(pe,4,this.length),n.read(this,pe,!1,23,4)},o.prototype.readDoubleLE=function(pe,ge){return pe=pe>>>0,ge||X(pe,8,this.length),n.read(this,pe,!0,52,8)},o.prototype.readDoubleBE=function(pe,ge){return pe=pe>>>0,ge||X(pe,8,this.length),n.read(this,pe,!1,52,8)};function oe(fe,pe,ge,Ae,we,De){if(!o.isBuffer(fe))throw new TypeError('"buffer" argument must be a Buffer instance');if(pe>we||pe<De)throw new RangeError('"value" argument is out of bounds');if(ge+Ae>fe.length)throw new RangeError("Index out of range")}o.prototype.writeUIntLE=function(pe,ge,Ae,we){if(pe=+pe,ge=ge>>>0,Ae=Ae>>>0,!we){var De=Math.pow(2,8*Ae)-1;oe(this,pe,ge,Ae,De,0)}var Be=1,Ve=0;for(this[ge]=pe&255;++Ve<Ae&&(Be*=256);)this[ge+Ve]=pe/Be&255;return ge+Ae},o.prototype.writeUIntBE=function(pe,ge,Ae,we){if(pe=+pe,ge=ge>>>0,Ae=Ae>>>0,!we){var De=Math.pow(2,8*Ae)-1;oe(this,pe,ge,Ae,De,0)}var Be=Ae-1,Ve=1;for(this[ge+Be]=pe&255;--Be>=0&&(Ve*=256);)this[ge+Be]=pe/Ve&255;return ge+Ae},o.prototype.writeUInt8=function(pe,ge,Ae){return pe=+pe,ge=ge>>>0,Ae||oe(this,pe,ge,1,255,0),this[ge]=pe&255,ge+1},o.prototype.writeUInt16LE=function(pe,ge,Ae){return pe=+pe,ge=ge>>>0,Ae||oe(this,pe,ge,2,65535,0),this[ge]=pe&255,this[ge+1]=pe>>>8,ge+2},o.prototype.writeUInt16BE=function(pe,ge,Ae){return pe=+pe,ge=ge>>>0,Ae||oe(this,pe,ge,2,65535,0),this[ge]=pe>>>8,this[ge+1]=pe&255,ge+2},o.prototype.writeUInt32LE=function(pe,ge,Ae){return pe=+pe,ge=ge>>>0,Ae||oe(this,pe,ge,4,4294967295,0),this[ge+3]=pe>>>24,this[ge+2]=pe>>>16,this[ge+1]=pe>>>8,this[ge]=pe&255,ge+4},o.prototype.writeUInt32BE=function(pe,ge,Ae){return pe=+pe,ge=ge>>>0,Ae||oe(this,pe,ge,4,4294967295,0),this[ge]=pe>>>24,this[ge+1]=pe>>>16,this[ge+2]=pe>>>8,this[ge+3]=pe&255,ge+4},o.prototype.writeIntLE=function(pe,ge,Ae,we){if(pe=+pe,ge=ge>>>0,!we){var De=Math.pow(2,8*Ae-1);oe(this,pe,ge,Ae,De-1,-De)}var Be=0,Ve=1,xe=0;for(this[ge]=pe&255;++Be<Ae&&(Ve*=256);)pe<0&&xe===0&&this[ge+Be-1]!==0&&(xe=1),this[ge+Be]=(pe/Ve>>0)-xe&255;return ge+Ae},o.prototype.writeIntBE=function(pe,ge,Ae,we){if(pe=+pe,ge=ge>>>0,!we){var De=Math.pow(2,8*Ae-1);oe(this,pe,ge,Ae,De-1,-De)}var Be=Ae-1,Ve=1,xe=0;for(this[ge+Be]=pe&255;--Be>=0&&(Ve*=256);)pe<0&&xe===0&&this[ge+Be+1]!==0&&(xe=1),this[ge+Be]=(pe/Ve>>0)-xe&255;return ge+Ae},o.prototype.writeInt8=function(pe,ge,Ae){return pe=+pe,ge=ge>>>0,Ae||oe(this,pe,ge,1,127,-128),pe<0&&(pe=255+pe+1),this[ge]=pe&255,ge+1},o.prototype.writeInt16LE=function(pe,ge,Ae){return pe=+pe,ge=ge>>>0,Ae||oe(this,pe,ge,2,32767,-32768),this[ge]=pe&255,this[ge+1]=pe>>>8,ge+2},o.prototype.writeInt16BE=function(pe,ge,Ae){return pe=+pe,ge=ge>>>0,Ae||oe(this,pe,ge,2,32767,-32768),this[ge]=pe>>>8,this[ge+1]=pe&255,ge+2},o.prototype.writeInt32LE=function(pe,ge,Ae){return pe=+pe,ge=ge>>>0,Ae||oe(this,pe,ge,4,2147483647,-2147483648),this[ge]=pe&255,this[ge+1]=pe>>>8,this[ge+2]=pe>>>16,this[ge+3]=pe>>>24,ge+4},o.prototype.writeInt32BE=function(pe,ge,Ae){return pe=+pe,ge=ge>>>0,Ae||oe(this,pe,ge,4,2147483647,-2147483648),pe<0&&(pe=4294967295+pe+1),this[ge]=pe>>>24,this[ge+1]=pe>>>16,this[ge+2]=pe>>>8,this[ge+3]=pe&255,ge+4};function se(fe,pe,ge,Ae,we,De){if(ge+Ae>fe.length)throw new RangeError("Index out of range");if(ge<0)throw new RangeError("Index out of range")}function ie(fe,pe,ge,Ae,we){return pe=+pe,ge=ge>>>0,we||se(fe,pe,ge,4),n.write(fe,pe,ge,Ae,23,4),ge+4}o.prototype.writeFloatLE=function(pe,ge,Ae){return ie(this,pe,ge,!0,Ae)},o.prototype.writeFloatBE=function(pe,ge,Ae){return ie(this,pe,ge,!1,Ae)};function N(fe,pe,ge,Ae,we){return pe=+pe,ge=ge>>>0,we||se(fe,pe,ge,8),n.write(fe,pe,ge,Ae,52,8),ge+8}o.prototype.writeDoubleLE=function(pe,ge,Ae){return N(this,pe,ge,!0,Ae)},o.prototype.writeDoubleBE=function(pe,ge,Ae){return N(this,pe,ge,!1,Ae)},o.prototype.copy=function(pe,ge,Ae,we){if(!o.isBuffer(pe))throw new TypeError("argument should be a Buffer");if(Ae||(Ae=0),!we&&we!==0&&(we=this.length),ge>=pe.length&&(ge=pe.length),ge||(ge=0),we>0&&we<Ae&&(we=Ae),we===Ae||pe.length===0||this.length===0)return 0;if(ge<0)throw new RangeError("targetStart out of bounds");if(Ae<0||Ae>=this.length)throw new RangeError("Index out of range");if(we<0)throw new RangeError("sourceEnd out of bounds");we>this.length&&(we=this.length),pe.length-ge<we-Ae&&(we=pe.length-ge+Ae);var De=we-Ae;if(this===pe&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(ge,Ae,we);else if(this===pe&&Ae<ge&&ge<we)for(var Be=De-1;Be>=0;--Be)pe[Be+ge]=this[Be+Ae];else Uint8Array.prototype.set.call(pe,this.subarray(Ae,we),ge);return De},o.prototype.fill=function(pe,ge,Ae,we){if(typeof pe=="string"){if(typeof ge=="string"?(we=ge,ge=0,Ae=this.length):typeof Ae=="string"&&(we=Ae,Ae=this.length),we!==void 0&&typeof we!="string")throw new TypeError("encoding must be a string");if(typeof we=="string"&&!o.isEncoding(we))throw new TypeError("Unknown encoding: "+we);if(pe.length===1){var De=pe.charCodeAt(0);(we==="utf8"&&De<128||we==="latin1")&&(pe=De)}}else typeof pe=="number"&&(pe=pe&255);if(ge<0||this.length<ge||this.length<Ae)throw new RangeError("Out of range index");if(Ae<=ge)return this;ge=ge>>>0,Ae=Ae===void 0?this.length:Ae>>>0,pe||(pe=0);var Be;if(typeof pe=="number")for(Be=ge;Be<Ae;++Be)this[Be]=pe;else{var Ve=o.isBuffer(pe)?pe:o.from(pe,we),xe=Ve.length;if(xe===0)throw new TypeError('The value "'+pe+'" is invalid for argument "value"');for(Be=0;Be<Ae-ge;++Be)this[Be+ge]=Ve[Be%xe]}return this};var U=/[^+/0-9A-Za-z-_]/g;function q(fe){if(fe=fe.split("=")[0],fe=fe.trim().replace(U,""),fe.length<2)return"";for(;fe.length%4!==0;)fe=fe+"=";return fe}function Q(fe){return fe<16?"0"+fe.toString(16):fe.toString(16)}function W(fe,pe){pe=pe||1/0;for(var ge,Ae=fe.length,we=null,De=[],Be=0;Be<Ae;++Be){if(ge=fe.charCodeAt(Be),ge>55295&&ge<57344){if(!we){if(ge>56319){(pe-=3)>-1&&De.push(239,191,189);continue}else if(Be+1===Ae){(pe-=3)>-1&&De.push(239,191,189);continue}we=ge;continue}if(ge<56320){(pe-=3)>-1&&De.push(239,191,189),we=ge;continue}ge=(we-55296<<10|ge-56320)+65536}else we&&(pe-=3)>-1&&De.push(239,191,189);if(we=null,ge<128){if((pe-=1)<0)break;De.push(ge)}else if(ge<2048){if((pe-=2)<0)break;De.push(ge>>6|192,ge&63|128)}else if(ge<65536){if((pe-=3)<0)break;De.push(ge>>12|224,ge>>6&63|128,ge&63|128)}else if(ge<1114112){if((pe-=4)<0)break;De.push(ge>>18|240,ge>>12&63|128,ge>>6&63|128,ge&63|128)}else throw new Error("Invalid code point")}return De}function Z(fe){for(var pe=[],ge=0;ge<fe.length;++ge)pe.push(fe.charCodeAt(ge)&255);return pe}function ee(fe,pe){for(var ge,Ae,we,De=[],Be=0;Be<fe.length&&!((pe-=2)<0);++Be)ge=fe.charCodeAt(Be),Ae=ge>>8,we=ge%256,De.push(we),De.push(Ae);return De}function te(fe){return a.toByteArray(q(fe))}function ae(fe,pe,ge,Ae){for(var we=0;we<Ae&&!(we+ge>=pe.length||we>=fe.length);++we)pe[we+ge]=fe[we];return we}function le(fe,pe){return fe instanceof pe||fe!=null&&fe.constructor!=null&&fe.constructor.name!=null&&fe.constructor.name===pe.name}function ye(fe){return fe!==fe}}).call(this)}).call(this,c("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(c,M,T){T.read=function(e,a,n,r,t){var f,o,i=t*8-r-1,g=(1<<i)-1,p=g>>1,y=-7,h=n?t-1:0,m=n?-1:1,u=e[a+h];for(h+=m,f=u&(1<<-y)-1,u>>=-y,y+=i;y>0;f=f*256+e[a+h],h+=m,y-=8);for(o=f&(1<<-y)-1,f>>=-y,y+=r;y>0;o=o*256+e[a+h],h+=m,y-=8);if(f===0)f=1-p;else{if(f===g)return o?NaN:(u?-1:1)*(1/0);o=o+Math.pow(2,r),f=f-p}return(u?-1:1)*o*Math.pow(2,f-r)},T.write=function(e,a,n,r,t,f){var o,i,g,p=f*8-t-1,y=(1<<p)-1,h=y>>1,m=t===23?Math.pow(2,-24)-Math.pow(2,-77):0,u=r?0:f-1,_=r?1:-1,s=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(i=isNaN(a)?1:0,o=y):(o=Math.floor(Math.log(a)/Math.LN2),a*(g=Math.pow(2,-o))<1&&(o--,g*=2),o+h>=1?a+=m/g:a+=m*Math.pow(2,1-h),a*g>=2&&(o++,g/=2),o+h>=y?(i=0,o=y):o+h>=1?(i=(a*g-1)*Math.pow(2,t),o=o+h):(i=a*Math.pow(2,h-1)*Math.pow(2,t),o=0));t>=8;e[n+u]=i&255,u+=_,i/=256,t-=8);for(o=o<<t|i,p+=t;p>0;e[n+u]=o&255,u+=_,o/=256,p-=8);e[n+u-_]|=s*128}},{}],5:[function(c,M,T){var e=M.exports={},a,n;function r(){throw new Error("setTimeout has not been defined")}function t(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?a=setTimeout:a=r}catch{a=r}try{typeof clearTimeout=="function"?n=clearTimeout:n=t}catch{n=t}})();function f(s){if(a===setTimeout)return setTimeout(s,0);if((a===r||!a)&&setTimeout)return a=setTimeout,setTimeout(s,0);try{return a(s,0)}catch{try{return a.call(null,s,0)}catch{return a.call(this,s,0)}}}function o(s){if(n===clearTimeout)return clearTimeout(s);if((n===t||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(s);try{return n(s)}catch{try{return n.call(null,s)}catch{return n.call(this,s)}}}var i=[],g=!1,p,y=-1;function h(){!g||!p||(g=!1,p.length?i=p.concat(i):y=-1,i.length&&m())}function m(){if(!g){var s=f(h);g=!0;for(var A=i.length;A;){for(p=i,i=[];++y<A;)p&&p[y].run();y=-1,A=i.length}p=null,g=!1,o(s)}}e.nextTick=function(s){var A=new Array(arguments.length-1);if(arguments.length>1)for(var x=1;x<arguments.length;x++)A[x-1]=arguments[x];i.push(new u(s,A)),i.length===1&&!g&&f(m)};function u(s,A){this.fun=s,this.array=A}u.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={};function _(){}e.on=_,e.addListener=_,e.once=_,e.off=_,e.removeListener=_,e.removeAllListeners=_,e.emit=_,e.prependListener=_,e.prependOnceListener=_,e.listeners=function(s){return[]},e.binding=function(s){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(s){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],6:[function(c,M,T){M.exports={alpha_shape:c("alpha-shape"),convex_hull:c("convex-hull"),delaunay_triangulate:c("delaunay-triangulate"),gl_cone3d:c("gl-cone3d"),gl_error3d:c("gl-error3d"),gl_heatmap2d:c("gl-heatmap2d"),gl_line3d:c("gl-line3d"),gl_mesh3d:c("gl-mesh3d"),gl_plot2d:c("gl-plot2d"),gl_plot3d:c("gl-plot3d"),gl_pointcloud2d:c("gl-pointcloud2d"),gl_scatter3d:c("gl-scatter3d"),gl_select_box:c("gl-select-box"),gl_spikes2d:c("gl-spikes2d"),gl_streamtube3d:c("gl-streamtube3d"),gl_surface3d:c("gl-surface3d"),ndarray:c("ndarray"),ndarray_linear_interpolate:c("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(c,M,T){M.exports=f;var e=c("turntable-camera-controller"),a=c("orbit-camera-controller"),n=c("matrix-camera-controller");function r(o,i){this._controllerNames=Object.keys(o),this._controllerList=this._controllerNames.map(function(g){return o[g]}),this._mode=i,this._active=o[i],this._active||(this._mode="turntable",this._active=o.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var t=r.prototype;t.flush=function(o){for(var i=this._controllerList,g=0;g<i.length;++g)i[g].flush(o)},t.idle=function(o){for(var i=this._controllerList,g=0;g<i.length;++g)i[g].idle(o)},t.lookAt=function(o,i,g,p){for(var y=this._controllerList,h=0;h<y.length;++h)y[h].lookAt(o,i,g,p)},t.rotate=function(o,i,g,p){for(var y=this._controllerList,h=0;h<y.length;++h)y[h].rotate(o,i,g,p)},t.pan=function(o,i,g,p){for(var y=this._controllerList,h=0;h<y.length;++h)y[h].pan(o,i,g,p)},t.translate=function(o,i,g,p){for(var y=this._controllerList,h=0;h<y.length;++h)y[h].translate(o,i,g,p)},t.setMatrix=function(o,i){for(var g=this._controllerList,p=0;p<g.length;++p)g[p].setMatrix(o,i)},t.setDistanceLimits=function(o,i){for(var g=this._controllerList,p=0;p<g.length;++p)g[p].setDistanceLimits(o,i)},t.setDistance=function(o,i){for(var g=this._controllerList,p=0;p<g.length;++p)g[p].setDistance(o,i)},t.recalcMatrix=function(o){this._active.recalcMatrix(o)},t.getDistance=function(o){return this._active.getDistance(o)},t.getDistanceLimits=function(o){return this._active.getDistanceLimits(o)},t.lastT=function(){return this._active.lastT()},t.setMode=function(o){if(o!==this._mode){var i=this._controllerNames.indexOf(o);if(!(i<0)){var g=this._active,p=this._controllerList[i],y=Math.max(g.lastT(),p.lastT());g.recalcMatrix(y),p.setMatrix(y,g.computedMatrix),this._active=p,this._mode=o,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},t.getMode=function(){return this._mode};function f(o){o=o||{};var i=o.eye||[0,0,1],g=o.center||[0,0,0],p=o.up||[0,1,0],y=o.distanceLimits||[0,1/0],h=o.mode||"turntable",m=e(),u=a(),_=n();return m.setDistanceLimits(y[0],y[1]),m.lookAt(0,i,g,p),u.setDistanceLimits(y[0],y[1]),u.lookAt(0,i,g,p),_.setDistanceLimits(y[0],y[1]),_.lookAt(0,i,g,p),new r({turntable:m,orbit:u,matrix:_},h)}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(c,M,T){var e=typeof WeakMap=="undefined"?c("weak-map"):WeakMap,a=c("gl-buffer"),n=c("gl-vao"),r=new e;function t(f){var o=r.get(f),i=o&&(o._triangleBuffer.handle||o._triangleBuffer.buffer);if(!i||!f.isBuffer(i)){var g=a(f,new Float32Array([-1,-1,-1,4,4,-1]));o=n(f,[{buffer:g,type:f.FLOAT,size:2}]),o._triangleBuffer=g,r.set(f,o)}o.bind(),f.drawArrays(f.TRIANGLES,0,3),o.unbind()}M.exports=t},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(c,M,T){var e=c("pad-left");M.exports=a;function a(n,r,t){r=typeof r=="number"?r:1,t=t||": ";var f=n.split(/\r?\n/),o=String(f.length+r-1).length;return f.map(function(i,g){var p=g+r,y=String(p).length,h=e(p,o-y);return h+t+i}).join(`
`)}},{"pad-left":264}],10:[function(c,M,T){M.exports=n;var e=c("robust-orientation");function a(r,t){for(var f=new Array(t+1),o=0;o<r.length;++o)f[o]=r[o];for(var o=0;o<=r.length;++o){for(var i=r.length;i<=t;++i){for(var g=new Array(t),p=0;p<t;++p)g[p]=Math.pow(i+1-o,p);f[i]=g}var y=e.apply(void 0,f);if(y)return!0}return!1}function n(r){var t=r.length;if(t===0)return[];if(t===1)return[0];for(var f=r[0].length,o=[r[0]],i=[0],g=1;g<t;++g){if(o.push(r[g]),!a(o,f)){o.pop();continue}if(i.push(g),i.length===f+1)return i}return i}},{"robust-orientation":284}],11:[function(c,M,T){M.exports=n;var e=c("delaunay-triangulate"),a=c("circumradius");function n(r,t){return e(t).filter(function(f){for(var o=new Array(f.length),i=0;i<f.length;++i)o[i]=t[f[i]];return a(o)*r<1})}},{circumradius:49,"delaunay-triangulate":63}],12:[function(c,M,T){M.exports=n;var e=c("alpha-complex"),a=c("simplicial-complex-boundary");function n(r,t){return a(e(r,t))}},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(c,M,T){M.exports=function(a){return atob(a)}},{}],14:[function(c,M,T){M.exports=n;var e=c("robust-linear-solve");function a(r){for(var t=0,f=0;f<r.length;++f)t+=r[f];return t}function n(r,t){for(var f=t.length,o=new Array(f+1),i=0;i<f;++i){for(var g=new Array(f+1),p=0;p<=f;++p)g[p]=r[p][i];o[i]=g}o[f]=new Array(f+1);for(var i=0;i<=f;++i)o[f][i]=1;for(var y=new Array(f+1),i=0;i<f;++i)y[i]=t[i];y[f]=1;var h=e(o,y),m=a(h[f+1]);m===0&&(m=1);for(var u=new Array(f+1),i=0;i<=f;++i)u[i]=a(h[i])/m;return u}},{"robust-linear-solve":283}],15:[function(c,M,T){var e=c("./lib/rationalize");M.exports=a;function a(n,r){return e(n[0].mul(r[1]).add(r[0].mul(n[1])),n[1].mul(r[1]))}},{"./lib/rationalize":25}],16:[function(c,M,T){M.exports=e;function e(a,n){return a[0].mul(n[1]).cmp(n[0].mul(a[1]))}},{}],17:[function(c,M,T){var e=c("./lib/rationalize");M.exports=a;function a(n,r){return e(n[0].mul(r[1]),n[1].mul(r[0]))}},{"./lib/rationalize":25}],18:[function(c,M,T){var e=c("./is-rat"),a=c("./lib/is-bn"),n=c("./lib/num-to-bn"),r=c("./lib/str-to-bn"),t=c("./lib/rationalize"),f=c("./div");M.exports=o;function o(i,g){if(e(i))return g?f(i,o(g)):[i[0].clone(),i[1].clone()];var p=0,y,h;if(a(i))y=i.clone();else if(typeof i=="string")y=r(i);else{if(i===0)return[n(0),n(1)];if(i===Math.floor(i))y=n(i);else{for(;i!==Math.floor(i);)i=i*Math.pow(2,256),p-=256;y=n(i)}}if(e(g))y.mul(g[1]),h=g[0].clone();else if(a(g))h=g.clone();else if(typeof g=="string")h=r(g);else if(!g)h=n(1);else if(g===Math.floor(g))h=n(g);else{for(;g!==Math.floor(g);)g=g*Math.pow(2,256),p+=256;h=n(g)}return p>0?y=y.ushln(p):p<0&&(h=h.ushln(-p)),t(y,h)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(c,M,T){var e=c("./lib/is-bn");M.exports=a;function a(n){return Array.isArray(n)&&n.length===2&&e(n[0])&&e(n[1])}},{"./lib/is-bn":23}],20:[function(c,M,T){var e=c("bn.js");M.exports=a;function a(n){return n.cmp(new e(0))}},{"bn.js":33}],21:[function(c,M,T){var e=c("./bn-sign");M.exports=a;function a(n){var r=n.length,t=n.words,f=0;if(r===1)f=t[0];else if(r===2)f=t[0]+t[1]*67108864;else for(var o=0;o<r;o++){var i=t[o];f+=i*Math.pow(67108864,o)}return e(n)*f}},{"./bn-sign":20}],22:[function(c,M,T){var e=c("double-bits"),a=c("bit-twiddle").countTrailingZeros;M.exports=n;function n(r){var t=a(e.lo(r));if(t<32)return t;var f=a(e.hi(r));return f>20?52:f+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(c,M,T){c("bn.js"),M.exports=e;function e(a){return a&&typeof a=="object"&&Boolean(a.words)}},{"bn.js":33}],24:[function(c,M,T){var e=c("bn.js"),a=c("double-bits");M.exports=n;function n(r){var t=a.exponent(r);return t<52?new e(r):new e(r*Math.pow(2,52-t)).ushln(t-52)}},{"bn.js":33,"double-bits":64}],25:[function(c,M,T){var e=c("./num-to-bn"),a=c("./bn-sign");M.exports=n;function n(r,t){var f=a(r),o=a(t);if(f===0)return[e(0),e(1)];if(o===0)return[e(0),e(0)];o<0&&(r=r.neg(),t=t.neg());var i=r.gcd(t);return i.cmpn(1)?[r.div(i),t.div(i)]:[r,t]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(c,M,T){var e=c("bn.js");M.exports=a;function a(n){return new e(n)}},{"bn.js":33}],27:[function(c,M,T){var e=c("./lib/rationalize");M.exports=a;function a(n,r){return e(n[0].mul(r[0]),n[1].mul(r[1]))}},{"./lib/rationalize":25}],28:[function(c,M,T){var e=c("./lib/bn-sign");M.exports=a;function a(n){return e(n[0])*e(n[1])}},{"./lib/bn-sign":20}],29:[function(c,M,T){var e=c("./lib/rationalize");M.exports=a;function a(n,r){return e(n[0].mul(r[1]).sub(n[1].mul(r[0])),n[1].mul(r[1]))}},{"./lib/rationalize":25}],30:[function(c,M,T){var e=c("./lib/bn-to-num"),a=c("./lib/ctz");M.exports=n;function n(r){var t=r[0],f=r[1];if(t.cmpn(0)===0)return 0;var o=t.abs().divmod(f.abs()),i=o.div,g=e(i),p=o.mod,y=t.negative!==f.negative?-1:1;if(p.cmpn(0)===0)return y*g;if(g){var h=a(g)+4,m=e(p.ushln(h).divRound(f));return y*(g+m*Math.pow(2,-h))}else{var u=f.bitLength()-p.bitLength()+53,m=e(p.ushln(u).divRound(f));return u<1023?y*m*Math.pow(2,-u):(m*=Math.pow(2,-1023),y*m*Math.pow(2,1023-u))}}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(c,M,T){function e(o,i,g,p,y){for(var h=y+1;p<=y;){var m=p+y>>>1,u=o[m],_=g!==void 0?g(u,i):u-i;_>=0?(h=m,y=m-1):p=m+1}return h}function a(o,i,g,p,y){for(var h=y+1;p<=y;){var m=p+y>>>1,u=o[m],_=g!==void 0?g(u,i):u-i;_>0?(h=m,y=m-1):p=m+1}return h}function n(o,i,g,p,y){for(var h=p-1;p<=y;){var m=p+y>>>1,u=o[m],_=g!==void 0?g(u,i):u-i;_<0?(h=m,p=m+1):y=m-1}return h}function r(o,i,g,p,y){for(var h=p-1;p<=y;){var m=p+y>>>1,u=o[m],_=g!==void 0?g(u,i):u-i;_<=0?(h=m,p=m+1):y=m-1}return h}function t(o,i,g,p,y){for(;p<=y;){var h=p+y>>>1,m=o[h],u=g!==void 0?g(m,i):m-i;if(u===0)return h;u<=0?p=h+1:y=h-1}return-1}function f(o,i,g,p,y,h){return typeof g=="function"?h(o,i,g,p===void 0?0:p|0,y===void 0?o.length-1:y|0):h(o,i,void 0,g===void 0?0:g|0,p===void 0?o.length-1:p|0)}M.exports={ge:function(o,i,g,p,y){return f(o,i,g,p,y,e)},gt:function(o,i,g,p,y){return f(o,i,g,p,y,a)},lt:function(o,i,g,p,y){return f(o,i,g,p,y,n)},le:function(o,i,g,p,y){return f(o,i,g,p,y,r)},eq:function(o,i,g,p,y){return f(o,i,g,p,y,t)}}},{}],32:[function(c,M,T){var e=32;T.INT_BITS=e,T.INT_MAX=2147483647,T.INT_MIN=-1<<e-1,T.sign=function(r){return(r>0)-(r<0)},T.abs=function(r){var t=r>>e-1;return(r^t)-t},T.min=function(r,t){return t^(r^t)&-(r<t)},T.max=function(r,t){return r^(r^t)&-(r<t)},T.isPow2=function(r){return!(r&r-1)&&!!r},T.log2=function(r){var t,f;return t=(r>65535)<<4,r>>>=t,f=(r>255)<<3,r>>>=f,t|=f,f=(r>15)<<2,r>>>=f,t|=f,f=(r>3)<<1,r>>>=f,t|=f,t|r>>1},T.log10=function(r){return r>=1e9?9:r>=1e8?8:r>=1e7?7:r>=1e6?6:r>=1e5?5:r>=1e4?4:r>=1e3?3:r>=100?2:r>=10?1:0},T.popCount=function(r){return r=r-(r>>>1&1431655765),r=(r&858993459)+(r>>>2&858993459),(r+(r>>>4)&252645135)*16843009>>>24};function a(r){var t=32;return r&=-r,r&&t--,r&65535&&(t-=16),r&16711935&&(t-=8),r&252645135&&(t-=4),r&858993459&&(t-=2),r&1431655765&&(t-=1),t}T.countTrailingZeros=a,T.nextPow2=function(r){return r+=r===0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1},T.prevPow2=function(r){return r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r-(r>>>1)},T.parity=function(r){return r^=r>>>16,r^=r>>>8,r^=r>>>4,r&=15,27030>>>r&1};var n=new Array(256);(function(r){for(var t=0;t<256;++t){var f=t,o=t,i=7;for(f>>>=1;f;f>>>=1)o<<=1,o|=f&1,--i;r[t]=o<<i&255}})(n),T.reverse=function(r){return n[r&255]<<24|n[r>>>8&255]<<16|n[r>>>16&255]<<8|n[r>>>24&255]},T.interleave2=function(r,t){return r&=65535,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t&=65535,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1},T.deinterleave2=function(r,t){return r=r>>>t&1431655765,r=(r|r>>>1)&858993459,r=(r|r>>>2)&252645135,r=(r|r>>>4)&16711935,r=(r|r>>>16)&65535,r<<16>>16},T.interleave3=function(r,t,f){return r&=1023,r=(r|r<<16)&4278190335,r=(r|r<<8)&251719695,r=(r|r<<4)&3272356035,r=(r|r<<2)&1227133513,t&=1023,t=(t|t<<16)&4278190335,t=(t|t<<8)&251719695,t=(t|t<<4)&3272356035,t=(t|t<<2)&1227133513,r|=t<<1,f&=1023,f=(f|f<<16)&4278190335,f=(f|f<<8)&251719695,f=(f|f<<4)&3272356035,f=(f|f<<2)&1227133513,r|f<<2},T.deinterleave3=function(r,t){return r=r>>>t&1227133513,r=(r|r>>>2)&3272356035,r=(r|r>>>4)&251719695,r=(r|r>>>8)&4278190335,r=(r|r>>>16)&1023,r<<22>>22},T.nextCombination=function(r){var t=r|r-1;return t+1|(~t&-~t)-1>>>a(r)+1}},{}],33:[function(c,M,T){(function(e,a){function n(I,D){if(!I)throw new Error(D||"Assertion failed")}function r(I,D){I.super_=D;var R=function(){};R.prototype=D.prototype,I.prototype=new R,I.prototype.constructor=I}function t(I,D,R){if(t.isBN(I))return I;this.negative=0,this.words=null,this.length=0,this.red=null,I!==null&&((D==="le"||D==="be")&&(R=D,D=10),this._init(I||0,D||10,R||"be"))}typeof e=="object"?e.exports=t:a.BN=t,t.BN=t,t.wordSize=26;var f;try{typeof window!="undefined"&&typeof window.Buffer!="undefined"?f=window.Buffer:f=c("buffer").Buffer}catch{}t.isBN=function(D){return D instanceof t?!0:D!==null&&typeof D=="object"&&D.constructor.wordSize===t.wordSize&&Array.isArray(D.words)},t.max=function(D,R){return D.cmp(R)>0?D:R},t.min=function(D,R){return D.cmp(R)<0?D:R},t.prototype._init=function(D,R,B){if(typeof D=="number")return this._initNumber(D,R,B);if(typeof D=="object")return this._initArray(D,R,B);R==="hex"&&(R=16),n(R===(R|0)&&R>=2&&R<=36),D=D.toString().replace(/\s+/g,"");var F=0;D[0]==="-"&&(F++,this.negative=1),F<D.length&&(R===16?this._parseHex(D,F,B):(this._parseBase(D,R,F),B==="le"&&this._initArray(this.toArray(),R,B)))},t.prototype._initNumber=function(D,R,B){D<0&&(this.negative=1,D=-D),D<67108864?(this.words=[D&67108863],this.length=1):D<4503599627370496?(this.words=[D&67108863,D/67108864&67108863],this.length=2):(n(D<9007199254740992),this.words=[D&67108863,D/67108864&67108863,1],this.length=3),B==="le"&&this._initArray(this.toArray(),R,B)},t.prototype._initArray=function(D,R,B){if(n(typeof D.length=="number"),D.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(D.length/3),this.words=new Array(this.length);for(var F=0;F<this.length;F++)this.words[F]=0;var V,G,J=0;if(B==="be")for(F=D.length-1,V=0;F>=0;F-=3)G=D[F]|D[F-1]<<8|D[F-2]<<16,this.words[V]|=G<<J&67108863,this.words[V+1]=G>>>26-J&67108863,J+=24,J>=26&&(J-=26,V++);else if(B==="le")for(F=0,V=0;F<D.length;F+=3)G=D[F]|D[F+1]<<8|D[F+2]<<16,this.words[V]|=G<<J&67108863,this.words[V+1]=G>>>26-J&67108863,J+=24,J>=26&&(J-=26,V++);return this.strip()};function o(I,D){var R=I.charCodeAt(D);return R>=65&&R<=70?R-55:R>=97&&R<=102?R-87:R-48&15}function i(I,D,R){var B=o(I,R);return R-1>=D&&(B|=o(I,R-1)<<4),B}t.prototype._parseHex=function(D,R,B){this.length=Math.ceil((D.length-R)/6),this.words=new Array(this.length);for(var F=0;F<this.length;F++)this.words[F]=0;var V=0,G=0,J;if(B==="be")for(F=D.length-1;F>=R;F-=2)J=i(D,R,F)<<V,this.words[G]|=J&67108863,V>=18?(V-=18,G+=1,this.words[G]|=J>>>26):V+=8;else{var j=D.length-R;for(F=j%2===0?R+1:R;F<D.length;F+=2)J=i(D,R,F)<<V,this.words[G]|=J&67108863,V>=18?(V-=18,G+=1,this.words[G]|=J>>>26):V+=8}this.strip()};function g(I,D,R,B){for(var F=0,V=Math.min(I.length,R),G=D;G<V;G++){var J=I.charCodeAt(G)-48;F*=B,J>=49?F+=J-49+10:J>=17?F+=J-17+10:F+=J}return F}t.prototype._parseBase=function(D,R,B){this.words=[0],this.length=1;for(var F=0,V=1;V<=67108863;V*=R)F++;F--,V=V/R|0;for(var G=D.length-B,J=G%F,j=Math.min(G,G-J)+B,Y=0,X=B;X<j;X+=F)Y=g(D,X,X+F,R),this.imuln(V),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y);if(J!==0){var oe=1;for(Y=g(D,X,D.length,R),X=0;X<J;X++)oe*=R;this.imuln(oe),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y)}this.strip()},t.prototype.copy=function(D){D.words=new Array(this.length);for(var R=0;R<this.length;R++)D.words[R]=this.words[R];D.length=this.length,D.negative=this.negative,D.red=this.red},t.prototype.clone=function(){var D=new t(null);return this.copy(D),D},t.prototype._expand=function(D){for(;this.length<D;)this.words[this.length++]=0;return this},t.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},t.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},t.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],y=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];t.prototype.toString=function(D,R){D=D||10,R=R|0||1;var B;if(D===16||D==="hex"){B="";for(var F=0,V=0,G=0;G<this.length;G++){var J=this.words[G],j=((J<<F|V)&16777215).toString(16);V=J>>>24-F&16777215,V!==0||G!==this.length-1?B=p[6-j.length]+j+B:B=j+B,F+=2,F>=26&&(F-=26,G--)}for(V!==0&&(B=V.toString(16)+B);B.length%R!==0;)B="0"+B;return this.negative!==0&&(B="-"+B),B}if(D===(D|0)&&D>=2&&D<=36){var Y=y[D],X=h[D];B="";var oe=this.clone();for(oe.negative=0;!oe.isZero();){var se=oe.modn(X).toString(D);oe=oe.idivn(X),oe.isZero()?B=se+B:B=p[Y-se.length]+se+B}for(this.isZero()&&(B="0"+B);B.length%R!==0;)B="0"+B;return this.negative!==0&&(B="-"+B),B}n(!1,"Base should be between 2 and 36")},t.prototype.toNumber=function(){var D=this.words[0];return this.length===2?D+=this.words[1]*67108864:this.length===3&&this.words[2]===1?D+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-D:D},t.prototype.toJSON=function(){return this.toString(16)},t.prototype.toBuffer=function(D,R){return n(typeof f!="undefined"),this.toArrayLike(f,D,R)},t.prototype.toArray=function(D,R){return this.toArrayLike(Array,D,R)},t.prototype.toArrayLike=function(D,R,B){var F=this.byteLength(),V=B||Math.max(1,F);n(F<=V,"byte array longer than desired length"),n(V>0,"Requested array length <= 0"),this.strip();var G=R==="le",J=new D(V),j,Y,X=this.clone();if(G){for(Y=0;!X.isZero();Y++)j=X.andln(255),X.iushrn(8),J[Y]=j;for(;Y<V;Y++)J[Y]=0}else{for(Y=0;Y<V-F;Y++)J[Y]=0;for(Y=0;!X.isZero();Y++)j=X.andln(255),X.iushrn(8),J[V-Y-1]=j}return J},Math.clz32?t.prototype._countBits=function(D){return 32-Math.clz32(D)}:t.prototype._countBits=function(D){var R=D,B=0;return R>=4096&&(B+=13,R>>>=13),R>=64&&(B+=7,R>>>=7),R>=8&&(B+=4,R>>>=4),R>=2&&(B+=2,R>>>=2),B+R},t.prototype._zeroBits=function(D){if(D===0)return 26;var R=D,B=0;return(R&8191)===0&&(B+=13,R>>>=13),(R&127)===0&&(B+=7,R>>>=7),(R&15)===0&&(B+=4,R>>>=4),(R&3)===0&&(B+=2,R>>>=2),(R&1)===0&&B++,B},t.prototype.bitLength=function(){var D=this.words[this.length-1],R=this._countBits(D);return(this.length-1)*26+R};function m(I){for(var D=new Array(I.bitLength()),R=0;R<D.length;R++){var B=R/26|0,F=R%26;D[R]=(I.words[B]&1<<F)>>>F}return D}t.prototype.zeroBits=function(){if(this.isZero())return 0;for(var D=0,R=0;R<this.length;R++){var B=this._zeroBits(this.words[R]);if(D+=B,B!==26)break}return D},t.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},t.prototype.toTwos=function(D){return this.negative!==0?this.abs().inotn(D).iaddn(1):this.clone()},t.prototype.fromTwos=function(D){return this.testn(D-1)?this.notn(D).iaddn(1).ineg():this.clone()},t.prototype.isNeg=function(){return this.negative!==0},t.prototype.neg=function(){return this.clone().ineg()},t.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},t.prototype.iuor=function(D){for(;this.length<D.length;)this.words[this.length++]=0;for(var R=0;R<D.length;R++)this.words[R]=this.words[R]|D.words[R];return this.strip()},t.prototype.ior=function(D){return n((this.negative|D.negative)===0),this.iuor(D)},t.prototype.or=function(D){return this.length>D.length?this.clone().ior(D):D.clone().ior(this)},t.prototype.uor=function(D){return this.length>D.length?this.clone().iuor(D):D.clone().iuor(this)},t.prototype.iuand=function(D){var R;this.length>D.length?R=D:R=this;for(var B=0;B<R.length;B++)this.words[B]=this.words[B]&D.words[B];return this.length=R.length,this.strip()},t.prototype.iand=function(D){return n((this.negative|D.negative)===0),this.iuand(D)},t.prototype.and=function(D){return this.length>D.length?this.clone().iand(D):D.clone().iand(this)},t.prototype.uand=function(D){return this.length>D.length?this.clone().iuand(D):D.clone().iuand(this)},t.prototype.iuxor=function(D){var R,B;this.length>D.length?(R=this,B=D):(R=D,B=this);for(var F=0;F<B.length;F++)this.words[F]=R.words[F]^B.words[F];if(this!==R)for(;F<R.length;F++)this.words[F]=R.words[F];return this.length=R.length,this.strip()},t.prototype.ixor=function(D){return n((this.negative|D.negative)===0),this.iuxor(D)},t.prototype.xor=function(D){return this.length>D.length?this.clone().ixor(D):D.clone().ixor(this)},t.prototype.uxor=function(D){return this.length>D.length?this.clone().iuxor(D):D.clone().iuxor(this)},t.prototype.inotn=function(D){n(typeof D=="number"&&D>=0);var R=Math.ceil(D/26)|0,B=D%26;this._expand(R),B>0&&R--;for(var F=0;F<R;F++)this.words[F]=~this.words[F]&67108863;return B>0&&(this.words[F]=~this.words[F]&67108863>>26-B),this.strip()},t.prototype.notn=function(D){return this.clone().inotn(D)},t.prototype.setn=function(D,R){n(typeof D=="number"&&D>=0);var B=D/26|0,F=D%26;return this._expand(B+1),R?this.words[B]=this.words[B]|1<<F:this.words[B]=this.words[B]&~(1<<F),this.strip()},t.prototype.iadd=function(D){var R;if(this.negative!==0&&D.negative===0)return this.negative=0,R=this.isub(D),this.negative^=1,this._normSign();if(this.negative===0&&D.negative!==0)return D.negative=0,R=this.isub(D),D.negative=1,R._normSign();var B,F;this.length>D.length?(B=this,F=D):(B=D,F=this);for(var V=0,G=0;G<F.length;G++)R=(B.words[G]|0)+(F.words[G]|0)+V,this.words[G]=R&67108863,V=R>>>26;for(;V!==0&&G<B.length;G++)R=(B.words[G]|0)+V,this.words[G]=R&67108863,V=R>>>26;if(this.length=B.length,V!==0)this.words[this.length]=V,this.length++;else if(B!==this)for(;G<B.length;G++)this.words[G]=B.words[G];return this},t.prototype.add=function(D){var R;return D.negative!==0&&this.negative===0?(D.negative=0,R=this.sub(D),D.negative^=1,R):D.negative===0&&this.negative!==0?(this.negative=0,R=D.sub(this),this.negative=1,R):this.length>D.length?this.clone().iadd(D):D.clone().iadd(this)},t.prototype.isub=function(D){if(D.negative!==0){D.negative=0;var R=this.iadd(D);return D.negative=1,R._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(D),this.negative=1,this._normSign();var B=this.cmp(D);if(B===0)return this.negative=0,this.length=1,this.words[0]=0,this;var F,V;B>0?(F=this,V=D):(F=D,V=this);for(var G=0,J=0;J<V.length;J++)R=(F.words[J]|0)-(V.words[J]|0)+G,G=R>>26,this.words[J]=R&67108863;for(;G!==0&&J<F.length;J++)R=(F.words[J]|0)+G,G=R>>26,this.words[J]=R&67108863;if(G===0&&J<F.length&&F!==this)for(;J<F.length;J++)this.words[J]=F.words[J];return this.length=Math.max(this.length,J),F!==this&&(this.negative=1),this.strip()},t.prototype.sub=function(D){return this.clone().isub(D)};function u(I,D,R){R.negative=D.negative^I.negative;var B=I.length+D.length|0;R.length=B,B=B-1|0;var F=I.words[0]|0,V=D.words[0]|0,G=F*V,J=G&67108863,j=G/67108864|0;R.words[0]=J;for(var Y=1;Y<B;Y++){for(var X=j>>>26,oe=j&67108863,se=Math.min(Y,D.length-1),ie=Math.max(0,Y-I.length+1);ie<=se;ie++){var N=Y-ie|0;F=I.words[N]|0,V=D.words[ie]|0,G=F*V+oe,X+=G/67108864|0,oe=G&67108863}R.words[Y]=oe|0,j=X|0}return j!==0?R.words[Y]=j|0:R.length--,R.strip()}var _=function(D,R,B){var F=D.words,V=R.words,G=B.words,J=0,j,Y,X,oe=F[0]|0,se=oe&8191,ie=oe>>>13,N=F[1]|0,U=N&8191,q=N>>>13,Q=F[2]|0,W=Q&8191,Z=Q>>>13,ee=F[3]|0,te=ee&8191,ae=ee>>>13,le=F[4]|0,ye=le&8191,fe=le>>>13,pe=F[5]|0,ge=pe&8191,Ae=pe>>>13,we=F[6]|0,De=we&8191,Be=we>>>13,Ve=F[7]|0,xe=Ve&8191,Le=Ve>>>13,He=F[8]|0,Je=He&8191,Oe=He>>>13,Pe=F[9]|0,Ue=Pe&8191,vt=Pe>>>13,Lt=V[0]|0,Yt=Lt&8191,At=Lt>>>13,Rt=V[1]|0,Bt=Rt&8191,Mt=Rt>>>13,Tt=V[2]|0,at=Tt&8191,ct=Tt>>>13,je=V[3]|0,ke=je&8191,Ye=je>>>13,Ke=V[4]|0,st=Ke&8191,Et=Ke>>>13,bt=V[5]|0,zt=bt&8191,$t=bt>>>13,Ot=V[6]|0,Qt=Ot&8191,tr=Ot>>>13,qt=V[7]|0,lr=qt&8191,Wr=qt>>>13,cn=V[8]|0,Jr=cn&8191,ot=cn>>>13,Vt=V[9]|0,jt=Vt&8191,Ut=Vt>>>13;B.negative=D.negative^R.negative,B.length=19,j=Math.imul(se,Yt),Y=Math.imul(se,At),Y=Y+Math.imul(ie,Yt)|0,X=Math.imul(ie,At);var yr=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(yr>>>26)|0,yr&=67108863,j=Math.imul(U,Yt),Y=Math.imul(U,At),Y=Y+Math.imul(q,Yt)|0,X=Math.imul(q,At),j=j+Math.imul(se,Bt)|0,Y=Y+Math.imul(se,Mt)|0,Y=Y+Math.imul(ie,Bt)|0,X=X+Math.imul(ie,Mt)|0;var nt=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(nt>>>26)|0,nt&=67108863,j=Math.imul(W,Yt),Y=Math.imul(W,At),Y=Y+Math.imul(Z,Yt)|0,X=Math.imul(Z,At),j=j+Math.imul(U,Bt)|0,Y=Y+Math.imul(U,Mt)|0,Y=Y+Math.imul(q,Bt)|0,X=X+Math.imul(q,Mt)|0,j=j+Math.imul(se,at)|0,Y=Y+Math.imul(se,ct)|0,Y=Y+Math.imul(ie,at)|0,X=X+Math.imul(ie,ct)|0;var _e=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(_e>>>26)|0,_e&=67108863,j=Math.imul(te,Yt),Y=Math.imul(te,At),Y=Y+Math.imul(ae,Yt)|0,X=Math.imul(ae,At),j=j+Math.imul(W,Bt)|0,Y=Y+Math.imul(W,Mt)|0,Y=Y+Math.imul(Z,Bt)|0,X=X+Math.imul(Z,Mt)|0,j=j+Math.imul(U,at)|0,Y=Y+Math.imul(U,ct)|0,Y=Y+Math.imul(q,at)|0,X=X+Math.imul(q,ct)|0,j=j+Math.imul(se,ke)|0,Y=Y+Math.imul(se,Ye)|0,Y=Y+Math.imul(ie,ke)|0,X=X+Math.imul(ie,Ye)|0;var Me=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(Me>>>26)|0,Me&=67108863,j=Math.imul(ye,Yt),Y=Math.imul(ye,At),Y=Y+Math.imul(fe,Yt)|0,X=Math.imul(fe,At),j=j+Math.imul(te,Bt)|0,Y=Y+Math.imul(te,Mt)|0,Y=Y+Math.imul(ae,Bt)|0,X=X+Math.imul(ae,Mt)|0,j=j+Math.imul(W,at)|0,Y=Y+Math.imul(W,ct)|0,Y=Y+Math.imul(Z,at)|0,X=X+Math.imul(Z,ct)|0,j=j+Math.imul(U,ke)|0,Y=Y+Math.imul(U,Ye)|0,Y=Y+Math.imul(q,ke)|0,X=X+Math.imul(q,Ye)|0,j=j+Math.imul(se,st)|0,Y=Y+Math.imul(se,Et)|0,Y=Y+Math.imul(ie,st)|0,X=X+Math.imul(ie,Et)|0;var Ne=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,j=Math.imul(ge,Yt),Y=Math.imul(ge,At),Y=Y+Math.imul(Ae,Yt)|0,X=Math.imul(Ae,At),j=j+Math.imul(ye,Bt)|0,Y=Y+Math.imul(ye,Mt)|0,Y=Y+Math.imul(fe,Bt)|0,X=X+Math.imul(fe,Mt)|0,j=j+Math.imul(te,at)|0,Y=Y+Math.imul(te,ct)|0,Y=Y+Math.imul(ae,at)|0,X=X+Math.imul(ae,ct)|0,j=j+Math.imul(W,ke)|0,Y=Y+Math.imul(W,Ye)|0,Y=Y+Math.imul(Z,ke)|0,X=X+Math.imul(Z,Ye)|0,j=j+Math.imul(U,st)|0,Y=Y+Math.imul(U,Et)|0,Y=Y+Math.imul(q,st)|0,X=X+Math.imul(q,Et)|0,j=j+Math.imul(se,zt)|0,Y=Y+Math.imul(se,$t)|0,Y=Y+Math.imul(ie,zt)|0,X=X+Math.imul(ie,$t)|0;var We=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(We>>>26)|0,We&=67108863,j=Math.imul(De,Yt),Y=Math.imul(De,At),Y=Y+Math.imul(Be,Yt)|0,X=Math.imul(Be,At),j=j+Math.imul(ge,Bt)|0,Y=Y+Math.imul(ge,Mt)|0,Y=Y+Math.imul(Ae,Bt)|0,X=X+Math.imul(Ae,Mt)|0,j=j+Math.imul(ye,at)|0,Y=Y+Math.imul(ye,ct)|0,Y=Y+Math.imul(fe,at)|0,X=X+Math.imul(fe,ct)|0,j=j+Math.imul(te,ke)|0,Y=Y+Math.imul(te,Ye)|0,Y=Y+Math.imul(ae,ke)|0,X=X+Math.imul(ae,Ye)|0,j=j+Math.imul(W,st)|0,Y=Y+Math.imul(W,Et)|0,Y=Y+Math.imul(Z,st)|0,X=X+Math.imul(Z,Et)|0,j=j+Math.imul(U,zt)|0,Y=Y+Math.imul(U,$t)|0,Y=Y+Math.imul(q,zt)|0,X=X+Math.imul(q,$t)|0,j=j+Math.imul(se,Qt)|0,Y=Y+Math.imul(se,tr)|0,Y=Y+Math.imul(ie,Qt)|0,X=X+Math.imul(ie,tr)|0;var Qe=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,j=Math.imul(xe,Yt),Y=Math.imul(xe,At),Y=Y+Math.imul(Le,Yt)|0,X=Math.imul(Le,At),j=j+Math.imul(De,Bt)|0,Y=Y+Math.imul(De,Mt)|0,Y=Y+Math.imul(Be,Bt)|0,X=X+Math.imul(Be,Mt)|0,j=j+Math.imul(ge,at)|0,Y=Y+Math.imul(ge,ct)|0,Y=Y+Math.imul(Ae,at)|0,X=X+Math.imul(Ae,ct)|0,j=j+Math.imul(ye,ke)|0,Y=Y+Math.imul(ye,Ye)|0,Y=Y+Math.imul(fe,ke)|0,X=X+Math.imul(fe,Ye)|0,j=j+Math.imul(te,st)|0,Y=Y+Math.imul(te,Et)|0,Y=Y+Math.imul(ae,st)|0,X=X+Math.imul(ae,Et)|0,j=j+Math.imul(W,zt)|0,Y=Y+Math.imul(W,$t)|0,Y=Y+Math.imul(Z,zt)|0,X=X+Math.imul(Z,$t)|0,j=j+Math.imul(U,Qt)|0,Y=Y+Math.imul(U,tr)|0,Y=Y+Math.imul(q,Qt)|0,X=X+Math.imul(q,tr)|0,j=j+Math.imul(se,lr)|0,Y=Y+Math.imul(se,Wr)|0,Y=Y+Math.imul(ie,lr)|0,X=X+Math.imul(ie,Wr)|0;var rt=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(rt>>>26)|0,rt&=67108863,j=Math.imul(Je,Yt),Y=Math.imul(Je,At),Y=Y+Math.imul(Oe,Yt)|0,X=Math.imul(Oe,At),j=j+Math.imul(xe,Bt)|0,Y=Y+Math.imul(xe,Mt)|0,Y=Y+Math.imul(Le,Bt)|0,X=X+Math.imul(Le,Mt)|0,j=j+Math.imul(De,at)|0,Y=Y+Math.imul(De,ct)|0,Y=Y+Math.imul(Be,at)|0,X=X+Math.imul(Be,ct)|0,j=j+Math.imul(ge,ke)|0,Y=Y+Math.imul(ge,Ye)|0,Y=Y+Math.imul(Ae,ke)|0,X=X+Math.imul(Ae,Ye)|0,j=j+Math.imul(ye,st)|0,Y=Y+Math.imul(ye,Et)|0,Y=Y+Math.imul(fe,st)|0,X=X+Math.imul(fe,Et)|0,j=j+Math.imul(te,zt)|0,Y=Y+Math.imul(te,$t)|0,Y=Y+Math.imul(ae,zt)|0,X=X+Math.imul(ae,$t)|0,j=j+Math.imul(W,Qt)|0,Y=Y+Math.imul(W,tr)|0,Y=Y+Math.imul(Z,Qt)|0,X=X+Math.imul(Z,tr)|0,j=j+Math.imul(U,lr)|0,Y=Y+Math.imul(U,Wr)|0,Y=Y+Math.imul(q,lr)|0,X=X+Math.imul(q,Wr)|0,j=j+Math.imul(se,Jr)|0,Y=Y+Math.imul(se,ot)|0,Y=Y+Math.imul(ie,Jr)|0,X=X+Math.imul(ie,ot)|0;var $e=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+($e>>>26)|0,$e&=67108863,j=Math.imul(Ue,Yt),Y=Math.imul(Ue,At),Y=Y+Math.imul(vt,Yt)|0,X=Math.imul(vt,At),j=j+Math.imul(Je,Bt)|0,Y=Y+Math.imul(Je,Mt)|0,Y=Y+Math.imul(Oe,Bt)|0,X=X+Math.imul(Oe,Mt)|0,j=j+Math.imul(xe,at)|0,Y=Y+Math.imul(xe,ct)|0,Y=Y+Math.imul(Le,at)|0,X=X+Math.imul(Le,ct)|0,j=j+Math.imul(De,ke)|0,Y=Y+Math.imul(De,Ye)|0,Y=Y+Math.imul(Be,ke)|0,X=X+Math.imul(Be,Ye)|0,j=j+Math.imul(ge,st)|0,Y=Y+Math.imul(ge,Et)|0,Y=Y+Math.imul(Ae,st)|0,X=X+Math.imul(Ae,Et)|0,j=j+Math.imul(ye,zt)|0,Y=Y+Math.imul(ye,$t)|0,Y=Y+Math.imul(fe,zt)|0,X=X+Math.imul(fe,$t)|0,j=j+Math.imul(te,Qt)|0,Y=Y+Math.imul(te,tr)|0,Y=Y+Math.imul(ae,Qt)|0,X=X+Math.imul(ae,tr)|0,j=j+Math.imul(W,lr)|0,Y=Y+Math.imul(W,Wr)|0,Y=Y+Math.imul(Z,lr)|0,X=X+Math.imul(Z,Wr)|0,j=j+Math.imul(U,Jr)|0,Y=Y+Math.imul(U,ot)|0,Y=Y+Math.imul(q,Jr)|0,X=X+Math.imul(q,ot)|0,j=j+Math.imul(se,jt)|0,Y=Y+Math.imul(se,Ut)|0,Y=Y+Math.imul(ie,jt)|0,X=X+Math.imul(ie,Ut)|0;var ht=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(ht>>>26)|0,ht&=67108863,j=Math.imul(Ue,Bt),Y=Math.imul(Ue,Mt),Y=Y+Math.imul(vt,Bt)|0,X=Math.imul(vt,Mt),j=j+Math.imul(Je,at)|0,Y=Y+Math.imul(Je,ct)|0,Y=Y+Math.imul(Oe,at)|0,X=X+Math.imul(Oe,ct)|0,j=j+Math.imul(xe,ke)|0,Y=Y+Math.imul(xe,Ye)|0,Y=Y+Math.imul(Le,ke)|0,X=X+Math.imul(Le,Ye)|0,j=j+Math.imul(De,st)|0,Y=Y+Math.imul(De,Et)|0,Y=Y+Math.imul(Be,st)|0,X=X+Math.imul(Be,Et)|0,j=j+Math.imul(ge,zt)|0,Y=Y+Math.imul(ge,$t)|0,Y=Y+Math.imul(Ae,zt)|0,X=X+Math.imul(Ae,$t)|0,j=j+Math.imul(ye,Qt)|0,Y=Y+Math.imul(ye,tr)|0,Y=Y+Math.imul(fe,Qt)|0,X=X+Math.imul(fe,tr)|0,j=j+Math.imul(te,lr)|0,Y=Y+Math.imul(te,Wr)|0,Y=Y+Math.imul(ae,lr)|0,X=X+Math.imul(ae,Wr)|0,j=j+Math.imul(W,Jr)|0,Y=Y+Math.imul(W,ot)|0,Y=Y+Math.imul(Z,Jr)|0,X=X+Math.imul(Z,ot)|0,j=j+Math.imul(U,jt)|0,Y=Y+Math.imul(U,Ut)|0,Y=Y+Math.imul(q,jt)|0,X=X+Math.imul(q,Ut)|0;var xt=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(xt>>>26)|0,xt&=67108863,j=Math.imul(Ue,at),Y=Math.imul(Ue,ct),Y=Y+Math.imul(vt,at)|0,X=Math.imul(vt,ct),j=j+Math.imul(Je,ke)|0,Y=Y+Math.imul(Je,Ye)|0,Y=Y+Math.imul(Oe,ke)|0,X=X+Math.imul(Oe,Ye)|0,j=j+Math.imul(xe,st)|0,Y=Y+Math.imul(xe,Et)|0,Y=Y+Math.imul(Le,st)|0,X=X+Math.imul(Le,Et)|0,j=j+Math.imul(De,zt)|0,Y=Y+Math.imul(De,$t)|0,Y=Y+Math.imul(Be,zt)|0,X=X+Math.imul(Be,$t)|0,j=j+Math.imul(ge,Qt)|0,Y=Y+Math.imul(ge,tr)|0,Y=Y+Math.imul(Ae,Qt)|0,X=X+Math.imul(Ae,tr)|0,j=j+Math.imul(ye,lr)|0,Y=Y+Math.imul(ye,Wr)|0,Y=Y+Math.imul(fe,lr)|0,X=X+Math.imul(fe,Wr)|0,j=j+Math.imul(te,Jr)|0,Y=Y+Math.imul(te,ot)|0,Y=Y+Math.imul(ae,Jr)|0,X=X+Math.imul(ae,ot)|0,j=j+Math.imul(W,jt)|0,Y=Y+Math.imul(W,Ut)|0,Y=Y+Math.imul(Z,jt)|0,X=X+Math.imul(Z,Ut)|0;var kt=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(kt>>>26)|0,kt&=67108863,j=Math.imul(Ue,ke),Y=Math.imul(Ue,Ye),Y=Y+Math.imul(vt,ke)|0,X=Math.imul(vt,Ye),j=j+Math.imul(Je,st)|0,Y=Y+Math.imul(Je,Et)|0,Y=Y+Math.imul(Oe,st)|0,X=X+Math.imul(Oe,Et)|0,j=j+Math.imul(xe,zt)|0,Y=Y+Math.imul(xe,$t)|0,Y=Y+Math.imul(Le,zt)|0,X=X+Math.imul(Le,$t)|0,j=j+Math.imul(De,Qt)|0,Y=Y+Math.imul(De,tr)|0,Y=Y+Math.imul(Be,Qt)|0,X=X+Math.imul(Be,tr)|0,j=j+Math.imul(ge,lr)|0,Y=Y+Math.imul(ge,Wr)|0,Y=Y+Math.imul(Ae,lr)|0,X=X+Math.imul(Ae,Wr)|0,j=j+Math.imul(ye,Jr)|0,Y=Y+Math.imul(ye,ot)|0,Y=Y+Math.imul(fe,Jr)|0,X=X+Math.imul(fe,ot)|0,j=j+Math.imul(te,jt)|0,Y=Y+Math.imul(te,Ut)|0,Y=Y+Math.imul(ae,jt)|0,X=X+Math.imul(ae,Ut)|0;var Wt=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,j=Math.imul(Ue,st),Y=Math.imul(Ue,Et),Y=Y+Math.imul(vt,st)|0,X=Math.imul(vt,Et),j=j+Math.imul(Je,zt)|0,Y=Y+Math.imul(Je,$t)|0,Y=Y+Math.imul(Oe,zt)|0,X=X+Math.imul(Oe,$t)|0,j=j+Math.imul(xe,Qt)|0,Y=Y+Math.imul(xe,tr)|0,Y=Y+Math.imul(Le,Qt)|0,X=X+Math.imul(Le,tr)|0,j=j+Math.imul(De,lr)|0,Y=Y+Math.imul(De,Wr)|0,Y=Y+Math.imul(Be,lr)|0,X=X+Math.imul(Be,Wr)|0,j=j+Math.imul(ge,Jr)|0,Y=Y+Math.imul(ge,ot)|0,Y=Y+Math.imul(Ae,Jr)|0,X=X+Math.imul(Ae,ot)|0,j=j+Math.imul(ye,jt)|0,Y=Y+Math.imul(ye,Ut)|0,Y=Y+Math.imul(fe,jt)|0,X=X+Math.imul(fe,Ut)|0;var Ft=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,j=Math.imul(Ue,zt),Y=Math.imul(Ue,$t),Y=Y+Math.imul(vt,zt)|0,X=Math.imul(vt,$t),j=j+Math.imul(Je,Qt)|0,Y=Y+Math.imul(Je,tr)|0,Y=Y+Math.imul(Oe,Qt)|0,X=X+Math.imul(Oe,tr)|0,j=j+Math.imul(xe,lr)|0,Y=Y+Math.imul(xe,Wr)|0,Y=Y+Math.imul(Le,lr)|0,X=X+Math.imul(Le,Wr)|0,j=j+Math.imul(De,Jr)|0,Y=Y+Math.imul(De,ot)|0,Y=Y+Math.imul(Be,Jr)|0,X=X+Math.imul(Be,ot)|0,j=j+Math.imul(ge,jt)|0,Y=Y+Math.imul(ge,Ut)|0,Y=Y+Math.imul(Ae,jt)|0,X=X+Math.imul(Ae,Ut)|0;var ir=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(ir>>>26)|0,ir&=67108863,j=Math.imul(Ue,Qt),Y=Math.imul(Ue,tr),Y=Y+Math.imul(vt,Qt)|0,X=Math.imul(vt,tr),j=j+Math.imul(Je,lr)|0,Y=Y+Math.imul(Je,Wr)|0,Y=Y+Math.imul(Oe,lr)|0,X=X+Math.imul(Oe,Wr)|0,j=j+Math.imul(xe,Jr)|0,Y=Y+Math.imul(xe,ot)|0,Y=Y+Math.imul(Le,Jr)|0,X=X+Math.imul(Le,ot)|0,j=j+Math.imul(De,jt)|0,Y=Y+Math.imul(De,Ut)|0,Y=Y+Math.imul(Be,jt)|0,X=X+Math.imul(Be,Ut)|0;var hr=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(hr>>>26)|0,hr&=67108863,j=Math.imul(Ue,lr),Y=Math.imul(Ue,Wr),Y=Y+Math.imul(vt,lr)|0,X=Math.imul(vt,Wr),j=j+Math.imul(Je,Jr)|0,Y=Y+Math.imul(Je,ot)|0,Y=Y+Math.imul(Oe,Jr)|0,X=X+Math.imul(Oe,ot)|0,j=j+Math.imul(xe,jt)|0,Y=Y+Math.imul(xe,Ut)|0,Y=Y+Math.imul(Le,jt)|0,X=X+Math.imul(Le,Ut)|0;var _r=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(_r>>>26)|0,_r&=67108863,j=Math.imul(Ue,Jr),Y=Math.imul(Ue,ot),Y=Y+Math.imul(vt,Jr)|0,X=Math.imul(vt,ot),j=j+Math.imul(Je,jt)|0,Y=Y+Math.imul(Je,Ut)|0,Y=Y+Math.imul(Oe,jt)|0,X=X+Math.imul(Oe,Ut)|0;var an=(J+j|0)+((Y&8191)<<13)|0;J=(X+(Y>>>13)|0)+(an>>>26)|0,an&=67108863,j=Math.imul(Ue,jt),Y=Math.imul(Ue,Ut),Y=Y+Math.imul(vt,jt)|0,X=Math.imul(vt,Ut);var Rr=(J+j|0)+((Y&8191)<<13)|0;return J=(X+(Y>>>13)|0)+(Rr>>>26)|0,Rr&=67108863,G[0]=yr,G[1]=nt,G[2]=_e,G[3]=Me,G[4]=Ne,G[5]=We,G[6]=Qe,G[7]=rt,G[8]=$e,G[9]=ht,G[10]=xt,G[11]=kt,G[12]=Wt,G[13]=Ft,G[14]=ir,G[15]=hr,G[16]=_r,G[17]=an,G[18]=Rr,J!==0&&(G[19]=J,B.length++),B};Math.imul||(_=u);function s(I,D,R){R.negative=D.negative^I.negative,R.length=I.length+D.length;for(var B=0,F=0,V=0;V<R.length-1;V++){var G=F;F=0;for(var J=B&67108863,j=Math.min(V,D.length-1),Y=Math.max(0,V-I.length+1);Y<=j;Y++){var X=V-Y,oe=I.words[X]|0,se=D.words[Y]|0,ie=oe*se,N=ie&67108863;G=G+(ie/67108864|0)|0,N=N+J|0,J=N&67108863,G=G+(N>>>26)|0,F+=G>>>26,G&=67108863}R.words[V]=J,B=G,G=F}return B!==0?R.words[V]=B:R.length--,R.strip()}function A(I,D,R){var B=new x;return B.mulp(I,D,R)}t.prototype.mulTo=function(D,R){var B,F=this.length+D.length;return this.length===10&&D.length===10?B=_(this,D,R):F<63?B=u(this,D,R):F<1024?B=s(this,D,R):B=A(this,D,R),B};function x(I,D){this.x=I,this.y=D}x.prototype.makeRBT=function(D){for(var R=new Array(D),B=t.prototype._countBits(D)-1,F=0;F<D;F++)R[F]=this.revBin(F,B,D);return R},x.prototype.revBin=function(D,R,B){if(D===0||D===B-1)return D;for(var F=0,V=0;V<R;V++)F|=(D&1)<<R-V-1,D>>=1;return F},x.prototype.permute=function(D,R,B,F,V,G){for(var J=0;J<G;J++)F[J]=R[D[J]],V[J]=B[D[J]]},x.prototype.transform=function(D,R,B,F,V,G){this.permute(G,D,R,B,F,V);for(var J=1;J<V;J<<=1)for(var j=J<<1,Y=Math.cos(2*Math.PI/j),X=Math.sin(2*Math.PI/j),oe=0;oe<V;oe+=j)for(var se=Y,ie=X,N=0;N<J;N++){var U=B[oe+N],q=F[oe+N],Q=B[oe+N+J],W=F[oe+N+J],Z=se*Q-ie*W;W=se*W+ie*Q,Q=Z,B[oe+N]=U+Q,F[oe+N]=q+W,B[oe+N+J]=U-Q,F[oe+N+J]=q-W,N!==j&&(Z=Y*se-X*ie,ie=Y*ie+X*se,se=Z)}},x.prototype.guessLen13b=function(D,R){var B=Math.max(R,D)|1,F=B&1,V=0;for(B=B/2|0;B;B=B>>>1)V++;return 1<<V+1+F},x.prototype.conjugate=function(D,R,B){if(!(B<=1))for(var F=0;F<B/2;F++){var V=D[F];D[F]=D[B-F-1],D[B-F-1]=V,V=R[F],R[F]=-R[B-F-1],R[B-F-1]=-V}},x.prototype.normalize13b=function(D,R){for(var B=0,F=0;F<R/2;F++){var V=Math.round(D[2*F+1]/R)*8192+Math.round(D[2*F]/R)+B;D[F]=V&67108863,V<67108864?B=0:B=V/67108864|0}return D},x.prototype.convert13b=function(D,R,B,F){for(var V=0,G=0;G<R;G++)V=V+(D[G]|0),B[2*G]=V&8191,V=V>>>13,B[2*G+1]=V&8191,V=V>>>13;for(G=2*R;G<F;++G)B[G]=0;n(V===0),n((V&-8192)===0)},x.prototype.stub=function(D){for(var R=new Array(D),B=0;B<D;B++)R[B]=0;return R},x.prototype.mulp=function(D,R,B){var F=2*this.guessLen13b(D.length,R.length),V=this.makeRBT(F),G=this.stub(F),J=new Array(F),j=new Array(F),Y=new Array(F),X=new Array(F),oe=new Array(F),se=new Array(F),ie=B.words;ie.length=F,this.convert13b(D.words,D.length,J,F),this.convert13b(R.words,R.length,X,F),this.transform(J,G,j,Y,F,V),this.transform(X,G,oe,se,F,V);for(var N=0;N<F;N++){var U=j[N]*oe[N]-Y[N]*se[N];Y[N]=j[N]*se[N]+Y[N]*oe[N],j[N]=U}return this.conjugate(j,Y,F),this.transform(j,Y,ie,G,F,V),this.conjugate(ie,G,F),this.normalize13b(ie,F),B.negative=D.negative^R.negative,B.length=D.length+R.length,B.strip()},t.prototype.mul=function(D){var R=new t(null);return R.words=new Array(this.length+D.length),this.mulTo(D,R)},t.prototype.mulf=function(D){var R=new t(null);return R.words=new Array(this.length+D.length),A(this,D,R)},t.prototype.imul=function(D){return this.clone().mulTo(D,this)},t.prototype.imuln=function(D){n(typeof D=="number"),n(D<67108864);for(var R=0,B=0;B<this.length;B++){var F=(this.words[B]|0)*D,V=(F&67108863)+(R&67108863);R>>=26,R+=F/67108864|0,R+=V>>>26,this.words[B]=V&67108863}return R!==0&&(this.words[B]=R,this.length++),this},t.prototype.muln=function(D){return this.clone().imuln(D)},t.prototype.sqr=function(){return this.mul(this)},t.prototype.isqr=function(){return this.imul(this.clone())},t.prototype.pow=function(D){var R=m(D);if(R.length===0)return new t(1);for(var B=this,F=0;F<R.length&&R[F]===0;F++,B=B.sqr());if(++F<R.length)for(var V=B.sqr();F<R.length;F++,V=V.sqr())R[F]!==0&&(B=B.mul(V));return B},t.prototype.iushln=function(D){n(typeof D=="number"&&D>=0);var R=D%26,B=(D-R)/26,F=67108863>>>26-R<<26-R,V;if(R!==0){var G=0;for(V=0;V<this.length;V++){var J=this.words[V]&F,j=(this.words[V]|0)-J<<R;this.words[V]=j|G,G=J>>>26-R}G&&(this.words[V]=G,this.length++)}if(B!==0){for(V=this.length-1;V>=0;V--)this.words[V+B]=this.words[V];for(V=0;V<B;V++)this.words[V]=0;this.length+=B}return this.strip()},t.prototype.ishln=function(D){return n(this.negative===0),this.iushln(D)},t.prototype.iushrn=function(D,R,B){n(typeof D=="number"&&D>=0);var F;R?F=(R-R%26)/26:F=0;var V=D%26,G=Math.min((D-V)/26,this.length),J=67108863^67108863>>>V<<V,j=B;if(F-=G,F=Math.max(0,F),j){for(var Y=0;Y<G;Y++)j.words[Y]=this.words[Y];j.length=G}if(G!==0)if(this.length>G)for(this.length-=G,Y=0;Y<this.length;Y++)this.words[Y]=this.words[Y+G];else this.words[0]=0,this.length=1;var X=0;for(Y=this.length-1;Y>=0&&(X!==0||Y>=F);Y--){var oe=this.words[Y]|0;this.words[Y]=X<<26-V|oe>>>V,X=oe&J}return j&&X!==0&&(j.words[j.length++]=X),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},t.prototype.ishrn=function(D,R,B){return n(this.negative===0),this.iushrn(D,R,B)},t.prototype.shln=function(D){return this.clone().ishln(D)},t.prototype.ushln=function(D){return this.clone().iushln(D)},t.prototype.shrn=function(D){return this.clone().ishrn(D)},t.prototype.ushrn=function(D){return this.clone().iushrn(D)},t.prototype.testn=function(D){n(typeof D=="number"&&D>=0);var R=D%26,B=(D-R)/26,F=1<<R;if(this.length<=B)return!1;var V=this.words[B];return!!(V&F)},t.prototype.imaskn=function(D){n(typeof D=="number"&&D>=0);var R=D%26,B=(D-R)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=B)return this;if(R!==0&&B++,this.length=Math.min(B,this.length),R!==0){var F=67108863^67108863>>>R<<R;this.words[this.length-1]&=F}return this.strip()},t.prototype.maskn=function(D){return this.clone().imaskn(D)},t.prototype.iaddn=function(D){return n(typeof D=="number"),n(D<67108864),D<0?this.isubn(-D):this.negative!==0?this.length===1&&(this.words[0]|0)<D?(this.words[0]=D-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(D),this.negative=1,this):this._iaddn(D)},t.prototype._iaddn=function(D){this.words[0]+=D;for(var R=0;R<this.length&&this.words[R]>=67108864;R++)this.words[R]-=67108864,R===this.length-1?this.words[R+1]=1:this.words[R+1]++;return this.length=Math.max(this.length,R+1),this},t.prototype.isubn=function(D){if(n(typeof D=="number"),n(D<67108864),D<0)return this.iaddn(-D);if(this.negative!==0)return this.negative=0,this.iaddn(D),this.negative=1,this;if(this.words[0]-=D,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var R=0;R<this.length&&this.words[R]<0;R++)this.words[R]+=67108864,this.words[R+1]-=1;return this.strip()},t.prototype.addn=function(D){return this.clone().iaddn(D)},t.prototype.subn=function(D){return this.clone().isubn(D)},t.prototype.iabs=function(){return this.negative=0,this},t.prototype.abs=function(){return this.clone().iabs()},t.prototype._ishlnsubmul=function(D,R,B){var F=D.length+B,V;this._expand(F);var G,J=0;for(V=0;V<D.length;V++){G=(this.words[V+B]|0)+J;var j=(D.words[V]|0)*R;G-=j&67108863,J=(G>>26)-(j/67108864|0),this.words[V+B]=G&67108863}for(;V<this.length-B;V++)G=(this.words[V+B]|0)+J,J=G>>26,this.words[V+B]=G&67108863;if(J===0)return this.strip();for(n(J===-1),J=0,V=0;V<this.length;V++)G=-(this.words[V]|0)+J,J=G>>26,this.words[V]=G&67108863;return this.negative=1,this.strip()},t.prototype._wordDiv=function(D,R){var B=this.length-D.length,F=this.clone(),V=D,G=V.words[V.length-1]|0,J=this._countBits(G);B=26-J,B!==0&&(V=V.ushln(B),F.iushln(B),G=V.words[V.length-1]|0);var j=F.length-V.length,Y;if(R!=="mod"){Y=new t(null),Y.length=j+1,Y.words=new Array(Y.length);for(var X=0;X<Y.length;X++)Y.words[X]=0}var oe=F.clone()._ishlnsubmul(V,1,j);oe.negative===0&&(F=oe,Y&&(Y.words[j]=1));for(var se=j-1;se>=0;se--){var ie=(F.words[V.length+se]|0)*67108864+(F.words[V.length+se-1]|0);for(ie=Math.min(ie/G|0,67108863),F._ishlnsubmul(V,ie,se);F.negative!==0;)ie--,F.negative=0,F._ishlnsubmul(V,1,se),F.isZero()||(F.negative^=1);Y&&(Y.words[se]=ie)}return Y&&Y.strip(),F.strip(),R!=="div"&&B!==0&&F.iushrn(B),{div:Y||null,mod:F}},t.prototype.divmod=function(D,R,B){if(n(!D.isZero()),this.isZero())return{div:new t(0),mod:new t(0)};var F,V,G;return this.negative!==0&&D.negative===0?(G=this.neg().divmod(D,R),R!=="mod"&&(F=G.div.neg()),R!=="div"&&(V=G.mod.neg(),B&&V.negative!==0&&V.iadd(D)),{div:F,mod:V}):this.negative===0&&D.negative!==0?(G=this.divmod(D.neg(),R),R!=="mod"&&(F=G.div.neg()),{div:F,mod:G.mod}):(this.negative&D.negative)!==0?(G=this.neg().divmod(D.neg(),R),R!=="div"&&(V=G.mod.neg(),B&&V.negative!==0&&V.isub(D)),{div:G.div,mod:V}):D.length>this.length||this.cmp(D)<0?{div:new t(0),mod:this}:D.length===1?R==="div"?{div:this.divn(D.words[0]),mod:null}:R==="mod"?{div:null,mod:new t(this.modn(D.words[0]))}:{div:this.divn(D.words[0]),mod:new t(this.modn(D.words[0]))}:this._wordDiv(D,R)},t.prototype.div=function(D){return this.divmod(D,"div",!1).div},t.prototype.mod=function(D){return this.divmod(D,"mod",!1).mod},t.prototype.umod=function(D){return this.divmod(D,"mod",!0).mod},t.prototype.divRound=function(D){var R=this.divmod(D);if(R.mod.isZero())return R.div;var B=R.div.negative!==0?R.mod.isub(D):R.mod,F=D.ushrn(1),V=D.andln(1),G=B.cmp(F);return G<0||V===1&&G===0?R.div:R.div.negative!==0?R.div.isubn(1):R.div.iaddn(1)},t.prototype.modn=function(D){n(D<=67108863);for(var R=(1<<26)%D,B=0,F=this.length-1;F>=0;F--)B=(R*B+(this.words[F]|0))%D;return B},t.prototype.idivn=function(D){n(D<=67108863);for(var R=0,B=this.length-1;B>=0;B--){var F=(this.words[B]|0)+R*67108864;this.words[B]=F/D|0,R=F%D}return this.strip()},t.prototype.divn=function(D){return this.clone().idivn(D)},t.prototype.egcd=function(D){n(D.negative===0),n(!D.isZero());var R=this,B=D.clone();R.negative!==0?R=R.umod(D):R=R.clone();for(var F=new t(1),V=new t(0),G=new t(0),J=new t(1),j=0;R.isEven()&&B.isEven();)R.iushrn(1),B.iushrn(1),++j;for(var Y=B.clone(),X=R.clone();!R.isZero();){for(var oe=0,se=1;(R.words[0]&se)===0&&oe<26;++oe,se<<=1);if(oe>0)for(R.iushrn(oe);oe-- >0;)(F.isOdd()||V.isOdd())&&(F.iadd(Y),V.isub(X)),F.iushrn(1),V.iushrn(1);for(var ie=0,N=1;(B.words[0]&N)===0&&ie<26;++ie,N<<=1);if(ie>0)for(B.iushrn(ie);ie-- >0;)(G.isOdd()||J.isOdd())&&(G.iadd(Y),J.isub(X)),G.iushrn(1),J.iushrn(1);R.cmp(B)>=0?(R.isub(B),F.isub(G),V.isub(J)):(B.isub(R),G.isub(F),J.isub(V))}return{a:G,b:J,gcd:B.iushln(j)}},t.prototype._invmp=function(D){n(D.negative===0),n(!D.isZero());var R=this,B=D.clone();R.negative!==0?R=R.umod(D):R=R.clone();for(var F=new t(1),V=new t(0),G=B.clone();R.cmpn(1)>0&&B.cmpn(1)>0;){for(var J=0,j=1;(R.words[0]&j)===0&&J<26;++J,j<<=1);if(J>0)for(R.iushrn(J);J-- >0;)F.isOdd()&&F.iadd(G),F.iushrn(1);for(var Y=0,X=1;(B.words[0]&X)===0&&Y<26;++Y,X<<=1);if(Y>0)for(B.iushrn(Y);Y-- >0;)V.isOdd()&&V.iadd(G),V.iushrn(1);R.cmp(B)>=0?(R.isub(B),F.isub(V)):(B.isub(R),V.isub(F))}var oe;return R.cmpn(1)===0?oe=F:oe=V,oe.cmpn(0)<0&&oe.iadd(D),oe},t.prototype.gcd=function(D){if(this.isZero())return D.abs();if(D.isZero())return this.abs();var R=this.clone(),B=D.clone();R.negative=0,B.negative=0;for(var F=0;R.isEven()&&B.isEven();F++)R.iushrn(1),B.iushrn(1);do{for(;R.isEven();)R.iushrn(1);for(;B.isEven();)B.iushrn(1);var V=R.cmp(B);if(V<0){var G=R;R=B,B=G}else if(V===0||B.cmpn(1)===0)break;R.isub(B)}while(!0);return B.iushln(F)},t.prototype.invm=function(D){return this.egcd(D).a.umod(D)},t.prototype.isEven=function(){return(this.words[0]&1)===0},t.prototype.isOdd=function(){return(this.words[0]&1)===1},t.prototype.andln=function(D){return this.words[0]&D},t.prototype.bincn=function(D){n(typeof D=="number");var R=D%26,B=(D-R)/26,F=1<<R;if(this.length<=B)return this._expand(B+1),this.words[B]|=F,this;for(var V=F,G=B;V!==0&&G<this.length;G++){var J=this.words[G]|0;J+=V,V=J>>>26,J&=67108863,this.words[G]=J}return V!==0&&(this.words[G]=V,this.length++),this},t.prototype.isZero=function(){return this.length===1&&this.words[0]===0},t.prototype.cmpn=function(D){var R=D<0;if(this.negative!==0&&!R)return-1;if(this.negative===0&&R)return 1;this.strip();var B;if(this.length>1)B=1;else{R&&(D=-D),n(D<=67108863,"Number is too big");var F=this.words[0]|0;B=F===D?0:F<D?-1:1}return this.negative!==0?-B|0:B},t.prototype.cmp=function(D){if(this.negative!==0&&D.negative===0)return-1;if(this.negative===0&&D.negative!==0)return 1;var R=this.ucmp(D);return this.negative!==0?-R|0:R},t.prototype.ucmp=function(D){if(this.length>D.length)return 1;if(this.length<D.length)return-1;for(var R=0,B=this.length-1;B>=0;B--){var F=this.words[B]|0,V=D.words[B]|0;if(F!==V){F<V?R=-1:F>V&&(R=1);break}}return R},t.prototype.gtn=function(D){return this.cmpn(D)===1},t.prototype.gt=function(D){return this.cmp(D)===1},t.prototype.gten=function(D){return this.cmpn(D)>=0},t.prototype.gte=function(D){return this.cmp(D)>=0},t.prototype.ltn=function(D){return this.cmpn(D)===-1},t.prototype.lt=function(D){return this.cmp(D)===-1},t.prototype.lten=function(D){return this.cmpn(D)<=0},t.prototype.lte=function(D){return this.cmp(D)<=0},t.prototype.eqn=function(D){return this.cmpn(D)===0},t.prototype.eq=function(D){return this.cmp(D)===0},t.red=function(D){return new P(D)},t.prototype.toRed=function(D){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),D.convertTo(this)._forceRed(D)},t.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},t.prototype._forceRed=function(D){return this.red=D,this},t.prototype.forceRed=function(D){return n(!this.red,"Already a number in reduction context"),this._forceRed(D)},t.prototype.redAdd=function(D){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,D)},t.prototype.redIAdd=function(D){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,D)},t.prototype.redSub=function(D){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,D)},t.prototype.redISub=function(D){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,D)},t.prototype.redShl=function(D){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,D)},t.prototype.redMul=function(D){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.mul(this,D)},t.prototype.redIMul=function(D){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.imul(this,D)},t.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},t.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},t.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},t.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},t.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},t.prototype.redPow=function(D){return n(this.red&&!D.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,D)};var v={k256:null,p224:null,p192:null,p25519:null};function b(I,D){this.name=I,this.p=new t(D,16),this.n=this.p.bitLength(),this.k=new t(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}b.prototype._tmp=function(){var D=new t(null);return D.words=new Array(Math.ceil(this.n/13)),D},b.prototype.ireduce=function(D){var R=D,B;do this.split(R,this.tmp),R=this.imulK(R),R=R.iadd(this.tmp),B=R.bitLength();while(B>this.n);var F=B<this.n?-1:R.ucmp(this.p);return F===0?(R.words[0]=0,R.length=1):F>0?R.isub(this.p):R.strip!==void 0?R.strip():R._strip(),R},b.prototype.split=function(D,R){D.iushrn(this.n,0,R)},b.prototype.imulK=function(D){return D.imul(this.k)};function l(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}r(l,b),l.prototype.split=function(D,R){for(var B=4194303,F=Math.min(D.length,9),V=0;V<F;V++)R.words[V]=D.words[V];if(R.length=F,D.length<=9){D.words[0]=0,D.length=1;return}var G=D.words[9];for(R.words[R.length++]=G&B,V=10;V<D.length;V++){var J=D.words[V]|0;D.words[V-10]=(J&B)<<4|G>>>22,G=J}G>>>=22,D.words[V-10]=G,G===0&&D.length>10?D.length-=10:D.length-=9},l.prototype.imulK=function(D){D.words[D.length]=0,D.words[D.length+1]=0,D.length+=2;for(var R=0,B=0;B<D.length;B++){var F=D.words[B]|0;R+=F*977,D.words[B]=R&67108863,R=F*64+(R/67108864|0)}return D.words[D.length-1]===0&&(D.length--,D.words[D.length-1]===0&&D.length--),D};function L(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}r(L,b);function S(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}r(S,b);function k(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}r(k,b),k.prototype.imulK=function(D){for(var R=0,B=0;B<D.length;B++){var F=(D.words[B]|0)*19+R,V=F&67108863;F>>>=26,D.words[B]=V,R=F}return R!==0&&(D.words[D.length++]=R),D},t._prime=function(D){if(v[D])return v[D];var R;if(D==="k256")R=new l;else if(D==="p224")R=new L;else if(D==="p192")R=new S;else if(D==="p25519")R=new k;else throw new Error("Unknown prime "+D);return v[D]=R,R};function P(I){if(typeof I=="string"){var D=t._prime(I);this.m=D.p,this.prime=D}else n(I.gtn(1),"modulus must be greater than 1"),this.m=I,this.prime=null}P.prototype._verify1=function(D){n(D.negative===0,"red works only with positives"),n(D.red,"red works only with red numbers")},P.prototype._verify2=function(D,R){n((D.negative|R.negative)===0,"red works only with positives"),n(D.red&&D.red===R.red,"red works only with red numbers")},P.prototype.imod=function(D){return this.prime?this.prime.ireduce(D)._forceRed(this):D.umod(this.m)._forceRed(this)},P.prototype.neg=function(D){return D.isZero()?D.clone():this.m.sub(D)._forceRed(this)},P.prototype.add=function(D,R){this._verify2(D,R);var B=D.add(R);return B.cmp(this.m)>=0&&B.isub(this.m),B._forceRed(this)},P.prototype.iadd=function(D,R){this._verify2(D,R);var B=D.iadd(R);return B.cmp(this.m)>=0&&B.isub(this.m),B},P.prototype.sub=function(D,R){this._verify2(D,R);var B=D.sub(R);return B.cmpn(0)<0&&B.iadd(this.m),B._forceRed(this)},P.prototype.isub=function(D,R){this._verify2(D,R);var B=D.isub(R);return B.cmpn(0)<0&&B.iadd(this.m),B},P.prototype.shl=function(D,R){return this._verify1(D),this.imod(D.ushln(R))},P.prototype.imul=function(D,R){return this._verify2(D,R),this.imod(D.imul(R))},P.prototype.mul=function(D,R){return this._verify2(D,R),this.imod(D.mul(R))},P.prototype.isqr=function(D){return this.imul(D,D.clone())},P.prototype.sqr=function(D){return this.mul(D,D)},P.prototype.sqrt=function(D){if(D.isZero())return D.clone();var R=this.m.andln(3);if(n(R%2===1),R===3){var B=this.m.add(new t(1)).iushrn(2);return this.pow(D,B)}for(var F=this.m.subn(1),V=0;!F.isZero()&&F.andln(1)===0;)V++,F.iushrn(1);n(!F.isZero());var G=new t(1).toRed(this),J=G.redNeg(),j=this.m.subn(1).iushrn(1),Y=this.m.bitLength();for(Y=new t(2*Y*Y).toRed(this);this.pow(Y,j).cmp(J)!==0;)Y.redIAdd(J);for(var X=this.pow(Y,F),oe=this.pow(D,F.addn(1).iushrn(1)),se=this.pow(D,F),ie=V;se.cmp(G)!==0;){for(var N=se,U=0;N.cmp(G)!==0;U++)N=N.redSqr();n(U<ie);var q=this.pow(X,new t(1).iushln(ie-U-1));oe=oe.redMul(q),X=q.redSqr(),se=se.redMul(X),ie=U}return oe},P.prototype.invm=function(D){var R=D._invmp(this.m);return R.negative!==0?(R.negative=0,this.imod(R).redNeg()):this.imod(R)},P.prototype.pow=function(D,R){if(R.isZero())return new t(1).toRed(this);if(R.cmpn(1)===0)return D.clone();var B=4,F=new Array(1<<B);F[0]=new t(1).toRed(this),F[1]=D;for(var V=2;V<F.length;V++)F[V]=this.mul(F[V-1],D);var G=F[0],J=0,j=0,Y=R.bitLength()%26;for(Y===0&&(Y=26),V=R.length-1;V>=0;V--){for(var X=R.words[V],oe=Y-1;oe>=0;oe--){var se=X>>oe&1;if(G!==F[0]&&(G=this.sqr(G)),se===0&&J===0){j=0;continue}J<<=1,J|=se,j++,!(j!==B&&(V!==0||oe!==0))&&(G=this.mul(G,F[J]),j=0,J=0)}Y=26}return G},P.prototype.convertTo=function(D){var R=D.umod(this.m);return R===D?R.clone():R},P.prototype.convertFrom=function(D){var R=D.clone();return R.red=null,R},t.mont=function(D){return new z(D)};function z(I){P.call(this,I),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new t(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}r(z,P),z.prototype.convertTo=function(D){return this.imod(D.ushln(this.shift))},z.prototype.convertFrom=function(D){var R=this.imod(D.mul(this.rinv));return R.red=null,R},z.prototype.imul=function(D,R){if(D.isZero()||R.isZero())return D.words[0]=0,D.length=1,D;var B=D.imul(R),F=B.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),V=B.isub(F).iushrn(this.shift),G=V;return V.cmp(this.m)>=0?G=V.isub(this.m):V.cmpn(0)<0&&(G=V.iadd(this.m)),G._forceRed(this)},z.prototype.mul=function(D,R){if(D.isZero()||R.isZero())return new t(0)._forceRed(this);var B=D.mul(R),F=B.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),V=B.isub(F).iushrn(this.shift),G=V;return V.cmp(this.m)>=0?G=V.isub(this.m):V.cmpn(0)<0&&(G=V.iadd(this.m)),G._forceRed(this)},z.prototype.invm=function(D){var R=this.imod(D._invmp(this.m).mul(this.r2));return R._forceRed(this)}})(typeof M=="undefined"||M,this)},{buffer:2}],34:[function(c,M,T){M.exports=e;function e(a){var n,r,t,f=a.length,o=0;for(n=0;n<f;++n)o+=a[n].length;var i=new Array(o),g=0;for(n=0;n<f;++n){var p=a[n],y=p.length;for(r=0;r<y;++r){var h=i[g++]=new Array(y-1),m=0;for(t=0;t<y;++t)t!==r&&(h[m++]=p[t]);if(r&1){var u=h[1];h[1]=h[0],h[0]=u}}}return i}},{}],35:[function(c,M,T){M.exports=y;var e=c("typedarray-pool"),a=c("./lib/sweep"),n=c("./lib/intersect");function r(h,m){for(var u=0;u<h;++u)if(!(m[u]<=m[u+h]))return!0;return!1}function t(h,m,u,_){for(var s=0,A=0,x=0,v=h.length;x<v;++x){var b=h[x];if(!r(m,b)){for(var l=0;l<2*m;++l)u[s++]=b[l];_[A++]=x}}return A}function f(h,m,u,_){var s=h.length,A=m.length;if(!(s<=0||A<=0)){var x=h[0].length>>>1;if(!(x<=0)){var v,b=e.mallocDouble(2*x*s),l=e.mallocInt32(s);if(s=t(h,x,b,l),s>0){if(x===1&&_)a.init(s),v=a.sweepComplete(x,u,0,s,b,l,0,s,b,l);else{var L=e.mallocDouble(2*x*A),S=e.mallocInt32(A);A=t(m,x,L,S),A>0&&(a.init(s+A),x===1?v=a.sweepBipartite(x,u,0,s,b,l,0,A,L,S):v=n(x,u,_,s,b,l,A,L,S),e.free(L),e.free(S))}e.free(b),e.free(l)}return v}}}var o;function i(h,m){o.push([h,m])}function g(h){return o=[],f(h,h,i,!0),o}function p(h,m){return o=[],f(h,m,i,!1),o}function y(h,m,u){switch(arguments.length){case 1:return g(h);case 2:return typeof m=="function"?f(h,h,m,!0):p(h,m);case 3:return f(h,m,u,!1);default:throw new Error("box-intersect: Invalid arguments")}}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(c,M,T){function e(){function r(o,i,g,p,y,h,m,u,_,s,A){for(var x=2*o,v=p,b=x*p;v<y;++v,b+=x){var l=h[i+b],L=h[i+b+o],S=m[v];e:for(var k=u,P=x*u;k<_;++k,P+=x){var z=s[i+P],I=s[i+P+o],D=A[k];if(!(I<l||L<z)){for(var R=i+1;R<o;++R){var B=h[R+b],F=h[R+o+b],V=s[R+P],G=s[R+o+P];if(F<V||G<B)continue e}var J=g(S,D);if(J!==void 0)return J}}}}function t(o,i,g,p,y,h,m,u,_,s,A){for(var x=2*o,v=u,b=x*u;v<_;++v,b+=x){var l=s[i+b],L=s[i+b+o],S=A[v];e:for(var k=p,P=x*p;k<y;++k,P+=x){var z=h[i+P],I=h[i+P+o],D=m[k];if(!(L<z||I<l)){for(var R=i+1;R<o;++R){var B=h[R+P],F=h[R+o+P],V=s[R+b],G=s[R+o+b];if(F<V||G<B)continue e}var J=g(D,S);if(J!==void 0)return J}}}}function f(o,i,g,p,y,h,m,u,_,s,A){return y-p>_-u?r(o,i,g,p,y,h,m,u,_,s,A):t(o,i,g,p,y,h,m,u,_,s,A)}return f}function a(){function r(g,p,y,h,m,u,_,s,A,x,v){for(var b=2*g,l=h,L=b*h;l<m;++l,L+=b){var S=u[p+L],k=u[p+L+g],P=_[l];e:for(var z=s,I=b*s;z<A;++z,I+=b){var D=x[p+I],R=v[z];if(!(D<=S||k<D)){for(var B=p+1;B<g;++B){var F=u[B+L],V=u[B+g+L],G=x[B+I],J=x[B+g+I];if(V<G||J<F)continue e}var j=y(R,P);if(j!==void 0)return j}}}}function t(g,p,y,h,m,u,_,s,A,x,v){for(var b=2*g,l=h,L=b*h;l<m;++l,L+=b){var S=u[p+L],k=u[p+L+g],P=_[l];e:for(var z=s,I=b*s;z<A;++z,I+=b){var D=x[p+I],R=v[z];if(!(D<S||k<D)){for(var B=p+1;B<g;++B){var F=u[B+L],V=u[B+g+L],G=x[B+I],J=x[B+g+I];if(V<G||J<F)continue e}var j=y(P,R);if(j!==void 0)return j}}}}function f(g,p,y,h,m,u,_,s,A,x,v){for(var b=2*g,l=s,L=b*s;l<A;++l,L+=b){var S=x[p+L],k=v[l];e:for(var P=h,z=b*h;P<m;++P,z+=b){var I=u[p+z],D=u[p+z+g],R=_[P];if(!(S<=I||D<S)){for(var B=p+1;B<g;++B){var F=u[B+z],V=u[B+g+z],G=x[B+L],J=x[B+g+L];if(V<G||J<F)continue e}var j=y(k,R);if(j!==void 0)return j}}}}function o(g,p,y,h,m,u,_,s,A,x,v){for(var b=2*g,l=s,L=b*s;l<A;++l,L+=b){var S=x[p+L],k=v[l];e:for(var P=h,z=b*h;P<m;++P,z+=b){var I=u[p+z],D=u[p+z+g],R=_[P];if(!(S<I||D<S)){for(var B=p+1;B<g;++B){var F=u[B+z],V=u[B+g+z],G=x[B+L],J=x[B+g+L];if(V<G||J<F)continue e}var j=y(R,k);if(j!==void 0)return j}}}}function i(g,p,y,h,m,u,_,s,A,x,v,b){return u-m>x-A?h?r(g,p,y,m,u,_,s,A,x,v,b):t(g,p,y,m,u,_,s,A,x,v,b):h?f(g,p,y,m,u,_,s,A,x,v,b):o(g,p,y,m,u,_,s,A,x,v,b)}return i}function n(r){return r?e():a()}T.partial=n(!1),T.full=n(!0)},{}],37:[function(c,M,T){M.exports=I;var e=c("typedarray-pool"),a=c("bit-twiddle"),n=c("./brute"),r=n.partial,t=n.full,f=c("./sweep"),o=c("./median"),i=c("./partition"),g=128,p=1<<22,y=1<<22,h=i("!(lo>=p0)&&!(p1>=hi)"),m=i("lo===p0"),u=i("lo<p0"),_=i("hi<=p0"),s=i("lo<=p0&&p0<=hi"),A=i("lo<p0&&p0<=hi"),x=6,v=2,b=1024,l=e.mallocInt32(b),L=e.mallocDouble(b);function S(D,R){var B=8*a.log2(R+1)*(D+1)|0,F=a.nextPow2(x*B);l.length<F&&(e.free(l),l=e.mallocInt32(F));var V=a.nextPow2(v*B);L.length<V&&(e.free(L),L=e.mallocDouble(V))}function k(D,R,B,F,V,G,J,j,Y){var X=x*D;l[X]=R,l[X+1]=B,l[X+2]=F,l[X+3]=V,l[X+4]=G,l[X+5]=J;var oe=v*D;L[oe]=j,L[oe+1]=Y}function P(D,R,B,F,V,G,J,j,Y,X,oe){var se=2*D,ie=Y*se,N=X[ie+R];e:for(var U=V,q=V*se;U<G;++U,q+=se){var Q=J[q+R],W=J[q+R+D];if(!(N<Q||W<N)&&!(F&&N===Q)){for(var Z=j[U],ee=R+1;ee<D;++ee){var Q=J[q+ee],W=J[q+ee+D],te=X[ie+ee],ae=X[ie+ee+D];if(W<te||ae<Q)continue e}var le;if(F?le=B(oe,Z):le=B(Z,oe),le!==void 0)return le}}}function z(D,R,B,F,V,G,J,j,Y,X){var oe=2*D,se=j*oe,ie=Y[se+R];e:for(var N=F,U=F*oe;N<V;++N,U+=oe){var q=J[N];if(q!==X){var Q=G[U+R],W=G[U+R+D];if(!(ie<Q||W<ie)){for(var Z=R+1;Z<D;++Z){var Q=G[U+Z],W=G[U+Z+D],ee=Y[se+Z],te=Y[se+Z+D];if(W<ee||te<Q)continue e}var ae=B(q,X);if(ae!==void 0)return ae}}}}function I(D,R,B,F,V,G,J,j,Y){S(D,F+J);var X=0,oe=2*D,se;for(k(X++,0,0,F,0,J,B?16:0,-1/0,1/0),B||k(X++,0,0,J,0,F,1,-1/0,1/0);X>0;){X-=1;var ie=X*x,N=l[ie],U=l[ie+1],q=l[ie+2],Q=l[ie+3],W=l[ie+4],Z=l[ie+5],ee=X*v,te=L[ee],ae=L[ee+1],le=Z&1,ye=!!(Z&16),fe=V,pe=G,ge=j,Ae=Y;if(le&&(fe=j,pe=Y,ge=V,Ae=G),!(Z&2&&(q=u(D,N,U,q,fe,pe,ae),U>=q))&&!(Z&4&&(U=_(D,N,U,q,fe,pe,te),U>=q))){var we=q-U,De=W-Q;if(ye){if(D*we*(we+De)<y){if(se=f.scanComplete(D,N,R,U,q,fe,pe,Q,W,ge,Ae),se!==void 0)return se;continue}}else if(D*Math.min(we,De)<g){if(se=r(D,N,R,le,U,q,fe,pe,Q,W,ge,Ae),se!==void 0)return se;continue}else if(D*we*De<p){if(se=f.scanBipartite(D,N,R,le,U,q,fe,pe,Q,W,ge,Ae),se!==void 0)return se;continue}var Be=h(D,N,U,q,fe,pe,te,ae);if(U<Be)if(D*(Be-U)<g){if(se=t(D,N+1,R,U,Be,fe,pe,Q,W,ge,Ae),se!==void 0)return se}else if(N===D-2){if(le?se=f.sweepBipartite(D,R,Q,W,ge,Ae,U,Be,fe,pe):se=f.sweepBipartite(D,R,U,Be,fe,pe,Q,W,ge,Ae),se!==void 0)return se}else k(X++,N+1,U,Be,Q,W,le,-1/0,1/0),k(X++,N+1,Q,W,U,Be,le^1,-1/0,1/0);if(Be<q){var Ve=o(D,N,Q,W,ge,Ae),xe=ge[oe*Ve+N],Le=m(D,N,Ve,W,ge,Ae,xe);if(Le<W&&k(X++,N,Be,q,Le,W,(le|4)+(ye?16:0),xe,ae),Q<Ve&&k(X++,N,Be,q,Q,Ve,(le|2)+(ye?16:0),te,xe),Ve+1===Le){if(ye?se=z(D,N,R,Be,q,fe,pe,Ve,ge,Ae[Ve]):se=P(D,N,R,le,Be,q,fe,pe,Ve,ge,Ae[Ve]),se!==void 0)return se}else if(Ve<Le){var He;if(ye){if(He=s(D,N,Be,q,fe,pe,xe),Be<He){var Je=m(D,N,Be,He,fe,pe,xe);if(N===D-2){if(Be<Je&&(se=f.sweepComplete(D,R,Be,Je,fe,pe,Ve,Le,ge,Ae),se!==void 0)||Je<He&&(se=f.sweepBipartite(D,R,Je,He,fe,pe,Ve,Le,ge,Ae),se!==void 0))return se}else Be<Je&&k(X++,N+1,Be,Je,Ve,Le,16,-1/0,1/0),Je<He&&(k(X++,N+1,Je,He,Ve,Le,0,-1/0,1/0),k(X++,N+1,Ve,Le,Je,He,1,-1/0,1/0))}}else le?He=A(D,N,Be,q,fe,pe,xe):He=s(D,N,Be,q,fe,pe,xe),Be<He&&(N===D-2?le?se=f.sweepBipartite(D,R,Ve,Le,ge,Ae,Be,He,fe,pe):se=f.sweepBipartite(D,R,Be,He,fe,pe,Ve,Le,ge,Ae):(k(X++,N+1,Be,He,Ve,Le,le,-1/0,1/0),k(X++,N+1,Ve,Le,Be,He,le^1,-1/0,1/0)))}}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(c,M,T){M.exports=t;var e=c("./partition"),a=e("lo<p0"),n=8;function r(f,o,i,g,p,y){for(var h=2*f,m=h*(i+1)+o,u=i+1;u<g;++u,m+=h)for(var _=p[m],s=u,A=h*(u-1);s>i&&p[A+o]>_;--s,A-=h){for(var x=A,v=A+h,b=0;b<h;++b,++x,++v){var l=p[x];p[x]=p[v],p[v]=l}var L=y[s];y[s]=y[s-1],y[s-1]=L}}function t(f,o,i,g,p,y){if(g<=i+1)return i;for(var h=i,m=g,u=g+i>>>1,_=2*f,s=u,A=p[_*u+o];h<m;){if(m-h<n){r(f,o,h,m,p,y),A=p[_*u+o];break}var x=m-h,v=Math.random()*x+h|0,b=p[_*v+o],l=Math.random()*x+h|0,L=p[_*l+o],S=Math.random()*x+h|0,k=p[_*S+o];b<=L?k>=L?(s=l,A=L):b>=k?(s=v,A=b):(s=S,A=k):L>=k?(s=l,A=L):k>=b?(s=v,A=b):(s=S,A=k);for(var I=_*(m-1),D=_*s,P=0;P<_;++P,++I,++D){var z=p[I];p[I]=p[D],p[D]=z}var R=y[m-1];y[m-1]=y[s],y[s]=R,s=a(f,o,h,m-1,p,y,A);for(var I=_*(m-1),D=_*s,P=0;P<_;++P,++I,++D){var z=p[I];p[I]=p[D],p[D]=z}var R=y[m-1];if(y[m-1]=y[s],y[s]=R,u<s){for(m=s-1;h<m&&p[_*(m-1)+o]===A;)m-=1;m+=1}else if(s<u)for(h=s+1;h<m&&p[_*h+o]===A;)h+=1;else break}return a(f,o,i,u,p,y,p[_*u+o])}},{"./partition":39}],39:[function(c,M,T){M.exports=a;var e={"lo===p0":n,"lo<p0":r,"lo<=p0":t,"hi<=p0":f,"lo<p0&&p0<=hi":i,"lo<=p0&&p0<=hi":o,"!(lo>=p0)&&!(p1>=hi)":g};function a(p){return e[p]}function n(p,y,h,m,u,_,s){for(var A=2*p,x=A*h,v=x,b=h,l=y,L=h;m>L;++L,x+=A){var S=u[x+l];if(S===s)if(b===L)b+=1,v+=A;else{for(var k=0;A>k;++k){var P=u[x+k];u[x+k]=u[v],u[v++]=P}var z=_[L];_[L]=_[b],_[b++]=z}}return b}function r(p,y,h,m,u,_,s){for(var A=2*p,x=A*h,v=x,b=h,l=y,L=h;m>L;++L,x+=A){var S=u[x+l];if(S<s)if(b===L)b+=1,v+=A;else{for(var k=0;A>k;++k){var P=u[x+k];u[x+k]=u[v],u[v++]=P}var z=_[L];_[L]=_[b],_[b++]=z}}return b}function t(p,y,h,m,u,_,s){for(var A=2*p,x=A*h,v=x,b=h,l=p+y,L=h;m>L;++L,x+=A){var S=u[x+l];if(S<=s)if(b===L)b+=1,v+=A;else{for(var k=0;A>k;++k){var P=u[x+k];u[x+k]=u[v],u[v++]=P}var z=_[L];_[L]=_[b],_[b++]=z}}return b}function f(p,y,h,m,u,_,s){for(var A=2*p,x=A*h,v=x,b=h,l=p+y,L=h;m>L;++L,x+=A){var S=u[x+l];if(S<=s)if(b===L)b+=1,v+=A;else{for(var k=0;A>k;++k){var P=u[x+k];u[x+k]=u[v],u[v++]=P}var z=_[L];_[L]=_[b],_[b++]=z}}return b}function o(p,y,h,m,u,_,s){for(var A=2*p,x=A*h,v=x,b=h,l=y,L=p+y,S=h;m>S;++S,x+=A){var k=u[x+l],P=u[x+L];if(k<=s&&s<=P)if(b===S)b+=1,v+=A;else{for(var z=0;A>z;++z){var I=u[x+z];u[x+z]=u[v],u[v++]=I}var D=_[S];_[S]=_[b],_[b++]=D}}return b}function i(p,y,h,m,u,_,s){for(var A=2*p,x=A*h,v=x,b=h,l=y,L=p+y,S=h;m>S;++S,x+=A){var k=u[x+l],P=u[x+L];if(k<s&&s<=P)if(b===S)b+=1,v+=A;else{for(var z=0;A>z;++z){var I=u[x+z];u[x+z]=u[v],u[v++]=I}var D=_[S];_[S]=_[b],_[b++]=D}}return b}function g(p,y,h,m,u,_,s,A){for(var x=2*p,v=x*h,b=v,l=h,L=y,S=p+y,k=h;m>k;++k,v+=x){var P=u[v+L],z=u[v+S];if(!(P>=s)&&!(A>=z))if(l===k)l+=1,b+=x;else{for(var I=0;x>I;++I){var D=u[v+I];u[v+I]=u[b],u[b++]=D}var R=_[k];_[k]=_[l],_[l++]=R}}return l}},{}],40:[function(c,M,T){M.exports=a;var e=32;function a(y,h){h<=4*e?n(0,h-1,y):p(0,h-1,y)}function n(y,h,m){for(var u=2*(y+1),_=y+1;_<=h;++_){for(var s=m[u++],A=m[u++],x=_,v=u-2;x-- >y;){var b=m[v-2],l=m[v-1];if(b<s)break;if(b===s&&l<A)break;m[v]=b,m[v+1]=l,v-=2}m[v]=s,m[v+1]=A}}function r(y,h,m){y*=2,h*=2;var u=m[y],_=m[y+1];m[y]=m[h],m[y+1]=m[h+1],m[h]=u,m[h+1]=_}function t(y,h,m){y*=2,h*=2,m[y]=m[h],m[y+1]=m[h+1]}function f(y,h,m,u){y*=2,h*=2,m*=2;var _=u[y],s=u[y+1];u[y]=u[h],u[y+1]=u[h+1],u[h]=u[m],u[h+1]=u[m+1],u[m]=_,u[m+1]=s}function o(y,h,m,u,_){y*=2,h*=2,_[y]=_[h],_[h]=m,_[y+1]=_[h+1],_[h+1]=u}function i(y,h,m){y*=2,h*=2;var u=m[y],_=m[h];return u<_?!1:u===_?m[y+1]>m[h+1]:!0}function g(y,h,m,u){y*=2;var _=u[y];return _<h?!0:_===h?u[y+1]<m:!1}function p(y,h,m){var u=(h-y+1)/6|0,_=y+u,s=h-u,A=y+h>>1,x=A-u,v=A+u,b=_,l=x,L=A,S=v,k=s,P=y+1,z=h-1,I=0;i(b,l,m)&&(I=b,b=l,l=I),i(S,k,m)&&(I=S,S=k,k=I),i(b,L,m)&&(I=b,b=L,L=I),i(l,L,m)&&(I=l,l=L,L=I),i(b,S,m)&&(I=b,b=S,S=I),i(L,S,m)&&(I=L,L=S,S=I),i(l,k,m)&&(I=l,l=k,k=I),i(l,L,m)&&(I=l,l=L,L=I),i(S,k,m)&&(I=S,S=k,k=I);for(var D=m[2*l],R=m[2*l+1],B=m[2*S],F=m[2*S+1],V=2*b,G=2*L,J=2*k,j=2*_,Y=2*A,X=2*s,oe=0;oe<2;++oe){var se=m[V+oe],ie=m[G+oe],N=m[J+oe];m[j+oe]=se,m[Y+oe]=ie,m[X+oe]=N}t(x,y,m),t(v,h,m);for(var U=P;U<=z;++U)if(g(U,D,R,m))U!==P&&r(U,P,m),++P;else if(!g(U,B,F,m))for(;;)if(g(z,B,F,m)){g(z,D,R,m)?(f(U,P,z,m),++P,--z):(r(U,z,m),--z);break}else{if(--z<U)break;continue}o(y,P-1,D,R,m),o(h,z+1,B,F,m),P-2-y<=e?n(y,P-2,m):p(y,P-2,m),h-(z+2)<=e?n(z+2,h,m):p(z+2,h,m),z-P<=e?n(P,z,m):p(P,z,m)}},{}],41:[function(c,M,T){M.exports={init:m,sweepBipartite:s,sweepComplete:A,scanBipartite:x,scanComplete:v};var e=c("typedarray-pool"),a=c("bit-twiddle"),n=c("./sort"),r=1<<28,t=1024,f=e.mallocInt32(t),o=e.mallocInt32(t),i=e.mallocInt32(t),g=e.mallocInt32(t),p=e.mallocInt32(t),y=e.mallocInt32(t),h=e.mallocDouble(t*8);function m(b){var l=a.nextPow2(b);f.length<l&&(e.free(f),f=e.mallocInt32(l)),o.length<l&&(e.free(o),o=e.mallocInt32(l)),i.length<l&&(e.free(i),i=e.mallocInt32(l)),g.length<l&&(e.free(g),g=e.mallocInt32(l)),p.length<l&&(e.free(p),p=e.mallocInt32(l)),y.length<l&&(e.free(y),y=e.mallocInt32(l));var L=8*l;h.length<L&&(e.free(h),h=e.mallocDouble(L))}function u(b,l,L,S){var k=l[S],P=b[L-1];b[k]=P,l[P]=k}function _(b,l,L,S){b[L]=S,l[S]=L}function s(b,l,L,S,k,P,z,I,D,R){for(var B=0,F=2*b,V=b-1,G=F-1,J=L;J<S;++J){var j=P[J],Y=F*J;h[B++]=k[Y+V],h[B++]=-(j+1),h[B++]=k[Y+G],h[B++]=j}for(var J=z;J<I;++J){var j=R[J]+r,X=F*J;h[B++]=D[X+V],h[B++]=-j,h[B++]=D[X+G],h[B++]=j}var oe=B>>>1;n(h,oe);for(var se=0,ie=0,J=0;J<oe;++J){var N=h[2*J+1]|0;if(N>=r)N=N-r|0,u(i,g,ie--,N);else if(N>=0)u(f,o,se--,N);else if(N<=-r){N=-N-r|0;for(var U=0;U<se;++U){var q=l(f[U],N);if(q!==void 0)return q}_(i,g,ie++,N)}else{N=-N-1|0;for(var U=0;U<ie;++U){var q=l(N,i[U]);if(q!==void 0)return q}_(f,o,se++,N)}}}function A(b,l,L,S,k,P,z,I,D,R){for(var B=0,F=2*b,V=b-1,G=F-1,J=L;J<S;++J){var j=P[J]+1<<1,Y=F*J;h[B++]=k[Y+V],h[B++]=-j,h[B++]=k[Y+G],h[B++]=j}for(var J=z;J<I;++J){var j=R[J]+1<<1,X=F*J;h[B++]=D[X+V],h[B++]=-j|1,h[B++]=D[X+G],h[B++]=j|1}var oe=B>>>1;n(h,oe);for(var se=0,ie=0,N=0,J=0;J<oe;++J){var U=h[2*J+1]|0,q=U&1;if(J<oe-1&&U>>1===h[2*J+3]>>1&&(q=2,J+=1),U<0){for(var Q=-(U>>1)-1,W=0;W<N;++W){var Z=l(p[W],Q);if(Z!==void 0)return Z}if(q!==0)for(var W=0;W<se;++W){var Z=l(f[W],Q);if(Z!==void 0)return Z}if(q!==1)for(var W=0;W<ie;++W){var Z=l(i[W],Q);if(Z!==void 0)return Z}q===0?_(f,o,se++,Q):q===1?_(i,g,ie++,Q):q===2&&_(p,y,N++,Q)}else{var Q=(U>>1)-1;q===0?u(f,o,se--,Q):q===1?u(i,g,ie--,Q):q===2&&u(p,y,N--,Q)}}}function x(b,l,L,S,k,P,z,I,D,R,B,F){var V=0,G=2*b,J=l,j=l+b,Y=1,X=1;S?X=r:Y=r;for(var oe=k;oe<P;++oe){var se=oe+Y,ie=G*oe;h[V++]=z[ie+J],h[V++]=-se,h[V++]=z[ie+j],h[V++]=se}for(var oe=D;oe<R;++oe){var se=oe+X,N=G*oe;h[V++]=B[N+J],h[V++]=-se}var U=V>>>1;n(h,U);for(var q=0,oe=0;oe<U;++oe){var Q=h[2*oe+1]|0;if(Q<0){var se=-Q,W=!1;if(se>=r?(W=!S,se-=r):(W=!!S,se-=1),W)_(f,o,q++,se);else{var Z=F[se],ee=G*se,te=B[ee+l+1],ae=B[ee+l+1+b];e:for(var le=0;le<q;++le){var ye=f[le],fe=G*ye;if(!(ae<z[fe+l+1]||z[fe+l+1+b]<te)){for(var pe=l+2;pe<b;++pe)if(B[ee+pe+b]<z[fe+pe]||z[fe+pe+b]<B[ee+pe])continue e;var ge=I[ye],Ae;if(S?Ae=L(Z,ge):Ae=L(ge,Z),Ae!==void 0)return Ae}}}}else u(f,o,q--,Q-Y)}}function v(b,l,L,S,k,P,z,I,D,R,B){for(var F=0,V=2*b,G=l,J=l+b,j=S;j<k;++j){var Y=j+r,X=V*j;h[F++]=P[X+G],h[F++]=-Y,h[F++]=P[X+J],h[F++]=Y}for(var j=I;j<D;++j){var Y=j+1,oe=V*j;h[F++]=R[oe+G],h[F++]=-Y}var se=F>>>1;n(h,se);for(var ie=0,j=0;j<se;++j){var N=h[2*j+1]|0;if(N<0){var Y=-N;if(Y>=r)f[ie++]=Y-r;else{Y-=1;var U=B[Y],q=V*Y,Q=R[q+l+1],W=R[q+l+1+b];e:for(var Z=0;Z<ie;++Z){var ee=f[Z],te=z[ee];if(te===U)break;var ae=V*ee;if(!(W<P[ae+l+1]||P[ae+l+1+b]<Q)){for(var le=l+2;le<b;++le)if(R[q+le+b]<P[ae+le]||P[ae+le+b]<R[q+le])continue e;var ye=L(te,U);if(ye!==void 0)return ye}}}}else{for(var Y=N-r,Z=ie-1;Z>=0;--Z)if(f[Z]===Y){for(var le=Z+1;le<ie;++le)f[le-1]=f[le];break}--ie}}}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(c,M,T){var e=c("./lib/monotone"),a=c("./lib/triangulation"),n=c("./lib/delaunay"),r=c("./lib/filter");M.exports=g;function t(p){return[Math.min(p[0],p[1]),Math.max(p[0],p[1])]}function f(p,y){return p[0]-y[0]||p[1]-y[1]}function o(p){return p.map(t).sort(f)}function i(p,y,h){return y in p?p[y]:h}function g(p,y,h){Array.isArray(y)?(h=h||{},y=y||[]):(h=y||{},y=[]);var m=!!i(h,"delaunay",!0),u=!!i(h,"interior",!0),_=!!i(h,"exterior",!0),s=!!i(h,"infinity",!1);if(!u&&!_||p.length===0)return[];var A=e(p,y);if(m||u!==_||s){for(var x=a(p.length,o(y)),v=0;v<A.length;++v){var b=A[v];x.addTriangle(b[0],b[1],b[2])}return m&&n(p,x),_?u?s?r(x,0,s):x.cells():r(x,1,s):r(x,-1)}else return A}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(c,M,T){var e=c("robust-in-sphere")[4];c("binary-search-bounds"),M.exports=n;function a(r,t,f,o,i,g){var p=t.opposite(o,i);if(!(p<0)){if(i<o){var y=o;o=i,i=y,y=g,g=p,p=y}t.isConstraint(o,i)||e(r[o],r[i],r[g],r[p])<0&&f.push(o,i)}}function n(r,t){for(var f=[],o=r.length,i=t.stars,g=0;g<o;++g)for(var p=i[g],y=1;y<p.length;y+=2){var h=p[y];if(!(h<g)&&!t.isConstraint(g,h)){for(var m=p[y-1],u=-1,_=1;_<p.length;_+=2)if(p[_-1]===h){u=p[_];break}u<0||e(r[g],r[h],r[m],r[u])<0&&f.push(g,h)}}for(;f.length>0;){for(var h=f.pop(),g=f.pop(),m=-1,u=-1,p=i[g],s=1;s<p.length;s+=2){var A=p[s-1],x=p[s];A===h?u=x:x===h&&(m=A)}m<0||u<0||e(r[g],r[h],r[m],r[u])>=0||(t.flip(g,h),a(r,t,f,m,g,u),a(r,t,f,g,u,m),a(r,t,f,u,h,m),a(r,t,f,h,m,u))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(c,M,T){var e=c("binary-search-bounds");M.exports=o;function a(i,g,p,y,h,m,u){this.cells=i,this.neighbor=g,this.flags=y,this.constraint=p,this.active=h,this.next=m,this.boundary=u}var n=a.prototype;function r(i,g){return i[0]-g[0]||i[1]-g[1]||i[2]-g[2]}n.locate=function(){var i=[0,0,0];return function(g,p,y){var h=g,m=p,u=y;return p<y?p<g&&(h=p,m=y,u=g):y<g&&(h=y,m=g,u=p),h<0?-1:(i[0]=h,i[1]=m,i[2]=u,e.eq(this.cells,i,r))}}();function t(i,g){for(var p=i.cells(),y=p.length,h=0;h<y;++h){var m=p[h],u=m[0],_=m[1],s=m[2];_<s?_<u&&(m[0]=_,m[1]=s,m[2]=u):s<u&&(m[0]=s,m[1]=u,m[2]=_)}p.sort(r);for(var A=new Array(y),h=0;h<A.length;++h)A[h]=0;var x=[],v=[],b=new Array(3*y),l=new Array(3*y),L=null;g&&(L=[]);for(var S=new a(p,b,l,A,x,v,L),h=0;h<y;++h)for(var m=p[h],k=0;k<3;++k){var u=m[k],_=m[(k+1)%3],P=b[3*h+k]=S.locate(_,u,i.opposite(_,u)),z=l[3*h+k]=i.isConstraint(u,_);P<0&&(z?v.push(h):(x.push(h),A[h]=1),g&&L.push([_,u,-1]))}return S}function f(i,g,p){for(var y=0,h=0;h<i.length;++h)g[h]===p&&(i[y++]=i[h]);return i.length=y,i}function o(i,g,p){var y=t(i,p);if(g===0)return p?y.cells.concat(y.boundary):y.cells;for(var h=1,m=y.active,u=y.next,_=y.flags,s=y.cells,A=y.constraint,x=y.neighbor;m.length>0||u.length>0;){for(;m.length>0;){var v=m.pop();if(_[v]!==-h){_[v]=h,s[v];for(var b=0;b<3;++b){var l=x[3*v+b];l>=0&&_[l]===0&&(A[3*v+b]?u.push(l):(m.push(l),_[l]=h))}}}var L=u;u=m,m=L,u.length=0,h=-h}var S=f(s,_,g);return p?S.concat(y.boundary):S}},{"binary-search-bounds":31}],45:[function(c,M,T){var e=c("binary-search-bounds"),a=c("robust-orientation")[3],n=0,r=1,t=2;M.exports=u;function f(_,s,A,x,v){this.a=_,this.b=s,this.idx=A,this.lowerIds=x,this.upperIds=v}function o(_,s,A,x){this.a=_,this.b=s,this.type=A,this.idx=x}function i(_,s){var A=_.a[0]-s.a[0]||_.a[1]-s.a[1]||_.type-s.type;return A||_.type!==n&&(A=a(_.a,_.b,s.b),A)?A:_.idx-s.idx}function g(_,s){return a(_.a,_.b,s)}function p(_,s,A,x,v){for(var b=e.lt(s,x,g),l=e.gt(s,x,g),L=b;L<l;++L){for(var S=s[L],k=S.lowerIds,z=k.length;z>1&&a(A[k[z-2]],A[k[z-1]],x)>0;)_.push([k[z-1],k[z-2],v]),z-=1;k.length=z,k.push(v);for(var P=S.upperIds,z=P.length;z>1&&a(A[P[z-2]],A[P[z-1]],x)<0;)_.push([P[z-2],P[z-1],v]),z-=1;P.length=z,P.push(v)}}function y(_,s){var A;return _.a[0]<s.a[0]?A=a(_.a,_.b,s.a):A=a(s.b,s.a,_.a),A||(s.b[0]<_.b[0]?A=a(_.a,_.b,s.b):A=a(s.b,s.a,_.b),A||_.idx-s.idx)}function h(_,s,A){var x=e.le(_,A,y),v=_[x],b=v.upperIds,l=b[b.length-1];v.upperIds=[l],_.splice(x+1,0,new f(A.a,A.b,A.idx,[l],b))}function m(_,s,A){var x=A.a;A.a=A.b,A.b=x;var v=e.eq(_,A,y),b=_[v],l=_[v-1];l.upperIds=b.upperIds,_.splice(v,1)}function u(_,s){for(var A=_.length,x=s.length,v=[],b=0;b<A;++b)v.push(new o(_[b],null,n,b));for(var b=0;b<x;++b){var l=s[b],L=_[l[0]],S=_[l[1]];L[0]<S[0]?v.push(new o(L,S,t,b),new o(S,L,r,b)):L[0]>S[0]&&v.push(new o(S,L,t,b),new o(L,S,r,b))}v.sort(i);for(var k=v[0].a[0]-(1+Math.abs(v[0].a[0]))*Math.pow(2,-52),P=[new f([k,1],[k,0],-1,[],[],[],[])],z=[],b=0,I=v.length;b<I;++b){var D=v[b],R=D.type;R===n?p(z,P,_,D.a,D.idx):R===t?h(P,_,D):m(P,_,D)}return z}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(c,M,T){var e=c("binary-search-bounds");M.exports=t;function a(f,o){this.stars=f,this.edges=o}var n=a.prototype;function r(f,o,i){for(var g=1,p=f.length;g<p;g+=2)if(f[g-1]===o&&f[g]===i){f[g-1]=f[p-2],f[g]=f[p-1],f.length=p-2;return}}n.isConstraint=function(){var f=[0,0];function o(i,g){return i[0]-g[0]||i[1]-g[1]}return function(i,g){return f[0]=Math.min(i,g),f[1]=Math.max(i,g),e.eq(this.edges,f,o)>=0}}(),n.removeTriangle=function(f,o,i){var g=this.stars;r(g[f],o,i),r(g[o],i,f),r(g[i],f,o)},n.addTriangle=function(f,o,i){var g=this.stars;g[f].push(o,i),g[o].push(i,f),g[i].push(f,o)},n.opposite=function(f,o){for(var i=this.stars[o],g=1,p=i.length;g<p;g+=2)if(i[g]===f)return i[g-1];return-1},n.flip=function(f,o){var i=this.opposite(f,o),g=this.opposite(o,f);this.removeTriangle(f,o,i),this.removeTriangle(o,f,g),this.addTriangle(f,g,i),this.addTriangle(o,i,g)},n.edges=function(){for(var f=this.stars,o=[],i=0,g=f.length;i<g;++i)for(var p=f[i],y=0,h=p.length;y<h;y+=2)o.push([p[y],p[y+1]]);return o},n.cells=function(){for(var f=this.stars,o=[],i=0,g=f.length;i<g;++i)for(var p=f[i],y=0,h=p.length;y<h;y+=2){var m=p[y],u=p[y+1];i<Math.min(m,u)&&o.push([i,m,u])}return o};function t(f,o){for(var i=new Array(f),g=0;g<f;++g)i[g]=[];return new a(i,o)}},{"binary-search-bounds":31}],47:[function(c,M,T){M.exports=e;function e(a){for(var n=1,r=1;r<a.length;++r)for(var t=0;t<r;++t)if(a[r]<a[t])n=-n;else if(a[t]===a[r])return 0;return n}},{}],48:[function(c,M,T){var e=c("dup"),a=c("robust-linear-solve");function n(f,o){for(var i=0,g=f.length,p=0;p<g;++p)i+=f[p]*o[p];return i}function r(f){var o=f.length;if(o===0)return[];f[0].length;var i=e([f.length+1,f.length+1],1),g=e([f.length+1],1);i[o][o]=0;for(var p=0;p<o;++p){for(var y=0;y<=p;++y)i[y][p]=i[p][y]=2*n(f[p],f[y]);g[p]=n(f[p],f[p])}for(var h=a(i,g),m=0,u=h[o+1],p=0;p<u.length;++p)m+=u[p];for(var _=new Array(o),p=0;p<o;++p){for(var u=h[p],s=0,y=0;y<u.length;++y)s+=u[y];_[p]=s/m}return _}function t(f){if(f.length===0)return[];for(var o=f[0].length,i=e([o]),g=r(f),p=0;p<f.length;++p)for(var y=0;y<o;++y)i[y]+=f[p][y]*g[p];return i}t.barycenetric=r,M.exports=t},{dup:65,"robust-linear-solve":283}],49:[function(c,M,T){M.exports=a;var e=c("circumcenter");function a(n){for(var r=e(n),t=0,f=0;f<n.length;++f)for(var o=n[f],i=0;i<r.length;++i)t+=Math.pow(o[i]-r[i],2);return Math.sqrt(t/n.length)}},{circumcenter:48}],50:[function(c,M,T){M.exports=L;var e=c("union-find"),a=c("box-intersect"),n=c("robust-segment-intersect"),r=c("big-rat"),t=c("big-rat/cmp"),f=c("big-rat/to-float"),o=c("rat-vec"),i=c("nextafter"),g=c("./lib/rat-seg-intersect");function p(S){var k=f(S);return[i(k,-1/0),i(k,1/0)]}function y(S,k){for(var P=new Array(k.length),z=0;z<k.length;++z){var I=k[z],D=S[I[0]],R=S[I[1]];P[z]=[i(Math.min(D[0],R[0]),-1/0),i(Math.min(D[1],R[1]),-1/0),i(Math.max(D[0],R[0]),1/0),i(Math.max(D[1],R[1]),1/0)]}return P}function h(S){for(var k=new Array(S.length),P=0;P<S.length;++P){var z=S[P];k[P]=[i(z[0],-1/0),i(z[1],-1/0),i(z[0],1/0),i(z[1],1/0)]}return k}function m(S,k,P){var z=[];return a(P,function(I,D){var R=k[I],B=k[D];if(!(R[0]===B[0]||R[0]===B[1]||R[1]===B[0]||R[1]===B[1])){var F=S[R[0]],V=S[R[1]],G=S[B[0]],J=S[B[1]];n(F,V,G,J)&&z.push([I,D])}}),z}function u(S,k,P,z){var I=[];return a(P,z,function(D,R){var B=k[D];if(!(B[0]===R||B[1]===R)){var F=S[R],V=S[B[0]],G=S[B[1]];n(V,G,F,F)&&I.push([D,R])}}),I}function _(S,k,P,z,I){var D,R,B=S.map(function(ee){return[r(ee[0]),r(ee[1])]});for(D=0;D<P.length;++D){var F=P[D];R=F[0];var V=F[1],G=k[R],J=k[V],j=g(o(S[G[0]]),o(S[G[1]]),o(S[J[0]]),o(S[J[1]]));if(!!j){var Y=S.length;S.push([f(j[0]),f(j[1])]),B.push(j),z.push([R,Y],[V,Y])}}for(z.sort(function(ee,te){if(ee[0]!==te[0])return ee[0]-te[0];var ae=B[ee[1]],le=B[te[1]];return t(ae[0],le[0])||t(ae[1],le[1])}),D=z.length-1;D>=0;--D){var X=z[D];R=X[0];var oe=k[R],se=oe[0],ie=oe[1],N=S[se],U=S[ie];if((N[0]-U[0]||N[1]-U[1])<0){var q=se;se=ie,ie=q}oe[0]=se;var Q=oe[1]=X[1],W;for(I&&(W=oe[2]);D>0&&z[D-1][0]===R;){var X=z[--D],Z=X[1];I?k.push([Q,Z,W]):k.push([Q,Z]),Q=Z}I?k.push([Q,ie,W]):k.push([Q,ie])}return B}function s(S,k,P){for(var z=k.length,I=new e(z),D=[],R=0;R<k.length;++R){var B=k[R],F=p(B[0]),V=p(B[1]);D.push([i(F[0],-1/0),i(V[0],-1/0),i(F[1],1/0),i(V[1],1/0)])}a(D,function(X,oe){I.link(X,oe)});for(var G=!0,J=new Array(z),R=0;R<z;++R){var j=I.find(R);j!==R&&(G=!1,S[j]=[Math.min(S[R][0],S[j][0]),Math.min(S[R][1],S[j][1])])}if(G)return null;for(var Y=0,R=0;R<z;++R){var j=I.find(R);j===R?(J[R]=Y,S[Y++]=S[R]):J[R]=-1}S.length=Y;for(var R=0;R<z;++R)J[R]<0&&(J[R]=J[I.find(R)]);return J}function A(S,k){return S[0]-k[0]||S[1]-k[1]}function x(S,k){var P=S[0]-k[0]||S[1]-k[1];return P||(S[2]<k[2]?-1:S[2]>k[2]?1:0)}function v(S,k,P){if(S.length!==0){if(k)for(var z=0;z<S.length;++z){var I=S[z],D=k[I[0]],R=k[I[1]];I[0]=Math.min(D,R),I[1]=Math.max(D,R)}else for(var z=0;z<S.length;++z){var I=S[z],D=I[0],R=I[1];I[0]=Math.min(D,R),I[1]=Math.max(D,R)}P?S.sort(x):S.sort(A);for(var B=1,z=1;z<S.length;++z){var F=S[z-1],V=S[z];V[0]===F[0]&&V[1]===F[1]&&(!P||V[2]===F[2])||(S[B++]=V)}S.length=B}}function b(S,k,P){var z=s(S,[],h(S));return v(k,z,P),!!z}function l(S,k,P){var z=y(S,k),I=m(S,k,z),D=h(S),R=u(S,k,z,D),B=_(S,k,I,R,P),F=s(S,B);return v(k,F,P),F?!0:I.length>0||R.length>0}function L(S,k,P){var z;if(P){z=k;for(var I=new Array(k.length),D=0;D<k.length;++D){var R=k[D];I[D]=[R[0],R[1],P[D]]}k=I}for(var B=b(S,k,!!P);l(S,k,!!P);)B=!0;if(!!P&&B){z.length=0,P.length=0;for(var D=0;D<k.length;++D){var R=k[D];z.push([R[0],R[1]]),P.push(R[2])}}return B}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(c,M,T){M.exports=g;var e=c("big-rat/mul"),a=c("big-rat/div"),n=c("big-rat/sub"),r=c("big-rat/sign"),t=c("rat-vec/sub"),f=c("rat-vec/add"),o=c("rat-vec/muls");function i(p,y){return n(e(p[0],y[1]),e(p[1],y[0]))}function g(p,y,h,m){var u=t(y,p),_=t(m,h),s=i(u,_);if(r(s)===0)return null;var A=t(p,h),x=i(_,A),v=a(x,s),b=o(u,v),l=f(p,b);return l}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(c,M,T){M.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(c,M,T){var e=c("./colorScale"),a=c("lerp");M.exports=n;function n(o){var i,g,p,y,h,m,u,_,v,s,A;if(o||(o={}),_=(o.nshades||72)-1,u=o.format||"hex",m=o.colormap,m||(m="jet"),typeof m=="string"){if(m=m.toLowerCase(),!e[m])throw Error(m+" not a supported colorscale");h=e[m]}else if(Array.isArray(m))h=m.slice();else throw Error("unsupported colormap option",m);if(h.length>_+1)throw new Error(m+" map requires nshades to be at least size "+h.length);Array.isArray(o.alpha)?o.alpha.length!==2?s=[1,1]:s=o.alpha.slice():typeof o.alpha=="number"?s=[o.alpha,o.alpha]:s=[1,1],i=h.map(function(L){return Math.round(L.index*_)}),s[0]=Math.min(Math.max(s[0],0),1),s[1]=Math.min(Math.max(s[1],0),1);var x=h.map(function(L,S){var k=h[S].index,P=h[S].rgb.slice();return P.length===4&&P[3]>=0&&P[3]<=1||(P[3]=s[0]+(s[1]-s[0])*k),P}),v=[];for(A=0;A<i.length-1;++A){y=i[A+1]-i[A],g=x[A],p=x[A+1];for(var b=0;b<y;b++){var l=b/y;v.push([Math.round(a(g[0],p[0],l)),Math.round(a(g[1],p[1],l)),Math.round(a(g[2],p[2],l)),a(g[3],p[3],l)])}}return v.push(h[h.length-1].rgb.concat(s[1])),u==="hex"?v=v.map(t):u==="rgbaString"?v=v.map(f):u==="float"&&(v=v.map(r)),v}function r(o){return[o[0]/255,o[1]/255,o[2]/255,o[3]]}function t(o){for(var i,g="#",p=0;p<3;++p)i=o[p],i=i.toString(16),g+=("00"+i).substr(i.length);return g}function f(o){return"rgba("+o.join(",")+")"}},{"./colorScale":52,lerp:240}],54:[function(c,M,T){M.exports=o;var e=c("robust-orientation"),a=c("signum"),n=c("two-sum"),r=c("robust-product"),t=c("robust-sum");function f(i,g,p){var y=n(i[0],-g[0]),h=n(i[1],-g[1]),m=n(p[0],-g[0]),u=n(p[1],-g[1]),_=t(r(y,m),r(h,u));return _[_.length-1]>=0}function o(i,g,p,y){var h=e(g,p,y);if(h===0){var m=a(e(i,g,p)),u=a(e(i,g,y));if(m===u){if(m===0){var _=f(i,g,p),s=f(i,g,y);return _===s?0:_?1:-1}return 0}else{if(u===0)return m>0||f(i,g,y)?-1:1;if(m===0)return u>0||f(i,g,p)?1:-1}return a(u-m)}var A=e(i,g,p);if(A>0)return h>0&&e(i,g,y)>0?1:-1;if(A<0)return h>0||e(i,g,y)>0?1:-1;var x=e(i,g,y);return x>0||f(i,g,p)?1:-1}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(c,M,T){M.exports=function(a){return a<0?-1:a>0?1:0}},{}],56:[function(c,M,T){M.exports=n;var e=Math.min;function a(r,t){return r-t}function n(r,t){var f=r.length,o=r.length-t.length;if(o)return o;switch(f){case 0:return 0;case 1:return r[0]-t[0];case 2:return r[0]+r[1]-t[0]-t[1]||e(r[0],r[1])-e(t[0],t[1]);case 3:var i=r[0]+r[1],g=t[0]+t[1];if(o=i+r[2]-(g+t[2]),o)return o;var p=e(r[0],r[1]),y=e(t[0],t[1]);return e(p,r[2])-e(y,t[2])||e(p+r[2],i)-e(y+t[2],g);case 4:var h=r[0],m=r[1],u=r[2],_=r[3],s=t[0],A=t[1],x=t[2],v=t[3];return h+m+u+_-(s+A+x+v)||e(h,m,u,_)-e(s,A,x,v,s)||e(h+m,h+u,h+_,m+u,m+_,u+_)-e(s+A,s+x,s+v,A+x,A+v,x+v)||e(h+m+u,h+m+_,h+u+_,m+u+_)-e(s+A+x,s+A+v,s+x+v,A+x+v);default:for(var b=r.slice().sort(a),l=t.slice().sort(a),L=0;L<f;++L)if(o=b[L]-l[L],o)return o;return 0}}},{}],57:[function(c,M,T){var e=c("compare-cell"),a=c("cell-orientation");M.exports=n;function n(r,t){return e(r,t)||a(r)-a(t)}},{"cell-orientation":47,"compare-cell":56}],58:[function(c,M,T){var e=c("./lib/ch1d"),a=c("./lib/ch2d"),n=c("./lib/chnd");M.exports=r;function r(t){var f=t.length;if(f===0)return[];if(f===1)return[[0]];var o=t[0].length;return o===0?[]:o===1?e(t):o===2?a(t):n(t,o)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(c,M,T){M.exports=e;function e(a){for(var n=0,r=0,t=1;t<a.length;++t)a[t][0]<a[n][0]&&(n=t),a[t][0]>a[r][0]&&(r=t);return n<r?[[n],[r]]:n>r?[[r],[n]]:[[n]]}},{}],60:[function(c,M,T){M.exports=a;var e=c("monotone-convex-hull-2d");function a(n){var r=e(n),t=r.length;if(t<=2)return[];for(var f=new Array(t),o=r[t-1],i=0;i<t;++i){var g=r[i];f[i]=[o,g],o=g}return f}},{"monotone-convex-hull-2d":246}],61:[function(c,M,T){M.exports=t;var e=c("incremental-convex-hull"),a=c("affine-hull");function n(f,o){for(var i=f.length,g=new Array(i),p=0;p<o.length;++p)g[p]=f[o[p]];for(var y=o.length,p=0;p<i;++p)o.indexOf(p)<0&&(g[y++]=f[p]);return g}function r(f,o){for(var i=f.length,g=o.length,p=0;p<i;++p)for(var y=f[p],h=0;h<y.length;++h){var m=y[h];if(m<g)y[h]=o[m];else{m=m-g;for(var u=0;u<g;++u)m>=o[u]&&(m+=1);y[h]=m}}return f}function t(f,o){try{return e(f,!0)}catch{var i=a(f);if(i.length<=o)return[];var g=n(f,i),p=e(g,!0);return r(p,i)}}},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(c,M,T){function e(n,r,t,f,o,i){var g=6*o*o-6*o,p=3*o*o-4*o+1,y=-6*o*o+6*o,h=3*o*o-2*o;if(n.length){i||(i=new Array(n.length));for(var m=n.length-1;m>=0;--m)i[m]=g*n[m]+p*r[m]+y*t[m]+h*f[m];return i}return g*n+p*r+y*t[m]+h*f}function a(n,r,t,f,o,i){var g=o-1,p=o*o,y=g*g,h=(1+2*o)*y,m=o*y,u=p*(3-2*o),_=p*g;if(n.length){i||(i=new Array(n.length));for(var s=n.length-1;s>=0;--s)i[s]=h*n[s]+m*r[s]+u*t[s]+_*f[s];return i}return h*n+m*r+u*t+_*f}M.exports=a,M.exports.derivative=e},{}],63:[function(c,M,T){var e=c("incremental-convex-hull"),a=c("uniq");M.exports=f;function n(o,i){this.point=o,this.index=i}function r(o,i){for(var g=o.point,p=i.point,y=g.length,h=0;h<y;++h){var m=p[h]-g[h];if(m)return m}return 0}function t(o,i,g){if(o===1)return g?[[-1,0]]:[];var p=i.map(function(_,s){return[_[0],s]});p.sort(function(_,s){return _[0]-s[0]});for(var y=new Array(o-1),h=1;h<o;++h){var m=p[h-1],u=p[h];y[h-1]=[m[1],u[1]]}return g&&y.push([-1,y[0][1]],[y[o-1][1],-1]),y}function f(o,i){var g=o.length;if(g===0)return[];var p=o[0].length;if(p<1)return[];if(p===1)return t(g,o,i);for(var y=new Array(g),h=1,m=0;m<g;++m){for(var u=o[m],_=new Array(p+1),s=0,A=0;A<p;++A){var x=u[A];_[A]=x,s+=x*x}_[p]=s,y[m]=new n(_,m),h=Math.max(s,h)}a(y,r),g=y.length;for(var v=new Array(g+p+1),b=new Array(g+p+1),l=(p+1)*(p+1)*h,L=new Array(p+1),m=0;m<=p;++m)L[m]=0;L[p]=l,v[0]=L.slice(),b[0]=-1;for(var m=0;m<=p;++m){var _=L.slice();_[m]=1,v[m+1]=_,b[m+1]=-1}for(var m=0;m<g;++m){var S=y[m];v[m+p+1]=S.point,b[m+p+1]=S.index}var k=e(v,!1);if(i?k=k.filter(function(P){for(var z=0,I=0;I<=p;++I){var D=b[P[I]];if(D<0&&++z>=2)return!1;P[I]=D}return!0}):k=k.filter(function(P){for(var z=0;z<=p;++z){var I=b[P[z]];if(I<0)return!1;P[z]=I}return!0}),p&1)for(var m=0;m<k.length;++m){var S=k[m],_=S[0];S[0]=S[1],S[1]=_}return k}},{"incremental-convex-hull":233,uniq:310}],64:[function(c,M,T){(function(e){(function(){var a=!1;if(typeof Float64Array!="undefined"){var n=new Float64Array(1),r=new Uint32Array(n.buffer);if(n[0]=1,a=!0,r[1]===1072693248){let f=function(g,p){return r[0]=g,r[1]=p,n[0]},o=function(g){return n[0]=g,r[0]},i=function(g){return n[0]=g,r[1]};M.exports=function(p){return n[0]=p,[r[0],r[1]]},M.exports.pack=f,M.exports.lo=o,M.exports.hi=i}else if(r[0]===1072693248){let f=function(g,p){return r[1]=g,r[0]=p,n[0]},o=function(g){return n[0]=g,r[1]},i=function(g){return n[0]=g,r[0]};M.exports=function(p){return n[0]=p,[r[1],r[0]]},M.exports.pack=f,M.exports.lo=o,M.exports.hi=i}else a=!1}if(!a){let f=function(g,p){return t.writeUInt32LE(g,0,!0),t.writeUInt32LE(p,4,!0),t.readDoubleLE(0,!0)},o=function(g){return t.writeDoubleLE(g,0,!0),t.readUInt32LE(0,!0)},i=function(g){return t.writeDoubleLE(g,0,!0),t.readUInt32LE(4,!0)};var t=new e(8);M.exports=function(p){return t.writeDoubleLE(p,0,!0),[t.readUInt32LE(0,!0),t.readUInt32LE(4,!0)]},M.exports.pack=f,M.exports.lo=o,M.exports.hi=i}M.exports.sign=function(f){return M.exports.hi(f)>>>31},M.exports.exponent=function(f){var o=M.exports.hi(f);return(o<<1>>>21)-1023},M.exports.fraction=function(f){var o=M.exports.lo(f),i=M.exports.hi(f),g=i&(1<<20)-1;return i&2146435072&&(g+=1<<20),[o,g]},M.exports.denormalized=function(f){var o=M.exports.hi(f);return!(o&2146435072)}}).call(this)}).call(this,c("buffer").Buffer)},{buffer:3}],65:[function(c,M,T){function e(r,t,f){var o=r[f]|0;if(o<=0)return[];var i=new Array(o),g;if(f===r.length-1)for(g=0;g<o;++g)i[g]=t;else for(g=0;g<o;++g)i[g]=e(r,t,f+1);return i}function a(r,t){var f,o;for(f=new Array(r),o=0;o<r;++o)f[o]=t;return f}function n(r,t){switch(typeof t=="undefined"&&(t=0),typeof r){case"number":if(r>0)return a(r|0,t);break;case"object":if(typeof r.length=="number")return e(r,t,0);break}return[]}M.exports=n},{}],66:[function(c,M,T){M.exports=a;var e=c("uniq");function a(n,r){var t=n.length;if(typeof r!="number"){r=0;for(var f=0;f<t;++f){var o=n[f];r=Math.max(r,o[0],o[1])}r=(r|0)+1}r=r|0;for(var i=new Array(r),f=0;f<r;++f)i[f]=[];for(var f=0;f<t;++f){var o=n[f];i[o[0]].push(o[1]),i[o[1]].push(o[0])}for(var g=0;g<r;++g)e(i[g],function(p,y){return p-y});return i}},{uniq:310}],67:[function(c,M,T){M.exports=e;function e(a,n,r){var t=n||0,f=r||1;return[[a[12]+a[0],a[13]+a[1],a[14]+a[2],a[15]+a[3]],[a[12]-a[0],a[13]-a[1],a[14]-a[2],a[15]-a[3]],[a[12]+a[4],a[13]+a[5],a[14]+a[6],a[15]+a[7]],[a[12]-a[4],a[13]-a[5],a[14]-a[6],a[15]-a[7]],[t*a[12]+a[8],t*a[13]+a[9],t*a[14]+a[10],t*a[15]+a[11]],[f*a[12]-a[8],f*a[13]-a[9],f*a[14]-a[10],f*a[15]-a[11]]]}},{}],68:[function(c,M,T){M.exports=o;var e=c("cubic-hermite"),a=c("binary-search-bounds");function n(i,g,p){return Math.min(g,Math.max(i,p))}function r(i,g,p){this.dimension=i.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var y=0;y<this.dimension;++y)this.bounds[0][y]=-1/0,this.bounds[1][y]=1/0;this._state=i.slice().reverse(),this._velocity=g.slice().reverse(),this._time=[p],this._scratch=[i.slice(),i.slice(),i.slice(),i.slice(),i.slice()]}var t=r.prototype;t.flush=function(i){var g=a.gt(this._time,i)-1;g<=0||(this._time.splice(0,g),this._state.splice(0,g*this.dimension),this._velocity.splice(0,g*this.dimension))},t.curve=function(i){var g=this._time,p=g.length,y=a.le(g,i),h=this._scratch[0],m=this._state,u=this._velocity,_=this.dimension,s=this.bounds;if(y<0)for(var A=_-1,x=0;x<_;++x,--A)h[x]=m[A];else if(y>=p-1)for(var A=m.length-1,v=i-g[p-1],x=0;x<_;++x,--A)h[x]=m[A]+v*u[A];else{for(var A=_*(y+1)-1,b=g[y],l=g[y+1],L=l-b||1,S=this._scratch[1],k=this._scratch[2],P=this._scratch[3],z=this._scratch[4],I=!0,x=0;x<_;++x,--A)S[x]=m[A],P[x]=u[A]*L,k[x]=m[A+_],z[x]=u[A+_]*L,I=I&&S[x]===k[x]&&P[x]===z[x]&&P[x]===0;if(I)for(var x=0;x<_;++x)h[x]=S[x];else e(S,P,k,z,(i-b)/L,h)}for(var D=s[0],R=s[1],x=0;x<_;++x)h[x]=n(D[x],R[x],h[x]);return h},t.dcurve=function(i){var g=this._time,p=g.length,y=a.le(g,i),h=this._scratch[0],m=this._state,u=this._velocity,_=this.dimension;if(y>=p-1){var s=m.length-1;i-g[p-1];for(var A=0;A<_;++A,--s)h[A]=u[s]}else{for(var s=_*(y+1)-1,x=g[y],v=g[y+1],b=v-x||1,l=this._scratch[1],L=this._scratch[2],S=this._scratch[3],k=this._scratch[4],P=!0,A=0;A<_;++A,--s)l[A]=m[s],S[A]=u[s]*b,L[A]=m[s+_],k[A]=u[s+_]*b,P=P&&l[A]===L[A]&&S[A]===k[A]&&S[A]===0;if(P)for(var A=0;A<_;++A)h[A]=0;else{e.derivative(l,S,L,k,(i-x)/b,h);for(var A=0;A<_;++A)h[A]/=b}}return h},t.lastT=function(){var i=this._time;return i[i.length-1]},t.stable=function(){for(var i=this._velocity,g=i.length,p=this.dimension-1;p>=0;--p)if(i[--g])return!1;return!0},t.jump=function(i){var g=this.lastT(),p=this.dimension;if(!(i<g||arguments.length!==p+1)){var y=this._state,h=this._velocity,m=y.length-this.dimension,u=this.bounds,_=u[0],s=u[1];this._time.push(g,i);for(var A=0;A<2;++A)for(var x=0;x<p;++x)y.push(y[m++]),h.push(0);this._time.push(i);for(var x=p;x>0;--x)y.push(n(_[x-1],s[x-1],arguments[x])),h.push(0)}},t.push=function(i){var g=this.lastT(),p=this.dimension;if(!(i<g||arguments.length!==p+1)){var y=this._state,h=this._velocity,m=y.length-this.dimension,u=i-g,_=this.bounds,s=_[0],A=_[1],x=u>1e-6?1/u:0;this._time.push(i);for(var v=p;v>0;--v){var b=n(s[v-1],A[v-1],arguments[v]);y.push(b),h.push((b-y[m++])*x)}}},t.set=function(i){var g=this.dimension;if(!(i<this.lastT()||arguments.length!==g+1)){var p=this._state,y=this._velocity,h=this.bounds,m=h[0],u=h[1];this._time.push(i);for(var _=g;_>0;--_)p.push(n(m[_-1],u[_-1],arguments[_])),y.push(0)}},t.move=function(i){var g=this.lastT(),p=this.dimension;if(!(i<=g||arguments.length!==p+1)){var y=this._state,h=this._velocity,m=y.length-this.dimension,u=this.bounds,_=u[0],s=u[1],A=i-g,x=A>1e-6?1/A:0;this._time.push(i);for(var v=p;v>0;--v){var b=arguments[v];y.push(n(_[v-1],s[v-1],y[m++]+b)),h.push(b*x)}}},t.idle=function(i){var g=this.lastT();if(!(i<g)){var p=this.dimension,y=this._state,h=this._velocity,m=y.length-p,u=this.bounds,_=u[0],s=u[1],A=i-g;this._time.push(i);for(var x=p-1;x>=0;--x)y.push(n(_[x],s[x],y[m]+A*h[m])),h.push(0),m+=1}};function f(i){for(var g=new Array(i),p=0;p<i;++p)g[p]=0;return g}function o(i,g,p){switch(arguments.length){case 0:return new r([0],[0],0);case 1:if(typeof i=="number"){var y=f(i);return new r(y,y,0)}else return new r(i,f(i.length),0);case 2:if(typeof g=="number"){var y=f(i.length);return new r(i,y,+g)}else p=0;case 3:if(i.length!==g.length)throw new Error("state and velocity lengths must match");return new r(i,g,p)}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(c,M,T){M.exports=A;var e=0,a=1;function n(x,v,b,l,L,S){this._color=x,this.key=v,this.value=b,this.left=l,this.right=L,this._count=S}function r(x){return new n(x._color,x.key,x.value,x.left,x.right,x._count)}function t(x,v){return new n(x,v.key,v.value,v.left,v.right,v._count)}function f(x){x._count=1+(x.left?x.left._count:0)+(x.right?x.right._count:0)}function o(x,v){this._compare=x,this.root=v}var i=o.prototype;Object.defineProperty(i,"keys",{get:function(){var x=[];return this.forEach(function(v,b){x.push(v)}),x}}),Object.defineProperty(i,"values",{get:function(){var x=[];return this.forEach(function(v,b){x.push(b)}),x}}),Object.defineProperty(i,"length",{get:function(){return this.root?this.root._count:0}}),i.insert=function(x,v){for(var b=this._compare,l=this.root,L=[],S=[];l;){var k=b(x,l.key);L.push(l),S.push(k),k<=0?l=l.left:l=l.right}L.push(new n(e,x,v,null,null,1));for(var P=L.length-2;P>=0;--P){var l=L[P];S[P]<=0?L[P]=new n(l._color,l.key,l.value,L[P+1],l.right,l._count+1):L[P]=new n(l._color,l.key,l.value,l.left,L[P+1],l._count+1)}for(var P=L.length-1;P>1;--P){var z=L[P-1],l=L[P];if(z._color===a||l._color===a)break;var I=L[P-2];if(I.left===z)if(z.left===l){var D=I.right;if(D&&D._color===e)z._color=a,I.right=t(a,D),I._color=e,P-=1;else{if(I._color=e,I.left=z.right,z._color=a,z.right=I,L[P-2]=z,L[P-1]=l,f(I),f(z),P>=3){var R=L[P-3];R.left===I?R.left=z:R.right=z}break}}else{var D=I.right;if(D&&D._color===e)z._color=a,I.right=t(a,D),I._color=e,P-=1;else{if(z.right=l.left,I._color=e,I.left=l.right,l._color=a,l.left=z,l.right=I,L[P-2]=l,L[P-1]=z,f(I),f(z),f(l),P>=3){var R=L[P-3];R.left===I?R.left=l:R.right=l}break}}else if(z.right===l){var D=I.left;if(D&&D._color===e)z._color=a,I.left=t(a,D),I._color=e,P-=1;else{if(I._color=e,I.right=z.left,z._color=a,z.left=I,L[P-2]=z,L[P-1]=l,f(I),f(z),P>=3){var R=L[P-3];R.right===I?R.right=z:R.left=z}break}}else{var D=I.left;if(D&&D._color===e)z._color=a,I.left=t(a,D),I._color=e,P-=1;else{if(z.left=l.right,I._color=e,I.right=l.left,l._color=a,l.right=z,l.left=I,L[P-2]=l,L[P-1]=z,f(I),f(z),f(l),P>=3){var R=L[P-3];R.right===I?R.right=l:R.left=l}break}}}return L[0]._color=a,new o(b,L[0])};function g(x,v){if(v.left){var b=g(x,v.left);if(b)return b}var b=x(v.key,v.value);if(b)return b;if(v.right)return g(x,v.right)}function p(x,v,b,l){var L=v(x,l.key);if(L<=0){if(l.left){var S=p(x,v,b,l.left);if(S)return S}var S=b(l.key,l.value);if(S)return S}if(l.right)return p(x,v,b,l.right)}function y(x,v,b,l,L){var S=b(x,L.key),k=b(v,L.key),P;if(S<=0&&(L.left&&(P=y(x,v,b,l,L.left),P)||k>0&&(P=l(L.key,L.value),P)))return P;if(k>0&&L.right)return y(x,v,b,l,L.right)}i.forEach=function(v,b,l){if(!!this.root)switch(arguments.length){case 1:return g(v,this.root);case 2:return p(b,this._compare,v,this.root);case 3:return this._compare(b,l)>=0?void 0:y(b,l,this._compare,v,this.root)}},Object.defineProperty(i,"begin",{get:function(){for(var x=[],v=this.root;v;)x.push(v),v=v.left;return new h(this,x)}}),Object.defineProperty(i,"end",{get:function(){for(var x=[],v=this.root;v;)x.push(v),v=v.right;return new h(this,x)}}),i.at=function(x){if(x<0)return new h(this,[]);for(var v=this.root,b=[];;){if(b.push(v),v.left){if(x<v.left._count){v=v.left;continue}x-=v.left._count}if(!x)return new h(this,b);if(x-=1,v.right){if(x>=v.right._count)break;v=v.right}else break}return new h(this,[])},i.ge=function(x){for(var v=this._compare,b=this.root,l=[],L=0;b;){var S=v(x,b.key);l.push(b),S<=0&&(L=l.length),S<=0?b=b.left:b=b.right}return l.length=L,new h(this,l)},i.gt=function(x){for(var v=this._compare,b=this.root,l=[],L=0;b;){var S=v(x,b.key);l.push(b),S<0&&(L=l.length),S<0?b=b.left:b=b.right}return l.length=L,new h(this,l)},i.lt=function(x){for(var v=this._compare,b=this.root,l=[],L=0;b;){var S=v(x,b.key);l.push(b),S>0&&(L=l.length),S<=0?b=b.left:b=b.right}return l.length=L,new h(this,l)},i.le=function(x){for(var v=this._compare,b=this.root,l=[],L=0;b;){var S=v(x,b.key);l.push(b),S>=0&&(L=l.length),S<0?b=b.left:b=b.right}return l.length=L,new h(this,l)},i.find=function(x){for(var v=this._compare,b=this.root,l=[];b;){var L=v(x,b.key);if(l.push(b),L===0)return new h(this,l);L<=0?b=b.left:b=b.right}return new h(this,[])},i.remove=function(x){var v=this.find(x);return v?v.remove():this},i.get=function(x){for(var v=this._compare,b=this.root;b;){var l=v(x,b.key);if(l===0)return b.value;l<=0?b=b.left:b=b.right}};function h(x,v){this.tree=x,this._stack=v}var m=h.prototype;Object.defineProperty(m,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(m,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),m.clone=function(){return new h(this.tree,this._stack.slice())};function u(x,v){x.key=v.key,x.value=v.value,x.left=v.left,x.right=v.right,x._color=v._color,x._count=v._count}function _(x){for(var v,b,l,L,S=x.length-1;S>=0;--S){if(v=x[S],S===0){v._color=a;return}if(b=x[S-1],b.left===v){if(l=b.right,l.right&&l.right._color===e){if(l=b.right=r(l),L=l.right=r(l.right),b.right=l.left,l.left=b,l.right=L,l._color=b._color,v._color=a,b._color=a,L._color=a,f(b),f(l),S>1){var k=x[S-2];k.left===b?k.left=l:k.right=l}x[S-1]=l;return}else if(l.left&&l.left._color===e){if(l=b.right=r(l),L=l.left=r(l.left),b.right=L.left,l.left=L.right,L.left=b,L.right=l,L._color=b._color,b._color=a,l._color=a,v._color=a,f(b),f(l),f(L),S>1){var k=x[S-2];k.left===b?k.left=L:k.right=L}x[S-1]=L;return}if(l._color===a)if(b._color===e){b._color=a,b.right=t(e,l);return}else{b.right=t(e,l);continue}else{if(l=r(l),b.right=l.left,l.left=b,l._color=b._color,b._color=e,f(b),f(l),S>1){var k=x[S-2];k.left===b?k.left=l:k.right=l}x[S-1]=l,x[S]=b,S+1<x.length?x[S+1]=v:x.push(v),S=S+2}}else{if(l=b.left,l.left&&l.left._color===e){if(l=b.left=r(l),L=l.left=r(l.left),b.left=l.right,l.right=b,l.left=L,l._color=b._color,v._color=a,b._color=a,L._color=a,f(b),f(l),S>1){var k=x[S-2];k.right===b?k.right=l:k.left=l}x[S-1]=l;return}else if(l.right&&l.right._color===e){if(l=b.left=r(l),L=l.right=r(l.right),b.left=L.right,l.right=L.left,L.right=b,L.left=l,L._color=b._color,b._color=a,l._color=a,v._color=a,f(b),f(l),f(L),S>1){var k=x[S-2];k.right===b?k.right=L:k.left=L}x[S-1]=L;return}if(l._color===a)if(b._color===e){b._color=a,b.left=t(e,l);return}else{b.left=t(e,l);continue}else{if(l=r(l),b.left=l.right,l.right=b,l._color=b._color,b._color=e,f(b),f(l),S>1){var k=x[S-2];k.right===b?k.right=l:k.left=l}x[S-1]=l,x[S]=b,S+1<x.length?x[S+1]=v:x.push(v),S=S+2}}}}m.remove=function(){var x=this._stack;if(x.length===0)return this.tree;var v=new Array(x.length),b=x[x.length-1];v[v.length-1]=new n(b._color,b.key,b.value,b.left,b.right,b._count);for(var l=x.length-2;l>=0;--l){var b=x[l];b.left===x[l+1]?v[l]=new n(b._color,b.key,b.value,v[l+1],b.right,b._count):v[l]=new n(b._color,b.key,b.value,b.left,v[l+1],b._count)}if(b=v[v.length-1],b.left&&b.right){var L=v.length;for(b=b.left;b.right;)v.push(b),b=b.right;var S=v[L-1];v.push(new n(b._color,S.key,S.value,b.left,b.right,b._count)),v[L-1].key=b.key,v[L-1].value=b.value;for(var l=v.length-2;l>=L;--l)b=v[l],v[l]=new n(b._color,b.key,b.value,b.left,v[l+1],b._count);v[L-1].left=v[L]}if(b=v[v.length-1],b._color===e){var k=v[v.length-2];k.left===b?k.left=null:k.right===b&&(k.right=null),v.pop();for(var l=0;l<v.length;++l)v[l]._count--;return new o(this.tree._compare,v[0])}else if(b.left||b.right){b.left?u(b,b.left):b.right&&u(b,b.right),b._color=a;for(var l=0;l<v.length-1;++l)v[l]._count--;return new o(this.tree._compare,v[0])}else{if(v.length===1)return new o(this.tree._compare,null);for(var l=0;l<v.length;++l)v[l]._count--;var P=v[v.length-2];_(v),P.left===b?P.left=null:P.right=null}return new o(this.tree._compare,v[0])},Object.defineProperty(m,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(m,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(m,"index",{get:function(){var x=0,v=this._stack;if(v.length===0){var b=this.tree.root;return b?b._count:0}else v[v.length-1].left&&(x=v[v.length-1].left._count);for(var l=v.length-2;l>=0;--l)v[l+1]===v[l].right&&(++x,v[l].left&&(x+=v[l].left._count));return x},enumerable:!0}),m.next=function(){var x=this._stack;if(x.length!==0){var v=x[x.length-1];if(v.right)for(v=v.right;v;)x.push(v),v=v.left;else for(x.pop();x.length>0&&x[x.length-1].right===v;)v=x[x.length-1],x.pop()}},Object.defineProperty(m,"hasNext",{get:function(){var x=this._stack;if(x.length===0)return!1;if(x[x.length-1].right)return!0;for(var v=x.length-1;v>0;--v)if(x[v-1].left===x[v])return!0;return!1}}),m.update=function(x){var v=this._stack;if(v.length===0)throw new Error("Can't update empty node!");var b=new Array(v.length),l=v[v.length-1];b[b.length-1]=new n(l._color,l.key,x,l.left,l.right,l._count);for(var L=v.length-2;L>=0;--L)l=v[L],l.left===v[L+1]?b[L]=new n(l._color,l.key,l.value,b[L+1],l.right,l._count):b[L]=new n(l._color,l.key,l.value,l.left,b[L+1],l._count);return new o(this.tree._compare,b[0])},m.prev=function(){var x=this._stack;if(x.length!==0){var v=x[x.length-1];if(v.left)for(v=v.left;v;)x.push(v),v=v.right;else for(x.pop();x.length>0&&x[x.length-1].left===v;)v=x[x.length-1],x.pop()}},Object.defineProperty(m,"hasPrev",{get:function(){var x=this._stack;if(x.length===0)return!1;if(x[x.length-1].left)return!0;for(var v=x.length-1;v>0;--v)if(x[v-1].right===x[v])return!0;return!1}});function s(x,v){return x<v?-1:x>v?1:0}function A(x){return new o(x||s,null)}},{}],70:[function(c,M,T){M.exports=v;var e=c("./lib/text.js"),a=c("./lib/lines.js"),n=c("./lib/background.js"),r=c("./lib/cube.js"),t=c("./lib/ticks.js"),f=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function o(b,l){return b[0]=l[0],b[1]=l[1],b[2]=l[2],b}function i(b){this.gl=b,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=n(b)}var g=i.prototype;g.update=function(b){b=b||{};function l(G,J,j){if(j in b){var Y=b[j],X=this[j],oe;(G?Array.isArray(Y)&&Array.isArray(Y[0]):Array.isArray(Y))?this[j]=oe=[J(Y[0]),J(Y[1]),J(Y[2])]:this[j]=oe=[J(Y),J(Y),J(Y)];for(var se=0;se<3;++se)if(oe[se]!==X[se])return!0}return!1}var L=l.bind(this,!1,Number),S=l.bind(this,!1,Boolean),k=l.bind(this,!1,String),P=l.bind(this,!0,function(G){if(Array.isArray(G)){if(G.length===3)return[+G[0],+G[1],+G[2],1];if(G.length===4)return[+G[0],+G[1],+G[2],+G[3]]}return[0,0,0,1]}),z,I=!1,D=!1;if("bounds"in b)for(var R=b.bounds,B=0;B<2;++B)for(var F=0;F<3;++F)R[B][F]!==this.bounds[B][F]&&(D=!0),this.bounds[B][F]=R[B][F];if("ticks"in b){z=b.ticks,I=!0,this.autoTicks=!1;for(var B=0;B<3;++B)this.tickSpacing[B]=0}else L("tickSpacing")&&(this.autoTicks=!0,D=!0);if(this._firstInit&&("ticks"in b||"tickSpacing"in b||(this.autoTicks=!0),D=!0,I=!0,this._firstInit=!1),D&&this.autoTicks&&(z=t.create(this.bounds,this.tickSpacing),I=!0),I){for(var B=0;B<3;++B)z[B].sort(function(J,j){return J.x-j.x});t.equal(z,this.ticks)?I=!1:this.ticks=z}S("tickEnable"),k("tickFont")&&(I=!0),L("tickSize"),L("tickAngle"),L("tickPad"),P("tickColor");var V=k("labels");k("labelFont")&&(V=!0),S("labelEnable"),L("labelSize"),L("labelPad"),P("labelColor"),S("lineEnable"),S("lineMirror"),L("lineWidth"),P("lineColor"),S("lineTickEnable"),S("lineTickMirror"),L("lineTickLength"),L("lineTickWidth"),P("lineTickColor"),S("gridEnable"),L("gridWidth"),P("gridColor"),S("zeroEnable"),P("zeroLineColor"),L("zeroLineWidth"),S("backgroundEnable"),P("backgroundColor"),this._text?this._text&&(V||I)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=e(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&I&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=a(this.gl,this.bounds,this.ticks))};function p(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}var y=[new p,new p,new p];function h(b,l,L,S,k){for(var P=b.primalOffset,z=b.primalMinor,I=b.mirrorOffset,D=b.mirrorMinor,R=S[l],B=0;B<3;++B)if(l!==B){var F=P,V=I,G=z,J=D;R&1<<B&&(F=I,V=P,G=D,J=z),F[B]=L[0][B],V[B]=L[1][B],k[B]>0?(G[B]=-1,J[B]=0):(G[B]=0,J[B]=1)}}var m=[0,0,0],u={model:f,view:f,projection:f,_ortho:!1};g.isOpaque=function(){return!0},g.isTransparent=function(){return!1},g.drawTransparent=function(b){};var _=0,s=[0,0,0],A=[0,0,0],x=[0,0,0];g.draw=function(b){b=b||u;for(var X=this.gl,l=b.model||f,L=b.view||f,S=b.projection||f,k=this.bounds,P=b._ortho||!1,z=r(l,L,S,k,P),I=z.cubeEdges,D=z.axis,R=L[12],B=L[13],F=L[14],V=L[15],G=P?2:1,J=G*this.pixelRatio*(S[3]*R+S[7]*B+S[11]*F+S[15]*V)/X.drawingBufferHeight,j=0;j<3;++j)this.lastCubeProps.cubeEdges[j]=I[j],this.lastCubeProps.axis[j]=D[j];for(var Y=y,j=0;j<3;++j)h(y[j],j,this.bounds,I,D);for(var X=this.gl,oe=m,j=0;j<3;++j)this.backgroundEnable[j]?oe[j]=D[j]:oe[j]=0;this._background.draw(l,L,S,k,oe,this.backgroundColor),this._lines.bind(l,L,S,this);for(var j=0;j<3;++j){var se=[0,0,0];D[j]>0?se[j]=k[1][j]:se[j]=k[0][j];for(var ie=0;ie<2;++ie){var N=(j+1+ie)%3,U=(j+1+(ie^1))%3;this.gridEnable[N]&&this._lines.drawGrid(N,U,this.bounds,se,this.gridColor[N],this.gridWidth[N]*this.pixelRatio)}for(var ie=0;ie<2;++ie){var N=(j+1+ie)%3,U=(j+1+(ie^1))%3;this.zeroEnable[U]&&Math.min(k[0][U],k[1][U])<=0&&Math.max(k[0][U],k[1][U])>=0&&this._lines.drawZero(N,U,this.bounds,se,this.zeroLineColor[U],this.zeroLineWidth[U]*this.pixelRatio)}}for(var j=0;j<3;++j){this.lineEnable[j]&&this._lines.drawAxisLine(j,this.bounds,Y[j].primalOffset,this.lineColor[j],this.lineWidth[j]*this.pixelRatio),this.lineMirror[j]&&this._lines.drawAxisLine(j,this.bounds,Y[j].mirrorOffset,this.lineColor[j],this.lineWidth[j]*this.pixelRatio);for(var q=o(s,Y[j].primalMinor),Q=o(A,Y[j].mirrorMinor),W=this.lineTickLength,ie=0;ie<3;++ie){var Z=J/l[5*ie];q[ie]*=W[ie]*Z,Q[ie]*=W[ie]*Z}this.lineTickEnable[j]&&this._lines.drawAxisTicks(j,Y[j].primalOffset,q,this.lineTickColor[j],this.lineTickWidth[j]*this.pixelRatio),this.lineTickMirror[j]&&this._lines.drawAxisTicks(j,Y[j].mirrorOffset,Q,this.lineTickColor[j],this.lineTickWidth[j]*this.pixelRatio)}this._lines.unbind(),this._text.bind(l,L,S,this.pixelRatio);var ee,te=.5,ae,le;function ye(De){le=[0,0,0],le[De]=1}function fe(De,Be,Ve){var xe=(De+1)%3,Le=(De+2)%3,He=Be[xe],Je=Be[Le],Oe=Ve[xe],Pe=Ve[Le];if(He>0&&Pe>0){ye(xe);return}else if(He>0&&Pe<0){ye(xe);return}else if(He<0&&Pe>0){ye(xe);return}else if(He<0&&Pe<0){ye(xe);return}else if(Je>0&&Oe>0){ye(Le);return}else if(Je>0&&Oe<0){ye(Le);return}else if(Je<0&&Oe>0){ye(Le);return}else if(Je<0&&Oe<0){ye(Le);return}}for(var j=0;j<3;++j){for(var pe=Y[j].primalMinor,ge=Y[j].mirrorMinor,Ae=o(x,Y[j].primalOffset),ie=0;ie<3;++ie)this.lineTickEnable[j]&&(Ae[ie]+=J*pe[ie]*Math.max(this.lineTickLength[ie],0)/l[5*ie]);var we=[0,0,0];if(we[j]=1,this.tickEnable[j]){this.tickAngle[j]===-3600?(this.tickAngle[j]=0,this.tickAlign[j]="auto"):this.tickAlign[j]=-1,ae=1,ee=[this.tickAlign[j],te,ae],ee[0]==="auto"?ee[0]=_:ee[0]=parseInt(""+ee[0]),le=[0,0,0],fe(j,pe,ge);for(var ie=0;ie<3;++ie)Ae[ie]+=J*pe[ie]*this.tickPad[ie]/l[5*ie];this._text.drawTicks(j,this.tickSize[j],this.tickAngle[j],Ae,this.tickColor[j],we,le,ee)}if(this.labelEnable[j]){ae=0,le=[0,0,0],this.labels[j].length>4&&(ye(j),ae=1),ee=[this.labelAlign[j],te,ae],ee[0]==="auto"?ee[0]=_:ee[0]=parseInt(""+ee[0]);for(var ie=0;ie<3;++ie)Ae[ie]+=J*pe[ie]*this.labelPad[ie]/l[5*ie];Ae[j]+=.5*(k[0][j]+k[1][j]),this._text.drawLabel(j,this.labelSize[j],this.labelAngle[j],Ae,this.labelColor[j],[0,0,0],le,ee)}}this._text.unbind()},g.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null};function v(b,l){var L=new i(b);return L.update(l),L}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(c,M,T){M.exports=f;var e=c("gl-buffer"),a=c("gl-vao"),n=c("./shaders").bg;function r(o,i,g,p){this.gl=o,this.buffer=i,this.vao=g,this.shader=p}var t=r.prototype;t.draw=function(o,i,g,p,y,h){for(var m=!1,u=0;u<3;++u)m=m||y[u];if(!!m){var _=this.gl;_.enable(_.POLYGON_OFFSET_FILL),_.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:o,view:i,projection:g,bounds:p,enable:y,colors:h},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),_.disable(_.POLYGON_OFFSET_FILL)}},t.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function f(o){for(var i=[],g=[],p=0,y=0;y<3;++y)for(var h=(y+1)%3,m=(y+2)%3,u=[0,0,0],_=[0,0,0],s=-1;s<=1;s+=2){g.push(p,p+2,p+1,p+1,p+2,p+3),u[y]=s,_[y]=s;for(var A=-1;A<=1;A+=2){u[h]=A;for(var x=-1;x<=1;x+=2)u[m]=x,i.push(u[0],u[1],u[2],_[0],_[1],_[2]),p+=1}var v=h;h=m,m=v}var b=e(o,new Float32Array(i)),l=e(o,new Uint16Array(g),o.ELEMENT_ARRAY_BUFFER),L=a(o,[{buffer:b,type:o.FLOAT,size:3,offset:0,stride:24},{buffer:b,type:o.FLOAT,size:3,offset:12,stride:24}],l),S=n(o);return S.attributes.position.location=0,S.attributes.normal.location=1,new r(o,b,L,S)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(c,M,T){M.exports=s;var e=c("bit-twiddle"),a=c("gl-mat4/multiply"),n=c("split-polygon"),r=c("robust-orientation"),t=new Array(16),f=new Array(8),o=new Array(8),i=new Array(3),g=[0,0,0];(function(){for(var A=0;A<8;++A)f[A]=[1,1,1,1],o[A]=[1,1,1]})();function p(A,x,v){for(var b=0;b<4;++b){A[b]=v[12+b];for(var l=0;l<3;++l)A[b]+=x[l]*v[4*l+b]}}var y=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function h(A){for(var x=0;x<y.length;++x)if(A=n.positive(A,y[x]),A.length<3)return 0;for(var v=A[0],b=v[0]/v[3],l=v[1]/v[3],L=0,x=1;x+1<A.length;++x){var S=A[x],k=A[x+1],P=S[0]/S[3],z=S[1]/S[3],I=k[0]/k[3],D=k[1]/k[3],R=P-b,B=z-l,F=I-b,V=D-l;L+=Math.abs(R*V-B*F)}return L}var m=[1,1,1],u=[0,0,0],_={cubeEdges:m,axis:u};function s(A,x,v,b,l){a(t,x,A),a(t,v,t);for(var L=0,S=0;S<2;++S){i[2]=b[S][2];for(var k=0;k<2;++k){i[1]=b[k][1];for(var P=0;P<2;++P)i[0]=b[P][0],p(f[L],i,t),L+=1}}for(var z=-1,S=0;S<8;++S){for(var I=f[S][3],D=0;D<3;++D)o[S][D]=f[S][D]/I;l&&(o[S][2]*=-1),I<0&&(z<0||o[S][2]<o[z][2])&&(z=S)}if(z<0){z=0;for(var R=0;R<3;++R){for(var B=(R+2)%3,F=(R+1)%3,V=-1,G=-1,J=0;J<2;++J){var j=J<<R,Y=j+(J<<B)+(1-J<<F),X=j+(1-J<<B)+(J<<F);r(o[j],o[Y],o[X],g)<0||(J?V=1:G=1)}if(V<0||G<0){G>V&&(z|=1<<R);continue}for(var J=0;J<2;++J){var j=J<<R,Y=j+(J<<B)+(1-J<<F),X=j+(1-J<<B)+(J<<F),oe=h([f[j],f[Y],f[X],f[j+(1<<B)+(1<<F)]]);J?V=oe:G=oe}if(G>V){z|=1<<R;continue}}}for(var se=7^z,ie=-1,S=0;S<8;++S)S===z||S===se||(ie<0||o[ie][1]>o[S][1])&&(ie=S);for(var N=-1,S=0;S<3;++S){var U=ie^1<<S;if(!(U===z||U===se)){N<0&&(N=U);var F=o[U];F[0]<o[N][0]&&(N=U)}}for(var q=-1,S=0;S<3;++S){var U=ie^1<<S;if(!(U===z||U===se||U===N)){q<0&&(q=U);var F=o[U];F[0]>o[q][0]&&(q=U)}}var Q=m;Q[0]=Q[1]=Q[2]=0,Q[e.log2(N^ie)]=ie&N,Q[e.log2(ie^q)]=ie&q;var W=q^7;W===z||W===se?(W=N^7,Q[e.log2(q^W)]=W&q):Q[e.log2(N^W)]=W&N;for(var Z=u,ee=z,R=0;R<3;++R)ee&1<<R?Z[R]=-1:Z[R]=1;return _}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(c,M,T){M.exports=m;var e=c("gl-buffer"),a=c("gl-vao"),n=c("./shaders").line,r=[0,0,0],t=[0,0,0],f=[0,0,0],o=[0,0,0],i=[1,1];function g(u){return u[0]=u[1]=u[2]=0,u}function p(u,_){return u[0]=_[0],u[1]=_[1],u[2]=_[2],u}function y(u,_,s,A,x,v,b,l){this.gl=u,this.vertBuffer=_,this.vao=s,this.shader=A,this.tickCount=x,this.tickOffset=v,this.gridCount=b,this.gridOffset=l}var h=y.prototype;h.bind=function(u,_,s){this.shader.bind(),this.shader.uniforms.model=u,this.shader.uniforms.view=_,this.shader.uniforms.projection=s,i[0]=this.gl.drawingBufferWidth,i[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=i,this.vao.bind()},h.unbind=function(){this.vao.unbind()},h.drawAxisLine=function(u,_,s,A,x){var v=g(t);this.shader.uniforms.majorAxis=t,v[u]=_[1][u]-_[0][u],this.shader.uniforms.minorAxis=v;var b=p(o,s);b[u]+=_[0][u],this.shader.uniforms.offset=b,this.shader.uniforms.lineWidth=x,this.shader.uniforms.color=A;var l=g(f);l[(u+2)%3]=1,this.shader.uniforms.screenAxis=l,this.vao.draw(this.gl.TRIANGLES,6);var l=g(f);l[(u+1)%3]=1,this.shader.uniforms.screenAxis=l,this.vao.draw(this.gl.TRIANGLES,6)},h.drawAxisTicks=function(u,_,s,A,x){if(!!this.tickCount[u]){var v=g(r);v[u]=1,this.shader.uniforms.majorAxis=v,this.shader.uniforms.offset=_,this.shader.uniforms.minorAxis=s,this.shader.uniforms.color=A,this.shader.uniforms.lineWidth=x;var b=g(f);b[u]=1,this.shader.uniforms.screenAxis=b,this.vao.draw(this.gl.TRIANGLES,this.tickCount[u],this.tickOffset[u])}},h.drawGrid=function(u,_,s,A,x,v){if(!!this.gridCount[u]){var b=g(t);b[_]=s[1][_]-s[0][_],this.shader.uniforms.minorAxis=b;var l=p(o,A);l[_]+=s[0][_],this.shader.uniforms.offset=l;var L=g(r);L[u]=1,this.shader.uniforms.majorAxis=L;var S=g(f);S[u]=1,this.shader.uniforms.screenAxis=S,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=x,this.vao.draw(this.gl.TRIANGLES,this.gridCount[u],this.gridOffset[u])}},h.drawZero=function(u,_,s,A,x,v){var b=g(t);this.shader.uniforms.majorAxis=b,b[u]=s[1][u]-s[0][u],this.shader.uniforms.minorAxis=b;var l=p(o,A);l[u]+=s[0][u],this.shader.uniforms.offset=l;var L=g(f);L[_]=1,this.shader.uniforms.screenAxis=L,this.shader.uniforms.lineWidth=v,this.shader.uniforms.color=x,this.vao.draw(this.gl.TRIANGLES,6)},h.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()};function m(u,_,s){var A=[],x=[0,0,0],v=[0,0,0],b=[0,0,0],l=[0,0,0];A.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var L=0;L<3;++L){for(var P=A.length/3|0,S=0;S<s[L].length;++S){var k=+s[L][S].x;A.push(k,0,1,k,1,1,k,0,-1,k,0,-1,k,1,1,k,1,-1)}var I=A.length/3|0;x[L]=P,v[L]=I-P;for(var P=A.length/3|0,z=0;z<s[L].length;++z){var k=+s[L][z].x;A.push(k,0,1,k,1,1,k,0,-1,k,0,-1,k,1,1,k,1,-1)}var I=A.length/3|0;b[L]=P,l[L]=I-P}var D=e(u,new Float32Array(A)),R=a(u,[{buffer:D,type:u.FLOAT,size:3,stride:0,offset:0}]),B=n(u);return B.attributes.position.location=0,new y(u,D,R,B,v,x,l,b)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(c,M,T){var e=c("glslify"),a=c("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);T.line=function(g){return a(g,n,r,null,[{name:"position",type:"vec3"}])};var t=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),f=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);T.text=function(g){return a(g,t,f,null,[{name:"position",type:"vec3"}])};var o=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),i=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);T.bg=function(g){return a(g,o,i,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(c,M,T){(function(e){(function(){M.exports=m;var a=c("gl-buffer"),n=c("gl-vao"),r=c("vectorize-text"),t=c("./shaders").text,f=window||e.global||{},o=f.__TEXT_CACHE||{};f.__TEXT_CACHE={};var i=3;function g(u,_,s,A){this.gl=u,this.shader=_,this.buffer=s,this.vao=A,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var p=g.prototype,y=[0,0];p.bind=function(u,_,s,A){this.vao.bind(),this.shader.bind();var x=this.shader.uniforms;x.model=u,x.view=_,x.projection=s,x.pixelScale=A,y[0]=this.gl.drawingBufferWidth,y[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=y},p.unbind=function(){this.vao.unbind()},p.update=function(u,_,s,A,x){var v=[];function b(R,B,F,V,G,J){var j=o[F];j||(j=o[F]={});var Y=j[B];Y||(Y=j[B]=h(B,{triangles:!0,font:F,textAlign:"center",textBaseline:"middle",lineSpacing:G,styletags:J}));for(var X=(V||12)/12,oe=Y.positions,se=Y.cells,ie=0,N=se.length;ie<N;++ie)for(var U=se[ie],q=2;q>=0;--q){var Q=oe[U[q]];v.push(X*Q[0],-X*Q[1],R)}}for(var l=[0,0,0],L=[0,0,0],S=[0,0,0],k=[0,0,0],P=1.25,z={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},I=0;I<3;++I){S[I]=v.length/i|0,b(.5*(u[0][I]+u[1][I]),_[I],s[I],12,P,z),k[I]=(v.length/i|0)-S[I],l[I]=v.length/i|0;for(var D=0;D<A[I].length;++D)!A[I][D].text||b(A[I][D].x,A[I][D].text,A[I][D].font||x,A[I][D].fontSize||12,P,z);L[I]=(v.length/i|0)-l[I]}this.buffer.update(v),this.tickOffset=l,this.tickCount=L,this.labelOffset=S,this.labelCount=k},p.drawTicks=function(u,_,s,A,x,v,b,l){!this.tickCount[u]||(this.shader.uniforms.axis=v,this.shader.uniforms.color=x,this.shader.uniforms.angle=s,this.shader.uniforms.scale=_,this.shader.uniforms.offset=A,this.shader.uniforms.alignDir=b,this.shader.uniforms.alignOpt=l,this.vao.draw(this.gl.TRIANGLES,this.tickCount[u],this.tickOffset[u]))},p.drawLabel=function(u,_,s,A,x,v,b,l){!this.labelCount[u]||(this.shader.uniforms.axis=v,this.shader.uniforms.color=x,this.shader.uniforms.angle=s,this.shader.uniforms.scale=_,this.shader.uniforms.offset=A,this.shader.uniforms.alignDir=b,this.shader.uniforms.alignOpt=l,this.vao.draw(this.gl.TRIANGLES,this.labelCount[u],this.labelOffset[u]))},p.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()};function h(u,_){try{return r(u,_)}catch(s){return console.warn('error vectorizing text:"'+u+'" error:',s),{cells:[],positions:[]}}}function m(u,_,s,A,x,v){var b=a(u),l=n(u,[{buffer:b,size:3}]),L=t(u);L.attributes.position.location=0;var S=new g(u,L,b,l);return S.update(_,s,A,x,v),S}}).call(this)}).call(this,c("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(c,M,T){T.create=a,T.equal=n;function e(r,t){var f=r+"",o=f.indexOf("."),i=0;o>=0&&(i=f.length-o-1);var g=Math.pow(10,i),p=Math.round(r*t*g),y=p+"";if(y.indexOf("e")>=0)return y;var h=p/g,m=p%g;p<0?(h=-Math.ceil(h)|0,m=-m|0):(h=Math.floor(h)|0,m=m|0);var u=""+h;if(p<0&&(u="-"+u),i){for(var _=""+m;_.length<i;)_="0"+_;return u+"."+_}else return u}function a(r,t){for(var f=[],o=0;o<3;++o){var i=[];.5*(r[0][o]+r[1][o]);for(var g=0;g*t[o]<=r[1][o];++g)i.push({x:g*t[o],text:e(t[o],g)});for(var g=-1;g*t[o]>=r[0][o];--g)i.push({x:g*t[o],text:e(t[o],g)});f.push(i)}return f}function n(r,t){for(var f=0;f<3;++f){if(r[f].length!==t[f].length)return!1;for(var o=0;o<r[f].length;++o){var i=r[f][o],g=t[f][o];if(i.x!==g.x||i.text!==g.text||i.font!==g.font||i.fontColor!==g.fontColor||i.fontSize!==g.fontSize||i.dx!==g.dx||i.dy!==g.dy)return!1}}return!0}},{}],77:[function(c,M,T){M.exports=_;var e=c("extract-frustum-planes"),a=c("split-polygon"),n=c("./lib/cube.js"),r=c("gl-mat4/multiply"),t=c("gl-mat4/transpose"),f=c("gl-vec4/transformMat4"),o=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),i=new Float32Array(16);function g(s,A,x){this.lo=s,this.hi=A,this.pixelsPerDataUnit=x}var p=[0,0,0,1],y=[0,0,0,1];function h(s,A,x,v,b){for(var l=0;l<3;++l){for(var L=p,S=y,k=0;k<3;++k)S[k]=L[k]=x[k];S[3]=L[3]=1,S[l]+=1,f(S,S,A),S[3]<0&&(s[l]=1/0),L[l]-=1,f(L,L,A),L[3]<0&&(s[l]=1/0);var P=(L[0]/L[3]-S[0]/S[3])*v,z=(L[1]/L[3]-S[1]/S[3])*b;s[l]=.25*Math.sqrt(P*P+z*z)}return s}var m=[new g(1/0,-1/0,1/0),new g(1/0,-1/0,1/0),new g(1/0,-1/0,1/0)],u=[0,0,0];function _(s,A,x,v,z){var l=A.model||o,L=A.view||o,S=A.projection||o,k=A._ortho||!1,P=s.bounds,z=z||n(l,L,S,P,k),I=z.axis;r(i,L,l),r(i,S,i);for(var D=m,R=0;R<3;++R)D[R].lo=1/0,D[R].hi=-1/0,D[R].pixelsPerDataUnit=1/0;var B=e(t(i,i));t(i,i);for(var F=0;F<3;++F){var V=(F+1)%3,G=(F+2)%3,J=u;e:for(var R=0;R<2;++R){var j=[];if(I[F]<0!=!!R){J[F]=P[R][F];for(var Y=0;Y<2;++Y){J[V]=P[Y^R][V];for(var X=0;X<2;++X)J[G]=P[X^Y^R][G],j.push(J.slice())}for(var oe=k?5:4,Y=oe;Y===oe;++Y){if(j.length===0)continue e;j=a.positive(j,B[Y])}for(var Y=0;Y<j.length;++Y)for(var G=j[Y],se=h(u,i,G,x,v),X=0;X<3;++X)D[X].lo=Math.min(D[X].lo,G[X]),D[X].hi=Math.max(D[X].hi,G[X]),X!==F&&(D[X].pixelsPerDataUnit=Math.min(D[X].pixelsPerDataUnit,Math.abs(se[X])))}}}return D}},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(c,M,T){var e=c("typedarray-pool"),a=c("ndarray-ops"),n=c("ndarray"),r=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function t(y,h,m,u,_){this.gl=y,this.type=h,this.handle=m,this.length=u,this.usage=_}var f=t.prototype;f.bind=function(){this.gl.bindBuffer(this.type,this.handle)},f.unbind=function(){this.gl.bindBuffer(this.type,null)},f.dispose=function(){this.gl.deleteBuffer(this.handle)};function o(y,h,m,u,_,s){var A=_.length*_.BYTES_PER_ELEMENT;if(s<0)return y.bufferData(h,_,u),A;if(A+s>m)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return y.bufferSubData(h,s,_),m}function i(y,h){for(var m=e.malloc(y.length,h),u=y.length,_=0;_<u;++_)m[_]=y[_];return m}function g(y,h){for(var m=1,u=h.length-1;u>=0;--u){if(h[u]!==m)return!1;m*=y[u]}return!0}f.update=function(y,h){if(typeof h!="number"&&(h=-1),this.bind(),typeof y=="object"&&typeof y.shape!="undefined"){var m=y.dtype;if(r.indexOf(m)<0&&(m="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var u=gl.getExtension("OES_element_index_uint");u&&m!=="uint16"?m="uint32":m="uint16"}if(m===y.dtype&&g(y.shape,y.stride))y.offset===0&&y.data.length===y.shape[0]?this.length=o(this.gl,this.type,this.length,this.usage,y.data,h):this.length=o(this.gl,this.type,this.length,this.usage,y.data.subarray(y.offset,y.shape[0]),h);else{var _=e.malloc(y.size,m),s=n(_,y.shape);a.assign(s,y),h<0?this.length=o(this.gl,this.type,this.length,this.usage,_,h):this.length=o(this.gl,this.type,this.length,this.usage,_.subarray(0,y.size),h),e.free(_)}}else if(Array.isArray(y)){var A;this.type===this.gl.ELEMENT_ARRAY_BUFFER?A=i(y,"uint16"):A=i(y,"float32"),h<0?this.length=o(this.gl,this.type,this.length,this.usage,A,h):this.length=o(this.gl,this.type,this.length,this.usage,A.subarray(0,y.length),h),e.free(A)}else if(typeof y=="object"&&typeof y.length=="number")this.length=o(this.gl,this.type,this.length,this.usage,y,h);else if(typeof y=="number"||y===void 0){if(h>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");y=y|0,y<=0&&(y=1),this.gl.bufferData(this.type,y|0,this.usage),this.length=y}else throw new Error("gl-buffer: Invalid data type")};function p(y,h,m,u){if(m=m||y.ARRAY_BUFFER,u=u||y.DYNAMIC_DRAW,m!==y.ARRAY_BUFFER&&m!==y.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(u!==y.DYNAMIC_DRAW&&u!==y.STATIC_DRAW&&u!==y.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var _=y.createBuffer(),s=new t(y,m,_,0,u);return s.update(h),s}M.exports=p},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(c,M,T){var e=c("gl-vec3");M.exports=function(n,r){var t=n.positions,f=n.vectors,o={positions:[],vertexIntensity:[],vertexIntensityBounds:n.vertexIntensityBounds,vectors:[],cells:[],coneOffset:n.coneOffset,colormap:n.colormap};if(n.positions.length===0)return r&&(r[0]=[0,0,0],r[1]=[0,0,0]),o;for(var i=0,g=1/0,p=-1/0,y=1/0,h=-1/0,m=1/0,u=-1/0,_=null,s=null,A=[],x=1/0,v=!1,b=0;b<t.length;b++){var l=t[b];g=Math.min(l[0],g),p=Math.max(l[0],p),y=Math.min(l[1],y),h=Math.max(l[1],h),m=Math.min(l[2],m),u=Math.max(l[2],u);var L=f[b];if(e.length(L)>i&&(i=e.length(L)),b){var S=2*e.distance(_,l)/(e.length(s)+e.length(L));S?(x=Math.min(x,S),v=!1):v=!0}v||(_=l,s=L),A.push(L)}var k=[g,y,m],P=[p,h,u];r&&(r[0]=k,r[1]=P),i===0&&(i=1);var z=1/i;isFinite(x)||(x=1),o.vectorScale=x;var I=n.coneSize||.5;n.absoluteConeSize&&(I=n.absoluteConeSize*z),o.coneScale=I;for(var b=0,D=0;b<t.length;b++)for(var l=t[b],R=l[0],B=l[1],F=l[2],V=A[b],G=e.length(V)*z,J=0,j=8;J<j;J++){o.positions.push([R,B,F,D++]),o.positions.push([R,B,F,D++]),o.positions.push([R,B,F,D++]),o.positions.push([R,B,F,D++]),o.positions.push([R,B,F,D++]),o.positions.push([R,B,F,D++]),o.vectors.push(V),o.vectors.push(V),o.vectors.push(V),o.vectors.push(V),o.vectors.push(V),o.vectors.push(V),o.vertexIntensity.push(G,G,G),o.vertexIntensity.push(G,G,G);var Y=o.positions.length;o.cells.push([Y-6,Y-5,Y-4],[Y-3,Y-2,Y-1])}return o};var a=c("./lib/shaders");M.exports.createMesh=c("./create_mesh"),M.exports.createConeMesh=function(n,r){return M.exports.createMesh(n,r,{shaders:a,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(c,M,T){var e=c("gl-shader"),a=c("gl-buffer"),n=c("gl-vao"),r=c("gl-texture2d"),t=c("gl-mat4/multiply"),f=c("gl-mat4/invert"),o=c("ndarray"),i=c("colormap"),g=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function p(A,x,v,b,l,L,S,k,P,z,I){this.gl=A,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=x,this.dirty=!0,this.triShader=v,this.pickShader=b,this.trianglePositions=l,this.triangleVectors=L,this.triangleColors=k,this.triangleUVs=P,this.triangleIds=S,this.triangleVAO=z,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=I,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=g,this._view=g,this._projection=g,this._resolution=[1,1]}var y=p.prototype;y.isOpaque=function(){return this.opacity>=1},y.isTransparent=function(){return this.opacity<1},y.pickSlots=1,y.setPickBase=function(A){this.pickId=A};function h(A){for(var x=i({colormap:A,nshades:256,format:"rgba"}),v=new Uint8Array(256*4),b=0;b<256;++b){for(var l=x[b],L=0;L<3;++L)v[4*b+L]=l[L];v[4*b+3]=l[3]*255}return o(v,[256,256,4],[4,0,1])}function m(A){for(var x=A.length,v=new Array(x),b=0;b<x;++b)v[b]=A[b][2];return v}y.update=function(A){A=A||{};var x=this.gl;this.dirty=!0,"lightPosition"in A&&(this.lightPosition=A.lightPosition),"opacity"in A&&(this.opacity=A.opacity),"ambient"in A&&(this.ambientLight=A.ambient),"diffuse"in A&&(this.diffuseLight=A.diffuse),"specular"in A&&(this.specularLight=A.specular),"roughness"in A&&(this.roughness=A.roughness),"fresnel"in A&&(this.fresnel=A.fresnel),A.tubeScale!==void 0&&(this.tubeScale=A.tubeScale),A.vectorScale!==void 0&&(this.vectorScale=A.vectorScale),A.coneScale!==void 0&&(this.coneScale=A.coneScale),A.coneOffset!==void 0&&(this.coneOffset=A.coneOffset),A.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=x.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=x.LINEAR,this.texture.setPixels(h(A.colormap)),this.texture.generateMipmap());var v=A.cells,b=A.positions,l=A.vectors;if(!b||!v||!l)return;var L=[],S=[],k=[],P=[],z=[];this.cells=v,this.positions=b,this.vectors=l;var I=A.meshColor||[1,1,1,1],D=A.vertexIntensity,R=1/0,B=-1/0;if(D)if(A.vertexIntensityBounds)R=+A.vertexIntensityBounds[0],B=+A.vertexIntensityBounds[1];else for(var F=0;F<D.length;++F){var V=D[F];R=Math.min(R,V),B=Math.max(B,V)}else for(var F=0;F<b.length;++F){var V=b[F][2];R=Math.min(R,V),B=Math.max(B,V)}D?this.intensity=D:this.intensity=m(b),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var F=0;F<b.length;++F)for(var G=b[F],J=0;J<3;++J)isNaN(G[J])||!isFinite(G[J])||(this.bounds[0][J]=Math.min(this.bounds[0][J],G[J]),this.bounds[1][J]=Math.max(this.bounds[1][J],G[J]));var j=0;e:for(var F=0;F<v.length;++F){var Y=v[F];switch(Y.length){case 3:for(var J=0;J<3;++J)for(var X=Y[J],G=b[X],oe=0;oe<3;++oe)if(isNaN(G[oe])||!isFinite(G[oe]))continue e;for(var J=0;J<3;++J){var X=Y[2-J],G=b[X];L.push(G[0],G[1],G[2],G[3]);var se=l[X];S.push(se[0],se[1],se[2],se[3]||0);var ie=I;ie.length===3?k.push(ie[0],ie[1],ie[2],1):k.push(ie[0],ie[1],ie[2],ie[3]);var N;D?N=[(D[X]-R)/(B-R),0]:N=[(G[2]-R)/(B-R),0],P.push(N[0],N[1]),z.push(F)}j+=1;break}}this.triangleCount=j,this.trianglePositions.update(L),this.triangleVectors.update(S),this.triangleColors.update(k),this.triangleUVs.update(P),this.triangleIds.update(new Uint32Array(z))},y.drawTransparent=y.draw=function(A){A=A||{};for(var x=this.gl,v=A.model||g,b=A.view||g,l=A.projection||g,L=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],S=0;S<3;++S)L[0][S]=Math.max(L[0][S],this.clipBounds[0][S]),L[1][S]=Math.min(L[1][S],this.clipBounds[1][S]);var k={model:v,view:b,projection:l,inverseModel:g.slice(),clipBounds:L,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};k.inverseModel=f(k.inverseModel,k.model),x.disable(x.CULL_FACE),this.texture.bind(0);var P=new Array(16);t(P,k.view,k.model),t(P,k.projection,P),f(P,P);for(var S=0;S<3;++S)k.eyePosition[S]=P[12+S]/P[15];for(var z=P[15],S=0;S<3;++S)z+=this.lightPosition[S]*P[4*S+3];for(var S=0;S<3;++S){for(var I=P[12+S],D=0;D<3;++D)I+=P[4*D+S]*this.lightPosition[D];k.lightPosition[S]=I/z}if(this.triangleCount>0){var R=this.triShader;R.bind(),R.uniforms=k,this.triangleVAO.bind(),x.drawArrays(x.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}},y.drawPick=function(A){A=A||{};for(var x=this.gl,v=A.model||g,b=A.view||g,l=A.projection||g,L=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],S=0;S<3;++S)L[0][S]=Math.max(L[0][S],this.clipBounds[0][S]),L[1][S]=Math.min(L[1][S],this.clipBounds[1][S]);this._model=[].slice.call(v),this._view=[].slice.call(b),this._projection=[].slice.call(l),this._resolution=[x.drawingBufferWidth,x.drawingBufferHeight];var k={model:v,view:b,projection:l,clipBounds:L,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},P=this.pickShader;P.bind(),P.uniforms=k,this.triangleCount>0&&(this.triangleVAO.bind(),x.drawArrays(x.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind())},y.pick=function(A){if(!A||A.id!==this.pickId)return null;var x=A.value[0]+256*A.value[1]+65536*A.value[2],v=this.cells[x],b=this.positions[v[1]].slice(0,3),l={position:b,dataCoordinate:b,index:Math.floor(v[1]/48)};return this.traceType==="cone"?l.index=Math.floor(v[1]/48):this.traceType==="streamtube"&&(l.intensity=this.intensity[v[1]],l.velocity=this.vectors[v[1]].slice(0,3),l.divergence=this.vectors[v[1]][3],l.index=x),l},y.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()};function u(A,x){var v=e(A,x.meshShader.vertex,x.meshShader.fragment,null,x.meshShader.attributes);return v.attributes.position.location=0,v.attributes.color.location=2,v.attributes.uv.location=3,v.attributes.vector.location=4,v}function _(A,x){var v=e(A,x.pickShader.vertex,x.pickShader.fragment,null,x.pickShader.attributes);return v.attributes.position.location=0,v.attributes.id.location=1,v.attributes.vector.location=4,v}function s(A,x,v){var b=v.shaders;arguments.length===1&&(x=A,A=x.gl);var l=u(A,b),L=_(A,b),S=r(A,o(new Uint8Array([255,255,255,255]),[1,1,4]));S.generateMipmap(),S.minFilter=A.LINEAR_MIPMAP_LINEAR,S.magFilter=A.LINEAR;var k=a(A),P=a(A),z=a(A),I=a(A),D=a(A),R=n(A,[{buffer:k,type:A.FLOAT,size:4},{buffer:D,type:A.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:z,type:A.FLOAT,size:4},{buffer:I,type:A.FLOAT,size:2},{buffer:P,type:A.FLOAT,size:4}]),B=new p(A,S,l,L,k,P,D,z,I,R,v.traceType||"cone");return B.update(x),B}M.exports=s},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(c,M,T){var e=c("glslify"),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),r=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);T.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},T.pickShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(c,M,T){M.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(c,M,T){var e=c("./1.0/numbers");M.exports=function(n){return e[n]}},{"./1.0/numbers":82}],84:[function(c,M,T){M.exports=p;var e=c("gl-buffer"),a=c("gl-vao"),n=c("./shaders/index"),r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(y,h,m,u){this.gl=y,this.shader=u,this.buffer=h,this.vao=m,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var f=t.prototype;f.isOpaque=function(){return!this.hasAlpha},f.isTransparent=function(){return this.hasAlpha},f.drawTransparent=f.draw=function(y){var h=this.gl,m=this.shader.uniforms;this.shader.bind();var u=m.view=y.view||r,_=m.projection=y.projection||r;m.model=y.model||r,m.clipBounds=this.clipBounds,m.opacity=this.opacity;var s=u[12],A=u[13],x=u[14],v=u[15],b=y._ortho||!1,l=b?2:1,L=l*this.pixelRatio*(_[3]*s+_[7]*A+_[11]*x+_[15]*v)/h.drawingBufferHeight;this.vao.bind();for(var S=0;S<3;++S)h.lineWidth(this.lineWidth[S]*this.pixelRatio),m.capSize=this.capSize[S]*L,this.lineCount[S]&&h.drawArrays(h.LINES,this.lineOffset[S],this.lineCount[S]);this.vao.unbind()};function o(y,h){for(var m=0;m<3;++m)y[0][m]=Math.min(y[0][m],h[m]),y[1][m]=Math.max(y[1][m],h[m])}var i=function(){for(var y=new Array(3),h=0;h<3;++h){for(var m=[],u=1;u<=2;++u)for(var _=-1;_<=1;_+=2){var s=(u+h)%3,A=[0,0,0];A[s]=_,m.push(A)}y[h]=m}return y}();function g(y,h,m,u){for(var _=i[u],s=0;s<_.length;++s){var A=_[s];y.push(h[0],h[1],h[2],m[0],m[1],m[2],m[3],A[0],A[1],A[2])}return _.length}f.update=function(y){y=y||{},"lineWidth"in y&&(this.lineWidth=y.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in y&&(this.capSize=y.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in y&&(this.opacity=+y.opacity,this.opacity<1&&(this.hasAlpha=!0));var h=y.color||[[0,0,0],[0,0,0],[0,0,0]],m=y.position,u=y.error;if(Array.isArray(h[0])||(h=[h,h,h]),m&&u){var _=[],s=m.length,A=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var x=0;x<3;++x){this.lineOffset[x]=A;e:for(var v=0;v<s;++v){for(var b=m[v],l=0;l<3;++l)if(isNaN(b[l])||!isFinite(b[l]))continue e;var L=u[v],S=h[x];if(Array.isArray(S[0])&&(S=h[v]),S.length===3?S=[S[0],S[1],S[2],1]:S.length===4&&(S=[S[0],S[1],S[2],S[3]],!this.hasAlpha&&S[3]<1&&(this.hasAlpha=!0)),!(isNaN(L[0][x])||isNaN(L[1][x]))){if(L[0][x]<0){var k=b.slice();k[x]+=L[0][x],_.push(b[0],b[1],b[2],S[0],S[1],S[2],S[3],0,0,0,k[0],k[1],k[2],S[0],S[1],S[2],S[3],0,0,0),o(this.bounds,k),A+=2+g(_,k,S,x)}if(L[1][x]>0){var k=b.slice();k[x]+=L[1][x],_.push(b[0],b[1],b[2],S[0],S[1],S[2],S[3],0,0,0,k[0],k[1],k[2],S[0],S[1],S[2],S[3],0,0,0),o(this.bounds,k),A+=2+g(_,k,S,x)}}}this.lineCount[x]=A-this.lineOffset[x]}this.buffer.update(_)}},f.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()};function p(y){var h=y.gl,m=e(h),u=a(h,[{buffer:m,type:h.FLOAT,size:3,offset:0,stride:40},{buffer:m,type:h.FLOAT,size:4,offset:12,stride:40},{buffer:m,type:h.FLOAT,size:3,offset:28,stride:40}]),_=n(h);_.attributes.position.location=0,_.attributes.color.location=1,_.attributes.offset.location=2;var s=new t(h,m,u,_);return s.update(y),s}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(c,M,T){var e=c("glslify"),a=c("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);M.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(c,M,T){var e=c("gl-texture2d");M.exports=A;var a=null,n,r,t,f;function o(x){var v=x.getParameter(x.FRAMEBUFFER_BINDING),b=x.getParameter(x.RENDERBUFFER_BINDING),l=x.getParameter(x.TEXTURE_BINDING_2D);return[v,b,l]}function i(x,v){x.bindFramebuffer(x.FRAMEBUFFER,v[0]),x.bindRenderbuffer(x.RENDERBUFFER,v[1]),x.bindTexture(x.TEXTURE_2D,v[2])}function g(x,v){var b=x.getParameter(v.MAX_COLOR_ATTACHMENTS_WEBGL);a=new Array(b+1);for(var l=0;l<=b;++l){for(var L=new Array(b),S=0;S<l;++S)L[S]=x.COLOR_ATTACHMENT0+S;for(var S=l;S<b;++S)L[S]=x.NONE;a[l]=L}}function p(x){switch(x){case n:throw new Error("gl-fbo: Framebuffer unsupported");case r:throw new Error("gl-fbo: Framebuffer incomplete attachment");case t:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case f:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function y(x,v,b,l,L,S){if(!l)return null;var k=e(x,v,b,L,l);return k.magFilter=x.NEAREST,k.minFilter=x.NEAREST,k.mipSamples=1,k.bind(),x.framebufferTexture2D(x.FRAMEBUFFER,S,x.TEXTURE_2D,k.handle,0),k}function h(x,v,b,l,L){var S=x.createRenderbuffer();return x.bindRenderbuffer(x.RENDERBUFFER,S),x.renderbufferStorage(x.RENDERBUFFER,l,v,b),x.framebufferRenderbuffer(x.FRAMEBUFFER,L,x.RENDERBUFFER,S),S}function m(x){var v=o(x.gl),b=x.gl,l=x.handle=b.createFramebuffer(),L=x._shape[0],S=x._shape[1],k=x.color.length,P=x._ext,z=x._useStencil,I=x._useDepth,D=x._colorType;b.bindFramebuffer(b.FRAMEBUFFER,l);for(var R=0;R<k;++R)x.color[R]=y(b,L,S,D,b.RGBA,b.COLOR_ATTACHMENT0+R);k===0?(x._color_rb=h(b,L,S,b.RGBA4,b.COLOR_ATTACHMENT0),P&&P.drawBuffersWEBGL(a[0])):k>1&&P.drawBuffersWEBGL(a[k]);var B=b.getExtension("WEBGL_depth_texture");B?z?x.depth=y(b,L,S,B.UNSIGNED_INT_24_8_WEBGL,b.DEPTH_STENCIL,b.DEPTH_STENCIL_ATTACHMENT):I&&(x.depth=y(b,L,S,b.UNSIGNED_SHORT,b.DEPTH_COMPONENT,b.DEPTH_ATTACHMENT)):I&&z?x._depth_rb=h(b,L,S,b.DEPTH_STENCIL,b.DEPTH_STENCIL_ATTACHMENT):I?x._depth_rb=h(b,L,S,b.DEPTH_COMPONENT16,b.DEPTH_ATTACHMENT):z&&(x._depth_rb=h(b,L,S,b.STENCIL_INDEX,b.STENCIL_ATTACHMENT));var F=b.checkFramebufferStatus(b.FRAMEBUFFER);if(F!==b.FRAMEBUFFER_COMPLETE){x._destroyed=!0,b.bindFramebuffer(b.FRAMEBUFFER,null),b.deleteFramebuffer(x.handle),x.handle=null,x.depth&&(x.depth.dispose(),x.depth=null),x._depth_rb&&(b.deleteRenderbuffer(x._depth_rb),x._depth_rb=null);for(var R=0;R<x.color.length;++R)x.color[R].dispose(),x.color[R]=null;x._color_rb&&(b.deleteRenderbuffer(x._color_rb),x._color_rb=null),i(b,v),p(F)}i(b,v)}function u(x,v,b,l,L,S,k,P){this.gl=x,this._shape=[v|0,b|0],this._destroyed=!1,this._ext=P,this.color=new Array(L);for(var z=0;z<L;++z)this.color[z]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=l,this._useDepth=S,this._useStencil=k;var I=this,D=[v|0,b|0];Object.defineProperties(D,{0:{get:function(){return I._shape[0]},set:function(R){return I.width=R}},1:{get:function(){return I._shape[1]},set:function(R){return I.height=R}}}),this._shapeVector=D,m(this)}var _=u.prototype;function s(x,v,b){if(x._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(!(x._shape[0]===v&&x._shape[1]===b)){var l=x.gl,L=l.getParameter(l.MAX_RENDERBUFFER_SIZE);if(v<0||v>L||b<0||b>L)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");x._shape[0]=v,x._shape[1]=b;for(var S=o(l),k=0;k<x.color.length;++k)x.color[k].shape=x._shape;x._color_rb&&(l.bindRenderbuffer(l.RENDERBUFFER,x._color_rb),l.renderbufferStorage(l.RENDERBUFFER,l.RGBA4,x._shape[0],x._shape[1])),x.depth&&(x.depth.shape=x._shape),x._depth_rb&&(l.bindRenderbuffer(l.RENDERBUFFER,x._depth_rb),x._useDepth&&x._useStencil?l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_STENCIL,x._shape[0],x._shape[1]):x._useDepth?l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_COMPONENT16,x._shape[0],x._shape[1]):x._useStencil&&l.renderbufferStorage(l.RENDERBUFFER,l.STENCIL_INDEX,x._shape[0],x._shape[1])),l.bindFramebuffer(l.FRAMEBUFFER,x.handle);var P=l.checkFramebufferStatus(l.FRAMEBUFFER);P!==l.FRAMEBUFFER_COMPLETE&&(x.dispose(),i(l,S),p(P)),i(l,S)}}Object.defineProperties(_,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(x){if(Array.isArray(x)||(x=[x|0,x|0]),x.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var v=x[0]|0,b=x[1]|0;return s(this,v,b),[v,b]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(x){return x=x|0,s(this,x,this._shape[1]),x},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(x){return x=x|0,s(this,this._shape[0],x),x},enumerable:!1}}),_.bind=function(){if(!this._destroyed){var x=this.gl;x.bindFramebuffer(x.FRAMEBUFFER,this.handle),x.viewport(0,0,this._shape[0],this._shape[1])}},_.dispose=function(){if(!this._destroyed){this._destroyed=!0;var x=this.gl;x.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(x.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var v=0;v<this.color.length;++v)this.color[v].dispose(),this.color[v]=null;this._color_rb&&(x.deleteRenderbuffer(this._color_rb),this._color_rb=null)}};function A(x,v,b,l){n||(n=x.FRAMEBUFFER_UNSUPPORTED,r=x.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,t=x.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,f=x.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var L=x.getExtension("WEBGL_draw_buffers");if(!a&&L&&g(x,L),Array.isArray(v)&&(l=b,b=v[1]|0,v=v[0]|0),typeof v!="number")throw new Error("gl-fbo: Missing shape parameter");var S=x.getParameter(x.MAX_RENDERBUFFER_SIZE);if(v<0||v>S||b<0||b>S)throw new Error("gl-fbo: Parameters are too large for FBO");l=l||{};var k=1;if("color"in l){if(k=Math.max(l.color|0,0),k<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(k>1)if(L){if(k>x.getParameter(L.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+k+" draw buffers")}else throw new Error("gl-fbo: Multiple draw buffer extension not supported")}var P=x.UNSIGNED_BYTE,z=x.getExtension("OES_texture_float");if(l.float&&k>0){if(!z)throw new Error("gl-fbo: Context does not support floating point textures");P=x.FLOAT}else l.preferFloat&&k>0&&z&&(P=x.FLOAT);var I=!0;"depth"in l&&(I=!!l.depth);var D=!1;return"stencil"in l&&(D=!!l.stencil),new u(x,v,b,P,k,I,D,L)}},{"gl-texture2d":146}],87:[function(c,M,T){var e=c("sprintf-js").sprintf,a=c("gl-constants/lookup"),n=c("glsl-shader-name"),r=c("add-line-numbers");M.exports=t;function t(f,o,i){var g=n(o)||"of unknown name (see npm glsl-shader-name)",p="unknown type";i!==void 0&&(p=i===a.FRAGMENT_SHADER?"fragment":"vertex");for(var y=e(`Error compiling %s shader %s:
`,p,g),h=e("%s%s",y,f),m=f.split(`
`),u={},_=0;_<m.length;_++){var s=m[_];if(!(s===""||s==="\0")){var A=parseInt(s.split(":")[2]);if(isNaN(A))throw new Error(e("Could not parse error: %s",s));u[A]=s}}for(var x=r(o).split(`
`),_=0;_<x.length;_++)if(!(!u[_+3]&&!u[_+2]&&!u[_+1])){var v=x[_];if(y+=v+`
`,u[_+1]){var b=u[_+1];b=b.substr(b.split(":",3).join(":").length+1).trim(),y+=e(`^^^ %s

`,b)}}return{long:y.trim(),short:h.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(c,M,T){M.exports=p;var e=c("binary-search-bounds"),a=c("iota-array"),n=c("typedarray-pool"),r=c("gl-shader"),t=c("gl-buffer"),f=c("./lib/shaders");function o(y,h,m,u,_,s,A){this.plot=y,this.shader=h,this.pickShader=m,this.positionBuffer=u,this.weightBuffer=_,this.colorBuffer=s,this.idBuffer=A,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var i=o.prototype,g=[0,0,1,0,0,1,1,0,1,1,0,1];i.draw=function(){var y=[1,0,0,0,1,0,0,0,1];return function(){var h=this.plot,m=this.shader,u=this.bounds,_=this.numVertices;if(!(_<=0)){var s=h.gl,A=h.dataBox,x=u[2]-u[0],v=u[3]-u[1],b=A[2]-A[0],l=A[3]-A[1];y[0]=2*x/b,y[4]=2*v/l,y[6]=2*(u[0]-A[0])/b-1,y[7]=2*(u[1]-A[1])/l-1,m.bind();var L=m.uniforms;L.viewTransform=y,L.shape=this.shape;var S=m.attributes;this.positionBuffer.bind(),S.position.pointer(),this.weightBuffer.bind(),S.weight.pointer(s.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),S.color.pointer(s.UNSIGNED_BYTE,!0),s.drawArrays(s.TRIANGLES,0,_)}}}(),i.drawPick=function(){var y=[1,0,0,0,1,0,0,0,1],h=[0,0,0,0];return function(m){var u=this.plot,_=this.pickShader,s=this.bounds,A=this.numVertices;if(!(A<=0)){var x=u.gl,v=u.dataBox,b=s[2]-s[0],l=s[3]-s[1],L=v[2]-v[0],S=v[3]-v[1];y[0]=2*b/L,y[4]=2*l/S,y[6]=2*(s[0]-v[0])/L-1,y[7]=2*(s[1]-v[1])/S-1;for(var k=0;k<4;++k)h[k]=m>>k*8&255;this.pickOffset=m,_.bind();var P=_.uniforms;P.viewTransform=y,P.pickOffset=h,P.shape=this.shape;var z=_.attributes;return this.positionBuffer.bind(),z.position.pointer(),this.weightBuffer.bind(),z.weight.pointer(x.UNSIGNED_BYTE,!1),this.idBuffer.bind(),z.pickId.pointer(x.UNSIGNED_BYTE,!1),x.drawArrays(x.TRIANGLES,0,A),m+this.shape[0]*this.shape[1]}}}(),i.pick=function(y,h,m){var u=this.pickOffset,_=this.shape[0]*this.shape[1];if(m<u||m>=u+_)return null;var s=m-u,A=this.xData,x=this.yData;return{object:this,pointId:s,dataCoord:[A[s%this.shape[0]],x[s/this.shape[0]|0]]}},i.update=function(y){y=y||{};var h=y.shape||[0,0],m=y.x||a(h[0]),u=y.y||a(h[1]),_=y.z||new Float32Array(h[0]*h[1]),s=y.zsmooth!==!1;this.xData=m,this.yData=u;var A=y.colorLevels||[0],x=y.colorValues||[0,0,0,1],v=A.length,b=this.bounds,l,L,S,k;s?(l=b[0]=m[0],L=b[1]=u[0],S=b[2]=m[m.length-1],k=b[3]=u[u.length-1]):(l=b[0]=m[0]+(m[1]-m[0])/2,L=b[1]=u[0]+(u[1]-u[0])/2,S=b[2]=m[m.length-1]+(m[m.length-1]-m[m.length-2])/2,k=b[3]=u[u.length-1]+(u[u.length-1]-u[u.length-2])/2);var P=1/(S-l),z=1/(k-L),I=h[0],D=h[1];this.shape=[I,D];var R=(s?(I-1)*(D-1):I*D)*(g.length>>>1);this.numVertices=R;for(var B=n.mallocUint8(R*4),F=n.mallocFloat32(R*2),V=n.mallocUint8(R*2),G=n.mallocUint32(R),J=0,j=s?I-1:I,Y=s?D-1:D,X=0;X<Y;++X){var oe,se;s?(oe=z*(u[X]-L),se=z*(u[X+1]-L)):(oe=X<D-1?z*(u[X]-(u[X+1]-u[X])/2-L):z*(u[X]-(u[X]-u[X-1])/2-L),se=X<D-1?z*(u[X]+(u[X+1]-u[X])/2-L):z*(u[X]+(u[X]-u[X-1])/2-L));for(var ie=0;ie<j;++ie){var N,U;s?(N=P*(m[ie]-l),U=P*(m[ie+1]-l)):(N=ie<I-1?P*(m[ie]-(m[ie+1]-m[ie])/2-l):P*(m[ie]-(m[ie]-m[ie-1])/2-l),U=ie<I-1?P*(m[ie]+(m[ie+1]-m[ie])/2-l):P*(m[ie]+(m[ie]-m[ie-1])/2-l));for(var q=0;q<g.length;q+=2){var Q=g[q],W=g[q+1],Z=s?(X+W)*I+(ie+Q):X*I+ie,ee=_[Z],te=e.le(A,ee),ae,le,ye,fe;if(te<0)ae=x[0],le=x[1],ye=x[2],fe=x[3];else if(te===v-1)ae=x[4*v-4],le=x[4*v-3],ye=x[4*v-2],fe=x[4*v-1];else{var pe=(ee-A[te])/(A[te+1]-A[te]),ge=1-pe,Ae=4*te,we=4*(te+1);ae=ge*x[Ae]+pe*x[we],le=ge*x[Ae+1]+pe*x[we+1],ye=ge*x[Ae+2]+pe*x[we+2],fe=ge*x[Ae+3]+pe*x[we+3]}B[4*J]=255*ae,B[4*J+1]=255*le,B[4*J+2]=255*ye,B[4*J+3]=255*fe,F[2*J]=N*.5+U*.5,F[2*J+1]=oe*.5+se*.5,V[2*J]=Q,V[2*J+1]=W,G[J]=X*I+ie,J+=1}}}this.positionBuffer.update(F),this.weightBuffer.update(V),this.colorBuffer.update(B),this.idBuffer.update(G),n.free(F),n.free(B),n.free(V),n.free(G)},i.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)};function p(y,h){var m=y.gl,u=r(m,f.vertex,f.fragment),_=r(m,f.pickVertex,f.pickFragment),s=t(m),A=t(m),x=t(m),v=t(m),b=new o(y,u,_,s,A,x,v);return b.update(h),y.addObject(b),b}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(c,M,T){var e=c("glslify");M.exports={fragment:e([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:231}],90:[function(c,M,T){var e=c("glslify"),a=c("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),f=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];T.createShader=function(o){return a(o,n,r,null,f)},T.createPickShader=function(o){return a(o,n,t,null,f)}},{"gl-shader":132,glslify:231}],91:[function(c,M,T){M.exports=x;var e=c("gl-buffer"),a=c("gl-vao"),n=c("gl-texture2d"),r=new Uint8Array(4),t=new Float32Array(r.buffer);function f(v,b,l,L){return r[0]=L,r[1]=l,r[2]=b,r[3]=v,t[0]}var o=c("binary-search-bounds"),i=c("ndarray"),g=c("./lib/shaders"),p=g.createShader,y=g.createPickShader,h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function m(v,b){for(var l=0,L=0;L<3;++L){var S=v[L]-b[L];l+=S*S}return Math.sqrt(l)}function u(v){for(var b=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],l=0;l<3;++l)b[0][l]=Math.max(v[0][l],b[0][l]),b[1][l]=Math.min(v[1][l],b[1][l]);return b}function _(v,b,l,L){this.arcLength=v,this.position=b,this.index=l,this.dataCoordinate=L}function s(v,b,l,L,S,k){this.gl=v,this.shader=b,this.pickShader=l,this.buffer=L,this.vao=S,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=k,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var A=s.prototype;A.isTransparent=function(){return this.hasAlpha},A.isOpaque=function(){return!this.hasAlpha},A.pickSlots=1,A.setPickBase=function(v){this.pickId=v},A.drawTransparent=A.draw=function(v){if(!!this.vertexCount){var b=this.gl,l=this.shader,L=this.vao;l.bind(),l.uniforms={model:v.model||h,view:v.view||h,projection:v.projection||h,clipBounds:u(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},L.bind(),L.draw(b.TRIANGLE_STRIP,this.vertexCount),L.unbind()}},A.drawPick=function(v){if(!!this.vertexCount){var b=this.gl,l=this.pickShader,L=this.vao;l.bind(),l.uniforms={model:v.model||h,view:v.view||h,projection:v.projection||h,pickId:this.pickId,clipBounds:u(this.clipBounds),screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},L.bind(),L.draw(b.TRIANGLE_STRIP,this.vertexCount),L.unbind()}},A.update=function(v){var b,l;this.dirty=!0;var L=!!v.connectGaps;"dashScale"in v&&(this.dashScale=v.dashScale),this.hasAlpha=!1,"opacity"in v&&(this.opacity=+v.opacity,this.opacity<1&&(this.hasAlpha=!0));var S=[],k=[],P=[],z=0,I=0,D=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],R=v.position||v.positions;if(R){var B=v.color||v.colors||[0,0,0,1],F=v.lineWidth||1,V=!1;e:for(b=1;b<R.length;++b){var G=R[b-1],J=R[b];for(k.push(z),P.push(G.slice()),l=0;l<3;++l){if(isNaN(G[l])||isNaN(J[l])||!isFinite(G[l])||!isFinite(J[l])){if(!L&&S.length>0){for(var j=0;j<24;++j)S.push(S[S.length-12]);I+=2,V=!0}continue e}D[0][l]=Math.min(D[0][l],G[l],J[l]),D[1][l]=Math.max(D[1][l],G[l],J[l])}var Y,X;Array.isArray(B[0])?(Y=B.length>b-1?B[b-1]:B.length>0?B[B.length-1]:[0,0,0,1],X=B.length>b?B[b]:B.length>0?B[B.length-1]:[0,0,0,1]):Y=X=B,Y.length===3&&(Y=[Y[0],Y[1],Y[2],1]),X.length===3&&(X=[X[0],X[1],X[2],1]),!this.hasAlpha&&Y[3]<1&&(this.hasAlpha=!0);var oe;Array.isArray(F)?oe=F.length>b-1?F[b-1]:F.length>0?F[F.length-1]:[0,0,0,1]:oe=F;var se=z;if(z+=m(G,J),V){for(l=0;l<2;++l)S.push(G[0],G[1],G[2],J[0],J[1],J[2],se,oe,Y[0],Y[1],Y[2],Y[3]);I+=2,V=!1}S.push(G[0],G[1],G[2],J[0],J[1],J[2],se,oe,Y[0],Y[1],Y[2],Y[3],G[0],G[1],G[2],J[0],J[1],J[2],se,-oe,Y[0],Y[1],Y[2],Y[3],J[0],J[1],J[2],G[0],G[1],G[2],z,-oe,X[0],X[1],X[2],X[3],J[0],J[1],J[2],G[0],G[1],G[2],z,oe,X[0],X[1],X[2],X[3]),I+=4}}if(this.buffer.update(S),k.push(z),P.push(R[R.length-1].slice()),this.bounds=D,this.vertexCount=I,this.points=P,this.arcLength=k,"dashes"in v){var ie=v.dashes,N=ie.slice();for(N.unshift(0),b=1;b<N.length;++b)N[b]=N[b-1]+N[b];var U=i(new Array(256*4),[256,1,4]);for(b=0;b<256;++b){for(l=0;l<4;++l)U.set(b,0,l,0);o.le(N,N[N.length-1]*b/255)&1?U.set(b,0,0,0):U.set(b,0,0,255)}this.texture.setPixels(U)}},A.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},A.pick=function(v){if(!v||v.id!==this.pickId)return null;var b=f(v.value[0],v.value[1],v.value[2],0),l=o.le(this.arcLength,b);if(l<0)return null;if(l===this.arcLength.length-1)return new _(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),l);for(var L=this.points[l],S=this.points[Math.min(l+1,this.points.length-1)],k=(b-this.arcLength[l])/(this.arcLength[l+1]-this.arcLength[l]),P=1-k,z=[0,0,0],I=0;I<3;++I)z[I]=P*L[I]+k*S[I];var D=Math.min(k<.5?l:l+1,this.points.length-1);return new _(b,z,D,this.points[D])};function x(v){var b=v.gl||v.scene&&v.scene.gl,l=p(b);l.attributes.position.location=0,l.attributes.nextPosition.location=1,l.attributes.arcLength.location=2,l.attributes.lineWidth.location=3,l.attributes.color.location=4;var L=y(b);L.attributes.position.location=0,L.attributes.nextPosition.location=1,L.attributes.arcLength.location=2,L.attributes.lineWidth.location=3,L.attributes.color.location=4;for(var S=e(b),k=a(b,[{buffer:S,size:3,offset:0,stride:48},{buffer:S,size:3,offset:12,stride:48},{buffer:S,size:1,offset:24,stride:48},{buffer:S,size:1,offset:28,stride:48},{buffer:S,size:4,offset:32,stride:48}]),P=i(new Array(256*4),[256,1,4]),z=0;z<256*4;++z)P.data[z]=255;var I=n(b,P);I.wrap=b.REPEAT;var D=new s(b,l,L,S,k,I);return D.update(v),D}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(c,M,T){M.exports=e;function e(a){var n=new Float32Array(16);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n[4]=a[4],n[5]=a[5],n[6]=a[6],n[7]=a[7],n[8]=a[8],n[9]=a[9],n[10]=a[10],n[11]=a[11],n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15],n}},{}],93:[function(c,M,T){M.exports=e;function e(){var a=new Float32Array(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],94:[function(c,M,T){M.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],f=a[3],o=a[4],i=a[5],g=a[6],p=a[7],y=a[8],h=a[9],m=a[10],u=a[11],_=a[12],s=a[13],A=a[14],x=a[15],v=n*i-r*o,b=n*g-t*o,l=n*p-f*o,L=r*g-t*i,S=r*p-f*i,k=t*p-f*g,P=y*s-h*_,z=y*A-m*_,I=y*x-u*_,D=h*A-m*s,R=h*x-u*s,B=m*x-u*A;return v*B-b*R+l*D+L*I-S*z+k*P}},{}],95:[function(c,M,T){M.exports=e;function e(a,n){var r=n[0],t=n[1],f=n[2],o=n[3],i=r+r,g=t+t,p=f+f,y=r*i,h=t*i,m=t*g,u=f*i,_=f*g,s=f*p,A=o*i,x=o*g,v=o*p;return a[0]=1-m-s,a[1]=h+v,a[2]=u-x,a[3]=0,a[4]=h-v,a[5]=1-y-s,a[6]=_+A,a[7]=0,a[8]=u+x,a[9]=_-A,a[10]=1-y-m,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],96:[function(c,M,T){M.exports=e;function e(a,n,r){var t=n[0],f=n[1],o=n[2],i=n[3],g=t+t,p=f+f,y=o+o,h=t*g,m=t*p,u=t*y,_=f*p,s=f*y,A=o*y,x=i*g,v=i*p,b=i*y;return a[0]=1-(_+A),a[1]=m+b,a[2]=u-v,a[3]=0,a[4]=m-b,a[5]=1-(h+A),a[6]=s+x,a[7]=0,a[8]=u+v,a[9]=s-x,a[10]=1-(h+_),a[11]=0,a[12]=r[0],a[13]=r[1],a[14]=r[2],a[15]=1,a}},{}],97:[function(c,M,T){M.exports=e;function e(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}},{}],98:[function(c,M,T){M.exports=e;function e(a,n){var r=n[0],t=n[1],f=n[2],o=n[3],i=n[4],g=n[5],p=n[6],y=n[7],h=n[8],m=n[9],u=n[10],_=n[11],s=n[12],A=n[13],x=n[14],v=n[15],b=r*g-t*i,l=r*p-f*i,L=r*y-o*i,S=t*p-f*g,k=t*y-o*g,P=f*y-o*p,z=h*A-m*s,I=h*x-u*s,D=h*v-_*s,R=m*x-u*A,B=m*v-_*A,F=u*v-_*x,V=b*F-l*B+L*R+S*D-k*I+P*z;return V?(V=1/V,a[0]=(g*F-p*B+y*R)*V,a[1]=(f*B-t*F-o*R)*V,a[2]=(A*P-x*k+v*S)*V,a[3]=(u*k-m*P-_*S)*V,a[4]=(p*D-i*F-y*I)*V,a[5]=(r*F-f*D+o*I)*V,a[6]=(x*L-s*P-v*l)*V,a[7]=(h*P-u*L+_*l)*V,a[8]=(i*B-g*D+y*z)*V,a[9]=(t*D-r*B-o*z)*V,a[10]=(s*k-A*L+v*b)*V,a[11]=(m*L-h*k-_*b)*V,a[12]=(g*I-i*R-p*z)*V,a[13]=(r*R-t*I+f*z)*V,a[14]=(A*l-s*S-x*b)*V,a[15]=(h*S-m*l+u*b)*V,a):null}},{}],99:[function(c,M,T){var e=c("./identity");M.exports=a;function a(n,r,t,f){var o,i,g,p,y,h,m,u,_,s,A=r[0],x=r[1],v=r[2],b=f[0],l=f[1],L=f[2],S=t[0],k=t[1],P=t[2];return Math.abs(A-S)<1e-6&&Math.abs(x-k)<1e-6&&Math.abs(v-P)<1e-6?e(n):(m=A-S,u=x-k,_=v-P,s=1/Math.sqrt(m*m+u*u+_*_),m*=s,u*=s,_*=s,o=l*_-L*u,i=L*m-b*_,g=b*u-l*m,s=Math.sqrt(o*o+i*i+g*g),s?(s=1/s,o*=s,i*=s,g*=s):(o=0,i=0,g=0),p=u*g-_*i,y=_*o-m*g,h=m*i-u*o,s=Math.sqrt(p*p+y*y+h*h),s?(s=1/s,p*=s,y*=s,h*=s):(p=0,y=0,h=0),n[0]=o,n[1]=p,n[2]=m,n[3]=0,n[4]=i,n[5]=y,n[6]=u,n[7]=0,n[8]=g,n[9]=h,n[10]=_,n[11]=0,n[12]=-(o*A+i*x+g*v),n[13]=-(p*A+y*x+h*v),n[14]=-(m*A+u*x+_*v),n[15]=1,n)}},{"./identity":97}],100:[function(c,M,T){M.exports=e;function e(a,n,r){var t=n[0],f=n[1],o=n[2],i=n[3],g=n[4],p=n[5],y=n[6],h=n[7],m=n[8],u=n[9],_=n[10],s=n[11],A=n[12],x=n[13],v=n[14],b=n[15],l=r[0],L=r[1],S=r[2],k=r[3];return a[0]=l*t+L*g+S*m+k*A,a[1]=l*f+L*p+S*u+k*x,a[2]=l*o+L*y+S*_+k*v,a[3]=l*i+L*h+S*s+k*b,l=r[4],L=r[5],S=r[6],k=r[7],a[4]=l*t+L*g+S*m+k*A,a[5]=l*f+L*p+S*u+k*x,a[6]=l*o+L*y+S*_+k*v,a[7]=l*i+L*h+S*s+k*b,l=r[8],L=r[9],S=r[10],k=r[11],a[8]=l*t+L*g+S*m+k*A,a[9]=l*f+L*p+S*u+k*x,a[10]=l*o+L*y+S*_+k*v,a[11]=l*i+L*h+S*s+k*b,l=r[12],L=r[13],S=r[14],k=r[15],a[12]=l*t+L*g+S*m+k*A,a[13]=l*f+L*p+S*u+k*x,a[14]=l*o+L*y+S*_+k*v,a[15]=l*i+L*h+S*s+k*b,a}},{}],101:[function(c,M,T){M.exports=e;function e(a,n,r,t,f,o,i){var g=1/(n-r),p=1/(t-f),y=1/(o-i);return a[0]=-2*g,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*p,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*y,a[11]=0,a[12]=(n+r)*g,a[13]=(f+t)*p,a[14]=(i+o)*y,a[15]=1,a}},{}],102:[function(c,M,T){M.exports=e;function e(a,n,r,t,f){var o=1/Math.tan(n/2),i=1/(t-f);return a[0]=o/r,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=o,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(f+t)*i,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*f*t*i,a[15]=0,a}},{}],103:[function(c,M,T){M.exports=e;function e(a,n,r,t){var f=t[0],o=t[1],i=t[2],g=Math.sqrt(f*f+o*o+i*i),p,y,h,m,u,_,s,A,x,v,b,l,L,S,k,P,z,I,D,R,B,F,V,G;return Math.abs(g)<1e-6?null:(g=1/g,f*=g,o*=g,i*=g,p=Math.sin(r),y=Math.cos(r),h=1-y,m=n[0],u=n[1],_=n[2],s=n[3],A=n[4],x=n[5],v=n[6],b=n[7],l=n[8],L=n[9],S=n[10],k=n[11],P=f*f*h+y,z=o*f*h+i*p,I=i*f*h-o*p,D=f*o*h-i*p,R=o*o*h+y,B=i*o*h+f*p,F=f*i*h+o*p,V=o*i*h-f*p,G=i*i*h+y,a[0]=m*P+A*z+l*I,a[1]=u*P+x*z+L*I,a[2]=_*P+v*z+S*I,a[3]=s*P+b*z+k*I,a[4]=m*D+A*R+l*B,a[5]=u*D+x*R+L*B,a[6]=_*D+v*R+S*B,a[7]=s*D+b*R+k*B,a[8]=m*F+A*V+l*G,a[9]=u*F+x*V+L*G,a[10]=_*F+v*V+S*G,a[11]=s*F+b*V+k*G,n!==a&&(a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a)}},{}],104:[function(c,M,T){M.exports=e;function e(a,n,r){var t=Math.sin(r),f=Math.cos(r),o=n[4],i=n[5],g=n[6],p=n[7],y=n[8],h=n[9],m=n[10],u=n[11];return n!==a&&(a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[4]=o*f+y*t,a[5]=i*f+h*t,a[6]=g*f+m*t,a[7]=p*f+u*t,a[8]=y*f-o*t,a[9]=h*f-i*t,a[10]=m*f-g*t,a[11]=u*f-p*t,a}},{}],105:[function(c,M,T){M.exports=e;function e(a,n,r){var t=Math.sin(r),f=Math.cos(r),o=n[0],i=n[1],g=n[2],p=n[3],y=n[8],h=n[9],m=n[10],u=n[11];return n!==a&&(a[4]=n[4],a[5]=n[5],a[6]=n[6],a[7]=n[7],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=o*f-y*t,a[1]=i*f-h*t,a[2]=g*f-m*t,a[3]=p*f-u*t,a[8]=o*t+y*f,a[9]=i*t+h*f,a[10]=g*t+m*f,a[11]=p*t+u*f,a}},{}],106:[function(c,M,T){M.exports=e;function e(a,n,r){var t=Math.sin(r),f=Math.cos(r),o=n[0],i=n[1],g=n[2],p=n[3],y=n[4],h=n[5],m=n[6],u=n[7];return n!==a&&(a[8]=n[8],a[9]=n[9],a[10]=n[10],a[11]=n[11],a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15]),a[0]=o*f+y*t,a[1]=i*f+h*t,a[2]=g*f+m*t,a[3]=p*f+u*t,a[4]=y*f-o*t,a[5]=h*f-i*t,a[6]=m*f-g*t,a[7]=u*f-p*t,a}},{}],107:[function(c,M,T){M.exports=e;function e(a,n,r){var t=r[0],f=r[1],o=r[2];return a[0]=n[0]*t,a[1]=n[1]*t,a[2]=n[2]*t,a[3]=n[3]*t,a[4]=n[4]*f,a[5]=n[5]*f,a[6]=n[6]*f,a[7]=n[7]*f,a[8]=n[8]*o,a[9]=n[9]*o,a[10]=n[10]*o,a[11]=n[11]*o,a[12]=n[12],a[13]=n[13],a[14]=n[14],a[15]=n[15],a}},{}],108:[function(c,M,T){M.exports=e;function e(a,n,r){var t=r[0],f=r[1],o=r[2],i,g,p,y,h,m,u,_,s,A,x,v;return n===a?(a[12]=n[0]*t+n[4]*f+n[8]*o+n[12],a[13]=n[1]*t+n[5]*f+n[9]*o+n[13],a[14]=n[2]*t+n[6]*f+n[10]*o+n[14],a[15]=n[3]*t+n[7]*f+n[11]*o+n[15]):(i=n[0],g=n[1],p=n[2],y=n[3],h=n[4],m=n[5],u=n[6],_=n[7],s=n[8],A=n[9],x=n[10],v=n[11],a[0]=i,a[1]=g,a[2]=p,a[3]=y,a[4]=h,a[5]=m,a[6]=u,a[7]=_,a[8]=s,a[9]=A,a[10]=x,a[11]=v,a[12]=i*t+h*f+s*o+n[12],a[13]=g*t+m*f+A*o+n[13],a[14]=p*t+u*f+x*o+n[14],a[15]=y*t+_*f+v*o+n[15]),a}},{}],109:[function(c,M,T){M.exports=e;function e(a,n){if(a===n){var r=n[1],t=n[2],f=n[3],o=n[6],i=n[7],g=n[11];a[1]=n[4],a[2]=n[8],a[3]=n[12],a[4]=r,a[6]=n[9],a[7]=n[13],a[8]=t,a[9]=o,a[11]=n[14],a[12]=f,a[13]=i,a[14]=g}else a[0]=n[0],a[1]=n[4],a[2]=n[8],a[3]=n[12],a[4]=n[1],a[5]=n[5],a[6]=n[9],a[7]=n[13],a[8]=n[2],a[9]=n[6],a[10]=n[10],a[11]=n[14],a[12]=n[3],a[13]=n[7],a[14]=n[11],a[15]=n[15];return a}},{}],110:[function(c,M,T){var e=c("barycentric"),a=c("polytope-closest-point/lib/closest_point_2d.js");M.exports=o;function n(i,g){for(var p=[0,0,0,0],y=0;y<4;++y)for(var h=0;h<4;++h)p[h]+=i[4*y+h]*g[y];return p}function r(i,g,p,y,h){for(var m=n(y,n(p,n(g,[i[0],i[1],i[2],1]))),u=0;u<3;++u)m[u]/=m[3];return[.5*h[0]*(1+m[0]),.5*h[1]*(1-m[1])]}function t(i,g){if(i.length===2){for(var p=0,y=0,h=0;h<2;++h)p+=Math.pow(g[h]-i[0][h],2),y+=Math.pow(g[h]-i[1][h],2);return p=Math.sqrt(p),y=Math.sqrt(y),p+y<1e-6?[1,0]:[y/(p+y),p/(y+p)]}else if(i.length===3){var m=[0,0];return a(i[0],i[1],i[2],g,m),e(i,m)}return[]}function f(i,g){for(var p=[0,0,0],y=0;y<i.length;++y)for(var h=i[y],m=g[y],u=0;u<3;++u)p[u]+=m*h[u];return p}function o(i,g,p,y,h,m){if(i.length===1)return[0,i[0].slice()];for(var u=new Array(i.length),_=0;_<i.length;++_)u[_]=r(i[_],p,y,h,m);for(var s=0,A=1/0,_=0;_<u.length;++_){for(var x=0,v=0;v<2;++v)x+=Math.pow(u[_][v]-g[v],2);x<A&&(A=x,s=_)}for(var b=t(u,g),l=0,_=0;_<3;++_){if(b[_]<-.001||b[_]>1.0001)return null;l+=b[_]}return Math.abs(l-1)>.001?null:[s,f(i,b),b]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(c,M,T){var e=c("glslify"),a=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),f=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),o=e([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),i=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),g=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),p=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),y=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),h=e([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);T.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},T.wireShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},T.pointShader={vertex:f,fragment:o,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},T.pickShader={vertex:i,fragment:g,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},T.pointPickShader={vertex:p,fragment:g,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},T.contourShader={vertex:y,fragment:h,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(c,M,T){var e=1e-6,a=1e-6,n=c("gl-shader"),r=c("gl-buffer"),t=c("gl-vao"),f=c("gl-texture2d"),o=c("normals"),i=c("gl-mat4/multiply"),g=c("gl-mat4/invert"),p=c("ndarray"),y=c("colormap"),h=c("simplicial-complex-contour"),m=c("typedarray-pool"),u=c("./lib/shaders"),_=c("./lib/closest-point"),s=u.meshShader,A=u.wireShader,x=u.pointShader,v=u.pickShader,b=u.pointPickShader,l=u.contourShader,L=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function S(j,Y,X,oe,se,ie,N,U,q,Q,W,Z,ee,te,ae,le,ye,fe,pe,ge,Ae,we,De,Be,Ve,xe,Le){this.gl=j,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=Y,this.dirty=!0,this.triShader=X,this.lineShader=oe,this.pointShader=se,this.pickShader=ie,this.pointPickShader=N,this.contourShader=U,this.trianglePositions=q,this.triangleColors=W,this.triangleNormals=ee,this.triangleUVs=Z,this.triangleIds=Q,this.triangleVAO=te,this.triangleCount=0,this.lineWidth=1,this.edgePositions=ae,this.edgeColors=ye,this.edgeUVs=fe,this.edgeIds=le,this.edgeVAO=pe,this.edgeCount=0,this.pointPositions=ge,this.pointColors=we,this.pointUVs=De,this.pointSizes=Be,this.pointIds=Ae,this.pointVAO=Ve,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=xe,this.contourVAO=Le,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=L,this._view=L,this._projection=L,this._resolution=[1,1]}var k=S.prototype;k.isOpaque=function(){return!this.hasAlpha},k.isTransparent=function(){return this.hasAlpha},k.pickSlots=1,k.setPickBase=function(j){this.pickId=j};function P(j,Y){if(!Y||!Y.length)return 1;for(var X=0;X<Y.length;++X){if(Y.length<2)return 1;if(Y[X][0]===j)return Y[X][1];if(Y[X][0]>j&&X>0){var oe=(Y[X][0]-j)/(Y[X][0]-Y[X-1][0]);return Y[X][1]*(1-oe)+oe*Y[X-1][1]}}return 1}function z(j,Y){for(var X=y({colormap:j,nshades:256,format:"rgba"}),oe=new Uint8Array(256*4),se=0;se<256;++se){for(var ie=X[se],N=0;N<3;++N)oe[4*se+N]=ie[N];Y?oe[4*se+3]=255*P(se/255,Y):oe[4*se+3]=255*ie[3]}return p(oe,[256,256,4],[4,0,1])}function I(j){for(var Y=j.length,X=new Array(Y),oe=0;oe<Y;++oe)X[oe]=j[oe][2];return X}k.highlight=function(j){if(!j||!this.contourEnable){this.contourCount=0;return}for(var Y=h(this.cells,this.intensity,j.intensity),X=Y.cells,oe=Y.vertexIds,se=Y.vertexWeights,ie=X.length,N=m.mallocFloat32(2*3*ie),U=0,q=0;q<ie;++q)for(var Q=X[q],W=0;W<2;++W){var Z=Q[0];Q.length===2&&(Z=Q[W]);for(var ee=oe[Z][0],te=oe[Z][1],ae=se[Z],le=1-ae,ye=this.positions[ee],fe=this.positions[te],pe=0;pe<3;++pe)N[U++]=ae*ye[pe]+le*fe[pe]}this.contourCount=U/3|0,this.contourPositions.update(N.subarray(0,U)),m.free(N)},k.update=function(j){j=j||{};var Y=this.gl;this.dirty=!0,"contourEnable"in j&&(this.contourEnable=j.contourEnable),"contourColor"in j&&(this.contourColor=j.contourColor),"lineWidth"in j&&(this.lineWidth=j.lineWidth),"lightPosition"in j&&(this.lightPosition=j.lightPosition),this.hasAlpha=!1,"opacity"in j&&(this.opacity=j.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in j&&(this.opacityscale=j.opacityscale,this.hasAlpha=!0),"ambient"in j&&(this.ambientLight=j.ambient),"diffuse"in j&&(this.diffuseLight=j.diffuse),"specular"in j&&(this.specularLight=j.specular),"roughness"in j&&(this.roughness=j.roughness),"fresnel"in j&&(this.fresnel=j.fresnel),j.texture?(this.texture.dispose(),this.texture=f(Y,j.texture)):j.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=Y.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=Y.LINEAR,this.texture.setPixels(z(j.colormap,this.opacityscale)),this.texture.generateMipmap());var X=j.cells,oe=j.positions;if(!oe||!X)return;var se=[],ie=[],N=[],U=[],q=[],Q=[],W=[],Z=[],ee=[],te=[],ae=[],le=[],ye=[],fe=[];this.cells=X,this.positions=oe;var pe=j.vertexNormals,ge=j.cellNormals,Ae=j.vertexNormalsEpsilon===void 0?e:j.vertexNormalsEpsilon,we=j.faceNormalsEpsilon===void 0?a:j.faceNormalsEpsilon;j.useFacetNormals&&!ge&&(ge=o.faceNormals(X,oe,we)),!ge&&!pe&&(pe=o.vertexNormals(X,oe,Ae));var De=j.vertexColors,Be=j.cellColors,Ve=j.meshColor||[1,1,1,1],xe=j.vertexUVs,Le=j.vertexIntensity,He=j.cellUVs,Je=j.cellIntensity,Oe=1/0,Pe=-1/0;if(!xe&&!He)if(Le)if(j.vertexIntensityBounds)Oe=+j.vertexIntensityBounds[0],Pe=+j.vertexIntensityBounds[1];else for(var Ue=0;Ue<Le.length;++Ue){var vt=Le[Ue];Oe=Math.min(Oe,vt),Pe=Math.max(Pe,vt)}else if(Je)if(j.cellIntensityBounds)Oe=+j.cellIntensityBounds[0],Pe=+j.cellIntensityBounds[1];else for(var Ue=0;Ue<Je.length;++Ue){var vt=Je[Ue];Oe=Math.min(Oe,vt),Pe=Math.max(Pe,vt)}else for(var Ue=0;Ue<oe.length;++Ue){var vt=oe[Ue][2];Oe=Math.min(Oe,vt),Pe=Math.max(Pe,vt)}Le?this.intensity=Le:Je?this.intensity=Je:this.intensity=I(oe),this.pickVertex=!(Je||Be);var Lt=j.pointSizes,Yt=j.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var Ue=0;Ue<oe.length;++Ue)for(var At=oe[Ue],Rt=0;Rt<3;++Rt)isNaN(At[Rt])||!isFinite(At[Rt])||(this.bounds[0][Rt]=Math.min(this.bounds[0][Rt],At[Rt]),this.bounds[1][Rt]=Math.max(this.bounds[1][Rt],At[Rt]));var Bt=0,Mt=0,Tt=0;e:for(var Ue=0;Ue<X.length;++Ue){var at=X[Ue];switch(at.length){case 1:for(var ct=at[0],At=oe[ct],Rt=0;Rt<3;++Rt)if(isNaN(At[Rt])||!isFinite(At[Rt]))continue e;te.push(At[0],At[1],At[2]);var je;De?je=De[ct]:Be?je=Be[Ue]:je=Ve,this.opacityscale&&Le?ie.push(je[0],je[1],je[2],this.opacity*P((Le[ct]-Oe)/(Pe-Oe),this.opacityscale)):je.length===3?ae.push(je[0],je[1],je[2],this.opacity):(ae.push(je[0],je[1],je[2],je[3]*this.opacity),je[3]<1&&(this.hasAlpha=!0));var ke;xe?ke=xe[ct]:Le?ke=[(Le[ct]-Oe)/(Pe-Oe),0]:He?ke=He[Ue]:Je?ke=[(Je[Ue]-Oe)/(Pe-Oe),0]:ke=[(At[2]-Oe)/(Pe-Oe),0],le.push(ke[0],ke[1]),Lt?ye.push(Lt[ct]):ye.push(Yt),fe.push(Ue),Tt+=1;break;case 2:for(var Rt=0;Rt<2;++Rt)for(var ct=at[Rt],At=oe[ct],Ye=0;Ye<3;++Ye)if(isNaN(At[Ye])||!isFinite(At[Ye]))continue e;for(var Rt=0;Rt<2;++Rt){var ct=at[Rt],At=oe[ct];Q.push(At[0],At[1],At[2]);var je;De?je=De[ct]:Be?je=Be[Ue]:je=Ve,this.opacityscale&&Le?ie.push(je[0],je[1],je[2],this.opacity*P((Le[ct]-Oe)/(Pe-Oe),this.opacityscale)):je.length===3?W.push(je[0],je[1],je[2],this.opacity):(W.push(je[0],je[1],je[2],je[3]*this.opacity),je[3]<1&&(this.hasAlpha=!0));var ke;xe?ke=xe[ct]:Le?ke=[(Le[ct]-Oe)/(Pe-Oe),0]:He?ke=He[Ue]:Je?ke=[(Je[Ue]-Oe)/(Pe-Oe),0]:ke=[(At[2]-Oe)/(Pe-Oe),0],Z.push(ke[0],ke[1]),ee.push(Ue)}Mt+=1;break;case 3:for(var Rt=0;Rt<3;++Rt)for(var ct=at[Rt],At=oe[ct],Ye=0;Ye<3;++Ye)if(isNaN(At[Ye])||!isFinite(At[Ye]))continue e;for(var Rt=0;Rt<3;++Rt){var ct=at[2-Rt],At=oe[ct];se.push(At[0],At[1],At[2]);var je;De?je=De[ct]:Be?je=Be[Ue]:je=Ve,je?this.opacityscale&&Le?ie.push(je[0],je[1],je[2],this.opacity*P((Le[ct]-Oe)/(Pe-Oe),this.opacityscale)):je.length===3?ie.push(je[0],je[1],je[2],this.opacity):(ie.push(je[0],je[1],je[2],je[3]*this.opacity),je[3]<1&&(this.hasAlpha=!0)):ie.push(.5,.5,.5,1);var ke;xe?ke=xe[ct]:Le?ke=[(Le[ct]-Oe)/(Pe-Oe),0]:He?ke=He[Ue]:Je?ke=[(Je[Ue]-Oe)/(Pe-Oe),0]:ke=[(At[2]-Oe)/(Pe-Oe),0],U.push(ke[0],ke[1]);var Ke;pe?Ke=pe[ct]:Ke=ge[Ue],N.push(Ke[0],Ke[1],Ke[2]),q.push(Ue)}Bt+=1;break}}this.pointCount=Tt,this.edgeCount=Mt,this.triangleCount=Bt,this.pointPositions.update(te),this.pointColors.update(ae),this.pointUVs.update(le),this.pointSizes.update(ye),this.pointIds.update(new Uint32Array(fe)),this.edgePositions.update(Q),this.edgeColors.update(W),this.edgeUVs.update(Z),this.edgeIds.update(new Uint32Array(ee)),this.trianglePositions.update(se),this.triangleColors.update(ie),this.triangleUVs.update(U),this.triangleNormals.update(N),this.triangleIds.update(new Uint32Array(q))},k.drawTransparent=k.draw=function(j){j=j||{};for(var Y=this.gl,X=j.model||L,oe=j.view||L,se=j.projection||L,ie=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],N=0;N<3;++N)ie[0][N]=Math.max(ie[0][N],this.clipBounds[0][N]),ie[1][N]=Math.min(ie[1][N],this.clipBounds[1][N]);var U={model:X,view:oe,projection:se,inverseModel:L.slice(),clipBounds:ie,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};U.inverseModel=g(U.inverseModel,U.model),Y.disable(Y.CULL_FACE),this.texture.bind(0);var q=new Array(16);i(q,U.view,U.model),i(q,U.projection,q),g(q,q);for(var N=0;N<3;++N)U.eyePosition[N]=q[12+N]/q[15];for(var Q=q[15],N=0;N<3;++N)Q+=this.lightPosition[N]*q[4*N+3];for(var N=0;N<3;++N){for(var W=q[12+N],Z=0;Z<3;++Z)W+=q[4*Z+N]*this.lightPosition[Z];U.lightPosition[N]=W/Q}if(this.triangleCount>0){var ee=this.triShader;ee.bind(),ee.uniforms=U,this.triangleVAO.bind(),Y.drawArrays(Y.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var ee=this.lineShader;ee.bind(),ee.uniforms=U,this.edgeVAO.bind(),Y.lineWidth(this.lineWidth*this.pixelRatio),Y.drawArrays(Y.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()}if(this.pointCount>0){var ee=this.pointShader;ee.bind(),ee.uniforms=U,this.pointVAO.bind(),Y.drawArrays(Y.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var ee=this.contourShader;ee.bind(),ee.uniforms=U,this.contourVAO.bind(),Y.drawArrays(Y.LINES,0,this.contourCount),this.contourVAO.unbind()}},k.drawPick=function(j){j=j||{};for(var Y=this.gl,X=j.model||L,oe=j.view||L,se=j.projection||L,ie=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],N=0;N<3;++N)ie[0][N]=Math.max(ie[0][N],this.clipBounds[0][N]),ie[1][N]=Math.min(ie[1][N],this.clipBounds[1][N]);this._model=[].slice.call(X),this._view=[].slice.call(oe),this._projection=[].slice.call(se),this._resolution=[Y.drawingBufferWidth,Y.drawingBufferHeight];var U={model:X,view:oe,projection:se,clipBounds:ie,pickId:this.pickId/255},q=this.pickShader;if(q.bind(),q.uniforms=U,this.triangleCount>0&&(this.triangleVAO.bind(),Y.drawArrays(Y.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),Y.lineWidth(this.lineWidth*this.pixelRatio),Y.drawArrays(Y.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()),this.pointCount>0){var q=this.pointPickShader;q.bind(),q.uniforms=U,this.pointVAO.bind(),Y.drawArrays(Y.POINTS,0,this.pointCount),this.pointVAO.unbind()}},k.pick=function(j){if(!j||j.id!==this.pickId)return null;for(var Y=j.value[0]+256*j.value[1]+65536*j.value[2],X=this.cells[Y],oe=this.positions,se=new Array(X.length),ie=0;ie<X.length;++ie)se[ie]=oe[X[ie]];var N=j.coord[0],U=j.coord[1];if(!this.pickVertex){var q=this.positions[X[0]],Q=this.positions[X[1]],W=this.positions[X[2]],Z=[(q[0]+Q[0]+W[0])/3,(q[1]+Q[1]+W[1])/3,(q[2]+Q[2]+W[2])/3];return{_cellCenter:!0,position:[N,U],index:Y,cell:X,cellId:Y,intensity:this.intensity[Y],dataCoordinate:Z}}var ee=_(se,[N*this.pixelRatio,this._resolution[1]-U*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!ee)return null;for(var te=ee[2],ae=0,ie=0;ie<X.length;++ie)ae+=te[ie]*this.intensity[X[ie]];return{position:ee[1],index:X[ee[0]],cell:X,cellId:Y,intensity:ae,dataCoordinate:this.positions[X[ee[0]]]}},k.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()};function D(j){var Y=n(j,s.vertex,s.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y.attributes.normal.location=4,Y}function R(j){var Y=n(j,A.vertex,A.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y}function B(j){var Y=n(j,x.vertex,x.fragment);return Y.attributes.position.location=0,Y.attributes.color.location=2,Y.attributes.uv.location=3,Y.attributes.pointSize.location=4,Y}function F(j){var Y=n(j,v.vertex,v.fragment);return Y.attributes.position.location=0,Y.attributes.id.location=1,Y}function V(j){var Y=n(j,b.vertex,b.fragment);return Y.attributes.position.location=0,Y.attributes.id.location=1,Y.attributes.pointSize.location=4,Y}function G(j){var Y=n(j,l.vertex,l.fragment);return Y.attributes.position.location=0,Y}function J(j,Y){arguments.length===1&&(Y=j,j=Y.gl);var X=j.getExtension("OES_standard_derivatives")||j.getExtension("MOZ_OES_standard_derivatives")||j.getExtension("WEBKIT_OES_standard_derivatives");if(!X)throw new Error("derivatives not supported");var oe=D(j),se=R(j),ie=B(j),N=F(j),U=V(j),q=G(j),Q=f(j,p(new Uint8Array([255,255,255,255]),[1,1,4]));Q.generateMipmap(),Q.minFilter=j.LINEAR_MIPMAP_LINEAR,Q.magFilter=j.LINEAR;var W=r(j),Z=r(j),ee=r(j),te=r(j),ae=r(j),le=t(j,[{buffer:W,type:j.FLOAT,size:3},{buffer:ae,type:j.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Z,type:j.FLOAT,size:4},{buffer:ee,type:j.FLOAT,size:2},{buffer:te,type:j.FLOAT,size:3}]),ye=r(j),fe=r(j),pe=r(j),ge=r(j),Ae=t(j,[{buffer:ye,type:j.FLOAT,size:3},{buffer:ge,type:j.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:fe,type:j.FLOAT,size:4},{buffer:pe,type:j.FLOAT,size:2}]),we=r(j),De=r(j),Be=r(j),Ve=r(j),xe=r(j),Le=t(j,[{buffer:we,type:j.FLOAT,size:3},{buffer:xe,type:j.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:De,type:j.FLOAT,size:4},{buffer:Be,type:j.FLOAT,size:2},{buffer:Ve,type:j.FLOAT,size:1}]),He=r(j),Je=t(j,[{buffer:He,type:j.FLOAT,size:3}]),Oe=new S(j,Q,oe,se,ie,N,U,q,W,ae,Z,ee,te,le,ye,ge,fe,pe,Ae,we,xe,De,Be,Ve,Le,He,Je);return Oe.update(Y),Oe}M.exports=J},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(c,M,T){M.exports=f;var e=c("gl-buffer"),a=c("gl-shader"),n=c("./shaders");function r(o,i,g){this.plot=o,this.vbo=i,this.shader=g}var t=r.prototype;t.bind=function(){var o=this.shader;this.vbo.bind(),this.shader.bind(),o.attributes.coord.pointer(),o.uniforms.screenBox=this.plot.screenBox},t.drawBox=function(){var o=[0,0],i=[0,0];return function(g,p,y,h,m){var u=this.plot,_=this.shader,s=u.gl;o[0]=g,o[1]=p,i[0]=y,i[1]=h,_.uniforms.lo=o,_.uniforms.hi=i,_.uniforms.color=m,s.drawArrays(s.TRIANGLE_STRIP,0,4)}}(),t.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function f(o){var i=o.gl,g=e(i,[0,0,0,1,1,0,1,1]),p=a(i,n.boxVert,n.lineFrag);return new r(o,g,p)}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(c,M,T){M.exports=i;var e=c("gl-buffer"),a=c("gl-shader"),n=c("binary-search-bounds"),r=c("./shaders");function t(g,p,y,h){this.plot=g,this.vbo=p,this.shader=y,this.tickShader=h,this.ticks=[[],[]]}function f(g,p){return g-p}var o=t.prototype;o.draw=function(){var g=[0,0],p=[0,0],y=[0,0];return function(){for(var h=this.plot,m=this.vbo,u=this.shader,_=this.ticks,s=h.gl,A=h._tickBounds,x=h.dataBox,v=h.viewBox,b=h.gridLineWidth,l=h.gridLineColor,L=h.gridLineEnable,S=h.pixelRatio,k=0;k<2;++k){var P=A[k],z=A[k+2],I=z-P,D=.5*(x[k+2]+x[k]),R=x[k+2]-x[k];p[k]=2*I/R,g[k]=2*(P-D)/R}u.bind(),m.bind(),u.attributes.dataCoord.pointer(),u.uniforms.dataShift=g,u.uniforms.dataScale=p;for(var B=0,k=0;k<2;++k){y[0]=y[1]=0,y[k]=1,u.uniforms.dataAxis=y,u.uniforms.lineWidth=b[k]/(v[k+2]-v[k])*S,u.uniforms.color=l[k];var F=_[k].length*6;L[k]&&F&&s.drawArrays(s.TRIANGLES,B,F),B+=F}}}(),o.drawTickMarks=function(){var g=[0,0],p=[0,0],y=[1,0],h=[0,1],m=[0,0],u=[0,0];return function(){for(var _=this.plot,s=this.vbo,A=this.tickShader,x=this.ticks,v=_.gl,b=_._tickBounds,l=_.dataBox,L=_.viewBox,S=_.pixelRatio,k=_.screenBox,P=k[2]-k[0],z=k[3]-k[1],I=L[2]-L[0],D=L[3]-L[1],R=0;R<2;++R){var B=b[R],F=b[R+2],V=F-B,G=.5*(l[R+2]+l[R]),J=l[R+2]-l[R];p[R]=2*V/J,g[R]=2*(B-G)/J}p[0]*=I/P,g[0]*=I/P,p[1]*=D/z,g[1]*=D/z,A.bind(),s.bind(),A.attributes.dataCoord.pointer();var j=A.uniforms;j.dataShift=g,j.dataScale=p;var Y=_.tickMarkLength,X=_.tickMarkWidth,oe=_.tickMarkColor,se=0,ie=x[0].length*6,N=Math.min(n.ge(x[0],(l[0]-b[0])/(b[2]-b[0]),f),x[0].length),U=Math.min(n.gt(x[0],(l[2]-b[0])/(b[2]-b[0]),f),x[0].length),q=se+6*N,Q=6*Math.max(0,U-N),W=Math.min(n.ge(x[1],(l[1]-b[1])/(b[3]-b[1]),f),x[1].length),Z=Math.min(n.gt(x[1],(l[3]-b[1])/(b[3]-b[1]),f),x[1].length),ee=ie+6*W,te=6*Math.max(0,Z-W);m[0]=2*(L[0]-Y[1])/P-1,m[1]=(L[3]+L[1])/z-1,u[0]=Y[1]*S/P,u[1]=X[1]*S/z,te&&(j.color=oe[1],j.tickScale=u,j.dataAxis=h,j.screenOffset=m,v.drawArrays(v.TRIANGLES,ee,te)),m[0]=(L[2]+L[0])/P-1,m[1]=2*(L[1]-Y[0])/z-1,u[0]=X[0]*S/P,u[1]=Y[0]*S/z,Q&&(j.color=oe[0],j.tickScale=u,j.dataAxis=y,j.screenOffset=m,v.drawArrays(v.TRIANGLES,q,Q)),m[0]=2*(L[2]+Y[3])/P-1,m[1]=(L[3]+L[1])/z-1,u[0]=Y[3]*S/P,u[1]=X[3]*S/z,te&&(j.color=oe[3],j.tickScale=u,j.dataAxis=h,j.screenOffset=m,v.drawArrays(v.TRIANGLES,ee,te)),m[0]=(L[2]+L[0])/P-1,m[1]=2*(L[3]+Y[2])/z-1,u[0]=X[2]*S/P,u[1]=Y[2]*S/z,Q&&(j.color=oe[2],j.tickScale=u,j.dataAxis=y,j.screenOffset=m,v.drawArrays(v.TRIANGLES,q,Q))}}(),o.update=function(){var g=[1,1,-1,-1,1,-1],p=[1,-1,1,1,-1,-1];return function(y){var h=y.ticks,m=y.bounds,u=new Float32Array(6*3*(h[0].length+h[1].length));this.plot.zeroLineEnable;for(var _=0,s=[[],[]],A=0;A<2;++A)for(var x=s[A],v=h[A],b=m[A],l=m[A+2],L=0;L<v.length;++L){var S=(v[L].x-b)/(l-b);x.push(S);for(var k=0;k<6;++k)u[_++]=S,u[_++]=g[k],u[_++]=p[k]}this.ticks=s,this.vbo.update(u)}}(),o.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()};function i(g){var p=g.gl,y=e(p),h=a(p,r.gridVert,r.gridFrag),m=a(p,r.tickVert,r.gridFrag),u=new t(g,y,h,m);return u}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(c,M,T){M.exports=f;var e=c("gl-buffer"),a=c("gl-shader"),n=c("./shaders");function r(o,i,g){this.plot=o,this.vbo=i,this.shader=g}var t=r.prototype;t.bind=function(){var o=this.shader;this.vbo.bind(),this.shader.bind(),o.attributes.coord.pointer(),o.uniforms.screenBox=this.plot.screenBox},t.drawLine=function(){var o=[0,0],i=[0,0];return function(g,p,y,h,m,u){var _=this.plot,s=this.shader,A=_.gl;o[0]=g,o[1]=p,i[0]=y,i[1]=h,s.uniforms.start=o,s.uniforms.end=i,s.uniforms.width=m*_.pixelRatio,s.uniforms.color=u,A.drawArrays(A.TRIANGLE_STRIP,0,4)}}(),t.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function f(o){var i=o.gl,g=e(i,[-1,-1,-1,1,1,-1,1,1]),p=a(i,n.lineVert,n.lineFrag),y=new r(o,g,p);return y}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(c,M,T){var e=c("glslify"),a=e([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);M.exports={lineVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:a,textVert:e([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:a,gridVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:a,boxVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:231}],117:[function(c,M,T){M.exports=i;var e=c("gl-buffer"),a=c("gl-shader"),n=c("text-cache"),r=c("binary-search-bounds"),t=c("./shaders");function f(g,p,y){this.plot=g,this.vbo=p,this.shader=y,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var o=f.prototype;o.drawTicks=function(){var g=[0,0],p=[0,0],y=[0,0];return function(h){var m=this.plot,u=this.shader,_=this.tickX[h],s=this.tickOffset[h],A=m.gl,x=m.viewBox,v=m.dataBox,b=m.screenBox,l=m.pixelRatio,L=m.tickEnable,S=m.tickPad,k=m.tickColor,P=m.tickAngle,z=m.labelEnable,I=m.labelPad,D=m.labelColor,R=m.labelAngle,B=this.labelOffset[h],F=this.labelCount[h],V=r.lt(_,v[h]),G=r.le(_,v[h+2]);g[0]=g[1]=0,g[h]=1,p[h]=(x[2+h]+x[h])/(b[2+h]-b[h])-1;var J=2/b[2+(h^1)]-b[h^1];p[h^1]=J*x[h^1]-1,L[h]&&(p[h^1]-=J*l*S[h],V<G&&s[G]>s[V]&&(u.uniforms.dataAxis=g,u.uniforms.screenOffset=p,u.uniforms.color=k[h],u.uniforms.angle=P[h],A.drawArrays(A.TRIANGLES,s[V],s[G]-s[V]))),z[h]&&F&&(p[h^1]-=J*l*I[h],u.uniforms.dataAxis=y,u.uniforms.screenOffset=p,u.uniforms.color=D[h],u.uniforms.angle=R[h],A.drawArrays(A.TRIANGLES,B,F)),p[h^1]=J*x[2+(h^1)]-1,L[h+2]&&(p[h^1]+=J*l*S[h+2],V<G&&s[G]>s[V]&&(u.uniforms.dataAxis=g,u.uniforms.screenOffset=p,u.uniforms.color=k[h+2],u.uniforms.angle=P[h+2],A.drawArrays(A.TRIANGLES,s[V],s[G]-s[V]))),z[h+2]&&F&&(p[h^1]+=J*l*I[h+2],u.uniforms.dataAxis=y,u.uniforms.screenOffset=p,u.uniforms.color=D[h+2],u.uniforms.angle=R[h+2],A.drawArrays(A.TRIANGLES,B,F))}}(),o.drawTitle=function(){var g=[0,0],p=[0,0];return function(){var y=this.plot,h=this.shader,m=y.gl,u=y.screenBox,_=y.titleCenter,s=y.titleAngle,A=y.titleColor,x=y.pixelRatio;if(!!this.titleCount){for(var v=0;v<2;++v)p[v]=2*(_[v]*x-u[v])/(u[2+v]-u[v])-1;h.bind(),h.uniforms.dataAxis=g,h.uniforms.screenOffset=p,h.uniforms.angle=s,h.uniforms.color=A,m.drawArrays(m.TRIANGLES,this.titleOffset,this.titleCount)}}}(),o.bind=function(){var g=[0,0],p=[0,0],y=[0,0];return function(){var h=this.plot,m=this.shader,u=h._tickBounds,_=h.dataBox,s=h.screenBox,A=h.viewBox;m.bind();for(var x=0;x<2;++x){var v=u[x],b=u[x+2],l=b-v,L=.5*(_[x+2]+_[x]),S=_[x+2]-_[x],k=A[x],P=A[x+2],z=P-k,I=s[x],D=s[x+2],R=D-I;p[x]=2*l/S*z/R,g[x]=2*(v-L)/S*z/R}y[1]=2*h.pixelRatio/(s[3]-s[1]),y[0]=y[1]*(s[3]-s[1])/(s[2]-s[0]),m.uniforms.dataScale=p,m.uniforms.dataShift=g,m.uniforms.textScale=y,this.vbo.bind(),m.attributes.textCoordinate.pointer()}}(),o.update=function(g){var p=[],y=g.ticks,h=g.bounds,m,u,_,s,A;for(A=0;A<2;++A){var x=[Math.floor(p.length/3)],v=[-1/0],b=y[A];for(m=0;m<b.length;++m){var l=b[m],L=l.x,S=l.text,k=l.font||"sans-serif";s=l.fontSize||12;for(var P=1/(h[A+2]-h[A]),z=h[A],I=S.split(`
`),D=0;D<I.length;D++)for(_=n(k,I[D]).data,u=0;u<_.length;u+=2)p.push(_[u]*s,-_[u+1]*s-D*s*1.2,(L-z)*P);x.push(Math.floor(p.length/3)),v.push(L)}this.tickOffset[A]=x,this.tickX[A]=v}for(A=0;A<2;++A){for(this.labelOffset[A]=Math.floor(p.length/3),_=n(g.labelFont[A],g.labels[A],{textAlign:"center"}).data,s=g.labelSize[A],m=0;m<_.length;m+=2)p.push(_[m]*s,-_[m+1]*s,0);this.labelCount[A]=Math.floor(p.length/3)-this.labelOffset[A]}for(this.titleOffset=Math.floor(p.length/3),_=n(g.titleFont,g.title).data,s=g.titleSize,m=0;m<_.length;m+=2)p.push(_[m]*s,-_[m+1]*s,0);this.titleCount=Math.floor(p.length/3)-this.titleOffset,this.vbo.update(p)},o.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function i(g){var p=g.gl,y=e(p),h=a(p,t.textVert,t.textFrag),m=new f(g,y,h);return m}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(c,M,T){M.exports=p;var e=c("gl-select-static"),a=c("./lib/grid"),n=c("./lib/text"),r=c("./lib/line"),t=c("./lib/box");function f(y,h){this.gl=y,this.pickBuffer=h,this.screenBox=[0,0,y.drawingBufferWidth,y.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var o=f.prototype;o.setDirty=function(){this.dirty=this.pickDirty=!0},o.setOverlayDirty=function(){this.dirty=!0},o.nextDepthValue=function(){return this._depthCounter++/65536},o.draw=function(){return function(){var y=this.gl,h=this.screenBox,m=this.viewBox,u=this.dataBox,_=this.pixelRatio,s=this.grid,A=this.line,x=this.text,v=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),!!this.dirty){if(this.dirty=!1,y.bindFramebuffer(y.FRAMEBUFFER,null),y.enable(y.SCISSOR_TEST),y.disable(y.DEPTH_TEST),y.depthFunc(y.LESS),y.depthMask(!1),y.enable(y.BLEND),y.blendEquation(y.FUNC_ADD,y.FUNC_ADD),y.blendFunc(y.ONE,y.ONE_MINUS_SRC_ALPHA),this.borderColor){y.scissor(h[0],h[1],h[2]-h[0],h[3]-h[1]);var b=this.borderColor;y.clearColor(b[0]*b[3],b[1]*b[3],b[2]*b[3],b[3]),y.clear(y.COLOR_BUFFER_BIT|y.DEPTH_BUFFER_BIT)}y.scissor(m[0],m[1],m[2]-m[0],m[3]-m[1]),y.viewport(m[0],m[1],m[2]-m[0],m[3]-m[1]);var l=this.backgroundColor;y.clearColor(l[0]*l[3],l[1]*l[3],l[2]*l[3],l[3]),y.clear(y.COLOR_BUFFER_BIT),s.draw();var L=this.zeroLineEnable,S=this.zeroLineColor,k=this.zeroLineWidth;if(L[0]||L[1]){A.bind();for(var P=0;P<2;++P)if(!(!L[P]||!(u[P]<=0&&u[P+2]>=0))){var z=h[P]-u[P]*(h[P+2]-h[P])/(u[P+2]-u[P]);P===0?A.drawLine(z,h[1],z,h[3],k[P],S[P]):A.drawLine(h[0],z,h[2],z,k[P],S[P])}}for(var P=0;P<v.length;++P)v[P].draw();y.viewport(h[0],h[1],h[2]-h[0],h[3]-h[1]),y.scissor(h[0],h[1],h[2]-h[0],h[3]-h[1]),this.grid.drawTickMarks(),A.bind();var I=this.borderLineEnable,D=this.borderLineWidth,R=this.borderLineColor;I[1]&&A.drawLine(m[0],m[1]-.5*D[1]*_,m[0],m[3]+.5*D[3]*_,D[1],R[1]),I[0]&&A.drawLine(m[0]-.5*D[0]*_,m[1],m[2]+.5*D[2]*_,m[1],D[0],R[0]),I[3]&&A.drawLine(m[2],m[1]-.5*D[1]*_,m[2],m[3]+.5*D[3]*_,D[3],R[3]),I[2]&&A.drawLine(m[0]-.5*D[0]*_,m[3],m[2]+.5*D[2]*_,m[3],D[2],R[2]),x.bind();for(var P=0;P<2;++P)x.drawTicks(P);this.titleEnable&&x.drawTitle();for(var B=this.overlays,P=0;P<B.length;++P)B[P].draw();y.disable(y.SCISSOR_TEST),y.disable(y.BLEND),y.depthMask(!0)}}}(),o.drawPick=function(){return function(){if(!this.static){var y=this.pickBuffer;this.gl,this._pickTimeout=null,y.begin();for(var h=1,m=this.objects,u=0;u<m.length;++u)h=m[u].drawPick(h);y.end()}}}(),o.pick=function(){return function(y,h){if(!this.static){var m=this.pixelRatio,u=this.pickPixelRatio,_=this.viewBox,s=Math.round((y-_[0]/m)*u)|0,A=Math.round((h-_[1]/m)*u)|0,x=this.pickBuffer.query(s,A,this.pickRadius);if(!x)return null;for(var v=x.id+(x.value[0]<<8)+(x.value[1]<<16)+(x.value[2]<<24),b=this.objects,l=0;l<b.length;++l){var L=b[l].pick(s,A,v);if(L)return L}return null}}}();function i(y){for(var h=y.slice(),m=0;m<h.length;++m)h[m]=h[m].slice();return h}function g(y,h){return y.x-h.x}o.setScreenBox=function(y){var h=this.screenBox,m=this.pixelRatio;h[0]=Math.round(y[0]*m)|0,h[1]=Math.round(y[1]*m)|0,h[2]=Math.round(y[2]*m)|0,h[3]=Math.round(y[3]*m)|0,this.setDirty()},o.setDataBox=function(y){var h=this.dataBox,m=h[0]!==y[0]||h[1]!==y[1]||h[2]!==y[2]||h[3]!==y[3];m&&(h[0]=y[0],h[1]=y[1],h[2]=y[2],h[3]=y[3],this.setDirty())},o.setViewBox=function(y){var h=this.pixelRatio,m=this.viewBox;m[0]=Math.round(y[0]*h)|0,m[1]=Math.round(y[1]*h)|0,m[2]=Math.round(y[2]*h)|0,m[3]=Math.round(y[3]*h)|0;var u=this.pickPixelRatio;this.pickBuffer.shape=[Math.round((y[2]-y[0])*u)|0,Math.round((y[3]-y[1])*u)|0],this.setDirty()},o.update=function(y){y=y||{};var h=this.gl;this.pixelRatio=y.pixelRatio||1;var m=this.pixelRatio;this.pickPixelRatio=Math.max(m,1),this.setScreenBox(y.screenBox||[0,0,h.drawingBufferWidth/m,h.drawingBufferHeight/m]),this.screenBox,this.setViewBox(y.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/m,.125*(this.screenBox[3]-this.screenBox[1])/m,.875*(this.screenBox[2]-this.screenBox[0])/m,.875*(this.screenBox[3]-this.screenBox[1])/m]);var u=this.viewBox,_=(u[2]-u[0])/(u[3]-u[1]);this.setDataBox(y.dataBox||[-10,-10/_,10,10/_]),this.borderColor=y.borderColor!==!1?(y.borderColor||[0,0,0,0]).slice():!1,this.backgroundColor=(y.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(y.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(y.gridLineWidth||[1,1]).slice(),this.gridLineColor=i(y.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(y.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(y.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=i(y.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(y.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(y.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=i(y.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(y.titleCenter||[.5*(u[0]+u[2])/m,(u[3]+120)/m]).slice(),this.titleEnable=!("titleEnable"in y)||!!y.titleEnable,this.titleAngle=y.titleAngle||0,this.titleColor=(y.titleColor||[0,0,0,1]).slice(),this.labelPad=(y.labelPad||[15,15,15,15]).slice(),this.labelAngle=(y.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(y.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=i(y.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(y.tickPad||[15,15,15,15]).slice(),this.tickAngle=(y.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(y.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=i(y.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(y.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(y.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=i(y.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var s=y.ticks||[[],[]],A=this._tickBounds;A[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(var x=0;x<2;++x){var v=s[x].slice(0);v.length!==0&&(v.sort(g),A[x]=Math.min(A[x],v[0].x),A[x+2]=Math.max(A[x+2],v[v.length-1].x))}this.grid.update({bounds:A,ticks:s}),this.text.update({bounds:A,ticks:s,labels:y.labels||["x","y"],labelSize:y.labelSize||[12,12],labelFont:y.labelFont||["sans-serif","sans-serif"],title:y.title||"",titleSize:y.titleSize||18,titleFont:y.titleFont||"sans-serif"}),this.static=!!y.static,this.setDirty()},o.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var y=this.objects.length-1;y>=0;--y)this.objects[y].dispose();this.objects.length=0;for(var y=this.overlays.length-1;y>=0;--y)this.overlays[y].dispose();this.overlays.length=0,this.gl=null},o.addObject=function(y){this.objects.indexOf(y)<0&&(this.objects.push(y),this.setDirty())},o.removeObject=function(y){for(var h=this.objects,m=0;m<h.length;++m)if(h[m]===y){h.splice(m,1),this.setDirty();break}},o.addOverlay=function(y){this.overlays.indexOf(y)<0&&(this.overlays.push(y),this.setOverlayDirty())},o.removeOverlay=function(y){for(var h=this.overlays,m=0;m<h.length;++m)if(h[m]===y){h.splice(m,1),this.setOverlayDirty();break}};function p(y){var h=y.gl,m=e(h,[h.drawingBufferWidth,h.drawingBufferHeight]),u=new f(h,m);return u.grid=a(u),u.text=n(u),u.line=r(u),u.box=t(u),u.update(y),u}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(c,M,T){M.exports=o;var e=c("right-now"),a=c("3d-view"),n=c("mouse-change"),r=c("mouse-wheel"),t=c("mouse-event-offset"),f=c("has-passive-events");function o(i,g){i=i||document.body,g=g||{};var p=[.01,1/0];"distanceLimits"in g&&(p[0]=g.distanceLimits[0],p[1]=g.distanceLimits[1]),"zoomMin"in g&&(p[0]=g.zoomMin),"zoomMax"in g&&(p[1]=g.zoomMax);var y=a({center:g.center||[0,0,0],up:g.up||[0,1,0],eye:g.eye||[0,0,10],mode:g.mode||"orbit",distanceLimits:p}),h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=0,u=i.clientWidth,_=i.clientHeight,s={keyBindingMode:"rotate",enableWheel:!0,view:y,element:i,delay:g.delay||16,rotateSpeed:g.rotateSpeed||1,zoomSpeed:g.zoomSpeed||1,translateSpeed:g.translateSpeed||1,flipX:!!g.flipX,flipY:!!g.flipY,modes:y.modes,_ortho:g._ortho||g.projection&&g.projection.type==="orthographic"||!1,tick:function(){var A=e(),x=this.delay,v=A-2*x;y.idle(A-x),y.recalcMatrix(v),y.flush(A-(100+x*2));for(var b=!0,l=y.computedMatrix,L=0;L<16;++L)b=b&&h[L]===l[L],h[L]=l[L];var S=i.clientWidth===u&&i.clientHeight===_;return u=i.clientWidth,_=i.clientHeight,b?!S:(m=Math.exp(y.computedRadius[0]),!0)},lookAt:function(A,x,v){y.lookAt(y.lastT(),A,x,v)},rotate:function(A,x,v){y.rotate(y.lastT(),A,x,v)},pan:function(A,x,v){y.pan(y.lastT(),A,x,v)},translate:function(A,x,v){y.translate(y.lastT(),A,x,v)}};return Object.defineProperties(s,{matrix:{get:function(){return y.computedMatrix},set:function(A){return y.setMatrix(y.lastT(),A),y.computedMatrix},enumerable:!0},mode:{get:function(){return y.getMode()},set:function(A){var x=y.computedUp.slice(),v=y.computedEye.slice(),b=y.computedCenter.slice();if(y.setMode(A),A==="turntable"){var l=e();y._active.lookAt(l,v,b,x),y._active.lookAt(l+500,v,b,[0,0,1]),y._active.flush(l)}return y.getMode()},enumerable:!0},center:{get:function(){return y.computedCenter},set:function(A){return y.lookAt(y.lastT(),null,A),y.computedCenter},enumerable:!0},eye:{get:function(){return y.computedEye},set:function(A){return y.lookAt(y.lastT(),A),y.computedEye},enumerable:!0},up:{get:function(){return y.computedUp},set:function(A){return y.lookAt(y.lastT(),null,null,A),y.computedUp},enumerable:!0},distance:{get:function(){return m},set:function(A){return y.setDistance(y.lastT(),A),A},enumerable:!0},distanceLimits:{get:function(){return y.getDistanceLimits(p)},set:function(A){return y.setDistanceLimits(A),A},enumerable:!0}}),i.addEventListener("contextmenu",function(A){return A.preventDefault(),!1}),s._lastX=-1,s._lastY=-1,s._lastMods={shift:!1,control:!1,alt:!1,meta:!1},s.enableMouseListeners=function(){s.mouseListener=n(i,A),i.addEventListener("touchstart",function(x){var v=t(x.changedTouches[0],i);A(0,v[0],v[1],s._lastMods),A(1,v[0],v[1],s._lastMods)},f?{passive:!0}:!1),i.addEventListener("touchmove",function(x){var v=t(x.changedTouches[0],i);A(1,v[0],v[1],s._lastMods),x.preventDefault()},f?{passive:!1}:!1),i.addEventListener("touchend",function(x){A(0,s._lastX,s._lastY,s._lastMods)},f?{passive:!0}:!1);function A(x,v,b,l){var L=s.keyBindingMode;if(L!==!1){var S=L==="rotate",k=L==="pan",P=L==="zoom",z=!!l.control,I=!!l.alt,D=!!l.shift,R=!!(x&1),B=!!(x&2),F=!!(x&4),V=1/i.clientHeight,G=V*(v-s._lastX),J=V*(b-s._lastY),j=s.flipX?1:-1,Y=s.flipY?1:-1,X=Math.PI*s.rotateSpeed,oe=e();if(s._lastX!==-1&&s._lastY!==-1&&((S&&R&&!z&&!I&&!D||R&&!z&&!I&&D)&&y.rotate(oe,j*X*G,-Y*X*J,0),(k&&R&&!z&&!I&&!D||B||R&&z&&!I&&!D)&&y.pan(oe,-s.translateSpeed*G*m,s.translateSpeed*J*m,0),P&&R&&!z&&!I&&!D||F||R&&!z&&I&&!D)){var se=-s.zoomSpeed*J/window.innerHeight*(oe-y.lastT())*100;y.pan(oe,0,0,m*(Math.exp(se)-1))}return s._lastX=v,s._lastY=b,s._lastMods=l,!0}}s.wheelListener=r(i,function(x,v){if(s.keyBindingMode!==!1&&!!s.enableWheel){var b=s.flipX?1:-1,l=s.flipY?1:-1,L=e();if(Math.abs(x)>Math.abs(v))y.rotate(L,0,0,-x*b*Math.PI*s.rotateSpeed/window.innerWidth);else if(!s._ortho){var S=-s.zoomSpeed*l*v/window.innerHeight*(L-y.lastT())/20;y.pan(L,0,0,m*(Math.exp(S)-1))}}},!0)},s.enableMouseListeners(),s}},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(c,M,T){var e=c("glslify"),a=c("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),r=e([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);M.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(c,M,T){var e=c("./camera.js"),a=c("gl-axes3d"),n=c("gl-axes3d/properties"),r=c("gl-spikes3d"),t=c("gl-select-static"),f=c("gl-fbo"),o=c("a-big-triangle"),i=c("mouse-change"),g=c("gl-mat4/perspective"),p=c("gl-mat4/ortho"),y=c("./lib/shader"),h=c("is-mobile")({tablet:!0,featureDetect:!0});M.exports={createScene:A,createCamera:e};function m(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function u(v,b){var l=null;try{l=v.getContext("webgl",b),l||(l=v.getContext("experimental-webgl",b))}catch{return null}return l}function _(v){var b=Math.round(Math.log(Math.abs(v))/Math.log(10));if(b<0){var l=Math.round(Math.pow(10,-b));return Math.ceil(v*l)/l}else if(b>0){var l=Math.round(Math.pow(10,b));return Math.ceil(v/l)*l}return Math.ceil(v)}function s(v){return typeof v=="boolean"?v:!0}function A(v){v=v||{},v.camera=v.camera||{};var b=v.canvas;if(!b)if(b=document.createElement("canvas"),v.container){var l=v.container;l.appendChild(b)}else document.body.appendChild(b);var L=v.gl;if(L||(v.glOptions&&(h=!!v.glOptions.preserveDrawingBuffer),L=u(b,v.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:h})),!L)throw new Error("webgl not supported");var S=v.bounds||[[-10,-10,-10],[10,10,10]],k=new m,P=f(L,L.drawingBufferWidth,L.drawingBufferHeight,{preferFloat:!h}),z=y(L),I=v.cameraObject&&v.cameraObject._ortho===!0||v.camera.projection&&v.camera.projection.type==="orthographic"||!1,D={eye:v.camera.eye||[2,0,0],center:v.camera.center||[0,0,0],up:v.camera.up||[0,1,0],zoomMin:v.camera.zoomMax||.1,zoomMax:v.camera.zoomMin||100,mode:v.camera.mode||"turntable",_ortho:I},R=v.axes||{},B=a(L,R);B.enable=!R.disable;var F=v.spikes||{},V=r(L,F),G=[],J=[],j=[],Y=[],X=!0,N=!0,oe=new Array(16),se=new Array(16),ie={view:null,projection:oe,model:se,_ortho:!1},N=!0,U=[L.drawingBufferWidth,L.drawingBufferHeight],q=v.cameraObject||e(b,D),Q={gl:L,contextLost:!1,pixelRatio:v.pixelRatio||1,canvas:b,selection:k,camera:q,axes:B,axesPixels:null,spikes:V,bounds:S,objects:G,shape:U,aspect:v.aspectRatio||[1,1,1],pickRadius:v.pickRadius||10,zNear:v.zNear||.01,zFar:v.zFar||1e3,fovy:v.fovy||Math.PI/4,clearColor:v.clearColor||[0,0,0,0],autoResize:s(v.autoResize),autoBounds:s(v.autoBounds),autoScale:!!v.autoScale,autoCenter:s(v.autoCenter),clipToBounds:s(v.clipToBounds),snapToData:!!v.snapToData,onselect:v.onselect||null,onrender:v.onrender||null,onclick:v.onclick||null,cameraParams:ie,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(ge){this.aspect[0]=ge.x,this.aspect[1]=ge.y,this.aspect[2]=ge.z,N=!0},setBounds:function(ge,Ae){this.bounds[0][ge]=Ae.min,this.bounds[1][ge]=Ae.max},setClearColor:function(ge){this.clearColor=ge},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},W=[L.drawingBufferWidth/Q.pixelRatio|0,L.drawingBufferHeight/Q.pixelRatio|0];function Z(){if(!Q._stopped&&!!Q.autoResize){var ge=b.parentNode,Ae=1,we=1;ge&&ge!==document.body?(Ae=ge.clientWidth,we=ge.clientHeight):(Ae=window.innerWidth,we=window.innerHeight);var De=Math.ceil(Ae*Q.pixelRatio)|0,Be=Math.ceil(we*Q.pixelRatio)|0;if(De!==b.width||Be!==b.height){b.width=De,b.height=Be;var Ve=b.style;Ve.position=Ve.position||"absolute",Ve.left="0px",Ve.top="0px",Ve.width=Ae+"px",Ve.height=we+"px",X=!0}}}Q.autoResize&&Z(),window.addEventListener("resize",Z);function ee(){for(var ge=G.length,Ae=Y.length,we=0;we<Ae;++we)j[we]=0;e:for(var we=0;we<ge;++we){var De=G[we],Be=De.pickSlots;if(!Be){J[we]=-1;continue}for(var Ve=0;Ve<Ae;++Ve)if(j[Ve]+Be<255){J[we]=Ve,De.setPickBase(j[Ve]+1),j[Ve]+=Be;continue e}var xe=t(L,U);J[we]=Ae,Y.push(xe),j.push(Be),De.setPickBase(1),Ae+=1}for(;Ae>0&&j[Ae-1]===0;)j.pop(),Y.pop().dispose()}Q.update=function(ge){Q._stopped||(X=!0,N=!0)},Q.add=function(ge){Q._stopped||(ge.axes=B,G.push(ge),J.push(-1),X=!0,N=!0,ee())},Q.remove=function(ge){if(!Q._stopped){var Ae=G.indexOf(ge);Ae<0||(G.splice(Ae,1),J.pop(),X=!0,N=!0,ee())}},Q.dispose=function(){if(!Q._stopped&&(Q._stopped=!0,window.removeEventListener("resize",Z),b.removeEventListener("webglcontextlost",te),Q.mouseListener.enabled=!1,!Q.contextLost)){B.dispose(),V.dispose();for(var ge=0;ge<G.length;++ge)G[ge].dispose();P.dispose();for(var ge=0;ge<Y.length;++ge)Y[ge].dispose();z.dispose(),L=null,B=null,V=null,G=[]}},Q._mouseRotating=!1,Q._prevButtons=0,Q.enableMouseListeners=function(){Q.mouseListener=i(b,function(ge,Ae,we){if(!Q._stopped){var De=Y.length,Be=G.length,Ve=k.object;k.distance=1/0,k.mouse[0]=Ae,k.mouse[1]=we,k.object=null,k.screen=null,k.dataCoordinate=k.dataPosition=null;var xe=!1;if(ge&&Q._prevButtons)Q._mouseRotating=!0;else{Q._mouseRotating&&(N=!0),Q._mouseRotating=!1;for(var Le=0;Le<De;++Le){var He=Y[Le].query(Ae,W[1]-we-1,Q.pickRadius);if(He){if(He.distance>k.distance)continue;for(var Je=0;Je<Be;++Je){var Oe=G[Je];if(J[Je]===Le){var Pe=Oe.pick(He);Pe&&(k.buttons=ge,k.screen=He.coord,k.distance=He.distance,k.object=Oe,k.index=Pe.distance,k.dataPosition=Pe.position,k.dataCoordinate=Pe.dataCoordinate,k.data=Pe,xe=!0)}}}}}Ve&&Ve!==k.object&&(Ve.highlight&&Ve.highlight(null),X=!0),k.object&&(k.object.highlight&&k.object.highlight(k.data),X=!0),xe=xe||k.object!==Ve,xe&&Q.onselect&&Q.onselect(k),ge&1&&!(Q._prevButtons&1)&&Q.onclick&&Q.onclick(k),Q._prevButtons=ge}})};function te(){if(Q.contextLost)return!0;L.isContextLost()&&(Q.contextLost=!0,Q.mouseListener.enabled=!1,Q.selection.object=null,Q.oncontextloss&&Q.oncontextloss())}b.addEventListener("webglcontextlost",te);function ae(){if(!te()){L.colorMask(!0,!0,!0,!0),L.depthMask(!0),L.disable(L.BLEND),L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL);for(var ge=G.length,Ae=Y.length,we=0;we<Ae;++we){var De=Y[we];De.shape=W,De.begin();for(var Be=0;Be<ge;++Be)if(J[Be]===we){var Ve=G[Be];Ve.drawPick&&(Ve.pixelRatio=1,Ve.drawPick(ie))}De.end()}}}var le=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],ye=[le[0].slice(),le[1].slice()];function fe(){if(!te()){Z();var ge=Q.camera.tick();ie.view=Q.camera.matrix,X=X||ge,N=N||ge,B.pixelRatio=Q.pixelRatio,V.pixelRatio=Q.pixelRatio;var Ae=G.length,we=le[0],De=le[1];we[0]=we[1]=we[2]=1/0,De[0]=De[1]=De[2]=-1/0;for(var Be=0;Be<Ae;++Be){var Ve=G[Be];Ve.pixelRatio=Q.pixelRatio,Ve.axes=Q.axes,X=X||!!Ve.dirty,N=N||!!Ve.dirty;var xe=Ve.bounds;if(xe)for(var Le=xe[0],He=xe[1],Je=0;Je<3;++Je)we[Je]=Math.min(we[Je],Le[Je]),De[Je]=Math.max(De[Je],He[Je])}var Oe=Q.bounds;if(Q.autoBounds)for(var Je=0;Je<3;++Je){if(De[Je]<we[Je])we[Je]=-1,De[Je]=1;else{we[Je]===De[Je]&&(we[Je]-=1,De[Je]+=1);var Pe=.05*(De[Je]-we[Je]);we[Je]=we[Je]-Pe,De[Je]=De[Je]+Pe}Oe[0][Je]=we[Je],Oe[1][Je]=De[Je]}for(var Ue=!1,Je=0;Je<3;++Je)Ue=Ue||ye[0][Je]!==Oe[0][Je]||ye[1][Je]!==Oe[1][Je],ye[0][Je]=Oe[0][Je],ye[1][Je]=Oe[1][Je];if(N=N||Ue,X=X||Ue,!!X){if(Ue){for(var vt=[0,0,0],Be=0;Be<3;++Be)vt[Be]=_((Oe[1][Be]-Oe[0][Be])/10);B.autoTicks?B.update({bounds:Oe,tickSpacing:vt}):B.update({bounds:Oe})}var Lt=L.drawingBufferWidth,Yt=L.drawingBufferHeight;U[0]=Lt,U[1]=Yt,W[0]=Math.max(Lt/Q.pixelRatio,1)|0,W[1]=Math.max(Yt/Q.pixelRatio,1)|0,x(Q,I);for(var Be=0;Be<Ae;++Be){var Ve=G[Be];Ve.axesBounds=Oe,Q.clipToBounds&&(Ve.clipBounds=Oe)}k.object&&(Q.snapToData?V.position=k.dataCoordinate:V.position=k.dataPosition,V.bounds=Oe),N&&(N=!1,ae()),Q.axesPixels=n(Q.axes,ie,Lt,Yt),Q.onrender&&Q.onrender(),L.bindFramebuffer(L.FRAMEBUFFER,null),L.viewport(0,0,Lt,Yt),Q.clearRGBA(),L.depthMask(!0),L.colorMask(!0,!0,!0,!0),L.enable(L.DEPTH_TEST),L.depthFunc(L.LEQUAL),L.disable(L.BLEND),L.disable(L.CULL_FACE);var At=!1;B.enable&&(At=At||B.isTransparent(),B.draw(ie)),V.axes=B,k.object&&V.draw(ie),L.disable(L.CULL_FACE);for(var Be=0;Be<Ae;++Be){var Ve=G[Be];Ve.axes=B,Ve.pixelRatio=Q.pixelRatio,Ve.isOpaque&&Ve.isOpaque()&&Ve.draw(ie),Ve.isTransparent&&Ve.isTransparent()&&(At=!0)}if(At){P.shape=U,P.bind(),L.clear(L.DEPTH_BUFFER_BIT),L.colorMask(!1,!1,!1,!1),L.depthMask(!0),L.depthFunc(L.LESS),B.enable&&B.isTransparent()&&B.drawTransparent(ie);for(var Be=0;Be<Ae;++Be){var Ve=G[Be];Ve.isOpaque&&Ve.isOpaque()&&Ve.draw(ie)}L.enable(L.BLEND),L.blendEquation(L.FUNC_ADD),L.blendFunc(L.ONE,L.ONE_MINUS_SRC_ALPHA),L.colorMask(!0,!0,!0,!0),L.depthMask(!1),L.clearColor(0,0,0,0),L.clear(L.COLOR_BUFFER_BIT),B.isTransparent()&&B.drawTransparent(ie);for(var Be=0;Be<Ae;++Be){var Ve=G[Be];Ve.isTransparent&&Ve.isTransparent()&&Ve.drawTransparent(ie)}L.bindFramebuffer(L.FRAMEBUFFER,null),L.blendFunc(L.ONE,L.ONE_MINUS_SRC_ALPHA),L.disable(L.DEPTH_TEST),z.bind(),P.color[0].bind(0),z.uniforms.accumBuffer=0,o(L),L.disable(L.BLEND)}X=!1;for(var Be=0;Be<Ae;++Be)G[Be].dirty=!1}}}function pe(){Q._stopped||Q.contextLost||(fe(),requestAnimationFrame(pe))}return Q.enableMouseListeners(),pe(),Q.redraw=function(){Q._stopped||(X=!0,fe())},Q}function x(v,b){var l=v.bounds,L=v.cameraParams,S=L.projection,k=L.model,P=v.gl.drawingBufferWidth,z=v.gl.drawingBufferHeight,I=v.zNear,D=v.zFar,R=v.fovy,B=P/z;b?(p(S,-B,B,-1,1,I,D),L._ortho=!0):(g(S,R,B,I,D),L._ortho=!1);for(var F=0;F<16;++F)k[F]=0;k[15]=1;for(var V=0,F=0;F<3;++F)V=Math.max(V,l[1][F]-l[0][F]);for(var F=0;F<3;++F)v.autoScale?k[5*F]=v.aspect[F]/(l[1][F]-l[0][F]):k[5*F]=1/V,v.autoCenter&&(k[12+F]=-k[5*F]*.5*(l[0][F]+l[1][F]))}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(c,M,T){var e=c("glslify");T.pointVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),T.pointFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),T.pickVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),T.pickFragment=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:231}],123:[function(c,M,T){var e=c("gl-shader"),a=c("gl-buffer"),n=c("typedarray-pool"),r=c("./lib/shader");M.exports=i;function t(g,p,y,h,m){this.plot=g,this.offsetBuffer=p,this.pickBuffer=y,this.shader=h,this.pickShader=m,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}var f=t.prototype;f.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},f.update=function(g){var p;g=g||{};function y(x,v){return x in g?g[x]:v}this.sizeMin=y("sizeMin",.5),this.sizeMax=y("sizeMax",20),this.color=y("color",[1,0,0,1]).slice(),this.areaRatio=y("areaRatio",1),this.borderColor=y("borderColor",[0,0,0,1]).slice(),this.blend=y("blend",!1);var h=g.positions.length>>>1,m=g.positions instanceof Float32Array,u=g.idToIndex instanceof Int32Array&&g.idToIndex.length>=h,_=g.positions,s=m?_:n.mallocFloat32(_.length),A=u?g.idToIndex:n.mallocInt32(h);if(m||s.set(_),!u)for(s.set(_),p=0;p<h;p++)A[p]=p;this.points=_,this.offsetBuffer.update(s),this.pickBuffer.update(A),m||n.free(s),u||n.free(A),this.pointCount=h,this.pickOffset=0};function o(g,p){var y=0,h=g.length>>>1,m;for(m=0;m<h;m++){var u=g[m*2],_=g[m*2+1];u>=p[0]&&u<=p[2]&&_>=p[1]&&_<=p[3]&&y++}return y}f.unifiedDraw=function(){var g=[1,0,0,0,1,0,0,0,1],p=[0,0,0,0];return function(y){var h=y!==void 0,m=h?this.pickShader:this.shader,u=this.plot.gl,_=this.plot.dataBox;if(this.pointCount===0)return y;var s=_[2]-_[0],A=_[3]-_[1],x=o(this.points,_),v=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(x,.33333)));g[0]=2/s,g[4]=2/A,g[6]=-2*_[0]/s-1,g[7]=-2*_[1]/A-1,this.offsetBuffer.bind(),m.bind(),m.attributes.position.pointer(),m.uniforms.matrix=g,m.uniforms.color=this.color,m.uniforms.borderColor=this.borderColor,m.uniforms.pointCloud=v<5,m.uniforms.pointSize=v,m.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),h&&(p[0]=y&255,p[1]=y>>8&255,p[2]=y>>16&255,p[3]=y>>24&255,this.pickBuffer.bind(),m.attributes.pickId.pointer(u.UNSIGNED_BYTE),m.uniforms.pickOffset=p,this.pickOffset=y);var b=u.getParameter(u.BLEND),l=u.getParameter(u.DITHER);return b&&!this.blend&&u.disable(u.BLEND),l&&u.disable(u.DITHER),u.drawArrays(u.POINTS,0,this.pointCount),b&&!this.blend&&u.enable(u.BLEND),l&&u.enable(u.DITHER),y+this.pointCount}}(),f.draw=f.unifiedDraw,f.drawPick=f.unifiedDraw,f.pick=function(g,p,y){var h=this.pickOffset,m=this.pointCount;if(y<h||y>=h+m)return null;var u=y-h,_=this.points;return{object:this,pointId:u,dataCoord:[_[2*u],_[2*u+1]]}};function i(g,p){var y=g.gl,h=a(y),m=a(y),u=e(y,r.pointVertex,r.pointFragment),_=e(y,r.pickVertex,r.pickFragment),s=new t(g,h,m,u,_);return s.update(p),g.addObject(s),s}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(c,M,T){M.exports=e;function e(a,n,r,t){var f=n[0],o=n[1],i=n[2],g=n[3],p=r[0],y=r[1],h=r[2],m=r[3],u,_,s,A,x;return _=f*p+o*y+i*h+g*m,_<0&&(_=-_,p=-p,y=-y,h=-h,m=-m),1-_>1e-6?(u=Math.acos(_),s=Math.sin(u),A=Math.sin((1-t)*u)/s,x=Math.sin(t*u)/s):(A=1-t,x=t),a[0]=A*f+x*p,a[1]=A*o+x*y,a[2]=A*i+x*h,a[3]=A*g+x*m,a}},{}],125:[function(c,M,T){M.exports=function(e){return!e&&e!==0?"":e.toString()}},{}],126:[function(c,M,T){var e=c("vectorize-text");M.exports=n;var a={};function n(r,t,f){var o=a[t];if(o||(o=a[t]={}),r in o)return o[r];var i={textAlign:"center",textBaseline:"middle",lineHeight:1,font:t,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}};i.triangles=!0;var g=e(r,i);i.triangles=!1;var p=e(r,i),y,h;if(f&&f!==1){for(y=0;y<g.positions.length;++y)for(h=0;h<g.positions[y].length;++h)g.positions[y][h]/=f;for(y=0;y<p.positions.length;++y)for(h=0;h<p.positions[y].length;++h)p.positions[y][h]/=f}var m=[[1/0,1/0],[-1/0,-1/0]],u=p.positions.length;for(y=0;y<u;++y){var _=p.positions[y];for(h=0;h<2;++h)m[0][h]=Math.min(m[0][h],_[h]),m[1][h]=Math.max(m[1][h],_[h])}return o[r]=[g,p,m]}},{"vectorize-text":311}],127:[function(c,M,T){var e=c("gl-shader"),a=c("glslify"),n=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),r=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),t=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),f=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),o=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),i=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],g={vertex:n,fragment:f,attributes:i},p={vertex:r,fragment:f,attributes:i},y={vertex:t,fragment:f,attributes:i},h={vertex:n,fragment:o,attributes:i},m={vertex:r,fragment:o,attributes:i},u={vertex:t,fragment:o,attributes:i};function _(s,A){var x=e(s,A),v=x.attributes;return v.position.location=0,v.color.location=1,v.glyph.location=2,v.id.location=3,x}T.createPerspective=function(s){return _(s,g)},T.createOrtho=function(s){return _(s,p)},T.createProject=function(s){return _(s,y)},T.createPickPerspective=function(s){return _(s,h)},T.createPickOrtho=function(s){return _(s,m)},T.createPickProject=function(s){return _(s,u)}},{"gl-shader":132,glslify:231}],128:[function(c,M,T){var e=c("is-string-blank"),a=c("gl-buffer"),n=c("gl-vao"),r=c("typedarray-pool"),t=c("gl-mat4/multiply"),f=c("./lib/shaders"),o=c("./lib/glyphs"),i=c("./lib/get-simple-string"),g=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];M.exports=J;function p(j,Y){var X=j[0],oe=j[1],se=j[2],ie=j[3];return j[0]=Y[0]*X+Y[4]*oe+Y[8]*se+Y[12]*ie,j[1]=Y[1]*X+Y[5]*oe+Y[9]*se+Y[13]*ie,j[2]=Y[2]*X+Y[6]*oe+Y[10]*se+Y[14]*ie,j[3]=Y[3]*X+Y[7]*oe+Y[11]*se+Y[15]*ie,j}function y(j,Y,X,oe){return p(oe,oe),p(oe,oe),p(oe,oe)}function h(j,Y){this.index=j,this.dataCoordinate=this.position=Y}function m(j){return j===!0||j>1?1:j}function u(j,Y,X,oe,se,ie,N,U,q,Q,W,Z){this.gl=j,this.pixelRatio=1,this.shader=Y,this.orthoShader=X,this.projectShader=oe,this.pointBuffer=se,this.colorBuffer=ie,this.glyphBuffer=N,this.idBuffer=U,this.vao=q,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=Q,this.pickOrthoShader=W,this.pickProjectShader=Z,this.points=[],this._selectResult=new h(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}var _=u.prototype;_.pickSlots=1,_.setPickBase=function(j){this.pickId=j},_.isTransparent=function(){if(this.hasAlpha)return!0;for(var j=0;j<3;++j)if(this.axesProject[j]&&this.projectHasAlpha)return!0;return!1},_.isOpaque=function(){if(!this.hasAlpha)return!0;for(var j=0;j<3;++j)if(this.axesProject[j]&&!this.projectHasAlpha)return!0;return!1};var s=[0,0],A=[0,0,0],x=[0,0,0],v=[0,0,0,1],b=[0,0,0,1],l=g.slice(),L=[0,0,0],S=[[0,0,0],[0,0,0]];function k(j){return j[0]=j[1]=j[2]=0,j}function P(j,Y){return j[0]=Y[0],j[1]=Y[1],j[2]=Y[2],j[3]=1,j}function z(j,Y,X,oe){return j[0]=Y[0],j[1]=Y[1],j[2]=Y[2],j[X]=oe,j}function I(j){for(var Y=S,X=0;X<2;++X)for(var oe=0;oe<3;++oe)Y[X][oe]=Math.max(Math.min(j[X][oe],1e8),-1e8);return Y}function D(j,Y,X,oe){var se=Y.axesProject,ie=Y.gl,N=j.uniforms,U=X.model||g,q=X.view||g,Q=X.projection||g,W=Y.axesBounds,Z=I(Y.clipBounds),ee;Y.axes&&Y.axes.lastCubeProps?ee=Y.axes.lastCubeProps.axis:ee=[1,1,1],s[0]=2/ie.drawingBufferWidth,s[1]=2/ie.drawingBufferHeight,j.bind(),N.view=q,N.projection=Q,N.screenSize=s,N.highlightId=Y.highlightId,N.highlightScale=Y.highlightScale,N.clipBounds=Z,N.pickGroup=Y.pickId/255,N.pixelRatio=oe;for(var te=0;te<3;++te)if(!!se[te]){N.scale=Y.projectScale[te],N.opacity=Y.projectOpacity[te];for(var ae=l,le=0;le<16;++le)ae[le]=0;for(var le=0;le<4;++le)ae[5*le]=1;ae[5*te]=0,ee[te]<0?ae[12+te]=W[0][te]:ae[12+te]=W[1][te],t(ae,U,ae),N.model=ae;var ye=(te+1)%3,fe=(te+2)%3,pe=k(A),ge=k(x);pe[ye]=1,ge[fe]=1;var Ae=y(Q,q,U,P(v,pe)),we=y(Q,q,U,P(b,ge));if(Math.abs(Ae[1])>Math.abs(we[1])){var De=Ae;Ae=we,we=De,De=pe,pe=ge,ge=De;var Be=ye;ye=fe,fe=Be}Ae[0]<0&&(pe[ye]=-1),we[1]>0&&(ge[fe]=-1);for(var Ve=0,xe=0,le=0;le<4;++le)Ve+=Math.pow(U[4*ye+le],2),xe+=Math.pow(U[4*fe+le],2);pe[ye]/=Math.sqrt(Ve),ge[fe]/=Math.sqrt(xe),N.axes[0]=pe,N.axes[1]=ge,N.fragClipBounds[0]=z(L,Z[0],te,-1e8),N.fragClipBounds[1]=z(L,Z[1],te,1e8),Y.vao.bind(),Y.vao.draw(ie.TRIANGLES,Y.vertexCount),Y.lineWidth>0&&(ie.lineWidth(Y.lineWidth*oe),Y.vao.draw(ie.LINES,Y.lineVertexCount,Y.vertexCount)),Y.vao.unbind()}}var R=[-1e8,-1e8,-1e8],B=[1e8,1e8,1e8],F=[R,B];function V(j,Y,X,oe,se,ie,N){var U=X.gl;if((ie===X.projectHasAlpha||N)&&D(Y,X,oe,se),ie===X.hasAlpha||N){j.bind();var q=j.uniforms;q.model=oe.model||g,q.view=oe.view||g,q.projection=oe.projection||g,s[0]=2/U.drawingBufferWidth,s[1]=2/U.drawingBufferHeight,q.screenSize=s,q.highlightId=X.highlightId,q.highlightScale=X.highlightScale,q.fragClipBounds=F,q.clipBounds=X.axes.bounds,q.opacity=X.opacity,q.pickGroup=X.pickId/255,q.pixelRatio=se,X.vao.bind(),X.vao.draw(U.TRIANGLES,X.vertexCount),X.lineWidth>0&&(U.lineWidth(X.lineWidth*se),X.vao.draw(U.LINES,X.lineVertexCount,X.vertexCount)),X.vao.unbind()}}_.draw=function(j){var Y=this.useOrtho?this.orthoShader:this.shader;V(Y,this.projectShader,this,j,this.pixelRatio,!1,!1)},_.drawTransparent=function(j){var Y=this.useOrtho?this.orthoShader:this.shader;V(Y,this.projectShader,this,j,this.pixelRatio,!0,!1)},_.drawPick=function(j){var Y=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;V(Y,this.pickProjectShader,this,j,1,!0,!0)},_.pick=function(j){if(!j||j.id!==this.pickId)return null;var Y=j.value[2]+(j.value[1]<<8)+(j.value[0]<<16);if(Y>=this.pointCount||Y<0)return null;var X=this.points[Y],oe=this._selectResult;oe.index=Y;for(var se=0;se<3;++se)oe.position[se]=oe.dataCoordinate[se]=X[se];return oe},_.highlight=function(j){if(!j)this.highlightId=[1,1,1,1];else{var Y=j.index,X=Y&255,oe=Y>>8&255,se=Y>>16&255;this.highlightId=[X/255,oe/255,se/255,0]}};function G(j,Y,X,oe){var se;Array.isArray(j)?Y<j.length?se=j[Y]:se=void 0:se=j,se=i(se);var ie=!0;e(se)&&(se="\u25BC",ie=!1);var N=o(se,X,oe);return{mesh:N[0],lines:N[1],bounds:N[2],visible:ie}}_.update=function(j){if(j=j||{},"perspective"in j&&(this.useOrtho=!j.perspective),"orthographic"in j&&(this.useOrtho=!!j.orthographic),"lineWidth"in j&&(this.lineWidth=j.lineWidth),"project"in j)if(Array.isArray(j.project))this.axesProject=j.project;else{var Y=!!j.project;this.axesProject=[Y,Y,Y]}if("projectScale"in j)if(Array.isArray(j.projectScale))this.projectScale=j.projectScale.slice();else{var X=+j.projectScale;this.projectScale=[X,X,X]}if(this.projectHasAlpha=!1,"projectOpacity"in j){if(Array.isArray(j.projectOpacity))this.projectOpacity=j.projectOpacity.slice();else{var X=+j.projectOpacity;this.projectOpacity=[X,X,X]}for(var oe=0;oe<3;++oe)this.projectOpacity[oe]=m(this.projectOpacity[oe]),this.projectOpacity[oe]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in j&&(this.opacity=m(j.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var se=j.position,ie=j.font||"normal",N=j.alignment||[0,0],U,q;if(N.length===2)U=N[0],q=N[1];else{U=[],q=[];for(var oe=0;oe<N.length;++oe)U[oe]=N[oe][0],q[oe]=N[oe][1]}var Q=[1/0,1/0,1/0],W=[-1/0,-1/0,-1/0],Z=j.glyph,ee=j.color,te=j.size,ae=j.angle,le=j.lineColor,ye=-1,fe=0,pe=0,ge=0;if(se.length){ge=se.length;e:for(var oe=0;oe<ge;++oe){for(var Ae=se[oe],we=0;we<3;++we)if(isNaN(Ae[we])||!isFinite(Ae[we]))continue e;var De=G(Z,oe,ie,this.pixelRatio),Be=De.mesh,Ve=De.lines,xe=De.bounds;fe+=Be.cells.length*3,pe+=Ve.edges.length*2}}var Le=fe+pe,He=r.mallocFloat(3*Le),Je=r.mallocFloat(4*Le),Oe=r.mallocFloat(2*Le),Pe=r.mallocUint32(Le);if(Le>0){var Ue=0,vt=fe,Lt=[0,0,0,1],Yt=[0,0,0,1],At=Array.isArray(ee)&&Array.isArray(ee[0]),Rt=Array.isArray(le)&&Array.isArray(le[0]);e:for(var oe=0;oe<ge;++oe){ye+=1;for(var Ae=se[oe],we=0;we<3;++we){if(isNaN(Ae[we])||!isFinite(Ae[we]))continue e;W[we]=Math.max(W[we],Ae[we]),Q[we]=Math.min(Q[we],Ae[we])}var De=G(Z,oe,ie,this.pixelRatio),Be=De.mesh,Ve=De.lines,xe=De.bounds,Bt=De.visible;if(!Bt)Lt=[1,1,1,0];else if(Array.isArray(ee)){var Mt;if(At?oe<ee.length?Mt=ee[oe]:Mt=[0,0,0,0]:Mt=ee,Mt.length===3){for(var we=0;we<3;++we)Lt[we]=Mt[we];Lt[3]=1}else if(Mt.length===4){for(var we=0;we<4;++we)Lt[we]=Mt[we];!this.hasAlpha&&Mt[3]<1&&(this.hasAlpha=!0)}}else Lt[0]=Lt[1]=Lt[2]=0,Lt[3]=1;if(!Bt)Yt=[1,1,1,0];else if(Array.isArray(le)){var Mt;if(Rt?oe<le.length?Mt=le[oe]:Mt=[0,0,0,0]:Mt=le,Mt.length===3){for(var we=0;we<3;++we)Yt[we]=Mt[we];Yt[we]=1}else if(Mt.length===4){for(var we=0;we<4;++we)Yt[we]=Mt[we];!this.hasAlpha&&Mt[3]<1&&(this.hasAlpha=!0)}}else Yt[0]=Yt[1]=Yt[2]=0,Yt[3]=1;var Tt=.5;Bt?Array.isArray(te)?oe<te.length?Tt=+te[oe]:Tt=12:te?Tt=+te:this.useOrtho&&(Tt=12):Tt=0;var at=0;Array.isArray(ae)?oe<ae.length?at=+ae[oe]:at=0:ae&&(at=+ae);for(var ct=Math.cos(at),je=Math.sin(at),Ae=se[oe],we=0;we<3;++we)W[we]=Math.max(W[we],Ae[we]),Q[we]=Math.min(Q[we],Ae[we]);var ke=U,Ye=q,ke=0;Array.isArray(U)?oe<U.length?ke=U[oe]:ke=0:U&&(ke=U);var Ye=0;Array.isArray(q)?oe<q.length?Ye=q[oe]:Ye=0:q&&(Ye=q),ke*=ke>0?1-xe[0][0]:ke<0?1+xe[1][0]:1,Ye*=Ye>0?1-xe[0][1]:Ye<0?1+xe[1][1]:1;for(var Ke=[ke,Ye],$t=Be.cells||[],Ot=Be.positions||[],we=0;we<$t.length;++we)for(var st=$t[we],Et=0;Et<3;++Et){for(var bt=0;bt<3;++bt)He[3*Ue+bt]=Ae[bt];for(var bt=0;bt<4;++bt)Je[4*Ue+bt]=Lt[bt];Pe[Ue]=ye;var zt=Ot[st[Et]];Oe[2*Ue]=Tt*(ct*zt[0]-je*zt[1]+Ke[0]),Oe[2*Ue+1]=Tt*(je*zt[0]+ct*zt[1]+Ke[1]),Ue+=1}for(var $t=Ve.edges,Ot=Ve.positions,we=0;we<$t.length;++we)for(var st=$t[we],Et=0;Et<2;++Et){for(var bt=0;bt<3;++bt)He[3*vt+bt]=Ae[bt];for(var bt=0;bt<4;++bt)Je[4*vt+bt]=Yt[bt];Pe[vt]=ye;var zt=Ot[st[Et]];Oe[2*vt]=Tt*(ct*zt[0]-je*zt[1]+Ke[0]),Oe[2*vt+1]=Tt*(je*zt[0]+ct*zt[1]+Ke[1]),vt+=1}}}this.bounds=[Q,W],this.points=se,this.pointCount=se.length,this.vertexCount=fe,this.lineVertexCount=pe,this.pointBuffer.update(He),this.colorBuffer.update(Je),this.glyphBuffer.update(Oe),this.idBuffer.update(Pe),r.free(He),r.free(Je),r.free(Oe),r.free(Pe)},_.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()};function J(j){var Y=j.gl,X=f.createPerspective(Y),oe=f.createOrtho(Y),se=f.createProject(Y),ie=f.createPickPerspective(Y),N=f.createPickOrtho(Y),U=f.createPickProject(Y),q=a(Y),Q=a(Y),W=a(Y),Z=a(Y),ee=n(Y,[{buffer:q,size:3,type:Y.FLOAT},{buffer:Q,size:4,type:Y.FLOAT},{buffer:W,size:2,type:Y.FLOAT},{buffer:Z,size:4,type:Y.UNSIGNED_BYTE,normalized:!0}]),te=new u(Y,X,oe,se,q,Q,W,Z,ee,ie,N,U);return te.update(j),te}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(c,M,T){var e=c("glslify");T.boxVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),T.boxFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:231}],130:[function(c,M,T){var e=c("gl-shader"),a=c("gl-buffer"),n=c("./lib/shaders");M.exports=f;function r(o,i,g){this.plot=o,this.boxBuffer=i,this.boxShader=g,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}var t=r.prototype;t.draw=function(){if(!!this.enabled){var o=this.plot,i=this.selectBox,g=this.borderWidth;this.innerFill;var p=this.innerColor;this.outerFill;var y=this.outerColor,h=this.borderColor,m=o.box,u=o.screenBox,_=o.dataBox,s=o.viewBox,A=o.pixelRatio,x=(i[0]-_[0])*(s[2]-s[0])/(_[2]-_[0])+s[0],v=(i[1]-_[1])*(s[3]-s[1])/(_[3]-_[1])+s[1],b=(i[2]-_[0])*(s[2]-s[0])/(_[2]-_[0])+s[0],l=(i[3]-_[1])*(s[3]-s[1])/(_[3]-_[1])+s[1];if(x=Math.max(x,s[0]),v=Math.max(v,s[1]),b=Math.min(b,s[2]),l=Math.min(l,s[3]),!(b<x||l<v)){m.bind();var L=u[2]-u[0],S=u[3]-u[1];if(this.outerFill&&(m.drawBox(0,0,L,v,y),m.drawBox(0,v,x,l,y),m.drawBox(0,l,L,S,y),m.drawBox(b,v,L,l,y)),this.innerFill&&m.drawBox(x,v,b,l,p),g>0){var k=g*A;m.drawBox(x-k,v-k,b+k,v+k,h),m.drawBox(x-k,l-k,b+k,l+k,h),m.drawBox(x-k,v-k,x+k,l+k,h),m.drawBox(b-k,v-k,b+k,l+k,h)}}}},t.update=function(o){o=o||{},this.innerFill=!!o.innerFill,this.outerFill=!!o.outerFill,this.innerColor=(o.innerColor||[0,0,0,.5]).slice(),this.outerColor=(o.outerColor||[0,0,0,.5]).slice(),this.borderColor=(o.borderColor||[0,0,0,1]).slice(),this.borderWidth=o.borderWidth||0,this.selectBox=(o.selectBox||this.selectBox).slice()},t.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)};function f(o,i){var g=o.gl,p=a(g,[0,0,0,1,1,0,1,1]),y=e(g,n.boxVertex,n.boxFragment),h=new r(o,p,y);return h.update(i),o.addOverlay(h),h}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(c,M,T){M.exports=g;var e=c("gl-fbo"),a=c("typedarray-pool"),n=c("ndarray"),r=c("bit-twiddle").nextPow2,t=function(p,y,h){for(var m=1e8,u=-1,_=-1,s=p.shape[0],A=p.shape[1],x=0;x<s;x++)for(var v=0;v<A;v++){var b=p.get(x,v,0),l=p.get(x,v,1),L=p.get(x,v,2),S=p.get(x,v,3);if(b<255||l<255||L<255||S<255){var k=y-x,P=h-v,z=k*k+P*P;z<m&&(m=z,u=x,_=v)}}return[u,_,m]};function f(p,y,h,m,u){this.coord=[p,y],this.id=h,this.value=m,this.distance=u}function o(p,y,h){this.gl=p,this.fbo=y,this.buffer=h,this._readTimeout=null;var m=this;this._readCallback=function(){!m.gl||(y.bind(),p.readPixels(0,0,y.shape[0],y.shape[1],p.RGBA,p.UNSIGNED_BYTE,m.buffer),m._readTimeout=null)}}var i=o.prototype;Object.defineProperty(i,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(p){if(!!this.gl){this.fbo.shape=p;var y=this.fbo.shape[0],h=this.fbo.shape[1];if(h*y*4>this.buffer.length){a.free(this.buffer);for(var m=this.buffer=a.mallocUint8(r(h*y*4)),u=0;u<h*y*4;++u)m[u]=255}return p}}}),i.begin=function(){var p=this.gl;this.shape,p&&(this.fbo.bind(),p.clearColor(1,1,1,1),p.clear(p.COLOR_BUFFER_BIT|p.DEPTH_BUFFER_BIT))},i.end=function(){var p=this.gl;!p||(p.bindFramebuffer(p.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},i.query=function(p,y,h){if(!this.gl)return null;var m=this.fbo.shape.slice();p=p|0,y=y|0,typeof h!="number"&&(h=1);var u=Math.min(Math.max(p-h,0),m[0])|0,_=Math.min(Math.max(p+h,0),m[0])|0,s=Math.min(Math.max(y-h,0),m[1])|0,A=Math.min(Math.max(y+h,0),m[1])|0;if(_<=u||A<=s)return null;var x=[_-u,A-s],v=n(this.buffer,[x[0],x[1],4],[4,m[0]*4,1],4*(u+m[0]*s)),b=t(v.hi(x[0],x[1],1),h,h),l=b[0],L=b[1];if(l<0||Math.pow(this.radius,2)<b[2])return null;var S=v.get(l,L,0),k=v.get(l,L,1),P=v.get(l,L,2),z=v.get(l,L,3);return new f(l+u|0,L+s|0,S,[k,P,z],Math.sqrt(b[2]))},i.dispose=function(){!this.gl||(this.fbo.dispose(),a.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))};function g(p,y){var h=y[0],m=y[1],u={},_=e(p,h,m,u),s=a.mallocUint8(h*m*4);return new o(p,_,s)}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(c,M,T){var e=c("./lib/create-uniforms"),a=c("./lib/create-attributes"),n=c("./lib/reflect"),r=c("./lib/shader-cache"),t=c("./lib/runtime-reflect"),f=c("./lib/GLError");function o(y){this.gl=y,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var i=o.prototype;i.bind=function(){this.program||this._relink();var y,h=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),m=this.gl.lastAttribCount;if(h>m)for(y=m;y<h;y++)this.gl.enableVertexAttribArray(y);else if(m>h)for(y=h;y<m;y++)this.gl.disableVertexAttribArray(y);this.gl.lastAttribCount=h,this.gl.useProgram(this.program)},i.dispose=function(){for(var y=this.gl.lastAttribCount,h=0;h<y;h++)this.gl.disableVertexAttribArray(h);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};function g(y,h){return y.name<h.name?-1:1}i.update=function(y,h,m,u){if(!h||arguments.length===1){var _=y;y=_.vertex,h=_.fragment,m=_.uniforms,u=_.attributes}var s=this,A=s.gl,x=s._vref;s._vref=r.shader(A,A.VERTEX_SHADER,y),x&&x.dispose(),s.vertShader=s._vref.shader;var v=this._fref;if(s._fref=r.shader(A,A.FRAGMENT_SHADER,h),v&&v.dispose(),s.fragShader=s._fref.shader,!m||!u){var b=A.createProgram();if(A.attachShader(b,s.fragShader),A.attachShader(b,s.vertShader),A.linkProgram(b),!A.getProgramParameter(b,A.LINK_STATUS)){var l=A.getProgramInfoLog(b);throw new f(l,"Error linking program:"+l)}m=m||t.uniforms(A,b),u=u||t.attributes(A,b),A.deleteProgram(b)}u=u.slice(),u.sort(g);var L=[],S=[],k=[],P;for(P=0;P<u.length;++P){var z=u[P];if(z.type.indexOf("mat")>=0){for(var I=z.type.charAt(z.type.length-1)|0,D=new Array(I),R=0;R<I;++R)D[R]=k.length,S.push(z.name+"["+R+"]"),typeof z.location=="number"?k.push(z.location+R):Array.isArray(z.location)&&z.location.length===I&&typeof z.location[R]=="number"?k.push(z.location[R]|0):k.push(-1);L.push({name:z.name,type:z.type,locations:D})}else L.push({name:z.name,type:z.type,locations:[k.length]}),S.push(z.name),typeof z.location=="number"?k.push(z.location|0):k.push(-1)}var B=0;for(P=0;P<k.length;++P)if(k[P]<0){for(;k.indexOf(B)>=0;)B+=1;k[P]=B}var F=new Array(m.length);function V(){s.program=r.program(A,s._vref,s._fref,S,k);for(var G=0;G<m.length;++G)F[G]=A.getUniformLocation(s.program,m[G].name)}V(),s._relink=V,s.types={uniforms:n(m),attributes:n(u)},s.attributes=a(A,s,L,k),Object.defineProperty(s,"uniforms",e(A,s,m,F))};function p(y,h,m,u,_){var s=new o(y);return s.update(h,m,u,_),s}M.exports=p},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(c,M,T){function e(a,n,r){this.shortMessage=n||"",this.longMessage=r||"",this.rawError=a||"",this.message="gl-shader: "+(n||a||"")+(r?`
`+r:""),this.stack=new Error().stack}e.prototype=new Error,e.prototype.name="GLError",e.prototype.constructor=e,M.exports=e},{}],134:[function(c,M,T){M.exports=o;var e=c("./GLError");function a(i,g,p,y,h,m){this._gl=i,this._wrapper=g,this._index=p,this._locations=y,this._dimension=h,this._constFunc=m}var n=a.prototype;n.pointer=function(g,p,y,h){var m=this,u=m._gl,_=m._locations[m._index];u.vertexAttribPointer(_,m._dimension,g||u.FLOAT,!!p,y||0,h||0),u.enableVertexAttribArray(_)},n.set=function(i,g,p,y){return this._constFunc(this._locations[this._index],i,g,p,y)},Object.defineProperty(n,"location",{get:function(){return this._locations[this._index]},set:function(i){return i!==this._locations[this._index]&&(this._locations[this._index]=i|0,this._wrapper.program=null),i|0}});var r=[function(i,g,p){return p.length===void 0?i.vertexAttrib1f(g,p):i.vertexAttrib1fv(g,p)},function(i,g,p,y){return p.length===void 0?i.vertexAttrib2f(g,p,y):i.vertexAttrib2fv(g,p)},function(i,g,p,y,h){return p.length===void 0?i.vertexAttrib3f(g,p,y,h):i.vertexAttrib3fv(g,p)},function(i,g,p,y,h,m){return p.length===void 0?i.vertexAttrib4f(g,p,y,h,m):i.vertexAttrib4fv(g,p)}];function t(i,g,p,y,h,m,u){var _=r[h],s=new a(i,g,p,y,h,_);Object.defineProperty(m,u,{set:function(A){return i.disableVertexAttribArray(y[p]),_(i,y[p],A),A},get:function(){return s},enumerable:!0})}function f(i,g,p,y,h,m,u){for(var _=new Array(h),s=new Array(h),A=0;A<h;++A)t(i,g,p[A],y,h,_,A),s[A]=_[A];Object.defineProperty(_,"location",{set:function(b){if(Array.isArray(b))for(var l=0;l<h;++l)s[l].location=b[l];else for(var l=0;l<h;++l)s[l].location=b+l;return b},get:function(){for(var b=new Array(h),l=0;l<h;++l)b[l]=y[p[l]];return b},enumerable:!0}),_.pointer=function(b,l,L,S){b=b||i.FLOAT,l=!!l,L=L||h*h,S=S||0;for(var k=0;k<h;++k){var P=y[p[k]];i.vertexAttribPointer(P,h,b,l,L,S+k*h),i.enableVertexAttribArray(P)}};var x=new Array(h),v=i["vertexAttrib"+h+"fv"];Object.defineProperty(m,u,{set:function(b){for(var l=0;l<h;++l){var L=y[p[l]];if(i.disableVertexAttribArray(L),Array.isArray(b[0]))v.call(i,L,b[l]);else{for(var S=0;S<h;++S)x[S]=b[h*l+S];v.call(i,L,x)}}return b},get:function(){return _},enumerable:!0})}function o(i,g,p,y){for(var h={},m=0,u=p.length;m<u;++m){var _=p[m],s=_.name,A=_.type,x=_.locations;switch(A){case"bool":case"int":case"float":t(i,g,x[0],y,1,h,s);break;default:if(A.indexOf("vec")>=0){var v=A.charCodeAt(A.length-1)-48;if(v<2||v>4)throw new e("","Invalid data type for attribute "+s+": "+A);t(i,g,x[0],y,v,h,s)}else if(A.indexOf("mat")>=0){var v=A.charCodeAt(A.length-1)-48;if(v<2||v>4)throw new e("","Invalid data type for attribute "+s+": "+A);f(i,g,x,y,v,h,s)}else throw new e("","Unknown data type for attribute "+s+": "+A);break}}return h}},{"./GLError":133}],135:[function(c,M,T){var e=c("./reflect"),a=c("./GLError");M.exports=t;function n(f){return function(){return f}}function r(f,o){for(var i=new Array(f),g=0;g<f;++g)i[g]=o;return i}function t(f,o,i,g){function p(A){return function(x,v,b){return x.getUniform(v.program,b[A])}}function y(A){return function(v){for(var b=h("",A),l=0;l<b.length;++l){var L=b[l],S=L[0],k=L[1];if(g[k]){var P=v;if(typeof S=="string"&&(S.indexOf(".")===0||S.indexOf("[")===0)){var z=S;if(S.indexOf(".")===0&&(z=S.slice(1)),z.indexOf("]")===z.length-1){var I=z.indexOf("["),D=z.slice(0,I),R=z.slice(I+1,z.length-1);P=D?v[D][R]:v[R]}else P=v[z]}var B=i[k].type,F;switch(B){case"bool":case"int":case"sampler2D":case"samplerCube":f.uniform1i(g[k],P);break;case"float":f.uniform1f(g[k],P);break;default:var V=B.indexOf("vec");if(0<=V&&V<=1&&B.length===4+V){if(F=B.charCodeAt(B.length-1)-48,F<2||F>4)throw new a("","Invalid data type");switch(B.charAt(0)){case"b":case"i":f["uniform"+F+"iv"](g[k],P);break;case"v":f["uniform"+F+"fv"](g[k],P);break;default:throw new a("","Unrecognized data type for vector "+name+": "+B)}}else if(B.indexOf("mat")===0&&B.length===4){if(F=B.charCodeAt(B.length-1)-48,F<2||F>4)throw new a("","Invalid uniform dimension type for matrix "+name+": "+B);f["uniformMatrix"+F+"fv"](g[k],!1,P);break}else throw new a("","Unknown uniform data type for "+name+": "+B)}}}}}function h(A,x){if(typeof x!="object")return[[A,x]];var v=[];for(var b in x){var l=x[b],L=A;parseInt(b)+""===b?L+="["+b+"]":L+="."+b,typeof l=="object"?v.push.apply(v,h(L,l)):v.push([L,l])}return v}function m(A){switch(A){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var x=A.indexOf("vec");if(0<=x&&x<=1&&A.length===4+x){var v=A.charCodeAt(A.length-1)-48;if(v<2||v>4)throw new a("","Invalid data type");return A.charAt(0)==="b"?r(v,!1):r(v,0)}else if(A.indexOf("mat")===0&&A.length===4){var v=A.charCodeAt(A.length-1)-48;if(v<2||v>4)throw new a("","Invalid uniform dimension type for matrix "+name+": "+A);return r(v*v,0)}else throw new a("","Unknown uniform data type for "+name+": "+A)}}function u(A,x,v){if(typeof v=="object"){var b=_(v);Object.defineProperty(A,x,{get:n(b),set:y(v),enumerable:!0,configurable:!1})}else g[v]?Object.defineProperty(A,x,{get:p(v),set:y(v),enumerable:!0,configurable:!1}):A[x]=m(i[v].type)}function _(A){var x;if(Array.isArray(A)){x=new Array(A.length);for(var v=0;v<A.length;++v)u(x,v,A[v])}else{x={};for(var b in A)u(x,b,A[b])}return x}var s=e(i,!0);return{get:n(_(s)),set:y(s),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(c,M,T){M.exports=e;function e(a,n){for(var r={},t=0;t<a.length;++t)for(var f=a[t].name,o=f.split("."),i=r,g=0;g<o.length;++g){var p=o[g].split("[");if(p.length>1){p[0]in i||(i[p[0]]=[]),i=i[p[0]];for(var y=1;y<p.length;++y){var h=parseInt(p[y]);y<p.length-1||g<o.length-1?(h in i||(y<p.length-1?i[h]=[]:i[h]={}),i=i[h]):n?i[h]=t:i[h]=a[t].type}}else g<o.length-1?(p[0]in i||(i[p[0]]={}),i=i[p[0]]):n?i[p[0]]=t:i[p[0]]=a[t].type}return r}},{}],137:[function(c,M,T){T.uniforms=r,T.attributes=t;var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},a=null;function n(f,o){if(!a){var i=Object.keys(e);a={};for(var g=0;g<i.length;++g){var p=i[g];a[f[p]]=e[p]}}return a[o]}function r(f,o){for(var i=f.getProgramParameter(o,f.ACTIVE_UNIFORMS),g=[],p=0;p<i;++p){var y=f.getActiveUniform(o,p);if(y){var h=n(f,y.type);if(y.size>1)for(var m=0;m<y.size;++m)g.push({name:y.name.replace("[0]","["+m+"]"),type:h});else g.push({name:y.name,type:h})}}return g}function t(f,o){for(var i=f.getProgramParameter(o,f.ACTIVE_ATTRIBUTES),g=[],p=0;p<i;++p){var y=f.getActiveAttrib(o,p);y&&g.push({name:y.name,type:n(f,y.type)})}return g}},{}],138:[function(c,M,T){T.shader=h,T.program=m;var e=c("./GLError"),a=c("gl-format-compiler-error"),n=typeof WeakMap=="undefined"?c("weakmap-shim"):WeakMap,r=new n,t=0;function f(u,_,s,A,x,v,b){this.id=u,this.src=_,this.type=s,this.shader=A,this.count=v,this.programs=[],this.cache=b}f.prototype.dispose=function(){if(--this.count===0){for(var u=this.cache,_=u.gl,s=this.programs,A=0,x=s.length;A<x;++A){var v=u.programs[s[A]];v&&(delete u.programs[A],_.deleteProgram(v))}_.deleteShader(this.shader),delete u.shaders[this.type===_.FRAGMENT_SHADER|0][this.src]}};function o(u){this.gl=u,this.shaders=[{},{}],this.programs={}}var i=o.prototype;function g(u,_,s){var A=u.createShader(_);if(u.shaderSource(A,s),u.compileShader(A),!u.getShaderParameter(A,u.COMPILE_STATUS)){var x=u.getShaderInfoLog(A);try{var v=a(x,s,_)}catch(b){throw console.warn("Failed to format compiler error: "+b),new e(x,`Error compiling shader:
`+x)}throw new e(x,v.short,v.long)}return A}i.getShaderReference=function(u,_){var s=this.gl,A=this.shaders[u===s.FRAGMENT_SHADER|0],x=A[_];if(!x||!s.isShader(x.shader)){var v=g(s,u,_);x=A[_]=new f(t++,_,u,v,[],1,this)}else x.count+=1;return x};function p(u,_,s,A,x){var v=u.createProgram();u.attachShader(v,_),u.attachShader(v,s);for(var b=0;b<A.length;++b)u.bindAttribLocation(v,x[b],A[b]);if(u.linkProgram(v),!u.getProgramParameter(v,u.LINK_STATUS)){var l=u.getProgramInfoLog(v);throw new e(l,"Error linking program: "+l)}return v}i.getProgram=function(u,_,s,A){var x=[u.id,_.id,s.join(":"),A.join(":")].join("@"),v=this.programs[x];return(!v||!this.gl.isProgram(v))&&(this.programs[x]=v=p(this.gl,u.shader,_.shader,s,A),u.programs.push(x),_.programs.push(x)),v};function y(u){var _=r.get(u);return _||(_=new o(u),r.set(u,_)),_}function h(u,_,s){return y(u).getShaderReference(_,s)}function m(u,_,s,A,x){return y(u).getProgram(_,s,A,x)}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(c,M,T){M.exports=n;function e(r){this.plot=r,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}var a=e.prototype;a.update=function(r){r=r||{},this.enable=(r.enable||[!0,!0,!1,!1]).slice(),this.width=(r.width||[1,1,1,1]).slice(),this.color=(r.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(t){return t.slice()}),this.center=(r.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},a.draw=function(){var r=this.enable,t=this.width,f=this.color,o=this.center,i=this.plot,g=i.line,p=i.dataBox,y=i.viewBox;if(g.bind(),p[0]<=o[0]&&o[0]<=p[2]&&p[1]<=o[1]&&o[1]<=p[3]){var h=y[0]+(o[0]-p[0])/(p[2]-p[0])*(y[2]-y[0]),m=y[1]+(o[1]-p[1])/(p[3]-p[1])*(y[3]-y[1]);r[0]&&g.drawLine(h,m,y[0],m,t[0],f[0]),r[1]&&g.drawLine(h,m,h,y[1],t[1],f[1]),r[2]&&g.drawLine(h,m,y[2],m,t[2],f[2]),r[3]&&g.drawLine(h,m,h,y[3],t[3],f[3])}},a.dispose=function(){this.plot.removeOverlay(this)};function n(r,t){var f=new e(r);return f.update(t),r.addOverlay(f),f}},{}],140:[function(c,M,T){var e=c("glslify"),a=c("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),r=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);M.exports=function(t){return a(t,n,r,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(c,M,T){var e=c("gl-buffer"),a=c("gl-vao"),n=c("./shaders/index");M.exports=p;var r=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(y,h,m,u){this.gl=y,this.buffer=h,this.vao=m,this.shader=u,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var f=t.prototype,o=[0,0,0],i=[0,0,0],g=[0,0];f.isTransparent=function(){return!1},f.drawTransparent=function(y){},f.draw=function(y){var h=this.gl,m=this.vao,u=this.shader;m.bind(),u.bind();var _=y.model||r,s=y.view||r,A=y.projection||r,x;this.axes&&(x=this.axes.lastCubeProps.axis);for(var v=o,b=i,l=0;l<3;++l)x&&x[l]<0?(v[l]=this.bounds[0][l],b[l]=this.bounds[1][l]):(v[l]=this.bounds[1][l],b[l]=this.bounds[0][l]);g[0]=h.drawingBufferWidth,g[1]=h.drawingBufferHeight,u.uniforms.model=_,u.uniforms.view=s,u.uniforms.projection=A,u.uniforms.coordinates=[this.position,v,b],u.uniforms.colors=this.colors,u.uniforms.screenShape=g;for(var l=0;l<3;++l)u.uniforms.lineWidth=this.lineWidth[l]*this.pixelRatio,this.enabled[l]&&(m.draw(h.TRIANGLES,6,6*l),this.drawSides[l]&&m.draw(h.TRIANGLES,12,18+12*l));m.unbind()},f.update=function(y){!y||("bounds"in y&&(this.bounds=y.bounds),"position"in y&&(this.position=y.position),"lineWidth"in y&&(this.lineWidth=y.lineWidth),"colors"in y&&(this.colors=y.colors),"enabled"in y&&(this.enabled=y.enabled),"drawSides"in y&&(this.drawSides=y.drawSides))},f.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function p(y,h){var m=[];function u(v,b,l,L,S,k){var P=[v,b,l,0,0,0,1];P[L+3]=1,P[L]=S,m.push.apply(m,P),P[6]=-1,m.push.apply(m,P),P[L]=k,m.push.apply(m,P),m.push.apply(m,P),P[6]=1,m.push.apply(m,P),P[L]=S,m.push.apply(m,P)}u(0,0,0,0,0,1),u(0,0,0,1,0,1),u(0,0,0,2,0,1),u(1,0,0,1,-1,1),u(1,0,0,2,-1,1),u(0,1,0,0,-1,1),u(0,1,0,2,-1,1),u(0,0,1,0,-1,1),u(0,0,1,1,-1,1);var _=e(y,m),s=a(y,[{type:y.FLOAT,buffer:_,size:3,offset:0,stride:28},{type:y.FLOAT,buffer:_,size:3,offset:12,stride:28},{type:y.FLOAT,buffer:_,size:1,offset:24,stride:28}]),A=n(y);A.attributes.position.location=0,A.attributes.color.location=1,A.attributes.weight.location=2;var x=new t(y,_,s,A);return x.update(h),x}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(c,M,T){var e=c("glslify"),a=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),r=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),t=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);T.meshShader={vertex:a,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},T.pickShader={vertex:r,fragment:t,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(c,M,T){var e=c("gl-vec3"),a=c("gl-vec4"),n=["xyz","xzy","yxz","yzx","zxy","zyx"],r=function(m,u,_,s){for(var A=m.points,x=m.velocities,v=m.divergences,b=[],l=[],L=[],S=[],k=[],P=[],z=0,I=0,D=a.create(),R=a.create(),B=8,F=0;F<A.length;F++){var V=A[F],G=x[F],J=v[F];u===0&&(J=_*.05),I=e.length(G)/s,D=a.create(),e.copy(D,G),D[3]=J;for(var j=0;j<B;j++)k[j]=[V[0],V[1],V[2],j];if(S.length>0)for(var j=0;j<B;j++){var Y=(j+1)%B;b.push(S[j],k[j],k[Y],k[Y],S[Y],S[j]),L.push(R,D,D,D,R,R),P.push(z,I,I,I,z,z);var X=b.length;l.push([X-6,X-5,X-4],[X-3,X-2,X-1])}var oe=S;S=k,k=oe;var se=R;R=D,D=se;var ie=z;z=I,I=ie}return{positions:b,cells:l,vectors:L,vertexIntensity:P}},t=function(m,u,_,s){for(var A=0,x=0;x<m.length;x++)for(var v=m[x].velocities,b=0;b<v.length;b++)A=Math.max(A,e.length(v[b]));for(var l=m.map(function(F){return r(F,_,s,A)}),L=[],S=[],k=[],P=[],x=0;x<l.length;x++){var z=l[x],I=L.length;L=L.concat(z.positions),k=k.concat(z.vectors),P=P.concat(z.vertexIntensity);for(var b=0;b<z.cells.length;b++){var D=z.cells[b],R=[];S.push(R);for(var B=0;B<D.length;B++)R.push(D[B]+I)}}return{positions:L,cells:S,vectors:k,vertexIntensity:P,colormap:u}},f=function(m,u){var _=m.length,s;for(s=0;s<_;s++){var A=m[s];if(A===u)return s;if(A>u)return s-1}return s},o=function(m,u,_){return m<u?u:m>_?_:m},i=function(m,u,_){var s=u.vectors,A=u.meshgrid,x=m[0],v=m[1],b=m[2],l=A[0].length,L=A[1].length,S=A[2].length,k=f(A[0],x),P=f(A[1],v),z=f(A[2],b),I=k+1,D=P+1,R=z+1;if(k=o(k,0,l-1),I=o(I,0,l-1),P=o(P,0,L-1),D=o(D,0,L-1),z=o(z,0,S-1),R=o(R,0,S-1),k<0||P<0||z<0||I>l-1||D>L-1||R>S-1)return e.create();var B=A[0][k],F=A[0][I],V=A[1][P],G=A[1][D],J=A[2][z],j=A[2][R],Y=(x-B)/(F-B),X=(v-V)/(G-V),oe=(b-J)/(j-J);isFinite(Y)||(Y=.5),isFinite(X)||(X=.5),isFinite(oe)||(oe=.5);var se,ie,N,U,q,Q;switch(_.reversedX&&(k=l-1-k,I=l-1-I),_.reversedY&&(P=L-1-P,D=L-1-D),_.reversedZ&&(z=S-1-z,R=S-1-R),_.filled){case 5:q=z,Q=R,N=P*S,U=D*S,se=k*S*L,ie=I*S*L;break;case 4:q=z,Q=R,se=k*S,ie=I*S,N=P*S*l,U=D*S*l;break;case 3:N=P,U=D,q=z*L,Q=R*L,se=k*L*S,ie=I*L*S;break;case 2:N=P,U=D,se=k*L,ie=I*L,q=z*L*l,Q=R*L*l;break;case 1:se=k,ie=I,q=z*l,Q=R*l,N=P*l*S,U=D*l*S;break;default:se=k,ie=I,N=P*l,U=D*l,q=z*l*L,Q=R*l*L;break}var W=s[se+N+q],Z=s[se+N+Q],ee=s[se+U+q],te=s[se+U+Q],ae=s[ie+N+q],le=s[ie+N+Q],ye=s[ie+U+q],fe=s[ie+U+Q],pe=e.create(),ge=e.create(),Ae=e.create(),we=e.create();e.lerp(pe,W,ae,Y),e.lerp(ge,Z,le,Y),e.lerp(Ae,ee,ye,Y),e.lerp(we,te,fe,Y);var De=e.create(),Be=e.create();e.lerp(De,pe,Ae,X),e.lerp(Be,ge,we,X);var Ve=e.create();return e.lerp(Ve,De,Be,oe),Ve},g=function(m){var u=1/0;m.sort(function(x,v){return x-v});for(var _=m.length,s=1;s<_;s++){var A=Math.abs(m[s]-m[s-1]);A<u&&(u=A)}return u},p=function(m){for(var u=[],_=[],s=[],A={},x={},v={},b=m.length,l=0;l<b;l++){var L=m[l],S=L[0],k=L[1],P=L[2];A[S]||(u.push(S),A[S]=!0),x[k]||(_.push(k),x[k]=!0),v[P]||(s.push(P),v[P]=!0)}var z=g(u),I=g(_),D=g(s),R=Math.min(z,I,D);return isFinite(R)?R:1};M.exports=function(m,u){var _=m.startingPositions,s=m.maxLength||1e3,A=m.tubeSize||1,x=m.absoluteTubeSize,v=m.gridFill||"+x+y+z",b={};v.indexOf("-x")!==-1&&(b.reversedX=!0),v.indexOf("-y")!==-1&&(b.reversedY=!0),v.indexOf("-z")!==-1&&(b.reversedZ=!0),b.filled=n.indexOf(v.replace(/-/g,"").replace(/\+/g,""));var l=m.getVelocity||function(le){return i(le,m,b)},L=m.getDivergence||function(le,ye){var fe=e.create(),pe=1e-4;e.add(fe,le,[pe,0,0]);var ge=l(fe);e.subtract(ge,ge,ye),e.scale(ge,ge,1/pe),e.add(fe,le,[0,pe,0]);var Ae=l(fe);e.subtract(Ae,Ae,ye),e.scale(Ae,Ae,1/pe),e.add(fe,le,[0,0,pe]);var we=l(fe);return e.subtract(we,we,ye),e.scale(we,we,1/pe),e.add(fe,ge,Ae),e.add(fe,fe,we),fe},S=[],k=u[0][0],P=u[0][1],z=u[0][2],I=u[1][0],D=u[1][1],R=u[1][2],B=function(le){var ye=le[0],fe=le[1],pe=le[2];return!(ye<k||ye>I||fe<P||fe>D||pe<z||pe>R)},F=e.distance(u[0],u[1]),V=10*F/s,G=V*V,J=1,j=0,Y=_.length;Y>1&&(J=p(_));for(var X=0;X<Y;X++){var oe=e.create();e.copy(oe,_[X]);var se=[oe],ie=[],N=l(oe),U=oe;ie.push(N);var q=[],Q=L(oe,N),W=e.length(Q);isFinite(W)&&W>j&&(j=W),q.push(W),S.push({points:se,velocities:ie,divergences:q});for(var Z=0;Z<s*100&&se.length<s&&B(oe);){Z++;var ee=e.clone(N),te=e.squaredLength(ee);if(te===0)break;if(te>G&&e.scale(ee,ee,V/Math.sqrt(te)),e.add(ee,ee,oe),N=l(ee),e.squaredDistance(U,ee)-G>-1e-4*G){se.push(ee),U=ee,ie.push(N);var Q=L(ee,N),W=e.length(Q);isFinite(W)&&W>j&&(j=W),q.push(W)}oe=ee}}var ae=t(S,m.colormap,j,J);return x?ae.tubeScale=x:(j===0&&(j=1),ae.tubeScale=A*.5*J/j),ae};var y=c("./lib/shaders"),h=c("gl-cone3d").createMesh;M.exports.createTubeMesh=function(m,u){return h(m,u,{shaders:y,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(c,M,T){var e=c("gl-shader"),a=c("glslify"),n=a([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),r=a([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),t=a([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),f=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);T.createShader=function(o){var i=e(o,n,r,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},T.createPickShader=function(o){var i=e(o,n,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},T.createContourShader=function(o){var i=e(o,t,r,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i},T.createPickContourShader=function(o){var i=e(o,t,f,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i}},{"gl-shader":132,glslify:231}],145:[function(c,M,T){M.exports=ie;var e=c("bit-twiddle"),a=c("gl-buffer"),n=c("gl-vao"),r=c("gl-texture2d"),t=c("typedarray-pool"),f=c("colormap"),o=c("ndarray-ops"),i=c("ndarray-pack"),g=c("ndarray"),p=c("surface-nets"),y=c("gl-mat4/multiply"),h=c("gl-mat4/invert"),m=c("binary-search-bounds"),u=c("ndarray-gradient"),_=c("./lib/shaders"),s=_.createShader,A=_.createContourShader,x=_.createPickShader,v=_.createPickContourShader,b=4*(4+3+3),l=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],L=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],S=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var N=0;N<3;++N){var U=S[N],q=(N+1)%3,Q=(N+2)%3;U[q+0]=1,U[Q+3]=1,U[N+6]=1}})();function k(N,U,q,Q,W){this.position=N,this.index=U,this.uv=q,this.level=Q,this.dataCoordinate=W}var P=256;function z(N,U,q,Q,W,Z,ee,te,ae,le,ye,fe,pe,ge,Ae){this.gl=N,this.shape=U,this.bounds=q,this.objectOffset=Ae,this.intensityBounds=[],this._shader=Q,this._pickShader=W,this._coordinateBuffer=Z,this._vao=ee,this._colorMap=te,this._contourShader=ae,this._contourPickShader=le,this._contourBuffer=ye,this._contourVAO=fe,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new k([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=pe,this._dynamicVAO=ge,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[g(t.mallocFloat(1024),[0,0]),g(t.mallocFloat(1024),[0,0]),g(t.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var I=z.prototype;I.genColormap=function(N,U){var q=!1,Q=i([f({colormap:N,nshades:P,format:"rgba"}).map(function(W,Z){var ee=U?D(Z/255,U):W[3];return ee<1&&(q=!0),[W[0],W[1],W[2],255*ee]})]);return o.divseq(Q,255),this.hasAlphaScale=q,Q},I.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},I.isOpaque=function(){return!this.isTransparent()},I.pickSlots=1,I.setPickBase=function(N){this.pickId=N};function D(N,U){if(!U||!U.length)return 1;for(var q=0;q<U.length;++q){if(U.length<2)return 1;if(U[q][0]===N)return U[q][1];if(U[q][0]>N&&q>0){var Q=(U[q][0]-N)/(U[q][0]-U[q-1][0]);return U[q][1]*(1-Q)+Q*U[q-1][1]}}return 1}var R=[0,0,0],B={showSurface:!1,showContour:!1,projections:[l.slice(),l.slice(),l.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function F(N,U){var q,Q,W,Z=U.axes&&U.axes.lastCubeProps.axis||R,ee=U.showSurface,te=U.showContour;for(q=0;q<3;++q)for(ee=ee||U.surfaceProject[q],Q=0;Q<3;++Q)te=te||U.contourProject[q][Q];for(q=0;q<3;++q){var ae=B.projections[q];for(Q=0;Q<16;++Q)ae[Q]=0;for(Q=0;Q<4;++Q)ae[5*Q]=1;ae[5*q]=0,ae[12+q]=U.axesBounds[+(Z[q]>0)][q],y(ae,N.model,ae);var le=B.clipBounds[q];for(W=0;W<2;++W)for(Q=0;Q<3;++Q)le[W][Q]=N.clipBounds[W][Q];le[0][q]=-1e8,le[1][q]=1e8}return B.showSurface=ee,B.showContour=te,B}var V={model:l,view:l,projection:l,inverseModel:l.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},G=l.slice(),J=[1,0,0,0,1,0,0,0,1];function j(N,U){N=N||{};var q=this.gl;q.disable(q.CULL_FACE),this._colorMap.bind(0);var Q=V;Q.model=N.model||l,Q.view=N.view||l,Q.projection=N.projection||l,Q.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],Q.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],Q.objectOffset=this.objectOffset,Q.contourColor=this.contourColor[0],Q.inverseModel=h(Q.inverseModel,Q.model);for(var W=0;W<2;++W)for(var Z=Q.clipBounds[W],ee=0;ee<3;++ee)Z[ee]=Math.min(Math.max(this.clipBounds[W][ee],-1e8),1e8);Q.kambient=this.ambientLight,Q.kdiffuse=this.diffuseLight,Q.kspecular=this.specularLight,Q.roughness=this.roughness,Q.fresnel=this.fresnel,Q.opacity=this.opacity,Q.height=0,Q.permutation=J,Q.vertexColor=this.vertexColor;var te=G;for(y(te,Q.view,Q.model),y(te,Q.projection,te),h(te,te),W=0;W<3;++W)Q.eyePosition[W]=te[12+W]/te[15];var ae=te[15];for(W=0;W<3;++W)ae+=this.lightPosition[W]*te[4*W+3];for(W=0;W<3;++W){var le=te[12+W];for(ee=0;ee<3;++ee)le+=te[4*ee+W]*this.lightPosition[ee];Q.lightPosition[W]=le/ae}var ye=F(Q,this);if(ye.showSurface){for(this._shader.bind(),this._shader.uniforms=Q,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(q.TRIANGLES,this._vertexCount),W=0;W<3;++W)!this.surfaceProject[W]||!this.vertexCount||(this._shader.uniforms.model=ye.projections[W],this._shader.uniforms.clipBounds=ye.clipBounds[W],this._vao.draw(q.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ye.showContour){var fe=this._contourShader;Q.kambient=1,Q.kdiffuse=0,Q.kspecular=0,Q.opacity=1,fe.bind(),fe.uniforms=Q;var pe=this._contourVAO;for(pe.bind(),W=0;W<3;++W)for(fe.uniforms.permutation=S[W],q.lineWidth(this.contourWidth[W]*this.pixelRatio),ee=0;ee<this.contourLevels[W].length;++ee)ee===this.highlightLevel[W]?(fe.uniforms.contourColor=this.highlightColor[W],fe.uniforms.contourTint=this.highlightTint[W]):(ee===0||ee-1===this.highlightLevel[W])&&(fe.uniforms.contourColor=this.contourColor[W],fe.uniforms.contourTint=this.contourTint[W]),this._contourCounts[W][ee]&&(fe.uniforms.height=this.contourLevels[W][ee],pe.draw(q.LINES,this._contourCounts[W][ee],this._contourOffsets[W][ee]));for(W=0;W<3;++W)for(fe.uniforms.model=ye.projections[W],fe.uniforms.clipBounds=ye.clipBounds[W],ee=0;ee<3;++ee)if(!!this.contourProject[W][ee]){fe.uniforms.permutation=S[ee],q.lineWidth(this.contourWidth[ee]*this.pixelRatio);for(var ge=0;ge<this.contourLevels[ee].length;++ge)ge===this.highlightLevel[ee]?(fe.uniforms.contourColor=this.highlightColor[ee],fe.uniforms.contourTint=this.highlightTint[ee]):(ge===0||ge-1===this.highlightLevel[ee])&&(fe.uniforms.contourColor=this.contourColor[ee],fe.uniforms.contourTint=this.contourTint[ee]),this._contourCounts[ee][ge]&&(fe.uniforms.height=this.contourLevels[ee][ge],pe.draw(q.LINES,this._contourCounts[ee][ge],this._contourOffsets[ee][ge]))}for(pe.unbind(),pe=this._dynamicVAO,pe.bind(),W=0;W<3;++W)if(this._dynamicCounts[W]!==0)for(fe.uniforms.model=Q.model,fe.uniforms.clipBounds=Q.clipBounds,fe.uniforms.permutation=S[W],q.lineWidth(this.dynamicWidth[W]*this.pixelRatio),fe.uniforms.contourColor=this.dynamicColor[W],fe.uniforms.contourTint=this.dynamicTint[W],fe.uniforms.height=this.dynamicLevel[W],pe.draw(q.LINES,this._dynamicCounts[W],this._dynamicOffsets[W]),ee=0;ee<3;++ee)!this.contourProject[ee][W]||(fe.uniforms.model=ye.projections[ee],fe.uniforms.clipBounds=ye.clipBounds[ee],pe.draw(q.LINES,this._dynamicCounts[W],this._dynamicOffsets[W]));pe.unbind()}}I.draw=function(N){return j.call(this,N,!1)},I.drawTransparent=function(N){return j.call(this,N,!0)};var Y={model:l,view:l,projection:l,inverseModel:l,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};I.drawPick=function(N){N=N||{};var U=this.gl;U.disable(U.CULL_FACE);var q=Y;q.model=N.model||l,q.view=N.view||l,q.projection=N.projection||l,q.shape=this._field[2].shape,q.pickId=this.pickId/255,q.lowerBound=this.bounds[0],q.upperBound=this.bounds[1],q.objectOffset=this.objectOffset,q.permutation=J;for(var Q=0;Q<2;++Q)for(var W=q.clipBounds[Q],Z=0;Z<3;++Z)W[Z]=Math.min(Math.max(this.clipBounds[Q][Z],-1e8),1e8);var ee=F(q,this);if(ee.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=q,this._vao.bind(),this._vao.draw(U.TRIANGLES,this._vertexCount),Q=0;Q<3;++Q)!this.surfaceProject[Q]||(this._pickShader.uniforms.model=ee.projections[Q],this._pickShader.uniforms.clipBounds=ee.clipBounds[Q],this._vao.draw(U.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ee.showContour){var te=this._contourPickShader;te.bind(),te.uniforms=q;var ae=this._contourVAO;for(ae.bind(),Z=0;Z<3;++Z)for(U.lineWidth(this.contourWidth[Z]*this.pixelRatio),te.uniforms.permutation=S[Z],Q=0;Q<this.contourLevels[Z].length;++Q)this._contourCounts[Z][Q]&&(te.uniforms.height=this.contourLevels[Z][Q],ae.draw(U.LINES,this._contourCounts[Z][Q],this._contourOffsets[Z][Q]));for(Q=0;Q<3;++Q)for(te.uniforms.model=ee.projections[Q],te.uniforms.clipBounds=ee.clipBounds[Q],Z=0;Z<3;++Z)if(!!this.contourProject[Q][Z]){te.uniforms.permutation=S[Z],U.lineWidth(this.contourWidth[Z]*this.pixelRatio);for(var le=0;le<this.contourLevels[Z].length;++le)this._contourCounts[Z][le]&&(te.uniforms.height=this.contourLevels[Z][le],ae.draw(U.LINES,this._contourCounts[Z][le],this._contourOffsets[Z][le]))}ae.unbind()}},I.pick=function(N){if(!N||N.id!==this.pickId)return null;var U=this._field[2].shape,q=this._pickResult,Q=U[0]*(N.value[0]+(N.value[2]>>4)/16)/255,W=Math.floor(Q),Z=Q-W,ee=U[1]*(N.value[1]+(N.value[2]&15)/16)/255,te=Math.floor(ee),ae=ee-te;W+=1,te+=1;var le=q.position;le[0]=le[1]=le[2]=0;for(var ye=0;ye<2;++ye)for(var fe=ye?Z:1-Z,pe=0;pe<2;++pe)for(var ge=pe?ae:1-ae,Ae=W+ye,we=te+pe,De=fe*ge,Be=0;Be<3;++Be)le[Be]+=this._field[Be].get(Ae,we)*De;for(var Ve=this._pickResult.level,xe=0;xe<3;++xe)if(Ve[xe]=m.le(this.contourLevels[xe],le[xe]),Ve[xe]<0)this.contourLevels[xe].length>0&&(Ve[xe]=0);else if(Ve[xe]<this.contourLevels[xe].length-1){var Le=this.contourLevels[xe][Ve[xe]],He=this.contourLevels[xe][Ve[xe]+1];Math.abs(Le-le[xe])>Math.abs(He-le[xe])&&(Ve[xe]+=1)}for(q.index[0]=Z<.5?W:W+1,q.index[1]=ae<.5?te:te+1,q.uv[0]=Q/U[0],q.uv[1]=ee/U[1],Be=0;Be<3;++Be)q.dataCoordinate[Be]=this._field[Be].get(q.index[0],q.index[1]);return q},I.padField=function(N,U){var q=U.shape.slice(),Q=N.shape.slice();o.assign(N.lo(1,1).hi(q[0],q[1]),U),o.assign(N.lo(1).hi(q[0],1),U.hi(q[0],1)),o.assign(N.lo(1,Q[1]-1).hi(q[0],1),U.lo(0,q[1]-1).hi(q[0],1)),o.assign(N.lo(0,1).hi(1,q[1]),U.hi(1)),o.assign(N.lo(Q[0]-1,1).hi(1,q[1]),U.lo(q[0]-1)),N.set(0,0,U.get(0,0)),N.set(0,Q[1]-1,U.get(0,q[1]-1)),N.set(Q[0]-1,0,U.get(q[0]-1,0)),N.set(Q[0]-1,Q[1]-1,U.get(q[0]-1,q[1]-1))};function X(N,U){return Array.isArray(N)?[U(N[0]),U(N[1]),U(N[2])]:[U(N),U(N),U(N)]}function oe(N){return Array.isArray(N)?N.length===3?[N[0],N[1],N[2],1]:[N[0],N[1],N[2],N[3]]:[0,0,0,1]}function se(N){if(Array.isArray(N)){if(Array.isArray(N))return[oe(N[0]),oe(N[1]),oe(N[2])];var U=oe(N);return[U.slice(),U.slice(),U.slice()]}}I.update=function(N){N=N||{},this.objectOffset=N.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in N&&(this.contourWidth=X(N.contourWidth,Number)),"showContour"in N&&(this.showContour=X(N.showContour,Boolean)),"showSurface"in N&&(this.showSurface=!!N.showSurface),"contourTint"in N&&(this.contourTint=X(N.contourTint,Boolean)),"contourColor"in N&&(this.contourColor=se(N.contourColor)),"contourProject"in N&&(this.contourProject=X(N.contourProject,function(xt){return X(xt,Boolean)})),"surfaceProject"in N&&(this.surfaceProject=N.surfaceProject),"dynamicColor"in N&&(this.dynamicColor=se(N.dynamicColor)),"dynamicTint"in N&&(this.dynamicTint=X(N.dynamicTint,Number)),"dynamicWidth"in N&&(this.dynamicWidth=X(N.dynamicWidth,Number)),"opacity"in N&&(this.opacity=N.opacity),"opacityscale"in N&&(this.opacityscale=N.opacityscale),"colorBounds"in N&&(this.colorBounds=N.colorBounds),"vertexColor"in N&&(this.vertexColor=N.vertexColor?1:0),"colormap"in N&&this._colorMap.setPixels(this.genColormap(N.colormap,this.opacityscale));var U=N.field||N.coords&&N.coords[2]||null,q=!1;if(U||(this._field[2].shape[0]||this._field[2].shape[2]?U=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):U=this._field[2].hi(0,0)),"field"in N||"coords"in N){var Q=(U.shape[0]+2)*(U.shape[1]+2);Q>this._field[2].data.length&&(t.freeFloat(this._field[2].data),this._field[2].data=t.mallocFloat(e.nextPow2(Q))),this._field[2]=g(this._field[2].data,[U.shape[0]+2,U.shape[1]+2]),this.padField(this._field[2],U),this.shape=U.shape.slice();for(var W=this.shape,Z=0;Z<2;++Z)this._field[2].size>this._field[Z].data.length&&(t.freeFloat(this._field[Z].data),this._field[Z].data=t.mallocFloat(this._field[2].size)),this._field[Z]=g(this._field[Z].data,[W[0]+2,W[1]+2]);if(N.coords){var ee=N.coords;if(!Array.isArray(ee)||ee.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(Z=0;Z<2;++Z){var te=ee[Z];for(pe=0;pe<2;++pe)if(te.shape[pe]!==W[pe])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[Z],te)}}else if(N.ticks){var ae=N.ticks;if(!Array.isArray(ae)||ae.length!==2)throw new Error("gl-surface: invalid ticks");for(Z=0;Z<2;++Z){var le=ae[Z];if((Array.isArray(le)||le.length)&&(le=g(le)),le.shape[0]!==W[Z])throw new Error("gl-surface: invalid tick length");var ye=g(le.data,W);ye.stride[Z]=le.stride[0],ye.stride[Z^1]=0,this.padField(this._field[Z],ye)}}else{for(Z=0;Z<2;++Z){var fe=[0,0];fe[Z]=1,this._field[Z]=g(this._field[Z].data,[W[0]+2,W[1]+2],fe,0)}this._field[0].set(0,0,0);for(var pe=0;pe<W[0];++pe)this._field[0].set(pe+1,0,pe);for(this._field[0].set(W[0]+1,0,W[0]-1),this._field[1].set(0,0,0),pe=0;pe<W[1];++pe)this._field[1].set(0,pe+1,pe);this._field[1].set(0,W[1]+1,W[1]-1)}var ge=this._field,Ae=g(t.mallocFloat(ge[2].size*3*2),[3,W[0]+2,W[1]+2,2]);for(Z=0;Z<3;++Z)u(Ae.pick(Z),ge[Z],"mirror");var we=g(t.mallocFloat(ge[2].size*3),[W[0]+2,W[1]+2,3]);for(Z=0;Z<W[0]+2;++Z)for(pe=0;pe<W[1]+2;++pe){var De=Ae.get(0,Z,pe,0),Be=Ae.get(0,Z,pe,1),Ve=Ae.get(1,Z,pe,0),xe=Ae.get(1,Z,pe,1),Le=Ae.get(2,Z,pe,0),He=Ae.get(2,Z,pe,1),Je=Ve*He-xe*Le,Oe=Le*Be-He*De,Pe=De*xe-Be*Ve,Ue=Math.sqrt(Je*Je+Oe*Oe+Pe*Pe);Ue<1e-8?(Ue=Math.max(Math.abs(Je),Math.abs(Oe),Math.abs(Pe)),Ue<1e-8?(Pe=1,Oe=Je=0,Ue=1):Ue=1/Ue):Ue=1/Math.sqrt(Ue),we.set(Z,pe,0,Je*Ue),we.set(Z,pe,1,Oe*Ue),we.set(Z,pe,2,Pe*Ue)}t.free(Ae.data);var vt=[1/0,1/0,1/0],Lt=[-1/0,-1/0,-1/0],Yt=1/0,At=-1/0,Rt=(W[0]-1)*(W[1]-1)*6,Bt=t.mallocFloat(e.nextPow2(10*Rt)),Mt=0,Tt=0;for(Z=0;Z<W[0]-1;++Z){e:for(pe=0;pe<W[1]-1;++pe){for(var at=0;at<2;++at)for(var ct=0;ct<2;++ct)for(var je=0;je<3;++je){var ke=this._field[je].get(1+Z+at,1+pe+ct);if(isNaN(ke)||!isFinite(ke))continue e}for(je=0;je<6;++je){var Ye=Z+L[je][0],Ke=pe+L[je][1],st=this._field[0].get(Ye+1,Ke+1),Et=this._field[1].get(Ye+1,Ke+1);ke=this._field[2].get(Ye+1,Ke+1),Je=we.get(Ye+1,Ke+1,0),Oe=we.get(Ye+1,Ke+1,1),Pe=we.get(Ye+1,Ke+1,2),N.intensity&&(bt=N.intensity.get(Ye,Ke));var bt=N.intensity?N.intensity.get(Ye,Ke):ke+this.objectOffset[2];Bt[Mt++]=Ye,Bt[Mt++]=Ke,Bt[Mt++]=st,Bt[Mt++]=Et,Bt[Mt++]=ke,Bt[Mt++]=0,Bt[Mt++]=bt,Bt[Mt++]=Je,Bt[Mt++]=Oe,Bt[Mt++]=Pe,vt[0]=Math.min(vt[0],st+this.objectOffset[0]),vt[1]=Math.min(vt[1],Et+this.objectOffset[1]),vt[2]=Math.min(vt[2],ke+this.objectOffset[2]),Yt=Math.min(Yt,bt),Lt[0]=Math.max(Lt[0],st+this.objectOffset[0]),Lt[1]=Math.max(Lt[1],Et+this.objectOffset[1]),Lt[2]=Math.max(Lt[2],ke+this.objectOffset[2]),At=Math.max(At,bt),Tt+=1}}}for(N.intensityBounds&&(Yt=+N.intensityBounds[0],At=+N.intensityBounds[1]),Z=6;Z<Mt;Z+=10)Bt[Z]=(Bt[Z]-Yt)/(At-Yt);this._vertexCount=Tt,this._coordinateBuffer.update(Bt.subarray(0,Mt)),t.freeFloat(Bt),t.free(we.data),this.bounds=[vt,Lt],this.intensity=N.intensity||this._field[2],(this.intensityBounds[0]!==Yt||this.intensityBounds[1]!==At)&&(q=!0),this.intensityBounds=[Yt,At]}if("levels"in N){var zt=N.levels;for(Array.isArray(zt[0])?zt=zt.slice():zt=[[],[],zt],Z=0;Z<3;++Z)zt[Z]=zt[Z].slice(),zt[Z].sort(function(xt,kt){return xt-kt});for(Z=0;Z<3;++Z)for(pe=0;pe<zt[Z].length;++pe)zt[Z][pe]-=this.objectOffset[Z];e:for(Z=0;Z<3;++Z){if(zt[Z].length!==this.contourLevels[Z].length){q=!0;break}for(pe=0;pe<zt[Z].length;++pe)if(zt[Z][pe]!==this.contourLevels[Z][pe]){q=!0;break e}}this.contourLevels=zt}if(q){ge=this._field,W=this.shape;for(var $t=[],Ot=0;Ot<3;++Ot){var Qt=this.contourLevels[Ot],tr=[],qt=[],lr=[0,0,0];for(Z=0;Z<Qt.length;++Z){var Wr=p(this._field[Ot],Qt[Z]);tr.push($t.length/5|0),Tt=0;e:for(pe=0;pe<Wr.cells.length;++pe){var cn=Wr.cells[pe];for(je=0;je<2;++je){var Jr=Wr.positions[cn[je]],ot=Jr[0],Vt=Math.floor(ot)|0,jt=ot-Vt,Ut=Jr[1],yr=Math.floor(Ut)|0,nt=Ut-yr,_e=!1;t:for(var Me=0;Me<3;++Me){lr[Me]=0;var Ne=(Ot+Me+1)%3;for(at=0;at<2;++at){var We=at?jt:1-jt;for(Ye=Math.min(Math.max(Vt+at,0),W[0])|0,ct=0;ct<2;++ct){var Qe=ct?nt:1-nt;if(Ke=Math.min(Math.max(yr+ct,0),W[1])|0,Me<2?ke=this._field[Ne].get(Ye,Ke):ke=(this.intensity.get(Ye,Ke)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(ke)||isNaN(ke)){_e=!0;break t}var rt=We*Qe;lr[Me]+=rt*ke}}}if(!_e)$t.push(lr[0],lr[1],Jr[0],Jr[1],lr[2]),Tt+=1;else{if(je>0){for(var $e=0;$e<5;++$e)$t.pop();Tt-=1}continue e}}}qt.push(Tt)}this._contourOffsets[Ot]=tr,this._contourCounts[Ot]=qt}var ht=t.mallocFloat($t.length);for(Z=0;Z<$t.length;++Z)ht[Z]=$t[Z];this._contourBuffer.update(ht),t.freeFloat(ht)}},I.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var N=0;N<3;++N)t.freeFloat(this._field[N].data)},I.highlight=function(N){var U;if(!N){this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],this.highlightLevel=[-1,-1,-1];return}for(U=0;U<3;++U)this.enableHighlight[U]?this.highlightLevel[U]=N.level[U]:this.highlightLevel[U]=-1;var q;for(this.snapToData?q=N.dataCoordinate:q=N.position,U=0;U<3;++U)q[U]-=this.objectOffset[U];if(!((!this.enableDynamic[0]||q[0]===this.dynamicLevel[0])&&(!this.enableDynamic[1]||q[1]===this.dynamicLevel[1])&&(!this.enableDynamic[2]||q[2]===this.dynamicLevel[2]))){for(var Q=0,W=this.shape,Z=t.mallocFloat(12*W[0]*W[1]),ee=0;ee<3;++ee){if(!this.enableDynamic[ee]){this.dynamicLevel[ee]=NaN,this._dynamicCounts[ee]=0;continue}this.dynamicLevel[ee]=q[ee];var te=(ee+1)%3,ae=(ee+2)%3,le=this._field[ee],ye=this._field[te],fe=this._field[ae],pe=p(le,q[ee]),ge=pe.cells,Ae=pe.positions;for(this._dynamicOffsets[ee]=Q,U=0;U<ge.length;++U)for(var we=ge[U],De=0;De<2;++De){var Be=Ae[we[De]],Ve=+Be[0],xe=Ve|0,Le=Math.min(xe+1,W[0])|0,He=Ve-xe,Je=1-He,Oe=+Be[1],Pe=Oe|0,Ue=Math.min(Pe+1,W[1])|0,vt=Oe-Pe,Lt=1-vt,Yt=Je*Lt,At=Je*vt,Rt=He*Lt,Bt=He*vt,Mt=Yt*ye.get(xe,Pe)+At*ye.get(xe,Ue)+Rt*ye.get(Le,Pe)+Bt*ye.get(Le,Ue),Tt=Yt*fe.get(xe,Pe)+At*fe.get(xe,Ue)+Rt*fe.get(Le,Pe)+Bt*fe.get(Le,Ue);if(isNaN(Mt)||isNaN(Tt)){De&&(Q-=1);break}Z[2*Q+0]=Mt,Z[2*Q+1]=Tt,Q+=1}this._dynamicCounts[ee]=Q-this._dynamicOffsets[ee]}this._dynamicBuffer.update(Z.subarray(0,2*Q)),t.freeFloat(Z)}};function ie(N){var U=N.gl,q=s(U),Q=x(U),W=A(U),Z=v(U),ee=a(U),te=n(U,[{buffer:ee,size:4,stride:b,offset:0},{buffer:ee,size:3,stride:b,offset:16},{buffer:ee,size:3,stride:b,offset:28}]),ae=a(U),le=n(U,[{buffer:ae,size:4,stride:20,offset:0},{buffer:ae,size:1,stride:20,offset:16}]),ye=a(U),fe=n(U,[{buffer:ye,size:2,type:U.FLOAT}]),pe=r(U,1,P,U.RGBA,U.UNSIGNED_BYTE);pe.minFilter=U.LINEAR,pe.magFilter=U.LINEAR;var ge=new z(U,[0,0],[[0,0,0],[0,0,0]],q,Q,ee,te,pe,W,Z,ae,le,ye,fe,[0,0,0]),Ae={levels:[[],[],[]]};for(var we in N)Ae[we]=N[we];return Ae.colormap=Ae.colormap||"jet",ge.update(Ae),ge}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(c,M,T){var e=c("ndarray"),a=c("ndarray-ops"),n=c("typedarray-pool");M.exports=v;var r=null,t=null,f=null;function o(b){r=[b.LINEAR,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_NEAREST],t=[b.NEAREST,b.LINEAR,b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR],f=[b.REPEAT,b.CLAMP_TO_EDGE,b.MIRRORED_REPEAT]}function i(b){return typeof HTMLCanvasElement!="undefined"&&b instanceof HTMLCanvasElement||typeof HTMLImageElement!="undefined"&&b instanceof HTMLImageElement||typeof HTMLVideoElement!="undefined"&&b instanceof HTMLVideoElement||typeof ImageData!="undefined"&&b instanceof ImageData}var g=function(b,l){a.muls(b,l,255)};function p(b,l,L){var S=b.gl,k=S.getParameter(S.MAX_TEXTURE_SIZE);if(l<0||l>k||L<0||L>k)throw new Error("gl-texture2d: Invalid texture size");return b._shape=[l,L],b.bind(),S.texImage2D(S.TEXTURE_2D,0,b.format,l,L,0,b.format,b.type,null),b._mipLevels=[0],b}function y(b,l,L,S,k,P){this.gl=b,this.handle=l,this.format=k,this.type=P,this._shape=[L,S],this._mipLevels=[0],this._magFilter=b.NEAREST,this._minFilter=b.NEAREST,this._wrapS=b.CLAMP_TO_EDGE,this._wrapT=b.CLAMP_TO_EDGE,this._anisoSamples=1;var z=this,I=[this._wrapS,this._wrapT];Object.defineProperties(I,[{get:function(){return z._wrapS},set:function(R){return z.wrapS=R}},{get:function(){return z._wrapT},set:function(R){return z.wrapT=R}}]),this._wrapVector=I;var D=[this._shape[0],this._shape[1]];Object.defineProperties(D,[{get:function(){return z._shape[0]},set:function(R){return z.width=R}},{get:function(){return z._shape[1]},set:function(R){return z.height=R}}]),this._shapeVector=D}var h=y.prototype;Object.defineProperties(h,{minFilter:{get:function(){return this._minFilter},set:function(b){this.bind();var l=this.gl;if(this.type===l.FLOAT&&r.indexOf(b)>=0&&(l.getExtension("OES_texture_float_linear")||(b=l.NEAREST)),t.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,b),this._minFilter=b}},magFilter:{get:function(){return this._magFilter},set:function(b){this.bind();var l=this.gl;if(this.type===l.FLOAT&&r.indexOf(b)>=0&&(l.getExtension("OES_texture_float_linear")||(b=l.NEAREST)),t.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,b),this._magFilter=b}},mipSamples:{get:function(){return this._anisoSamples},set:function(b){var l=this._anisoSamples;if(this._anisoSamples=Math.max(b,1)|0,l!==this._anisoSamples){var L=this.gl.getExtension("EXT_texture_filter_anisotropic");L&&this.gl.texParameterf(this.gl.TEXTURE_2D,L.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(b){if(this.bind(),f.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,b),this._wrapS=b}},wrapT:{get:function(){return this._wrapT},set:function(b){if(this.bind(),f.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,b),this._wrapT=b}},wrap:{get:function(){return this._wrapVector},set:function(b){if(Array.isArray(b)||(b=[b,b]),b.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var l=0;l<2;++l)if(f.indexOf(b[l])<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);this._wrapS=b[0],this._wrapT=b[1];var L=this.gl;return this.bind(),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_S,this._wrapS),L.texParameteri(L.TEXTURE_2D,L.TEXTURE_WRAP_T,this._wrapT),b}},shape:{get:function(){return this._shapeVector},set:function(b){if(!Array.isArray(b))b=[b|0,b|0];else if(b.length!==2)throw new Error("gl-texture2d: Invalid texture shape");return p(this,b[0]|0,b[1]|0),[b[0]|0,b[1]|0]}},width:{get:function(){return this._shape[0]},set:function(b){return b=b|0,p(this,b,this._shape[1]),b}},height:{get:function(){return this._shape[1]},set:function(b){return b=b|0,p(this,this._shape[0],b),b}}}),h.bind=function(b){var l=this.gl;return b!==void 0&&l.activeTexture(l.TEXTURE0+(b|0)),l.bindTexture(l.TEXTURE_2D,this.handle),b!==void 0?b|0:l.getParameter(l.ACTIVE_TEXTURE)-l.TEXTURE0},h.dispose=function(){this.gl.deleteTexture(this.handle)},h.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var b=Math.min(this._shape[0],this._shape[1]),l=0;b>0;++l,b>>>=1)this._mipLevels.indexOf(l)<0&&this._mipLevels.push(l)},h.setPixels=function(b,l,L,S){var k=this.gl;this.bind(),Array.isArray(l)?(S=L,L=l[1]|0,l=l[0]|0):(l=l||0,L=L||0),S=S||0;var P=i(b)?b:b.raw;if(P){var z=this._mipLevels.indexOf(S)<0;z?(k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,this.type,P),this._mipLevels.push(S)):k.texSubImage2D(k.TEXTURE_2D,S,l,L,this.format,this.type,P)}else if(b.shape&&b.stride&&b.data){if(b.shape.length<2||l+b.shape[1]>this._shape[1]>>>S||L+b.shape[0]>this._shape[0]>>>S||l<0||L<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");u(k,l,L,S,this.format,this.type,this._mipLevels,b)}else throw new Error("gl-texture2d: Unsupported data type")};function m(b,l){return b.length===3?l[2]===1&&l[1]===b[0]*b[2]&&l[0]===b[2]:l[0]===1&&l[1]===b[0]}function u(b,l,L,S,k,P,z,I){var D=I.dtype,R=I.shape.slice();if(R.length<2||R.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var B=0,F=0,V=m(R,I.stride.slice());if(D==="float32"?B=b.FLOAT:D==="float64"?(B=b.FLOAT,V=!1,D="float32"):D==="uint8"?B=b.UNSIGNED_BYTE:(B=b.UNSIGNED_BYTE,V=!1,D="uint8"),R.length===2)F=b.LUMINANCE,R=[R[0],R[1],1],I=e(I.data,R,[I.stride[0],I.stride[1],1],I.offset);else if(R.length===3)if(R[2]===1)F=b.ALPHA;else if(R[2]===2)F=b.LUMINANCE_ALPHA;else if(R[2]===3)F=b.RGB;else if(R[2]===4)F=b.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");else throw new Error("gl-texture2d: Invalid shape for texture");if((F===b.LUMINANCE||F===b.ALPHA)&&(k===b.LUMINANCE||k===b.ALPHA)&&(F=k),F!==k)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var G=I.size,J=z.indexOf(S)<0;if(J&&z.push(S),B===P&&V)I.offset===0&&I.data.length===G?J?b.texImage2D(b.TEXTURE_2D,S,k,R[0],R[1],0,k,P,I.data):b.texSubImage2D(b.TEXTURE_2D,S,l,L,R[0],R[1],k,P,I.data):J?b.texImage2D(b.TEXTURE_2D,S,k,R[0],R[1],0,k,P,I.data.subarray(I.offset,I.offset+G)):b.texSubImage2D(b.TEXTURE_2D,S,l,L,R[0],R[1],k,P,I.data.subarray(I.offset,I.offset+G));else{var j;P===b.FLOAT?j=n.mallocFloat32(G):j=n.mallocUint8(G);var Y=e(j,R,[R[2],R[2]*R[0],1]);B===b.FLOAT&&P===b.UNSIGNED_BYTE?g(Y,I):a.assign(Y,I),J?b.texImage2D(b.TEXTURE_2D,S,k,R[0],R[1],0,k,P,j.subarray(0,G)):b.texSubImage2D(b.TEXTURE_2D,S,l,L,R[0],R[1],k,P,j.subarray(0,G)),P===b.FLOAT?n.freeFloat32(j):n.freeUint8(j)}}function _(b){var l=b.createTexture();return b.bindTexture(b.TEXTURE_2D,l),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),l}function s(b,l,L,S,k){var P=b.getParameter(b.MAX_TEXTURE_SIZE);if(l<0||l>P||L<0||L>P)throw new Error("gl-texture2d: Invalid texture shape");if(k===b.FLOAT&&!b.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var z=_(b);return b.texImage2D(b.TEXTURE_2D,0,S,l,L,0,S,k,null),new y(b,z,l,L,S,k)}function A(b,l,L,S,k,P){var z=_(b);return b.texImage2D(b.TEXTURE_2D,0,k,k,P,l),new y(b,z,L,S,k,P)}function x(b,l){var L=l.dtype,S=l.shape.slice(),k=b.getParameter(b.MAX_TEXTURE_SIZE);if(S[0]<0||S[0]>k||S[1]<0||S[1]>k)throw new Error("gl-texture2d: Invalid texture size");var P=m(S,l.stride.slice()),z=0;L==="float32"?z=b.FLOAT:L==="float64"?(z=b.FLOAT,P=!1,L="float32"):L==="uint8"?z=b.UNSIGNED_BYTE:(z=b.UNSIGNED_BYTE,P=!1,L="uint8");var I=0;if(S.length===2)I=b.LUMINANCE,S=[S[0],S[1],1],l=e(l.data,S,[l.stride[0],l.stride[1],1],l.offset);else if(S.length===3)if(S[2]===1)I=b.ALPHA;else if(S[2]===2)I=b.LUMINANCE_ALPHA;else if(S[2]===3)I=b.RGB;else if(S[2]===4)I=b.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");else throw new Error("gl-texture2d: Invalid shape for texture");z===b.FLOAT&&!b.getExtension("OES_texture_float")&&(z=b.UNSIGNED_BYTE,P=!1);var D,R,B=l.size;if(P)l.offset===0&&l.data.length===B?D=l.data:D=l.data.subarray(l.offset,l.offset+B);else{var F=[S[2],S[2]*S[0],1];R=n.malloc(B,L);var V=e(R,S,F,0);(L==="float32"||L==="float64")&&z===b.UNSIGNED_BYTE?g(V,l):a.assign(V,l),D=R.subarray(0,B)}var G=_(b);return b.texImage2D(b.TEXTURE_2D,0,I,S[0],S[1],0,I,z,D),P||n.free(R),new y(b,G,S[0],S[1],I,z)}function v(b){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(r||o(b),typeof arguments[1]=="number")return s(b,arguments[1],arguments[2],arguments[3]||b.RGBA,arguments[4]||b.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return s(b,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var l=arguments[1],L=i(l)?l:l.raw;if(L)return A(b,L,l.width|0,l.height|0,arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(l.shape&&l.data&&l.stride)return x(b,l)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(c,M,T){function e(a,n,r){n?n.bind():a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,null);var t=a.getParameter(a.MAX_VERTEX_ATTRIBS)|0;if(r){if(r.length>t)throw new Error("gl-vao: Too many vertex attributes");for(var f=0;f<r.length;++f){var o=r[f];if(o.buffer){var i=o.buffer,g=o.size||4,p=o.type||a.FLOAT,y=!!o.normalized,h=o.stride||0,m=o.offset||0;i.bind(),a.enableVertexAttribArray(f),a.vertexAttribPointer(f,g,p,y,h,m)}else{if(typeof o=="number")a.vertexAttrib1f(f,o);else if(o.length===1)a.vertexAttrib1f(f,o[0]);else if(o.length===2)a.vertexAttrib2f(f,o[0],o[1]);else if(o.length===3)a.vertexAttrib3f(f,o[0],o[1],o[2]);else if(o.length===4)a.vertexAttrib4f(f,o[0],o[1],o[2],o[3]);else throw new Error("gl-vao: Invalid vertex attribute");a.disableVertexAttribArray(f)}}for(;f<t;++f)a.disableVertexAttribArray(f)}else{a.bindBuffer(a.ARRAY_BUFFER,null);for(var f=0;f<t;++f)a.disableVertexAttribArray(f)}}M.exports=e},{}],148:[function(c,M,T){var e=c("./do-bind.js");function a(r){this.gl=r,this._elements=null,this._attributes=null,this._elementsType=r.UNSIGNED_SHORT}a.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},a.prototype.update=function(r,t,f){this._elements=t,this._attributes=r,this._elementsType=f||this.gl.UNSIGNED_SHORT},a.prototype.dispose=function(){},a.prototype.unbind=function(){},a.prototype.draw=function(r,t,f){f=f||0;var o=this.gl;this._elements?o.drawElements(r,t,this._elementsType,f):o.drawArrays(r,f,t)};function n(r){return new a(r)}M.exports=n},{"./do-bind.js":147}],149:[function(c,M,T){var e=c("./do-bind.js");function a(t,f,o,i,g,p){this.location=t,this.dimension=f,this.a=o,this.b=i,this.c=g,this.d=p}a.prototype.bind=function(t){switch(this.dimension){case 1:t.vertexAttrib1f(this.location,this.a);break;case 2:t.vertexAttrib2f(this.location,this.a,this.b);break;case 3:t.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:t.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function n(t,f,o){this.gl=t,this._ext=f,this.handle=o,this._attribs=[],this._useElements=!1,this._elementsType=t.UNSIGNED_SHORT}n.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var t=0;t<this._attribs.length;++t)this._attribs[t].bind(this.gl)},n.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},n.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},n.prototype.update=function(t,f,o){if(this.bind(),e(this.gl,f,t),this.unbind(),this._attribs.length=0,t)for(var i=0;i<t.length;++i){var g=t[i];typeof g=="number"?this._attribs.push(new a(i,1,g)):Array.isArray(g)&&this._attribs.push(new a(i,g.length,g[0],g[1],g[2],g[3]))}this._useElements=!!f,this._elementsType=o||this.gl.UNSIGNED_SHORT},n.prototype.draw=function(t,f,o){o=o||0;var i=this.gl;this._useElements?i.drawElements(t,f,this._elementsType,o):i.drawArrays(t,o,f)};function r(t,f){return new n(t,f,f.createVertexArrayOES())}M.exports=r},{"./do-bind.js":147}],150:[function(c,M,T){var e=c("./lib/vao-native.js"),a=c("./lib/vao-emulated.js");function n(t){this.bindVertexArrayOES=t.bindVertexArray.bind(t),this.createVertexArrayOES=t.createVertexArray.bind(t),this.deleteVertexArrayOES=t.deleteVertexArray.bind(t)}function r(t,f,o,i){var g=t.createVertexArray?new n(t):t.getExtension("OES_vertex_array_object"),p;return g?p=e(t,g):p=a(t),p.update(f,o,i),p}M.exports=r},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a}},{}],152:[function(c,M,T){M.exports=r;var e=c("./fromValues"),a=c("./normalize"),n=c("./dot");function r(t,f){var o=e(t[0],t[1],t[2]),i=e(f[0],f[1],f[2]);a(o,o),a(i,i);var g=n(o,i);return g>1?0:Math.acos(g)}},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(c,M,T){M.exports=e;function e(a,n){return a[0]=Math.ceil(n[0]),a[1]=Math.ceil(n[1]),a[2]=Math.ceil(n[2]),a}},{}],154:[function(c,M,T){M.exports=e;function e(a){var n=new Float32Array(3);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n}},{}],155:[function(c,M,T){M.exports=e;function e(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a}},{}],156:[function(c,M,T){M.exports=e;function e(){var a=new Float32Array(3);return a[0]=0,a[1]=0,a[2]=0,a}},{}],157:[function(c,M,T){M.exports=e;function e(a,n,r){var t=n[0],f=n[1],o=n[2],i=r[0],g=r[1],p=r[2];return a[0]=f*p-o*g,a[1]=o*i-t*p,a[2]=t*g-f*i,a}},{}],158:[function(c,M,T){M.exports=c("./distance")},{"./distance":159}],159:[function(c,M,T){M.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],f=n[2]-a[2];return Math.sqrt(r*r+t*t+f*f)}},{}],160:[function(c,M,T){M.exports=c("./divide")},{"./divide":161}],161:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=n[0]/r[0],a[1]=n[1]/r[1],a[2]=n[2]/r[2],a}},{}],162:[function(c,M,T){M.exports=e;function e(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]}},{}],163:[function(c,M,T){M.exports=1e-6},{}],164:[function(c,M,T){M.exports=a;var e=c("./epsilon");function a(n,r){var t=n[0],f=n[1],o=n[2],i=r[0],g=r[1],p=r[2];return Math.abs(t-i)<=e*Math.max(1,Math.abs(t),Math.abs(i))&&Math.abs(f-g)<=e*Math.max(1,Math.abs(f),Math.abs(g))&&Math.abs(o-p)<=e*Math.max(1,Math.abs(o),Math.abs(p))}},{"./epsilon":163}],165:[function(c,M,T){M.exports=e;function e(a,n){return a[0]===n[0]&&a[1]===n[1]&&a[2]===n[2]}},{}],166:[function(c,M,T){M.exports=e;function e(a,n){return a[0]=Math.floor(n[0]),a[1]=Math.floor(n[1]),a[2]=Math.floor(n[2]),a}},{}],167:[function(c,M,T){M.exports=a;var e=c("./create")();function a(n,r,t,f,o,i){var g,p;for(r||(r=3),t||(t=0),f?p=Math.min(f*r+t,n.length):p=n.length,g=t;g<p;g+=r)e[0]=n[g],e[1]=n[g+1],e[2]=n[g+2],o(e,e,i),n[g]=e[0],n[g+1]=e[1],n[g+2]=e[2];return n}},{"./create":156}],168:[function(c,M,T){M.exports=e;function e(a,n,r){var t=new Float32Array(3);return t[0]=a,t[1]=n,t[2]=r,t}},{}],169:[function(c,M,T){M.exports={EPSILON:c("./epsilon"),create:c("./create"),clone:c("./clone"),angle:c("./angle"),fromValues:c("./fromValues"),copy:c("./copy"),set:c("./set"),equals:c("./equals"),exactEquals:c("./exactEquals"),add:c("./add"),subtract:c("./subtract"),sub:c("./sub"),multiply:c("./multiply"),mul:c("./mul"),divide:c("./divide"),div:c("./div"),min:c("./min"),max:c("./max"),floor:c("./floor"),ceil:c("./ceil"),round:c("./round"),scale:c("./scale"),scaleAndAdd:c("./scaleAndAdd"),distance:c("./distance"),dist:c("./dist"),squaredDistance:c("./squaredDistance"),sqrDist:c("./sqrDist"),length:c("./length"),len:c("./len"),squaredLength:c("./squaredLength"),sqrLen:c("./sqrLen"),negate:c("./negate"),inverse:c("./inverse"),normalize:c("./normalize"),dot:c("./dot"),cross:c("./cross"),lerp:c("./lerp"),random:c("./random"),transformMat4:c("./transformMat4"),transformMat3:c("./transformMat3"),transformQuat:c("./transformQuat"),rotateX:c("./rotateX"),rotateY:c("./rotateY"),rotateZ:c("./rotateZ"),forEach:c("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(c,M,T){M.exports=e;function e(a,n){return a[0]=1/n[0],a[1]=1/n[1],a[2]=1/n[2],a}},{}],171:[function(c,M,T){M.exports=c("./length")},{"./length":172}],172:[function(c,M,T){M.exports=e;function e(a){var n=a[0],r=a[1],t=a[2];return Math.sqrt(n*n+r*r+t*t)}},{}],173:[function(c,M,T){M.exports=e;function e(a,n,r,t){var f=n[0],o=n[1],i=n[2];return a[0]=f+t*(r[0]-f),a[1]=o+t*(r[1]-o),a[2]=i+t*(r[2]-i),a}},{}],174:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=Math.max(n[0],r[0]),a[1]=Math.max(n[1],r[1]),a[2]=Math.max(n[2],r[2]),a}},{}],175:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=Math.min(n[0],r[0]),a[1]=Math.min(n[1],r[1]),a[2]=Math.min(n[2],r[2]),a}},{}],176:[function(c,M,T){M.exports=c("./multiply")},{"./multiply":177}],177:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=n[0]*r[0],a[1]=n[1]*r[1],a[2]=n[2]*r[2],a}},{}],178:[function(c,M,T){M.exports=e;function e(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a}},{}],179:[function(c,M,T){M.exports=e;function e(a,n){var r=n[0],t=n[1],f=n[2],o=r*r+t*t+f*f;return o>0&&(o=1/Math.sqrt(o),a[0]=n[0]*o,a[1]=n[1]*o,a[2]=n[2]*o),a}},{}],180:[function(c,M,T){M.exports=e;function e(a,n){n=n||1;var r=Math.random()*2*Math.PI,t=Math.random()*2-1,f=Math.sqrt(1-t*t)*n;return a[0]=Math.cos(r)*f,a[1]=Math.sin(r)*f,a[2]=t*n,a}},{}],181:[function(c,M,T){M.exports=e;function e(a,n,r,t){var f=r[1],o=r[2],i=n[1]-f,g=n[2]-o,p=Math.sin(t),y=Math.cos(t);return a[0]=n[0],a[1]=f+i*y-g*p,a[2]=o+i*p+g*y,a}},{}],182:[function(c,M,T){M.exports=e;function e(a,n,r,t){var f=r[0],o=r[2],i=n[0]-f,g=n[2]-o,p=Math.sin(t),y=Math.cos(t);return a[0]=f+g*p+i*y,a[1]=n[1],a[2]=o+g*y-i*p,a}},{}],183:[function(c,M,T){M.exports=e;function e(a,n,r,t){var f=r[0],o=r[1],i=n[0]-f,g=n[1]-o,p=Math.sin(t),y=Math.cos(t);return a[0]=f+i*y-g*p,a[1]=o+i*p+g*y,a[2]=n[2],a}},{}],184:[function(c,M,T){M.exports=e;function e(a,n){return a[0]=Math.round(n[0]),a[1]=Math.round(n[1]),a[2]=Math.round(n[2]),a}},{}],185:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a}},{}],186:[function(c,M,T){M.exports=e;function e(a,n,r,t){return a[0]=n[0]+r[0]*t,a[1]=n[1]+r[1]*t,a[2]=n[2]+r[2]*t,a}},{}],187:[function(c,M,T){M.exports=e;function e(a,n,r,t){return a[0]=n,a[1]=r,a[2]=t,a}},{}],188:[function(c,M,T){M.exports=c("./squaredDistance")},{"./squaredDistance":190}],189:[function(c,M,T){M.exports=c("./squaredLength")},{"./squaredLength":191}],190:[function(c,M,T){M.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],f=n[2]-a[2];return r*r+t*t+f*f}},{}],191:[function(c,M,T){M.exports=e;function e(a){var n=a[0],r=a[1],t=a[2];return n*n+r*r+t*t}},{}],192:[function(c,M,T){M.exports=c("./subtract")},{"./subtract":193}],193:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a}},{}],194:[function(c,M,T){M.exports=e;function e(a,n,r){var t=n[0],f=n[1],o=n[2];return a[0]=t*r[0]+f*r[3]+o*r[6],a[1]=t*r[1]+f*r[4]+o*r[7],a[2]=t*r[2]+f*r[5]+o*r[8],a}},{}],195:[function(c,M,T){M.exports=e;function e(a,n,r){var t=n[0],f=n[1],o=n[2],i=r[3]*t+r[7]*f+r[11]*o+r[15];return i=i||1,a[0]=(r[0]*t+r[4]*f+r[8]*o+r[12])/i,a[1]=(r[1]*t+r[5]*f+r[9]*o+r[13])/i,a[2]=(r[2]*t+r[6]*f+r[10]*o+r[14])/i,a}},{}],196:[function(c,M,T){M.exports=e;function e(a,n,r){var t=n[0],f=n[1],o=n[2],i=r[0],g=r[1],p=r[2],y=r[3],h=y*t+g*o-p*f,m=y*f+p*t-i*o,u=y*o+i*f-g*t,_=-i*t-g*f-p*o;return a[0]=h*y+_*-i+m*-p-u*-g,a[1]=m*y+_*-g+u*-i-h*-p,a[2]=u*y+_*-p+h*-g-m*-i,a}},{}],197:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=n[0]+r[0],a[1]=n[1]+r[1],a[2]=n[2]+r[2],a[3]=n[3]+r[3],a}},{}],198:[function(c,M,T){M.exports=e;function e(a){var n=new Float32Array(4);return n[0]=a[0],n[1]=a[1],n[2]=a[2],n[3]=a[3],n}},{}],199:[function(c,M,T){M.exports=e;function e(a,n){return a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],a}},{}],200:[function(c,M,T){M.exports=e;function e(){var a=new Float32Array(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a}},{}],201:[function(c,M,T){M.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],f=n[2]-a[2],o=n[3]-a[3];return Math.sqrt(r*r+t*t+f*f+o*o)}},{}],202:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=n[0]/r[0],a[1]=n[1]/r[1],a[2]=n[2]/r[2],a[3]=n[3]/r[3],a}},{}],203:[function(c,M,T){M.exports=e;function e(a,n){return a[0]*n[0]+a[1]*n[1]+a[2]*n[2]+a[3]*n[3]}},{}],204:[function(c,M,T){M.exports=e;function e(a,n,r,t){var f=new Float32Array(4);return f[0]=a,f[1]=n,f[2]=r,f[3]=t,f}},{}],205:[function(c,M,T){M.exports={create:c("./create"),clone:c("./clone"),fromValues:c("./fromValues"),copy:c("./copy"),set:c("./set"),add:c("./add"),subtract:c("./subtract"),multiply:c("./multiply"),divide:c("./divide"),min:c("./min"),max:c("./max"),scale:c("./scale"),scaleAndAdd:c("./scaleAndAdd"),distance:c("./distance"),squaredDistance:c("./squaredDistance"),length:c("./length"),squaredLength:c("./squaredLength"),negate:c("./negate"),inverse:c("./inverse"),normalize:c("./normalize"),dot:c("./dot"),lerp:c("./lerp"),random:c("./random"),transformMat4:c("./transformMat4"),transformQuat:c("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(c,M,T){M.exports=e;function e(a,n){return a[0]=1/n[0],a[1]=1/n[1],a[2]=1/n[2],a[3]=1/n[3],a}},{}],207:[function(c,M,T){M.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],f=a[3];return Math.sqrt(n*n+r*r+t*t+f*f)}},{}],208:[function(c,M,T){M.exports=e;function e(a,n,r,t){var f=n[0],o=n[1],i=n[2],g=n[3];return a[0]=f+t*(r[0]-f),a[1]=o+t*(r[1]-o),a[2]=i+t*(r[2]-i),a[3]=g+t*(r[3]-g),a}},{}],209:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=Math.max(n[0],r[0]),a[1]=Math.max(n[1],r[1]),a[2]=Math.max(n[2],r[2]),a[3]=Math.max(n[3],r[3]),a}},{}],210:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=Math.min(n[0],r[0]),a[1]=Math.min(n[1],r[1]),a[2]=Math.min(n[2],r[2]),a[3]=Math.min(n[3],r[3]),a}},{}],211:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=n[0]*r[0],a[1]=n[1]*r[1],a[2]=n[2]*r[2],a[3]=n[3]*r[3],a}},{}],212:[function(c,M,T){M.exports=e;function e(a,n){return a[0]=-n[0],a[1]=-n[1],a[2]=-n[2],a[3]=-n[3],a}},{}],213:[function(c,M,T){M.exports=e;function e(a,n){var r=n[0],t=n[1],f=n[2],o=n[3],i=r*r+t*t+f*f+o*o;return i>0&&(i=1/Math.sqrt(i),a[0]=r*i,a[1]=t*i,a[2]=f*i,a[3]=o*i),a}},{}],214:[function(c,M,T){var e=c("./normalize"),a=c("./scale");M.exports=n;function n(r,t){return t=t||1,r[0]=Math.random(),r[1]=Math.random(),r[2]=Math.random(),r[3]=Math.random(),e(r,r),a(r,r,t),r}},{"./normalize":213,"./scale":215}],215:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=n[0]*r,a[1]=n[1]*r,a[2]=n[2]*r,a[3]=n[3]*r,a}},{}],216:[function(c,M,T){M.exports=e;function e(a,n,r,t){return a[0]=n[0]+r[0]*t,a[1]=n[1]+r[1]*t,a[2]=n[2]+r[2]*t,a[3]=n[3]+r[3]*t,a}},{}],217:[function(c,M,T){M.exports=e;function e(a,n,r,t,f){return a[0]=n,a[1]=r,a[2]=t,a[3]=f,a}},{}],218:[function(c,M,T){M.exports=e;function e(a,n){var r=n[0]-a[0],t=n[1]-a[1],f=n[2]-a[2],o=n[3]-a[3];return r*r+t*t+f*f+o*o}},{}],219:[function(c,M,T){M.exports=e;function e(a){var n=a[0],r=a[1],t=a[2],f=a[3];return n*n+r*r+t*t+f*f}},{}],220:[function(c,M,T){M.exports=e;function e(a,n,r){return a[0]=n[0]-r[0],a[1]=n[1]-r[1],a[2]=n[2]-r[2],a[3]=n[3]-r[3],a}},{}],221:[function(c,M,T){M.exports=e;function e(a,n,r){var t=n[0],f=n[1],o=n[2],i=n[3];return a[0]=r[0]*t+r[4]*f+r[8]*o+r[12]*i,a[1]=r[1]*t+r[5]*f+r[9]*o+r[13]*i,a[2]=r[2]*t+r[6]*f+r[10]*o+r[14]*i,a[3]=r[3]*t+r[7]*f+r[11]*o+r[15]*i,a}},{}],222:[function(c,M,T){M.exports=e;function e(a,n,r){var t=n[0],f=n[1],o=n[2],i=r[0],g=r[1],p=r[2],y=r[3],h=y*t+g*o-p*f,m=y*f+p*t-i*o,u=y*o+i*f-g*t,_=-i*t-g*f-p*o;return a[0]=h*y+_*-i+m*-p-u*-g,a[1]=m*y+_*-g+u*-i-h*-p,a[2]=u*y+_*-p+h*-g-m*-i,a[3]=n[3],a}},{}],223:[function(c,M,T){var e=c("glsl-tokenizer"),a=c("atob-lite");M.exports=n;function n(r){for(var t=Array.isArray(r)?r:e(r),f=0;f<t.length;f++){var o=t[f];if(o.type==="preprocessor"){var i=o.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(!!i&&!!i[2]){var g=i[1],p=i[2];return(g?a(p):p).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(c,M,T){M.exports=l;var e=c("./lib/literals"),a=c("./lib/operators"),n=c("./lib/builtins"),r=c("./lib/literals-300es"),t=c("./lib/builtins-300es"),f=999,o=9999,i=0,g=1,p=2,y=3,h=4,m=5,u=6,_=7,s=8,A=9,x=10,v=11,b=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function l(L){var S=0,k=0,P=f,z,I,D=[],R=[],B=1,F=0,V=0,G=!1,J=!1,j="",Y;L=L||{};var X=n,oe=e;L.version==="300 es"&&(X=t,oe=r);for(var se={},ie={},S=0;S<X.length;S++)se[X[S]]=!0;for(var S=0;S<oe.length;S++)ie[oe[S]]=!0;return function(Ae){return R=[],Ae!==null?U(Ae):q()};function N(Ae){Ae.length&&R.push({type:b[P],data:Ae,position:V,line:B,column:F})}function U(Ae){S=0,Ae.toString&&(Ae=Ae.toString()),j+=Ae.replace(/\r\n/g,`
`),Y=j.length;for(var we;z=j[S],S<Y;){switch(we=S,P){case i:S=te();break;case g:S=ee();break;case p:S=Z();break;case y:S=ae();break;case h:S=fe();break;case v:S=ye();break;case m:S=pe();break;case o:S=ge();break;case A:S=W();break;case f:S=Q();break}if(we!==S)switch(j[we]){case`
`:F=0,++B;break;default:++F;break}}return k+=S,j=j.slice(S),R}function q(Ae){return D.length&&N(D.join("")),P=x,N("(eof)"),R}function Q(){return D=D.length?[]:D,I==="/"&&z==="*"?(V=k+S-1,P=i,I=z,S+1):I==="/"&&z==="/"?(V=k+S-1,P=g,I=z,S+1):z==="#"?(P=p,V=k+S,S):/\s/.test(z)?(P=A,V=k+S,S):(G=/\d/.test(z),J=/[^\w_]/.test(z),V=k+S,P=G?h:J?y:o,S)}function W(){return/[^\s]/g.test(z)?(N(D.join("")),P=f,S):(D.push(z),I=z,S+1)}function Z(){return(z==="\r"||z===`
`)&&I!=="\\"?(N(D.join("")),P=f,S):(D.push(z),I=z,S+1)}function ee(){return Z()}function te(){return z==="/"&&I==="*"?(D.push(z),N(D.join("")),P=f,S+1):(D.push(z),I=z,S+1)}function ae(){if(I==="."&&/\d/.test(z))return P=m,S;if(I==="/"&&z==="*")return P=i,S;if(I==="/"&&z==="/")return P=g,S;if(z==="."&&D.length){for(;le(D););return P=m,S}if(z===";"||z===")"||z==="("){if(D.length)for(;le(D););return N(z),P=f,S+1}var Ae=D.length===2&&z!=="=";if(/[\w_\d\s]/.test(z)||Ae){for(;le(D););return P=f,S}return D.push(z),I=z,S+1}function le(Ae){var we=0,De,Be;do{if(De=a.indexOf(Ae.slice(0,Ae.length+we).join("")),Be=a[De],De===-1){if(we--+Ae.length>0)continue;Be=Ae.slice(0,1).join("")}return N(Be),V+=Be.length,D=D.slice(Be.length),D.length}while(1)}function ye(){return/[^a-fA-F0-9]/.test(z)?(N(D.join("")),P=f,S):(D.push(z),I=z,S+1)}function fe(){return z==="."||/[eE]/.test(z)?(D.push(z),P=m,I=z,S+1):z==="x"&&D.length===1&&D[0]==="0"?(P=v,D.push(z),I=z,S+1):/[^\d]/.test(z)?(N(D.join("")),P=f,S):(D.push(z),I=z,S+1)}function pe(){return z==="f"&&(D.push(z),I=z,S+=1),/[eE]/.test(z)||(z==="-"||z==="+")&&/[eE]/.test(I)?(D.push(z),I=z,S+1):/[^\d]/.test(z)?(N(D.join("")),P=f,S):(D.push(z),I=z,S+1)}function ge(){if(/[^\d\w_]/.test(z)){var Ae=D.join("");return ie[Ae]?P=s:se[Ae]?P=_:P=u,N(D.join("")),P=f,S}return D.push(z),I=z,S+1}}},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(c,M,T){var e=c("./builtins");e=e.slice().filter(function(a){return!/^(gl\_|texture)/.test(a)}),M.exports=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(c,M,T){M.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(c,M,T){var e=c("./literals");M.exports=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(c,M,T){M.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(c,M,T){M.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(c,M,T){var e=c("./index");M.exports=a;function a(n,r){var t=e(r),f=[];return f=f.concat(t(n)),f=f.concat(t(null)),f}},{"./index":224}],231:[function(c,M,T){M.exports=function(e){typeof e=="string"&&(e=[e]);for(var a=[].slice.call(arguments,1),n=[],r=0;r<e.length-1;r++)n.push(e[r],a[r]||"");return n.push(e[r]),n.join("")}},{}],232:[function(c,M,T){var e=c("is-browser");function a(){var n=!1;try{var r=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("test",null,r),window.removeEventListener("test",null,r)}catch{n=!1}return n}M.exports=e&&a()},{"is-browser":236}],233:[function(c,M,T){M.exports=y;var e=c("robust-orientation"),a=c("simplicial-complex").compareCells;function n(h,m,u){this.vertices=h,this.adjacent=m,this.boundary=u,this.lastVisited=-1}n.prototype.flip=function(){var h=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=h;var m=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=m};function r(h,m,u){this.vertices=h,this.cell=m,this.index=u}function t(h,m){return a(h.vertices,m.vertices)}function f(h){return function(){var m=this.tuple;return h.apply(this,m)}}function o(h){var m=e[h+1];return m||(m=e),f(m)}var i=[];function g(h,m,u){this.dimension=h,this.vertices=m,this.simplices=u,this.interior=u.filter(function(A){return!A.boundary}),this.tuple=new Array(h+1);for(var _=0;_<=h;++_)this.tuple[_]=this.vertices[_];var s=i[h];s||(s=i[h]=o(h)),this.orient=s}var p=g.prototype;p.handleBoundaryDegeneracy=function(h,m){var u=this.dimension,_=this.vertices.length-1,s=this.tuple,A=this.vertices,x=[h];for(h.lastVisited=-_;x.length>0;){h=x.pop();for(var v=h.adjacent,b=0;b<=u;++b){var l=v[b];if(!(!l.boundary||l.lastVisited<=-_)){for(var L=l.vertices,S=0;S<=u;++S){var k=L[S];k<0?s[S]=m:s[S]=A[k]}var P=this.orient();if(P>0)return l;l.lastVisited=-_,P===0&&x.push(l)}}}return null},p.walk=function(h,m){var u=this.vertices.length-1,_=this.dimension,s=this.vertices,A=this.tuple,x=m?this.interior.length*Math.random()|0:this.interior.length-1,v=this.interior[x];e:for(;!v.boundary;){for(var b=v.vertices,l=v.adjacent,L=0;L<=_;++L)A[L]=s[b[L]];v.lastVisited=u;for(var L=0;L<=_;++L){var S=l[L];if(!(S.lastVisited>=u)){var k=A[L];A[L]=h;var P=this.orient();if(A[L]=k,P<0){v=S;continue e}else S.boundary?S.lastVisited=-u:S.lastVisited=u}}return}return v},p.addPeaks=function(h,m){var u=this.vertices.length-1,_=this.dimension,s=this.vertices,A=this.tuple,x=this.interior,v=this.simplices,b=[m];m.lastVisited=u,m.vertices[m.vertices.indexOf(-1)]=u,m.boundary=!1,x.push(m);for(var l=[];b.length>0;){var m=b.pop(),L=m.vertices,S=m.adjacent,k=L.indexOf(u);if(!(k<0)){for(var P=0;P<=_;++P)if(P!==k){var z=S[P];if(!(!z.boundary||z.lastVisited>=u)){var I=z.vertices;if(z.lastVisited!==-u){for(var D=0,R=0;R<=_;++R)I[R]<0?(D=R,A[R]=h):A[R]=s[I[R]];var B=this.orient();if(B>0){I[D]=u,z.boundary=!1,x.push(z),b.push(z),z.lastVisited=u;continue}else z.lastVisited=-u}var F=z.adjacent,V=L.slice(),G=S.slice(),J=new n(V,G,!0);v.push(J);var j=F.indexOf(m);if(!(j<0)){F[j]=J,G[k]=z,V[P]=-1,G[P]=m,S[P]=J,J.flip();for(var R=0;R<=_;++R){var Y=V[R];if(!(Y<0||Y===u)){for(var X=new Array(_-1),oe=0,se=0;se<=_;++se){var ie=V[se];ie<0||se===R||(X[oe++]=ie)}l.push(new r(X,J,R))}}}}}}}l.sort(t);for(var P=0;P+1<l.length;P+=2){var N=l[P],U=l[P+1],q=N.index,Q=U.index;q<0||Q<0||(N.cell.adjacent[N.index]=U.cell,U.cell.adjacent[U.index]=N.cell)}},p.insert=function(h,m){var u=this.vertices;u.push(h);var _=this.walk(h,m);if(!!_){for(var s=this.dimension,A=this.tuple,x=0;x<=s;++x){var v=_.vertices[x];v<0?A[x]=h:A[x]=u[v]}var b=this.orient(A);b<0||b===0&&(_=this.handleBoundaryDegeneracy(_,h),!_)||this.addPeaks(h,_)}},p.boundary=function(){for(var h=this.dimension,m=[],u=this.simplices,_=u.length,s=0;s<_;++s){var A=u[s];if(A.boundary){for(var x=new Array(h),v=A.vertices,b=0,l=0,L=0;L<=h;++L)v[L]>=0?x[b++]=v[L]:l=L&1;if(l===(h&1)){var S=x[0];x[0]=x[1],x[1]=S}m.push(x)}}return m};function y(h,m){var u=h.length;if(u===0)throw new Error("Must have at least d+1 points");var _=h[0].length;if(u<=_)throw new Error("Must input at least d+1 points");var s=h.slice(0,_+1),A=e.apply(void 0,s);if(A===0)throw new Error("Input not in general position");for(var x=new Array(_+1),v=0;v<=_;++v)x[v]=v;A<0&&(x[0]=1,x[1]=0);for(var b=new n(x,new Array(_+1),!1),l=b.adjacent,L=new Array(_+2),v=0;v<=_;++v){for(var S=x.slice(),k=0;k<=_;++k)k===v&&(S[k]=-1);var P=S[0];S[0]=S[1],S[1]=P;var z=new n(S,new Array(_+1),!0);l[v]=z,L[v]=z}L[_+1]=b;for(var v=0;v<=_;++v)for(var S=l[v].vertices,I=l[v].adjacent,k=0;k<=_;++k){var D=S[k];if(D<0){I[k]=b;continue}for(var R=0;R<=_;++R)l[R].vertices.indexOf(D)<0&&(I[k]=l[R])}for(var B=new g(_,s,L),F=!!m,v=_+1;v<u;++v)B.insert(h[v],F);return B.boundary()}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(c,M,T){var e=c("binary-search-bounds"),a=0,n=1,r=2;M.exports=b;function t(l,L,S,k,P){this.mid=l,this.left=L,this.right=S,this.leftPoints=k,this.rightPoints=P,this.count=(L?L.count:0)+(S?S.count:0)+k.length}var f=t.prototype;function o(l,L){l.mid=L.mid,l.left=L.left,l.right=L.right,l.leftPoints=L.leftPoints,l.rightPoints=L.rightPoints,l.count=L.count}function i(l,L){var S=A(L);l.mid=S.mid,l.left=S.left,l.right=S.right,l.leftPoints=S.leftPoints,l.rightPoints=S.rightPoints,l.count=S.count}function g(l,L){var S=l.intervals([]);S.push(L),i(l,S)}function p(l,L){var S=l.intervals([]),k=S.indexOf(L);return k<0?a:(S.splice(k,1),i(l,S),n)}f.intervals=function(l){return l.push.apply(l,this.leftPoints),this.left&&this.left.intervals(l),this.right&&this.right.intervals(l),l},f.insert=function(l){var L=this.count-this.leftPoints.length;if(this.count+=1,l[1]<this.mid)this.left?4*(this.left.count+1)>3*(L+1)?g(this,l):this.left.insert(l):this.left=A([l]);else if(l[0]>this.mid)this.right?4*(this.right.count+1)>3*(L+1)?g(this,l):this.right.insert(l):this.right=A([l]);else{var S=e.ge(this.leftPoints,l,_),k=e.ge(this.rightPoints,l,s);this.leftPoints.splice(S,0,l),this.rightPoints.splice(k,0,l)}},f.remove=function(l){var L=this.count-this.leftPoints;if(l[1]<this.mid){if(!this.left)return a;var S=this.right?this.right.count:0;if(4*S>3*(L-1))return p(this,l);var k=this.left.remove(l);return k===r?(this.left=null,this.count-=1,n):(k===n&&(this.count-=1),k)}else if(l[0]>this.mid){if(!this.right)return a;var P=this.left?this.left.count:0;if(4*P>3*(L-1))return p(this,l);var k=this.right.remove(l);return k===r?(this.right=null,this.count-=1,n):(k===n&&(this.count-=1),k)}else{if(this.count===1)return this.leftPoints[0]===l?r:a;if(this.leftPoints.length===1&&this.leftPoints[0]===l){if(this.left&&this.right){for(var z=this,I=this.left;I.right;)z=I,I=I.right;if(z===this)I.right=this.right;else{var D=this.left,k=this.right;z.count-=I.count,z.right=I.left,I.left=D,I.right=k}o(this,I),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?o(this,this.left):o(this,this.right);return n}for(var D=e.ge(this.leftPoints,l,_);D<this.leftPoints.length&&this.leftPoints[D][0]===l[0];++D)if(this.leftPoints[D]===l){this.count-=1,this.leftPoints.splice(D,1);for(var k=e.ge(this.rightPoints,l,s);k<this.rightPoints.length&&this.rightPoints[k][1]===l[1];++k)if(this.rightPoints[k]===l)return this.rightPoints.splice(k,1),n}return a}};function y(l,L,S){for(var k=0;k<l.length&&l[k][0]<=L;++k){var P=S(l[k]);if(P)return P}}function h(l,L,S){for(var k=l.length-1;k>=0&&l[k][1]>=L;--k){var P=S(l[k]);if(P)return P}}function m(l,L){for(var S=0;S<l.length;++S){var k=L(l[S]);if(k)return k}}f.queryPoint=function(l,L){if(l<this.mid){if(this.left){var S=this.left.queryPoint(l,L);if(S)return S}return y(this.leftPoints,l,L)}else if(l>this.mid){if(this.right){var S=this.right.queryPoint(l,L);if(S)return S}return h(this.rightPoints,l,L)}else return m(this.leftPoints,L)},f.queryInterval=function(l,L,S){if(l<this.mid&&this.left){var k=this.left.queryInterval(l,L,S);if(k)return k}if(L>this.mid&&this.right){var k=this.right.queryInterval(l,L,S);if(k)return k}return L<this.mid?y(this.leftPoints,L,S):l>this.mid?h(this.rightPoints,l,S):m(this.leftPoints,S)};function u(l,L){return l-L}function _(l,L){var S=l[0]-L[0];return S||l[1]-L[1]}function s(l,L){var S=l[1]-L[1];return S||l[0]-L[0]}function A(l){if(l.length===0)return null;for(var L=[],S=0;S<l.length;++S)L.push(l[S][0],l[S][1]);L.sort(u);for(var k=L[L.length>>1],P=[],z=[],I=[],S=0;S<l.length;++S){var D=l[S];D[1]<k?P.push(D):k<D[0]?z.push(D):I.push(D)}var R=I,B=I.slice();return R.sort(_),B.sort(s),new t(k,A(P),A(z),R,B)}function x(l){this.root=l}var v=x.prototype;v.insert=function(l){this.root?this.root.insert(l):this.root=new t(l[0],null,null,[l],[l])},v.remove=function(l){if(this.root){var L=this.root.remove(l);return L===r&&(this.root=null),L!==a}return!1},v.queryPoint=function(l,L){if(this.root)return this.root.queryPoint(l,L)},v.queryInterval=function(l,L,S){if(l<=L&&this.root)return this.root.queryInterval(l,L,S)},Object.defineProperty(v,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(v,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});function b(l){return!l||l.length===0?new x(null):new x(A(l))}},{"binary-search-bounds":31}],235:[function(c,M,T){function e(a){for(var n=new Array(a),r=0;r<a;++r)n[r]=r;return n}M.exports=e},{}],236:[function(c,M,T){M.exports=!0},{}],237:[function(c,M,T){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */M.exports=function(n){return n!=null&&(e(n)||a(n)||!!n._isBuffer)};function e(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function a(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&e(n.slice(0,0))}},{}],238:[function(c,M,T){M.exports=n,M.exports.isMobile=n,M.exports.default=n;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function n(r){r||(r={});var t=r.ua;if(!t&&typeof navigator!="undefined"&&(t=navigator.userAgent),t&&t.headers&&typeof t.headers["user-agent"]=="string"&&(t=t.headers["user-agent"]),typeof t!="string")return!1;var f=r.tablet?a.test(t):e.test(t);return!f&&r.tablet&&r.featureDetect&&navigator&&navigator.maxTouchPoints>1&&t.indexOf("Macintosh")!==-1&&t.indexOf("Safari")!==-1&&(f=!0),f}},{}],239:[function(c,M,T){M.exports=function(e){for(var a=e.length,n,r=0;r<a;r++)if(n=e.charCodeAt(r),(n<9||n>13)&&n!==32&&n!==133&&n!==160&&n!==5760&&n!==6158&&(n<8192||n>8205)&&n!==8232&&n!==8233&&n!==8239&&n!==8287&&n!==8288&&n!==12288&&n!==65279)return!1;return!0}},{}],240:[function(c,M,T){function e(a,n,r){return a*(1-r)+n*r}M.exports=e},{}],241:[function(c,M,T){var e=c("./normalize"),a=c("gl-mat4/create"),n=c("gl-mat4/clone"),r=c("gl-mat4/determinant"),t=c("gl-mat4/invert"),f=c("gl-mat4/transpose"),o={length:c("gl-vec3/length"),normalize:c("gl-vec3/normalize"),dot:c("gl-vec3/dot"),cross:c("gl-vec3/cross")},i=a(),g=a(),p=[0,0,0,0],y=[[0,0,0],[0,0,0],[0,0,0]],h=[0,0,0];M.exports=function(A,x,v,b,l,L){if(x||(x=[0,0,0]),v||(v=[0,0,0]),b||(b=[0,0,0]),l||(l=[0,0,0,1]),L||(L=[0,0,0,1]),!e(i,A)||(n(g,i),g[3]=0,g[7]=0,g[11]=0,g[15]=1,Math.abs(r(g)<1e-8)))return!1;var S=i[3],k=i[7],P=i[11],z=i[12],I=i[13],D=i[14],R=i[15];if(S!==0||k!==0||P!==0){p[0]=S,p[1]=k,p[2]=P,p[3]=R;var B=t(g,g);if(!B)return!1;f(g,g),m(l,p,g)}else l[0]=l[1]=l[2]=0,l[3]=1;if(x[0]=z,x[1]=I,x[2]=D,u(y,i),v[0]=o.length(y[0]),o.normalize(y[0],y[0]),b[0]=o.dot(y[0],y[1]),_(y[1],y[1],y[0],1,-b[0]),v[1]=o.length(y[1]),o.normalize(y[1],y[1]),b[0]/=v[1],b[1]=o.dot(y[0],y[2]),_(y[2],y[2],y[0],1,-b[1]),b[2]=o.dot(y[1],y[2]),_(y[2],y[2],y[1],1,-b[2]),v[2]=o.length(y[2]),o.normalize(y[2],y[2]),b[1]/=v[2],b[2]/=v[2],o.cross(h,y[1],y[2]),o.dot(y[0],h)<0)for(var F=0;F<3;F++)v[F]*=-1,y[F][0]*=-1,y[F][1]*=-1,y[F][2]*=-1;return L[0]=.5*Math.sqrt(Math.max(1+y[0][0]-y[1][1]-y[2][2],0)),L[1]=.5*Math.sqrt(Math.max(1-y[0][0]+y[1][1]-y[2][2],0)),L[2]=.5*Math.sqrt(Math.max(1-y[0][0]-y[1][1]+y[2][2],0)),L[3]=.5*Math.sqrt(Math.max(1+y[0][0]+y[1][1]+y[2][2],0)),y[2][1]>y[1][2]&&(L[0]=-L[0]),y[0][2]>y[2][0]&&(L[1]=-L[1]),y[1][0]>y[0][1]&&(L[2]=-L[2]),!0};function m(s,A,x){var v=A[0],b=A[1],l=A[2],L=A[3];return s[0]=x[0]*v+x[4]*b+x[8]*l+x[12]*L,s[1]=x[1]*v+x[5]*b+x[9]*l+x[13]*L,s[2]=x[2]*v+x[6]*b+x[10]*l+x[14]*L,s[3]=x[3]*v+x[7]*b+x[11]*l+x[15]*L,s}function u(s,A){s[0][0]=A[0],s[0][1]=A[1],s[0][2]=A[2],s[1][0]=A[4],s[1][1]=A[5],s[1][2]=A[6],s[2][0]=A[8],s[2][1]=A[9],s[2][2]=A[10]}function _(s,A,x,v,b){s[0]=A[0]*v+x[0]*b,s[1]=A[1]*v+x[1]*b,s[2]=A[2]*v+x[2]*b}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(c,M,T){M.exports=function(a,n){var r=n[15];if(r===0)return!1;for(var t=1/r,f=0;f<16;f++)a[f]=n[f]*t;return!0}},{}],243:[function(c,M,T){var e=c("gl-vec3/lerp"),a=c("mat4-recompose"),n=c("mat4-decompose"),r=c("gl-mat4/determinant"),t=c("quat-slerp"),f=p(),o=p(),i=p();M.exports=g;function g(m,u,_,s){if(r(u)===0||r(_)===0)return!1;var A=n(u,f.translate,f.scale,f.skew,f.perspective,f.quaternion),x=n(_,o.translate,o.scale,o.skew,o.perspective,o.quaternion);return!A||!x?!1:(e(i.translate,f.translate,o.translate,s),e(i.skew,f.skew,o.skew,s),e(i.scale,f.scale,o.scale,s),e(i.perspective,f.perspective,o.perspective,s),t(i.quaternion,f.quaternion,o.quaternion,s),a(m,i.translate,i.scale,i.skew,i.perspective,i.quaternion),!0)}function p(){return{translate:y(),scale:y(1),skew:y(),perspective:h(),quaternion:h()}}function y(m){return[m||0,m||0,m||0]}function h(){return[0,0,0,1]}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(c,M,T){var e={identity:c("gl-mat4/identity"),translate:c("gl-mat4/translate"),multiply:c("gl-mat4/multiply"),create:c("gl-mat4/create"),scale:c("gl-mat4/scale"),fromRotationTranslation:c("gl-mat4/fromRotationTranslation")};e.create();var a=e.create();M.exports=function(r,t,f,o,i,g){return e.identity(r),e.fromRotationTranslation(r,g,t),r[3]=i[0],r[7]=i[1],r[11]=i[2],r[15]=i[3],e.identity(a),o[2]!==0&&(a[9]=o[2],e.multiply(r,r,a)),o[1]!==0&&(a[9]=0,a[8]=o[1],e.multiply(r,r,a)),o[0]!==0&&(a[8]=0,a[4]=o[0],e.multiply(r,r,a)),e.scale(r,r,f),r}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(c,M,T){var e=c("binary-search-bounds"),a=c("mat4-interpolate"),n=c("gl-mat4/invert"),r=c("gl-mat4/rotateX"),t=c("gl-mat4/rotateY"),f=c("gl-mat4/rotateZ"),o=c("gl-mat4/lookAt"),i=c("gl-mat4/translate");c("gl-mat4/scale");var g=c("gl-vec3/normalize"),p=[0,0,0];M.exports=u;function y(_){this._components=_.slice(),this._time=[0],this.prevMatrix=_.slice(),this.nextMatrix=_.slice(),this.computedMatrix=_.slice(),this.computedInverse=_.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}var h=y.prototype;h.recalcMatrix=function(_){var s=this._time,A=e.le(s,_),x=this.computedMatrix;if(!(A<0)){var v=this._components;if(A===s.length-1)for(var b=16*A,l=0;l<16;++l)x[l]=v[b++];else{for(var L=s[A+1]-s[A],b=16*A,S=this.prevMatrix,k=!0,l=0;l<16;++l)S[l]=v[b++];for(var P=this.nextMatrix,l=0;l<16;++l)P[l]=v[b++],k=k&&S[l]===P[l];if(L<1e-6||k)for(var l=0;l<16;++l)x[l]=S[l];else a(x,S,P,(_-s[A])/L)}var z=this.computedUp;z[0]=x[1],z[1]=x[5],z[2]=x[9],g(z,z);var I=this.computedInverse;n(I,x);var D=this.computedEye,R=I[15];D[0]=I[12]/R,D[1]=I[13]/R,D[2]=I[14]/R;for(var B=this.computedCenter,F=Math.exp(this.computedRadius[0]),l=0;l<3;++l)B[l]=D[l]-x[2+4*l]*F}},h.idle=function(_){if(!(_<this.lastT())){for(var s=this._components,A=s.length-16,x=0;x<16;++x)s.push(s[A++]);this._time.push(_)}},h.flush=function(_){var s=e.gt(this._time,_)-2;s<0||(this._time.splice(0,s),this._components.splice(0,16*s))},h.lastT=function(){return this._time[this._time.length-1]},h.lookAt=function(_,s,A,x){this.recalcMatrix(_),s=s||this.computedEye,A=A||p,x=x||this.computedUp,this.setMatrix(_,o(this.computedMatrix,s,A,x));for(var v=0,b=0;b<3;++b)v+=Math.pow(A[b]-s[b],2);v=Math.log(Math.sqrt(v)),this.computedRadius[0]=v},h.rotate=function(_,s,A,x){this.recalcMatrix(_);var v=this.computedInverse;s&&t(v,v,s),A&&r(v,v,A),x&&f(v,v,x),this.setMatrix(_,n(this.computedMatrix,v))};var m=[0,0,0];h.pan=function(_,s,A,x){m[0]=-(s||0),m[1]=-(A||0),m[2]=-(x||0),this.recalcMatrix(_);var v=this.computedInverse;i(v,v,m),this.setMatrix(_,n(v,v))},h.translate=function(_,s,A,x){m[0]=s||0,m[1]=A||0,m[2]=x||0,this.recalcMatrix(_);var v=this.computedMatrix;i(v,v,m),this.setMatrix(_,v)},h.setMatrix=function(_,s){if(!(_<this.lastT())){this._time.push(_);for(var A=0;A<16;++A)this._components.push(s[A])}},h.setDistance=function(_,s){this.computedRadius[0]=s},h.setDistanceLimits=function(_,s){var A=this._limits;A[0]=_,A[1]=s},h.getDistanceLimits=function(_){var s=this._limits;return _?(_[0]=s[0],_[1]=s[1],_):s};function u(_){_=_||{};var s=_.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new y(s)}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(c,M,T){M.exports=a;var e=c("robust-orientation")[3];function a(n){var r=n.length;if(r<3){for(var h=new Array(r),t=0;t<r;++t)h[t]=t;return r===2&&n[0][0]===n[1][0]&&n[0][1]===n[1][1]?[0]:h}for(var f=new Array(r),t=0;t<r;++t)f[t]=t;f.sort(function(s,A){var x=n[s][0]-n[A][0];return x||n[s][1]-n[A][1]});for(var o=[f[0],f[1]],i=[f[0],f[1]],t=2;t<r;++t){for(var g=f[t],p=n[g],y=o.length;y>1&&e(n[o[y-2]],n[o[y-1]],p)<=0;)y-=1,o.pop();for(o.push(g),y=i.length;y>1&&e(n[i[y-2]],n[i[y-1]],p)>=0;)y-=1,i.pop();i.push(g)}for(var h=new Array(i.length+o.length-2),m=0,t=0,u=o.length;t<u;++t)h[m++]=o[t];for(var _=i.length-2;_>0;--_)h[m++]=i[_];return h}},{"robust-orientation":284}],247:[function(c,M,T){M.exports=a;var e=c("mouse-event");function a(n,r){r||(r=n,n=window);var t=0,f=0,o=0,i={shift:!1,alt:!1,control:!1,meta:!1},g=!1;function p(l){var L=!1;return"altKey"in l&&(L=L||l.altKey!==i.alt,i.alt=!!l.altKey),"shiftKey"in l&&(L=L||l.shiftKey!==i.shift,i.shift=!!l.shiftKey),"ctrlKey"in l&&(L=L||l.ctrlKey!==i.control,i.control=!!l.ctrlKey),"metaKey"in l&&(L=L||l.metaKey!==i.meta,i.meta=!!l.metaKey),L}function y(l,L){var S=e.x(L),k=e.y(L);"buttons"in L&&(l=L.buttons|0),(l!==t||S!==f||k!==o||p(L))&&(t=l|0,f=S||0,o=k||0,r&&r(t,f,o,i))}function h(l){y(0,l)}function m(){(t||f||o||i.shift||i.alt||i.meta||i.control)&&(f=o=0,t=0,i.shift=i.alt=i.control=i.meta=!1,r&&r(0,0,0,i))}function u(l){p(l)&&r&&r(t,f,o,i)}function _(l){e.buttons(l)===0?y(0,l):y(t,l)}function s(l){y(t|e.buttons(l),l)}function A(l){y(t&~e.buttons(l),l)}function x(){g||(g=!0,n.addEventListener("mousemove",_),n.addEventListener("mousedown",s),n.addEventListener("mouseup",A),n.addEventListener("mouseleave",h),n.addEventListener("mouseenter",h),n.addEventListener("mouseout",h),n.addEventListener("mouseover",h),n.addEventListener("blur",m),n.addEventListener("keyup",u),n.addEventListener("keydown",u),n.addEventListener("keypress",u),n!==window&&(window.addEventListener("blur",m),window.addEventListener("keyup",u),window.addEventListener("keydown",u),window.addEventListener("keypress",u)))}function v(){!g||(g=!1,n.removeEventListener("mousemove",_),n.removeEventListener("mousedown",s),n.removeEventListener("mouseup",A),n.removeEventListener("mouseleave",h),n.removeEventListener("mouseenter",h),n.removeEventListener("mouseout",h),n.removeEventListener("mouseover",h),n.removeEventListener("blur",m),n.removeEventListener("keyup",u),n.removeEventListener("keydown",u),n.removeEventListener("keypress",u),n!==window&&(window.removeEventListener("blur",m),window.removeEventListener("keyup",u),window.removeEventListener("keydown",u),window.removeEventListener("keypress",u)))}x();var b={element:n};return Object.defineProperties(b,{enabled:{get:function(){return g},set:function(l){l?x():v()},enumerable:!0},buttons:{get:function(){return t},enumerable:!0},x:{get:function(){return f},enumerable:!0},y:{get:function(){return o},enumerable:!0},mods:{get:function(){return i},enumerable:!0}}),b}},{"mouse-event":249}],248:[function(c,M,T){var e={left:0,top:0};M.exports=a;function a(r,t,f){t=t||r.currentTarget||r.srcElement,Array.isArray(f)||(f=[0,0]);var o=r.clientX||0,i=r.clientY||0,g=n(t);return f[0]=o-g.left,f[1]=i-g.top,f}function n(r){return r===window||r===document||r===document.body?e:r.getBoundingClientRect()}},{}],249:[function(c,M,T){function e(t){if(typeof t=="object"){if("buttons"in t)return t.buttons;if("which"in t){var f=t.which;if(f===2)return 4;if(f===3)return 2;if(f>0)return 1<<f-1}else if("button"in t){var f=t.button;if(f===1)return 4;if(f===2)return 2;if(f>=0)return 1<<f}}return 0}T.buttons=e;function a(t){return t.target||t.srcElement||window}T.element=a;function n(t){if(typeof t=="object"){if("offsetX"in t)return t.offsetX;var f=a(t),o=f.getBoundingClientRect();return t.clientX-o.left}return 0}T.x=n;function r(t){if(typeof t=="object"){if("offsetY"in t)return t.offsetY;var f=a(t),o=f.getBoundingClientRect();return t.clientY-o.top}return 0}T.y=r},{}],250:[function(c,M,T){var e=c("to-px");M.exports=a;function a(n,r,t){typeof n=="function"&&(t=!!r,r=n,n=window);var f=e("ex",n),o=function(i){t&&i.preventDefault();var g=i.deltaX||0,p=i.deltaY||0,y=i.deltaZ||0,h=i.deltaMode,m=1;switch(h){case 1:m=f;break;case 2:m=window.innerHeight;break}if(g*=m,p*=m,y*=m,g||p||y)return r(g,p,y,i)};return n.addEventListener("wheel",o),o}},{"to-px":304}],251:[function(c,M,T){var e=c("typedarray-pool");M.exports=r;var a={"false,0,1":function(f,o,i,g,p){return function(h,m,u,_){var s=h.shape[0]|0,A=h.shape[1]|0,x=h.data,v=h.offset|0,b=h.stride[0]|0,l=h.stride[1]|0,L=v,S,k=-b|0,P=0,z=-l|0,I=0,D=-b-l|0,R=0,B=b|0,F=l-b*s|0,V=0,G=0,J=0,j=2*s|0,Y=g(j),X=g(j),oe=0,se=0,ie=-1,N=-1,U=0,q=-s|0,Q=s|0,W=0,Z=-s-1|0,ee=s-1|0,te=0,ae=0,le=0;for(V=0;V<s;++V)Y[oe++]=i(x[L],m,u,_),L+=B;if(L+=F,A>0){if(G=1,Y[oe++]=i(x[L],m,u,_),L+=B,s>0)for(V=1,S=x[L],se=Y[oe]=i(S,m,u,_),U=Y[oe+ie],W=Y[oe+q],te=Y[oe+Z],(se!==U||se!==W||se!==te)&&(P=x[L+k],I=x[L+z],R=x[L+D],f(V,G,S,P,I,R,se,U,W,te,m,u,_),ae=X[oe]=J++),oe+=1,L+=B,V=2;V<s;++V)S=x[L],se=Y[oe]=i(S,m,u,_),U=Y[oe+ie],W=Y[oe+q],te=Y[oe+Z],(se!==U||se!==W||se!==te)&&(P=x[L+k],I=x[L+z],R=x[L+D],f(V,G,S,P,I,R,se,U,W,te,m,u,_),ae=X[oe]=J++,te!==U&&o(X[oe+ie],ae,R,P,te,U,m,u,_)),oe+=1,L+=B;for(L+=F,oe=0,le=ie,ie=N,N=le,le=q,q=Q,Q=le,le=Z,Z=ee,ee=le,G=2;G<A;++G){if(Y[oe++]=i(x[L],m,u,_),L+=B,s>0)for(V=1,S=x[L],se=Y[oe]=i(S,m,u,_),U=Y[oe+ie],W=Y[oe+q],te=Y[oe+Z],(se!==U||se!==W||se!==te)&&(P=x[L+k],I=x[L+z],R=x[L+D],f(V,G,S,P,I,R,se,U,W,te,m,u,_),ae=X[oe]=J++,te!==W&&o(X[oe+q],ae,I,R,W,te,m,u,_)),oe+=1,L+=B,V=2;V<s;++V)S=x[L],se=Y[oe]=i(S,m,u,_),U=Y[oe+ie],W=Y[oe+q],te=Y[oe+Z],(se!==U||se!==W||se!==te)&&(P=x[L+k],I=x[L+z],R=x[L+D],f(V,G,S,P,I,R,se,U,W,te,m,u,_),ae=X[oe]=J++,te!==W&&o(X[oe+q],ae,I,R,W,te,m,u,_),te!==U&&o(X[oe+ie],ae,R,P,te,U,m,u,_)),oe+=1,L+=B;G&1&&(oe=0),le=ie,ie=N,N=le,le=q,q=Q,Q=le,le=Z,Z=ee,ee=le,L+=F}}p(X),p(Y)}},"false,1,0":function(f,o,i,g,p){return function(h,m,u,_){var s=h.shape[0]|0,A=h.shape[1]|0,x=h.data,v=h.offset|0,b=h.stride[0]|0,l=h.stride[1]|0,L=v,S,k=-b|0,P=0,z=-l|0,I=0,D=-b-l|0,R=0,B=l|0,F=b-l*A|0,V=0,G=0,J=0,j=2*A|0,Y=g(j),X=g(j),oe=0,se=0,ie=-1,N=-1,U=0,q=-A|0,Q=A|0,W=0,Z=-A-1|0,ee=A-1|0,te=0,ae=0,le=0;for(G=0;G<A;++G)Y[oe++]=i(x[L],m,u,_),L+=B;if(L+=F,s>0){if(V=1,Y[oe++]=i(x[L],m,u,_),L+=B,A>0)for(G=1,S=x[L],se=Y[oe]=i(S,m,u,_),W=Y[oe+q],U=Y[oe+ie],te=Y[oe+Z],(se!==W||se!==U||se!==te)&&(P=x[L+k],I=x[L+z],R=x[L+D],f(V,G,S,P,I,R,se,W,U,te,m,u,_),ae=X[oe]=J++),oe+=1,L+=B,G=2;G<A;++G)S=x[L],se=Y[oe]=i(S,m,u,_),W=Y[oe+q],U=Y[oe+ie],te=Y[oe+Z],(se!==W||se!==U||se!==te)&&(P=x[L+k],I=x[L+z],R=x[L+D],f(V,G,S,P,I,R,se,W,U,te,m,u,_),ae=X[oe]=J++,te!==U&&o(X[oe+ie],ae,I,R,U,te,m,u,_)),oe+=1,L+=B;for(L+=F,oe=0,le=q,q=Q,Q=le,le=ie,ie=N,N=le,le=Z,Z=ee,ee=le,V=2;V<s;++V){if(Y[oe++]=i(x[L],m,u,_),L+=B,A>0)for(G=1,S=x[L],se=Y[oe]=i(S,m,u,_),W=Y[oe+q],U=Y[oe+ie],te=Y[oe+Z],(se!==W||se!==U||se!==te)&&(P=x[L+k],I=x[L+z],R=x[L+D],f(V,G,S,P,I,R,se,W,U,te,m,u,_),ae=X[oe]=J++,te!==W&&o(X[oe+q],ae,R,P,te,W,m,u,_)),oe+=1,L+=B,G=2;G<A;++G)S=x[L],se=Y[oe]=i(S,m,u,_),W=Y[oe+q],U=Y[oe+ie],te=Y[oe+Z],(se!==W||se!==U||se!==te)&&(P=x[L+k],I=x[L+z],R=x[L+D],f(V,G,S,P,I,R,se,W,U,te,m,u,_),ae=X[oe]=J++,te!==U&&o(X[oe+ie],ae,I,R,U,te,m,u,_),te!==W&&o(X[oe+q],ae,R,P,te,W,m,u,_)),oe+=1,L+=B;V&1&&(oe=0),le=q,q=Q,Q=le,le=ie,ie=N,N=le,le=Z,Z=ee,ee=le,L+=F}}p(X),p(Y)}}};function n(t,f,o,i,g,p){var y=[p,g].join(","),h=a[y];return h(t,f,o,e.mallocUint32,e.freeUint32)}function r(t){function f(m){throw new Error("ndarray-extract-contour: "+m)}typeof t!="object"&&f("Must specify arguments");var o=t.order;Array.isArray(o)||f("Must specify order");var i=t.arrayArguments||1;i<1&&f("Must have at least one array argument");var g=t.scalarArguments||0;g<0&&f("Scalar arg count must be > 0"),typeof t.vertex!="function"&&f("Must specify vertex creation function"),typeof t.cell!="function"&&f("Must specify cell creation function"),typeof t.phase!="function"&&f("Must specify phase function");for(var p=t.getters||[],y=new Array(i),h=0;h<i;++h)p.indexOf(h)>=0?y[h]=!0:y[h]=!1;return n(t.vertex,t.cell,t.phase,g,o,y)}},{"typedarray-pool":308}],252:[function(c,M,T){var e=c("dup"),a={zero:function(u,_,s,A){var x=u[0],v=s[0];A|=0;var b=0,l=v;for(b=0;b<x;++b)_[A]=0,A+=l},fdTemplate1:function(u,_,s,A,x,v,b){var l=u[0],L=s[0],S=v[0],k=-1*L,P=L;A|=0,b|=0;var z=0,I=L,D=S;for(z=0;z<l;++z)x[b]=.5*(_[A+k]-_[A+P]),A+=I,b+=D},fdTemplate2:function(u,_,s,A,x,v,b,l,L,S){var k=u[0],P=u[1],z=s[0],I=s[1],D=v[0],R=v[1],B=L[0],F=L[1],V=-1*z,G=z,J=-1*I,j=I;A|=0,b|=0,S|=0;var Y=0,X=0,oe=I,se=z-P*I,ie=R,N=D-P*R,U=F,q=B-P*F;for(X=0;X<k;++X){for(Y=0;Y<P;++Y)x[b]=.5*(_[A+V]-_[A+G]),l[S]=.5*(_[A+J]-_[A+j]),A+=oe,b+=ie,S+=U;A+=se,b+=N,S+=q}}},n={cdiff:function(u){var _={};return function(A,x,v){var b=A.dtype,l=A.order,L=x.dtype,S=x.order,k=v.dtype,P=v.order,z=[b,l.join(),L,S.join(),k,P.join()].join(),I=_[z];return I||(_[z]=I=u([b,l,L,S,k,P])),I(A.shape.slice(0),A.data,A.stride,A.offset|0,x.data,x.stride,x.offset|0,v.data,v.stride,v.offset|0)}},zero:function(u){var _={};return function(A){var x=A.dtype,v=A.order,b=[x,v.join()].join(),l=_[b];return l||(_[b]=l=u([x,v])),l(A.shape.slice(0),A.data,A.stride,A.offset|0)}},fdTemplate1:function(u){var _={};return function(A,x){var v=A.dtype,b=A.order,l=x.dtype,L=x.order,S=[v,b.join(),l,L.join()].join(),k=_[S];return k||(_[S]=k=u([v,b,l,L])),k(A.shape.slice(0),A.data,A.stride,A.offset|0,x.data,x.stride,x.offset|0)}},fdTemplate2:function(u){var _={};return function(A,x,v){var b=A.dtype,l=A.order,L=x.dtype,S=x.order,k=v.dtype,P=v.order,z=[b,l.join(),L,S.join(),k,P.join()].join(),I=_[z];return I||(_[z]=I=u([b,l,L,S,k,P])),I(A.shape.slice(0),A.data,A.stride,A.offset|0,x.data,x.stride,x.offset|0,v.data,v.stride,v.offset|0)}}};function r(u){var _=n[u.funcName];return _(t.bind(void 0,u))}function t(u){return a[u.funcName]}function f(u){return r({funcName:u.funcName})}var o={},i={},g=f({funcName:"cdiff"}),p=f({funcName:"zero"});function y(u){return u in o?o[u]:o[u]=f({funcName:"fdTemplate"+u})}function h(u,_,s,A){return function(x,v){var b=v.shape.slice();return b[0]>2&&b[1]>2&&A(v.pick(-1,-1).lo(1,1).hi(b[0]-2,b[1]-2),x.pick(-1,-1,0).lo(1,1).hi(b[0]-2,b[1]-2),x.pick(-1,-1,1).lo(1,1).hi(b[0]-2,b[1]-2)),b[1]>2&&(s(v.pick(0,-1).lo(1).hi(b[1]-2),x.pick(0,-1,1).lo(1).hi(b[1]-2)),_(x.pick(0,-1,0).lo(1).hi(b[1]-2))),b[1]>2&&(s(v.pick(b[0]-1,-1).lo(1).hi(b[1]-2),x.pick(b[0]-1,-1,1).lo(1).hi(b[1]-2)),_(x.pick(b[0]-1,-1,0).lo(1).hi(b[1]-2))),b[0]>2&&(s(v.pick(-1,0).lo(1).hi(b[0]-2),x.pick(-1,0,0).lo(1).hi(b[0]-2)),_(x.pick(-1,0,1).lo(1).hi(b[0]-2))),b[0]>2&&(s(v.pick(-1,b[1]-1).lo(1).hi(b[0]-2),x.pick(-1,b[1]-1,0).lo(1).hi(b[0]-2)),_(x.pick(-1,b[1]-1,1).lo(1).hi(b[0]-2))),x.set(0,0,0,0),x.set(0,0,1,0),x.set(b[0]-1,0,0,0),x.set(b[0]-1,0,1,0),x.set(0,b[1]-1,0,0),x.set(0,b[1]-1,1,0),x.set(b[0]-1,b[1]-1,0,0),x.set(b[0]-1,b[1]-1,1,0),x}}function m(u){var _=u.join(),b=i[_];if(b)return b;for(var s=u.length,A=[g,p],x=1;x<=s;++x)A.push(y(x));var v=h,b=v.apply(void 0,A);return i[_]=b,b}M.exports=function(_,s,A){if(Array.isArray(A)||(typeof A=="string"?A=e(s.dimension,A):A=e(s.dimension,"clamp")),s.size===0)return _;if(s.dimension===0)return _.set(0),_;var x=m(A);return x(_,s)}},{dup:65}],253:[function(c,M,T){function e(f,o){var i=Math.floor(o),g=o-i,p=0<=i&&i<f.shape[0],y=0<=i+1&&i+1<f.shape[0],h=p?+f.get(i):0,m=y?+f.get(i+1):0;return(1-g)*h+g*m}function a(f,o,i){var g=Math.floor(o),p=o-g,y=0<=g&&g<f.shape[0],h=0<=g+1&&g+1<f.shape[0],m=Math.floor(i),u=i-m,_=0<=m&&m<f.shape[1],s=0<=m+1&&m+1<f.shape[1],A=y&&_?f.get(g,m):0,x=y&&s?f.get(g,m+1):0,v=h&&_?f.get(g+1,m):0,b=h&&s?f.get(g+1,m+1):0;return(1-u)*((1-p)*A+p*v)+u*((1-p)*x+p*b)}function n(f,o,i,g){var p=Math.floor(o),y=o-p,h=0<=p&&p<f.shape[0],m=0<=p+1&&p+1<f.shape[0],u=Math.floor(i),_=i-u,s=0<=u&&u<f.shape[1],A=0<=u+1&&u+1<f.shape[1],x=Math.floor(g),v=g-x,b=0<=x&&x<f.shape[2],l=0<=x+1&&x+1<f.shape[2],L=h&&s&&b?f.get(p,u,x):0,S=h&&A&&b?f.get(p,u+1,x):0,k=m&&s&&b?f.get(p+1,u,x):0,P=m&&A&&b?f.get(p+1,u+1,x):0,z=h&&s&&l?f.get(p,u,x+1):0,I=h&&A&&l?f.get(p,u+1,x+1):0,D=m&&s&&l?f.get(p+1,u,x+1):0,R=m&&A&&l?f.get(p+1,u+1,x+1):0;return(1-v)*((1-_)*((1-y)*L+y*k)+_*((1-y)*S+y*P))+v*((1-_)*((1-y)*z+y*D)+_*((1-y)*I+y*R))}function r(f){var o=f.shape.length|0,i=new Array(o),g=new Array(o),p=new Array(o),y=new Array(o),h,m;for(h=0;h<o;++h)m=+arguments[h+1],i[h]=Math.floor(m),g[h]=m-i[h],p[h]=0<=i[h]&&i[h]<f.shape[h],y[h]=0<=i[h]+1&&i[h]+1<f.shape[h];var u=0,_,s,A;e:for(h=0;h<1<<o;++h){for(s=1,A=f.offset,_=0;_<o;++_)if(h&1<<_){if(!y[_])continue e;s*=g[_],A+=f.stride[_]*(i[_]+1)}else{if(!p[_])continue e;s*=1-g[_],A+=f.stride[_]*i[_]}u+=s*f.data[A]}return u}function t(f,o,i,g){switch(f.shape.length){case 0:return 0;case 1:return e(f,o);case 2:return a(f,o,i);case 3:return n(f,o,i,g);default:return r.apply(void 0,arguments)}}M.exports=t,M.exports.d1=e,M.exports.d2=a,M.exports.d3=n},{}],254:[function(c,M,T){var e={"float64,2,1,0":function(){return function(g,p,y,h,m){var u=g[0],_=g[1],s=g[2],A=y[0],x=y[1],v=y[2];h|=0;var b=0,l=0,L=0,S=v,k=x-s*v,P=A-_*x;for(L=0;L<u;++L){for(l=0;l<_;++l){for(b=0;b<s;++b)p[h]/=m,h+=S;h+=k}h+=P}}},"uint8,2,0,1,float64,2,1,0":function(){return function(g,p,y,h,m,u,_,s){var A=g[0],x=g[1],v=g[2],b=y[0],l=y[1],L=y[2],S=u[0],k=u[1],P=u[2];h|=0,_|=0;for(var z=h,I=_,D=g[0]|0;D>0;){D<64?(A=D,D=0):(A=64,D-=64);for(var R=g[1]|0;R>0;){R<64?(x=R,R=0):(x=64,R-=64),h=z+D*b+R*l,_=I+D*S+R*k;var B=0,F=0,V=0,G=L,J=b-v*L,j=l-A*b,Y=P,X=S-v*P,oe=k-A*S;for(V=0;V<x;++V){for(F=0;F<A;++F){for(B=0;B<v;++B)p[h]=m[_]*s,h+=G,_+=Y;h+=J,_+=X}h+=j,_+=oe}}}}},"float32,1,0,float32,1,0":function(){return function(g,p,y,h,m,u,_){var s=g[0],A=g[1],x=y[0],v=y[1],b=u[0],l=u[1];h|=0,_|=0;var L=0,S=0,k=v,P=x-A*v,z=l,I=b-A*l;for(S=0;S<s;++S){for(L=0;L<A;++L)p[h]=m[_],h+=k,_+=z;h+=P,_+=I}}},"float32,1,0,float32,0,1":function(){return function(g,p,y,h,m,u,_){var s=g[0],A=g[1],x=y[0],v=y[1],b=u[0],l=u[1];h|=0,_|=0;for(var L=h,S=_,k=g[1]|0;k>0;){k<64?(A=k,k=0):(A=64,k-=64);for(var P=g[0]|0;P>0;){P<64?(s=P,P=0):(s=64,P-=64),h=L+k*v+P*x,_=S+k*l+P*b;var z=0,I=0,D=v,R=x-A*v,B=l,F=b-A*l;for(I=0;I<s;++I){for(z=0;z<A;++z)p[h]=m[_],h+=D,_+=B;h+=R,_+=F}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(g,p,y,h,m,u,_){var s=g[0],A=g[1],x=g[2],v=y[0],b=y[1],l=y[2],L=u[0],S=u[1],k=u[2];h|=0,_|=0;for(var P=h,z=_,I=g[2]|0;I>0;){I<64?(x=I,I=0):(x=64,I-=64);for(var D=g[0]|0;D>0;){D<64?(s=D,D=0):(s=64,D-=64);for(var R=g[1]|0;R>0;){R<64?(A=R,R=0):(A=64,R-=64),h=P+I*l+D*v+R*b,_=z+I*k+D*L+R*S;var B=0,F=0,V=0,G=l,J=v-x*l,j=b-s*v,Y=k,X=L-x*k,oe=S-s*L;for(V=0;V<A;++V){for(F=0;F<s;++F){for(B=0;B<x;++B)p[h]=m[_],h+=G,_+=Y;h+=J,_+=X}h+=j,_+=oe}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(g,p,y,h,m,u,_){var s=g[0],A=g[1],x=g[2],v=y[0],b=y[1],l=y[2],L=u[0],S=u[1],k=u[2];h|=0,_|=0;var P=0,z=0,I=0,D=l,R=v-x*l,B=b-s*v,F=k,V=L-x*k,G=S-s*L;for(I=0;I<A;++I){for(z=0;z<s;++z){for(P=0;P<x;++P)p[h]=m[_],h+=D,_+=F;h+=R,_+=V}h+=B,_+=G}}}};function a(i,g){var p=g.join(","),y=e[p];return y()}var n=a,r={mul:function(i){var g={};return function(y,h,m){var u=y.dtype,_=y.order,s=h.dtype,A=h.order,x=m.dtype,v=m.order,b=[u,_.join(),s,A.join(),x,v.join()].join(),l=g[b];return l||(g[b]=l=i([u,_,s,A,x,v])),l(y.shape.slice(0),y.data,y.stride,y.offset|0,h.data,h.stride,h.offset|0,m.data,m.stride,m.offset|0)}},muls:function(i){var g={};return function(y,h,m){var u=y.dtype,_=y.order,s=h.dtype,A=h.order,x=[u,_.join(),s,A.join()].join(),v=g[x];return v||(g[x]=v=i([u,_,s,A])),v(y.shape.slice(0),y.data,y.stride,y.offset|0,h.data,h.stride,h.offset|0,m)}},mulseq:function(i){var g={};return function(y,h){var m=y.dtype,u=y.order,_=[m,u.join()].join(),s=g[_];return s||(g[_]=s=i([m,u])),s(y.shape.slice(0),y.data,y.stride,y.offset|0,h)}},div:function(i){var g={};return function(y,h,m){var u=y.dtype,_=y.order,s=h.dtype,A=h.order,x=m.dtype,v=m.order,b=[u,_.join(),s,A.join(),x,v.join()].join(),l=g[b];return l||(g[b]=l=i([u,_,s,A,x,v])),l(y.shape.slice(0),y.data,y.stride,y.offset|0,h.data,h.stride,h.offset|0,m.data,m.stride,m.offset|0)}},divs:function(i){var g={};return function(y,h,m){var u=y.dtype,_=y.order,s=h.dtype,A=h.order,x=[u,_.join(),s,A.join()].join(),v=g[x];return v||(g[x]=v=i([u,_,s,A])),v(y.shape.slice(0),y.data,y.stride,y.offset|0,h.data,h.stride,h.offset|0,m)}},divseq:function(i){var g={};return function(y,h){var m=y.dtype,u=y.order,_=[m,u.join()].join(),s=g[_];return s||(g[_]=s=i([m,u])),s(y.shape.slice(0),y.data,y.stride,y.offset|0,h)}},assign:function(i){var g={};return function(y,h){var m=y.dtype,u=y.order,_=h.dtype,s=h.order,A=[m,u.join(),_,s.join()].join(),x=g[A];return x||(g[A]=x=i([m,u,_,s])),x(y.shape.slice(0),y.data,y.stride,y.offset|0,h.data,h.stride,h.offset|0)}}};function t(i){var g=r[i.funcName];return g(n.bind(void 0,i))}function f(i){return t({funcName:i.funcName})}var o={mul:"*",div:"/"};(function(){for(var i in o)T[i]=f({funcName:i}),T[i+"s"]=f({funcName:i+"s"}),T[i+"seq"]=f({funcName:i+"seq"})})(),T.assign=f({funcName:"assign"})},{}],255:[function(c,M,T){var e=c("ndarray"),a=c("./doConvert.js");M.exports=function(r,t){for(var f=[],o=r,i=1;Array.isArray(o);)f.push(o.length),i*=o.length,o=o[0];return f.length===0?e():(t||(t=e(new Float64Array(i),f)),a(t,r),t)}},{"./doConvert.js":256,ndarray:259}],256:[function(c,M,T){function e(){return function(o,i,g,p,y){var h=o[0],m=o[1],u=o[2],_=g[0],s=g[1],A=g[2],x=[0,0,0];p|=0;var v=0,b=0,l=0,L=A,S=s-u*A,k=_-m*s;for(l=0;l<h;++l){for(b=0;b<m;++b){for(v=0;v<u;++v){{var P=y,z;for(z=0;z<x.length-1;++z)P=P[x[z]];i[p]=P[x[x.length-1]]}p+=L,++x[2]}p+=S,x[2]-=u,++x[1]}p+=k,x[1]-=m,++x[0]}}}function a(){return e()}var n=a;function r(o){var i={};return function(p,y){var h=p.dtype,m=p.order,u=[h,m.join()].join(),_=i[u];return _||(i[u]=_=o([h,m])),_(p.shape.slice(0),p.data,p.stride,p.offset|0,y)}}function t(o){return r(n.bind(void 0,o))}function f(o){return t({funcName:o.funcName})}M.exports=f({funcName:"convert"})},{}],257:[function(c,M,T){var e=c("typedarray-pool");function a(g){switch(g){case"uint32":return[e.mallocUint32,e.freeUint32];default:return null}}var n={"uint32,1,0":function(g,p){return function(h,m,u,_,s,A,x,v,b,l,L){var S,k,P,z=h*s+_,I,D=g(v),R,B,F,V;for(S=h+1;S<=m;++S){for(k=S,z+=s,P=z,R=0,B=z,I=0;I<v;++I)D[R++]=u[B],B+=b;e:for(;k-- >h;){R=0,B=P-s;t:for(I=0;I<v;++I){if(F=u[B],V=D[R],F<V)break e;if(F>V)break t;B+=l,R+=L}for(R=P,B=P-s,I=0;I<v;++I)u[R]=u[B],R+=b,B+=b;P-=s}for(R=P,B=0,I=0;I<v;++I)u[R]=D[B++],R+=b}p(D)}}};function r(g,p){var y=a(p),h=[p,g].join(","),m=n[h];return y?m(y[0],y[1]):m()}var t={"uint32,1,0":function(g,p,y){return function h(m,u,_,s,A,x,v,b,l,L,S){var k=(u-m+1)/6|0,P=m+k,z=u-k,I=m+u>>1,D=I-k,R=I+k,B=P,F=D,V=I,G=R,J=z,j=m+1,Y=u-1,X=!0,oe,se,ie,N,U,q,Q,W,Z,ee=0,te=0,ae=0,le,ye,fe,pe,ge,Ae,we,De,Be,Ve,xe,Le,He,Je,Oe,Pe,Ue=b,vt=p(Ue),Lt=p(Ue);ye=A*B,fe=A*F,Pe=s;e:for(le=0;le<b;++le){if(Q=ye+Pe,W=fe+Pe,ae=_[Q]-_[W],ae>0){se=B,B=F,F=se;break e}if(ae<0)break e;Pe+=L}ye=A*G,fe=A*J,Pe=s;e:for(le=0;le<b;++le){if(Q=ye+Pe,W=fe+Pe,ae=_[Q]-_[W],ae>0){se=G,G=J,J=se;break e}if(ae<0)break e;Pe+=L}ye=A*B,fe=A*V,Pe=s;e:for(le=0;le<b;++le){if(Q=ye+Pe,W=fe+Pe,ae=_[Q]-_[W],ae>0){se=B,B=V,V=se;break e}if(ae<0)break e;Pe+=L}ye=A*F,fe=A*V,Pe=s;e:for(le=0;le<b;++le){if(Q=ye+Pe,W=fe+Pe,ae=_[Q]-_[W],ae>0){se=F,F=V,V=se;break e}if(ae<0)break e;Pe+=L}ye=A*B,fe=A*G,Pe=s;e:for(le=0;le<b;++le){if(Q=ye+Pe,W=fe+Pe,ae=_[Q]-_[W],ae>0){se=B,B=G,G=se;break e}if(ae<0)break e;Pe+=L}ye=A*V,fe=A*G,Pe=s;e:for(le=0;le<b;++le){if(Q=ye+Pe,W=fe+Pe,ae=_[Q]-_[W],ae>0){se=V,V=G,G=se;break e}if(ae<0)break e;Pe+=L}ye=A*F,fe=A*J,Pe=s;e:for(le=0;le<b;++le){if(Q=ye+Pe,W=fe+Pe,ae=_[Q]-_[W],ae>0){se=F,F=J,J=se;break e}if(ae<0)break e;Pe+=L}ye=A*F,fe=A*V,Pe=s;e:for(le=0;le<b;++le){if(Q=ye+Pe,W=fe+Pe,ae=_[Q]-_[W],ae>0){se=F,F=V,V=se;break e}if(ae<0)break e;Pe+=L}ye=A*G,fe=A*J,Pe=s;e:for(le=0;le<b;++le){if(Q=ye+Pe,W=fe+Pe,ae=_[Q]-_[W],ae>0){se=G,G=J,J=se;break e}if(ae<0)break e;Pe+=L}for(ye=A*B,fe=A*F,pe=A*V,ge=A*G,Ae=A*J,we=A*P,De=A*I,Be=A*z,Oe=0,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,Z=pe+Pe,Ve=ge+Pe,xe=Ae+Pe,Le=we+Pe,He=De+Pe,Je=Be+Pe,vt[Oe]=_[W],Lt[Oe]=_[Ve],X=X&&vt[Oe]===Lt[Oe],ie=_[Q],N=_[Z],U=_[xe],_[Le]=ie,_[He]=N,_[Je]=U,++Oe,Pe+=l;for(ye=A*D,fe=A*m,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,_[Q]=_[W],Pe+=l;for(ye=A*R,fe=A*u,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,_[Q]=_[W],Pe+=l;if(X)for(q=j;q<=Y;++q){Q=s+q*A,Oe=0;e:for(le=0;le<b;++le){if(ae=_[Q]-vt[Oe],ae!==0)break e;Oe+=S,Q+=L}if(ae!==0)if(ae<0){if(q!==j)for(ye=A*q,fe=A*j,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,oe=_[Q],_[Q]=_[W],_[W]=oe,Pe+=l;++j}else for(;;){Q=s+Y*A,Oe=0;e:for(le=0;le<b;++le){if(ae=_[Q]-vt[Oe],ae!==0)break e;Oe+=S,Q+=L}if(ae>0)Y--;else if(ae<0){for(ye=A*q,fe=A*j,pe=A*Y,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,Z=pe+Pe,oe=_[Q],_[Q]=_[W],_[W]=_[Z],_[Z]=oe,Pe+=l;++j,--Y;break}else{for(ye=A*q,fe=A*Y,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,oe=_[Q],_[Q]=_[W],_[W]=oe,Pe+=l;--Y;break}}}else for(q=j;q<=Y;++q){Q=s+q*A,Oe=0;e:for(le=0;le<b;++le){if(ee=_[Q]-vt[Oe],ee!==0)break e;Oe+=S,Q+=L}if(ee<0){if(q!==j)for(ye=A*q,fe=A*j,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,oe=_[Q],_[Q]=_[W],_[W]=oe,Pe+=l;++j}else{Q=s+q*A,Oe=0;e:for(le=0;le<b;++le){if(te=_[Q]-Lt[Oe],te!==0)break e;Oe+=S,Q+=L}if(te>0)for(;;){Q=s+Y*A,Oe=0;e:for(le=0;le<b;++le){if(ae=_[Q]-Lt[Oe],ae!==0)break e;Oe+=S,Q+=L}if(ae>0){if(--Y<q)break;continue}else{Q=s+Y*A,Oe=0;e:for(le=0;le<b;++le){if(ae=_[Q]-vt[Oe],ae!==0)break e;Oe+=S,Q+=L}if(ae<0){for(ye=A*q,fe=A*j,pe=A*Y,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,Z=pe+Pe,oe=_[Q],_[Q]=_[W],_[W]=_[Z],_[Z]=oe,Pe+=l;++j,--Y}else{for(ye=A*q,fe=A*Y,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,oe=_[Q],_[Q]=_[W],_[W]=oe,Pe+=l;--Y}break}}}}for(ye=A*m,fe=A*(j-1),Oe=0,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,_[Q]=_[W],_[W]=vt[Oe],++Oe,Pe+=l;for(ye=A*u,fe=A*(Y+1),Oe=0,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,_[Q]=_[W],_[W]=Lt[Oe],++Oe,Pe+=l;if(j-2-m<=32?g(m,j-2,_,s,A,x,v,b,l,L,S):h(m,j-2,_,s,A,x,v,b,l,L,S),u-(Y+2)<=32?g(Y+2,u,_,s,A,x,v,b,l,L,S):h(Y+2,u,_,s,A,x,v,b,l,L,S),X){y(vt),y(Lt);return}if(j<P&&Y>z){e:for(;;){for(Q=s+j*A,Oe=0,Pe=s,le=0;le<b;++le){if(_[Q]!==vt[Oe])break e;++Oe,Q+=l}++j}e:for(;;){for(Q=s+Y*A,Oe=0,Pe=s,le=0;le<b;++le){if(_[Q]!==Lt[Oe])break e;++Oe,Q+=l}--Y}for(q=j;q<=Y;++q){Q=s+q*A,Oe=0;e:for(le=0;le<b;++le){if(ee=_[Q]-vt[Oe],ee!==0)break e;Oe+=S,Q+=L}if(ee===0){if(q!==j)for(ye=A*q,fe=A*j,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,oe=_[Q],_[Q]=_[W],_[W]=oe,Pe+=l;++j}else{Q=s+q*A,Oe=0;e:for(le=0;le<b;++le){if(te=_[Q]-Lt[Oe],te!==0)break e;Oe+=S,Q+=L}if(te===0)for(;;){Q=s+Y*A,Oe=0;e:for(le=0;le<b;++le){if(ae=_[Q]-Lt[Oe],ae!==0)break e;Oe+=S,Q+=L}if(ae===0){if(--Y<q)break;continue}else{Q=s+Y*A,Oe=0;e:for(le=0;le<b;++le){if(ae=_[Q]-vt[Oe],ae!==0)break e;Oe+=S,Q+=L}if(ae<0){for(ye=A*q,fe=A*j,pe=A*Y,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,Z=pe+Pe,oe=_[Q],_[Q]=_[W],_[W]=_[Z],_[Z]=oe,Pe+=l;++j,--Y}else{for(ye=A*q,fe=A*Y,Pe=s,le=0;le<b;++le)Q=ye+Pe,W=fe+Pe,oe=_[Q],_[Q]=_[W],_[W]=oe,Pe+=l;--Y}break}}}}}y(vt),y(Lt),Y-j<=32?g(j,Y,_,s,A,x,v,b,l,L,S):h(j,Y,_,s,A,x,v,b,l,L,S)}}};function f(g,p,y){var h=a(p),m=[p,g].join(","),u=t[m];return g.length>1&&h?u(y,h[0],h[1]):u(y)}var o={"uint32,1,0":function(g,p){return function(y){var h=y.data,m=y.offset|0,u=y.shape,_=y.stride,s=_[0]|0,A=u[0]|0,x=_[1]|0,v=u[1]|0,b=x,l=x,L=1;A<=32?g(0,A-1,h,m,s,x,A,v,b,l,L):p(0,A-1,h,m,s,x,A,v,b,l,L)}}};function i(g,p){var y=[p,g].join(","),h=o[y],m=r(g,p),u=f(g,p,m);return h(m,u)}M.exports=i},{"typedarray-pool":308}],258:[function(c,M,T){var e=c("./lib/compile_sort.js"),a={};function n(r){var t=r.order,f=r.dtype,o=[t,f],i=o.join(":"),g=a[i];return g||(a[i]=g=e(t,f)),g(r),r}M.exports=n},{"./lib/compile_sort.js":257}],259:[function(c,M,T){var e=c("is-buffer"),a=typeof Float64Array!="undefined";function n(p,y){return p[0]-y[0]}function r(){var p=this.stride,y=new Array(p.length),h;for(h=0;h<y.length;++h)y[h]=[Math.abs(p[h]),h];y.sort(n);var m=new Array(y.length);for(h=0;h<m.length;++h)m[h]=y[h][1];return m}var t={T:function(p){function y(m){this.data=m}var h=y.prototype;return h.dtype=p,h.index=function(){return-1},h.size=0,h.dimension=-1,h.shape=h.stride=h.order=[],h.lo=h.hi=h.transpose=h.step=function(){return new y(this.data)},h.get=h.set=function(){},h.pick=function(){return null},function(u){return new y(u)}},0:function(p,y){function h(u,_){this.data=u,this.offset=_}var m=h.prototype;return m.dtype=p,m.index=function(){return this.offset},m.dimension=0,m.size=1,m.shape=m.stride=m.order=[],m.lo=m.hi=m.transpose=m.step=function(){return new h(this.data,this.offset)},m.pick=function(){return y(this.data)},m.valueOf=m.get=function(){return p==="generic"?this.data.get(this.offset):this.data[this.offset]},m.set=function(_){return p==="generic"?this.data.set(this.offset,_):this.data[this.offset]=_},function(_,s,A,x){return new h(_,x)}},1:function(p,y,h){function m(_,s,A,x){this.data=_,this.shape=[s],this.stride=[A],this.offset=x|0}var u=m.prototype;return u.dtype=p,u.dimension=1,Object.defineProperty(u,"size",{get:function(){return this.shape[0]}}),u.order=[0],u.set=function(s,A){return p==="generic"?this.data.set(this.offset+this.stride[0]*s,A):this.data[this.offset+this.stride[0]*s]=A},u.get=function(s){return p==="generic"?this.data.get(this.offset+this.stride[0]*s):this.data[this.offset+this.stride[0]*s]},u.index=function(s){return this.offset+this.stride[0]*s},u.hi=function(s){return new m(this.data,typeof s!="number"||s<0?this.shape[0]:s|0,this.stride[0],this.offset)},u.lo=function(s){var A=this.offset,x=0,v=this.shape[0],b=this.stride[0];return typeof s=="number"&&s>=0&&(x=s|0,A+=b*x,v-=x),new m(this.data,v,b,A)},u.step=function(s){var A=this.shape[0],x=this.stride[0],v=this.offset,b=0,l=Math.ceil;return typeof s=="number"&&(b=s|0,b<0?(v+=x*(A-1),A=l(-A/b)):A=l(A/b),x*=b),new m(this.data,A,x,v)},u.transpose=function(s){s=s===void 0?0:s|0;var A=this.shape,x=this.stride;return new m(this.data,A[s],x[s],this.offset)},u.pick=function(s){var A=[],x=[],v=this.offset;typeof s=="number"&&s>=0?v=v+this.stride[0]*s|0:(A.push(this.shape[0]),x.push(this.stride[0]));var b=y[A.length+1];return b(this.data,A,x,v)},function(s,A,x,v){return new m(s,A[0],x[0],v)}},2:function(p,y,h){function m(_,s,A,x,v,b){this.data=_,this.shape=[s,A],this.stride=[x,v],this.offset=b|0}var u=m.prototype;return u.dtype=p,u.dimension=2,Object.defineProperty(u,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(u,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),u.set=function(s,A,x){return p==="generic"?this.data.set(this.offset+this.stride[0]*s+this.stride[1]*A,x):this.data[this.offset+this.stride[0]*s+this.stride[1]*A]=x},u.get=function(s,A){return p==="generic"?this.data.get(this.offset+this.stride[0]*s+this.stride[1]*A):this.data[this.offset+this.stride[0]*s+this.stride[1]*A]},u.index=function(s,A){return this.offset+this.stride[0]*s+this.stride[1]*A},u.hi=function(s,A){return new m(this.data,typeof s!="number"||s<0?this.shape[0]:s|0,typeof A!="number"||A<0?this.shape[1]:A|0,this.stride[0],this.stride[1],this.offset)},u.lo=function(s,A){var x=this.offset,v=0,b=this.shape[0],l=this.shape[1],L=this.stride[0],S=this.stride[1];return typeof s=="number"&&s>=0&&(v=s|0,x+=L*v,b-=v),typeof A=="number"&&A>=0&&(v=A|0,x+=S*v,l-=v),new m(this.data,b,l,L,S,x)},u.step=function(s,A){var x=this.shape[0],v=this.shape[1],b=this.stride[0],l=this.stride[1],L=this.offset,S=0,k=Math.ceil;return typeof s=="number"&&(S=s|0,S<0?(L+=b*(x-1),x=k(-x/S)):x=k(x/S),b*=S),typeof A=="number"&&(S=A|0,S<0?(L+=l*(v-1),v=k(-v/S)):v=k(v/S),l*=S),new m(this.data,x,v,b,l,L)},u.transpose=function(s,A){s=s===void 0?0:s|0,A=A===void 0?1:A|0;var x=this.shape,v=this.stride;return new m(this.data,x[s],x[A],v[s],v[A],this.offset)},u.pick=function(s,A){var x=[],v=[],b=this.offset;typeof s=="number"&&s>=0?b=b+this.stride[0]*s|0:(x.push(this.shape[0]),v.push(this.stride[0])),typeof A=="number"&&A>=0?b=b+this.stride[1]*A|0:(x.push(this.shape[1]),v.push(this.stride[1]));var l=y[x.length+1];return l(this.data,x,v,b)},function(s,A,x,v){return new m(s,A[0],A[1],x[0],x[1],v)}},3:function(p,y,h){function m(_,s,A,x,v,b,l,L){this.data=_,this.shape=[s,A,x],this.stride=[v,b,l],this.offset=L|0}var u=m.prototype;return u.dtype=p,u.dimension=3,Object.defineProperty(u,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(u,"order",{get:function(){var s=Math.abs(this.stride[0]),A=Math.abs(this.stride[1]),x=Math.abs(this.stride[2]);return s>A?A>x?[2,1,0]:s>x?[1,2,0]:[1,0,2]:s>x?[2,0,1]:x>A?[0,1,2]:[0,2,1]}}),u.set=function(s,A,x,v){return p==="generic"?this.data.set(this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*x,v):this.data[this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*x]=v},u.get=function(s,A,x){return p==="generic"?this.data.get(this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*x):this.data[this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*x]},u.index=function(s,A,x){return this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*x},u.hi=function(s,A,x){return new m(this.data,typeof s!="number"||s<0?this.shape[0]:s|0,typeof A!="number"||A<0?this.shape[1]:A|0,typeof x!="number"||x<0?this.shape[2]:x|0,this.stride[0],this.stride[1],this.stride[2],this.offset)},u.lo=function(s,A,x){var v=this.offset,b=0,l=this.shape[0],L=this.shape[1],S=this.shape[2],k=this.stride[0],P=this.stride[1],z=this.stride[2];return typeof s=="number"&&s>=0&&(b=s|0,v+=k*b,l-=b),typeof A=="number"&&A>=0&&(b=A|0,v+=P*b,L-=b),typeof x=="number"&&x>=0&&(b=x|0,v+=z*b,S-=b),new m(this.data,l,L,S,k,P,z,v)},u.step=function(s,A,x){var v=this.shape[0],b=this.shape[1],l=this.shape[2],L=this.stride[0],S=this.stride[1],k=this.stride[2],P=this.offset,z=0,I=Math.ceil;return typeof s=="number"&&(z=s|0,z<0?(P+=L*(v-1),v=I(-v/z)):v=I(v/z),L*=z),typeof A=="number"&&(z=A|0,z<0?(P+=S*(b-1),b=I(-b/z)):b=I(b/z),S*=z),typeof x=="number"&&(z=x|0,z<0?(P+=k*(l-1),l=I(-l/z)):l=I(l/z),k*=z),new m(this.data,v,b,l,L,S,k,P)},u.transpose=function(s,A,x){s=s===void 0?0:s|0,A=A===void 0?1:A|0,x=x===void 0?2:x|0;var v=this.shape,b=this.stride;return new m(this.data,v[s],v[A],v[x],b[s],b[A],b[x],this.offset)},u.pick=function(s,A,x){var v=[],b=[],l=this.offset;typeof s=="number"&&s>=0?l=l+this.stride[0]*s|0:(v.push(this.shape[0]),b.push(this.stride[0])),typeof A=="number"&&A>=0?l=l+this.stride[1]*A|0:(v.push(this.shape[1]),b.push(this.stride[1])),typeof x=="number"&&x>=0?l=l+this.stride[2]*x|0:(v.push(this.shape[2]),b.push(this.stride[2]));var L=y[v.length+1];return L(this.data,v,b,l)},function(s,A,x,v){return new m(s,A[0],A[1],A[2],x[0],x[1],x[2],v)}},4:function(p,y,h){function m(_,s,A,x,v,b,l,L,S,k){this.data=_,this.shape=[s,A,x,v],this.stride=[b,l,L,S],this.offset=k|0}var u=m.prototype;return u.dtype=p,u.dimension=4,Object.defineProperty(u,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(u,"order",{get:h}),u.set=function(s,A,x,v,b){return p==="generic"?this.data.set(this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*x+this.stride[3]*v,b):this.data[this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*x+this.stride[3]*v]=b},u.get=function(s,A,x,v){return p==="generic"?this.data.get(this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*x+this.stride[3]*v):this.data[this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*x+this.stride[3]*v]},u.index=function(s,A,x,v){return this.offset+this.stride[0]*s+this.stride[1]*A+this.stride[2]*x+this.stride[3]*v},u.hi=function(s,A,x,v){return new m(this.data,typeof s!="number"||s<0?this.shape[0]:s|0,typeof A!="number"||A<0?this.shape[1]:A|0,typeof x!="number"||x<0?this.shape[2]:x|0,typeof v!="number"||v<0?this.shape[3]:v|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},u.lo=function(s,A,x,v){var b=this.offset,l=0,L=this.shape[0],S=this.shape[1],k=this.shape[2],P=this.shape[3],z=this.stride[0],I=this.stride[1],D=this.stride[2],R=this.stride[3];return typeof s=="number"&&s>=0&&(l=s|0,b+=z*l,L-=l),typeof A=="number"&&A>=0&&(l=A|0,b+=I*l,S-=l),typeof x=="number"&&x>=0&&(l=x|0,b+=D*l,k-=l),typeof v=="number"&&v>=0&&(l=v|0,b+=R*l,P-=l),new m(this.data,L,S,k,P,z,I,D,R,b)},u.step=function(s,A,x,v){var b=this.shape[0],l=this.shape[1],L=this.shape[2],S=this.shape[3],k=this.stride[0],P=this.stride[1],z=this.stride[2],I=this.stride[3],D=this.offset,R=0,B=Math.ceil;return typeof s=="number"&&(R=s|0,R<0?(D+=k*(b-1),b=B(-b/R)):b=B(b/R),k*=R),typeof A=="number"&&(R=A|0,R<0?(D+=P*(l-1),l=B(-l/R)):l=B(l/R),P*=R),typeof x=="number"&&(R=x|0,R<0?(D+=z*(L-1),L=B(-L/R)):L=B(L/R),z*=R),typeof v=="number"&&(R=v|0,R<0?(D+=I*(S-1),S=B(-S/R)):S=B(S/R),I*=R),new m(this.data,b,l,L,S,k,P,z,I,D)},u.transpose=function(s,A,x,v){s=s===void 0?0:s|0,A=A===void 0?1:A|0,x=x===void 0?2:x|0,v=v===void 0?3:v|0;var b=this.shape,l=this.stride;return new m(this.data,b[s],b[A],b[x],b[v],l[s],l[A],l[x],l[v],this.offset)},u.pick=function(s,A,x,v){var b=[],l=[],L=this.offset;typeof s=="number"&&s>=0?L=L+this.stride[0]*s|0:(b.push(this.shape[0]),l.push(this.stride[0])),typeof A=="number"&&A>=0?L=L+this.stride[1]*A|0:(b.push(this.shape[1]),l.push(this.stride[1])),typeof x=="number"&&x>=0?L=L+this.stride[2]*x|0:(b.push(this.shape[2]),l.push(this.stride[2])),typeof v=="number"&&v>=0?L=L+this.stride[3]*v|0:(b.push(this.shape[3]),l.push(this.stride[3]));var S=y[b.length+1];return S(this.data,b,l,L)},function(s,A,x,v){return new m(s,A[0],A[1],A[2],A[3],x[0],x[1],x[2],x[3],v)}},5:function(y,h,m){function u(s,A,x,v,b,l,L,S,k,P,z,I){this.data=s,this.shape=[A,x,v,b,l],this.stride=[L,S,k,P,z],this.offset=I|0}var _=u.prototype;return _.dtype=y,_.dimension=5,Object.defineProperty(_,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(_,"order",{get:m}),_.set=function(A,x,v,b,l,L){return y==="generic"?this.data.set(this.offset+this.stride[0]*A+this.stride[1]*x+this.stride[2]*v+this.stride[3]*b+this.stride[4]*l,L):this.data[this.offset+this.stride[0]*A+this.stride[1]*x+this.stride[2]*v+this.stride[3]*b+this.stride[4]*l]=L},_.get=function(A,x,v,b,l){return y==="generic"?this.data.get(this.offset+this.stride[0]*A+this.stride[1]*x+this.stride[2]*v+this.stride[3]*b+this.stride[4]*l):this.data[this.offset+this.stride[0]*A+this.stride[1]*x+this.stride[2]*v+this.stride[3]*b+this.stride[4]*l]},_.index=function(A,x,v,b,l){return this.offset+this.stride[0]*A+this.stride[1]*x+this.stride[2]*v+this.stride[3]*b+this.stride[4]*l},_.hi=function(A,x,v,b,l){return new u(this.data,typeof A!="number"||A<0?this.shape[0]:A|0,typeof x!="number"||x<0?this.shape[1]:x|0,typeof v!="number"||v<0?this.shape[2]:v|0,typeof b!="number"||b<0?this.shape[3]:b|0,typeof l!="number"||l<0?this.shape[4]:l|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},_.lo=function(A,x,v,b,l){var L=this.offset,S=0,k=this.shape[0],P=this.shape[1],z=this.shape[2],I=this.shape[3],D=this.shape[4],R=this.stride[0],B=this.stride[1],F=this.stride[2],V=this.stride[3],G=this.stride[4];return typeof A=="number"&&A>=0&&(S=A|0,L+=R*S,k-=S),typeof x=="number"&&x>=0&&(S=x|0,L+=B*S,P-=S),typeof v=="number"&&v>=0&&(S=v|0,L+=F*S,z-=S),typeof b=="number"&&b>=0&&(S=b|0,L+=V*S,I-=S),typeof l=="number"&&l>=0&&(S=l|0,L+=G*S,D-=S),new u(this.data,k,P,z,I,D,R,B,F,V,G,L)},_.step=function(A,x,v,b,l){var L=this.shape[0],S=this.shape[1],k=this.shape[2],P=this.shape[3],z=this.shape[4],I=this.stride[0],D=this.stride[1],R=this.stride[2],B=this.stride[3],F=this.stride[4],V=this.offset,G=0,J=Math.ceil;return typeof A=="number"&&(G=A|0,G<0?(V+=I*(L-1),L=J(-L/G)):L=J(L/G),I*=G),typeof x=="number"&&(G=x|0,G<0?(V+=D*(S-1),S=J(-S/G)):S=J(S/G),D*=G),typeof v=="number"&&(G=v|0,G<0?(V+=R*(k-1),k=J(-k/G)):k=J(k/G),R*=G),typeof b=="number"&&(G=b|0,G<0?(V+=B*(P-1),P=J(-P/G)):P=J(P/G),B*=G),typeof l=="number"&&(G=l|0,G<0?(V+=F*(z-1),z=J(-z/G)):z=J(z/G),F*=G),new u(this.data,L,S,k,P,z,I,D,R,B,F,V)},_.transpose=function(A,x,v,b,l){A=A===void 0?0:A|0,x=x===void 0?1:x|0,v=v===void 0?2:v|0,b=b===void 0?3:b|0,l=l===void 0?4:l|0;var L=this.shape,S=this.stride;return new u(this.data,L[A],L[x],L[v],L[b],L[l],S[A],S[x],S[v],S[b],S[l],this.offset)},_.pick=function(A,x,v,b,l){var L=[],S=[],k=this.offset;typeof A=="number"&&A>=0?k=k+this.stride[0]*A|0:(L.push(this.shape[0]),S.push(this.stride[0])),typeof x=="number"&&x>=0?k=k+this.stride[1]*x|0:(L.push(this.shape[1]),S.push(this.stride[1])),typeof v=="number"&&v>=0?k=k+this.stride[2]*v|0:(L.push(this.shape[2]),S.push(this.stride[2])),typeof b=="number"&&b>=0?k=k+this.stride[3]*b|0:(L.push(this.shape[3]),S.push(this.stride[3])),typeof l=="number"&&l>=0?k=k+this.stride[4]*l|0:(L.push(this.shape[4]),S.push(this.stride[4]));var P=h[L.length+1];return P(this.data,L,S,k)},function(A,x,v,b){return new u(A,x[0],x[1],x[2],x[3],x[4],v[0],v[1],v[2],v[3],v[4],b)}}};function f(p,y){var h=y===-1?"T":String(y),m=t[h];return y===-1?m(p):y===0?m(p,i[p][0]):m(p,i[p],r)}function o(p){if(e(p))return"buffer";if(a)switch(Object.prototype.toString.call(p)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(p)?"array":"generic"}var i={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};function g(p,y,h,m){if(p===void 0){var v=i.array[0];return v([])}else typeof p=="number"&&(p=[p]);y===void 0&&(y=[p.length]);var u=y.length;if(h===void 0){h=new Array(u);for(var _=u-1,s=1;_>=0;--_)h[_]=s,s*=y[_]}if(m===void 0){m=0;for(var _=0;_<u;++_)h[_]<0&&(m-=(y[_]-1)*h[_])}for(var A=o(p),x=i[A];x.length<=u+1;)x.push(f(A,x.length-1));var v=x[u+1];return v(p,y,h,m)}M.exports=g},{"is-buffer":237}],260:[function(c,M,T){var e=c("double-bits"),a=Math.pow(2,-1074),n=-1>>>0;M.exports=r;function r(t,f){if(isNaN(t)||isNaN(f))return NaN;if(t===f)return t;if(t===0)return f<0?-a:a;var o=e.hi(t),i=e.lo(t);return f>t==t>0?i===n?(o+=1,i=0):i+=1:i===0?(i=n,o-=1):i-=1,e.pack(i,o)}},{"double-bits":64}],261:[function(c,M,T){var e=1e-6,a=1e-6;T.vertexNormals=function(n,r,t){for(var f=r.length,o=new Array(f),i=t===void 0?e:t,g=0;g<f;++g)o[g]=[0,0,0];for(var g=0;g<n.length;++g)for(var p=n[g],y=0,h=p[p.length-1],m=p[0],u=0;u<p.length;++u){y=h,h=m,m=p[(u+1)%p.length];for(var _=r[y],s=r[h],A=r[m],x=new Array(3),v=0,b=new Array(3),l=0,L=0;L<3;++L)x[L]=_[L]-s[L],v+=x[L]*x[L],b[L]=A[L]-s[L],l+=b[L]*b[L];if(v*l>i)for(var S=o[h],k=1/Math.sqrt(v*l),L=0;L<3;++L){var P=(L+1)%3,z=(L+2)%3;S[L]+=k*(b[P]*x[z]-b[z]*x[P])}}for(var g=0;g<f;++g){for(var S=o[g],I=0,L=0;L<3;++L)I+=S[L]*S[L];if(I>i)for(var k=1/Math.sqrt(I),L=0;L<3;++L)S[L]*=k;else for(var L=0;L<3;++L)S[L]=0}return o},T.faceNormals=function(n,r,t){for(var f=n.length,o=new Array(f),i=t===void 0?a:t,g=0;g<f;++g){for(var p=n[g],y=new Array(3),h=0;h<3;++h)y[h]=r[p[h]];for(var m=new Array(3),u=new Array(3),h=0;h<3;++h)m[h]=y[1][h]-y[0][h],u[h]=y[2][h]-y[0][h];for(var _=new Array(3),s=0,h=0;h<3;++h){var A=(h+1)%3,x=(h+2)%3;_[h]=m[A]*u[x]-m[x]*u[A],s+=_[h]*_[h]}s>i?s=1/Math.sqrt(s):s=0;for(var h=0;h<3;++h)_[h]*=s;o[g]=_}return o}},{}],262:[function(c,M,T){M.exports=e;function e(a,n,r,t,f,o,i,g,p,y){var h=n+o+y;if(m>0){var m=Math.sqrt(h+1);a[0]=.5*(i-p)/m,a[1]=.5*(g-t)/m,a[2]=.5*(r-o)/m,a[3]=.5*m}else{var u=Math.max(n,o,y),m=Math.sqrt(2*u-h+1);n>=u?(a[0]=.5*m,a[1]=.5*(f+r)/m,a[2]=.5*(g+t)/m,a[3]=.5*(i-p)/m):o>=u?(a[0]=.5*(r+f)/m,a[1]=.5*m,a[2]=.5*(p+i)/m,a[3]=.5*(g-t)/m):(a[0]=.5*(t+g)/m,a[1]=.5*(i+p)/m,a[2]=.5*m,a[3]=.5*(r-f)/m)}return a}},{}],263:[function(c,M,T){M.exports=y;var e=c("filtered-vector"),a=c("gl-mat4/lookAt"),n=c("gl-mat4/fromQuat"),r=c("gl-mat4/invert"),t=c("./lib/quatFromFrame");function f(h,m,u){return Math.sqrt(Math.pow(h,2)+Math.pow(m,2)+Math.pow(u,2))}function o(h,m,u,_){return Math.sqrt(Math.pow(h,2)+Math.pow(m,2)+Math.pow(u,2)+Math.pow(_,2))}function i(h,m){var u=m[0],_=m[1],s=m[2],A=m[3],x=o(u,_,s,A);x>1e-6?(h[0]=u/x,h[1]=_/x,h[2]=s/x,h[3]=A/x):(h[0]=h[1]=h[2]=0,h[3]=1)}function g(h,m,u){this.radius=e([u]),this.center=e(m),this.rotation=e(h),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var p=g.prototype;p.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},p.recalcMatrix=function(h){this.radius.curve(h),this.center.curve(h),this.rotation.curve(h);var m=this.computedRotation;i(m,m);var u=this.computedMatrix;n(u,m);var _=this.computedCenter,s=this.computedEye,A=this.computedUp,x=Math.exp(this.computedRadius[0]);s[0]=_[0]+x*u[2],s[1]=_[1]+x*u[6],s[2]=_[2]+x*u[10],A[0]=u[1],A[1]=u[5],A[2]=u[9];for(var v=0;v<3;++v){for(var b=0,l=0;l<3;++l)b+=u[v+4*l]*s[l];u[12+v]=-b}},p.getMatrix=function(h,m){this.recalcMatrix(h);var u=this.computedMatrix;if(m){for(var _=0;_<16;++_)m[_]=u[_];return m}return u},p.idle=function(h){this.center.idle(h),this.radius.idle(h),this.rotation.idle(h)},p.flush=function(h){this.center.flush(h),this.radius.flush(h),this.rotation.flush(h)},p.pan=function(h,m,u,_){m=m||0,u=u||0,_=_||0,this.recalcMatrix(h);var s=this.computedMatrix,A=s[1],x=s[5],v=s[9],b=f(A,x,v);A/=b,x/=b,v/=b;var l=s[0],L=s[4],S=s[8],k=l*A+L*x+S*v;l-=A*k,L-=x*k,S-=v*k;var P=f(l,L,S);l/=P,L/=P,S/=P,s[2],s[6],s[10];var z=l*m+A*u,I=L*m+x*u,D=S*m+v*u;this.center.move(h,z,I,D);var R=Math.exp(this.computedRadius[0]);R=Math.max(1e-4,R+_),this.radius.set(h,Math.log(R))},p.rotate=function(h,m,u,_){this.recalcMatrix(h),m=m||0,u=u||0;var s=this.computedMatrix,A=s[0],x=s[4],v=s[8],b=s[1],l=s[5],L=s[9],S=s[2],k=s[6],P=s[10],z=m*A+u*b,I=m*x+u*l,D=m*v+u*L,R=-(k*D-P*I),B=-(P*z-S*D),F=-(S*I-k*z),V=Math.sqrt(Math.max(0,1-Math.pow(R,2)-Math.pow(B,2)-Math.pow(F,2))),G=o(R,B,F,V);G>1e-6?(R/=G,B/=G,F/=G,V/=G):(R=B=F=0,V=1);var J=this.computedRotation,j=J[0],Y=J[1],X=J[2],oe=J[3],se=j*V+oe*R+Y*F-X*B,ie=Y*V+oe*B+X*R-j*F,N=X*V+oe*F+j*B-Y*R,U=oe*V-j*R-Y*B-X*F;if(_){R=S,B=k,F=P;var q=Math.sin(_)/f(R,B,F);R*=q,B*=q,F*=q,V=Math.cos(m),se=se*V+U*R+ie*F-N*B,ie=ie*V+U*B+N*R-se*F,N=N*V+U*F+se*B-ie*R,U=U*V-se*R-ie*B-N*F}var Q=o(se,ie,N,U);Q>1e-6?(se/=Q,ie/=Q,N/=Q,U/=Q):(se=ie=N=0,U=1),this.rotation.set(h,se,ie,N,U)},p.lookAt=function(h,m,u,_){this.recalcMatrix(h),u=u||this.computedCenter,m=m||this.computedEye,_=_||this.computedUp;var s=this.computedMatrix;a(s,m,u,_);var A=this.computedRotation;t(A,s[0],s[1],s[2],s[4],s[5],s[6],s[8],s[9],s[10]),i(A,A),this.rotation.set(h,A[0],A[1],A[2],A[3]);for(var x=0,v=0;v<3;++v)x+=Math.pow(u[v]-m[v],2);this.radius.set(h,.5*Math.log(Math.max(x,1e-6))),this.center.set(h,u[0],u[1],u[2])},p.translate=function(h,m,u,_){this.center.move(h,m||0,u||0,_||0)},p.setMatrix=function(h,m){var u=this.computedRotation;t(u,m[0],m[1],m[2],m[4],m[5],m[6],m[8],m[9],m[10]),i(u,u),this.rotation.set(h,u[0],u[1],u[2],u[3]);var _=this.computedMatrix;r(_,m);var s=_[15];if(Math.abs(s)>1e-6){var A=_[12]/s,x=_[13]/s,v=_[14]/s;this.recalcMatrix(h);var b=Math.exp(this.computedRadius[0]);this.center.set(h,A-_[2]*b,x-_[6]*b,v-_[10]*b),this.radius.idle(h)}else this.center.idle(h),this.radius.idle(h)},p.setDistance=function(h,m){m>0&&this.radius.set(h,Math.log(m))},p.setDistanceLimits=function(h,m){h>0?h=Math.log(h):h=-1/0,m>0?m=Math.log(m):m=1/0,m=Math.max(m,h),this.radius.bounds[0][0]=h,this.radius.bounds[1][0]=m},p.getDistanceLimits=function(h){var m=this.radius.bounds;return h?(h[0]=Math.exp(m[0][0]),h[1]=Math.exp(m[1][0]),h):[Math.exp(m[0][0]),Math.exp(m[1][0])]},p.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},p.fromJSON=function(h){var m=this.lastT(),u=h.center;u&&this.center.set(m,u[0],u[1],u[2]);var _=h.rotation;_&&this.rotation.set(m,_[0],_[1],_[2],_[3]);var s=h.distance;s&&s>0&&this.radius.set(m,Math.log(s)),this.setDistanceLimits(h.zoomMin,h.zoomMax)};function y(h){h=h||{};var m=h.center||[0,0,0],u=h.rotation||[0,0,0,1],_=h.radius||1;m=[].slice.call(m,0,3),u=[].slice.call(u,0,4),i(u,u);var s=new g(u,m,Math.log(_));return s.setDistanceLimits(h.zoomMin,h.zoomMax),("eye"in h||"up"in h)&&s.lookAt(0,h.eye,h.center,h.up),s}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(c,M,T){var e=c("repeat-string");M.exports=function(n,r,t){return t=typeof t!="undefined"?t+"":" ",e(t,r)+n}},{"repeat-string":277}],265:[function(c,M,T){M.exports=function(a,n){n||(n=[0,""]),a=String(a);var r=parseFloat(a,10);return n[0]=r,n[1]=a.match(/[\d.\-\+]*\s*(.*)/)[1]||"",n}},{}],266:[function(c,M,T){M.exports=a;var e=c("compare-angle");function a(n,r){for(var t=r.length|0,f=n.length,o=[new Array(t),new Array(t)],i=0;i<t;++i)o[0][i]=[],o[1][i]=[];for(var i=0;i<f;++i){var g=n[i];o[0][g[0]].push(g),o[1][g[1]].push(g)}for(var p=[],i=0;i<t;++i)o[0][i].length+o[1][i].length===0&&p.push([i]);function y(x,v){var b=o[v][x[v]];b.splice(b.indexOf(x),1)}function h(x,v,b){for(var l,L,S,k=0;k<2;++k)if(o[k][v].length>0){l=o[k][v][0],S=k;break}L=l[S^1];for(var P=0;P<2;++P)for(var z=o[P][v],I=0;I<z.length;++I){var D=z[I],R=D[P^1],B=e(r[x],r[v],r[L],r[R]);B>0&&(l=D,L=R,S=P)}return b||l&&y(l,S),L}function m(x,v){var b=o[v][x][0],l=[x];y(b,v);for(var L=b[v^1];;){for(;L!==x;)l.push(L),L=h(l[l.length-2],L,!1);if(o[0][x].length+o[1][x].length===0)break;var S=l[l.length-1],k=x,P=l[1],z=h(S,k,!0);if(e(r[S],r[k],r[P],r[z])<0)break;l.push(x),L=h(S,k)}return l}function u(x,v){return v[1]===v[v.length-1]}for(var i=0;i<t;++i)for(var _=0;_<2;++_){for(var s=[];o[_][i].length>0;){o[0][i].length;var A=m(i,_);u(s,A)?s.push.apply(s,A):(s.length>0&&p.push(s),s=A)}s.length>0&&p.push(s)}return p}},{"compare-angle":54}],267:[function(c,M,T){M.exports=a;var e=c("edges-to-adjacency-list");function a(n,r){for(var t=e(n,r.length),f=new Array(r.length),o=new Array(r.length),i=[],g=0;g<r.length;++g){var p=t[g].length;o[g]=p,f[g]=!0,p<=1&&i.push(g)}for(;i.length>0;){var y=i.pop();f[y]=!1;for(var h=t[y],g=0;g<h.length;++g){var m=h[g];--o[m]===0&&i.push(m)}}for(var u=new Array(r.length),_=[],g=0;g<r.length;++g)if(f[g]){var y=_.length;u[g]=y,_.push(r[g])}else u[g]=-1;for(var s=[],g=0;g<n.length;++g){var A=n[g];f[A[0]]&&f[A[1]]&&s.push([u[A[0]],u[A[1]]])}return[s,_]}},{"edges-to-adjacency-list":66}],268:[function(c,M,T){M.exports=p;var e=c("edges-to-adjacency-list"),a=c("planar-dual"),n=c("point-in-big-polygon"),r=c("two-product"),t=c("robust-sum"),f=c("uniq"),o=c("./lib/trim-leaves");function i(y,h){for(var m=new Array(y),u=0;u<y;++u)m[u]=h;return m}function g(y){for(var h=new Array(y),m=0;m<y;++m)h[m]=[];return h}function p(y,h){var U=o(y,h);y=U[0],h=U[1];var m=h.length;y.length;for(var u=e(y,h.length),_=0;_<m;++_)if(u[_].length%2===1)throw new Error("planar-graph-to-polyline: graph must be manifold");var s=a(y,h);function A(ae){for(var le=ae.length,ye=[0],fe=0;fe<le;++fe){var pe=h[ae[fe]],ge=h[ae[(fe+1)%le]],Ae=r(-pe[0],pe[1]),we=r(-pe[0],ge[1]),De=r(ge[0],pe[1]),Be=r(ge[0],ge[1]);ye=t(ye,t(t(Ae,we),t(De,Be)))}return ye[ye.length-1]>0}s=s.filter(A);for(var x=s.length,v=new Array(x),b=new Array(x),_=0;_<x;++_){v[_]=_;var l=new Array(x),L=s[_].map(function(le){return h[le]}),S=n([L]),k=0;e:for(var P=0;P<x;++P)if(l[P]=0,_!==P){for(var z=s[P],I=z.length,D=0;D<I;++D){var R=S(h[z[D]]);if(R!==0){R<0&&(l[P]=1,k+=1);continue e}}l[P]=1,k+=1}b[_]=[k,_,l]}b.sort(function(ae,le){return le[0]-ae[0]});for(var _=0;_<x;++_)for(var l=b[_],B=l[1],F=l[2],P=0;P<x;++P)F[P]&&(v[P]=B);for(var V=g(x),_=0;_<x;++_)V[_].push(v[_]),V[v[_]].push(_);for(var G={},J=i(m,!1),_=0;_<x;++_)for(var z=s[_],I=z.length,P=0;P<I;++P){var j=z[P],Y=z[(P+1)%I],X=Math.min(j,Y)+":"+Math.max(j,Y);if(X in G){var oe=G[X];V[oe].push(_),V[_].push(oe),J[j]=J[Y]=!0}else G[X]=_}function se(ae){for(var le=ae.length,ye=0;ye<le;++ye)if(!J[ae[ye]])return!1;return!0}for(var ie=[],N=i(x,-1),_=0;_<x;++_)v[_]===_&&!se(s[_])?(ie.push(_),N[_]=0):N[_]=-1;for(var U=[];ie.length>0;){var q=ie.pop(),Q=V[q];f(Q,function(ae,le){return ae-le});var W=Q.length,Z=N[q],ee;if(Z===0){var z=s[q];ee=[z]}for(var _=0;_<W;++_){var te=Q[_];if(!(N[te]>=0)&&(N[te]=Z^1,ie.push(te),Z===0)){var z=s[te];se(z)||(z.reverse(),ee.push(z))}}Z===0&&U.push(ee)}return U}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(c,M,T){M.exports=h;var e=c("robust-orientation")[3],a=c("slab-decomposition"),n=c("interval-tree-1d"),r=c("binary-search-bounds");function t(){return!0}function f(m){return function(u,_){var s=m[u];return s?!!s.queryPoint(_,t):!1}}function o(m){for(var u={},_=0;_<m.length;++_){var s=m[_],A=s[0][0],x=s[0][1],v=s[1][1],b=[Math.min(x,v),Math.max(x,v)];A in u?u[A].push(b):u[A]=[b]}for(var l={},L=Object.keys(u),_=0;_<L.length;++_){var S=u[L[_]];l[L[_]]=n(S)}return f(l)}function i(m,u){return function(_){var s=r.le(u,_[0]);if(s<0)return 1;var A=m[s];if(!A)if(s>0&&u[s]===_[0])A=m[s-1];else return 1;for(var x=1;A;){var v=A.key,b=e(_,v[0],v[1]);if(v[0][0]<v[1][0])if(b<0)A=A.left;else if(b>0)x=-1,A=A.right;else return 0;else if(b>0)A=A.left;else if(b<0)x=1,A=A.right;else return 0}return x}}function g(m){return 1}function p(m){return function(_){return m(_[0],_[1])?0:1}}function y(m,u){return function(s){return m(s[0],s[1])?0:u(s)}}function h(m){for(var u=m.length,_=[],s=[],A=0;A<u;++A)for(var x=m[A],v=x.length,b=v-1,l=0;l<v;b=l++){var L=x[b],S=x[l];L[0]===S[0]?s.push([L,S]):_.push([L,S])}if(_.length===0)return s.length===0?g:p(o(s));var k=a(_),P=i(k.slabs,k.coordinates);return s.length===0?P:y(o(s),P)}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(c,M,T){var e=new Float64Array(4),a=new Float64Array(4),n=new Float64Array(4);function r(t,f,o,i,g){e.length<i.length&&(e=new Float64Array(i.length),a=new Float64Array(i.length),n=new Float64Array(i.length));for(var p=0;p<i.length;++p)e[p]=t[p]-i[p],a[p]=f[p]-t[p],n[p]=o[p]-t[p];for(var y=0,h=0,m=0,u=0,_=0,s=0,p=0;p<i.length;++p){var A=a[p],x=n[p],v=e[p];y+=A*A,h+=A*x,m+=x*x,u+=v*A,_+=v*x,s+=v*v}var b=Math.abs(y*m-h*h),l=h*_-m*u,L=h*u-y*_,S;if(l+L<=b)if(l<0)L<0&&u<0?(L=0,-u>=y?(l=1,S=y+2*u+s):(l=-u/y,S=u*l+s)):(l=0,_>=0?(L=0,S=s):-_>=m?(L=1,S=m+2*_+s):(L=-_/m,S=_*L+s));else if(L<0)L=0,u>=0?(l=0,S=s):-u>=y?(l=1,S=y+2*u+s):(l=-u/y,S=u*l+s);else{var k=1/b;l*=k,L*=k,S=l*(y*l+h*L+2*u)+L*(h*l+m*L+2*_)+s}else{var P,z,I,D;l<0?(P=h+u,z=m+_,z>P?(I=z-P,D=y-2*h+m,I>=D?(l=1,L=0,S=y+2*u+s):(l=I/D,L=1-l,S=l*(y*l+h*L+2*u)+L*(h*l+m*L+2*_)+s)):(l=0,z<=0?(L=1,S=m+2*_+s):_>=0?(L=0,S=s):(L=-_/m,S=_*L+s))):L<0?(P=h+_,z=y+u,z>P?(I=z-P,D=y-2*h+m,I>=D?(L=1,l=0,S=m+2*_+s):(L=I/D,l=1-L,S=l*(y*l+h*L+2*u)+L*(h*l+m*L+2*_)+s)):(L=0,z<=0?(l=1,S=y+2*u+s):u>=0?(l=0,S=s):(l=-u/y,S=u*l+s))):(I=m+_-h-u,I<=0?(l=0,L=1,S=m+2*_+s):(D=y-2*h+m,I>=D?(l=1,L=0,S=y+2*u+s):(l=I/D,L=1-l,S=l*(y*l+h*L+2*u)+L*(h*l+m*L+2*_)+s)))}for(var R=1-l-L,p=0;p<i.length;++p)g[p]=R*t[p]+l*f[p]+L*o[p];return S<0?0:S}M.exports=r},{}],271:[function(c,M,T){M.exports=c("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(c,M,T){var e=c("big-rat/add");M.exports=a;function a(n,r){for(var t=n.length,f=new Array(t),o=0;o<t;++o)f[o]=e(n[o],r[o]);return f}},{"big-rat/add":15}],273:[function(c,M,T){M.exports=a;var e=c("big-rat");function a(n){for(var r=new Array(n.length),t=0;t<n.length;++t)r[t]=e(n[t]);return r}},{"big-rat":18}],274:[function(c,M,T){var e=c("big-rat"),a=c("big-rat/mul");M.exports=n;function n(r,t){for(var f=e(t),o=r.length,i=new Array(o),g=0;g<o;++g)i[g]=a(r[g],f);return i}},{"big-rat":18,"big-rat/mul":27}],275:[function(c,M,T){var e=c("big-rat/sub");M.exports=a;function a(n,r){for(var t=n.length,f=new Array(t),o=0;o<t;++o)f[o]=e(n[o],r[o]);return f}},{"big-rat/sub":29}],276:[function(c,M,T){var e=c("compare-cell"),a=c("compare-oriented-cell"),n=c("cell-orientation");M.exports=r;function r(t){t.sort(a);for(var f=t.length,o=0,i=0;i<f;++i){var g=t[i],p=n(g);if(p!==0){if(o>0){var y=t[o-1];if(e(g,y)===0&&n(y)!==p){o-=1;continue}}t[o++]=g}}return t.length=o,t}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(c,M,T){var e="",a;M.exports=n;function n(r,t){if(typeof r!="string")throw new TypeError("expected a string");if(t===1)return r;if(t===2)return r+r;var f=r.length*t;if(a!==r||typeof a=="undefined")a=r,e="";else if(e.length>=f)return e.substr(0,f);for(;f>e.length&&t>1;)t&1&&(e+=r),t>>=1,r+=r;return e+=r,e=e.substr(0,f),e}},{}],278:[function(c,M,T){(function(e){(function(){M.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,typeof w!="undefined"?w:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],279:[function(c,M,T){M.exports=e;function e(a){for(var n=a.length,r=a[a.length-1],t=n,f=n-2;f>=0;--f){var o=r,i=a[f];r=o+i;var g=r-o,p=i-g;p&&(a[--t]=r,r=p)}for(var y=0,f=t;f<n;++f){var o=a[f],i=r;r=o+i;var g=r-o,p=i-g;p&&(a[y++]=p)}return a[y++]=r,a.length=y,a}},{}],280:[function(c,M,T){var e=c("two-product"),a=c("robust-sum"),n=c("robust-scale"),r=c("robust-compress"),t=6;function f(u,_,s,A){return function(v){return A(u(s(v[0][0],v[1][1]),s(-v[0][1],v[1][0])))}}function o(u,_,s,A){return function(v){return A(u(_(u(s(v[1][1],v[2][2]),s(-v[1][2],v[2][1])),v[0][0]),u(_(u(s(v[1][0],v[2][2]),s(-v[1][2],v[2][0])),-v[0][1]),_(u(s(v[1][0],v[2][1]),s(-v[1][1],v[2][0])),v[0][2]))))}}function i(u,_,s,A){return function(v){return A(u(u(_(u(_(u(s(v[2][2],v[3][3]),s(-v[2][3],v[3][2])),v[1][1]),u(_(u(s(v[2][1],v[3][3]),s(-v[2][3],v[3][1])),-v[1][2]),_(u(s(v[2][1],v[3][2]),s(-v[2][2],v[3][1])),v[1][3]))),v[0][0]),_(u(_(u(s(v[2][2],v[3][3]),s(-v[2][3],v[3][2])),v[1][0]),u(_(u(s(v[2][0],v[3][3]),s(-v[2][3],v[3][0])),-v[1][2]),_(u(s(v[2][0],v[3][2]),s(-v[2][2],v[3][0])),v[1][3]))),-v[0][1])),u(_(u(_(u(s(v[2][1],v[3][3]),s(-v[2][3],v[3][1])),v[1][0]),u(_(u(s(v[2][0],v[3][3]),s(-v[2][3],v[3][0])),-v[1][1]),_(u(s(v[2][0],v[3][1]),s(-v[2][1],v[3][0])),v[1][3]))),v[0][2]),_(u(_(u(s(v[2][1],v[3][2]),s(-v[2][2],v[3][1])),v[1][0]),u(_(u(s(v[2][0],v[3][2]),s(-v[2][2],v[3][0])),-v[1][1]),_(u(s(v[2][0],v[3][1]),s(-v[2][1],v[3][0])),v[1][2]))),-v[0][3]))))}}function g(u,_,s,A){return function(v){return A(u(u(_(u(u(_(u(_(u(s(v[3][3],v[4][4]),s(-v[3][4],v[4][3])),v[2][2]),u(_(u(s(v[3][2],v[4][4]),s(-v[3][4],v[4][2])),-v[2][3]),_(u(s(v[3][2],v[4][3]),s(-v[3][3],v[4][2])),v[2][4]))),v[1][1]),_(u(_(u(s(v[3][3],v[4][4]),s(-v[3][4],v[4][3])),v[2][1]),u(_(u(s(v[3][1],v[4][4]),s(-v[3][4],v[4][1])),-v[2][3]),_(u(s(v[3][1],v[4][3]),s(-v[3][3],v[4][1])),v[2][4]))),-v[1][2])),u(_(u(_(u(s(v[3][2],v[4][4]),s(-v[3][4],v[4][2])),v[2][1]),u(_(u(s(v[3][1],v[4][4]),s(-v[3][4],v[4][1])),-v[2][2]),_(u(s(v[3][1],v[4][2]),s(-v[3][2],v[4][1])),v[2][4]))),v[1][3]),_(u(_(u(s(v[3][2],v[4][3]),s(-v[3][3],v[4][2])),v[2][1]),u(_(u(s(v[3][1],v[4][3]),s(-v[3][3],v[4][1])),-v[2][2]),_(u(s(v[3][1],v[4][2]),s(-v[3][2],v[4][1])),v[2][3]))),-v[1][4]))),v[0][0]),_(u(u(_(u(_(u(s(v[3][3],v[4][4]),s(-v[3][4],v[4][3])),v[2][2]),u(_(u(s(v[3][2],v[4][4]),s(-v[3][4],v[4][2])),-v[2][3]),_(u(s(v[3][2],v[4][3]),s(-v[3][3],v[4][2])),v[2][4]))),v[1][0]),_(u(_(u(s(v[3][3],v[4][4]),s(-v[3][4],v[4][3])),v[2][0]),u(_(u(s(v[3][0],v[4][4]),s(-v[3][4],v[4][0])),-v[2][3]),_(u(s(v[3][0],v[4][3]),s(-v[3][3],v[4][0])),v[2][4]))),-v[1][2])),u(_(u(_(u(s(v[3][2],v[4][4]),s(-v[3][4],v[4][2])),v[2][0]),u(_(u(s(v[3][0],v[4][4]),s(-v[3][4],v[4][0])),-v[2][2]),_(u(s(v[3][0],v[4][2]),s(-v[3][2],v[4][0])),v[2][4]))),v[1][3]),_(u(_(u(s(v[3][2],v[4][3]),s(-v[3][3],v[4][2])),v[2][0]),u(_(u(s(v[3][0],v[4][3]),s(-v[3][3],v[4][0])),-v[2][2]),_(u(s(v[3][0],v[4][2]),s(-v[3][2],v[4][0])),v[2][3]))),-v[1][4]))),-v[0][1])),u(_(u(u(_(u(_(u(s(v[3][3],v[4][4]),s(-v[3][4],v[4][3])),v[2][1]),u(_(u(s(v[3][1],v[4][4]),s(-v[3][4],v[4][1])),-v[2][3]),_(u(s(v[3][1],v[4][3]),s(-v[3][3],v[4][1])),v[2][4]))),v[1][0]),_(u(_(u(s(v[3][3],v[4][4]),s(-v[3][4],v[4][3])),v[2][0]),u(_(u(s(v[3][0],v[4][4]),s(-v[3][4],v[4][0])),-v[2][3]),_(u(s(v[3][0],v[4][3]),s(-v[3][3],v[4][0])),v[2][4]))),-v[1][1])),u(_(u(_(u(s(v[3][1],v[4][4]),s(-v[3][4],v[4][1])),v[2][0]),u(_(u(s(v[3][0],v[4][4]),s(-v[3][4],v[4][0])),-v[2][1]),_(u(s(v[3][0],v[4][1]),s(-v[3][1],v[4][0])),v[2][4]))),v[1][3]),_(u(_(u(s(v[3][1],v[4][3]),s(-v[3][3],v[4][1])),v[2][0]),u(_(u(s(v[3][0],v[4][3]),s(-v[3][3],v[4][0])),-v[2][1]),_(u(s(v[3][0],v[4][1]),s(-v[3][1],v[4][0])),v[2][3]))),-v[1][4]))),v[0][2]),u(_(u(u(_(u(_(u(s(v[3][2],v[4][4]),s(-v[3][4],v[4][2])),v[2][1]),u(_(u(s(v[3][1],v[4][4]),s(-v[3][4],v[4][1])),-v[2][2]),_(u(s(v[3][1],v[4][2]),s(-v[3][2],v[4][1])),v[2][4]))),v[1][0]),_(u(_(u(s(v[3][2],v[4][4]),s(-v[3][4],v[4][2])),v[2][0]),u(_(u(s(v[3][0],v[4][4]),s(-v[3][4],v[4][0])),-v[2][2]),_(u(s(v[3][0],v[4][2]),s(-v[3][2],v[4][0])),v[2][4]))),-v[1][1])),u(_(u(_(u(s(v[3][1],v[4][4]),s(-v[3][4],v[4][1])),v[2][0]),u(_(u(s(v[3][0],v[4][4]),s(-v[3][4],v[4][0])),-v[2][1]),_(u(s(v[3][0],v[4][1]),s(-v[3][1],v[4][0])),v[2][4]))),v[1][2]),_(u(_(u(s(v[3][1],v[4][2]),s(-v[3][2],v[4][1])),v[2][0]),u(_(u(s(v[3][0],v[4][2]),s(-v[3][2],v[4][0])),-v[2][1]),_(u(s(v[3][0],v[4][1]),s(-v[3][1],v[4][0])),v[2][2]))),-v[1][4]))),-v[0][3]),_(u(u(_(u(_(u(s(v[3][2],v[4][3]),s(-v[3][3],v[4][2])),v[2][1]),u(_(u(s(v[3][1],v[4][3]),s(-v[3][3],v[4][1])),-v[2][2]),_(u(s(v[3][1],v[4][2]),s(-v[3][2],v[4][1])),v[2][3]))),v[1][0]),_(u(_(u(s(v[3][2],v[4][3]),s(-v[3][3],v[4][2])),v[2][0]),u(_(u(s(v[3][0],v[4][3]),s(-v[3][3],v[4][0])),-v[2][2]),_(u(s(v[3][0],v[4][2]),s(-v[3][2],v[4][0])),v[2][3]))),-v[1][1])),u(_(u(_(u(s(v[3][1],v[4][3]),s(-v[3][3],v[4][1])),v[2][0]),u(_(u(s(v[3][0],v[4][3]),s(-v[3][3],v[4][0])),-v[2][1]),_(u(s(v[3][0],v[4][1]),s(-v[3][1],v[4][0])),v[2][3]))),v[1][2]),_(u(_(u(s(v[3][1],v[4][2]),s(-v[3][2],v[4][1])),v[2][0]),u(_(u(s(v[3][0],v[4][2]),s(-v[3][2],v[4][0])),-v[2][1]),_(u(s(v[3][0],v[4][1]),s(-v[3][1],v[4][0])),v[2][2]))),-v[1][3]))),v[0][4])))))}}function p(u){var _=u===2?f:u===3?o:u===4?i:u===5?g:void 0;return _(a,n,e,r)}var y=[function(){return[0]},function(_){return[_[0][0]]}];function h(u,_,s,A,x,v,b,l){return function(S){switch(S.length){case 0:return u(S);case 1:return _(S);case 2:return s(S);case 3:return A(S);case 4:return x(S);case 5:return v(S)}var k=b[S.length];return k||(k=b[S.length]=l(S.length)),k(S)}}function m(){for(;y.length<t;)y.push(p(y.length));M.exports=h.apply(void 0,y.concat([y,p]));for(var u=0;u<y.length;++u)M.exports[u]=y[u]}m()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(c,M,T){var e=c("two-product"),a=c("robust-sum");M.exports=n;function n(r,t){for(var f=e(r[0],t[0]),o=1;o<r.length;++o)f=a(f,e(r[o],t[o]));return f}},{"robust-sum":289,"two-product":306}],282:[function(c,M,T){var e=c("two-product"),a=c("robust-sum"),n=c("robust-subtract"),r=c("robust-scale"),t=6;function f(x){var v=x===3?p:x===4?y:x===5?h:m;return v(a,n,e,r)}function o(){return 0}function i(){return 0}function g(){return 0}function p(x,v,b,l){function L(S,k,P){var z=b(S[0],S[0]),I=l(z,k[0]),D=l(z,P[0]),R=b(k[0],k[0]),B=l(R,S[0]),F=l(R,P[0]),V=b(P[0],P[0]),G=l(V,S[0]),J=l(V,k[0]),j=x(v(J,F),v(B,I)),Y=v(G,D),X=v(j,Y);return X[X.length-1]}return L}function y(x,v,b,l){function L(S,k,P,z){var I=x(b(S[0],S[0]),b(S[1],S[1])),D=l(I,k[0]),R=l(I,P[0]),B=l(I,z[0]),F=x(b(k[0],k[0]),b(k[1],k[1])),V=l(F,S[0]),G=l(F,P[0]),J=l(F,z[0]),j=x(b(P[0],P[0]),b(P[1],P[1])),Y=l(j,S[0]),X=l(j,k[0]),oe=l(j,z[0]),se=x(b(z[0],z[0]),b(z[1],z[1])),ie=l(se,S[0]),N=l(se,k[0]),U=l(se,P[0]),q=x(x(l(v(U,oe),k[1]),x(l(v(N,J),-P[1]),l(v(X,G),z[1]))),x(l(v(N,J),S[1]),x(l(v(ie,B),-k[1]),l(v(V,D),z[1])))),Q=x(x(l(v(U,oe),S[1]),x(l(v(ie,B),-P[1]),l(v(Y,R),z[1]))),x(l(v(X,G),S[1]),x(l(v(Y,R),-k[1]),l(v(V,D),P[1])))),W=v(q,Q);return W[W.length-1]}return L}function h(x,v,b,l){function L(S,k,P,z,I){var D=x(b(S[0],S[0]),x(b(S[1],S[1]),b(S[2],S[2]))),R=l(D,k[0]),B=l(D,P[0]),F=l(D,z[0]),V=l(D,I[0]),G=x(b(k[0],k[0]),x(b(k[1],k[1]),b(k[2],k[2]))),J=l(G,S[0]),j=l(G,P[0]),Y=l(G,z[0]),X=l(G,I[0]),oe=x(b(P[0],P[0]),x(b(P[1],P[1]),b(P[2],P[2]))),se=l(oe,S[0]),ie=l(oe,k[0]),N=l(oe,z[0]),U=l(oe,I[0]),q=x(b(z[0],z[0]),x(b(z[1],z[1]),b(z[2],z[2]))),Q=l(q,S[0]),W=l(q,k[0]),Z=l(q,P[0]),ee=l(q,I[0]),te=x(b(I[0],I[0]),x(b(I[1],I[1]),b(I[2],I[2]))),ae=l(te,S[0]),le=l(te,k[0]),ye=l(te,P[0]),fe=l(te,z[0]),pe=x(x(x(l(x(l(v(fe,ee),P[1]),x(l(v(ye,U),-z[1]),l(v(Z,N),I[1]))),k[2]),x(l(x(l(v(fe,ee),k[1]),x(l(v(le,X),-z[1]),l(v(W,Y),I[1]))),-P[2]),l(x(l(v(ye,U),k[1]),x(l(v(le,X),-P[1]),l(v(ie,j),I[1]))),z[2]))),x(l(x(l(v(Z,N),k[1]),x(l(v(W,Y),-P[1]),l(v(ie,j),z[1]))),-I[2]),x(l(x(l(v(fe,ee),k[1]),x(l(v(le,X),-z[1]),l(v(W,Y),I[1]))),S[2]),l(x(l(v(fe,ee),S[1]),x(l(v(ae,V),-z[1]),l(v(Q,F),I[1]))),-k[2])))),x(x(l(x(l(v(le,X),S[1]),x(l(v(ae,V),-k[1]),l(v(J,R),I[1]))),z[2]),x(l(x(l(v(W,Y),S[1]),x(l(v(Q,F),-k[1]),l(v(J,R),z[1]))),-I[2]),l(x(l(v(Z,N),k[1]),x(l(v(W,Y),-P[1]),l(v(ie,j),z[1]))),S[2]))),x(l(x(l(v(Z,N),S[1]),x(l(v(Q,F),-P[1]),l(v(se,B),z[1]))),-k[2]),x(l(x(l(v(W,Y),S[1]),x(l(v(Q,F),-k[1]),l(v(J,R),z[1]))),P[2]),l(x(l(v(ie,j),S[1]),x(l(v(se,B),-k[1]),l(v(J,R),P[1]))),-z[2]))))),ge=x(x(x(l(x(l(v(fe,ee),P[1]),x(l(v(ye,U),-z[1]),l(v(Z,N),I[1]))),S[2]),l(x(l(v(fe,ee),S[1]),x(l(v(ae,V),-z[1]),l(v(Q,F),I[1]))),-P[2])),x(l(x(l(v(ye,U),S[1]),x(l(v(ae,V),-P[1]),l(v(se,B),I[1]))),z[2]),l(x(l(v(Z,N),S[1]),x(l(v(Q,F),-P[1]),l(v(se,B),z[1]))),-I[2]))),x(x(l(x(l(v(ye,U),k[1]),x(l(v(le,X),-P[1]),l(v(ie,j),I[1]))),S[2]),l(x(l(v(ye,U),S[1]),x(l(v(ae,V),-P[1]),l(v(se,B),I[1]))),-k[2])),x(l(x(l(v(le,X),S[1]),x(l(v(ae,V),-k[1]),l(v(J,R),I[1]))),P[2]),l(x(l(v(ie,j),S[1]),x(l(v(se,B),-k[1]),l(v(J,R),P[1]))),-I[2])))),Ae=v(pe,ge);return Ae[Ae.length-1]}return L}function m(x,v,b,l){function L(S,k,P,z,I,D){var R=x(x(b(S[0],S[0]),b(S[1],S[1])),x(b(S[2],S[2]),b(S[3],S[3]))),B=l(R,k[0]),F=l(R,P[0]),V=l(R,z[0]),G=l(R,I[0]),J=l(R,D[0]),j=x(x(b(k[0],k[0]),b(k[1],k[1])),x(b(k[2],k[2]),b(k[3],k[3]))),Y=l(j,S[0]),X=l(j,P[0]),oe=l(j,z[0]),se=l(j,I[0]),ie=l(j,D[0]),N=x(x(b(P[0],P[0]),b(P[1],P[1])),x(b(P[2],P[2]),b(P[3],P[3]))),U=l(N,S[0]),q=l(N,k[0]),Q=l(N,z[0]),W=l(N,I[0]),Z=l(N,D[0]),ee=x(x(b(z[0],z[0]),b(z[1],z[1])),x(b(z[2],z[2]),b(z[3],z[3]))),te=l(ee,S[0]),ae=l(ee,k[0]),le=l(ee,P[0]),ye=l(ee,I[0]),fe=l(ee,D[0]),pe=x(x(b(I[0],I[0]),b(I[1],I[1])),x(b(I[2],I[2]),b(I[3],I[3]))),ge=l(pe,S[0]),Ae=l(pe,k[0]),we=l(pe,P[0]),De=l(pe,z[0]),Be=l(pe,D[0]),Ve=x(x(b(D[0],D[0]),b(D[1],D[1])),x(b(D[2],D[2]),b(D[3],D[3]))),xe=l(Ve,S[0]),Le=l(Ve,k[0]),He=l(Ve,P[0]),Je=l(Ve,z[0]),Oe=l(Ve,I[0]),Pe=x(x(x(l(x(x(l(x(l(v(Oe,Be),z[1]),x(l(v(Je,fe),-I[1]),l(v(De,ye),D[1]))),P[2]),l(x(l(v(Oe,Be),P[1]),x(l(v(He,Z),-I[1]),l(v(we,W),D[1]))),-z[2])),x(l(x(l(v(Je,fe),P[1]),x(l(v(He,Z),-z[1]),l(v(le,Q),D[1]))),I[2]),l(x(l(v(De,ye),P[1]),x(l(v(we,W),-z[1]),l(v(le,Q),I[1]))),-D[2]))),k[3]),x(l(x(x(l(x(l(v(Oe,Be),z[1]),x(l(v(Je,fe),-I[1]),l(v(De,ye),D[1]))),k[2]),l(x(l(v(Oe,Be),k[1]),x(l(v(Le,ie),-I[1]),l(v(Ae,se),D[1]))),-z[2])),x(l(x(l(v(Je,fe),k[1]),x(l(v(Le,ie),-z[1]),l(v(ae,oe),D[1]))),I[2]),l(x(l(v(De,ye),k[1]),x(l(v(Ae,se),-z[1]),l(v(ae,oe),I[1]))),-D[2]))),-P[3]),l(x(x(l(x(l(v(Oe,Be),P[1]),x(l(v(He,Z),-I[1]),l(v(we,W),D[1]))),k[2]),l(x(l(v(Oe,Be),k[1]),x(l(v(Le,ie),-I[1]),l(v(Ae,se),D[1]))),-P[2])),x(l(x(l(v(He,Z),k[1]),x(l(v(Le,ie),-P[1]),l(v(q,X),D[1]))),I[2]),l(x(l(v(we,W),k[1]),x(l(v(Ae,se),-P[1]),l(v(q,X),I[1]))),-D[2]))),z[3]))),x(x(l(x(x(l(x(l(v(Je,fe),P[1]),x(l(v(He,Z),-z[1]),l(v(le,Q),D[1]))),k[2]),l(x(l(v(Je,fe),k[1]),x(l(v(Le,ie),-z[1]),l(v(ae,oe),D[1]))),-P[2])),x(l(x(l(v(He,Z),k[1]),x(l(v(Le,ie),-P[1]),l(v(q,X),D[1]))),z[2]),l(x(l(v(le,Q),k[1]),x(l(v(ae,oe),-P[1]),l(v(q,X),z[1]))),-D[2]))),-I[3]),l(x(x(l(x(l(v(De,ye),P[1]),x(l(v(we,W),-z[1]),l(v(le,Q),I[1]))),k[2]),l(x(l(v(De,ye),k[1]),x(l(v(Ae,se),-z[1]),l(v(ae,oe),I[1]))),-P[2])),x(l(x(l(v(we,W),k[1]),x(l(v(Ae,se),-P[1]),l(v(q,X),I[1]))),z[2]),l(x(l(v(le,Q),k[1]),x(l(v(ae,oe),-P[1]),l(v(q,X),z[1]))),-I[2]))),D[3])),x(l(x(x(l(x(l(v(Oe,Be),z[1]),x(l(v(Je,fe),-I[1]),l(v(De,ye),D[1]))),k[2]),l(x(l(v(Oe,Be),k[1]),x(l(v(Le,ie),-I[1]),l(v(Ae,se),D[1]))),-z[2])),x(l(x(l(v(Je,fe),k[1]),x(l(v(Le,ie),-z[1]),l(v(ae,oe),D[1]))),I[2]),l(x(l(v(De,ye),k[1]),x(l(v(Ae,se),-z[1]),l(v(ae,oe),I[1]))),-D[2]))),S[3]),l(x(x(l(x(l(v(Oe,Be),z[1]),x(l(v(Je,fe),-I[1]),l(v(De,ye),D[1]))),S[2]),l(x(l(v(Oe,Be),S[1]),x(l(v(xe,J),-I[1]),l(v(ge,G),D[1]))),-z[2])),x(l(x(l(v(Je,fe),S[1]),x(l(v(xe,J),-z[1]),l(v(te,V),D[1]))),I[2]),l(x(l(v(De,ye),S[1]),x(l(v(ge,G),-z[1]),l(v(te,V),I[1]))),-D[2]))),-k[3])))),x(x(x(l(x(x(l(x(l(v(Oe,Be),k[1]),x(l(v(Le,ie),-I[1]),l(v(Ae,se),D[1]))),S[2]),l(x(l(v(Oe,Be),S[1]),x(l(v(xe,J),-I[1]),l(v(ge,G),D[1]))),-k[2])),x(l(x(l(v(Le,ie),S[1]),x(l(v(xe,J),-k[1]),l(v(Y,B),D[1]))),I[2]),l(x(l(v(Ae,se),S[1]),x(l(v(ge,G),-k[1]),l(v(Y,B),I[1]))),-D[2]))),z[3]),l(x(x(l(x(l(v(Je,fe),k[1]),x(l(v(Le,ie),-z[1]),l(v(ae,oe),D[1]))),S[2]),l(x(l(v(Je,fe),S[1]),x(l(v(xe,J),-z[1]),l(v(te,V),D[1]))),-k[2])),x(l(x(l(v(Le,ie),S[1]),x(l(v(xe,J),-k[1]),l(v(Y,B),D[1]))),z[2]),l(x(l(v(ae,oe),S[1]),x(l(v(te,V),-k[1]),l(v(Y,B),z[1]))),-D[2]))),-I[3])),x(l(x(x(l(x(l(v(De,ye),k[1]),x(l(v(Ae,se),-z[1]),l(v(ae,oe),I[1]))),S[2]),l(x(l(v(De,ye),S[1]),x(l(v(ge,G),-z[1]),l(v(te,V),I[1]))),-k[2])),x(l(x(l(v(Ae,se),S[1]),x(l(v(ge,G),-k[1]),l(v(Y,B),I[1]))),z[2]),l(x(l(v(ae,oe),S[1]),x(l(v(te,V),-k[1]),l(v(Y,B),z[1]))),-I[2]))),D[3]),l(x(x(l(x(l(v(Je,fe),P[1]),x(l(v(He,Z),-z[1]),l(v(le,Q),D[1]))),k[2]),l(x(l(v(Je,fe),k[1]),x(l(v(Le,ie),-z[1]),l(v(ae,oe),D[1]))),-P[2])),x(l(x(l(v(He,Z),k[1]),x(l(v(Le,ie),-P[1]),l(v(q,X),D[1]))),z[2]),l(x(l(v(le,Q),k[1]),x(l(v(ae,oe),-P[1]),l(v(q,X),z[1]))),-D[2]))),S[3]))),x(x(l(x(x(l(x(l(v(Je,fe),P[1]),x(l(v(He,Z),-z[1]),l(v(le,Q),D[1]))),S[2]),l(x(l(v(Je,fe),S[1]),x(l(v(xe,J),-z[1]),l(v(te,V),D[1]))),-P[2])),x(l(x(l(v(He,Z),S[1]),x(l(v(xe,J),-P[1]),l(v(U,F),D[1]))),z[2]),l(x(l(v(le,Q),S[1]),x(l(v(te,V),-P[1]),l(v(U,F),z[1]))),-D[2]))),-k[3]),l(x(x(l(x(l(v(Je,fe),k[1]),x(l(v(Le,ie),-z[1]),l(v(ae,oe),D[1]))),S[2]),l(x(l(v(Je,fe),S[1]),x(l(v(xe,J),-z[1]),l(v(te,V),D[1]))),-k[2])),x(l(x(l(v(Le,ie),S[1]),x(l(v(xe,J),-k[1]),l(v(Y,B),D[1]))),z[2]),l(x(l(v(ae,oe),S[1]),x(l(v(te,V),-k[1]),l(v(Y,B),z[1]))),-D[2]))),P[3])),x(l(x(x(l(x(l(v(He,Z),k[1]),x(l(v(Le,ie),-P[1]),l(v(q,X),D[1]))),S[2]),l(x(l(v(He,Z),S[1]),x(l(v(xe,J),-P[1]),l(v(U,F),D[1]))),-k[2])),x(l(x(l(v(Le,ie),S[1]),x(l(v(xe,J),-k[1]),l(v(Y,B),D[1]))),P[2]),l(x(l(v(q,X),S[1]),x(l(v(U,F),-k[1]),l(v(Y,B),P[1]))),-D[2]))),-z[3]),l(x(x(l(x(l(v(le,Q),k[1]),x(l(v(ae,oe),-P[1]),l(v(q,X),z[1]))),S[2]),l(x(l(v(le,Q),S[1]),x(l(v(te,V),-P[1]),l(v(U,F),z[1]))),-k[2])),x(l(x(l(v(ae,oe),S[1]),x(l(v(te,V),-k[1]),l(v(Y,B),z[1]))),P[2]),l(x(l(v(q,X),S[1]),x(l(v(U,F),-k[1]),l(v(Y,B),P[1]))),-z[2]))),D[3]))))),Ue=x(x(x(l(x(x(l(x(l(v(Oe,Be),z[1]),x(l(v(Je,fe),-I[1]),l(v(De,ye),D[1]))),P[2]),l(x(l(v(Oe,Be),P[1]),x(l(v(He,Z),-I[1]),l(v(we,W),D[1]))),-z[2])),x(l(x(l(v(Je,fe),P[1]),x(l(v(He,Z),-z[1]),l(v(le,Q),D[1]))),I[2]),l(x(l(v(De,ye),P[1]),x(l(v(we,W),-z[1]),l(v(le,Q),I[1]))),-D[2]))),S[3]),x(l(x(x(l(x(l(v(Oe,Be),z[1]),x(l(v(Je,fe),-I[1]),l(v(De,ye),D[1]))),S[2]),l(x(l(v(Oe,Be),S[1]),x(l(v(xe,J),-I[1]),l(v(ge,G),D[1]))),-z[2])),x(l(x(l(v(Je,fe),S[1]),x(l(v(xe,J),-z[1]),l(v(te,V),D[1]))),I[2]),l(x(l(v(De,ye),S[1]),x(l(v(ge,G),-z[1]),l(v(te,V),I[1]))),-D[2]))),-P[3]),l(x(x(l(x(l(v(Oe,Be),P[1]),x(l(v(He,Z),-I[1]),l(v(we,W),D[1]))),S[2]),l(x(l(v(Oe,Be),S[1]),x(l(v(xe,J),-I[1]),l(v(ge,G),D[1]))),-P[2])),x(l(x(l(v(He,Z),S[1]),x(l(v(xe,J),-P[1]),l(v(U,F),D[1]))),I[2]),l(x(l(v(we,W),S[1]),x(l(v(ge,G),-P[1]),l(v(U,F),I[1]))),-D[2]))),z[3]))),x(x(l(x(x(l(x(l(v(Je,fe),P[1]),x(l(v(He,Z),-z[1]),l(v(le,Q),D[1]))),S[2]),l(x(l(v(Je,fe),S[1]),x(l(v(xe,J),-z[1]),l(v(te,V),D[1]))),-P[2])),x(l(x(l(v(He,Z),S[1]),x(l(v(xe,J),-P[1]),l(v(U,F),D[1]))),z[2]),l(x(l(v(le,Q),S[1]),x(l(v(te,V),-P[1]),l(v(U,F),z[1]))),-D[2]))),-I[3]),l(x(x(l(x(l(v(De,ye),P[1]),x(l(v(we,W),-z[1]),l(v(le,Q),I[1]))),S[2]),l(x(l(v(De,ye),S[1]),x(l(v(ge,G),-z[1]),l(v(te,V),I[1]))),-P[2])),x(l(x(l(v(we,W),S[1]),x(l(v(ge,G),-P[1]),l(v(U,F),I[1]))),z[2]),l(x(l(v(le,Q),S[1]),x(l(v(te,V),-P[1]),l(v(U,F),z[1]))),-I[2]))),D[3])),x(l(x(x(l(x(l(v(Oe,Be),P[1]),x(l(v(He,Z),-I[1]),l(v(we,W),D[1]))),k[2]),l(x(l(v(Oe,Be),k[1]),x(l(v(Le,ie),-I[1]),l(v(Ae,se),D[1]))),-P[2])),x(l(x(l(v(He,Z),k[1]),x(l(v(Le,ie),-P[1]),l(v(q,X),D[1]))),I[2]),l(x(l(v(we,W),k[1]),x(l(v(Ae,se),-P[1]),l(v(q,X),I[1]))),-D[2]))),S[3]),l(x(x(l(x(l(v(Oe,Be),P[1]),x(l(v(He,Z),-I[1]),l(v(we,W),D[1]))),S[2]),l(x(l(v(Oe,Be),S[1]),x(l(v(xe,J),-I[1]),l(v(ge,G),D[1]))),-P[2])),x(l(x(l(v(He,Z),S[1]),x(l(v(xe,J),-P[1]),l(v(U,F),D[1]))),I[2]),l(x(l(v(we,W),S[1]),x(l(v(ge,G),-P[1]),l(v(U,F),I[1]))),-D[2]))),-k[3])))),x(x(x(l(x(x(l(x(l(v(Oe,Be),k[1]),x(l(v(Le,ie),-I[1]),l(v(Ae,se),D[1]))),S[2]),l(x(l(v(Oe,Be),S[1]),x(l(v(xe,J),-I[1]),l(v(ge,G),D[1]))),-k[2])),x(l(x(l(v(Le,ie),S[1]),x(l(v(xe,J),-k[1]),l(v(Y,B),D[1]))),I[2]),l(x(l(v(Ae,se),S[1]),x(l(v(ge,G),-k[1]),l(v(Y,B),I[1]))),-D[2]))),P[3]),l(x(x(l(x(l(v(He,Z),k[1]),x(l(v(Le,ie),-P[1]),l(v(q,X),D[1]))),S[2]),l(x(l(v(He,Z),S[1]),x(l(v(xe,J),-P[1]),l(v(U,F),D[1]))),-k[2])),x(l(x(l(v(Le,ie),S[1]),x(l(v(xe,J),-k[1]),l(v(Y,B),D[1]))),P[2]),l(x(l(v(q,X),S[1]),x(l(v(U,F),-k[1]),l(v(Y,B),P[1]))),-D[2]))),-I[3])),x(l(x(x(l(x(l(v(we,W),k[1]),x(l(v(Ae,se),-P[1]),l(v(q,X),I[1]))),S[2]),l(x(l(v(we,W),S[1]),x(l(v(ge,G),-P[1]),l(v(U,F),I[1]))),-k[2])),x(l(x(l(v(Ae,se),S[1]),x(l(v(ge,G),-k[1]),l(v(Y,B),I[1]))),P[2]),l(x(l(v(q,X),S[1]),x(l(v(U,F),-k[1]),l(v(Y,B),P[1]))),-I[2]))),D[3]),l(x(x(l(x(l(v(De,ye),P[1]),x(l(v(we,W),-z[1]),l(v(le,Q),I[1]))),k[2]),l(x(l(v(De,ye),k[1]),x(l(v(Ae,se),-z[1]),l(v(ae,oe),I[1]))),-P[2])),x(l(x(l(v(we,W),k[1]),x(l(v(Ae,se),-P[1]),l(v(q,X),I[1]))),z[2]),l(x(l(v(le,Q),k[1]),x(l(v(ae,oe),-P[1]),l(v(q,X),z[1]))),-I[2]))),S[3]))),x(x(l(x(x(l(x(l(v(De,ye),P[1]),x(l(v(we,W),-z[1]),l(v(le,Q),I[1]))),S[2]),l(x(l(v(De,ye),S[1]),x(l(v(ge,G),-z[1]),l(v(te,V),I[1]))),-P[2])),x(l(x(l(v(we,W),S[1]),x(l(v(ge,G),-P[1]),l(v(U,F),I[1]))),z[2]),l(x(l(v(le,Q),S[1]),x(l(v(te,V),-P[1]),l(v(U,F),z[1]))),-I[2]))),-k[3]),l(x(x(l(x(l(v(De,ye),k[1]),x(l(v(Ae,se),-z[1]),l(v(ae,oe),I[1]))),S[2]),l(x(l(v(De,ye),S[1]),x(l(v(ge,G),-z[1]),l(v(te,V),I[1]))),-k[2])),x(l(x(l(v(Ae,se),S[1]),x(l(v(ge,G),-k[1]),l(v(Y,B),I[1]))),z[2]),l(x(l(v(ae,oe),S[1]),x(l(v(te,V),-k[1]),l(v(Y,B),z[1]))),-I[2]))),P[3])),x(l(x(x(l(x(l(v(we,W),k[1]),x(l(v(Ae,se),-P[1]),l(v(q,X),I[1]))),S[2]),l(x(l(v(we,W),S[1]),x(l(v(ge,G),-P[1]),l(v(U,F),I[1]))),-k[2])),x(l(x(l(v(Ae,se),S[1]),x(l(v(ge,G),-k[1]),l(v(Y,B),I[1]))),P[2]),l(x(l(v(q,X),S[1]),x(l(v(U,F),-k[1]),l(v(Y,B),P[1]))),-I[2]))),-z[3]),l(x(x(l(x(l(v(le,Q),k[1]),x(l(v(ae,oe),-P[1]),l(v(q,X),z[1]))),S[2]),l(x(l(v(le,Q),S[1]),x(l(v(te,V),-P[1]),l(v(U,F),z[1]))),-k[2])),x(l(x(l(v(ae,oe),S[1]),x(l(v(te,V),-k[1]),l(v(Y,B),z[1]))),P[2]),l(x(l(v(q,X),S[1]),x(l(v(U,F),-k[1]),l(v(Y,B),P[1]))),-z[2]))),I[3]))))),vt=v(Pe,Ue);return vt[vt.length-1]}return L}var u=[o,i,g];function _(x){var v=u[x.length];return v||(v=u[x.length]=f(x.length)),v.apply(void 0,x)}function s(x,v,b,l,L,S,k,P){function z(I,D,R,B,F,V){switch(arguments.length){case 0:case 1:return 0;case 2:return l(I,D);case 3:return L(I,D,R);case 4:return S(I,D,R,B);case 5:return k(I,D,R,B,F);case 6:return P(I,D,R,B,F,V)}for(var G=new Array(arguments.length),J=0;J<arguments.length;++J)G[J]=arguments[J];return x(G)}return z}function A(){for(;u.length<=t;)u.push(f(u.length));M.exports=s.apply(void 0,[_].concat(u));for(var x=0;x<=t;++x)M.exports[x]=u[x]}A()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(c,M,T){var e=c("robust-determinant"),a=6;function n(u){var _=u===2?f:u===3?o:u===4?i:u===5?g:p;return u<6?_(e[u]):_(e)}function r(){return[[0]]}function t(u,_){return[[_[0]],[u[0][0]]]}function f(u){return function(s,A){return[u([[+A[0],+s[0][1]],[+A[1],+s[1][1]]]),u([[+s[0][0],+A[0]],[+s[1][0],+A[1]]]),u(s)]}}function o(u){return function(s,A){return[u([[+A[0],+s[0][1],+s[0][2]],[+A[1],+s[1][1],+s[1][2]],[+A[2],+s[2][1],+s[2][2]]]),u([[+s[0][0],+A[0],+s[0][2]],[+s[1][0],+A[1],+s[1][2]],[+s[2][0],+A[2],+s[2][2]]]),u([[+s[0][0],+s[0][1],+A[0]],[+s[1][0],+s[1][1],+A[1]],[+s[2][0],+s[2][1],+A[2]]]),u(s)]}}function i(u){return function(s,A){return[u([[+A[0],+s[0][1],+s[0][2],+s[0][3]],[+A[1],+s[1][1],+s[1][2],+s[1][3]],[+A[2],+s[2][1],+s[2][2],+s[2][3]],[+A[3],+s[3][1],+s[3][2],+s[3][3]]]),u([[+s[0][0],+A[0],+s[0][2],+s[0][3]],[+s[1][0],+A[1],+s[1][2],+s[1][3]],[+s[2][0],+A[2],+s[2][2],+s[2][3]],[+s[3][0],+A[3],+s[3][2],+s[3][3]]]),u([[+s[0][0],+s[0][1],+A[0],+s[0][3]],[+s[1][0],+s[1][1],+A[1],+s[1][3]],[+s[2][0],+s[2][1],+A[2],+s[2][3]],[+s[3][0],+s[3][1],+A[3],+s[3][3]]]),u([[+s[0][0],+s[0][1],+s[0][2],+A[0]],[+s[1][0],+s[1][1],+s[1][2],+A[1]],[+s[2][0],+s[2][1],+s[2][2],+A[2]],[+s[3][0],+s[3][1],+s[3][2],+A[3]]]),u(s)]}}function g(u){return function(s,A){return[u([[+A[0],+s[0][1],+s[0][2],+s[0][3],+s[0][4]],[+A[1],+s[1][1],+s[1][2],+s[1][3],+s[1][4]],[+A[2],+s[2][1],+s[2][2],+s[2][3],+s[2][4]],[+A[3],+s[3][1],+s[3][2],+s[3][3],+s[3][4]],[+A[4],+s[4][1],+s[4][2],+s[4][3],+s[4][4]]]),u([[+s[0][0],+A[0],+s[0][2],+s[0][3],+s[0][4]],[+s[1][0],+A[1],+s[1][2],+s[1][3],+s[1][4]],[+s[2][0],+A[2],+s[2][2],+s[2][3],+s[2][4]],[+s[3][0],+A[3],+s[3][2],+s[3][3],+s[3][4]],[+s[4][0],+A[4],+s[4][2],+s[4][3],+s[4][4]]]),u([[+s[0][0],+s[0][1],+A[0],+s[0][3],+s[0][4]],[+s[1][0],+s[1][1],+A[1],+s[1][3],+s[1][4]],[+s[2][0],+s[2][1],+A[2],+s[2][3],+s[2][4]],[+s[3][0],+s[3][1],+A[3],+s[3][3],+s[3][4]],[+s[4][0],+s[4][1],+A[4],+s[4][3],+s[4][4]]]),u([[+s[0][0],+s[0][1],+s[0][2],+A[0],+s[0][4]],[+s[1][0],+s[1][1],+s[1][2],+A[1],+s[1][4]],[+s[2][0],+s[2][1],+s[2][2],+A[2],+s[2][4]],[+s[3][0],+s[3][1],+s[3][2],+A[3],+s[3][4]],[+s[4][0],+s[4][1],+s[4][2],+A[4],+s[4][4]]]),u([[+s[0][0],+s[0][1],+s[0][2],+s[0][3],+A[0]],[+s[1][0],+s[1][1],+s[1][2],+s[1][3],+A[1]],[+s[2][0],+s[2][1],+s[2][2],+s[2][3],+A[2]],[+s[3][0],+s[3][1],+s[3][2],+s[3][3],+A[3]],[+s[4][0],+s[4][1],+s[4][2],+s[4][3],+A[4]]]),u(s)]}}function p(u){return function(s,A){return[u([[+A[0],+s[0][1],+s[0][2],+s[0][3],+s[0][4],+s[0][5]],[+A[1],+s[1][1],+s[1][2],+s[1][3],+s[1][4],+s[1][5]],[+A[2],+s[2][1],+s[2][2],+s[2][3],+s[2][4],+s[2][5]],[+A[3],+s[3][1],+s[3][2],+s[3][3],+s[3][4],+s[3][5]],[+A[4],+s[4][1],+s[4][2],+s[4][3],+s[4][4],+s[4][5]],[+A[5],+s[5][1],+s[5][2],+s[5][3],+s[5][4],+s[5][5]]]),u([[+s[0][0],+A[0],+s[0][2],+s[0][3],+s[0][4],+s[0][5]],[+s[1][0],+A[1],+s[1][2],+s[1][3],+s[1][4],+s[1][5]],[+s[2][0],+A[2],+s[2][2],+s[2][3],+s[2][4],+s[2][5]],[+s[3][0],+A[3],+s[3][2],+s[3][3],+s[3][4],+s[3][5]],[+s[4][0],+A[4],+s[4][2],+s[4][3],+s[4][4],+s[4][5]],[+s[5][0],+A[5],+s[5][2],+s[5][3],+s[5][4],+s[5][5]]]),u([[+s[0][0],+s[0][1],+A[0],+s[0][3],+s[0][4],+s[0][5]],[+s[1][0],+s[1][1],+A[1],+s[1][3],+s[1][4],+s[1][5]],[+s[2][0],+s[2][1],+A[2],+s[2][3],+s[2][4],+s[2][5]],[+s[3][0],+s[3][1],+A[3],+s[3][3],+s[3][4],+s[3][5]],[+s[4][0],+s[4][1],+A[4],+s[4][3],+s[4][4],+s[4][5]],[+s[5][0],+s[5][1],+A[5],+s[5][3],+s[5][4],+s[5][5]]]),u([[+s[0][0],+s[0][1],+s[0][2],+A[0],+s[0][4],+s[0][5]],[+s[1][0],+s[1][1],+s[1][2],+A[1],+s[1][4],+s[1][5]],[+s[2][0],+s[2][1],+s[2][2],+A[2],+s[2][4],+s[2][5]],[+s[3][0],+s[3][1],+s[3][2],+A[3],+s[3][4],+s[3][5]],[+s[4][0],+s[4][1],+s[4][2],+A[4],+s[4][4],+s[4][5]],[+s[5][0],+s[5][1],+s[5][2],+A[5],+s[5][4],+s[5][5]]]),u([[+s[0][0],+s[0][1],+s[0][2],+s[0][3],+A[0],+s[0][5]],[+s[1][0],+s[1][1],+s[1][2],+s[1][3],+A[1],+s[1][5]],[+s[2][0],+s[2][1],+s[2][2],+s[2][3],+A[2],+s[2][5]],[+s[3][0],+s[3][1],+s[3][2],+s[3][3],+A[3],+s[3][5]],[+s[4][0],+s[4][1],+s[4][2],+s[4][3],+A[4],+s[4][5]],[+s[5][0],+s[5][1],+s[5][2],+s[5][3],+A[5],+s[5][5]]]),u([[+s[0][0],+s[0][1],+s[0][2],+s[0][3],+s[0][4],+A[0]],[+s[1][0],+s[1][1],+s[1][2],+s[1][3],+s[1][4],+A[1]],[+s[2][0],+s[2][1],+s[2][2],+s[2][3],+s[2][4],+A[2]],[+s[3][0],+s[3][1],+s[3][2],+s[3][3],+s[3][4],+A[3]],[+s[4][0],+s[4][1],+s[4][2],+s[4][3],+s[4][4],+A[4]],[+s[5][0],+s[5][1],+s[5][2],+s[5][3],+s[5][4],+A[5]]]),u(s)]}}var y=[r,t];function h(u,_,s,A,x,v,b,l){return function(S,k){switch(S.length){case 0:return u(S,k);case 1:return _(S,k);case 2:return s(S,k);case 3:return A(S,k);case 4:return x(S,k);case 5:return v(S,k)}var P=b[S.length];return P||(P=b[S.length]=l(S.length)),P(S,k)}}function m(){for(;y.length<a;)y.push(n(y.length));M.exports=h.apply(void 0,y.concat([y,n]));for(var u=0;u<a;++u)M.exports[u]=y[u]}m()},{"robust-determinant":280}],284:[function(c,M,T){var e=c("two-product"),a=c("robust-sum"),n=c("robust-scale"),r=c("robust-subtract"),t=5,f=11102230246251565e-32,o=(3+16*f)*f,i=(7+56*f)*f;function g(v,b,l,L){return function(k,P,z){var I=v(v(b(P[1],z[0]),b(-z[1],P[0])),v(b(k[1],P[0]),b(-P[1],k[0]))),D=v(b(k[1],z[0]),b(-z[1],k[0])),R=L(I,D);return R[R.length-1]}}function p(v,b,l,L){return function(k,P,z,I){var D=v(v(l(v(b(z[1],I[0]),b(-I[1],z[0])),P[2]),v(l(v(b(P[1],I[0]),b(-I[1],P[0])),-z[2]),l(v(b(P[1],z[0]),b(-z[1],P[0])),I[2]))),v(l(v(b(P[1],I[0]),b(-I[1],P[0])),k[2]),v(l(v(b(k[1],I[0]),b(-I[1],k[0])),-P[2]),l(v(b(k[1],P[0]),b(-P[1],k[0])),I[2])))),R=v(v(l(v(b(z[1],I[0]),b(-I[1],z[0])),k[2]),v(l(v(b(k[1],I[0]),b(-I[1],k[0])),-z[2]),l(v(b(k[1],z[0]),b(-z[1],k[0])),I[2]))),v(l(v(b(P[1],z[0]),b(-z[1],P[0])),k[2]),v(l(v(b(k[1],z[0]),b(-z[1],k[0])),-P[2]),l(v(b(k[1],P[0]),b(-P[1],k[0])),z[2])))),B=L(D,R);return B[B.length-1]}}function y(v,b,l,L){return function(k,P,z,I,D){var R=v(v(v(l(v(l(v(b(I[1],D[0]),b(-D[1],I[0])),z[2]),v(l(v(b(z[1],D[0]),b(-D[1],z[0])),-I[2]),l(v(b(z[1],I[0]),b(-I[1],z[0])),D[2]))),P[3]),v(l(v(l(v(b(I[1],D[0]),b(-D[1],I[0])),P[2]),v(l(v(b(P[1],D[0]),b(-D[1],P[0])),-I[2]),l(v(b(P[1],I[0]),b(-I[1],P[0])),D[2]))),-z[3]),l(v(l(v(b(z[1],D[0]),b(-D[1],z[0])),P[2]),v(l(v(b(P[1],D[0]),b(-D[1],P[0])),-z[2]),l(v(b(P[1],z[0]),b(-z[1],P[0])),D[2]))),I[3]))),v(l(v(l(v(b(z[1],I[0]),b(-I[1],z[0])),P[2]),v(l(v(b(P[1],I[0]),b(-I[1],P[0])),-z[2]),l(v(b(P[1],z[0]),b(-z[1],P[0])),I[2]))),-D[3]),v(l(v(l(v(b(I[1],D[0]),b(-D[1],I[0])),P[2]),v(l(v(b(P[1],D[0]),b(-D[1],P[0])),-I[2]),l(v(b(P[1],I[0]),b(-I[1],P[0])),D[2]))),k[3]),l(v(l(v(b(I[1],D[0]),b(-D[1],I[0])),k[2]),v(l(v(b(k[1],D[0]),b(-D[1],k[0])),-I[2]),l(v(b(k[1],I[0]),b(-I[1],k[0])),D[2]))),-P[3])))),v(v(l(v(l(v(b(P[1],D[0]),b(-D[1],P[0])),k[2]),v(l(v(b(k[1],D[0]),b(-D[1],k[0])),-P[2]),l(v(b(k[1],P[0]),b(-P[1],k[0])),D[2]))),I[3]),v(l(v(l(v(b(P[1],I[0]),b(-I[1],P[0])),k[2]),v(l(v(b(k[1],I[0]),b(-I[1],k[0])),-P[2]),l(v(b(k[1],P[0]),b(-P[1],k[0])),I[2]))),-D[3]),l(v(l(v(b(z[1],I[0]),b(-I[1],z[0])),P[2]),v(l(v(b(P[1],I[0]),b(-I[1],P[0])),-z[2]),l(v(b(P[1],z[0]),b(-z[1],P[0])),I[2]))),k[3]))),v(l(v(l(v(b(z[1],I[0]),b(-I[1],z[0])),k[2]),v(l(v(b(k[1],I[0]),b(-I[1],k[0])),-z[2]),l(v(b(k[1],z[0]),b(-z[1],k[0])),I[2]))),-P[3]),v(l(v(l(v(b(P[1],I[0]),b(-I[1],P[0])),k[2]),v(l(v(b(k[1],I[0]),b(-I[1],k[0])),-P[2]),l(v(b(k[1],P[0]),b(-P[1],k[0])),I[2]))),z[3]),l(v(l(v(b(P[1],z[0]),b(-z[1],P[0])),k[2]),v(l(v(b(k[1],z[0]),b(-z[1],k[0])),-P[2]),l(v(b(k[1],P[0]),b(-P[1],k[0])),z[2]))),-I[3]))))),B=v(v(v(l(v(l(v(b(I[1],D[0]),b(-D[1],I[0])),z[2]),v(l(v(b(z[1],D[0]),b(-D[1],z[0])),-I[2]),l(v(b(z[1],I[0]),b(-I[1],z[0])),D[2]))),k[3]),l(v(l(v(b(I[1],D[0]),b(-D[1],I[0])),k[2]),v(l(v(b(k[1],D[0]),b(-D[1],k[0])),-I[2]),l(v(b(k[1],I[0]),b(-I[1],k[0])),D[2]))),-z[3])),v(l(v(l(v(b(z[1],D[0]),b(-D[1],z[0])),k[2]),v(l(v(b(k[1],D[0]),b(-D[1],k[0])),-z[2]),l(v(b(k[1],z[0]),b(-z[1],k[0])),D[2]))),I[3]),l(v(l(v(b(z[1],I[0]),b(-I[1],z[0])),k[2]),v(l(v(b(k[1],I[0]),b(-I[1],k[0])),-z[2]),l(v(b(k[1],z[0]),b(-z[1],k[0])),I[2]))),-D[3]))),v(v(l(v(l(v(b(z[1],D[0]),b(-D[1],z[0])),P[2]),v(l(v(b(P[1],D[0]),b(-D[1],P[0])),-z[2]),l(v(b(P[1],z[0]),b(-z[1],P[0])),D[2]))),k[3]),l(v(l(v(b(z[1],D[0]),b(-D[1],z[0])),k[2]),v(l(v(b(k[1],D[0]),b(-D[1],k[0])),-z[2]),l(v(b(k[1],z[0]),b(-z[1],k[0])),D[2]))),-P[3])),v(l(v(l(v(b(P[1],D[0]),b(-D[1],P[0])),k[2]),v(l(v(b(k[1],D[0]),b(-D[1],k[0])),-P[2]),l(v(b(k[1],P[0]),b(-P[1],k[0])),D[2]))),z[3]),l(v(l(v(b(P[1],z[0]),b(-z[1],P[0])),k[2]),v(l(v(b(k[1],z[0]),b(-z[1],k[0])),-P[2]),l(v(b(k[1],P[0]),b(-P[1],k[0])),z[2]))),-D[3])))),F=L(R,B);return F[F.length-1]}}function h(v){var b=v===3?g:v===4?p:y;return b(a,e,n,r)}var m=h(3),u=h(4),_=[function(){return 0},function(){return 0},function(b,l){return l[0]-b[0]},function(b,l,L){var S=(b[1]-L[1])*(l[0]-L[0]),k=(b[0]-L[0])*(l[1]-L[1]),P=S-k,z;if(S>0){if(k<=0)return P;z=S+k}else if(S<0){if(k>=0)return P;z=-(S+k)}else return P;var I=o*z;return P>=I||P<=-I?P:m(b,l,L)},function(b,l,L,S){var k=b[0]-S[0],P=l[0]-S[0],z=L[0]-S[0],I=b[1]-S[1],D=l[1]-S[1],R=L[1]-S[1],B=b[2]-S[2],F=l[2]-S[2],V=L[2]-S[2],G=P*R,J=z*D,j=z*I,Y=k*R,X=k*D,oe=P*I,se=B*(G-J)+F*(j-Y)+V*(X-oe),ie=(Math.abs(G)+Math.abs(J))*Math.abs(B)+(Math.abs(j)+Math.abs(Y))*Math.abs(F)+(Math.abs(X)+Math.abs(oe))*Math.abs(V),N=i*ie;return se>N||-se>N?se:u(b,l,L,S)}];function s(v){var b=_[v.length];return b||(b=_[v.length]=h(v.length)),b.apply(void 0,v)}function A(v,b,l,L,S,k,P){return function(I,D,R,B,F){switch(arguments.length){case 0:case 1:return 0;case 2:return L(I,D);case 3:return S(I,D,R);case 4:return k(I,D,R,B);case 5:return P(I,D,R,B,F)}for(var V=new Array(arguments.length),G=0;G<arguments.length;++G)V[G]=arguments[G];return v(V)}}function x(){for(;_.length<=t;)_.push(h(_.length));M.exports=A.apply(void 0,[s].concat(_));for(var v=0;v<=t;++v)M.exports[v]=_[v]}x()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(c,M,T){var e=c("robust-sum"),a=c("robust-scale");M.exports=n;function n(r,t){if(r.length===1)return a(t,r[0]);if(t.length===1)return a(r,t[0]);if(r.length===0||t.length===0)return[0];var f=[0];if(r.length<t.length)for(var o=0;o<r.length;++o)f=e(f,a(t,r[o]));else for(var o=0;o<t.length;++o)f=e(f,a(r,t[o]));return f}},{"robust-scale":286,"robust-sum":289}],286:[function(c,M,T){var e=c("two-product"),a=c("two-sum");M.exports=n;function n(r,t){var f=r.length;if(f===1){var o=e(r[0],t);return o[0]?o:[o[1]]}var i=new Array(2*f),g=[.1,.1],p=[.1,.1],y=0;e(r[0],t,g),g[0]&&(i[y++]=g[0]);for(var h=1;h<f;++h){e(r[h],t,p);var m=g[1];a(m,p[0],g),g[0]&&(i[y++]=g[0]);var u=p[1],_=g[1],s=u+_,A=s-u,x=_-A;g[1]=s,x&&(i[y++]=x)}return g[1]&&(i[y++]=g[1]),y===0&&(i[y++]=0),i.length=y,i}},{"two-product":306,"two-sum":307}],287:[function(c,M,T){M.exports=n;var e=c("robust-orientation")[3];function a(r,t,f,o){for(var i=0;i<2;++i){var g=r[i],p=t[i],y=Math.min(g,p),h=Math.max(g,p),m=f[i],u=o[i],_=Math.min(m,u),s=Math.max(m,u);if(s<y||h<_)return!1}return!0}function n(r,t,f,o){var i=e(r,f,o),g=e(t,f,o);if(i>0&&g>0||i<0&&g<0)return!1;var p=e(f,r,t),y=e(o,r,t);return p>0&&y>0||p<0&&y<0?!1:i===0&&g===0&&p===0&&y===0?a(r,t,f,o):!0}},{"robust-orientation":284}],288:[function(c,M,T){M.exports=a;function e(n,r){var t=n+r,f=t-n,o=t-f,i=r-f,g=n-o,p=g+i;return p?[p,t]:[t]}function a(n,r){var t=n.length|0,f=r.length|0;if(t===1&&f===1)return e(n[0],-r[0]);var o=t+f,i=new Array(o),g=0,p=0,y=0,h=Math.abs,m=n[p],u=h(m),_=-r[y],s=h(_),A,x;u<s?(x=m,p+=1,p<t&&(m=n[p],u=h(m))):(x=_,y+=1,y<f&&(_=-r[y],s=h(_))),p<t&&u<s||y>=f?(A=m,p+=1,p<t&&(m=n[p],u=h(m))):(A=_,y+=1,y<f&&(_=-r[y],s=h(_)));for(var v=A+x,b=v-A,l=x-b,L=l,S=v,k,P,z,I,D;p<t&&y<f;)u<s?(A=m,p+=1,p<t&&(m=n[p],u=h(m))):(A=_,y+=1,y<f&&(_=-r[y],s=h(_))),x=L,v=A+x,b=v-A,l=x-b,l&&(i[g++]=l),k=S+v,P=k-S,z=k-P,I=v-P,D=S-z,L=D+I,S=k;for(;p<t;)A=m,x=L,v=A+x,b=v-A,l=x-b,l&&(i[g++]=l),k=S+v,P=k-S,z=k-P,I=v-P,D=S-z,L=D+I,S=k,p+=1,p<t&&(m=n[p]);for(;y<f;)A=_,x=L,v=A+x,b=v-A,l=x-b,l&&(i[g++]=l),k=S+v,P=k-S,z=k-P,I=v-P,D=S-z,L=D+I,S=k,y+=1,y<f&&(_=-r[y]);return L&&(i[g++]=L),S&&(i[g++]=S),g||(i[g++]=0),i.length=g,i}},{}],289:[function(c,M,T){M.exports=a;function e(n,r){var t=n+r,f=t-n,o=t-f,i=r-f,g=n-o,p=g+i;return p?[p,t]:[t]}function a(n,r){var t=n.length|0,f=r.length|0;if(t===1&&f===1)return e(n[0],r[0]);var o=t+f,i=new Array(o),g=0,p=0,y=0,h=Math.abs,m=n[p],u=h(m),_=r[y],s=h(_),A,x;u<s?(x=m,p+=1,p<t&&(m=n[p],u=h(m))):(x=_,y+=1,y<f&&(_=r[y],s=h(_))),p<t&&u<s||y>=f?(A=m,p+=1,p<t&&(m=n[p],u=h(m))):(A=_,y+=1,y<f&&(_=r[y],s=h(_)));for(var v=A+x,b=v-A,l=x-b,L=l,S=v,k,P,z,I,D;p<t&&y<f;)u<s?(A=m,p+=1,p<t&&(m=n[p],u=h(m))):(A=_,y+=1,y<f&&(_=r[y],s=h(_))),x=L,v=A+x,b=v-A,l=x-b,l&&(i[g++]=l),k=S+v,P=k-S,z=k-P,I=v-P,D=S-z,L=D+I,S=k;for(;p<t;)A=m,x=L,v=A+x,b=v-A,l=x-b,l&&(i[g++]=l),k=S+v,P=k-S,z=k-P,I=v-P,D=S-z,L=D+I,S=k,p+=1,p<t&&(m=n[p]);for(;y<f;)A=_,x=L,v=A+x,b=v-A,l=x-b,l&&(i[g++]=l),k=S+v,P=k-S,z=k-P,I=v-P,D=S-z,L=D+I,S=k,y+=1,y<f&&(_=r[y]);return L&&(i[g++]=L),S&&(i[g++]=S),g||(i[g++]=0),i.length=g,i}},{}],290:[function(c,M,T){M.exports=n;var e=c("boundary-cells"),a=c("reduce-simplicial-complex");function n(r){return a(e(r))}},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(c,M,T){M.exports=y;var e=c("ndarray"),a=c("typedarray-pool"),n=c("ndarray-sort"),r=c("./lib/codegen");function t(h){for(var m=h.length,u=0,_=0;_<m;++_)u=Math.max(u,h[_].length)|0;return u-1}function f(h,m){for(var u=h.length,_=a.mallocUint8(u),s=0;s<u;++s)_[s]=h[s]<m|0;return _}function o(h,m){for(var u=h.length,_=m*(m+1)/2*u|0,s=a.mallocUint32(_*2),A=0,x=0;x<u;++x)for(var v=h[x],m=v.length,b=0;b<m;++b)for(var l=0;l<b;++l){var L=v[l],S=v[b];s[A++]=Math.min(L,S)|0,s[A++]=Math.max(L,S)|0}var k=A/2|0;n(e(s,[k,2]));for(var P=2,x=2;x<A;x+=2)s[x-2]===s[x]&&s[x-1]===s[x+1]||(s[P++]=s[x],s[P++]=s[x+1]);return e(s,[P/2|0,2])}function i(h,m,u,_){for(var s=h.data,A=h.shape[0],x=a.mallocDouble(A),v=0,b=0;b<A;++b){var l=s[2*b],L=s[2*b+1];if(u[l]!==u[L]){var S=m[l],k=m[L];s[2*v]=l,s[2*v+1]=L,x[v++]=(k-_)/(k-S)}}return h.shape[0]=v,e(x,[v])}function g(h,m){var u=a.mallocInt32(m*2),_=h.shape[0],s=h.data;u[0]=0;for(var A=0,x=0;x<_;++x){var v=s[2*x];if(v!==A){for(u[2*A+1]=x;++A<v;)u[2*A]=x,u[2*A+1]=x;u[2*A]=x}}for(u[2*A+1]=_;++A<m;)u[2*A]=u[2*A+1]=_;return u}function p(h){for(var m=h.shape[0]|0,u=h.data,_=new Array(m),s=0;s<m;++s)_[s]=[u[2*s],u[2*s+1]];return _}function y(h,m,u,_){u=u||0,typeof _=="undefined"&&(_=t(h));var s=h.length;if(s===0||_<1)return{cells:[],vertexIds:[],vertexWeights:[]};var A=f(m,+u),x=o(h,_),v=i(x,m,A,+u),b=g(x,m.length|0),l=r(_)(h,x.data,b,A),L=p(x),S=[].slice.call(v.data,0,v.shape[0]);return a.free(A),a.free(x.data),a.free(v.data),a.free(b),{cells:l,vertexIds:L,vertexWeights:S}}},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(c,M,T){M.exports=a;var e=[function(){function r(t,f,o,i){for(var g=t.length,p=[],y=0;y<g;++y){var h=t[y];h.length}return p}return r},function(){function r(f,o,i,g){for(var p=Math.min(i,g)|0,y=Math.max(i,g)|0,h=f[2*p],m=f[2*p+1];h<m;){var u=h+m>>1,_=o[2*u+1];if(_===y)return u;y<_?m=u:h=u+1}return h}function t(f,o,i,g){for(var p=f.length,y=[],h=0;h<p;++h){var m=f[h],u=m.length;if(u===2){var _=(g[m[0]]<<0)+(g[m[1]]<<1);if(_===0||_===3)continue;switch(_){case 0:break;case 1:y.push([r(i,o,m[0],m[1])]);break;case 2:y.push([r(i,o,m[1],m[0])]);break}}}return y}return t},function(){function r(f,o,i,g){for(var p=Math.min(i,g)|0,y=Math.max(i,g)|0,h=f[2*p],m=f[2*p+1];h<m;){var u=h+m>>1,_=o[2*u+1];if(_===y)return u;y<_?m=u:h=u+1}return h}function t(f,o,i,g){for(var p=f.length,y=[],h=0;h<p;++h){var m=f[h],u=m.length;if(u===3){var _=(g[m[0]]<<0)+(g[m[1]]<<1)+(g[m[2]]<<2);if(_===0||_===7)continue;switch(_){case 0:break;case 1:y.push([r(i,o,m[0],m[2]),r(i,o,m[0],m[1])]);break;case 2:y.push([r(i,o,m[1],m[0]),r(i,o,m[1],m[2])]);break;case 3:y.push([r(i,o,m[0],m[2]),r(i,o,m[1],m[2])]);break;case 4:y.push([r(i,o,m[2],m[1]),r(i,o,m[2],m[0])]);break;case 5:y.push([r(i,o,m[2],m[1]),r(i,o,m[0],m[1])]);break;case 6:y.push([r(i,o,m[1],m[0]),r(i,o,m[2],m[0])]);break}}else if(u===2){var _=(g[m[0]]<<0)+(g[m[1]]<<1);if(_===0||_===3)continue;switch(_){case 0:break;case 1:y.push([r(i,o,m[0],m[1])]);break;case 2:y.push([r(i,o,m[1],m[0])]);break}}}return y}return t},function(){function r(f,o,i,g){for(var p=Math.min(i,g)|0,y=Math.max(i,g)|0,h=f[2*p],m=f[2*p+1];h<m;){var u=h+m>>1,_=o[2*u+1];if(_===y)return u;y<_?m=u:h=u+1}return h}function t(f,o,i,g){for(var p=f.length,y=[],h=0;h<p;++h){var m=f[h],u=m.length;if(u===4){var _=(g[m[0]]<<0)+(g[m[1]]<<1)+(g[m[2]]<<2)+(g[m[3]]<<3);if(_===0||_===15)continue;switch(_){case 0:break;case 1:y.push([r(i,o,m[0],m[1]),r(i,o,m[0],m[2]),r(i,o,m[0],m[3])]);break;case 2:y.push([r(i,o,m[1],m[2]),r(i,o,m[1],m[0]),r(i,o,m[1],m[3])]);break;case 3:y.push([r(i,o,m[1],m[2]),r(i,o,m[0],m[2]),r(i,o,m[0],m[3])],[r(i,o,m[1],m[3]),r(i,o,m[1],m[2]),r(i,o,m[0],m[3])]);break;case 4:y.push([r(i,o,m[2],m[0]),r(i,o,m[2],m[1]),r(i,o,m[2],m[3])]);break;case 5:y.push([r(i,o,m[0],m[1]),r(i,o,m[2],m[1]),r(i,o,m[0],m[3])],[r(i,o,m[2],m[1]),r(i,o,m[2],m[3]),r(i,o,m[0],m[3])]);break;case 6:y.push([r(i,o,m[2],m[0]),r(i,o,m[1],m[0]),r(i,o,m[1],m[3])],[r(i,o,m[2],m[3]),r(i,o,m[2],m[0]),r(i,o,m[1],m[3])]);break;case 7:y.push([r(i,o,m[0],m[3]),r(i,o,m[1],m[3]),r(i,o,m[2],m[3])]);break;case 8:y.push([r(i,o,m[3],m[1]),r(i,o,m[3],m[0]),r(i,o,m[3],m[2])]);break;case 9:y.push([r(i,o,m[3],m[1]),r(i,o,m[0],m[1]),r(i,o,m[0],m[2])],[r(i,o,m[3],m[2]),r(i,o,m[3],m[1]),r(i,o,m[0],m[2])]);break;case 10:y.push([r(i,o,m[1],m[0]),r(i,o,m[3],m[0]),r(i,o,m[1],m[2])],[r(i,o,m[3],m[0]),r(i,o,m[3],m[2]),r(i,o,m[1],m[2])]);break;case 11:y.push([r(i,o,m[1],m[2]),r(i,o,m[0],m[2]),r(i,o,m[3],m[2])]);break;case 12:y.push([r(i,o,m[3],m[0]),r(i,o,m[2],m[0]),r(i,o,m[2],m[1])],[r(i,o,m[3],m[1]),r(i,o,m[3],m[0]),r(i,o,m[2],m[1])]);break;case 13:y.push([r(i,o,m[0],m[1]),r(i,o,m[2],m[1]),r(i,o,m[3],m[1])]);break;case 14:y.push([r(i,o,m[2],m[0]),r(i,o,m[1],m[0]),r(i,o,m[3],m[0])]);break}}else if(u===3){var _=(g[m[0]]<<0)+(g[m[1]]<<1)+(g[m[2]]<<2);if(_===0||_===7)continue;switch(_){case 0:break;case 1:y.push([r(i,o,m[0],m[2]),r(i,o,m[0],m[1])]);break;case 2:y.push([r(i,o,m[1],m[0]),r(i,o,m[1],m[2])]);break;case 3:y.push([r(i,o,m[0],m[2]),r(i,o,m[1],m[2])]);break;case 4:y.push([r(i,o,m[2],m[1]),r(i,o,m[2],m[0])]);break;case 5:y.push([r(i,o,m[2],m[1]),r(i,o,m[0],m[1])]);break;case 6:y.push([r(i,o,m[1],m[0]),r(i,o,m[2],m[0])]);break}}else if(u===2){var _=(g[m[0]]<<0)+(g[m[1]]<<1);if(_===0||_===3)continue;switch(_){case 0:break;case 1:y.push([r(i,o,m[0],m[1])]);break;case 2:y.push([r(i,o,m[1],m[0])]);break}}}return y}return t}];function a(n){return e[n]()}},{}],293:[function(c,M,T){var e=c("bit-twiddle"),a=c("union-find");function n(v){for(var b=0,l=Math.max,L=0,S=v.length;L<S;++L)b=l(b,v[L].length);return b-1}T.dimension=n;function r(v){for(var b=-1,l=Math.max,L=0,S=v.length;L<S;++L)for(var k=v[L],P=0,z=k.length;P<z;++P)b=l(b,k[P]);return b+1}T.countVertices=r;function t(v){for(var b=new Array(v.length),l=0,L=v.length;l<L;++l)b[l]=v[l].slice(0);return b}T.cloneCells=t;function f(v,b){var l=v.length,L=v.length-b.length,S=Math.min;if(L)return L;switch(l){case 0:return 0;case 1:return v[0]-b[0];case 2:var D=v[0]+v[1]-b[0]-b[1];return D||S(v[0],v[1])-S(b[0],b[1]);case 3:var k=v[0]+v[1],P=b[0]+b[1];if(D=k+v[2]-(P+b[2]),D)return D;var z=S(v[0],v[1]),I=S(b[0],b[1]),D=S(z,v[2])-S(I,b[2]);return D||S(z+v[2],k)-S(I+b[2],P);default:var R=v.slice(0);R.sort();var B=b.slice(0);B.sort();for(var F=0;F<l;++F)if(L=R[F]-B[F],L)return L;return 0}}T.compareCells=f;function o(v,b){return f(v[0],b[0])}function i(v,b){if(b){for(var l=v.length,L=new Array(l),S=0;S<l;++S)L[S]=[v[S],b[S]];L.sort(o);for(var S=0;S<l;++S)v[S]=L[S][0],b[S]=L[S][1];return v}else return v.sort(f),v}T.normalize=i;function g(v){if(v.length===0)return[];for(var b=1,l=v.length,L=1;L<l;++L){var S=v[L];if(f(S,v[L-1])){if(L===b){b++;continue}v[b++]=S}}return v.length=b,v}T.unique=g;function p(v,b){for(var l=0,L=v.length-1,S=-1;l<=L;){var k=l+L>>1,P=f(v[k],b);P<=0?(P===0&&(S=k),l=k+1):P>0&&(L=k-1)}return S}T.findCell=p;function y(v,b){for(var l=new Array(v.length),L=0,S=l.length;L<S;++L)l[L]=[];for(var k=[],L=0,P=b.length;L<P;++L)for(var z=b[L],I=z.length,D=1,R=1<<I;D<R;++D){k.length=e.popCount(D);for(var B=0,F=0;F<I;++F)D&1<<F&&(k[B++]=z[F]);var V=p(v,k);if(!(V<0))for(;l[V++].push(L),!(V>=v.length||f(v[V],k)!==0););}return l}T.incidence=y;function h(v,b){if(!b)return y(g(u(v,0)),v);for(var l=new Array(b),L=0;L<b;++L)l[L]=[];for(var L=0,S=v.length;L<S;++L)for(var k=v[L],P=0,z=k.length;P<z;++P)l[k[P]].push(L);return l}T.dual=h;function m(v){for(var b=[],l=0,L=v.length;l<L;++l)for(var S=v[l],k=S.length|0,P=1,z=1<<k;P<z;++P){for(var I=[],D=0;D<k;++D)P>>>D&1&&I.push(S[D]);b.push(I)}return i(b)}T.explode=m;function u(v,b){if(b<0)return[];for(var l=[],L=(1<<b+1)-1,S=0;S<v.length;++S)for(var k=v[S],P=L;P<1<<k.length;P=e.nextCombination(P)){for(var z=new Array(b+1),I=0,D=0;D<k.length;++D)P&1<<D&&(z[I++]=k[D]);l.push(z)}return i(l)}T.skeleton=u;function _(v){for(var b=[],l=0,L=v.length;l<L;++l)for(var S=v[l],k=0,P=S.length;k<P;++k){for(var z=new Array(S.length-1),I=0,D=0;I<P;++I)I!==k&&(z[D++]=S[I]);b.push(z)}return i(b)}T.boundary=_;function s(v,b){for(var l=new a(b),L=0;L<v.length;++L)for(var S=v[L],k=0;k<S.length;++k)for(var P=k+1;P<S.length;++P)l.link(S[k],S[P]);for(var z=[],I=l.ranks,L=0;L<I.length;++L)I[L]=-1;for(var L=0;L<v.length;++L){var D=l.find(v[L][0]);I[D]<0?(I[D]=z.length,z.push([v[L].slice(0)])):z[I[D]].push(v[L].slice(0))}return z}function A(v){for(var b=g(i(u(v,0))),l=new a(b.length),L=0;L<v.length;++L)for(var S=v[L],k=0;k<S.length;++k)for(var P=p(b,[S[k]]),z=k+1;z<S.length;++z)l.link(P,p(b,[S[z]]));for(var I=[],D=l.ranks,L=0;L<D.length;++L)D[L]=-1;for(var L=0;L<v.length;++L){var R=l.find(p(b,[v[L][0]]));D[R]<0?(D[R]=I.length,I.push([v[L].slice(0)])):I[D[R]].push(v[L].slice(0))}return I}function x(v,b){return b?s(v,b):A(v)}T.connectedComponents=x},{"bit-twiddle":32,"union-find":309}],294:[function(c,M,T){arguments[4][32][0].apply(T,arguments)},{dup:32}],295:[function(c,M,T){arguments[4][293][0].apply(T,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(c,M,T){M.exports=e;function e(a){this.roots=new Array(a),this.ranks=new Array(a);for(var n=0;n<a;++n)this.roots[n]=n,this.ranks[n]=0}e.prototype.length=function(){return this.roots.length},e.prototype.makeSet=function(){var a=this.roots.length;return this.roots.push(a),this.ranks.push(0),a},e.prototype.find=function(a){for(var n=this.roots;n[a]!==a;){var r=n[a];n[a]=n[r],a=r}return a},e.prototype.link=function(a,n){var r=this.find(a),t=this.find(n);if(r!==t){var f=this.ranks,o=this.roots,i=f[r],g=f[t];i<g?o[r]=t:g<i?o[t]=r:(o[t]=r,++f[r])}}},{}],297:[function(c,M,T){M.exports=r;var e=c("robust-orientation"),a=c("simplicial-complex");function n(t,f,o){var i=Math.abs(e(t,f,o)),g=Math.sqrt(Math.pow(f[0]-o[0],2)+Math.pow(f[1]-o[1],2));return i/g}function r(t,f,o){for(var i=f.length,g=t.length,p=new Array(i),y=new Array(i),h=new Array(i),m=new Array(i),u=0;u<i;++u)p[u]=y[u]=-1,h[u]=1/0,m[u]=!1;for(var u=0;u<g;++u){var _=t[u];if(_.length!==2)throw new Error("Input must be a graph");var s=_[1],A=_[0];y[A]!==-1?y[A]=-2:y[A]=s,p[s]!==-1?p[s]=-2:p[s]=A}function x(j){if(m[j])return 1/0;var Y=p[j],X=y[j];return Y<0||X<0?1/0:n(f[j],f[Y],f[X])}function v(j,Y){var X=I[j],oe=I[Y];I[j]=oe,I[Y]=X,D[X]=Y,D[oe]=j}function b(j){return h[I[j]]}function l(j){return j&1?j-1>>1:(j>>1)-1}function L(j){for(var Y=b(j);;){var X=Y,oe=2*j+1,se=2*(j+1),ie=j;if(oe<B){var N=b(oe);N<X&&(ie=oe,X=N)}if(se<B){var U=b(se);U<X&&(ie=se)}if(ie===j)return j;v(j,ie),j=ie}}function S(j){for(var Y=b(j);j>0;){var X=l(j);if(X>=0){var oe=b(X);if(Y<oe){v(j,X),j=X;continue}}return j}}function k(){if(B>0){var j=I[0];return v(0,B-1),B-=1,L(0),j}return-1}function P(j,Y){var X=I[j];return h[X]===Y?j:(h[X]=-1/0,S(j),k(),h[X]=Y,B+=1,S(B-1))}function z(j){if(!m[j]){m[j]=!0;var Y=p[j],X=y[j];p[X]>=0&&(p[X]=Y),y[Y]>=0&&(y[Y]=X),D[Y]>=0&&P(D[Y],x(Y)),D[X]>=0&&P(D[X],x(X))}}for(var I=[],D=new Array(i),u=0;u<i;++u){var R=h[u]=x(u);R<1/0?(D[u]=I.length,I.push(u)):D[u]=-1}for(var B=I.length,u=B>>1;u>=0;--u)L(u);for(;;){var F=k();if(F<0||h[F]>o)break;z(F)}for(var V=[],u=0;u<i;++u)m[u]||(D[u]=V.length,V.push(f[u].slice()));V.length;function G(j,Y){if(j[Y]<0)return Y;var X=Y,oe=Y;do{var se=j[oe];if(!m[oe]||se<0||se===oe||(oe=se,se=j[oe],!m[oe]||se<0||se===oe))break;oe=se,X=j[X]}while(X!==oe);for(var ie=Y;ie!==oe;ie=j[ie])j[ie]=oe;return oe}var J=[];return t.forEach(function(j){var Y=G(p,j[0]),X=G(y,j[1]);if(Y>=0&&X>=0&&Y!==X){var oe=D[Y],se=D[X];oe!==se&&J.push([oe,se])}}),a.unique(a.normalize(J)),{positions:V,edges:J}}},{"robust-orientation":284,"simplicial-complex":295}],298:[function(c,M,T){M.exports=n;var e=c("robust-orientation");function a(r,t){var f,o;if(t[0][0]<t[1][0])f=t[0],o=t[1];else if(t[0][0]>t[1][0])f=t[1],o=t[0];else{var i=Math.min(r[0][1],r[1][1]),g=Math.max(r[0][1],r[1][1]),p=Math.min(t[0][1],t[1][1]),y=Math.max(t[0][1],t[1][1]);return g<p?g-p:i>y?i-y:g-y}var h,m;r[0][1]<r[1][1]?(h=r[0],m=r[1]):(h=r[1],m=r[0]);var u=e(o,f,h);return u||(u=e(o,f,m),u)?u:m-o}function n(r,t){var f,o;if(t[0][0]<t[1][0])f=t[0],o=t[1];else if(t[0][0]>t[1][0])f=t[1],o=t[0];else return a(t,r);var i,g;if(r[0][0]<r[1][0])i=r[0],g=r[1];else if(r[0][0]>r[1][0])i=r[1],g=r[0];else return-a(r,t);var p=e(f,o,g),y=e(f,o,i);if(p<0){if(y<=0)return p}else if(p>0){if(y>=0)return p}else if(y)return y;if(p=e(g,i,o),y=e(g,i,f),p<0){if(y<=0)return p}else if(p>0){if(y>=0)return p}else if(y)return y;return o[0]-g[0]}},{"robust-orientation":284}],299:[function(c,M,T){M.exports=y;var e=c("binary-search-bounds"),a=c("functional-red-black-tree"),n=c("robust-orientation"),r=c("./lib/order-segments");function t(h,m,u){this.slabs=h,this.coordinates=m,this.horizontal=u}var f=t.prototype;function o(h,m){return h.y-m}function i(h,m){for(var u=null;h;){var _=h.key,s,A;_[0][0]<_[1][0]?(s=_[0],A=_[1]):(s=_[1],A=_[0]);var x=n(s,A,m);if(x<0)h=h.left;else if(x>0)if(m[0]!==_[1][0])u=h,h=h.right;else{var v=i(h.right,m);if(v)return v;h=h.left}else{if(m[0]!==_[1][0])return h;var v=i(h.right,m);if(v)return v;h=h.left}}return u}f.castUp=function(h){var m=e.le(this.coordinates,h[0]);if(m<0)return-1;this.slabs[m];var u=i(this.slabs[m],h),_=-1;if(u&&(_=u.value),this.coordinates[m]===h[0]){var s=null;if(u&&(s=u.key),m>0){var A=i(this.slabs[m-1],h);A&&(s?r(A.key,s)>0&&(s=A.key,_=A.value):(_=A.value,s=A.key))}var x=this.horizontal[m];if(x.length>0){var v=e.ge(x,h[1],o);if(v<x.length){var b=x[v];if(h[1]===b.y){if(b.closed)return b.index;for(;v<x.length-1&&x[v+1].y===h[1];)if(v=v+1,b=x[v],b.closed)return b.index;if(b.y===h[1]&&!b.start){if(v=v+1,v>=x.length)return _;b=x[v]}}if(b.start)if(s){var l=n(s[0],s[1],[h[0],b.y]);s[0][0]>s[1][0]&&(l=-l),l>0&&(_=b.index)}else _=b.index;else b.y!==h[1]&&(_=b.index)}}}return _};function g(h,m,u,_){this.y=h,this.index=m,this.start=u,this.closed=_}function p(h,m,u,_){this.x=h,this.segment=m,this.create=u,this.index=_}function y(h){for(var m=h.length,u=2*m,_=new Array(u),s=0;s<m;++s){var A=h[s],x=A[0][0]<A[1][0];_[2*s]=new p(A[0][0],A,x,s),_[2*s+1]=new p(A[1][0],A,!x,s)}_.sort(function(z,I){var D=z.x-I.x;return D||(D=z.create-I.create,D)?D:Math.min(z.segment[0][1],z.segment[1][1])-Math.min(I.segment[0][1],I.segment[1][1])});for(var v=a(r),b=[],l=[],L=[],s=0;s<u;){for(var S=_[s].x,k=[];s<u;){var P=_[s];if(P.x!==S)break;s+=1,P.segment[0][0]===P.x&&P.segment[1][0]===P.x?P.create&&(P.segment[0][1]<P.segment[1][1]?(k.push(new g(P.segment[0][1],P.index,!0,!0)),k.push(new g(P.segment[1][1],P.index,!1,!1))):(k.push(new g(P.segment[1][1],P.index,!0,!1)),k.push(new g(P.segment[0][1],P.index,!1,!0)))):P.create?v=v.insert(P.segment,P.index):v=v.remove(P.segment)}b.push(v.root),l.push(S),L.push(k)}return new t(b,l,L)}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(c,M,T){var e=c("robust-dot-product"),a=c("robust-sum");M.exports=t,M.exports.positive=f,M.exports.negative=o;function n(i,g){var p=a(e(i,g),[g[g.length-1]]);return p[p.length-1]}function r(i,g,p,y){var h=y-g,m=-g/h;m<0?m=0:m>1&&(m=1);for(var u=1-m,_=i.length,s=new Array(_),A=0;A<_;++A)s[A]=m*i[A]+u*p[A];return s}function t(i,g){for(var p=[],y=[],h=n(i[i.length-1],g),m=i[i.length-1],u=i[0],_=0;_<i.length;++_,m=u){u=i[_];var s=n(u,g);if(h<0&&s>0||h>0&&s<0){var A=r(m,s,u,h);p.push(A),y.push(A.slice())}s<0?y.push(u.slice()):s>0?p.push(u.slice()):(p.push(u.slice()),y.push(u.slice())),h=s}return{positive:p,negative:y}}function f(i,g){for(var p=[],y=n(i[i.length-1],g),h=i[i.length-1],m=i[0],u=0;u<i.length;++u,h=m){m=i[u];var _=n(m,g);(y<0&&_>0||y>0&&_<0)&&p.push(r(h,_,m,y)),_>=0&&p.push(m.slice()),y=_}return p}function o(i,g){for(var p=[],y=n(i[i.length-1],g),h=i[i.length-1],m=i[0],u=0;u<i.length;++u,h=m){m=i[u];var _=n(m,g);(y<0&&_>0||y>0&&_<0)&&p.push(r(h,_,m,y)),_<=0&&p.push(m.slice()),y=_}return p}},{"robust-dot-product":281,"robust-sum":289}],301:[function(c,M,T){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function a(o){return r(f(o),arguments)}function n(o,i){return a.apply(null,[o].concat(i||[]))}function r(o,i){var g=1,p=o.length,y,h="",m,u,_,s,A,x,v,b;for(m=0;m<p;m++)if(typeof o[m]=="string")h+=o[m];else if(typeof o[m]=="object"){if(_=o[m],_.keys)for(y=i[g],u=0;u<_.keys.length;u++){if(y==null)throw new Error(a('[sprintf] Cannot access property "%s" of undefined value "%s"',_.keys[u],_.keys[u-1]));y=y[_.keys[u]]}else _.param_no?y=i[_.param_no]:y=i[g++];if(e.not_type.test(_.type)&&e.not_primitive.test(_.type)&&y instanceof Function&&(y=y()),e.numeric_arg.test(_.type)&&typeof y!="number"&&isNaN(y))throw new TypeError(a("[sprintf] expecting number but found %T",y));switch(e.number.test(_.type)&&(v=y>=0),_.type){case"b":y=parseInt(y,10).toString(2);break;case"c":y=String.fromCharCode(parseInt(y,10));break;case"d":case"i":y=parseInt(y,10);break;case"j":y=JSON.stringify(y,null,_.width?parseInt(_.width):0);break;case"e":y=_.precision?parseFloat(y).toExponential(_.precision):parseFloat(y).toExponential();break;case"f":y=_.precision?parseFloat(y).toFixed(_.precision):parseFloat(y);break;case"g":y=_.precision?String(Number(y.toPrecision(_.precision))):parseFloat(y);break;case"o":y=(parseInt(y,10)>>>0).toString(8);break;case"s":y=String(y),y=_.precision?y.substring(0,_.precision):y;break;case"t":y=String(!!y),y=_.precision?y.substring(0,_.precision):y;break;case"T":y=Object.prototype.toString.call(y).slice(8,-1).toLowerCase(),y=_.precision?y.substring(0,_.precision):y;break;case"u":y=parseInt(y,10)>>>0;break;case"v":y=y.valueOf(),y=_.precision?y.substring(0,_.precision):y;break;case"x":y=(parseInt(y,10)>>>0).toString(16);break;case"X":y=(parseInt(y,10)>>>0).toString(16).toUpperCase();break}e.json.test(_.type)?h+=y:(e.number.test(_.type)&&(!v||_.sign)?(b=v?"+":"-",y=y.toString().replace(e.sign,"")):b="",A=_.pad_char?_.pad_char==="0"?"0":_.pad_char.charAt(1):" ",x=_.width-(b+y).length,s=_.width&&x>0?A.repeat(x):"",h+=_.align?b+y+s:A==="0"?b+s+y:s+b+y)}return h}var t=Object.create(null);function f(o){if(t[o])return t[o];for(var i=o,g,p=[],y=0;i;){if((g=e.text.exec(i))!==null)p.push(g[0]);else if((g=e.modulo.exec(i))!==null)p.push("%");else if((g=e.placeholder.exec(i))!==null){if(g[2]){y|=1;var h=[],m=g[2],u=[];if((u=e.key.exec(m))!==null)for(h.push(u[1]);(m=m.substring(u[0].length))!=="";)if((u=e.key_access.exec(m))!==null)h.push(u[1]);else if((u=e.index_access.exec(m))!==null)h.push(u[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");g[2]=h}else y|=2;if(y===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");p.push({placeholder:g[0],param_no:g[1],keys:g[2],sign:g[3],pad_char:g[4],align:g[5],width:g[6],precision:g[7],type:g[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");i=i.substring(g[0].length)}return t[o]=p}typeof T!="undefined"&&(T.sprintf=a,T.vsprintf=n),typeof window!="undefined"&&(window.sprintf=a,window.vsprintf=n)})()},{}],302:[function(c,M,T){M.exports=o;var e=c("ndarray-extract-contour"),a=c("zero-crossings"),n={"2d":function(i,g,p){var y=i({order:g,scalarArguments:3,getters:p==="generic"?[0]:void 0,phase:function(m,u,_,s){return m>s|0},vertex:function(m,u,_,s,A,x,v,b,l,L,S,k,P){var z=(v<<0)+(b<<1)+(l<<2)+(L<<3)|0;if(!(z===0||z===15))switch(z){case 0:S.push([m-.5,u-.5]);break;case 1:S.push([m-.25-.25*(s+_-2*P)/(_-s),u-.25-.25*(A+_-2*P)/(_-A)]);break;case 2:S.push([m-.75-.25*(-s-_+2*P)/(s-_),u-.25-.25*(x+s-2*P)/(s-x)]);break;case 3:S.push([m-.5,u-.5-.5*(A+_+x+s-4*P)/(_-A+s-x)]);break;case 4:S.push([m-.25-.25*(x+A-2*P)/(A-x),u-.75-.25*(-A-_+2*P)/(A-_)]);break;case 5:S.push([m-.5-.5*(s+_+x+A-4*P)/(_-s+A-x),u-.5]);break;case 6:S.push([m-.5-.25*(-s-_+x+A)/(s-_+A-x),u-.5-.25*(-A-_+x+s)/(A-_+s-x)]);break;case 7:S.push([m-.75-.25*(x+A-2*P)/(A-x),u-.75-.25*(x+s-2*P)/(s-x)]);break;case 8:S.push([m-.75-.25*(-x-A+2*P)/(x-A),u-.75-.25*(-x-s+2*P)/(x-s)]);break;case 9:S.push([m-.5-.25*(s+_+-x-A)/(_-s+x-A),u-.5-.25*(A+_+-x-s)/(_-A+x-s)]);break;case 10:S.push([m-.5-.5*(-s-_+-x-A+4*P)/(s-_+x-A),u-.5]);break;case 11:S.push([m-.25-.25*(-x-A+2*P)/(x-A),u-.75-.25*(A+_-2*P)/(_-A)]);break;case 12:S.push([m-.5,u-.5-.5*(-A-_+-x-s+4*P)/(A-_+x-s)]);break;case 13:S.push([m-.75-.25*(s+_-2*P)/(_-s),u-.25-.25*(-x-s+2*P)/(x-s)]);break;case 14:S.push([m-.25-.25*(-s-_+2*P)/(s-_),u-.25-.25*(-A-_+2*P)/(A-_)]);break;case 15:S.push([m-.5,u-.5]);break}},cell:function(m,u,_,s,A,x,v,b,l){A?b.push([m,u]):b.push([u,m])}});return function(h,m){var u=[],_=[];return y(h,u,_,m),{positions:u,cells:_}}}};function r(i,g){var p=i.length+"d",y=n[p];if(y)return y(e,i,g)}function t(i,g){for(var p=a(i,g),y=p.length,h=new Array(y),m=new Array(y),u=0;u<y;++u)h[u]=[p[u]],m[u]=[u];return{positions:h,cells:m}}var f={};function o(i,h){if(i.dimension<=0)return{positions:[],cells:[]};if(i.dimension===1)return t(i,h);var p=i.order.join()+"-"+i.dtype,y=f[p],h=+h||0;return y||(y=f[p]=r(i.order,i.dtype)),y(i,h)}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(c,M,T){(function(e){(function(){M.exports=f;var a=c("vectorize-text"),n=window||e.global||{},r=n.__TEXT_CACHE||{};n.__TEXT_CACHE={};function t(o){for(var i=o.cells,g=o.positions,p=new Float32Array(i.length*6),y=0,h=0,m=0;m<i.length;++m)for(var u=i[m],_=0;_<3;++_){var s=g[u[_]];p[y++]=s[0],p[y++]=s[1]+1.4,h=Math.max(s[0],h)}return{data:p,shape:h}}function f(o,i,p){var p=p||{},y=r[o];y||(y=r[o]={" ":{data:new Float32Array(0),shape:.2}});var h=y[i];if(!h)if(i.length<=1||!/\d/.test(i))h=y[i]=t(a(i,{triangles:!0,font:o,textAlign:p.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var m=i.split(/(\d|\s)/),u=new Array(m.length),_=0,s=0,A=0;A<m.length;++A)u[A]=f(o,m[A]),_+=u[A].data.length,s+=u[A].shape,A>0&&(s+=.02);for(var x=new Float32Array(_),v=0,b=-.5*s,A=0;A<u.length;++A){for(var l=u[A].data,L=0;L<l.length;L+=2)x[v++]=l[L]+b,x[v++]=l[L+1];b+=u[A].shape+.02}h=y[i]={data:x,shape:s}}return h}}).call(this)}).call(this,c("_process"))},{_process:5,"vectorize-text":311}],304:[function(c,M,T){var e=c("parse-unit");M.exports=t;var a=96;function n(f,o){var i=e(getComputedStyle(f).getPropertyValue(o));return i[0]*t(i[1],f)}function r(f,o){var i=document.createElement("div");i.style["font-size"]="128"+f,o.appendChild(i);var g=n(i,"font-size")/128;return o.removeChild(i),g}function t(f,o){switch(o=o||document.body,f=(f||"px").trim().toLowerCase(),(o===window||o===document)&&(o=document.body),f){case"%":return o.clientHeight/100;case"ch":case"ex":return r(f,o);case"em":return n(o,"font-size");case"rem":return n(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return a;case"cm":return a/2.54;case"mm":return a/25.4;case"pt":return a/72;case"pc":return a/6}return 1}},{"parse-unit":265}],305:[function(c,M,T){M.exports=m;var e=c("filtered-vector"),a=c("gl-mat4/invert"),n=c("gl-mat4/rotate"),r=c("gl-vec3/cross"),t=c("gl-vec3/normalize"),f=c("gl-vec3/dot");function o(u,_,s){return Math.sqrt(Math.pow(u,2)+Math.pow(_,2)+Math.pow(s,2))}function i(u){return Math.min(1,Math.max(-1,u))}function g(u){var _=Math.abs(u[0]),s=Math.abs(u[1]),A=Math.abs(u[2]),x=[0,0,0];_>Math.max(s,A)?x[2]=1:s>Math.max(_,A)?x[0]=1:x[1]=1;for(var v=0,b=0,l=0;l<3;++l)v+=u[l]*u[l],b+=x[l]*u[l];for(var l=0;l<3;++l)x[l]-=b/v*u[l];return t(x,x),x}function p(u,_,s,A,x,v,b,l){this.center=e(s),this.up=e(A),this.right=e(x),this.radius=e([v]),this.angle=e([b,l]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(u,_),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var L=0;L<16;++L)this.computedMatrix[L]=.5;this.recalcMatrix(0)}var y=p.prototype;y.setDistanceLimits=function(u,_){u>0?u=Math.log(u):u=-1/0,_>0?_=Math.log(_):_=1/0,_=Math.max(_,u),this.radius.bounds[0][0]=u,this.radius.bounds[1][0]=_},y.getDistanceLimits=function(u){var _=this.radius.bounds[0];return u?(u[0]=Math.exp(_[0][0]),u[1]=Math.exp(_[1][0]),u):[Math.exp(_[0][0]),Math.exp(_[1][0])]},y.recalcMatrix=function(u){this.center.curve(u),this.up.curve(u),this.right.curve(u),this.radius.curve(u),this.angle.curve(u);for(var _=this.computedUp,s=this.computedRight,A=0,x=0,v=0;v<3;++v)x+=_[v]*s[v],A+=_[v]*_[v];for(var b=Math.sqrt(A),l=0,v=0;v<3;++v)s[v]-=_[v]*x/A,l+=s[v]*s[v],_[v]/=b;for(var L=Math.sqrt(l),v=0;v<3;++v)s[v]/=L;var S=this.computedToward;r(S,_,s),t(S,S);for(var k=Math.exp(this.computedRadius[0]),P=this.computedAngle[0],z=this.computedAngle[1],I=Math.cos(P),D=Math.sin(P),R=Math.cos(z),B=Math.sin(z),F=this.computedCenter,V=I*R,G=D*R,J=B,j=-I*B,Y=-D*B,X=R,oe=this.computedEye,se=this.computedMatrix,v=0;v<3;++v){var ie=V*s[v]+G*S[v]+J*_[v];se[4*v+1]=j*s[v]+Y*S[v]+X*_[v],se[4*v+2]=ie,se[4*v+3]=0}var N=se[1],U=se[5],q=se[9],Q=se[2],W=se[6],Z=se[10],ee=U*Z-q*W,te=q*Q-N*Z,ae=N*W-U*Q,le=o(ee,te,ae);ee/=le,te/=le,ae/=le,se[0]=ee,se[4]=te,se[8]=ae;for(var v=0;v<3;++v)oe[v]=F[v]+se[2+4*v]*k;for(var v=0;v<3;++v){for(var l=0,ye=0;ye<3;++ye)l+=se[v+4*ye]*oe[ye];se[12+v]=-l}se[15]=1},y.getMatrix=function(u,_){this.recalcMatrix(u);var s=this.computedMatrix;if(_){for(var A=0;A<16;++A)_[A]=s[A];return _}return s};var h=[0,0,0];y.rotate=function(u,_,s,A){if(this.angle.move(u,_,s),A){this.recalcMatrix(u);var x=this.computedMatrix;h[0]=x[2],h[1]=x[6],h[2]=x[10];for(var v=this.computedUp,b=this.computedRight,l=this.computedToward,L=0;L<3;++L)x[4*L]=v[L],x[4*L+1]=b[L],x[4*L+2]=l[L];n(x,x,A,h);for(var L=0;L<3;++L)v[L]=x[4*L],b[L]=x[4*L+1];this.up.set(u,v[0],v[1],v[2]),this.right.set(u,b[0],b[1],b[2])}},y.pan=function(u,_,s,A){_=_||0,s=s||0,A=A||0,this.recalcMatrix(u);var x=this.computedMatrix;Math.exp(this.computedRadius[0]);var v=x[1],b=x[5],l=x[9],L=o(v,b,l);v/=L,b/=L,l/=L;var S=x[0],k=x[4],P=x[8],z=S*v+k*b+P*l;S-=v*z,k-=b*z,P-=l*z;var I=o(S,k,P);S/=I,k/=I,P/=I;var D=S*_+v*s,R=k*_+b*s,B=P*_+l*s;this.center.move(u,D,R,B);var F=Math.exp(this.computedRadius[0]);F=Math.max(1e-4,F+A),this.radius.set(u,Math.log(F))},y.translate=function(u,_,s,A){this.center.move(u,_||0,s||0,A||0)},y.setMatrix=function(u,_,s,A){var x=1;typeof s=="number"&&(x=s|0),(x<0||x>3)&&(x=1);var v=(x+2)%3;_||(this.recalcMatrix(u),_=this.computedMatrix);var b=_[x],l=_[x+4],L=_[x+8];if(A){var k=Math.abs(b),P=Math.abs(l),z=Math.abs(L),I=Math.max(k,P,z);k===I?(b=b<0?-1:1,l=L=0):z===I?(L=L<0?-1:1,b=l=0):(l=l<0?-1:1,b=L=0)}else{var S=o(b,l,L);b/=S,l/=S,L/=S}var D=_[v],R=_[v+4],B=_[v+8],F=D*b+R*l+B*L;D-=b*F,R-=l*F,B-=L*F;var V=o(D,R,B);D/=V,R/=V,B/=V;var G=l*B-L*R,J=L*D-b*B,j=b*R-l*D,Y=o(G,J,j);G/=Y,J/=Y,j/=Y,this.center.jump(u,Ae,we,De),this.radius.idle(u),this.up.jump(u,b,l,L),this.right.jump(u,D,R,B);var X,oe;if(x===2){var se=_[1],ie=_[5],N=_[9],U=se*D+ie*R+N*B,q=se*G+ie*J+N*j;ee<0?X=-Math.PI/2:X=Math.PI/2,oe=Math.atan2(q,U)}else{var Q=_[2],W=_[6],Z=_[10],ee=Q*b+W*l+Z*L,te=Q*D+W*R+Z*B,ae=Q*G+W*J+Z*j;X=Math.asin(i(ee)),oe=Math.atan2(ae,te)}this.angle.jump(u,oe,X),this.recalcMatrix(u);var le=_[2],ye=_[6],fe=_[10],pe=this.computedMatrix;a(pe,_);var ge=pe[15],Ae=pe[12]/ge,we=pe[13]/ge,De=pe[14]/ge,Be=Math.exp(this.computedRadius[0]);this.center.jump(u,Ae-le*Be,we-ye*Be,De-fe*Be)},y.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},y.idle=function(u){this.center.idle(u),this.up.idle(u),this.right.idle(u),this.radius.idle(u),this.angle.idle(u)},y.flush=function(u){this.center.flush(u),this.up.flush(u),this.right.flush(u),this.radius.flush(u),this.angle.flush(u)},y.setDistance=function(u,_){_>0&&this.radius.set(u,Math.log(_))},y.lookAt=function(u,_,s,A){this.recalcMatrix(u),_=_||this.computedEye,s=s||this.computedCenter,A=A||this.computedUp;var x=A[0],v=A[1],b=A[2],l=o(x,v,b);if(!(l<1e-6)){x/=l,v/=l,b/=l;var L=_[0]-s[0],S=_[1]-s[1],k=_[2]-s[2],P=o(L,S,k);if(!(P<1e-6)){L/=P,S/=P,k/=P;var z=this.computedRight,I=z[0],D=z[1],R=z[2],B=x*I+v*D+b*R;I-=B*x,D-=B*v,R-=B*b;var F=o(I,D,R);if(!(F<.01&&(I=v*k-b*S,D=b*L-x*k,R=x*S-v*L,F=o(I,D,R),F<1e-6))){I/=F,D/=F,R/=F,this.up.set(u,x,v,b),this.right.set(u,I,D,R),this.center.set(u,s[0],s[1],s[2]),this.radius.set(u,Math.log(P));var V=v*R-b*D,G=b*I-x*R,J=x*D-v*I,j=o(V,G,J);V/=j,G/=j,J/=j;var Y=x*L+v*S+b*k,X=I*L+D*S+R*k,oe=V*L+G*S+J*k,se=Math.asin(i(Y)),ie=Math.atan2(oe,X),N=this.angle._state,U=N[N.length-1],q=N[N.length-2];U=U%(2*Math.PI);var Q=Math.abs(U+2*Math.PI-ie),W=Math.abs(U-ie),Z=Math.abs(U-2*Math.PI-ie);Q<W&&(U+=2*Math.PI),Z<W&&(U-=2*Math.PI),this.angle.jump(this.angle.lastT(),U,q),this.angle.set(u,ie,se)}}}};function m(u){u=u||{};var _=u.center||[0,0,0],s=u.up||[0,1,0],A=u.right||g(s),x=u.radius||1,v=u.theta||0,b=u.phi||0;if(_=[].slice.call(_,0,3),s=[].slice.call(s,0,3),t(s,s),A=[].slice.call(A,0,3),t(A,A),"eye"in u){var l=u.eye,L=[l[0]-_[0],l[1]-_[1],l[2]-_[2]];r(A,L,s),o(A[0],A[1],A[2])<1e-6?A=g(s):t(A,A),x=o(L[0],L[1],L[2]);var S=f(s,L)/x,k=f(A,L)/x;b=Math.acos(S),v=Math.acos(k)}return x=Math.log(x),new p(u.zoomMin,u.zoomMax,_,s,A,x,v,b)}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(c,M,T){M.exports=a;var e=+(Math.pow(2,27)+1);function a(n,r,t){var f=n*r,o=e*n,i=o-n,g=o-i,p=n-g,y=e*r,h=y-r,m=y-h,u=r-m,_=f-g*m,s=_-p*m,A=s-g*u,x=p*u-A;return t?(t[0]=x,t[1]=f,t):[x,f]}},{}],307:[function(c,M,T){M.exports=e;function e(a,n,r){var t=a+n,f=t-a,o=t-f,i=n-f,g=a-o;return r?(r[0]=g+i,r[1]=t,r):[g+i,t]}},{}],308:[function(c,M,T){(function(e){(function(){var a=c("bit-twiddle"),n=c("dup"),r=c("buffer").Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:n([32,0]),UINT16:n([32,0]),UINT32:n([32,0]),BIGUINT64:n([32,0]),INT8:n([32,0]),INT16:n([32,0]),INT32:n([32,0]),BIGINT64:n([32,0]),FLOAT:n([32,0]),DOUBLE:n([32,0]),DATA:n([32,0]),UINT8C:n([32,0]),BUFFER:n([32,0])});var t=typeof Uint8ClampedArray!="undefined",f=typeof BigUint64Array!="undefined",o=typeof BigInt64Array!="undefined",i=e.__TYPEDARRAY_POOL;i.UINT8C||(i.UINT8C=n([32,0])),i.BIGUINT64||(i.BIGUINT64=n([32,0])),i.BIGINT64||(i.BIGINT64=n([32,0])),i.BUFFER||(i.BUFFER=n([32,0]));var g=i.DATA,p=i.BUFFER;T.free=function(D){if(r.isBuffer(D))p[a.log2(D.length)].push(D);else{if(Object.prototype.toString.call(D)!=="[object ArrayBuffer]"&&(D=D.buffer),!D)return;var R=D.length||D.byteLength,B=a.log2(R)|0;g[B].push(D)}};function y(I){if(!!I){var D=I.length||I.byteLength,R=a.log2(D);g[R].push(I)}}function h(I){y(I.buffer)}T.freeUint8=T.freeUint16=T.freeUint32=T.freeBigUint64=T.freeInt8=T.freeInt16=T.freeInt32=T.freeBigInt64=T.freeFloat32=T.freeFloat=T.freeFloat64=T.freeDouble=T.freeUint8Clamped=T.freeDataView=h,T.freeArrayBuffer=y,T.freeBuffer=function(D){p[a.log2(D.length)].push(D)},T.malloc=function(D,R){if(R===void 0||R==="arraybuffer")return m(D);switch(R){case"uint8":return u(D);case"uint16":return _(D);case"uint32":return s(D);case"int8":return A(D);case"int16":return x(D);case"int32":return v(D);case"float":case"float32":return b(D);case"double":case"float64":return l(D);case"uint8_clamped":return L(D);case"bigint64":return k(D);case"biguint64":return S(D);case"buffer":return z(D);case"data":case"dataview":return P(D);default:return null}return null};function m(D){var D=a.nextPow2(D),R=a.log2(D),B=g[R];return B.length>0?B.pop():new ArrayBuffer(D)}T.mallocArrayBuffer=m;function u(I){return new Uint8Array(m(I),0,I)}T.mallocUint8=u;function _(I){return new Uint16Array(m(2*I),0,I)}T.mallocUint16=_;function s(I){return new Uint32Array(m(4*I),0,I)}T.mallocUint32=s;function A(I){return new Int8Array(m(I),0,I)}T.mallocInt8=A;function x(I){return new Int16Array(m(2*I),0,I)}T.mallocInt16=x;function v(I){return new Int32Array(m(4*I),0,I)}T.mallocInt32=v;function b(I){return new Float32Array(m(4*I),0,I)}T.mallocFloat32=T.mallocFloat=b;function l(I){return new Float64Array(m(8*I),0,I)}T.mallocFloat64=T.mallocDouble=l;function L(I){return t?new Uint8ClampedArray(m(I),0,I):u(I)}T.mallocUint8Clamped=L;function S(I){return f?new BigUint64Array(m(8*I),0,I):null}T.mallocBigUint64=S;function k(I){return o?new BigInt64Array(m(8*I),0,I):null}T.mallocBigInt64=k;function P(I){return new DataView(m(I),0,I)}T.mallocDataView=P;function z(I){I=a.nextPow2(I);var D=a.log2(I),R=p[D];return R.length>0?R.pop():new r(I)}T.mallocBuffer=z,T.clearCache=function(){for(var D=0;D<32;++D)i.UINT8[D].length=0,i.UINT16[D].length=0,i.UINT32[D].length=0,i.INT8[D].length=0,i.INT16[D].length=0,i.INT32[D].length=0,i.FLOAT[D].length=0,i.DOUBLE[D].length=0,i.BIGUINT64[D].length=0,i.BIGINT64[D].length=0,i.UINT8C[D].length=0,g[D].length=0,p[D].length=0}}).call(this)}).call(this,typeof w!="undefined"?w:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(c,M,T){M.exports=e;function e(n){this.roots=new Array(n),this.ranks=new Array(n);for(var r=0;r<n;++r)this.roots[r]=r,this.ranks[r]=0}var a=e.prototype;Object.defineProperty(a,"length",{get:function(){return this.roots.length}}),a.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},a.find=function(n){for(var r=n,t=this.roots;t[n]!==n;)n=t[n];for(;t[r]!==n;){var f=t[r];t[r]=n,r=f}return n},a.link=function(n,r){var t=this.find(n),f=this.find(r);if(t!==f){var o=this.ranks,i=this.roots,g=o[t],p=o[f];g<p?i[t]=f:p<g?i[f]=t:(i[f]=t,++o[t])}}},{}],310:[function(c,M,T){function e(r,t){for(var f=1,o=r.length,i=r[0],g=r[0],p=1;p<o;++p)if(g=i,i=r[p],t(i,g)){if(p===f){f++;continue}r[f++]=i}return r.length=f,r}function a(r){for(var t=1,f=r.length,o=r[0],i=r[0],g=1;g<f;++g,i=o)if(i=o,o=r[g],o!==i){if(g===t){t++;continue}r[t++]=o}return r.length=t,r}function n(r,t,f){return r.length===0?r:t?(f||r.sort(t),e(r,t)):(f||r.sort(),a(r))}M.exports=n},{}],311:[function(c,M,T){M.exports=r;var e=c("./lib/vtext"),a=null,n=null;typeof document!="undefined"&&(a=document.createElement("canvas"),a.width=8192,a.height=1024,n=a.getContext("2d"));function r(t,f){return(typeof f!="object"||f===null)&&(f={}),e(t,f.canvas||a,f.context||n,f)}},{"./lib/vtext":312}],312:[function(c,M,T){M.exports=S,M.exports.processPixels=L;var e=c("surface-nets"),a=c("ndarray"),n=c("simplify-planar-graph"),r=c("clean-pslg"),t=c("cdt2d"),f=c("planar-graph-to-polyline"),o="b",i="b|",g="i",p="i|",y="sup",h="+",m="+1",u="sub",_="-",s="-1";function A(k,P,z,I){for(var D="<"+k+">",R="</"+k+">",B=D.length,F=R.length,V=P[0]===h||P[0]===_,G=0,J=-F;G>-1&&(G=z.indexOf(D,G),!(G===-1||(J=z.indexOf(R,G+B),J===-1)||J<=G));){for(var j=G;j<J+F;++j)if(j<G+B||j>=J)I[j]=null,z=z.substr(0,j)+" "+z.substr(j+1);else if(I[j]!==null){var Y=I[j].indexOf(P[0]);Y===-1?I[j]+=P:V&&(I[j]=I[j].substr(0,Y+1)+(1+parseInt(I[j][Y+1]))+I[j].substr(Y+2))}var X=G+B,oe=z.substr(X,J-X),se=oe.indexOf(D);se!==-1?G=se:G=J+F}return I}function x(k,P,z){for(var I=P.textAlign||"start",D=P.textBaseline||"alphabetic",R=[1<<30,1<<30],B=[0,0],F=k.length,V=0;V<F;++V)for(var G=k[V],J=0;J<2;++J)R[J]=Math.min(R[J],G[J])|0,B[J]=Math.max(B[J],G[J])|0;var j=0;switch(I){case"center":j=-.5*(R[0]+B[0]);break;case"right":case"end":j=-B[0];break;case"left":case"start":j=-R[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+I+"'")}var Y=0;switch(D){case"hanging":case"top":Y=-R[1];break;case"middle":Y=-.5*(R[1]+B[1]);break;case"alphabetic":case"ideographic":Y=-3*z;break;case"bottom":Y=-B[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+D+"'")}var X=1/z;return"lineHeight"in P?X*=+P.lineHeight:"width"in P?X=P.width/(B[0]-R[0]):"height"in P&&(X=P.height/(B[1]-R[1])),k.map(function(oe){return[X*(oe[0]+j),X*(oe[1]+Y)]})}function v(k,P,z,I,D,R){z=z.replace(/\n/g,""),R.breaklines===!0?z=z.replace(/\<br\>/g,`
`):z=z.replace(/\<br\>/g," ");var B="",F=[];for(U=0;U<z.length;++U)F[U]=B;R.bolds===!0&&(F=A(o,i,z,F)),R.italics===!0&&(F=A(g,p,z,F)),R.superscripts===!0&&(F=A(y,m,z,F)),R.subscripts===!0&&(F=A(u,s,z,F));var V=[],G="";for(U=0;U<z.length;++U)F[U]!==null&&(G+=z[U],V.push(F[U]));var J=G.split(`
`),j=J.length,Y=Math.round(D*I),X=I,oe=I*2,se=0,ie=j*Y+oe;k.height<ie&&(k.height=ie),P.fillStyle="#000",P.fillRect(0,0,k.width,k.height),P.fillStyle="#fff";var N,U,q,Q,W,Z=0,ee="";function te(){if(ee!==""){var De=P.measureText(ee).width;P.fillText(ee,X+q,oe+Q),q+=De}}function ae(){return""+Math.round(W)+"px "}function le(De,Be){var Ve=""+P.font;if(R.subscripts===!0){var xe=De.indexOf(_),Le=Be.indexOf(_),He=xe>-1?parseInt(De[1+xe]):0,Je=Le>-1?parseInt(Be[1+Le]):0;He!==Je&&(Ve=Ve.replace(ae(),"?px "),W*=Math.pow(.75,Je-He),Ve=Ve.replace("?px ",ae())),Q+=.25*Y*(Je-He)}if(R.superscripts===!0){var Oe=De.indexOf(h),Pe=Be.indexOf(h),Ue=Oe>-1?parseInt(De[1+Oe]):0,vt=Pe>-1?parseInt(Be[1+Pe]):0;Ue!==vt&&(Ve=Ve.replace(ae(),"?px "),W*=Math.pow(.75,vt-Ue),Ve=Ve.replace("?px ",ae())),Q-=.25*Y*(vt-Ue)}if(R.bolds===!0){var Lt=De.indexOf(i)>-1,Yt=Be.indexOf(i)>-1;!Lt&&Yt&&(At?Ve=Ve.replace("italic ","italic bold "):Ve="bold "+Ve),Lt&&!Yt&&(Ve=Ve.replace("bold ",""))}if(R.italics===!0){var At=De.indexOf(p)>-1,Rt=Be.indexOf(p)>-1;!At&&Rt&&(Ve="italic "+Ve),At&&!Rt&&(Ve=Ve.replace("italic ",""))}P.font=Ve}for(N=0;N<j;++N){var ye=J[N]+`
`;for(q=0,Q=N*Y,W=I,ee="",U=0;U<ye.length;++U){var fe=U+Z<V.length?V[U+Z]:V[V.length-1];B===fe?ee+=ye[U]:(te(),ee=ye[U],fe!==void 0&&(le(B,fe),B=fe))}te(),Z+=ye.length;var pe=Math.round(q+2*X)|0;se<pe&&(se=pe)}var ge=se,Ae=oe+Y*j,we=a(P.getImageData(0,0,ge,Ae).data,[Ae,ge,4]);return we.pick(-1,-1,0).transpose(1,0)}function b(k,P){var z=e(k,128);return P?n(z.cells,z.positions,.25):{edges:z.cells,positions:z.positions}}function l(k,P,z,I){var D=b(k,I),R=x(D.positions,P,z),B=D.edges,F=P.orientation==="ccw";if(r(R,B),P.polygons||P.polygon||P.polyline){for(var V=f(B,R),G=new Array(V.length),J=0;J<V.length;++J){for(var j=V[J],Y=new Array(j.length),X=0;X<j.length;++X){for(var oe=j[X],se=new Array(oe.length),ie=0;ie<oe.length;++ie)se[ie]=R[oe[ie]].slice();F&&se.reverse(),Y[X]=se}G[J]=Y}return G}else return P.triangles||P.triangulate||P.triangle?{cells:t(R,B,{delaunay:!1,exterior:!1,interior:!0}),positions:R}:{edges:B,positions:R}}function L(k,P,z){try{return l(k,P,z,!0)}catch{}try{return l(k,P,z,!1)}catch{}return P.polygons||P.polyline||P.polygon?[]:P.triangles||P.triangulate||P.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}function S(k,P,z,I){var D=64,R=1.25,B={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};I&&(I.size&&I.size>0&&(D=I.size),I.lineSpacing&&I.lineSpacing>0&&(R=I.lineSpacing),I.styletags&&I.styletags.breaklines&&(B.breaklines=!!I.styletags.breaklines),I.styletags&&I.styletags.bolds&&(B.bolds=!!I.styletags.bolds),I.styletags&&I.styletags.italics&&(B.italics=!!I.styletags.italics),I.styletags&&I.styletags.subscripts&&(B.subscripts=!!I.styletags.subscripts),I.styletags&&I.styletags.superscripts&&(B.superscripts=!!I.styletags.superscripts)),z.font=[I.fontStyle,I.fontVariant,I.fontWeight,D+"px",I.font].filter(function(V){return V}).join(" "),z.textAlign="start",z.textBaseline="alphabetic",z.direction="ltr";var F=v(P,z,k,D,R,B);return L(F,I,D)}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(c,M,T){(function(){if(typeof ses!="undefined"&&ses.ok&&!ses.ok())return;function a(L){L.permitHostObjects___&&L.permitHostObjects___(a)}typeof ses!="undefined"&&(ses.weakMapPermitHostObjects=a);var n=!1;if(typeof WeakMap=="function"){var r=WeakMap;if(!(typeof navigator!="undefined"&&/Firefox/.test(navigator.userAgent))){var t=new r,f=Object.freeze({});if(t.set(f,1),t.get(f)!==1)n=!0;else{M.exports=WeakMap;return}}}var o=Object.getOwnPropertyNames,i=Object.defineProperty,g=Object.isExtensible,p="weakmap:",y=p+"ident:"+Math.random()+"___";if(typeof crypto!="undefined"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var h=new ArrayBuffer(25),m=new Uint8Array(h);crypto.getRandomValues(m),y=p+"rand:"+Array.prototype.map.call(m,function(L){return(L%36).toString(36)}).join("")+"___"}function u(L){return!(L.substr(0,p.length)==p&&L.substr(L.length-3)==="___")}if(i(Object,"getOwnPropertyNames",{value:function(S){return o(S).filter(u)}}),"getPropertyNames"in Object){var _=Object.getPropertyNames;i(Object,"getPropertyNames",{value:function(S){return _(S).filter(u)}})}function s(L){if(L!==Object(L))throw new TypeError("Not an object: "+L);var S=L[y];if(S&&S.key===L)return S;if(!!g(L)){S={key:L};try{return i(L,y,{value:S,writable:!1,enumerable:!1,configurable:!1}),S}catch{return}}}(function(){var L=Object.freeze;i(Object,"freeze",{value:function(z){return s(z),L(z)}});var S=Object.seal;i(Object,"seal",{value:function(z){return s(z),S(z)}});var k=Object.preventExtensions;i(Object,"preventExtensions",{value:function(z){return s(z),k(z)}})})();function A(L){return L.prototype=null,Object.freeze(L)}var x=!1;function v(){!x&&typeof console!="undefined"&&(x=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}var b=0,l=function(){this instanceof l||v();var L=[],S=[],k=b++;function P(R,B){var F,V=s(R);return V?k in V?V[k]:B:(F=L.indexOf(R),F>=0?S[F]:B)}function z(R){var B=s(R);return B?k in B:L.indexOf(R)>=0}function I(R,B){var F,V=s(R);return V?V[k]=B:(F=L.indexOf(R),F>=0?S[F]=B:(F=L.length,S[F]=B,L[F]=R)),this}function D(R){var B=s(R),F,V;return B?k in B&&delete B[k]:(F=L.indexOf(R),F<0?!1:(V=L.length-1,L[F]=void 0,S[F]=S[V],L[F]=L[V],L.length=V,S.length=V,!0))}return Object.create(l.prototype,{get___:{value:A(P)},has___:{value:A(z)},set___:{value:A(I)},delete___:{value:A(D)}})};l.prototype=Object.create(Object.prototype,{get:{value:function(S,k){return this.get___(S,k)},writable:!0,configurable:!0},has:{value:function(S){return this.has___(S)},writable:!0,configurable:!0},set:{value:function(S,k){return this.set___(S,k)},writable:!0,configurable:!0},delete:{value:function(S){return this.delete___(S)},writable:!0,configurable:!0}}),typeof r=="function"?function(){n&&typeof Proxy!="undefined"&&(Proxy=void 0);function L(){this instanceof l||v();var S=new r,k=void 0,P=!1;function z(B,F){return k?S.has(B)?S.get(B):k.get___(B,F):S.get(B,F)}function I(B){return S.has(B)||(k?k.has___(B):!1)}var D;n?D=function(B,F){return S.set(B,F),S.has(B)||(k||(k=new l),k.set(B,F)),this}:D=function(B,F){if(P)try{S.set(B,F)}catch{k||(k=new l),k.set___(B,F)}else S.set(B,F);return this};function R(B){var F=!!S.delete(B);return k&&k.delete___(B)||F}return Object.create(l.prototype,{get___:{value:A(z)},has___:{value:A(I)},set___:{value:A(D)},delete___:{value:A(R)},permitHostObjects___:{value:A(function(B){if(B===a)P=!0;else throw new Error("bogus call to permitHostObjects___")})}})}L.prototype=l.prototype,M.exports=L,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy!="undefined"&&(Proxy=void 0),M.exports=l)})()},{}],314:[function(c,M,T){var e=c("./hidden-store.js");M.exports=a;function a(){var n={};return function(r){if((typeof r!="object"||r===null)&&typeof r!="function")throw new Error("Weakmap-shim: Key must be object");var t=r.valueOf(n);return t&&t.identity===n?t:e(r,n)}}},{"./hidden-store.js":315}],315:[function(c,M,T){M.exports=e;function e(a,n){var r={identity:n},t=a.valueOf;return Object.defineProperty(a,"valueOf",{value:function(f){return f!==n?t.apply(this,arguments):r},writable:!0}),r}},{}],316:[function(c,M,T){var e=c("./create-store.js");M.exports=a;function a(){var n=e();return{get:function(r,t){var f=n(r);return f.hasOwnProperty("value")?f.value:t},set:function(r,t){return n(r).value=t,this},has:function(r){return"value"in n(r)},delete:function(r){return delete n(r).value}}}},{"./create-store.js":314}],317:[function(c,M,T){function e(){return function(o,i,g,p,y,h){var m=o[0],u=g[0],_=[0],s=u;p|=0;var A=0,x=u;for(A=0;A<m;++A){{var v=i[p]-h,b=i[p+s]-h;v>=0!=b>=0&&y.push(_[0]+.5+.5*(v+b)/(v-b))}p+=x,++_[0]}}}function a(){return e()}var n=a;function r(o){var i={};return function(p,y,h){var m=p.dtype,u=p.order,_=[m,u.join()].join(),s=i[_];return s||(i[_]=s=o([m,u])),s(p.shape.slice(0),p.data,p.stride,p.offset|0,y,h)}}function t(o){return r(n.bind(void 0,o))}function f(o){return t({funcName:o.funcName})}M.exports=f({funcName:"zeroCrossings"})},{}],318:[function(c,M,T){M.exports=a;var e=c("./lib/zc-core");function a(n,r){var t=[];return r=+r||0,e(n.hi(n.shape[0]-1),t,r),t}},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,typeof Mo!="undefined"?Mo:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[27])(27)})})(rp);var Mg=sg(rp.exports);export{Mg as P,Ag as S,gg as a,cg as b,dg as c,Q0 as d,vg as e,bg as f,xg as g,ng as h,Tg as i,wg as j,ig as k,ep as l,ag as m,$v as n,mg as o,pg as p,fg as q,yg as r,lg as s,_g as t,hg as u,ug as v};
